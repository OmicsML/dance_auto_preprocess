/home/zyxing/dance/dance/utils/matrix.py:178: NumbaExperimentalFeatureWarning: First-class function type feature is experimental
  for j in numba.prange(n):
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numba/np/ufunc/parallel.py:371: NumbaWarning: The TBB threading layer requires TBB version 2021 update 6 or later i.e., TBB_INTERFACE_VERSION >= 12060. Found TBB_INTERFACE_VERSION = 12050. The TBB threading layer is disabled.
  warnings.warn(problem)
[INFO][2024-03-21 19:15:59,970][dance][<module>] 
{'batch_size': 128,
 'cache': False,
 'count': 600,
 'device': 'cuda:1',
 'hidden_dims': [2000],
 'lambd': 0.005,
 'learning_rate': 0.0001,
 'log_level': 'INFO',
 'nofilter': False,
 'normalize': False,
 'num_epochs': 50,
 'print_cost': False,
 'root_path': '/home/zyxing/dance/examples/tuning/cta_actinn',
 'seed': 0,
 'species': 'human',
 'summary_file_path': 'results/pipeline/best_test_acc.csv',
 'sweep_id': None,
 'test_dataset': ['138'],
 'tissue': 'Brain',
 'train_dataset': ['328'],
 'tune_mode': 'pipeline_params',
 'valid_dataset': None}
[INFO][2024-03-21 19:15:59,971][dance][<module>] 
 files is saved in /home/zyxing/dance/examples/tuning/cta_actinn/328_138
[INFO][2024-03-21 19:15:59,994][dance][config] tune mode is set to pipeline_params,tune_mode will first be converted to pipeline
[WARNING][2024-03-21 19:15:59,998][dance][_resolve_pelem_plan] 1 (out of 6) inclusions were not found in the registry under the scope 'preprocessor.feature.cell'.
[INFO][2024-03-21 19:15:59,999][dance][<module>] Running SVM with the following parameters:
{'batch_size': 128,
 'cache': False,
 'count': 600,
 'device': 'cuda:1',
 'hidden_dims': [2000],
 'lambd': 0.005,
 'learning_rate': 0.0001,
 'log_level': 'INFO',
 'nofilter': False,
 'normalize': False,
 'num_epochs': 50,
 'print_cost': False,
 'root_path': '/home/zyxing/dance/examples/tuning/cta_actinn',
 'seed': 0,
 'species': 'human',
 'summary_file_path': 'results/pipeline/best_test_acc.csv',
 'sweep_id': None,
 'test_dataset': ['138'],
 'tissue': 'Brain',
 'train_dataset': ['328'],
 'tune_mode': 'pipeline_params',
 'valid_dataset': None}
[INFO][2024-03-21 19:15:59,999][dance][wandb_sweep] Sweep config:
{'entity': 'xzy11632',
 'method': 'grid',
 'metric': {'goal': 'maximize', 'name': 'acc'},
 'parameters': {'pipeline.0.filter.gene': {'values': ['FilterGenesPercentile',
                                                      'FilterGenesPlaceHolder',
                                                      'FilterGenesScanpyOrder']},
                'pipeline.1.normalize': {'values': ['Log1P',
                                                    'NormalizePlaceHolder',
                                                    'NormalizeTotal',
                                                    'ScTransform',
                                                    'ScaleFeature']},
                'pipeline.2.filter.gene': {'values': ['FilterGenesNumberPlaceHolder',
                                                      'FilterGenesRegression',
                                                      'FilterGenesTopK',
                                                      'HighlyVariableGenesLogarithmizedByMeanAndDisp',
                                                      'HighlyVariableGenesLogarithmizedByTopGenes',
                                                      'HighlyVariableGenesRawCount']},
                'pipeline.3.feature.cell': {'values': ['CellPCA',
                                                       'CellSVD',
                                                       'FeatureCellPlaceHolder',
                                                       'WeightedFeaturePCA',
                                                       'WeightedFeatureSVD']}},
 'project': 'dance-dev'}
[INFO][2024-03-21 19:16:01,458][dance][wandb_sweep] [94m

	[*] Sweep ID: ek4kaw79
[0m
[INFO][2024-03-21 19:16:01,458][dance][wandb_sweep_agent] Spawning agent: sweep_id='ek4kaw79', entity='xzy11632', project='dance-dev', count=600
wandb: Agent Starting Run: vdwobsjx with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: Currently logged in as: xzy11632. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_191603-vdwobsjx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run cool-sweep-1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/vdwobsjx
[INFO][2024-03-21 19:16:12,847][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:16:12,847][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:16:12,849][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'FilterGenesNumberPlaceHolder',
 'CellPCA',
 None][0m
[INFO][2024-03-21 19:16:12,853][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:16:13,550][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:16:13,837][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:16:13,846][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:16:14,332][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:16:14,332][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:16:14,332][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:16:14,332][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:16:14,332][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:16:14,334][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:16:14,335][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:16:14,335][dance][wrapped_func] Took 0:00:01.482051 to load and process data.
[WARNING][2024-03-21 19:16:14,344][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 19:16:14,345][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:16:14,350][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 19:16:14,639][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 19:16:44,680][dance.CellPCA][__call__] Generating cell PCA features (466, 21867) (k=362)
[INFO][2024-03-21 19:16:44,683][dance.CellPCA][__call__] Top 10 explained variances: [0.11204968 0.03459479 0.01951907 0.01849966 0.01026512 0.00872076
 0.00687905 0.00607501 0.00575275 0.00526155]
[INFO][2024-03-21 19:16:44,683][dance.CellPCA][__call__] Total explained variance: 90.09%
[INFO][2024-03-21 19:16:44,685][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:16:44,685][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.43939
wandb:  test_acc 0.17391
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run cool-sweep-1 at: https://wandb.ai/xzy11632/dance-dev/runs/vdwobsjx
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_191603-vdwobsjx/logs
wandb: Agent Starting Run: v15abfts with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_191711-v15abfts
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run summer-sweep-2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/v15abfts
[INFO][2024-03-21 19:17:21,628][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:17:21,629][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:17:21,631][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'FilterGenesNumberPlaceHolder',
 'CellSVD',
 None][0m
[INFO][2024-03-21 19:17:21,636][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:17:22,637][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:17:22,967][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:17:22,969][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:17:23,573][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:17:23,574][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:17:23,574][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:17:23,574][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:17:23,575][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:17:23,577][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:17:23,577][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:17:23,577][dance][wrapped_func] Took 0:00:01.941793 to load and process data.
[WARNING][2024-03-21 19:17:23,586][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 19:17:23,587][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:17:23,593][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 19:17:23,728][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 19:19:24,818][dance.CellSVD][__call__] Generating cell SVD features (466, 21867) (k=363)
[INFO][2024-03-21 19:19:24,820][dance.CellSVD][__call__] Top 10 explained variances: [0.09834396 0.03498174 0.02630393 0.01928741 0.01053023 0.0095353
 0.0068708  0.00687904 0.00596418 0.00561349]
[INFO][2024-03-21 19:19:24,821][dance.CellSVD][__call__] Total explained variance: 89.74%
[INFO][2024-03-21 19:19:24,824][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:19:24,824][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.018 MB of 0.025 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.40909
wandb:  test_acc 0.18841
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run summer-sweep-2 at: https://wandb.ai/xzy11632/dance-dev/runs/v15abfts
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_191711-v15abfts/logs
wandb: Agent Starting Run: 2orx5jjz with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_191940-2orx5jjz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run elated-sweep-3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/2orx5jjz
[INFO][2024-03-21 19:19:49,455][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:19:49,455][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:19:49,457][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'FilterGenesNumberPlaceHolder',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 19:19:49,473][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:19:50,224][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:19:50,561][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:19:50,565][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:19:50,902][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:19:50,902][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:19:50,903][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:19:50,903][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:19:50,903][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:19:50,905][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:19:50,906][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:19:50,906][dance][wrapped_func] Took 0:00:01.433184 to load and process data.
[WARNING][2024-03-21 19:19:50,927][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 19:19:50,927][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 19:19:50,927][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 19:19:50,928][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:19:50,934][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 19:19:51,070][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 19:19:51,071][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 19:19:51,072][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 19:19:53,711][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:19:53,712][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.83333
wandb:  test_acc 0.78261
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run elated-sweep-3 at: https://wandb.ai/xzy11632/dance-dev/runs/2orx5jjz
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_191940-2orx5jjz/logs
wandb: Agent Starting Run: sc7rkql6 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_192013-sc7rkql6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run likely-sweep-4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/sc7rkql6
[INFO][2024-03-21 19:20:20,566][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:20:20,567][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:20:20,570][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 19:20:20,576][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:20:21,053][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:20:21,233][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:20:21,237][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:20:21,479][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:20:21,479][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:20:21,479][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:20:21,479][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:20:21,479][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:20:21,481][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:20:21,481][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:20:21,481][dance][wrapped_func] Took 0:00:00.905844 to load and process data.
[WARNING][2024-03-21 19:20:21,488][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 19:20:21,488][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:20:21,494][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 19:20:21,570][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 19:20:22,495][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 21867) (k=189)
[INFO][2024-03-21 19:20:22,496][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.11%
[INFO][2024-03-21 19:20:22,625][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:20:22,636][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.021 MB uploadedwandb: \ 0.012 MB of 0.021 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.60606
wandb:  test_acc 0.18841
wandb: train_acc 0.76718
wandb: 
wandb: üöÄ View run likely-sweep-4 at: https://wandb.ai/xzy11632/dance-dev/runs/sc7rkql6
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_192013-sc7rkql6/logs
wandb: Agent Starting Run: qbyhho74 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_192038-qbyhho74
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run vague-sweep-5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/qbyhho74
[INFO][2024-03-21 19:20:45,889][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:20:45,889][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:20:45,898][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 19:20:45,902][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:20:46,860][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:20:47,039][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:20:47,042][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:20:47,236][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:20:47,236][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:20:47,237][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:20:47,237][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:20:47,237][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:20:47,239][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:20:47,239][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:20:47,240][dance][wrapped_func] Took 0:00:01.337389 to load and process data.
[WARNING][2024-03-21 19:20:47,249][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 19:20:47,249][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:20:47,256][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 19:20:47,347][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 19:21:05,562][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 21867) (k=208)
[INFO][2024-03-21 19:21:05,567][dance.WeightedFeatureSVD][__call__] Total explained variance: 93.00%
[INFO][2024-03-21 19:21:05,627][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:21:05,628][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.57576
wandb:  test_acc 0.18116
wandb: train_acc 0.74809
wandb: 
wandb: üöÄ View run vague-sweep-5 at: https://wandb.ai/xzy11632/dance-dev/runs/qbyhho74
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_192038-qbyhho74/logs
wandb: Agent Starting Run: 772b8k9r with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_192118-772b8k9r
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run different-sweep-6
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/772b8k9r
[INFO][2024-03-21 19:21:25,710][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:21:25,711][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:21:25,712][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile', 'Log1P', 'FilterGenesRegression', 'CellPCA', None][0m
[INFO][2024-03-21 19:21:25,730][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:21:26,350][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:21:26,655][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:21:26,658][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:21:27,172][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:21:27,172][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:21:27,174][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:21:27,174][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:21:27,174][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:21:27,177][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:21:27,182][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:21:27,183][dance][wrapped_func] Took 0:00:01.452883 to load and process data.
[WARNING][2024-03-21 19:21:27,215][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:21:27,229][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 19:21:27,723][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 19:21:47,094][dance.CellPCA][__call__] Generating cell PCA features (466, 21867) (k=362)
[INFO][2024-03-21 19:21:47,100][dance.CellPCA][__call__] Top 10 explained variances: [0.11204968 0.03459479 0.01951907 0.01849966 0.01026512 0.00872076
 0.00687905 0.00607501 0.00575275 0.00526155]
[INFO][2024-03-21 19:21:47,100][dance.CellPCA][__call__] Total explained variance: 90.09%
[INFO][2024-03-21 19:21:47,102][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:21:47,103][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.43939
wandb:  test_acc 0.17391
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run different-sweep-6 at: https://wandb.ai/xzy11632/dance-dev/runs/772b8k9r
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_192118-772b8k9r/logs
wandb: Agent Starting Run: fb2hibpl with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_192206-fb2hibpl
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run classic-sweep-7
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/fb2hibpl
[INFO][2024-03-21 19:22:15,912][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:22:15,917][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:22:15,918][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile', 'Log1P', 'FilterGenesRegression', 'CellSVD', None][0m
[INFO][2024-03-21 19:22:15,924][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:22:16,815][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:22:17,169][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:22:17,173][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:22:17,662][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:22:17,662][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:22:17,662][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:22:17,663][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:22:17,663][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:22:17,666][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:22:17,669][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:22:17,669][dance][wrapped_func] Took 0:00:01.745839 to load and process data.
[WARNING][2024-03-21 19:22:17,689][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:22:17,697][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 19:22:18,082][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 19:24:14,416][dance.CellSVD][__call__] Generating cell SVD features (466, 21867) (k=363)
[INFO][2024-03-21 19:24:14,421][dance.CellSVD][__call__] Top 10 explained variances: [0.09834396 0.03498174 0.02630393 0.01928741 0.01053023 0.0095353
 0.0068708  0.00687904 0.00596418 0.00561349]
[INFO][2024-03-21 19:24:14,422][dance.CellSVD][__call__] Total explained variance: 89.74%
[INFO][2024-03-21 19:24:14,424][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:24:14,426][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.40909
wandb:  test_acc 0.18841
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run classic-sweep-7 at: https://wandb.ai/xzy11632/dance-dev/runs/fb2hibpl
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_192206-fb2hibpl/logs
wandb: Agent Starting Run: 1fmfxxog with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_192431-1fmfxxog
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run revived-sweep-8
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/1fmfxxog
[INFO][2024-03-21 19:24:40,222][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:24:40,222][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:24:40,224][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'FilterGenesRegression',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 19:24:40,243][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:24:40,999][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:24:41,327][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:24:41,331][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:24:41,583][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:24:41,584][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:24:41,585][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:24:41,585][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:24:41,585][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:24:41,588][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:24:41,589][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:24:41,589][dance][wrapped_func] Took 0:00:01.346474 to load and process data.
[WARNING][2024-03-21 19:24:41,601][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 19:24:41,602][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 19:24:41,604][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:24:41,614][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 19:24:41,928][dance][_filter_enclasc] Start generating cell features using EnClaSC
[WARNING][2024-03-21 19:24:41,981][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 19:24:41,981][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 19:24:45,277][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:24:45,278][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.018 MB of 0.026 MB uploadedwandb: | 0.018 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.83333
wandb:  test_acc 0.78261
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run revived-sweep-8 at: https://wandb.ai/xzy11632/dance-dev/runs/1fmfxxog
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_192431-1fmfxxog/logs
wandb: Agent Starting Run: 5bmo23f0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_192506-5bmo23f0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run helpful-sweep-9
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/5bmo23f0
[INFO][2024-03-21 19:25:15,561][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:25:15,561][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:25:15,563][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 19:25:15,581][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:25:16,476][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:25:16,810][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:25:16,813][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:25:17,145][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:25:17,159][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:25:17,159][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:25:17,160][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:25:17,160][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:25:17,162][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:25:17,162][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:25:17,163][dance][wrapped_func] Took 0:00:01.594383 to load and process data.
[WARNING][2024-03-21 19:25:17,178][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:25:17,183][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 19:25:17,633][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 19:25:25,938][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 21867) (k=189)
[INFO][2024-03-21 19:25:25,946][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.11%
[INFO][2024-03-21 19:25:26,050][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:25:26,050][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.60606
wandb:  test_acc 0.18841
wandb: train_acc 0.76718
wandb: 
wandb: üöÄ View run helpful-sweep-9 at: https://wandb.ai/xzy11632/dance-dev/runs/5bmo23f0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_192506-5bmo23f0/logs
wandb: Agent Starting Run: xbjdt0ug with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_192541-xbjdt0ug
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lucky-sweep-10
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/xbjdt0ug
[INFO][2024-03-21 19:25:50,813][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:25:50,814][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:25:50,815][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 19:25:50,821][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:25:51,812][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:25:52,340][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:25:52,347][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:25:52,917][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:25:52,917][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:25:52,917][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:25:52,918][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:25:52,918][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:25:52,920][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:25:52,920][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:25:52,921][dance][wrapped_func] Took 0:00:02.100490 to load and process data.
[WARNING][2024-03-21 19:25:52,942][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:25:52,948][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 19:25:53,335][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 19:26:43,382][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 21867) (k=208)
[INFO][2024-03-21 19:26:43,382][dance.WeightedFeatureSVD][__call__] Total explained variance: 93.00%
[INFO][2024-03-21 19:26:43,439][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:26:43,440][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.57576
wandb:  test_acc 0.18116
wandb: train_acc 0.74809
wandb: 
wandb: üöÄ View run lucky-sweep-10 at: https://wandb.ai/xzy11632/dance-dev/runs/xbjdt0ug
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_192541-xbjdt0ug/logs
wandb: Agent Starting Run: 3dh8qriw with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_192701-3dh8qriw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run vocal-sweep-11
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/3dh8qriw
[INFO][2024-03-21 19:27:10,634][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:27:10,634][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:27:10,636][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile', 'Log1P', 'FilterGenesTopK', 'CellPCA', None][0m
[INFO][2024-03-21 19:27:10,645][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:27:11,347][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:27:11,600][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:27:11,604][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:27:12,105][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:27:12,106][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:27:12,106][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:27:12,106][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:27:12,106][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:27:12,108][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:27:12,109][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:27:12,109][dance][wrapped_func] Took 0:00:01.464183 to load and process data.
Create sweep with ID: ek4kaw79
Sweep URL: https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 19:27:12,119][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:27:12,125][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 19:27:15,944][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=213)
[INFO][2024-03-21 19:27:15,945][dance.CellPCA][__call__] Top 10 explained variances: [0.07902199 0.01458714 0.01205022 0.01095151 0.01079713 0.0103516
 0.01023789 0.01015549 0.00944025 0.00873434]
[INFO][2024-03-21 19:27:15,945][dance.CellPCA][__call__] Total explained variance: 90.10%
[INFO][2024-03-21 19:27:15,946][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:27:15,947][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.022 MB of 0.025 MB uploadedwandb: | 0.022 MB of 0.025 MB uploadedwandb: / 0.022 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.58397
wandb: 
wandb: üöÄ View run vocal-sweep-11 at: https://wandb.ai/xzy11632/dance-dev/runs/3dh8qriw
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_192701-3dh8qriw/logs
wandb: Agent Starting Run: uvso3cmy with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_192735-uvso3cmy
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sweet-sweep-12
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/uvso3cmy
[INFO][2024-03-21 19:27:44,555][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:27:44,556][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:27:44,558][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile', 'Log1P', 'FilterGenesTopK', 'CellSVD', None][0m
[INFO][2024-03-21 19:27:44,570][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:27:46,178][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:27:46,614][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:27:46,618][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:27:46,892][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:27:46,893][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:27:46,893][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:27:46,893][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:27:46,893][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:27:46,899][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:27:46,900][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:27:46,900][dance][wrapped_func] Took 0:00:02.330533 to load and process data.
[WARNING][2024-03-21 19:27:46,911][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:27:46,927][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 19:29:06,420][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=213)
[INFO][2024-03-21 19:29:06,422][dance.CellSVD][__call__] Top 10 explained variances: [0.07899692 0.01457518 0.01202486 0.01094823 0.01078471 0.01033875
 0.01023467 0.0101459  0.00941532 0.00871388]
[INFO][2024-03-21 19:29:06,422][dance.CellSVD][__call__] Total explained variance: 89.96%
[INFO][2024-03-21 19:29:06,423][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:29:06,424][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.55725
wandb: 
wandb: üöÄ View run sweet-sweep-12 at: https://wandb.ai/xzy11632/dance-dev/runs/uvso3cmy
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_192735-uvso3cmy/logs
wandb: Agent Starting Run: jrf0mysp with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_192922-jrf0mysp
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dry-sweep-13
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/jrf0mysp
[INFO][2024-03-21 19:29:30,308][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:29:30,309][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:29:30,311][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'FilterGenesTopK',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 19:29:30,316][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:29:30,989][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:29:31,259][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:29:31,263][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:29:31,536][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:29:31,537][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:29:31,537][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:29:31,537][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:29:31,537][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:29:31,540][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:29:31,540][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:29:31,541][dance][wrapped_func] Took 0:00:01.225360 to load and process data.
[WARNING][2024-03-21 19:29:31,555][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 19:29:31,556][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 19:29:31,557][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:29:31,564][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[WARNING][2024-03-21 19:29:31,771][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 19:29:31,771][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 19:29:31,932][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:29:31,934][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.71374
wandb: 
wandb: üöÄ View run dry-sweep-13 at: https://wandb.ai/xzy11632/dance-dev/runs/jrf0mysp
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_192922-jrf0mysp/logs
wandb: Agent Starting Run: 06j4dpdk with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_192948-06j4dpdk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run autumn-sweep-14
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/06j4dpdk
[INFO][2024-03-21 19:29:57,288][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:29:57,288][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:29:57,290][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 19:29:57,295][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:29:57,879][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:29:58,105][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:29:58,109][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:29:58,397][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:29:58,397][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:29:58,397][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:29:58,397][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:29:58,398][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:29:58,400][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:29:58,400][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:29:58,400][dance][wrapped_func] Took 0:00:01.105658 to load and process data.
[WARNING][2024-03-21 19:29:58,408][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:29:58,414][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 19:29:59,229][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=133)
[INFO][2024-03-21 19:29:59,230][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.22%
[INFO][2024-03-21 19:29:59,286][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:29:59,288][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.31818
wandb:  test_acc 0.06522
wandb: train_acc 0.41985
wandb: 
wandb: üöÄ View run autumn-sweep-14 at: https://wandb.ai/xzy11632/dance-dev/runs/06j4dpdk
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_192948-06j4dpdk/logs
wandb: Agent Starting Run: ykfhk0io with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_193015-ykfhk0io
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run avid-sweep-15
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ykfhk0io
[INFO][2024-03-21 19:30:23,345][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:30:23,346][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:30:23,348][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 19:30:23,354][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:30:23,899][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:30:24,108][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:30:24,111][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:30:24,528][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:30:24,528][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:30:24,528][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:30:24,528][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:30:24,528][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:30:24,531][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:30:24,532][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:30:24,532][dance][wrapped_func] Took 0:00:01.178393 to load and process data.
[WARNING][2024-03-21 19:30:24,541][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:30:24,547][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 19:31:03,730][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=130)
[INFO][2024-03-21 19:31:03,730][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.50%
[INFO][2024-03-21 19:31:03,789][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:31:03,790][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.41221
wandb: 
wandb: üöÄ View run avid-sweep-15 at: https://wandb.ai/xzy11632/dance-dev/runs/ykfhk0io
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_193015-ykfhk0io/logs
wandb: Agent Starting Run: 7vr1ikrs with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_193119-7vr1ikrs
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run polar-sweep-16
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/7vr1ikrs
[INFO][2024-03-21 19:31:28,250][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:31:28,251][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:31:28,252][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellPCA',
 None][0m
[INFO][2024-03-21 19:31:28,257][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:31:28,810][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:31:29,061][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:31:29,065][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:31:29,289][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:31:29,290][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:31:29,290][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:31:29,291][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:31:29,291][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:31:29,293][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:31:29,294][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:31:29,294][dance][wrapped_func] Took 0:00:01.037892 to load and process data.
[WARNING][2024-03-21 19:31:29,307][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:31:29,315][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[INFO][2024-03-21 19:31:46,628][dance.CellPCA][__call__] Generating cell PCA features (466, 4813) (k=319)
[INFO][2024-03-21 19:31:46,629][dance.CellPCA][__call__] Top 10 explained variances: [0.030978   0.02128178 0.01893844 0.01510893 0.01326037 0.00987826
 0.0080045  0.00720455 0.00662593 0.0065151 ]
[INFO][2024-03-21 19:31:46,629][dance.CellPCA][__call__] Total explained variance: 90.06%
[INFO][2024-03-21 19:31:46,631][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:31:46,631][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.51515
wandb:  test_acc 0.35507
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run polar-sweep-16 at: https://wandb.ai/xzy11632/dance-dev/runs/7vr1ikrs
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_193119-7vr1ikrs/logs
wandb: Agent Starting Run: tih8k2v1 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_193207-tih8k2v1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run legendary-sweep-17
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/tih8k2v1
[INFO][2024-03-21 19:32:20,694][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:32:20,694][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:32:20,696][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellSVD',
 None][0m
[INFO][2024-03-21 19:32:20,739][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:32:22,427][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:32:23,168][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:32:23,194][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:32:23,931][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:32:23,937][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:32:23,938][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:32:23,938][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:32:23,939][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:32:23,943][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:32:23,944][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:32:23,944][dance][wrapped_func] Took 0:00:03.206075 to load and process data.
[WARNING][2024-03-21 19:32:23,986][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:32:24,013][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[INFO][2024-03-21 19:34:47,524][dance.CellSVD][__call__] Generating cell SVD features (466, 4813) (k=320)
[INFO][2024-03-21 19:34:47,543][dance.CellSVD][__call__] Top 10 explained variances: [0.02624549 0.02203661 0.01910841 0.01534144 0.01329419 0.01026991
 0.00801324 0.00721135 0.00718455 0.00655313]
[INFO][2024-03-21 19:34:47,545][dance.CellSVD][__call__] Total explained variance: 89.92%
[INFO][2024-03-21 19:34:47,547][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:34:47,551][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.021 MB of 0.025 MB uploadedwandb: \ 0.021 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.45455
wandb:  test_acc 0.26087
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run legendary-sweep-17 at: https://wandb.ai/xzy11632/dance-dev/runs/tih8k2v1
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_193207-tih8k2v1/logs
wandb: Agent Starting Run: mm71lnyw with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_193506-mm71lnyw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run helpful-sweep-18
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/mm71lnyw
[INFO][2024-03-21 19:35:15,279][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:35:15,279][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:35:15,281][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 19:35:15,286][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:35:15,868][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:35:16,096][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:35:16,100][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:35:16,339][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:35:16,340][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:35:16,340][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:35:16,340][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:35:16,340][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:35:16,342][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:35:16,343][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:35:16,343][dance][wrapped_func] Took 0:00:01.057125 to load and process data.
[WARNING][2024-03-21 19:35:16,356][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 19:35:16,357][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 19:35:16,357][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:35:16,372][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 19:35:17,579][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 19:35:17,580][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 19:35:17,851][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:35:17,851][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.69697
wandb:  test_acc 0.54348
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run helpful-sweep-18 at: https://wandb.ai/xzy11632/dance-dev/runs/mm71lnyw
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_193506-mm71lnyw/logs
wandb: Agent Starting Run: 1yjth4mn with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_193540-1yjth4mn
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run twilight-sweep-19
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/1yjth4mn
[INFO][2024-03-21 19:35:51,471][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:35:51,472][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:35:51,475][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 19:35:51,481][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:35:52,188][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:35:52,374][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:35:52,377][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:35:52,595][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:35:52,596][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:35:52,596][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:35:52,596][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:35:52,597][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:35:52,599][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:35:52,600][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:35:52,600][dance][wrapped_func] Took 0:00:01.119563 to load and process data.
[WARNING][2024-03-21 19:35:52,609][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:35:52,616][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[INFO][2024-03-21 19:35:55,828][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 4813) (k=190)
[INFO][2024-03-21 19:35:55,835][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.13%
[INFO][2024-03-21 19:35:55,998][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:35:55,999][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.56061
wandb:  test_acc 0.15942
wandb: train_acc 0.75573
wandb: 
wandb: üöÄ View run twilight-sweep-19 at: https://wandb.ai/xzy11632/dance-dev/runs/1yjth4mn
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_193540-1yjth4mn/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: vsizkly1 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_193619-vsizkly1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wise-sweep-20
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/vsizkly1
[INFO][2024-03-21 19:36:28,451][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:36:28,452][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:36:28,453][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 19:36:28,458][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:36:29,049][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:36:29,226][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:36:29,229][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:36:29,423][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:36:29,424][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:36:29,424][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:36:29,425][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:36:29,425][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:36:29,427][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:36:29,428][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:36:29,428][dance][wrapped_func] Took 0:00:00.970066 to load and process data.
[WARNING][2024-03-21 19:36:29,436][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:36:29,442][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[INFO][2024-03-21 19:36:48,178][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 4813) (k=193)
[INFO][2024-03-21 19:36:48,180][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.58%
[INFO][2024-03-21 19:36:48,257][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:36:48,257][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.015 MB of 0.025 MB uploadedwandb: - 0.015 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.57576
wandb:  test_acc 0.14493
wandb: train_acc 0.79008
wandb: 
wandb: üöÄ View run wise-sweep-20 at: https://wandb.ai/xzy11632/dance-dev/runs/vsizkly1
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_193619-vsizkly1/logs
wandb: Agent Starting Run: vr5otw2e with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_193705-vr5otw2e
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run smooth-sweep-21
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/vr5otw2e
[INFO][2024-03-21 19:37:12,036][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:37:12,037][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:37:12,039][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellPCA',
 None][0m
[INFO][2024-03-21 19:37:12,044][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:37:12,370][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:37:12,524][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:37:12,528][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:37:12,699][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:37:12,699][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:37:12,699][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:37:12,699][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:37:12,699][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:37:12,701][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:37:12,701][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:37:12,701][dance][wrapped_func] Took 0:00:00.657053 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 19:37:12,709][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:37:12,713][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[INFO][2024-03-21 19:37:14,038][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=254)
[INFO][2024-03-21 19:37:14,038][dance.CellPCA][__call__] Top 10 explained variances: [0.08691587 0.05630874 0.05112346 0.03591548 0.01923113 0.01752405
 0.01365106 0.01165026 0.00850422 0.00738007]
[INFO][2024-03-21 19:37:14,039][dance.CellPCA][__call__] Total explained variance: 90.01%
[INFO][2024-03-21 19:37:14,039][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:37:14,040][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.69697
wandb:  test_acc 0.50725
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run smooth-sweep-21 at: https://wandb.ai/xzy11632/dance-dev/runs/vr5otw2e
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_193705-vr5otw2e/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: nja1jvbt with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_193735-nja1jvbt
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run clear-sweep-22
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/nja1jvbt
[INFO][2024-03-21 19:37:41,605][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:37:41,605][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:37:41,607][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellSVD',
 None][0m
[INFO][2024-03-21 19:37:41,613][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:37:42,304][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:37:42,576][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:37:42,581][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:37:42,891][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:37:42,892][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:37:42,892][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:37:42,892][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:37:42,893][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:37:42,895][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:37:42,896][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:37:42,897][dance][wrapped_func] Took 0:00:01.284113 to load and process data.
[WARNING][2024-03-21 19:37:42,910][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:37:42,918][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[INFO][2024-03-21 19:40:00,432][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=255)
[INFO][2024-03-21 19:40:00,434][dance.CellSVD][__call__] Top 10 explained variances: [0.06333642 0.06670894 0.05285758 0.03838715 0.02516376 0.0176874
 0.01374676 0.01170967 0.00863553 0.00756309]
[INFO][2024-03-21 19:40:00,434][dance.CellSVD][__call__] Total explained variance: 89.94%
[INFO][2024-03-21 19:40:00,435][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:40:00,435][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.66667
wandb:  test_acc 0.48551
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run clear-sweep-22 at: https://wandb.ai/xzy11632/dance-dev/runs/nja1jvbt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_193735-nja1jvbt/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: u905grqz with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_194025-u905grqz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run swift-sweep-23
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/u905grqz
[INFO][2024-03-21 19:40:36,153][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:40:36,153][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:40:36,155][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 19:40:36,160][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:40:36,962][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:40:37,286][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:40:37,297][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:40:37,668][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:40:37,668][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:40:37,669][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:40:37,669][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:40:37,669][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:40:37,671][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:40:37,672][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:40:37,672][dance][wrapped_func] Took 0:00:01.512540 to load and process data.
[WARNING][2024-03-21 19:40:37,691][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 19:40:37,692][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 19:40:37,692][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:40:37,698][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 19:40:38,889][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 19:40:38,890][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 19:40:38,974][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:40:38,976][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.78788
wandb:  test_acc 0.78986
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run swift-sweep-23 at: https://wandb.ai/xzy11632/dance-dev/runs/u905grqz
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_194025-u905grqz/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: rbo2r76t with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_194104-rbo2r76t
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run stoic-sweep-24
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/rbo2r76t
[INFO][2024-03-21 19:41:16,422][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:41:16,441][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:41:16,443][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 19:41:16,452][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:41:17,441][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:41:17,709][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:41:17,712][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:41:18,003][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:41:18,003][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:41:18,003][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:41:18,003][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:41:18,003][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:41:18,005][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:41:18,006][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:41:18,006][dance][wrapped_func] Took 0:00:01.554632 to load and process data.
[WARNING][2024-03-21 19:41:18,040][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:41:18,052][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[INFO][2024-03-21 19:41:27,628][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=152)
[INFO][2024-03-21 19:41:27,634][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.08%
[INFO][2024-03-21 19:41:27,679][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:41:27,686][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.72727
wandb:  test_acc 0.54348
wandb: train_acc 0.87405
wandb: 
wandb: üöÄ View run stoic-sweep-24 at: https://wandb.ai/xzy11632/dance-dev/runs/rbo2r76t
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_194104-rbo2r76t/logs
wandb: Agent Starting Run: d5qk1k5r with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_194147-d5qk1k5r
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lyric-sweep-25
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/d5qk1k5r
[INFO][2024-03-21 19:41:56,073][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:41:56,073][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:41:56,074][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 19:41:56,079][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:41:57,167][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:41:57,527][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:41:57,530][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:41:57,885][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:41:57,885][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:41:57,886][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:41:57,886][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:41:57,886][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:41:57,888][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:41:57,889][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:41:57,889][dance][wrapped_func] Took 0:00:01.809896 to load and process data.
[WARNING][2024-03-21 19:41:57,898][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:41:57,904][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[INFO][2024-03-21 19:43:13,196][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=167)
[INFO][2024-03-21 19:43:13,197][dance.WeightedFeatureSVD][__call__] Total explained variance: 92.09%
[INFO][2024-03-21 19:43:13,253][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:43:13,253][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.72727
wandb:  test_acc 0.60145
wandb: train_acc 0.87023
wandb: 
wandb: üöÄ View run lyric-sweep-25 at: https://wandb.ai/xzy11632/dance-dev/runs/d5qk1k5r
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_194147-d5qk1k5r/logs
wandb: Agent Starting Run: elo4ce2u with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_194337-elo4ce2u
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run bumbling-sweep-26
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/elo4ce2u
[INFO][2024-03-21 19:43:45,960][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:43:45,960][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:43:45,962][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'CellPCA',
 None][0m
[INFO][2024-03-21 19:43:45,977][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:43:47,068][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:43:47,344][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:43:47,348][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:43:47,553][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:43:47,554][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:43:47,554][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:43:47,554][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:43:47,555][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:43:47,557][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:43:47,557][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:43:47,558][dance][wrapped_func] Took 0:00:01.580890 to load and process data.
[WARNING][2024-03-21 19:43:47,568][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:43:47,575][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-21 19:44:28,493][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=250)
[INFO][2024-03-21 19:44:28,494][dance.CellPCA][__call__] Top 10 explained variances: [0.11698209 0.08996756 0.054926   0.03348333 0.02607505 0.0160925
 0.01511195 0.01246669 0.01013604 0.00799843]
[INFO][2024-03-21 19:44:28,494][dance.CellPCA][__call__] Total explained variance: 90.03%
[INFO][2024-03-21 19:44:28,496][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:44:28,496][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.72727
wandb:  test_acc 0.67391
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run bumbling-sweep-26 at: https://wandb.ai/xzy11632/dance-dev/runs/elo4ce2u
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_194337-elo4ce2u/logs
wandb: Agent Starting Run: mjnbwvh9 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_194448-mjnbwvh9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run feasible-sweep-27
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/mjnbwvh9
[INFO][2024-03-21 19:44:58,595][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:44:58,595][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:44:58,597][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'CellSVD',
 None][0m
[INFO][2024-03-21 19:44:58,608][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:44:59,676][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:45:00,281][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:45:00,290][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:45:00,519][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:45:00,519][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:45:00,520][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:45:00,520][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:45:00,520][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:45:00,522][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:45:00,523][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:45:00,523][dance][wrapped_func] Took 0:00:01.915301 to load and process data.
[WARNING][2024-03-21 19:45:00,535][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:45:00,542][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-21 19:47:21,653][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=251)
[INFO][2024-03-21 19:47:21,654][dance.CellSVD][__call__] Top 10 explained variances: [0.09634817 0.09007901 0.05542665 0.04647222 0.02862464 0.01610904
 0.01511303 0.01247685 0.01041746 0.00805582]
[INFO][2024-03-21 19:47:21,654][dance.CellSVD][__call__] Total explained variance: 89.94%
[INFO][2024-03-21 19:47:21,656][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:47:21,656][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.72727
wandb:  test_acc 0.62319
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run feasible-sweep-27 at: https://wandb.ai/xzy11632/dance-dev/runs/mjnbwvh9
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_194448-mjnbwvh9/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: hz5rtxt5 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_194746-hz5rtxt5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run elated-sweep-28
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/hz5rtxt5
[INFO][2024-03-21 19:47:59,316][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:47:59,317][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:47:59,318][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 19:47:59,344][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:48:00,697][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:48:01,115][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:48:01,141][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:48:01,679][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:48:01,679][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:48:01,679][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:48:01,679][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:48:01,679][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:48:01,682][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:48:01,683][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:48:01,683][dance][wrapped_func] Took 0:00:02.339576 to load and process data.
[WARNING][2024-03-21 19:48:01,721][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 19:48:01,722][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 19:48:01,723][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:48:01,748][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-21 19:48:02,943][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 19:48:02,943][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 19:48:03,075][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:48:03,076][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.026 MB uploadedwandb: \ 0.018 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.77273
wandb:  test_acc 0.80435
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run elated-sweep-28 at: https://wandb.ai/xzy11632/dance-dev/runs/hz5rtxt5
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_194746-hz5rtxt5/logs
wandb: Agent Starting Run: bcdpvx4e with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: W&B API key is configured. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_194828-bcdpvx4e
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run valiant-sweep-29
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/bcdpvx4e
[INFO][2024-03-21 19:48:37,152][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:48:37,153][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:48:37,154][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 19:48:37,180][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:48:37,747][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:48:37,968][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:48:37,972][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:48:38,215][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:48:38,216][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:48:38,216][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:48:38,216][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:48:38,216][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:48:38,218][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:48:38,219][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:48:38,220][dance][wrapped_func] Took 0:00:01.040265 to load and process data.
[WARNING][2024-03-21 19:48:38,235][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:48:38,241][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-21 19:48:40,224][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=135)
[INFO][2024-03-21 19:48:40,224][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.02%
[INFO][2024-03-21 19:48:40,372][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:48:40,373][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.71212
wandb:  test_acc 0.69565
wandb: train_acc 0.85878
wandb: 
wandb: üöÄ View run valiant-sweep-29 at: https://wandb.ai/xzy11632/dance-dev/runs/bcdpvx4e
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_194828-bcdpvx4e/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: q1qw34ns with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_194903-q1qw34ns
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run floral-sweep-30
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/q1qw34ns
[INFO][2024-03-21 19:49:11,368][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:49:11,369][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:49:11,370][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 19:49:11,383][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:49:12,267][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:49:12,700][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:49:12,703][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:49:12,980][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:49:12,980][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:49:12,981][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:49:12,981][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:49:12,981][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:49:12,983][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:49:12,984][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:49:12,984][dance][wrapped_func] Took 0:00:01.601745 to load and process data.
[WARNING][2024-03-21 19:49:12,999][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:49:13,005][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-21 19:50:30,809][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=164)
[INFO][2024-03-21 19:50:30,810][dance.WeightedFeatureSVD][__call__] Total explained variance: 93.35%
[INFO][2024-03-21 19:50:30,856][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:50:30,856][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.71212
wandb:  test_acc 0.61594
wandb: train_acc 0.85496
wandb: 
wandb: üöÄ View run floral-sweep-30 at: https://wandb.ai/xzy11632/dance-dev/runs/q1qw34ns
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_194903-q1qw34ns/logs
wandb: Agent Starting Run: zylrzru5 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_195049-zylrzru5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run splendid-sweep-31
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/zylrzru5
[INFO][2024-03-21 19:50:58,704][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:50:58,704][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:50:58,706][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'FilterGenesNumberPlaceHolder',
 'CellPCA',
 None][0m
[INFO][2024-03-21 19:50:58,710][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:50:59,388][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:50:59,650][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:50:59,654][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:50:59,889][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:50:59,890][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:50:59,890][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:50:59,890][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:50:59,890][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:50:59,892][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:50:59,893][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:50:59,893][dance][wrapped_func] Took 0:00:01.183349 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 19:50:59,903][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 19:50:59,904][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 19:50:59,904][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:50:59,911][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 19:51:00,054][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 19:51:00,055][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 19:51:41,199][dance.CellPCA][__call__] Generating cell PCA features (466, 21867) (k=274)
[INFO][2024-03-21 19:51:41,200][dance.CellPCA][__call__] Top 10 explained variances: [0.05908213 0.04292385 0.03186836 0.01887885 0.01708423 0.01578213
 0.01421802 0.01313262 0.0101546  0.00916899]
[INFO][2024-03-21 19:51:41,200][dance.CellPCA][__call__] Total explained variance: 90.08%
[INFO][2024-03-21 19:51:41,202][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:51:41,202][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.45455
wandb:  test_acc 0.31884
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run splendid-sweep-31 at: https://wandb.ai/xzy11632/dance-dev/runs/zylrzru5
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_195049-zylrzru5/logs
wandb: Agent Starting Run: wwo7j15c with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_195206-wwo7j15c
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run super-sweep-32
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/wwo7j15c
[INFO][2024-03-21 19:52:15,911][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:52:15,912][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:52:15,913][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'FilterGenesNumberPlaceHolder',
 'CellSVD',
 None][0m
[INFO][2024-03-21 19:52:15,918][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:52:16,657][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:52:16,949][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:52:16,954][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:52:17,350][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:52:17,351][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:52:17,351][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:52:17,351][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:52:17,352][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:52:17,354][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:52:17,355][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:52:17,356][dance][wrapped_func] Took 0:00:01.437550 to load and process data.
[WARNING][2024-03-21 19:52:17,365][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 19:52:17,366][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 19:52:17,366][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:52:17,376][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 19:52:17,498][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 19:52:17,500][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 19:55:23,667][dance.CellSVD][__call__] Generating cell SVD features (466, 21867) (k=274)
[INFO][2024-03-21 19:55:23,669][dance.CellSVD][__call__] Top 10 explained variances: [0.05182417 0.04293025 0.03260317 0.02039106 0.0177555  0.01619443
 0.01423499 0.01373062 0.01021244 0.00923451]
[INFO][2024-03-21 19:55:23,670][dance.CellSVD][__call__] Total explained variance: 89.89%
[INFO][2024-03-21 19:55:23,674][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:55:23,674][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.013 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.42424
wandb:  test_acc 0.41304
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run super-sweep-32 at: https://wandb.ai/xzy11632/dance-dev/runs/wwo7j15c
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_195206-wwo7j15c/logs
wandb: Agent Starting Run: p5p0i6o0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_195537-p5p0i6o0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run giddy-sweep-33
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/p5p0i6o0
[INFO][2024-03-21 19:55:52,169][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:55:52,169][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:55:52,170][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'FilterGenesNumberPlaceHolder',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 19:55:52,175][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:55:53,396][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:55:54,014][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:55:54,031][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:55:54,604][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:55:54,605][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:55:54,606][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:55:54,606][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:55:54,606][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:55:54,609][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:55:54,613][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:55:54,614][dance][wrapped_func] Took 0:00:02.439465 to load and process data.
[WARNING][2024-03-21 19:55:54,647][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 19:55:54,647][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 19:55:54,647][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 19:55:54,647][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 19:55:54,648][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:55:54,702][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 19:55:55,013][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 19:55:55,013][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 19:55:55,013][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 19:55:55,014][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 19:56:00,165][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:56:00,166][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.78788
wandb:  test_acc 0.74638
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run giddy-sweep-33 at: https://wandb.ai/xzy11632/dance-dev/runs/p5p0i6o0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_195537-p5p0i6o0/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: s6y7xesh with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_195630-s6y7xesh
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run clean-sweep-34
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/s6y7xesh
[INFO][2024-03-21 19:56:48,418][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:56:48,418][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:56:48,420][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 19:56:48,435][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:56:49,250][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:56:49,581][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:56:49,588][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:56:49,938][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:56:49,938][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:56:49,948][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:56:49,949][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:56:49,949][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:56:49,951][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:56:49,952][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:56:49,952][dance][wrapped_func] Took 0:00:01.516745 to load and process data.
[WARNING][2024-03-21 19:56:49,974][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 19:56:49,975][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 19:56:49,975][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:56:49,993][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 19:56:50,185][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 19:56:50,186][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 19:57:10,029][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 21867) (k=146)
[INFO][2024-03-21 19:57:10,030][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.04%
[INFO][2024-03-21 19:57:10,180][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:57:10,189][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.83333
wandb:  test_acc 0.78986
wandb: train_acc 0.9771
wandb: 
wandb: üöÄ View run clean-sweep-34 at: https://wandb.ai/xzy11632/dance-dev/runs/s6y7xesh
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_195630-s6y7xesh/logs
wandb: Agent Starting Run: 195jgru0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_195728-195jgru0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run atomic-sweep-35
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/195jgru0
[INFO][2024-03-21 19:57:38,242][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:57:38,242][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:57:38,244][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 19:57:38,252][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:57:39,161][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:57:39,665][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:57:39,669][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:57:39,968][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:57:39,968][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:57:39,969][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:57:39,969][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:57:39,969][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:57:39,972][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:57:39,972][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:57:39,973][dance][wrapped_func] Took 0:00:01.720636 to load and process data.
[WARNING][2024-03-21 19:57:39,983][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 19:57:39,984][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 19:57:39,984][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:57:39,992][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 19:57:40,080][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 19:57:40,081][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 19:59:15,954][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 21867) (k=154)
[INFO][2024-03-21 19:59:15,956][dance.WeightedFeatureSVD][__call__] Total explained variance: 91.27%
[INFO][2024-03-21 19:59:16,082][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 19:59:16,083][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.013 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.68116
wandb: train_acc 0.9771
wandb: 
wandb: üöÄ View run atomic-sweep-35 at: https://wandb.ai/xzy11632/dance-dev/runs/195jgru0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_195728-195jgru0/logs
wandb: Agent Starting Run: ldcc3ou0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_195937-ldcc3ou0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run valiant-sweep-36
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ldcc3ou0
[INFO][2024-03-21 19:59:53,069][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 19:59:53,069][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 19:59:53,071][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'CellPCA',
 None][0m
[INFO][2024-03-21 19:59:53,090][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 19:59:54,145][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 19:59:54,707][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 19:59:54,717][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 19:59:55,267][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 19:59:55,283][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 19:59:55,283][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 19:59:55,284][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 19:59:55,284][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 19:59:55,287][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 19:59:55,289][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 19:59:55,290][dance][wrapped_func] Took 0:00:02.200729 to load and process data.
[WARNING][2024-03-21 19:59:55,313][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 19:59:55,321][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 19:59:55,328][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 19:59:55,553][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 19:59:55,768][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 20:00:59,122][dance.CellPCA][__call__] Generating cell PCA features (466, 21867) (k=274)
[INFO][2024-03-21 20:00:59,123][dance.CellPCA][__call__] Top 10 explained variances: [0.05908213 0.04292385 0.03186836 0.01887885 0.01708423 0.01578213
 0.01421802 0.01313262 0.0101546  0.00916899]
[INFO][2024-03-21 20:00:59,123][dance.CellPCA][__call__] Total explained variance: 90.08%
[INFO][2024-03-21 20:00:59,124][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:00:59,124][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.45455
wandb:  test_acc 0.31884
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run valiant-sweep-36 at: https://wandb.ai/xzy11632/dance-dev/runs/ldcc3ou0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_195937-ldcc3ou0/logs
wandb: Agent Starting Run: w6vxlkdd with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_200119-w6vxlkdd
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run effortless-sweep-37
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/w6vxlkdd
[INFO][2024-03-21 20:01:35,988][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:01:35,989][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:01:35,990][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'CellSVD',
 None][0m
[INFO][2024-03-21 20:01:36,023][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:01:37,126][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:01:37,417][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:01:37,421][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:01:38,081][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:01:38,081][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:01:38,082][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:01:38,082][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:01:38,082][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:01:38,084][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:01:38,084][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:01:38,084][dance][wrapped_func] Took 0:00:02.061929 to load and process data.
[WARNING][2024-03-21 20:01:38,094][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:01:38,095][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:01:38,115][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:01:38,313][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:01:38,623][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 20:05:09,505][dance.CellSVD][__call__] Generating cell SVD features (466, 21867) (k=274)
[INFO][2024-03-21 20:05:09,507][dance.CellSVD][__call__] Top 10 explained variances: [0.05182417 0.04293025 0.03260317 0.02039106 0.0177555  0.01619443
 0.01423499 0.01373062 0.01021244 0.00923451]
[INFO][2024-03-21 20:05:09,507][dance.CellSVD][__call__] Total explained variance: 89.89%
[INFO][2024-03-21 20:05:09,508][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:05:09,509][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.018 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.42424
wandb:  test_acc 0.41304
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run effortless-sweep-37 at: https://wandb.ai/xzy11632/dance-dev/runs/w6vxlkdd
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_200119-w6vxlkdd/logs
wandb: Agent Starting Run: wrxwldz9 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_200528-wrxwldz9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run clean-sweep-38
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/wrxwldz9
[INFO][2024-03-21 20:05:42,015][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:05:42,016][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:05:42,018][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 20:05:42,024][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:05:42,709][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:05:42,879][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:05:42,882][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:05:43,150][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:05:43,150][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:05:43,150][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:05:43,150][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:05:43,150][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:05:43,152][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:05:43,153][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:05:43,153][dance][wrapped_func] Took 0:00:01.129632 to load and process data.
[WARNING][2024-03-21 20:05:43,163][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:05:43,164][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:05:43,164][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 20:05:43,164][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:05:43,172][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:05:43,264][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:05:43,462][dance][_filter_enclasc] Start generating cell features using EnClaSC
[WARNING][2024-03-21 20:05:43,493][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:05:43,493][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 20:05:46,130][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:05:46,130][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.78788
wandb:  test_acc 0.74638
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run clean-sweep-38 at: https://wandb.ai/xzy11632/dance-dev/runs/wrxwldz9
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_200528-wrxwldz9/logs
wandb: Agent Starting Run: c7zthm74 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_200608-c7zthm74
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run balmy-sweep-39
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/c7zthm74
[INFO][2024-03-21 20:06:19,135][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:06:19,145][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:06:19,147][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 20:06:19,155][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:06:19,996][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:06:20,390][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:06:20,402][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:06:21,045][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:06:21,047][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:06:21,047][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:06:21,048][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:06:21,048][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:06:21,051][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:06:21,052][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:06:21,052][dance][wrapped_func] Took 0:00:01.897320 to load and process data.
[WARNING][2024-03-21 20:06:21,063][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:06:21,064][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:06:21,071][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:06:21,217][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:06:21,460][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 20:06:29,374][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 21867) (k=146)
[INFO][2024-03-21 20:06:29,381][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.04%
[INFO][2024-03-21 20:06:29,708][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:06:29,709][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.013 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.83333
wandb:  test_acc 0.78986
wandb: train_acc 0.9771
wandb: 
wandb: üöÄ View run balmy-sweep-39 at: https://wandb.ai/xzy11632/dance-dev/runs/c7zthm74
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_200608-c7zthm74/logs
wandb: Agent Starting Run: 6fz3v2ui with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_200648-6fz3v2ui
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run youthful-sweep-40
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/6fz3v2ui
[INFO][2024-03-21 20:07:04,072][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:07:04,073][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:07:04,075][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 20:07:04,080][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:07:04,923][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:07:05,106][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:07:05,110][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:07:05,483][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:07:05,484][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:07:05,484][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:07:05,484][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:07:05,485][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:07:05,487][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:07:05,488][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:07:05,488][dance][wrapped_func] Took 0:00:01.408066 to load and process data.
[WARNING][2024-03-21 20:07:05,499][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:07:05,500][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:07:05,507][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:07:05,637][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:07:05,815][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 20:08:46,564][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 21867) (k=154)
[INFO][2024-03-21 20:08:46,571][dance.WeightedFeatureSVD][__call__] Total explained variance: 91.27%
[INFO][2024-03-21 20:08:46,745][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:08:46,750][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.68116
wandb: train_acc 0.9771
wandb: 
wandb: üöÄ View run youthful-sweep-40 at: https://wandb.ai/xzy11632/dance-dev/runs/6fz3v2ui
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_200648-6fz3v2ui/logs
wandb: Agent Starting Run: 3pv68ftv with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_200906-3pv68ftv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run eager-sweep-41
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/3pv68ftv
[INFO][2024-03-21 20:09:17,386][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:09:17,386][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:09:17,388][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'CellPCA',
 None][0m
[INFO][2024-03-21 20:09:17,400][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:09:18,504][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:09:18,818][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:09:18,823][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:09:19,298][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:09:19,298][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:09:19,299][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:09:19,299][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:09:19,299][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:09:19,301][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:09:19,302][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:09:19,302][dance][wrapped_func] Took 0:00:01.902436 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 20:09:19,314][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:09:19,315][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:09:19,322][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:09:19,436][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 20:09:25,414][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=55)
[INFO][2024-03-21 20:09:25,415][dance.CellPCA][__call__] Top 10 explained variances: [0.16844612 0.1322545  0.09476218 0.06954926 0.04885819 0.03440032
 0.03236063 0.02847997 0.02214933 0.01987045]
[INFO][2024-03-21 20:09:25,415][dance.CellPCA][__call__] Total explained variance: 90.03%
[INFO][2024-03-21 20:09:25,416][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:09:25,416][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.34848
wandb:  test_acc 0.10145
wandb: train_acc 0.56107
wandb: 
wandb: üöÄ View run eager-sweep-41 at: https://wandb.ai/xzy11632/dance-dev/runs/3pv68ftv
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_200906-3pv68ftv/logs
wandb: Agent Starting Run: 8tkb3904 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_200947-8tkb3904
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run volcanic-sweep-42
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/8tkb3904
[INFO][2024-03-21 20:10:03,555][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:10:03,555][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:10:03,558][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'CellSVD',
 None][0m
[INFO][2024-03-21 20:10:03,563][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:10:04,681][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:10:05,124][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:10:05,127][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:10:05,588][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:10:05,613][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:10:05,613][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:10:05,613][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:10:05,614][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:10:05,617][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:10:05,617][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:10:05,618][dance][wrapped_func] Took 0:00:02.055281 to load and process data.
[WARNING][2024-03-21 20:10:05,651][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:10:05,656][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:10:05,663][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:10:05,867][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 20:12:12,886][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=55)
[INFO][2024-03-21 20:12:12,893][dance.CellSVD][__call__] Top 10 explained variances: [0.1684352  0.13225268 0.09476031 0.06954776 0.04885579 0.03439301
 0.03236081 0.02847993 0.02214614 0.01986784]
[INFO][2024-03-21 20:12:12,894][dance.CellSVD][__call__] Total explained variance: 90.00%
[INFO][2024-03-21 20:12:12,895][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:12:12,895][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.31818
wandb:  test_acc 0.0942
wandb: train_acc 0.5916
wandb: 
wandb: üöÄ View run volcanic-sweep-42 at: https://wandb.ai/xzy11632/dance-dev/runs/8tkb3904
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_200947-8tkb3904/logs
wandb: Agent Starting Run: y753ts80 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_201230-y753ts80
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run stellar-sweep-43
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/y753ts80
[INFO][2024-03-21 20:12:38,371][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:12:38,372][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:12:38,373][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 20:12:38,378][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:12:39,183][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:12:39,469][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:12:39,527][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:12:39,940][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:12:39,940][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:12:39,940][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:12:39,940][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:12:39,940][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:12:39,956][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:12:39,956][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:12:39,956][dance][wrapped_func] Took 0:00:01.578824 to load and process data.
[WARNING][2024-03-21 20:12:39,990][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:12:39,990][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:12:39,990][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 20:12:39,991][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:12:40,004][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:12:40,214][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[WARNING][2024-03-21 20:12:40,337][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:12:40,337][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 20:12:40,496][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:12:40,500][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.34848
wandb:  test_acc 0.16667
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run stellar-sweep-43 at: https://wandb.ai/xzy11632/dance-dev/runs/y753ts80
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_201230-y753ts80/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: r9zql5w8 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_201308-r9zql5w8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run light-sweep-44
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/r9zql5w8
[INFO][2024-03-21 20:13:29,530][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:13:29,530][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:13:29,532][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 20:13:29,539][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:13:31,371][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:13:31,789][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:13:31,792][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:13:32,431][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:13:32,432][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:13:32,432][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:13:32,432][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:13:32,432][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:13:32,434][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:13:32,435][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:13:32,435][dance][wrapped_func] Took 0:00:02.896408 to load and process data.
[WARNING][2024-03-21 20:13:32,466][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:13:32,467][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:13:32,473][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:13:32,817][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 20:13:39,256][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=36)
[INFO][2024-03-21 20:13:39,263][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.08%
[INFO][2024-03-21 20:13:39,313][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:13:39,314][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.25758
wandb:  test_acc 0.0942
wandb: train_acc 0.54198
wandb: 
wandb: üöÄ View run light-sweep-44 at: https://wandb.ai/xzy11632/dance-dev/runs/r9zql5w8
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_201308-r9zql5w8/logs
wandb: Agent Starting Run: bvcyt443 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_201358-bvcyt443
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run soft-sweep-45
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/bvcyt443
[INFO][2024-03-21 20:14:10,420][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:14:10,420][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:14:10,421][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 20:14:10,426][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:14:11,681][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:14:12,064][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:14:12,095][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:14:12,674][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:14:12,690][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:14:12,691][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:14:12,691][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:14:12,691][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:14:12,693][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:14:12,693][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:14:12,694][dance][wrapped_func] Took 0:00:02.267373 to load and process data.
[WARNING][2024-03-21 20:14:12,734][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:14:12,735][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:14:12,742][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:14:12,991][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 20:15:06,898][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=36)
[INFO][2024-03-21 20:15:06,899][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.07%
[INFO][2024-03-21 20:15:07,013][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:15:07,014][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.25758
wandb:  test_acc 0.1087
wandb: train_acc 0.5687
wandb: 
wandb: üöÄ View run soft-sweep-45 at: https://wandb.ai/xzy11632/dance-dev/runs/bvcyt443
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_201358-bvcyt443/logs
wandb: Agent Starting Run: dlwy8sqj with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_201522-dlwy8sqj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run comic-sweep-46
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/dlwy8sqj
[INFO][2024-03-21 20:15:30,000][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:15:30,001][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:15:30,002][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellPCA',
 None][0m
[INFO][2024-03-21 20:15:30,006][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:15:30,651][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:15:30,805][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:15:30,809][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:15:31,012][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:15:31,013][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:15:31,013][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:15:31,013][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:15:31,013][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:15:31,015][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:15:31,016][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:15:31,016][dance][wrapped_func] Took 0:00:01.009985 to load and process data.
[WARNING][2024-03-21 20:15:31,028][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:15:31,029][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:15:31,037][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:15:31,156][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run comic-sweep-46 at: https://wandb.ai/xzy11632/dance-dev/runs/dlwy8sqj
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_201522-dlwy8sqj/logs
wandb: ERROR Run dlwy8sqj errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: 85tr37fl with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_201548-85tr37fl
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run clear-sweep-47
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/85tr37fl
[INFO][2024-03-21 20:15:55,626][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:15:55,626][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:15:55,630][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellSVD',
 None][0m
[INFO][2024-03-21 20:15:55,638][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:15:56,074][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:15:56,333][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:15:56,336][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:15:56,649][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:15:56,649][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:15:56,649][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:15:56,650][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:15:56,650][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:15:56,651][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:15:56,652][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:15:56,652][dance][wrapped_func] Took 0:00:01.014012 to load and process data.
[WARNING][2024-03-21 20:15:56,661][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:15:56,662][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:15:56,669][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:15:56,787][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run clear-sweep-47 at: https://wandb.ai/xzy11632/dance-dev/runs/85tr37fl
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_201548-85tr37fl/logs
wandb: ERROR Run 85tr37fl errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: aw4598c5 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_201610-aw4598c5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ruby-sweep-48
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/aw4598c5
[INFO][2024-03-21 20:16:18,527][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:16:18,527][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:16:18,529][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 20:16:18,548][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:16:19,069][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:16:19,275][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:16:19,279][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:16:19,530][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:16:19,530][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:16:19,531][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:16:19,531][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:16:19,531][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:16:19,533][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:16:19,534][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:16:19,534][dance][wrapped_func] Took 0:00:00.986514 to load and process data.
[WARNING][2024-03-21 20:16:19,544][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:16:19,544][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:16:19,545][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 20:16:19,545][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:16:19,552][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:16:19,637][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run ruby-sweep-48 at: https://wandb.ai/xzy11632/dance-dev/runs/aw4598c5
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_201610-aw4598c5/logs
wandb: ERROR Run aw4598c5 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: x2t6zyd0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_201641-x2t6zyd0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run easy-sweep-49
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/x2t6zyd0
[INFO][2024-03-21 20:16:50,702][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:16:50,702][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:16:50,704][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 20:16:50,709][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:16:51,290][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:16:51,450][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:16:51,453][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:16:51,717][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:16:51,717][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:16:51,717][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:16:51,717][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:16:51,717][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:16:51,719][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:16:51,719][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:16:51,719][dance][wrapped_func] Took 0:00:01.010592 to load and process data.
[WARNING][2024-03-21 20:16:51,729][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:16:51,729][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:16:51,735][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:16:51,871][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.013 MB uploadedwandb: \ 0.012 MB of 0.013 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run easy-sweep-49 at: https://wandb.ai/xzy11632/dance-dev/runs/x2t6zyd0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_201641-x2t6zyd0/logs
wandb: ERROR Run x2t6zyd0 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: jpr4z6q0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_201708-jpr4z6q0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run snowy-sweep-50
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/jpr4z6q0
[INFO][2024-03-21 20:17:15,554][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:17:15,555][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:17:15,556][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 20:17:15,574][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:17:16,125][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:17:16,350][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:17:16,353][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:17:16,608][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:17:16,608][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:17:16,611][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:17:16,611][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:17:16,611][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:17:16,615][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:17:16,616][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:17:16,616][dance][wrapped_func] Took 0:00:01.055968 to load and process data.
[WARNING][2024-03-21 20:17:16,635][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:17:16,636][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:17:16,668][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:17:16,867][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.017 MB of 0.025 MB uploadedwandb: \ 0.017 MB of 0.025 MB uploadedwandb: | 0.017 MB of 0.025 MB uploadedwandb: / 0.017 MB of 0.025 MB uploadedwandb: - 0.021 MB of 0.025 MB uploadedwandb: \ 0.021 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run snowy-sweep-50 at: https://wandb.ai/xzy11632/dance-dev/runs/jpr4z6q0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_201708-jpr4z6q0/logs
wandb: ERROR Run jpr4z6q0 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: t428p93j with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_201735-t428p93j
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run young-sweep-51
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/t428p93j
[INFO][2024-03-21 20:17:42,372][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:17:42,373][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:17:42,384][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellPCA',
 None][0m
[INFO][2024-03-21 20:17:42,406][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:17:43,006][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:17:43,282][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:17:43,285][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:17:43,606][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:17:43,606][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:17:43,606][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:17:43,606][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:17:43,607][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:17:43,609][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:17:43,609][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:17:43,609][dance][wrapped_func] Took 0:00:01.203586 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 20:17:43,620][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:17:43,620][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:17:43,627][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:17:43,754][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run young-sweep-51 at: https://wandb.ai/xzy11632/dance-dev/runs/t428p93j
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_201735-t428p93j/logs
wandb: ERROR Run t428p93j errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: vkkre3o4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_201757-vkkre3o4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run major-sweep-52
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/vkkre3o4
[INFO][2024-03-21 20:18:04,780][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:18:04,781][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:18:04,782][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellSVD',
 None][0m
[INFO][2024-03-21 20:18:04,787][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:18:05,454][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:18:05,699][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:18:05,703][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:18:06,013][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:18:06,013][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:18:06,013][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:18:06,013][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:18:06,013][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:18:06,016][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:18:06,016][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:18:06,016][dance][wrapped_func] Took 0:00:01.229629 to load and process data.
[WARNING][2024-03-21 20:18:06,034][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:18:06,035][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:18:06,041][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:18:06,144][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run major-sweep-52 at: https://wandb.ai/xzy11632/dance-dev/runs/vkkre3o4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_201757-vkkre3o4/logs
wandb: ERROR Run vkkre3o4 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: zem5tyvv with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_201818-zem5tyvv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run spring-sweep-53
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/zem5tyvv
[INFO][2024-03-21 20:18:24,538][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:18:24,539][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:18:24,541][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 20:18:24,546][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:18:24,945][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:18:25,135][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:18:25,139][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:18:25,327][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:18:25,327][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:18:25,327][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:18:25,328][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:18:25,328][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:18:25,329][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:18:25,330][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:18:25,330][dance][wrapped_func] Took 0:00:00.784478 to load and process data.
[WARNING][2024-03-21 20:18:25,338][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:18:25,338][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:18:25,338][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 20:18:25,339][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:18:25,344][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:18:25,432][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run spring-sweep-53 at: https://wandb.ai/xzy11632/dance-dev/runs/zem5tyvv
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_201818-zem5tyvv/logs
wandb: ERROR Run zem5tyvv errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: osizbyp6 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_201839-osizbyp6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run golden-sweep-54
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/osizbyp6
[INFO][2024-03-21 20:18:44,945][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:18:44,945][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:18:44,947][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 20:18:44,952][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:18:45,293][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:18:45,416][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:18:45,419][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:18:45,590][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:18:45,591][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:18:45,591][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:18:45,591][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:18:45,591][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:18:45,593][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:18:45,593][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:18:45,593][dance][wrapped_func] Took 0:00:00.641486 to load and process data.
[WARNING][2024-03-21 20:18:45,601][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:18:45,602][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:18:45,607][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:18:45,688][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.018 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run golden-sweep-54 at: https://wandb.ai/xzy11632/dance-dev/runs/osizbyp6
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_201839-osizbyp6/logs
wandb: ERROR Run osizbyp6 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 9fxld0s5 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_201905-9fxld0s5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run major-sweep-55
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/9fxld0s5
[INFO][2024-03-21 20:19:12,567][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:19:12,568][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:19:12,569][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 20:19:12,574][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:19:12,918][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:19:13,057][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:19:13,060][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:19:13,235][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:19:13,235][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:19:13,235][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:19:13,235][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:19:13,235][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:19:13,236][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:19:13,237][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:19:13,237][dance][wrapped_func] Took 0:00:00.662800 to load and process data.
[WARNING][2024-03-21 20:19:13,243][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:19:13,243][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:19:13,248][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:19:13,329][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run major-sweep-55 at: https://wandb.ai/xzy11632/dance-dev/runs/9fxld0s5
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_201905-9fxld0s5/logs
wandb: ERROR Run 9fxld0s5 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: iyve8h4h with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_201927-iyve8h4h
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run balmy-sweep-56
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/iyve8h4h
[INFO][2024-03-21 20:19:33,076][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:19:33,082][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:19:33,084][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'CellPCA',
 None][0m
[INFO][2024-03-21 20:19:33,089][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:19:33,565][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:19:33,725][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:19:33,727][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:19:33,905][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:19:33,906][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:19:33,906][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:19:33,906][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:19:33,906][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:19:33,908][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:19:33,908][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:19:33,908][dance][wrapped_func] Took 0:00:00.819885 to load and process data.
[WARNING][2024-03-21 20:19:33,917][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:19:33,917][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:19:33,923][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:19:34,005][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:19:43,637][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=177)
[INFO][2024-03-21 20:19:43,644][dance.CellPCA][__call__] Top 10 explained variances: [0.08196966 0.06369064 0.03799973 0.03525763 0.02949587 0.02415994
 0.02162023 0.018137   0.01458214 0.0139874 ]
[INFO][2024-03-21 20:19:43,644][dance.CellPCA][__call__] Total explained variance: 90.07%
[INFO][2024-03-21 20:19:43,645][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:19:43,645][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.63636
wandb:  test_acc 0.43478
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run balmy-sweep-56 at: https://wandb.ai/xzy11632/dance-dev/runs/iyve8h4h
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_201927-iyve8h4h/logs
wandb: Agent Starting Run: fe6lz3rh with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_201956-fe6lz3rh
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run trim-sweep-57
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/fe6lz3rh
[INFO][2024-03-21 20:20:02,291][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:20:02,298][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:20:02,299][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'CellSVD',
 None][0m
[INFO][2024-03-21 20:20:02,310][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:20:02,738][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:20:02,917][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:20:02,921][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:20:03,111][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:20:03,112][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:20:03,112][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:20:03,112][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:20:03,112][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:20:03,113][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:20:03,114][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:20:03,114][dance][wrapped_func] Took 0:00:00.804382 to load and process data.
[WARNING][2024-03-21 20:20:03,122][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:20:03,122][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:20:03,128][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:20:03,209][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:20:37,361][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=177)
[INFO][2024-03-21 20:20:37,369][dance.CellSVD][__call__] Top 10 explained variances: [0.06263579 0.06787915 0.04393432 0.03781378 0.03079172 0.02427398
 0.02179544 0.01945242 0.01491108 0.01399529]
[INFO][2024-03-21 20:20:37,369][dance.CellSVD][__call__] Total explained variance: 89.96%
[INFO][2024-03-21 20:20:37,370][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:20:37,371][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.018 MB of 0.025 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.65152
wandb:  test_acc 0.44928
wandb: train_acc 0.99237
wandb: 
wandb: üöÄ View run trim-sweep-57 at: https://wandb.ai/xzy11632/dance-dev/runs/fe6lz3rh
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_201956-fe6lz3rh/logs
wandb: Agent Starting Run: h4dfqje4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_202051-h4dfqje4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run silver-sweep-58
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/h4dfqje4
[INFO][2024-03-21 20:21:00,630][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:21:00,630][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:21:00,631][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 20:21:00,650][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:21:01,301][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:21:01,581][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:21:01,591][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:21:01,959][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:21:01,960][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:21:01,960][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:21:01,960][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:21:01,960][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:21:01,962][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:21:01,963][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:21:01,963][dance][wrapped_func] Took 0:00:01.326534 to load and process data.
[WARNING][2024-03-21 20:21:01,971][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:21:01,971][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:21:01,971][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 20:21:01,972][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:21:01,979][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:21:02,076][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:21:02,556][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:21:02,556][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 20:21:02,679][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:21:02,679][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.017 MB of 0.026 MB uploadedwandb: \ 0.017 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.80303
wandb:  test_acc 0.47101
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run silver-sweep-58 at: https://wandb.ai/xzy11632/dance-dev/runs/h4dfqje4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_202051-h4dfqje4/logs
wandb: Agent Starting Run: xc5qard7 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_202118-xc5qard7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run hearty-sweep-59
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/xc5qard7
[INFO][2024-03-21 20:21:26,423][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:21:26,424][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:21:26,426][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 20:21:26,431][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:21:26,986][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:21:27,165][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:21:27,168][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:21:27,385][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:21:27,385][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:21:27,386][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:21:27,386][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:21:27,386][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:21:27,388][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:21:27,389][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:21:27,389][dance][wrapped_func] Took 0:00:00.958346 to load and process data.
[WARNING][2024-03-21 20:21:27,400][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:21:27,401][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:21:27,408][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:21:27,502][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:21:29,722][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=103)
[INFO][2024-03-21 20:21:29,725][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.05%
[INFO][2024-03-21 20:21:29,807][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:21:29,808][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.78788
wandb:  test_acc 0.71739
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run hearty-sweep-59 at: https://wandb.ai/xzy11632/dance-dev/runs/xc5qard7
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_202118-xc5qard7/logs
wandb: Agent Starting Run: p0s7952p with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_202144-p0s7952p
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fresh-sweep-60
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/p0s7952p
[INFO][2024-03-21 20:21:52,009][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:21:52,009][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:21:52,010][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 20:21:52,016][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:21:52,518][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:21:52,776][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:21:52,779][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:21:53,077][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:21:53,078][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:21:53,078][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:21:53,078][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:21:53,079][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:21:53,081][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:21:53,081][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:21:53,082][dance][wrapped_func] Took 0:00:01.066083 to load and process data.
[WARNING][2024-03-21 20:21:53,089][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:21:53,089][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:21:53,095][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:21:53,214][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:22:34,317][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=106)
[INFO][2024-03-21 20:22:34,318][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.52%
[INFO][2024-03-21 20:22:34,410][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:22:34,410][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.83333
wandb:  test_acc 0.71014
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run fresh-sweep-60 at: https://wandb.ai/xzy11632/dance-dev/runs/p0s7952p
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_202144-p0s7952p/logs
wandb: Agent Starting Run: 9973729o with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_202250-9973729o
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run azure-sweep-61
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/9973729o
[INFO][2024-03-21 20:22:59,450][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:22:59,451][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:22:59,453][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'FilterGenesNumberPlaceHolder',
 'CellPCA',
 None][0m
[INFO][2024-03-21 20:22:59,464][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:23:00,025][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:23:00,245][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:23:00,250][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:23:00,566][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:23:00,567][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:23:00,567][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:23:00,567][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:23:00,567][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:23:00,569][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:23:00,582][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:23:00,583][dance][wrapped_func] Took 0:00:01.118823 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 20:23:00,591][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:23:00,592][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:23:00,598][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:23:00,848][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:23:22,495][dance.CellPCA][__call__] Generating cell PCA features (466, 21867) (k=292)
[INFO][2024-03-21 20:23:22,496][dance.CellPCA][__call__] Top 10 explained variances: [0.03104846 0.02727658 0.0223577  0.02065605 0.01753404 0.01365364
 0.01195264 0.01078421 0.00948025 0.00916126]
[INFO][2024-03-21 20:23:22,496][dance.CellPCA][__call__] Total explained variance: 90.02%
[INFO][2024-03-21 20:23:22,497][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:23:22,497][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.5
wandb:  test_acc 0.28261
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run azure-sweep-61 at: https://wandb.ai/xzy11632/dance-dev/runs/9973729o
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_202250-9973729o/logs
wandb: Agent Starting Run: eljeet9r with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_202336-eljeet9r
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resilient-sweep-62
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/eljeet9r
[INFO][2024-03-21 20:23:45,176][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:23:45,176][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:23:45,178][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'FilterGenesNumberPlaceHolder',
 'CellSVD',
 None][0m
[INFO][2024-03-21 20:23:45,182][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:23:45,825][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:23:46,299][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:23:46,309][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:23:46,656][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:23:46,659][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:23:46,659][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:23:46,659][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:23:46,660][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:23:46,673][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:23:46,673][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:23:46,673][dance][wrapped_func] Took 0:00:01.491613 to load and process data.
[WARNING][2024-03-21 20:23:46,683][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:23:46,684][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:23:46,691][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:23:46,898][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:26:03,035][dance.CellSVD][__call__] Generating cell SVD features (466, 21867) (k=293)
[INFO][2024-03-21 20:26:03,036][dance.CellSVD][__call__] Top 10 explained variances: [0.00111455 0.03104701 0.0272127  0.022357   0.02043677 0.01740303
 0.0136536  0.01181666 0.01078386 0.00947704]
[INFO][2024-03-21 20:26:03,037][dance.CellSVD][__call__] Total explained variance: 89.87%
[INFO][2024-03-21 20:26:03,038][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:26:03,039][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.54545
wandb:  test_acc 0.22464
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run resilient-sweep-62 at: https://wandb.ai/xzy11632/dance-dev/runs/eljeet9r
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_202336-eljeet9r/logs
wandb: Agent Starting Run: iz49b0hk with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_202617-iz49b0hk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sandy-sweep-63
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/iz49b0hk
[INFO][2024-03-21 20:26:27,973][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:26:27,980][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:26:27,982][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'FilterGenesNumberPlaceHolder',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 20:26:27,987][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:26:28,847][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:26:29,099][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:26:29,103][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:26:29,360][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:26:29,360][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:26:29,361][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:26:29,361][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:26:29,361][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:26:29,364][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:26:29,364][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:26:29,365][dance][wrapped_func] Took 0:00:01.378456 to load and process data.
[WARNING][2024-03-21 20:26:29,381][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:26:29,381][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:26:29,382][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 20:26:29,382][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:26:29,388][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:26:29,586][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:26:29,587][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:26:29,588][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 20:26:33,632][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:26:33,632][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.017 MB of 0.026 MB uploadedwandb: / 0.017 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.74242
wandb:  test_acc 0.75362
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run sandy-sweep-63 at: https://wandb.ai/xzy11632/dance-dev/runs/iz49b0hk
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_202617-iz49b0hk/logs
wandb: Agent Starting Run: t4tatlyx with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_202649-t4tatlyx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sweepy-sweep-64
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/t4tatlyx
[INFO][2024-03-21 20:26:57,164][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:26:57,165][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:26:57,166][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 20:26:57,173][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:26:57,828][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:26:58,063][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:26:58,066][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:26:58,330][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:26:58,331][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:26:58,331][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:26:58,331][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:26:58,332][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:26:58,334][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:26:58,334][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:26:58,335][dance][wrapped_func] Took 0:00:01.162865 to load and process data.
[WARNING][2024-03-21 20:26:58,358][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:26:58,359][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:26:58,379][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:26:58,640][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:27:04,587][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 21867) (k=158)
[INFO][2024-03-21 20:27:04,587][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.04%
[INFO][2024-03-21 20:27:04,815][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:27:04,816][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.80303
wandb:  test_acc 0.71014
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run sweepy-sweep-64 at: https://wandb.ai/xzy11632/dance-dev/runs/t4tatlyx
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_202649-t4tatlyx/logs
wandb: Agent Starting Run: qnt1k8r0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_202718-qnt1k8r0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run efficient-sweep-65
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/qnt1k8r0
[INFO][2024-03-21 20:27:26,273][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:27:26,273][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:27:26,288][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 20:27:26,293][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:27:26,890][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:27:27,070][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:27:27,073][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:27:27,273][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:27:27,273][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:27:27,273][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:27:27,274][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:27:27,274][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:27:27,276][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:27:27,276][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:27:27,276][dance][wrapped_func] Took 0:00:00.983461 to load and process data.
[WARNING][2024-03-21 20:27:27,285][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:27:27,285][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:27:27,293][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 20:27:27,447][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:28:31,864][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 21867) (k=166)
[INFO][2024-03-21 20:28:31,865][dance.WeightedFeatureSVD][__call__] Total explained variance: 91.26%
[INFO][2024-03-21 20:28:32,019][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:28:32,019][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.80303
wandb:  test_acc 0.78986
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run efficient-sweep-65 at: https://wandb.ai/xzy11632/dance-dev/runs/qnt1k8r0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_202718-qnt1k8r0/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: gh8ypjuq with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_202857-gh8ypjuq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run vivid-sweep-66
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/gh8ypjuq
[INFO][2024-03-21 20:29:06,068][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:29:06,068][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:29:06,070][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'FilterGenesRegression',
 'CellPCA',
 None][0m
[INFO][2024-03-21 20:29:06,078][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:29:06,518][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:29:06,777][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:29:06,781][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:29:07,142][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:29:07,142][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:29:07,143][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:29:07,143][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:29:07,144][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:29:07,146][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:29:07,146][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:29:07,147][dance][wrapped_func] Took 0:00:01.069214 to load and process data.
[WARNING][2024-03-21 20:29:07,164][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:29:07,179][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 20:29:07,752][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 20:29:33,987][dance.CellPCA][__call__] Generating cell PCA features (466, 21867) (k=292)
[INFO][2024-03-21 20:29:33,988][dance.CellPCA][__call__] Top 10 explained variances: [0.03104846 0.02727658 0.0223577  0.02065605 0.01753404 0.01365364
 0.01195264 0.01078421 0.00948025 0.00916126]
[INFO][2024-03-21 20:29:33,988][dance.CellPCA][__call__] Total explained variance: 90.02%
[INFO][2024-03-21 20:29:33,990][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:29:33,990][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.5
wandb:  test_acc 0.28261
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run vivid-sweep-66 at: https://wandb.ai/xzy11632/dance-dev/runs/gh8ypjuq
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_202857-gh8ypjuq/logs
wandb: Agent Starting Run: l2z6udsl with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_202948-l2z6udsl
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run grateful-sweep-67
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/l2z6udsl
[INFO][2024-03-21 20:29:55,809][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:29:55,810][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:29:55,811][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'FilterGenesRegression',
 'CellSVD',
 None][0m
[INFO][2024-03-21 20:29:55,816][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:29:56,429][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:29:56,690][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:29:56,694][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:29:56,998][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:29:56,999][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:29:56,999][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:29:56,999][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:29:57,000][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:29:57,002][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:29:57,002][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:29:57,003][dance][wrapped_func] Took 0:00:01.186459 to load and process data.
[WARNING][2024-03-21 20:29:57,014][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:29:57,035][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 20:29:57,639][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 20:31:58,194][dance.CellSVD][__call__] Generating cell SVD features (466, 21867) (k=293)
[INFO][2024-03-21 20:31:58,196][dance.CellSVD][__call__] Top 10 explained variances: [0.00111455 0.03104701 0.0272127  0.022357   0.02043677 0.01740303
 0.0136536  0.01181666 0.01078386 0.00947704]
[INFO][2024-03-21 20:31:58,196][dance.CellSVD][__call__] Total explained variance: 89.87%
[INFO][2024-03-21 20:31:58,197][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:31:58,198][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.54545
wandb:  test_acc 0.22464
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run grateful-sweep-67 at: https://wandb.ai/xzy11632/dance-dev/runs/l2z6udsl
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_202948-l2z6udsl/logs
wandb: Agent Starting Run: 63xqd6vj with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_203212-63xqd6vj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run logical-sweep-68
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/63xqd6vj
[INFO][2024-03-21 20:32:21,226][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:32:21,226][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:32:21,228][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'FilterGenesRegression',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 20:32:21,233][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:32:21,871][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:32:22,105][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:32:22,116][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:32:22,379][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:32:22,380][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:32:22,380][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:32:22,381][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:32:22,381][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:32:22,383][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:32:22,383][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:32:22,383][dance][wrapped_func] Took 0:00:01.150402 to load and process data.
[WARNING][2024-03-21 20:32:22,399][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:32:22,400][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 20:32:22,400][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:32:22,407][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 20:32:22,877][dance][_filter_enclasc] Start generating cell features using EnClaSC
[WARNING][2024-03-21 20:32:22,923][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:32:22,924][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 20:32:25,619][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:32:25,620][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.74242
wandb:  test_acc 0.75362
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run logical-sweep-68 at: https://wandb.ai/xzy11632/dance-dev/runs/63xqd6vj
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_203212-63xqd6vj/logs
wandb: Agent Starting Run: 2xa6a0co with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_203241-2xa6a0co
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wandering-sweep-69
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/2xa6a0co
[INFO][2024-03-21 20:32:49,944][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:32:49,945][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:32:49,946][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 20:32:49,951][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:32:50,457][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:32:50,698][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:32:50,702][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:32:50,946][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:32:50,946][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:32:50,946][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:32:50,946][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:32:50,947][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:32:50,948][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:32:50,948][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:32:50,949][dance][wrapped_func] Took 0:00:00.997573 to load and process data.
[WARNING][2024-03-21 20:32:50,956][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:32:50,969][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 20:32:51,350][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 20:32:54,594][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 21867) (k=158)
[INFO][2024-03-21 20:32:54,595][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.04%
[INFO][2024-03-21 20:32:54,706][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:32:54,707][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.80303
wandb:  test_acc 0.71014
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run wandering-sweep-69 at: https://wandb.ai/xzy11632/dance-dev/runs/2xa6a0co
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_203241-2xa6a0co/logs
wandb: Agent Starting Run: l8i0o0sb with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_203308-l8i0o0sb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run swept-sweep-70
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/l8i0o0sb
[INFO][2024-03-21 20:33:16,177][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:33:16,177][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:33:16,178][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 20:33:16,195][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:33:16,749][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:33:16,997][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:33:17,001][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:33:17,272][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:33:17,273][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:33:17,273][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:33:17,273][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:33:17,274][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:33:17,276][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:33:17,276][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:33:17,277][dance][wrapped_func] Took 0:00:01.081803 to load and process data.
[WARNING][2024-03-21 20:33:17,289][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:33:17,297][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 20:33:17,678][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 20:34:19,477][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 21867) (k=166)
[INFO][2024-03-21 20:34:19,477][dance.WeightedFeatureSVD][__call__] Total explained variance: 91.26%
[INFO][2024-03-21 20:34:19,650][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:34:19,651][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.80303
wandb:  test_acc 0.78986
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run swept-sweep-70 at: https://wandb.ai/xzy11632/dance-dev/runs/l8i0o0sb
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_203308-l8i0o0sb/logs
wandb: Agent Starting Run: p8ua9qq9 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_203436-p8ua9qq9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run youthful-sweep-71
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/p8ua9qq9
[INFO][2024-03-21 20:34:45,014][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:34:45,014][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:34:45,015][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile', 'NormalizeTotal', 'FilterGenesTopK', 'CellPCA', None][0m
[INFO][2024-03-21 20:34:45,026][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:34:45,440][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:34:45,659][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:34:45,663][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:34:45,871][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:34:45,872][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:34:45,872][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:34:45,872][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:34:45,872][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:34:45,873][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:34:45,874][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:34:45,874][dance][wrapped_func] Took 0:00:00.853568 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 20:34:45,882][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:34:45,887][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 20:34:50,468][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=60)
[INFO][2024-03-21 20:34:50,468][dance.CellPCA][__call__] Top 10 explained variances: [0.12330956 0.07092546 0.06570496 0.05583641 0.04218313 0.04140448
 0.0347369  0.02829308 0.02559349 0.02527203]
[INFO][2024-03-21 20:34:50,469][dance.CellPCA][__call__] Total explained variance: 90.11%
[INFO][2024-03-21 20:34:50,470][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:34:50,470][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.07246
wandb: train_acc 0.5687
wandb: 
wandb: üöÄ View run youthful-sweep-71 at: https://wandb.ai/xzy11632/dance-dev/runs/p8ua9qq9
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_203436-p8ua9qq9/logs
wandb: Agent Starting Run: gmu5ae5u with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_203503-gmu5ae5u
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dandy-sweep-72
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/gmu5ae5u
[INFO][2024-03-21 20:35:09,108][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:35:09,108][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:35:09,110][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile', 'NormalizeTotal', 'FilterGenesTopK', 'CellSVD', None][0m
[INFO][2024-03-21 20:35:09,114][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:35:09,615][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:35:09,762][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:35:09,765][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:35:09,941][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:35:09,941][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:35:09,941][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:35:09,941][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:35:09,941][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:35:09,943][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:35:09,943][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:35:09,944][dance][wrapped_func] Took 0:00:00.829379 to load and process data.
[WARNING][2024-03-21 20:35:09,951][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:35:09,957][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 20:35:57,421][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=60)
[INFO][2024-03-21 20:35:57,422][dance.CellSVD][__call__] Top 10 explained variances: [0.12330093 0.0709144  0.06570283 0.05583347 0.04216819 0.04141152
 0.03473337 0.02828541 0.02558903 0.02527704]
[INFO][2024-03-21 20:35:57,422][dance.CellSVD][__call__] Total explained variance: 90.09%
[INFO][2024-03-21 20:35:57,424][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:35:57,424][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.27273
wandb:  test_acc 0.10145
wandb: train_acc 0.59924
wandb: 
wandb: üöÄ View run dandy-sweep-72 at: https://wandb.ai/xzy11632/dance-dev/runs/gmu5ae5u
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_203503-gmu5ae5u/logs
wandb: Agent Starting Run: xqbxmgs7 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_203612-xqbxmgs7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run stellar-sweep-73
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/xqbxmgs7
[INFO][2024-03-21 20:36:19,879][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:36:19,879][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:36:19,881][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'FilterGenesTopK',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 20:36:19,886][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:36:20,459][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:36:20,751][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:36:20,754][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:36:20,961][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:36:20,962][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:36:20,962][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:36:20,963][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:36:20,963][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:36:20,965][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:36:20,965][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:36:20,966][dance][wrapped_func] Took 0:00:01.079835 to load and process data.
[WARNING][2024-03-21 20:36:20,975][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:36:20,975][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 20:36:20,975][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:36:20,981][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[WARNING][2024-03-21 20:36:21,184][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:36:21,185][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 20:36:21,228][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:36:21,235][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.026 MB uploadedwandb: \ 0.018 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.27273
wandb:  test_acc 0.14493
wandb: train_acc 0.98473
wandb: 
wandb: üöÄ View run stellar-sweep-73 at: https://wandb.ai/xzy11632/dance-dev/runs/xqbxmgs7
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_203612-xqbxmgs7/logs
wandb: Agent Starting Run: brij1myr with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_203638-brij1myr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sunny-sweep-74
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/brij1myr
[INFO][2024-03-21 20:36:46,840][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:36:46,841][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:36:46,842][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 20:36:46,847][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:36:47,648][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:36:48,049][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:36:48,053][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:36:48,447][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:36:48,461][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:36:48,461][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:36:48,462][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:36:48,462][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:36:48,464][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:36:48,464][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:36:48,466][dance][wrapped_func] Took 0:00:01.619559 to load and process data.
[WARNING][2024-03-21 20:36:48,477][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:36:48,487][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 20:36:51,615][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=34)
[INFO][2024-03-21 20:36:51,617][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.31%
[INFO][2024-03-21 20:36:51,641][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:36:51,645][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.24242
wandb:  test_acc 0.11594
wandb: train_acc 0.55725
wandb: 
wandb: üöÄ View run sunny-sweep-74 at: https://wandb.ai/xzy11632/dance-dev/runs/brij1myr
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_203638-brij1myr/logs
wandb: Agent Starting Run: cn66d1th with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_203705-cn66d1th
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run cerulean-sweep-75
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/cn66d1th
[INFO][2024-03-21 20:37:13,779][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:37:13,779][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:37:13,781][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 20:37:13,788][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:37:14,646][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:37:14,994][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:37:14,998][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:37:15,272][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:37:15,273][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:37:15,273][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:37:15,274][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:37:15,274][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:37:15,276][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:37:15,277][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:37:15,277][dance][wrapped_func] Took 0:00:01.489973 to load and process data.
[WARNING][2024-03-21 20:37:15,289][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:37:15,296][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 20:37:55,888][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=34)
[INFO][2024-03-21 20:37:55,889][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.31%
[INFO][2024-03-21 20:37:55,898][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:37:55,898][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.27273
wandb:  test_acc 0.1087
wandb: train_acc 0.5458
wandb: 
wandb: üöÄ View run cerulean-sweep-75 at: https://wandb.ai/xzy11632/dance-dev/runs/cn66d1th
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_203705-cn66d1th/logs
wandb: Agent Starting Run: 3omza7ph with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_203811-3omza7ph
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run bumbling-sweep-76
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/3omza7ph
[INFO][2024-03-21 20:38:20,228][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:38:20,228][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:38:20,230][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellPCA',
 None][0m
[INFO][2024-03-21 20:38:20,234][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:38:20,852][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:38:21,083][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:38:21,087][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:38:21,370][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:38:21,371][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:38:21,371][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:38:21,371][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:38:21,371][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:38:21,376][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:38:21,378][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:38:21,378][dance][wrapped_func] Took 0:00:01.144393 to load and process data.
[WARNING][2024-03-21 20:38:21,388][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:38:21,396][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run bumbling-sweep-76 at: https://wandb.ai/xzy11632/dance-dev/runs/3omza7ph
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_203811-3omza7ph/logs
wandb: ERROR Run 3omza7ph errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: nflflakf with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_203838-nflflakf
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run silvery-sweep-77
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/nflflakf
[INFO][2024-03-21 20:38:46,477][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:38:46,477][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:38:46,478][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellSVD',
 None][0m
[INFO][2024-03-21 20:38:46,494][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:38:47,179][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:38:47,385][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:38:47,389][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:38:47,607][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:38:47,607][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:38:47,608][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:38:47,608][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:38:47,608][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:38:47,610][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:38:47,611][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:38:47,611][dance][wrapped_func] Took 0:00:01.117656 to load and process data.
[WARNING][2024-03-21 20:38:47,621][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:38:47,629][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.021 MB of 0.025 MB uploadedwandb: / 0.021 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run silvery-sweep-77 at: https://wandb.ai/xzy11632/dance-dev/runs/nflflakf
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_203838-nflflakf/logs
wandb: ERROR Run nflflakf errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: z7yd9rwr with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_203905-z7yd9rwr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run feasible-sweep-78
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/z7yd9rwr
[INFO][2024-03-21 20:39:12,877][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:39:12,877][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:39:12,879][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 20:39:12,885][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:39:13,713][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:39:13,970][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:39:13,995][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:39:14,351][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:39:14,352][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:39:14,352][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:39:14,352][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:39:14,352][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:39:14,361][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:39:14,362][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:39:14,362][dance][wrapped_func] Took 0:00:01.478407 to load and process data.
[WARNING][2024-03-21 20:39:14,390][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:39:14,390][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 20:39:14,391][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:39:14,397][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.021 MB of 0.025 MB uploadedwandb: | 0.021 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run feasible-sweep-78 at: https://wandb.ai/xzy11632/dance-dev/runs/z7yd9rwr
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_203905-z7yd9rwr/logs
wandb: ERROR Run z7yd9rwr errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: xtaqa6sn with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_203936-xtaqa6sn
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run leafy-sweep-79
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/xtaqa6sn
[INFO][2024-03-21 20:39:45,331][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:39:45,331][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:39:45,333][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 20:39:45,337][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:39:46,009][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:39:46,316][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:39:46,327][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:39:46,641][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:39:46,641][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:39:46,641][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:39:46,641][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:39:46,642][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:39:46,643][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:39:46,644][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:39:46,644][dance][wrapped_func] Took 0:00:01.306906 to load and process data.
[WARNING][2024-03-21 20:39:46,653][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:39:46,670][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.017 MB of 0.025 MB uploadedwandb: \ 0.017 MB of 0.025 MB uploadedwandb: | 0.021 MB of 0.025 MB uploadedwandb: / 0.024 MB of 0.025 MB uploadedwandb: - 0.024 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run leafy-sweep-79 at: https://wandb.ai/xzy11632/dance-dev/runs/xtaqa6sn
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_203936-xtaqa6sn/logs
wandb: ERROR Run xtaqa6sn errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: 2c9va4w6 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_204008-2c9va4w6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run vivid-sweep-80
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/2c9va4w6
[INFO][2024-03-21 20:40:20,185][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:40:20,185][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:40:20,187][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 20:40:20,200][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:40:20,860][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:40:21,018][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:40:21,022][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:40:21,220][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:40:21,220][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:40:21,220][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:40:21,221][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:40:21,221][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:40:21,223][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:40:21,223][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:40:21,224][dance][wrapped_func] Took 0:00:01.023802 to load and process data.
[WARNING][2024-03-21 20:40:21,233][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:40:21,239][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run vivid-sweep-80 at: https://wandb.ai/xzy11632/dance-dev/runs/2c9va4w6
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_204008-2c9va4w6/logs
wandb: ERROR Run 2c9va4w6 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: ery2v7lc with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_204035-ery2v7lc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run super-sweep-81
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ery2v7lc
[INFO][2024-03-21 20:40:45,615][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:40:45,616][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:40:45,618][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellPCA',
 None][0m
[INFO][2024-03-21 20:40:45,623][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:40:46,337][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:40:46,641][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:40:46,645][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:40:46,863][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:40:46,863][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:40:46,864][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:40:46,864][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:40:46,865][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:40:46,867][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:40:46,867][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:40:46,868][dance][wrapped_func] Took 0:00:01.244964 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 20:40:46,880][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:40:46,888][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run super-sweep-81 at: https://wandb.ai/xzy11632/dance-dev/runs/ery2v7lc
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_204035-ery2v7lc/logs
wandb: ERROR Run ery2v7lc errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: jp4i68mx with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_204101-jp4i68mx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lilac-sweep-82
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/jp4i68mx
[INFO][2024-03-21 20:41:17,504][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:41:17,504][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:41:17,506][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellSVD',
 None][0m
[INFO][2024-03-21 20:41:17,514][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:41:18,174][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:41:18,421][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:41:18,425][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:41:18,707][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:41:18,708][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:41:18,708][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:41:18,708][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:41:18,708][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:41:18,710][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:41:18,711][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:41:18,711][dance][wrapped_func] Took 0:00:01.197496 to load and process data.
[WARNING][2024-03-21 20:41:18,722][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:41:18,746][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.018 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run lilac-sweep-82 at: https://wandb.ai/xzy11632/dance-dev/runs/jp4i68mx
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_204101-jp4i68mx/logs
wandb: ERROR Run jp4i68mx errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: uybj3bx4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_204133-uybj3bx4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run volcanic-sweep-83
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/uybj3bx4
[INFO][2024-03-21 20:41:46,581][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:41:46,581][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:41:46,583][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 20:41:46,587][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:41:47,361][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:41:47,640][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:41:47,644][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:41:48,130][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:41:48,132][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:41:48,132][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:41:48,132][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:41:48,133][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:41:48,135][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:41:48,138][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:41:48,138][dance][wrapped_func] Took 0:00:01.551377 to load and process data.
[WARNING][2024-03-21 20:41:48,160][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:41:48,161][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 20:41:48,161][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:41:48,180][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run volcanic-sweep-83 at: https://wandb.ai/xzy11632/dance-dev/runs/uybj3bx4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_204133-uybj3bx4/logs
wandb: ERROR Run uybj3bx4 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: kr8cock4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_204205-kr8cock4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run mild-sweep-84
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/kr8cock4
[INFO][2024-03-21 20:42:13,276][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:42:13,277][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:42:13,278][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 20:42:13,284][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:42:14,322][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:42:14,631][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:42:14,635][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:42:14,880][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:42:14,880][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:42:14,880][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:42:14,880][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:42:14,881][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:42:14,882][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:42:14,883][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:42:14,883][dance][wrapped_func] Took 0:00:01.599004 to load and process data.
[WARNING][2024-03-21 20:42:14,893][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:42:14,899][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.013 MB uploadedwandb: - 0.012 MB of 0.013 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run mild-sweep-84 at: https://wandb.ai/xzy11632/dance-dev/runs/kr8cock4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_204205-kr8cock4/logs
wandb: ERROR Run kr8cock4 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: 00gm0h69 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_204232-00gm0h69
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sleek-sweep-85
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/00gm0h69
[INFO][2024-03-21 20:42:41,906][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:42:41,906][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:42:41,907][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 20:42:41,921][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:42:42,403][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:42:42,614][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:42:42,619][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:42:42,988][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:42:42,996][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:42:42,996][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:42:42,997][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:42:42,997][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:42:42,999][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:42:43,000][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:42:43,000][dance][wrapped_func] Took 0:00:01.079507 to load and process data.
[WARNING][2024-03-21 20:42:43,023][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:42:43,050][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run sleek-sweep-85 at: https://wandb.ai/xzy11632/dance-dev/runs/00gm0h69
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_204232-00gm0h69/logs
wandb: ERROR Run 00gm0h69 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: ox5a6520 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_204258-ox5a6520
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fallen-sweep-86
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ox5a6520
[INFO][2024-03-21 20:43:08,554][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:43:08,554][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:43:08,556][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'CellPCA',
 None][0m
[INFO][2024-03-21 20:43:08,574][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:43:09,262][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:43:09,697][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:43:09,702][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:43:10,157][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:43:10,158][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:43:10,158][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:43:10,158][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:43:10,159][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:43:10,161][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:43:10,161][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:43:10,161][dance][wrapped_func] Took 0:00:01.587961 to load and process data.
[WARNING][2024-03-21 20:43:10,171][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:43:10,180][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-21 20:43:19,926][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=189)
[INFO][2024-03-21 20:43:19,927][dance.CellPCA][__call__] Top 10 explained variances: [0.05391086 0.03864191 0.03625606 0.02868224 0.02354394 0.02195621
 0.02013339 0.01915573 0.01538059 0.01479751]
[INFO][2024-03-21 20:43:19,928][dance.CellPCA][__call__] Total explained variance: 90.01%
[INFO][2024-03-21 20:43:19,929][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:43:19,929][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.63636
wandb:  test_acc 0.25362
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run fallen-sweep-86 at: https://wandb.ai/xzy11632/dance-dev/runs/ox5a6520
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_204258-ox5a6520/logs
wandb: Agent Starting Run: zdc1ek8t with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_204338-zdc1ek8t
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run magic-sweep-87
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/zdc1ek8t
[INFO][2024-03-21 20:43:47,247][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:43:47,247][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:43:47,249][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'CellSVD',
 None][0m
[INFO][2024-03-21 20:43:47,260][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:43:47,935][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:43:48,144][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:43:48,147][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:43:48,447][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:43:48,448][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:43:48,449][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:43:48,449][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:43:48,449][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:43:48,451][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:43:48,452][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:43:48,452][dance][wrapped_func] Took 0:00:01.192306 to load and process data.
[WARNING][2024-03-21 20:43:48,477][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:43:48,484][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-21 20:45:35,327][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=190)
[INFO][2024-03-21 20:45:35,346][dance.CellSVD][__call__] Top 10 explained variances: [0.02414215 0.04422335 0.03625735 0.03148043 0.02839664 0.02332584
 0.02177789 0.01943526 0.01888049 0.01536245]
[INFO][2024-03-21 20:45:35,349][dance.CellSVD][__call__] Total explained variance: 89.96%
[INFO][2024-03-21 20:45:35,357][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:45:35,357][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.56061
wandb:  test_acc 0.27536
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run magic-sweep-87 at: https://wandb.ai/xzy11632/dance-dev/runs/zdc1ek8t
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_204338-zdc1ek8t/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: f7dxf8az with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_204600-f7dxf8az
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run deft-sweep-88
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/f7dxf8az
[INFO][2024-03-21 20:46:08,865][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:46:08,865][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:46:08,867][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 20:46:08,872][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:46:09,403][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:46:09,620][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:46:09,626][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:46:09,840][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:46:09,841][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:46:09,841][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:46:09,841][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:46:09,842][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:46:09,844][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:46:09,845][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:46:09,845][dance][wrapped_func] Took 0:00:00.973195 to load and process data.
[WARNING][2024-03-21 20:46:09,856][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:46:09,856][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 20:46:09,857][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:46:09,864][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-21 20:46:10,598][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:46:10,599][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 20:46:10,766][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:46:10,772][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.72727
wandb:  test_acc 0.61594
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run deft-sweep-88 at: https://wandb.ai/xzy11632/dance-dev/runs/f7dxf8az
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_204600-f7dxf8az/logs
wandb: Agent Starting Run: 0qae3m9b with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_204628-0qae3m9b
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run decent-sweep-89
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/0qae3m9b
[INFO][2024-03-21 20:46:37,545][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:46:37,545][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:46:37,546][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 20:46:37,552][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:46:38,153][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:46:38,405][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:46:38,409][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:46:38,637][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:46:38,638][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:46:38,638][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:46:38,638][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:46:38,638][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:46:38,640][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:46:38,641][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:46:38,641][dance][wrapped_func] Took 0:00:01.089925 to load and process data.
[WARNING][2024-03-21 20:46:38,658][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:46:38,666][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-21 20:46:44,939][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=109)
[INFO][2024-03-21 20:46:44,939][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.12%
[INFO][2024-03-21 20:46:45,019][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:46:45,019][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.021 MB of 0.025 MB uploadedwandb: | 0.021 MB of 0.025 MB uploadedwandb: / 0.021 MB of 0.025 MB uploadedwandb: - 0.021 MB of 0.025 MB uploadedwandb: \ 0.021 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.69697
wandb:  test_acc 0.65217
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run decent-sweep-89 at: https://wandb.ai/xzy11632/dance-dev/runs/0qae3m9b
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_204628-0qae3m9b/logs
wandb: Agent Starting Run: 3gmgt0xi with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_204706-3gmgt0xi
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run legendary-sweep-90
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/3gmgt0xi
[INFO][2024-03-21 20:47:15,768][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:47:15,768][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:47:15,769][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 20:47:15,837][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:47:16,721][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:47:17,147][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:47:17,150][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:47:17,364][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:47:17,365][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:47:17,365][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:47:17,365][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:47:17,365][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:47:17,367][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:47:17,367][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:47:17,368][dance][wrapped_func] Took 0:00:01.531457 to load and process data.
[WARNING][2024-03-21 20:47:17,376][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:47:17,383][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-21 20:48:07,217][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=112)
[INFO][2024-03-21 20:48:07,229][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.56%
[INFO][2024-03-21 20:48:07,274][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:48:07,275][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.018 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.018 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.77273
wandb:  test_acc 0.58696
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run legendary-sweep-90 at: https://wandb.ai/xzy11632/dance-dev/runs/3gmgt0xi
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_204706-3gmgt0xi/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 4kajpe42 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_204833-4kajpe42
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run vivid-sweep-91
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/4kajpe42
[INFO][2024-03-21 20:48:43,708][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:48:43,708][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:48:43,710][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'FilterGenesNumberPlaceHolder',
 'CellPCA',
 None][0m
[INFO][2024-03-21 20:48:43,715][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:48:44,284][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:48:44,538][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:48:44,548][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:48:44,782][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:48:44,782][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:48:44,783][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:48:44,783][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:48:44,783][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:48:44,785][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:48:44,785][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:48:44,785][dance][wrapped_func] Took 0:00:01.070802 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 20:48:44,793][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:48:44,794][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:48:44,799][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 20:49:06,453][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:49:48,693][dance.CellPCA][__call__] Generating cell PCA features (466, 21867) (k=388)
[INFO][2024-03-21 20:49:48,695][dance.CellPCA][__call__] Top 10 explained variances: [0.0199555  0.01548578 0.01356882 0.01153318 0.00883506 0.00759505
 0.00651095 0.00573275 0.00537481 0.00486775]
[INFO][2024-03-21 20:49:48,695][dance.CellPCA][__call__] Total explained variance: 90.08%
[INFO][2024-03-21 20:49:48,697][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:49:48,698][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.5
wandb:  test_acc 0.17391
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run vivid-sweep-91 at: https://wandb.ai/xzy11632/dance-dev/runs/4kajpe42
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_204833-4kajpe42/logs
wandb: Agent Starting Run: kl707f91 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_205001-kl707f91
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run curious-sweep-92
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/kl707f91
[INFO][2024-03-21 20:50:10,691][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:50:10,694][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:50:10,695][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'FilterGenesNumberPlaceHolder',
 'CellSVD',
 None][0m
[INFO][2024-03-21 20:50:10,702][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:50:11,145][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:50:11,311][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:50:11,315][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:50:11,536][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:50:11,536][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:50:11,537][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:50:11,537][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:50:11,537][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:50:11,539][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:50:11,540][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:50:11,540][dance][wrapped_func] Took 0:00:00.838519 to load and process data.
[WARNING][2024-03-21 20:50:11,554][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:50:11,555][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:50:11,591][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 20:50:32,826][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:52:04,079][dance.CellSVD][__call__] Generating cell SVD features (466, 21867) (k=389)
[INFO][2024-03-21 20:52:04,080][dance.CellSVD][__call__] Top 10 explained variances: [0.00153067 0.01986926 0.0153978  0.01353692 0.01134143 0.0087766
 0.00759034 0.00650787 0.00572756 0.00526307]
[INFO][2024-03-21 20:52:04,080][dance.CellSVD][__call__] Total explained variance: 89.57%
[INFO][2024-03-21 20:52:04,082][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:52:04,083][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.36364
wandb:  test_acc 0.17391
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run curious-sweep-92 at: https://wandb.ai/xzy11632/dance-dev/runs/kl707f91
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_205001-kl707f91/logs
wandb: Agent Starting Run: m70xj5tu with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_205216-m70xj5tu
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run bright-sweep-93
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/m70xj5tu
[INFO][2024-03-21 20:52:22,245][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:52:22,245][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:52:22,247][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'FilterGenesNumberPlaceHolder',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 20:52:22,254][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:52:22,810][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:52:23,046][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:52:23,050][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:52:23,246][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:52:23,247][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:52:23,247][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:52:23,247][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:52:23,248][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:52:23,250][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:52:23,250][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:52:23,250][dance][wrapped_func] Took 0:00:00.997017 to load and process data.
[WARNING][2024-03-21 20:52:23,259][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:52:23,260][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:52:23,260][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 20:52:23,260][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:52:23,266][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 20:52:44,784][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:52:44,799][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:52:44,800][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 20:52:48,191][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:52:48,192][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.78788
wandb:  test_acc 0.76087
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run bright-sweep-93 at: https://wandb.ai/xzy11632/dance-dev/runs/m70xj5tu
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_205216-m70xj5tu/logs
wandb: Agent Starting Run: 7m8732mr with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_205305-7m8732mr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run driven-sweep-94
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/7m8732mr
[INFO][2024-03-21 20:53:14,473][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:53:14,474][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:53:14,476][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 20:53:14,489][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:53:15,354][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:53:15,721][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:53:15,725][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:53:15,919][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:53:15,919][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:53:15,919][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:53:15,919][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:53:15,919][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:53:15,921][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:53:15,921][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:53:15,921][dance][wrapped_func] Took 0:00:01.432847 to load and process data.
[WARNING][2024-03-21 20:53:15,930][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:53:15,930][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:53:15,936][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 20:53:40,618][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:53:55,283][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 21867) (k=219)
[INFO][2024-03-21 20:53:55,284][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.19%
[INFO][2024-03-21 20:53:55,541][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:53:55,542][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.60606
wandb:  test_acc 0.16667
wandb: train_acc 0.67557
wandb: 
wandb: üöÄ View run driven-sweep-94 at: https://wandb.ai/xzy11632/dance-dev/runs/7m8732mr
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_205305-7m8732mr/logs
wandb: Agent Starting Run: wmvrgbdw with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_205411-wmvrgbdw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run laced-sweep-95
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/wmvrgbdw
[INFO][2024-03-21 20:54:19,973][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:54:19,973][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:54:19,975][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 20:54:19,981][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:54:20,947][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:54:21,313][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:54:21,323][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:54:21,615][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:54:21,615][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:54:21,616][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:54:21,616][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:54:21,616][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:54:21,618][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:54:21,618][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:54:21,619][dance][wrapped_func] Took 0:00:01.638404 to load and process data.
[WARNING][2024-03-21 20:54:21,628][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 20:54:21,629][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:54:21,635][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 20:54:44,618][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 20:56:10,213][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 21867) (k=220)
[INFO][2024-03-21 20:56:10,221][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.08%
[INFO][2024-03-21 20:56:10,418][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:56:10,419][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.018 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.59091
wandb:  test_acc 0.14493
wandb: train_acc 0.6145
wandb: 
wandb: üöÄ View run laced-sweep-95 at: https://wandb.ai/xzy11632/dance-dev/runs/wmvrgbdw
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_205411-wmvrgbdw/logs
wandb: Agent Starting Run: r3h1q40y with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_205629-r3h1q40y
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run likely-sweep-96
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/r3h1q40y
[INFO][2024-03-21 20:56:37,640][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:56:37,641][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:56:37,642][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'FilterGenesRegression',
 'CellPCA',
 None][0m
[INFO][2024-03-21 20:56:37,648][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:56:38,174][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:56:38,353][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:56:38,356][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:56:38,652][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:56:38,653][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:56:38,653][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:56:38,654][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:56:38,654][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:56:38,669][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:56:38,669][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:56:38,670][dance][wrapped_func] Took 0:00:01.021565 to load and process data.
[WARNING][2024-03-21 20:56:38,679][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:56:38,684][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 20:57:03,734][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 20:57:44,305][dance.CellPCA][__call__] Generating cell PCA features (466, 21867) (k=388)
[INFO][2024-03-21 20:57:44,306][dance.CellPCA][__call__] Top 10 explained variances: [0.0199555  0.01548578 0.01356882 0.01153318 0.00883506 0.00759505
 0.00651095 0.00573275 0.00537481 0.00486775]
[INFO][2024-03-21 20:57:44,307][dance.CellPCA][__call__] Total explained variance: 90.08%
[INFO][2024-03-21 20:57:44,318][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 20:57:44,318][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.5
wandb:  test_acc 0.17391
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run likely-sweep-96 at: https://wandb.ai/xzy11632/dance-dev/runs/r3h1q40y
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_205629-r3h1q40y/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: uk5emnjn with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_205809-uk5emnjn
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run faithful-sweep-97
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/uk5emnjn
[INFO][2024-03-21 20:58:17,416][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 20:58:17,416][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 20:58:17,417][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'FilterGenesRegression',
 'CellSVD',
 None][0m
[INFO][2024-03-21 20:58:17,424][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 20:58:18,111][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 20:58:18,334][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 20:58:18,338][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 20:58:18,643][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 20:58:18,643][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 20:58:18,644][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 20:58:18,644][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 20:58:18,644][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 20:58:18,646][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 20:58:18,648][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 20:58:18,648][dance][wrapped_func] Took 0:00:01.224130 to load and process data.
[WARNING][2024-03-21 20:58:18,657][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 20:58:18,674][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 20:58:42,390][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 21:01:46,483][dance.CellSVD][__call__] Generating cell SVD features (466, 21867) (k=389)
[INFO][2024-03-21 21:01:46,489][dance.CellSVD][__call__] Top 10 explained variances: [0.00153067 0.01986926 0.0153978  0.01353692 0.01134143 0.0087766
 0.00759034 0.00650787 0.00572756 0.00526307]
[INFO][2024-03-21 21:01:46,489][dance.CellSVD][__call__] Total explained variance: 89.57%
[INFO][2024-03-21 21:01:46,511][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:01:46,511][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.36364
wandb:  test_acc 0.17391
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run faithful-sweep-97 at: https://wandb.ai/xzy11632/dance-dev/runs/uk5emnjn
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_205809-uk5emnjn/logs
wandb: Agent Starting Run: 8i3abk3j with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_210206-8i3abk3j
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run eager-sweep-98
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/8i3abk3j
[INFO][2024-03-21 21:02:13,525][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:02:13,525][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:02:13,528][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'FilterGenesRegression',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 21:02:13,549][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:02:14,453][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:02:14,620][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:02:14,625][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:02:14,843][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:02:14,844][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:02:14,844][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:02:14,844][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:02:14,844][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:02:14,846][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:02:14,847][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:02:14,847][dance][wrapped_func] Took 0:00:01.297689 to load and process data.
[WARNING][2024-03-21 21:02:14,868][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 21:02:14,868][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 21:02:14,868][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:02:14,879][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 21:02:38,494][dance][_filter_enclasc] Start generating cell features using EnClaSC
[WARNING][2024-03-21 21:02:38,575][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 21:02:38,576][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 21:02:41,411][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:02:41,412][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.78788
wandb:  test_acc 0.76087
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run eager-sweep-98 at: https://wandb.ai/xzy11632/dance-dev/runs/8i3abk3j
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_210206-8i3abk3j/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: ykws2bfz with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_210307-ykws2bfz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run zesty-sweep-99
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ykws2bfz
[INFO][2024-03-21 21:03:13,796][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:03:13,797][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:03:13,798][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 21:03:13,811][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:03:14,246][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:03:14,444][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:03:14,448][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:03:14,671][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:03:14,671][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:03:14,672][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:03:14,672][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:03:14,672][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:03:14,674][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:03:14,675][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:03:14,675][dance][wrapped_func] Took 0:00:00.864798 to load and process data.
[WARNING][2024-03-21 21:03:14,688][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:03:14,696][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 21:03:37,615][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 21:03:43,244][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 21867) (k=219)
[INFO][2024-03-21 21:03:43,265][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.19%
[INFO][2024-03-21 21:03:43,423][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:03:43,423][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.60606
wandb:  test_acc 0.16667
wandb: train_acc 0.67557
wandb: 
wandb: üöÄ View run zesty-sweep-99 at: https://wandb.ai/xzy11632/dance-dev/runs/ykws2bfz
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_210307-ykws2bfz/logs
wandb: Agent Starting Run: i5wh84sf with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_210358-i5wh84sf
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dulcet-sweep-100
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/i5wh84sf
[INFO][2024-03-21 21:04:06,492][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:04:06,493][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:04:06,497][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 21:04:06,512][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:04:07,175][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:04:07,422][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:04:07,426][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:04:07,617][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:04:07,618][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:04:07,618][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:04:07,618][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:04:07,619][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:04:07,620][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:04:07,621][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:04:07,621][dance][wrapped_func] Took 0:00:01.109555 to load and process data.
[WARNING][2024-03-21 21:04:07,631][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:04:07,636][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 21:04:32,586][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 21:05:39,451][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 21867) (k=220)
[INFO][2024-03-21 21:05:39,452][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.08%
[INFO][2024-03-21 21:05:39,784][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:05:39,785][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.59091
wandb:  test_acc 0.14493
wandb: train_acc 0.6145
wandb: 
wandb: üöÄ View run dulcet-sweep-100 at: https://wandb.ai/xzy11632/dance-dev/runs/i5wh84sf
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_210358-i5wh84sf/logs
wandb: Agent Starting Run: hhls57y4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_210554-hhls57y4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dandy-sweep-101
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/hhls57y4
[INFO][2024-03-21 21:06:01,531][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:06:01,531][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:06:01,533][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile', 'ScTransform', 'FilterGenesTopK', 'CellPCA', None][0m
[INFO][2024-03-21 21:06:01,540][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:06:02,168][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:06:02,410][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:06:02,414][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:06:02,612][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:06:02,613][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:06:02,613][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:06:02,613][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:06:02,614][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:06:02,616][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:06:02,616][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:06:02,616][dance][wrapped_func] Took 0:00:01.076187 to load and process data.
[WARNING][2024-03-21 21:06:02,625][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:06:02,631][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 21:06:43,531][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=284)
[INFO][2024-03-21 21:06:43,532][dance.CellPCA][__call__] Top 10 explained variances: [0.11018476 0.01400813 0.01317216 0.0094556  0.00851066 0.00828545
 0.00706854 0.00697117 0.0067643  0.00668244]
[INFO][2024-03-21 21:06:43,532][dance.CellPCA][__call__] Total explained variance: 90.04%
[INFO][2024-03-21 21:06:43,534][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:06:43,534][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.018 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.36364
wandb:  test_acc 0.13043
wandb: train_acc 0.8626
wandb: 
wandb: üöÄ View run dandy-sweep-101 at: https://wandb.ai/xzy11632/dance-dev/runs/hhls57y4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_210554-hhls57y4/logs
wandb: Agent Starting Run: ymxjqook with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_210656-ymxjqook
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run silvery-sweep-102
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ymxjqook
[INFO][2024-03-21 21:07:04,259][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:07:04,259][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:07:04,261][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile', 'ScTransform', 'FilterGenesTopK', 'CellSVD', None][0m
[INFO][2024-03-21 21:07:04,274][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:07:04,822][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:07:05,077][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:07:05,080][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:07:05,276][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:07:05,276][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:07:05,276][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:07:05,277][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:07:05,277][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:07:05,279][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:07:05,280][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:07:05,280][dance][wrapped_func] Took 0:00:01.006665 to load and process data.
[WARNING][2024-03-21 21:07:05,289][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:07:05,296][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 21:09:25,553][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=285)
[INFO][2024-03-21 21:09:25,555][dance.CellSVD][__call__] Top 10 explained variances: [0.11007204 0.01400714 0.01315953 0.00929423 0.00844126 0.00828179
 0.00667195 0.0069815  0.00675692 0.00668258]
[INFO][2024-03-21 21:09:25,555][dance.CellSVD][__call__] Total explained variance: 89.95%
[INFO][2024-03-21 21:09:25,562][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:09:25,563][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.31818
wandb:  test_acc 0.07246
wandb: train_acc 0.84351
wandb: 
wandb: üöÄ View run silvery-sweep-102 at: https://wandb.ai/xzy11632/dance-dev/runs/ymxjqook
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_210656-ymxjqook/logs
wandb: Agent Starting Run: 1al1xcq4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_210937-1al1xcq4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dainty-sweep-103
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/1al1xcq4
[INFO][2024-03-21 21:09:45,185][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:09:45,192][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:09:45,194][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'FilterGenesTopK',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 21:09:45,199][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:09:45,614][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:09:45,774][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:09:45,777][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:09:45,959][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:09:45,959][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:09:45,959][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:09:45,960][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:09:45,960][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:09:45,962][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:09:45,962][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:09:45,962][dance][wrapped_func] Took 0:00:00.763193 to load and process data.
[WARNING][2024-03-21 21:09:45,971][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 21:09:45,971][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 21:09:45,972][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:09:45,977][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[WARNING][2024-03-21 21:10:08,368][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 21:10:08,369][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 21:10:08,487][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:10:08,493][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.021 MB uploadedwandb: - 0.012 MB of 0.021 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.36364
wandb:  test_acc 0.0942
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run dainty-sweep-103 at: https://wandb.ai/xzy11632/dance-dev/runs/1al1xcq4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_210937-1al1xcq4/logs
wandb: Agent Starting Run: 57noaygo with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_211025-57noaygo
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run logical-sweep-104
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/57noaygo
[INFO][2024-03-21 21:10:35,375][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:10:35,375][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:10:35,378][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 21:10:35,395][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:10:36,234][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:10:36,463][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:10:36,466][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:10:36,664][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:10:36,664][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:10:36,665][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:10:36,665][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:10:36,665][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:10:36,673][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:10:36,673][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:10:36,673][dance][wrapped_func] Took 0:00:01.279092 to load and process data.
[WARNING][2024-03-21 21:10:36,684][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:10:36,710][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 21:11:03,461][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=171)
[INFO][2024-03-21 21:11:03,462][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.16%
[INFO][2024-03-21 21:11:03,514][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:11:03,514][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.4542
wandb: 
wandb: üöÄ View run logical-sweep-104 at: https://wandb.ai/xzy11632/dance-dev/runs/57noaygo
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_211025-57noaygo/logs
wandb: Agent Starting Run: p0vj75q4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_211118-p0vj75q4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lucky-sweep-105
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/p0vj75q4
[INFO][2024-03-21 21:11:28,663][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:11:28,663][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:11:28,665][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 21:11:28,679][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:11:29,476][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:11:29,769][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:11:29,772][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:11:30,064][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:11:30,064][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:11:30,065][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:11:30,065][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:11:30,065][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:11:30,068][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:11:30,069][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:11:30,069][dance][wrapped_func] Took 0:00:01.390120 to load and process data.
[WARNING][2024-03-21 21:11:30,078][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:11:30,084][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 21:12:58,523][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=167)
[INFO][2024-03-21 21:12:58,524][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.25%
[INFO][2024-03-21 21:12:58,584][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:12:58,584][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.41985
wandb: 
wandb: üöÄ View run lucky-sweep-105 at: https://wandb.ai/xzy11632/dance-dev/runs/p0vj75q4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_211118-p0vj75q4/logs
wandb: Agent Starting Run: hygw3wfh with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_211314-hygw3wfh
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lemon-sweep-106
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/hygw3wfh
[INFO][2024-03-21 21:13:21,537][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:13:21,537][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:13:21,542][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellPCA',
 None][0m
[INFO][2024-03-21 21:13:21,548][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:13:21,999][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:13:22,202][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:13:22,206][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:13:22,487][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:13:22,487][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:13:22,487][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:13:22,487][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:13:22,487][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:13:22,489][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:13:22,489][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:13:22,489][dance][wrapped_func] Took 0:00:00.941186 to load and process data.
[WARNING][2024-03-21 21:13:22,505][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:13:22,538][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[INFO][2024-03-21 21:14:09,840][dance.CellPCA][__call__] Generating cell PCA features (466, 6891) (k=361)
[INFO][2024-03-21 21:14:09,841][dance.CellPCA][__call__] Top 10 explained variances: [0.02286754 0.02123829 0.02034254 0.01457696 0.01332175 0.0105136
 0.00855259 0.00709342 0.00639107 0.00567182]
[INFO][2024-03-21 21:14:09,842][dance.CellPCA][__call__] Total explained variance: 90.06%
[INFO][2024-03-21 21:14:09,843][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:14:09,843][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.56061
wandb:  test_acc 0.34058
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run lemon-sweep-106 at: https://wandb.ai/xzy11632/dance-dev/runs/hygw3wfh
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_211314-hygw3wfh/logs
wandb: Agent Starting Run: zmj4cpgq with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_211423-zmj4cpgq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run chocolate-sweep-107
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/zmj4cpgq
[INFO][2024-03-21 21:14:29,497][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:14:29,498][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:14:29,499][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellSVD',
 None][0m
[INFO][2024-03-21 21:14:29,505][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:14:29,927][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:14:30,210][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:14:30,214][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:14:30,480][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:14:30,481][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:14:30,481][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:14:30,481][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:14:30,482][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:14:30,483][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:14:30,484][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:14:30,484][dance][wrapped_func] Took 0:00:00.979562 to load and process data.
[WARNING][2024-03-21 21:14:30,497][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:14:30,503][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[INFO][2024-03-21 21:17:00,436][dance.CellSVD][__call__] Generating cell SVD features (466, 6891) (k=362)
[INFO][2024-03-21 21:17:00,438][dance.CellSVD][__call__] Top 10 explained variances: [0.0066688  0.02250096 0.02063417 0.01799503 0.01376838 0.01328389
 0.01031147 0.00854971 0.00708725 0.0063529 ]
[INFO][2024-03-21 21:17:00,438][dance.CellSVD][__call__] Total explained variance: 89.77%
[INFO][2024-03-21 21:17:00,441][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:17:00,441][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.5
wandb:  test_acc 0.27536
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run chocolate-sweep-107 at: https://wandb.ai/xzy11632/dance-dev/runs/zmj4cpgq
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_211423-zmj4cpgq/logs
wandb: Agent Starting Run: g7x4no8m with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_211717-g7x4no8m
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run helpful-sweep-108
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/g7x4no8m
[INFO][2024-03-21 21:17:26,291][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:17:26,292][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:17:26,293][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 21:17:26,299][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:17:27,005][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:17:27,361][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:17:27,365][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:17:27,552][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:17:27,553][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:17:27,554][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:17:27,554][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:17:27,554][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:17:27,556][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:17:27,557][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:17:27,557][dance][wrapped_func] Took 0:00:01.258653 to load and process data.
[WARNING][2024-03-21 21:17:27,566][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 21:17:27,566][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 21:17:27,566][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:17:27,573][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 21:17:50,389][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 21:17:50,390][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 21:17:50,730][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:17:50,731][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.018 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.75758
wandb:  test_acc 0.65217
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run helpful-sweep-108 at: https://wandb.ai/xzy11632/dance-dev/runs/g7x4no8m
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_211717-g7x4no8m/logs
wandb: Agent Starting Run: l44drsf8 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_211807-l44drsf8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run logical-sweep-109
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/l44drsf8
[INFO][2024-03-21 21:18:15,827][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:18:15,828][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:18:15,839][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 21:18:15,845][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:18:16,493][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:18:16,838][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:18:16,842][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:18:17,100][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:18:17,107][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:18:17,107][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:18:17,108][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:18:17,108][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:18:17,110][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:18:17,111][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:18:17,111][dance][wrapped_func] Took 0:00:01.266197 to load and process data.
[WARNING][2024-03-21 21:18:17,120][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:18:17,151][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[INFO][2024-03-21 21:18:48,605][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 6891) (k=209)
[INFO][2024-03-21 21:18:48,606][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.14%
[INFO][2024-03-21 21:18:48,672][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:18:48,674][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.015 MB of 0.025 MB uploadedwandb: | 0.015 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.65152
wandb:  test_acc 0.26087
wandb: train_acc 0.77099
wandb: 
wandb: üöÄ View run logical-sweep-109 at: https://wandb.ai/xzy11632/dance-dev/runs/l44drsf8
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_211807-l44drsf8/logs
wandb: Agent Starting Run: trrhihag with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_211908-trrhihag
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wild-sweep-110
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/trrhihag
[INFO][2024-03-21 21:19:16,729][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:19:16,729][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:19:16,731][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 21:19:16,753][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:19:17,283][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:19:17,518][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:19:17,522][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:19:17,759][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:19:17,760][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:19:17,760][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:19:17,760][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:19:17,761][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:19:17,763][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:19:17,764][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:19:17,764][dance][wrapped_func] Took 0:00:01.011464 to load and process data.
[WARNING][2024-03-21 21:19:17,777][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:19:17,786][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[INFO][2024-03-21 21:20:52,481][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 6891) (k=210)
[INFO][2024-03-21 21:20:52,482][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.13%
[INFO][2024-03-21 21:20:52,544][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:20:52,544][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.013 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.62121
wandb:  test_acc 0.15942
wandb: train_acc 0.71374
wandb: 
wandb: üöÄ View run wild-sweep-110 at: https://wandb.ai/xzy11632/dance-dev/runs/trrhihag
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_211908-trrhihag/logs
wandb: Agent Starting Run: 6gfxavls with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_212110-6gfxavls
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lucky-sweep-111
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/6gfxavls
[INFO][2024-03-21 21:21:19,282][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:21:19,283][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:21:19,285][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellPCA',
 None][0m
[INFO][2024-03-21 21:21:19,314][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:21:19,794][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:21:20,117][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:21:20,123][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:21:20,331][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:21:20,332][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:21:20,332][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:21:20,332][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:21:20,332][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:21:20,335][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:21:20,335][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:21:20,336][dance][wrapped_func] Took 0:00:01.021409 to load and process data.
[WARNING][2024-03-21 21:21:20,344][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:21:20,350][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[INFO][2024-03-21 21:22:02,663][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=322)
[INFO][2024-03-21 21:22:02,663][dance.CellPCA][__call__] Top 10 explained variances: [0.03987281 0.03254013 0.02632728 0.02249485 0.01595536 0.00961579
 0.00895701 0.00847467 0.00679444 0.00651236]
[INFO][2024-03-21 21:22:02,664][dance.CellPCA][__call__] Total explained variance: 90.10%
[INFO][2024-03-21 21:22:02,665][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:22:02,665][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.65152
wandb:  test_acc 0.25362
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run lucky-sweep-111 at: https://wandb.ai/xzy11632/dance-dev/runs/6gfxavls
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_212110-6gfxavls/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: vowylb5k with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_212227-vowylb5k
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run vivid-sweep-112
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/vowylb5k
[INFO][2024-03-21 21:22:37,041][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:22:37,041][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:22:37,043][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellSVD',
 None][0m
[INFO][2024-03-21 21:22:37,055][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:22:37,848][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:22:38,073][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:22:38,077][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:22:38,312][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:22:38,313][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:22:38,314][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:22:38,315][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:22:38,315][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:22:38,319][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:22:38,322][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:22:38,324][dance][wrapped_func] Took 0:00:01.268873 to load and process data.
[WARNING][2024-03-21 21:22:38,343][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:22:38,351][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[INFO][2024-03-21 21:25:32,902][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=322)
[INFO][2024-03-21 21:25:32,920][dance.CellSVD][__call__] Top 10 explained variances: [0.01802659 0.03560034 0.03104327 0.02248552 0.01908954 0.01447195
 0.00943334 0.00885123 0.00837227 0.00676931]
[INFO][2024-03-21 21:25:32,920][dance.CellSVD][__call__] Total explained variance: 89.84%
[INFO][2024-03-21 21:25:32,922][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:25:32,922][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.018 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.59091
wandb:  test_acc 0.18841
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run vivid-sweep-112 at: https://wandb.ai/xzy11632/dance-dev/runs/vowylb5k
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_212227-vowylb5k/logs
wandb: Agent Starting Run: drulm61q with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_212546-drulm61q
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run copper-sweep-113
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/drulm61q
[INFO][2024-03-21 21:25:54,093][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:25:54,094][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:25:54,096][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 21:25:54,109][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:25:54,985][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:25:55,364][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:25:55,369][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:25:55,708][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:25:55,708][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:25:55,708][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:25:55,709][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:25:55,709][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:25:55,711][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:25:55,712][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:25:55,712][dance][wrapped_func] Took 0:00:01.603319 to load and process data.
[WARNING][2024-03-21 21:25:55,722][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 21:25:55,723][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 21:25:55,723][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:25:55,730][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 21:26:25,104][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 21:26:25,105][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 21:26:25,214][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:26:25,223][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.74242
wandb:  test_acc 0.50725
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run copper-sweep-113 at: https://wandb.ai/xzy11632/dance-dev/runs/drulm61q
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_212546-drulm61q/logs
wandb: Agent Starting Run: 0m7elu3o with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_212644-0m7elu3o
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glorious-sweep-114
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/0m7elu3o
[INFO][2024-03-21 21:26:53,689][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:26:53,689][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:26:53,690][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 21:26:53,716][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:26:54,567][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:26:54,947][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:26:54,952][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:26:55,186][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:26:55,187][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:26:55,187][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:26:55,188][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:26:55,188][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:26:55,195][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:26:55,197][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:26:55,198][dance][wrapped_func] Took 0:00:01.482055 to load and process data.
[WARNING][2024-03-21 21:26:55,211][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:26:55,218][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[INFO][2024-03-21 21:27:24,590][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=195)
[INFO][2024-03-21 21:27:24,591][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.19%
[INFO][2024-03-21 21:27:24,632][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:27:24,633][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.71212
wandb:  test_acc 0.2029
wandb: train_acc 0.83588
wandb: 
wandb: üöÄ View run glorious-sweep-114 at: https://wandb.ai/xzy11632/dance-dev/runs/0m7elu3o
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_212644-0m7elu3o/logs
wandb: Agent Starting Run: 86di0hjo with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_212744-86di0hjo
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sweepy-sweep-115
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/86di0hjo
[INFO][2024-03-21 21:27:52,760][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:27:52,761][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:27:52,762][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 21:27:52,782][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:27:54,476][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:27:54,858][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:27:54,861][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:27:56,271][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:27:56,272][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:27:56,272][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:27:56,273][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:27:56,273][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:27:56,283][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:27:56,283][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:27:56,283][dance][wrapped_func] Took 0:00:03.501973 to load and process data.
[WARNING][2024-03-21 21:27:56,298][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:27:56,307][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[INFO][2024-03-21 21:29:37,466][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=195)
[INFO][2024-03-21 21:29:37,491][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.03%
[INFO][2024-03-21 21:29:37,503][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:29:37,504][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.63636
wandb:  test_acc 0.15942
wandb: train_acc 0.76718
wandb: 
wandb: üöÄ View run sweepy-sweep-115 at: https://wandb.ai/xzy11632/dance-dev/runs/86di0hjo
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_212744-86di0hjo/logs
wandb: Agent Starting Run: n0vo5oqa with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_212958-n0vo5oqa
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run chocolate-sweep-116
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/n0vo5oqa
[INFO][2024-03-21 21:30:06,663][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:30:06,670][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:30:06,672][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'CellPCA',
 None][0m
[INFO][2024-03-21 21:30:06,678][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:30:07,269][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:30:07,497][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:30:07,501][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:30:07,741][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:30:07,742][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:30:07,742][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:30:07,742][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:30:07,743][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:30:07,744][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:30:07,745][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:30:07,745][dance][wrapped_func] Took 0:00:01.067418 to load and process data.
[WARNING][2024-03-21 21:30:07,754][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:30:07,759][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-21 21:30:45,927][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=304)
[INFO][2024-03-21 21:30:45,928][dance.CellPCA][__call__] Top 10 explained variances: [0.04553334 0.03629709 0.02556079 0.02422409 0.02242365 0.01734532
 0.01016401 0.00906466 0.0088138  0.00698523]
[INFO][2024-03-21 21:30:45,928][dance.CellPCA][__call__] Total explained variance: 90.03%
[INFO][2024-03-21 21:30:45,930][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:30:45,930][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.017 MB of 0.025 MB uploadedwandb: \ 0.017 MB of 0.025 MB uploadedwandb: | 0.017 MB of 0.025 MB uploadedwandb: / 0.017 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.65152
wandb:  test_acc 0.28261
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run chocolate-sweep-116 at: https://wandb.ai/xzy11632/dance-dev/runs/n0vo5oqa
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_212958-n0vo5oqa/logs
wandb: Agent Starting Run: xlo5ovsb with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_213104-xlo5ovsb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run breezy-sweep-117
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/xlo5ovsb
[INFO][2024-03-21 21:31:14,887][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:31:14,888][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:31:14,889][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'CellSVD',
 None][0m
[INFO][2024-03-21 21:31:14,902][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:31:15,564][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:31:15,748][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:31:15,752][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:31:16,055][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:31:16,055][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:31:16,055][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:31:16,055][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:31:16,056][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:31:16,057][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:31:16,058][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:31:16,058][dance][wrapped_func] Took 0:00:01.156080 to load and process data.
[WARNING][2024-03-21 21:31:16,080][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:31:16,087][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-21 21:33:52,975][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=305)
[INFO][2024-03-21 21:33:52,985][dance.CellSVD][__call__] Top 10 explained variances: [0.02723791 0.03833801 0.02836214 0.02420902 0.02343604 0.01920647
 0.01452178 0.01002859 0.00900576 0.00881148]
[INFO][2024-03-21 21:33:52,985][dance.CellSVD][__call__] Total explained variance: 89.90%
[INFO][2024-03-21 21:33:52,987][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:33:52,987][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.60606
wandb:  test_acc 0.16667
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run breezy-sweep-117 at: https://wandb.ai/xzy11632/dance-dev/runs/xlo5ovsb
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_213104-xlo5ovsb/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: wevafn5w with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_213418-wevafn5w
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sparkling-sweep-118
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/wevafn5w
[INFO][2024-03-21 21:34:25,913][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:34:25,913][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:34:25,915][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 21:34:25,929][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:34:27,843][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:34:28,204][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:34:28,207][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:34:32,003][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:34:32,004][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:34:32,005][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:34:32,005][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:34:32,005][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:34:32,024][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:34:32,024][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:34:32,025][dance][wrapped_func] Took 0:00:06.096332 to load and process data.
[WARNING][2024-03-21 21:34:32,043][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 21:34:32,043][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 21:34:32,044][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:34:32,051][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-21 21:35:03,712][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 21:35:03,712][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 21:35:03,831][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:35:03,848][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.74242
wandb:  test_acc 0.60145
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run sparkling-sweep-118 at: https://wandb.ai/xzy11632/dance-dev/runs/wevafn5w
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_213418-wevafn5w/logs
wandb: Agent Starting Run: gartmfgq with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_213523-gartmfgq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run twilight-sweep-119
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/gartmfgq
[INFO][2024-03-21 21:35:29,998][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:35:29,999][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:35:30,001][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 21:35:30,022][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:35:32,460][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:35:32,689][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:35:32,692][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:35:40,670][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:35:40,672][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:35:40,672][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:35:40,672][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:35:40,672][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:35:40,695][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:35:40,696][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:35:40,696][dance][wrapped_func] Took 0:00:10.674035 to load and process data.
[WARNING][2024-03-21 21:35:40,709][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:35:40,720][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-21 21:36:19,919][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=187)
[INFO][2024-03-21 21:36:19,938][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.13%
[INFO][2024-03-21 21:36:19,983][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:36:19,983][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.69697
wandb:  test_acc 0.32609
wandb: train_acc 0.82824
wandb: 
wandb: üöÄ View run twilight-sweep-119 at: https://wandb.ai/xzy11632/dance-dev/runs/gartmfgq
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_213523-gartmfgq/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: oppieaio with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_213643-oppieaio
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run silvery-sweep-120
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/oppieaio
[INFO][2024-03-21 21:36:49,687][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:36:49,689][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:36:49,691][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 21:36:49,706][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:36:54,869][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:36:55,936][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:36:55,948][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:37:08,628][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:37:08,629][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:37:08,630][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:37:08,630][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:37:08,630][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:37:08,634][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:37:08,635][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:37:08,635][dance][wrapped_func] Took 0:00:18.937718 to load and process data.
[WARNING][2024-03-21 21:37:08,652][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:37:08,659][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-21 21:38:44,451][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=187)
[INFO][2024-03-21 21:38:44,453][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.00%
[INFO][2024-03-21 21:38:44,545][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:38:44,550][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.65152
wandb:  test_acc 0.21739
wandb: train_acc 0.79389
wandb: 
wandb: üöÄ View run silvery-sweep-120 at: https://wandb.ai/xzy11632/dance-dev/runs/oppieaio
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_213643-oppieaio/logs
wandb: Agent Starting Run: l9b28691 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_213905-l9b28691
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rosy-sweep-121
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/l9b28691
[INFO][2024-03-21 21:39:17,570][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:39:17,571][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:39:17,573][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'FilterGenesNumberPlaceHolder',
 'CellPCA',
 None][0m
[INFO][2024-03-21 21:39:17,587][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:39:19,057][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:39:19,414][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:39:19,420][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:39:22,439][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:39:22,463][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:39:22,463][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:39:22,464][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:39:22,464][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:39:22,496][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:39:22,505][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:39:22,506][dance][wrapped_func] Took 0:00:04.920974 to load and process data.
[WARNING][2024-03-21 21:39:22,522][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 21:39:22,523][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:39:22,536][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 21:39:24,192][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 21:40:12,488][dance.CellPCA][__call__] Generating cell PCA features (466, 21867) (k=324)
[INFO][2024-03-21 21:40:12,489][dance.CellPCA][__call__] Top 10 explained variances: [0.12962113 0.01239563 0.00985748 0.00651145 0.00610012 0.00596467
 0.00579483 0.00568479 0.00540166 0.00529312]
[INFO][2024-03-21 21:40:12,490][dance.CellPCA][__call__] Total explained variance: 90.04%
[INFO][2024-03-21 21:40:12,495][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:40:12,495][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.51908
wandb: 
wandb: üöÄ View run rosy-sweep-121 at: https://wandb.ai/xzy11632/dance-dev/runs/l9b28691
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_213905-l9b28691/logs
wandb: Agent Starting Run: ta5vt6ix with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_214032-ta5vt6ix
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run effortless-sweep-122
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ta5vt6ix
[INFO][2024-03-21 21:40:38,715][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:40:38,716][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:40:38,718][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'FilterGenesNumberPlaceHolder',
 'CellSVD',
 None][0m
[INFO][2024-03-21 21:40:38,728][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:40:40,685][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:40:41,209][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:40:41,212][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:40:42,589][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:40:42,590][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:40:42,590][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:40:42,590][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:40:42,590][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:40:42,610][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:40:42,611][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:40:42,611][dance][wrapped_func] Took 0:00:03.883296 to load and process data.
[WARNING][2024-03-21 21:40:42,618][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 21:40:42,618][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:40:42,626][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 21:40:43,590][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 21:43:15,486][dance.CellSVD][__call__] Generating cell SVD features (466, 21867) (k=325)
[INFO][2024-03-21 21:43:15,497][dance.CellSVD][__call__] Top 10 explained variances: [0.1295687  0.00973311 0.00682385 0.00950398 0.00611377 0.00597477
 0.00596467 0.00579451 0.00567812 0.00532615]
[INFO][2024-03-21 21:43:15,498][dance.CellSVD][__call__] Total explained variance: 89.87%
[INFO][2024-03-21 21:43:15,504][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:43:15,504][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.50763
wandb: 
wandb: üöÄ View run effortless-sweep-122 at: https://wandb.ai/xzy11632/dance-dev/runs/ta5vt6ix
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_214032-ta5vt6ix/logs
wandb: Agent Starting Run: g4ttir6r with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_214334-g4ttir6r
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run misunderstood-sweep-123
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/g4ttir6r
[INFO][2024-03-21 21:43:42,707][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:43:42,708][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:43:42,710][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'FilterGenesNumberPlaceHolder',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 21:43:42,715][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:43:43,753][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:43:44,102][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:43:44,115][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:43:45,721][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:43:45,721][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:43:45,721][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:43:45,722][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:43:45,722][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:43:45,724][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:43:45,724][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:43:45,725][dance][wrapped_func] Took 0:00:03.009942 to load and process data.
[WARNING][2024-03-21 21:43:45,734][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 21:43:45,735][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 21:43:45,735][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 21:43:45,736][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:43:45,744][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 21:43:46,316][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 21:43:46,317][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 21:43:46,318][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 21:43:53,439][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:43:53,440][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.62121
wandb:  test_acc 0.14493
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run misunderstood-sweep-123 at: https://wandb.ai/xzy11632/dance-dev/runs/g4ttir6r
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_214334-g4ttir6r/logs
wandb: Agent Starting Run: c3h800gh with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_214411-c3h800gh
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sage-sweep-124
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/c3h800gh
[INFO][2024-03-21 21:44:20,617][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:44:20,617][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:44:20,619][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 21:44:20,626][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:44:26,798][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:44:27,219][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:44:27,233][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:44:31,729][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:44:31,729][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:44:31,729][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:44:31,730][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:44:31,730][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:44:31,757][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:44:31,758][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:44:31,758][dance][wrapped_func] Took 0:00:11.132973 to load and process data.
[WARNING][2024-03-21 21:44:31,769][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 21:44:31,770][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:44:31,778][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 21:44:33,534][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 21:44:41,379][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 21867) (k=183)
[INFO][2024-03-21 21:44:41,380][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.05%
[INFO][2024-03-21 21:44:42,373][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:44:42,373][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.013 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run sage-sweep-124 at: https://wandb.ai/xzy11632/dance-dev/runs/c3h800gh
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_214411-c3h800gh/logs
wandb: Agent Starting Run: ul524wui with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_214506-ul524wui
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run eager-sweep-125
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ul524wui
[INFO][2024-03-21 21:45:14,156][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:45:14,156][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:45:14,158][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 21:45:14,163][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:45:17,530][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:45:18,086][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:45:18,104][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:45:21,413][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:45:21,414][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:45:21,414][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:45:21,427][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:45:21,427][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:45:21,456][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:45:21,457][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:45:21,457][dance][wrapped_func] Took 0:00:07.294651 to load and process data.
[WARNING][2024-03-21 21:45:21,466][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 21:45:21,467][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:45:21,480][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 21:45:23,690][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 21:46:24,997][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 21867) (k=183)
[INFO][2024-03-21 21:46:25,003][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.89%
[INFO][2024-03-21 21:46:25,581][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:46:25,581][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run eager-sweep-125 at: https://wandb.ai/xzy11632/dance-dev/runs/ul524wui
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_214506-ul524wui/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: dzhq3w4g with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_214648-dzhq3w4g
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dutiful-sweep-126
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/dzhq3w4g
[INFO][2024-03-21 21:46:54,672][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:46:54,672][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:46:54,674][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'FilterGenesRegression',
 'CellPCA',
 None][0m
[INFO][2024-03-21 21:46:54,680][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:46:55,650][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:46:56,444][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:46:56,448][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:46:58,149][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:46:58,150][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:46:58,150][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:46:58,150][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:46:58,151][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:46:58,172][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:46:58,173][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:46:58,173][dance][wrapped_func] Took 0:00:03.494300 to load and process data.
[WARNING][2024-03-21 21:46:58,182][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:46:58,189][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 21:47:00,300][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 21:47:26,230][dance.CellPCA][__call__] Generating cell PCA features (466, 21867) (k=324)
[INFO][2024-03-21 21:47:26,231][dance.CellPCA][__call__] Top 10 explained variances: [0.12962113 0.01239563 0.00985748 0.00651145 0.00610012 0.00596467
 0.00579483 0.00568479 0.00540166 0.00529312]
[INFO][2024-03-21 21:47:26,231][dance.CellPCA][__call__] Total explained variance: 90.04%
[INFO][2024-03-21 21:47:26,236][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:47:26,236][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.51908
wandb: 
wandb: üöÄ View run dutiful-sweep-126 at: https://wandb.ai/xzy11632/dance-dev/runs/dzhq3w4g
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_214648-dzhq3w4g/logs
wandb: Agent Starting Run: mstv9fv0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_214741-mstv9fv0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run trim-sweep-127
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/mstv9fv0
[INFO][2024-03-21 21:47:47,041][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:47:47,041][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:47:47,043][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'FilterGenesRegression',
 'CellSVD',
 None][0m
[INFO][2024-03-21 21:47:47,048][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:47:47,961][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:47:48,216][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:47:48,220][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:47:49,730][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:47:49,730][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:47:49,730][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:47:49,730][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:47:49,731][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:47:49,743][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:47:49,744][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:47:49,744][dance][wrapped_func] Took 0:00:02.696176 to load and process data.
[WARNING][2024-03-21 21:47:49,752][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:47:49,759][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 21:47:51,088][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 21:49:05,948][dance.CellSVD][__call__] Generating cell SVD features (466, 21867) (k=325)
[INFO][2024-03-21 21:49:05,949][dance.CellSVD][__call__] Top 10 explained variances: [0.1295687  0.00973311 0.00682385 0.00950398 0.00611377 0.00597477
 0.00596467 0.00579451 0.00567812 0.00532615]
[INFO][2024-03-21 21:49:05,949][dance.CellSVD][__call__] Total explained variance: 89.87%
[INFO][2024-03-21 21:49:05,956][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:49:05,956][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.50763
wandb: 
wandb: üöÄ View run trim-sweep-127 at: https://wandb.ai/xzy11632/dance-dev/runs/mstv9fv0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_214741-mstv9fv0/logs
wandb: Agent Starting Run: avoa0y34 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_214919-avoa0y34
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fiery-sweep-128
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/avoa0y34
[INFO][2024-03-21 21:49:25,818][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:49:25,818][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:49:25,820][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'FilterGenesRegression',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 21:49:25,827][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:49:26,891][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:49:27,199][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:49:27,217][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:49:28,232][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:49:28,232][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:49:28,232][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:49:28,233][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:49:28,233][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:49:28,235][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:49:28,236][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:49:28,236][dance][wrapped_func] Took 0:00:02.409366 to load and process data.
[WARNING][2024-03-21 21:49:28,245][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 21:49:28,246][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 21:49:28,246][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:49:28,252][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 21:49:28,531][dance][_filter_enclasc] Start generating cell features using EnClaSC
[WARNING][2024-03-21 21:49:28,557][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 21:49:28,557][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 21:49:31,921][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:49:31,923][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.62121
wandb:  test_acc 0.14493
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run fiery-sweep-128 at: https://wandb.ai/xzy11632/dance-dev/runs/avoa0y34
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_214919-avoa0y34/logs
wandb: Agent Starting Run: ciyjfh8b with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_214950-ciyjfh8b
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run grateful-sweep-129
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ciyjfh8b
[INFO][2024-03-21 21:49:56,413][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:49:56,413][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:49:56,415][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 21:49:56,428][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:49:56,888][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:49:57,151][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:49:57,155][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:49:57,364][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:49:57,365][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:49:57,365][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:49:57,365][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:49:57,365][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:49:57,367][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:49:57,369][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:49:57,370][dance][wrapped_func] Took 0:00:00.942346 to load and process data.
[WARNING][2024-03-21 21:49:57,378][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:49:57,384][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 21:49:57,670][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 21:50:04,369][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 21867) (k=183)
[INFO][2024-03-21 21:50:04,383][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.05%
[INFO][2024-03-21 21:50:04,552][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:50:04,552][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run grateful-sweep-129 at: https://wandb.ai/xzy11632/dance-dev/runs/ciyjfh8b
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_214950-ciyjfh8b/logs
wandb: Agent Starting Run: ftzr8ugs with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_215017-ftzr8ugs
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run warm-sweep-130
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ftzr8ugs
[INFO][2024-03-21 21:50:23,814][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:50:23,818][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:50:23,820][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 21:50:23,827][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:50:24,961][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:50:25,213][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:50:25,217][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:50:26,931][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:50:26,931][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:50:26,931][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:50:26,932][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:50:26,932][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:50:26,941][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:50:26,941][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:50:26,941][dance][wrapped_func] Took 0:00:03.114615 to load and process data.
[WARNING][2024-03-21 21:50:26,950][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:50:26,956][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 21:50:28,899][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 21:50:58,525][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 21867) (k=183)
[INFO][2024-03-21 21:50:58,535][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.89%
[INFO][2024-03-21 21:50:59,362][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:50:59,363][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run warm-sweep-130 at: https://wandb.ai/xzy11632/dance-dev/runs/ftzr8ugs
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_215017-ftzr8ugs/logs
wandb: Agent Starting Run: 5zsj9nyw with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_215114-5zsj9nyw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run noble-sweep-131
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/5zsj9nyw
[INFO][2024-03-21 21:51:19,307][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:51:19,307][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:51:19,309][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile', 'ScaleFeature', 'FilterGenesTopK', 'CellPCA', None][0m
[INFO][2024-03-21 21:51:19,314][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:51:20,554][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:51:20,767][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:51:20,771][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:51:23,741][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:51:23,741][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:51:23,741][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:51:23,742][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:51:23,742][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:51:23,755][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:51:23,756][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:51:23,756][dance][wrapped_func] Took 0:00:04.442154 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 21:51:23,765][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:51:23,770][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 21:51:35,529][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=273)
[INFO][2024-03-21 21:51:35,529][dance.CellPCA][__call__] Top 10 explained variances: [0.18763506 0.01687237 0.01127613 0.00824903 0.00726683 0.00700421
 0.00639412 0.00617347 0.00613042 0.00600407]
[INFO][2024-03-21 21:51:35,530][dance.CellPCA][__call__] Total explained variance: 90.09%
[INFO][2024-03-21 21:51:35,530][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:51:35,530][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.39695
wandb: 
wandb: üöÄ View run noble-sweep-131 at: https://wandb.ai/xzy11632/dance-dev/runs/5zsj9nyw
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_215114-5zsj9nyw/logs
wandb: Agent Starting Run: tjx44obp with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_215148-tjx44obp
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run tough-sweep-132
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/tjx44obp
[INFO][2024-03-21 21:51:54,157][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:51:54,158][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:51:54,159][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile', 'ScaleFeature', 'FilterGenesTopK', 'CellSVD', None][0m
[INFO][2024-03-21 21:51:54,170][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:51:55,137][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:51:55,272][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:51:55,275][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:51:57,520][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:51:57,520][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:51:57,520][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:51:57,520][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:51:57,521][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:51:57,535][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:51:57,535][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:51:57,536][dance][wrapped_func] Took 0:00:03.365863 to load and process data.
[WARNING][2024-03-21 21:51:57,544][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:51:57,551][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 21:52:40,453][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=273)
[INFO][2024-03-21 21:52:40,455][dance.CellSVD][__call__] Top 10 explained variances: [0.1876312  0.01686738 0.01127027 0.00824199 0.00725938 0.00699835
 0.00638682 0.00616329 0.00612435 0.00599736]
[INFO][2024-03-21 21:52:40,455][dance.CellSVD][__call__] Total explained variance: 89.89%
[INFO][2024-03-21 21:52:40,457][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:52:40,457][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run tough-sweep-132 at: https://wandb.ai/xzy11632/dance-dev/runs/tjx44obp
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_215148-tjx44obp/logs
wandb: Agent Starting Run: krxt8gtm with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_215252-krxt8gtm
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fearless-sweep-133
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/krxt8gtm
[INFO][2024-03-21 21:52:58,691][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:52:58,692][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:52:58,693][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'FilterGenesTopK',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 21:52:58,699][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:52:59,344][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:52:59,521][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:52:59,524][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:53:01,790][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:53:01,790][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:53:01,790][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:53:01,791][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:53:01,791][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:53:01,808][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:53:01,808][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:53:01,809][dance][wrapped_func] Took 0:00:03.110188 to load and process data.
[WARNING][2024-03-21 21:53:01,820][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 21:53:01,821][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 21:53:01,821][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:53:01,830][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[WARNING][2024-03-21 21:53:03,464][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 21:53:03,465][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 21:53:03,517][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:53:03,517][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.017 MB of 0.025 MB uploadedwandb: \ 0.017 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.56107
wandb: 
wandb: üöÄ View run fearless-sweep-133 at: https://wandb.ai/xzy11632/dance-dev/runs/krxt8gtm
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_215252-krxt8gtm/logs
wandb: Agent Starting Run: c5bp7uso with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_215319-c5bp7uso
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run twilight-sweep-134
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/c5bp7uso
[INFO][2024-03-21 21:53:24,559][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:53:24,559][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:53:24,561][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 21:53:24,566][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:53:25,808][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:53:25,963][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:53:25,966][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:53:27,761][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:53:27,761][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:53:27,761][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:53:27,761][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:53:27,761][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:53:27,768][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:53:27,769][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:53:27,769][dance][wrapped_func] Took 0:00:03.202747 to load and process data.
[WARNING][2024-03-21 21:53:27,777][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:53:27,784][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 21:53:30,421][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=159)
[INFO][2024-03-21 21:53:30,421][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.06%
[INFO][2024-03-21 21:53:30,553][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:53:30,553][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run twilight-sweep-134 at: https://wandb.ai/xzy11632/dance-dev/runs/c5bp7uso
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_215319-c5bp7uso/logs
wandb: Agent Starting Run: 0j5nuuda with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_215345-0j5nuuda
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run spring-sweep-135
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/0j5nuuda
[INFO][2024-03-21 21:53:51,180][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:53:51,180][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:53:51,182][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 21:53:51,187][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:53:52,741][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:53:52,926][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:53:52,930][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:53:55,008][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:53:55,008][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:53:55,008][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:53:55,009][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:53:55,009][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:53:55,017][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:53:55,017][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:53:55,017][dance][wrapped_func] Took 0:00:03.830365 to load and process data.
[WARNING][2024-03-21 21:53:55,025][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:53:55,030][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 21:54:02,849][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=157)
[INFO][2024-03-21 21:54:02,850][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.55%
[INFO][2024-03-21 21:54:02,881][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:54:02,882][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.017 MB of 0.025 MB uploadedwandb: | 0.017 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run spring-sweep-135 at: https://wandb.ai/xzy11632/dance-dev/runs/0j5nuuda
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_215345-0j5nuuda/logs
wandb: Agent Starting Run: 2m97jxsx with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_215416-2m97jxsx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fancy-sweep-136
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/2m97jxsx
[INFO][2024-03-21 21:54:21,968][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:54:21,969][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:54:21,970][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellPCA',
 None][0m
[INFO][2024-03-21 21:54:21,975][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:54:23,488][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:54:23,692][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:54:23,696][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:54:26,063][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:54:26,063][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:54:26,063][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:54:26,063][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:54:26,063][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:54:26,072][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:54:26,072][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:54:26,072][dance][wrapped_func] Took 0:00:04.097965 to load and process data.
[WARNING][2024-03-21 21:54:26,080][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:54:26,086][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run fancy-sweep-136 at: https://wandb.ai/xzy11632/dance-dev/runs/2m97jxsx
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_215416-2m97jxsx/logs
wandb: ERROR Run 2m97jxsx errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/cell_feature.py", line 142, in __call__
wandb: ERROR     cell_feat = pca.fit_transform(feat)
wandb: ERROR                 ^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
wandb: ERROR     data_to_wrap = f(self, X, *args, **kwargs)
wandb: ERROR                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 1152, in wrapper
wandb: ERROR     return fit_method(estimator, *args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 460, in fit_transform
wandb: ERROR     U, S, Vt = self._fit(X)
wandb: ERROR                ^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 483, in _fit
wandb: ERROR     X = self._validate_data(
wandb: ERROR         ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 605, in _validate_data
wandb: ERROR     out = check_array(X, input_name="X", **check_params)
wandb: ERROR           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/validation.py", line 976, in check_array
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: Found array with 0 feature(s) (shape=(466, 0)) while a minimum of 1 is required by PCA.
wandb: ERROR 
wandb: Agent Starting Run: kvyly3ds with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_215443-kvyly3ds
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run comic-sweep-137
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/kvyly3ds
[INFO][2024-03-21 21:54:50,452][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:54:50,453][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:54:50,454][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellSVD',
 None][0m
[INFO][2024-03-21 21:54:50,459][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:54:51,642][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:54:51,849][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:54:51,853][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:54:55,172][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:54:55,173][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:54:55,173][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:54:55,173][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:54:55,173][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:54:55,182][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:54:55,183][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:54:55,183][dance][wrapped_func] Took 0:00:04.724539 to load and process data.
[WARNING][2024-03-21 21:54:55,194][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:54:55,202][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.013 MB uploadedwandb: - 0.012 MB of 0.013 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run comic-sweep-137 at: https://wandb.ai/xzy11632/dance-dev/runs/kvyly3ds
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_215443-kvyly3ds/logs
wandb: ERROR Run kvyly3ds errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/cell_feature.py", line 179, in __call__
wandb: ERROR     svd.fit_transform(feat)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
wandb: ERROR     data_to_wrap = f(self, X, *args, **kwargs)
wandb: ERROR                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 1145, in wrapper
wandb: ERROR     estimator._validate_params()
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 638, in _validate_params
wandb: ERROR     validate_parameter_constraints(
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_param_validation.py", line 96, in validate_parameter_constraints
wandb: ERROR     raise InvalidParameterError(
wandb: ERROR sklearn.utils._param_validation.InvalidParameterError: The 'n_components' parameter of TruncatedSVD must be an int in the range [1, inf). Got -1 instead.
wandb: ERROR 
wandb: Agent Starting Run: 476ykk2u with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_215510-476ykk2u
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run proud-sweep-138
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/476ykk2u
[INFO][2024-03-21 21:55:16,849][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:55:16,850][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:55:16,852][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 21:55:16,857][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:55:18,273][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:55:18,441][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:55:18,444][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:55:20,198][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:55:20,198][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:55:20,198][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:55:20,198][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:55:20,199][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:55:20,211][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:55:20,211][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:55:20,212][dance][wrapped_func] Took 0:00:03.355206 to load and process data.
[WARNING][2024-03-21 21:55:20,222][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 21:55:20,222][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 21:55:20,223][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:55:20,231][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 21:55:21,559][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 21:55:21,559][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 21:55:21,560][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:55:21,560][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/torch/nn/init.py:405: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/torch/nn/modules/linear.py:114: UserWarning: An output with one or more elements was resized since it had shape [128, 2000], which does not match the required output shape [2000]. This behavior is deprecated, and in a future PyTorch release outputs will not be resized unless they have zero elements. You can explicitly reuse an out tensor t by resizing it, inplace, to zero elements with t.resize_(0). (Triggered internally at ../aten/src/ATen/native/Resize.cpp:26.)
  return F.linear(input, self.weight, self.bias)
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.018 MB of 0.026 MB uploadedwandb: | 0.018 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run proud-sweep-138 at: https://wandb.ai/xzy11632/dance-dev/runs/476ykk2u
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_215510-476ykk2u/logs
wandb: ERROR Run 476ykk2u errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 83, in evaluate_pipeline
wandb: ERROR     model.fit(x_train, y_train, seed=args.seed, lr=args.learning_rate, num_epochs=args.num_epochs,
wandb: ERROR   File "/home/zyxing/dance/dance/modules/single_modality/cell_type_annotation/actinn.py", line 162, in fit
wandb: ERROR     batch_cost = self.compute_loss(self.model(batch_x), batch_y)
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/modules/single_modality/cell_type_annotation/actinn.py", line 87, in compute_loss
wandb: ERROR     loss = nn.NLLLoss()(log_prob, y)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
wandb: ERROR     return forward_call(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 216, in forward
wandb: ERROR     return F.nll_loss(input, target, weight=self.weight, ignore_index=self.ignore_index, reduction=self.reduction)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/torch/nn/functional.py", line 2704, in nll_loss
wandb: ERROR     return torch._C._nn.nll_loss_nd(input, target, weight, _Reduction.get_enum(reduction), ignore_index)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR RuntimeError: size mismatch (got input: [8], target: [128])
wandb: ERROR 
wandb: Agent Starting Run: c9m5gcgu with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_215537-c9m5gcgu
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run grateful-sweep-139
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/c9m5gcgu
[INFO][2024-03-21 21:55:44,389][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:55:44,390][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:55:44,391][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 21:55:44,396][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:55:46,306][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:55:46,638][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:55:46,641][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:55:50,677][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:55:50,678][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:55:50,678][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:55:50,678][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:55:50,678][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:55:50,692][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:55:50,692][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:55:50,693][dance][wrapped_func] Took 0:00:06.297113 to load and process data.
[WARNING][2024-03-21 21:55:50,702][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:55:50,708][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run grateful-sweep-139 at: https://wandb.ai/xzy11632/dance-dev/runs/c9m5gcgu
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_215537-c9m5gcgu/logs
wandb: ERROR Run c9m5gcgu errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/cell_feature.py", line 50, in __call__
wandb: ERROR     gene_feat = gene_pca.fit_transform(feat.T)  # decompose into gene features
wandb: ERROR                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
wandb: ERROR     data_to_wrap = f(self, X, *args, **kwargs)
wandb: ERROR                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 1152, in wrapper
wandb: ERROR     return fit_method(estimator, *args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 460, in fit_transform
wandb: ERROR     U, S, Vt = self._fit(X)
wandb: ERROR                ^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 483, in _fit
wandb: ERROR     X = self._validate_data(
wandb: ERROR         ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 605, in _validate_data
wandb: ERROR     out = check_array(X, input_name="X", **check_params)
wandb: ERROR           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/validation.py", line 967, in check_array
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: Found array with 0 sample(s) (shape=(0, 262)) while a minimum of 1 is required by PCA.
wandb: ERROR 
wandb: Agent Starting Run: nr4qpebe with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_215610-nr4qpebe
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run toasty-sweep-140
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/nr4qpebe
[INFO][2024-03-21 21:56:17,558][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:56:17,558][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:56:17,560][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 21:56:17,564][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:56:18,127][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:56:18,337][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:56:18,340][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:56:18,570][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:56:18,571][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:56:18,571][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:56:18,571][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:56:18,571][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:56:18,573][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:56:18,574][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:56:18,574][dance][wrapped_func] Took 0:00:01.010225 to load and process data.
[WARNING][2024-03-21 21:56:18,587][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:56:18,594][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.013 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run toasty-sweep-140 at: https://wandb.ai/xzy11632/dance-dev/runs/nr4qpebe
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_215610-nr4qpebe/logs
wandb: ERROR Run nr4qpebe errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/cell_feature.py", line 97, in __call__
wandb: ERROR     svd.fit_transform(feat)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
wandb: ERROR     data_to_wrap = f(self, X, *args, **kwargs)
wandb: ERROR                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 1145, in wrapper
wandb: ERROR     estimator._validate_params()
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 638, in _validate_params
wandb: ERROR     validate_parameter_constraints(
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_param_validation.py", line 96, in validate_parameter_constraints
wandb: ERROR     raise InvalidParameterError(
wandb: ERROR sklearn.utils._param_validation.InvalidParameterError: The 'n_components' parameter of TruncatedSVD must be an int in the range [1, inf). Got -1 instead.
wandb: ERROR 
wandb: Agent Starting Run: iar8ol8s with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_215637-iar8ol8s
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fast-sweep-141
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/iar8ol8s
[INFO][2024-03-21 21:56:44,165][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:56:44,165][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:56:44,166][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellPCA',
 None][0m
[INFO][2024-03-21 21:56:44,178][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:56:44,674][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:56:44,898][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:56:44,902][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:56:45,466][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:56:45,469][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:56:45,469][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:56:45,469][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:56:45,469][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:56:45,471][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:56:45,471][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:56:45,472][dance][wrapped_func] Took 0:00:01.293708 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 21:56:45,480][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:56:45,524][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[INFO][2024-03-21 21:56:58,061][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=284)
[INFO][2024-03-21 21:56:58,061][dance.CellPCA][__call__] Top 10 explained variances: [0.03180153 0.01068398 0.0104881  0.00913671 0.00765239 0.00743921
 0.00712582 0.00701963 0.00686424 0.0065345 ]
[INFO][2024-03-21 21:56:58,062][dance.CellPCA][__call__] Total explained variance: 90.06%
[INFO][2024-03-21 21:56:58,062][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:56:58,062][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run fast-sweep-141 at: https://wandb.ai/xzy11632/dance-dev/runs/iar8ol8s
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_215637-iar8ol8s/logs
wandb: Agent Starting Run: 2u9av7y2 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_215717-2u9av7y2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sage-sweep-142
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/2u9av7y2
[INFO][2024-03-21 21:57:25,097][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:57:25,097][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:57:25,099][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellSVD',
 None][0m
[INFO][2024-03-21 21:57:25,104][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:57:25,726][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:57:25,920][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:57:25,924][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:57:26,187][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:57:26,187][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:57:26,188][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:57:26,188][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:57:26,189][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:57:26,191][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:57:26,191][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:57:26,192][dance][wrapped_func] Took 0:00:01.087874 to load and process data.
[WARNING][2024-03-21 21:57:26,203][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:57:26,210][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[INFO][2024-03-21 21:59:15,169][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=285)
[INFO][2024-03-21 21:59:15,183][dance.CellSVD][__call__] Top 10 explained variances: [0.03142621 0.00711181 0.01053196 0.00939789 0.00804016 0.00762454
 0.00728951 0.0071256  0.00686832 0.00680585]
[INFO][2024-03-21 21:59:15,183][dance.CellSVD][__call__] Total explained variance: 89.95%
[INFO][2024-03-21 21:59:15,184][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:59:15,184][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run sage-sweep-142 at: https://wandb.ai/xzy11632/dance-dev/runs/2u9av7y2
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_215717-2u9av7y2/logs
wandb: Agent Starting Run: ww5aozc2 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_215928-ww5aozc2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fluent-sweep-143
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ww5aozc2
[INFO][2024-03-21 21:59:35,085][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 21:59:35,085][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 21:59:35,086][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 21:59:35,092][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 21:59:35,685][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 21:59:35,893][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 21:59:35,901][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 21:59:36,209][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 21:59:36,209][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 21:59:36,210][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 21:59:36,210][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 21:59:36,210][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 21:59:36,212][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 21:59:36,213][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 21:59:36,213][dance][wrapped_func] Took 0:00:01.121390 to load and process data.
[WARNING][2024-03-21 21:59:36,224][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 21:59:36,224][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 21:59:36,225][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 21:59:36,231][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 21:59:36,955][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 21:59:36,957][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 21:59:37,031][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 21:59:37,032][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.39313
wandb: 
wandb: üöÄ View run fluent-sweep-143 at: https://wandb.ai/xzy11632/dance-dev/runs/ww5aozc2
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_215928-ww5aozc2/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: p8iq1ykw with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_220001-p8iq1ykw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run still-sweep-144
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/p8iq1ykw
[INFO][2024-03-21 22:00:15,651][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:00:15,653][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:00:15,655][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 22:00:15,674][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:00:16,654][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:00:17,065][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:00:17,095][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:00:17,755][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:00:17,756][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:00:17,756][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:00:17,757][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:00:17,757][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:00:17,759][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:00:17,761][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:00:17,761][dance][wrapped_func] Took 0:00:02.088847 to load and process data.
[WARNING][2024-03-21 22:00:17,794][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:00:17,871][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[INFO][2024-03-21 22:00:21,292][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=165)
[INFO][2024-03-21 22:00:21,293][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.17%
[INFO][2024-03-21 22:00:21,413][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:00:21,420][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run still-sweep-144 at: https://wandb.ai/xzy11632/dance-dev/runs/p8iq1ykw
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_220001-p8iq1ykw/logs
wandb: Agent Starting Run: bhhx5th8 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_220047-bhhx5th8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run valiant-sweep-145
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/bhhx5th8
[INFO][2024-03-21 22:01:01,521][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:01:01,521][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:01:01,522][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 22:01:01,527][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:01:02,869][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:01:03,860][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:01:03,888][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:01:04,764][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:01:04,764][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:01:04,764][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:01:04,764][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:01:04,765][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:01:04,767][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:01:04,767][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:01:04,767][dance][wrapped_func] Took 0:00:03.240314 to load and process data.
[WARNING][2024-03-21 22:01:04,775][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:01:04,792][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
[INFO][2024-03-21 22:02:03,331][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=165)
[INFO][2024-03-21 22:02:03,331][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.04%
[INFO][2024-03-21 22:02:03,398][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:02:03,399][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run valiant-sweep-145 at: https://wandb.ai/xzy11632/dance-dev/runs/bhhx5th8
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_220047-bhhx5th8/logs
wandb: Agent Starting Run: av0k7gpv with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_220222-av0k7gpv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run celestial-sweep-146
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/av0k7gpv
[INFO][2024-03-21 22:02:36,047][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:02:36,047][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:02:36,049][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'CellPCA',
 None][0m
[INFO][2024-03-21 22:02:36,061][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:02:37,244][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:02:37,854][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:02:37,857][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:02:38,533][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:02:38,533][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:02:38,534][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:02:38,534][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:02:38,534][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:02:38,536][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:02:38,537][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:02:38,537][dance][wrapped_func] Took 0:00:02.475909 to load and process data.
[WARNING][2024-03-21 22:02:38,547][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:02:38,565][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-21 22:02:50,283][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=293)
[INFO][2024-03-21 22:02:50,285][dance.CellPCA][__call__] Top 10 explained variances: [0.06094072 0.01422031 0.0120164  0.00917147 0.00837025 0.00805564
 0.00741076 0.00719776 0.00690539 0.00672044]
[INFO][2024-03-21 22:02:50,286][dance.CellPCA][__call__] Total explained variance: 90.07%
[INFO][2024-03-21 22:02:50,287][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:02:50,288][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run celestial-sweep-146 at: https://wandb.ai/xzy11632/dance-dev/runs/av0k7gpv
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_220222-av0k7gpv/logs
wandb: Agent Starting Run: 6o0pk43i with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_220312-6o0pk43i
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run pretty-sweep-147
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/6o0pk43i
[INFO][2024-03-21 22:03:23,506][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:03:23,506][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:03:23,508][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'CellSVD',
 None][0m
[INFO][2024-03-21 22:03:23,512][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:03:24,608][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:03:25,060][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:03:25,064][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:03:27,845][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:03:27,848][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:03:27,848][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:03:27,849][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:03:27,849][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:03:27,852][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:03:27,854][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:03:27,855][dance][wrapped_func] Took 0:00:04.343308 to load and process data.
[WARNING][2024-03-21 22:03:27,878][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:03:27,898][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-21 22:05:49,080][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=293)
[INFO][2024-03-21 22:05:49,091][dance.CellSVD][__call__] Top 10 explained variances: [0.06080554 0.01329516 0.00721784 0.01132097 0.00909877 0.00826956
 0.00766428 0.00734264 0.0069492  0.0068071 ]
[INFO][2024-03-21 22:05:49,098][dance.CellSVD][__call__] Total explained variance: 89.87%
[INFO][2024-03-21 22:05:49,105][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:05:49,115][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.013 MB uploadedwandb: | 0.018 MB of 0.025 MB uploadedwandb: / 0.018 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run pretty-sweep-147 at: https://wandb.ai/xzy11632/dance-dev/runs/6o0pk43i
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_220312-6o0pk43i/logs
wandb: Agent Starting Run: i6iz0cno with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_220611-i6iz0cno
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run scarlet-sweep-148
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/i6iz0cno
[INFO][2024-03-21 22:06:20,905][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:06:20,905][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:06:20,906][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 22:06:20,915][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:06:21,776][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:06:22,055][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:06:22,059][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:06:22,372][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:06:22,373][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:06:22,373][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:06:22,374][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:06:22,374][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:06:22,376][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:06:22,376][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:06:22,376][dance][wrapped_func] Took 0:00:01.461868 to load and process data.
[WARNING][2024-03-21 22:06:22,417][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:06:22,417][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 22:06:22,418][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:06:22,436][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-21 22:06:23,240][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:06:23,242][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 22:06:23,413][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:06:23,413][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.40458
wandb: 
wandb: üöÄ View run scarlet-sweep-148 at: https://wandb.ai/xzy11632/dance-dev/runs/i6iz0cno
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_220611-i6iz0cno/logs
wandb: Agent Starting Run: a8tacdhu with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_220642-a8tacdhu
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run major-sweep-149
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/a8tacdhu
[INFO][2024-03-21 22:06:51,660][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:06:51,660][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:06:51,661][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 22:06:51,673][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:06:52,694][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:06:52,965][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:06:52,969][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:06:53,337][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:06:53,345][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:06:53,347][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:06:53,348][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:06:53,348][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:06:53,351][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:06:53,355][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:06:53,356][dance][wrapped_func] Took 0:00:01.682994 to load and process data.
[WARNING][2024-03-21 22:06:53,376][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:06:53,412][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-21 22:06:57,547][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=171)
[INFO][2024-03-21 22:06:57,548][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.07%
[INFO][2024-03-21 22:06:57,656][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:06:57,657][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run major-sweep-149 at: https://wandb.ai/xzy11632/dance-dev/runs/a8tacdhu
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_220642-a8tacdhu/logs
wandb: Agent Starting Run: 7a32v42m with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_220718-7a32v42m
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rosy-sweep-150
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/7a32v42m
[INFO][2024-03-21 22:07:31,905][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:07:31,905][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:07:31,907][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 22:07:31,912][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:07:32,611][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:07:32,827][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:07:32,835][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:07:33,138][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:07:33,139][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:07:33,140][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:07:33,140][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:07:33,140][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:07:33,144][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:07:33,145][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:07:33,146][dance][wrapped_func] Took 0:00:01.233697 to load and process data.
[WARNING][2024-03-21 22:07:33,158][dance.FilterGenesPercentile][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:07:33,166][dance.FilterGenesPercentile][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-21 22:08:44,571][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=171)
[INFO][2024-03-21 22:08:44,583][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.93%
[INFO][2024-03-21 22:08:44,634][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:08:44,639][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run rosy-sweep-150 at: https://wandb.ai/xzy11632/dance-dev/runs/7a32v42m
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_220718-7a32v42m/logs
wandb: Agent Starting Run: 59dgqjxt with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_220859-59dgqjxt
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dauntless-sweep-151
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/59dgqjxt
[INFO][2024-03-21 22:09:08,649][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:09:08,649][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:09:08,650][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'FilterGenesNumberPlaceHolder',
 'CellPCA',
 None][0m
[INFO][2024-03-21 22:09:08,666][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:09:09,641][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:09:09,917][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:09:09,922][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:09:10,290][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:09:10,297][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:09:10,298][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:09:10,298][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:09:10,298][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:09:10,302][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:09:10,305][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:09:10,305][dance][wrapped_func] Took 0:00:01.639022 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 22:09:10,390][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:09:10,391][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:09:10,392][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:09:10,429][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:09:10,431][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 22:09:10,488][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:09:32,416][dance.CellPCA][__call__] Generating cell PCA features (466, 22088) (k=362)
[INFO][2024-03-21 22:09:32,416][dance.CellPCA][__call__] Top 10 explained variances: [0.1143287  0.03756818 0.02089324 0.01997864 0.01090698 0.00894295
 0.00699869 0.00616712 0.00582356 0.00529302]
[INFO][2024-03-21 22:09:32,416][dance.CellPCA][__call__] Total explained variance: 90.07%
[INFO][2024-03-21 22:09:32,432][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:09:32,432][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.39394
wandb:  test_acc 0.26087
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run dauntless-sweep-151 at: https://wandb.ai/xzy11632/dance-dev/runs/59dgqjxt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_220859-59dgqjxt/logs
wandb: Agent Starting Run: 0xjzdd4z with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_220951-0xjzdd4z
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run hearty-sweep-152
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/0xjzdd4z
[INFO][2024-03-21 22:10:02,200][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:10:02,200][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:10:02,201][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'FilterGenesNumberPlaceHolder',
 'CellSVD',
 None][0m
[INFO][2024-03-21 22:10:02,206][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:10:03,147][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:10:03,750][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:10:03,761][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:10:04,314][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:10:04,315][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:10:04,315][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:10:04,315][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:10:04,315][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:10:04,319][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:10:04,319][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:10:04,319][dance][wrapped_func] Took 0:00:02.113136 to load and process data.
[WARNING][2024-03-21 22:10:04,342][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:10:04,342][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:10:04,343][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:10:04,379][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:10:04,381][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 22:10:04,403][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:12:56,499][dance.CellSVD][__call__] Generating cell SVD features (466, 22088) (k=363)
[INFO][2024-03-21 22:12:56,505][dance.CellSVD][__call__] Top 10 explained variances: [0.09542988 0.0379401  0.03076899 0.02067343 0.01136558 0.01016332
 0.00801424 0.00698474 0.00615151 0.00575116]
[INFO][2024-03-21 22:12:56,505][dance.CellSVD][__call__] Total explained variance: 89.72%
[INFO][2024-03-21 22:12:56,507][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:12:56,507][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.018 MB of 0.026 MB uploadedwandb: | 0.018 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.37879
wandb:  test_acc 0.30435
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run hearty-sweep-152 at: https://wandb.ai/xzy11632/dance-dev/runs/0xjzdd4z
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_220951-0xjzdd4z/logs
wandb: Agent Starting Run: yw19pggc with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_221315-yw19pggc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sleek-sweep-153
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/yw19pggc
[INFO][2024-03-21 22:13:43,869][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:13:43,869][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:13:43,870][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'FilterGenesNumberPlaceHolder',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 22:13:43,893][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:13:44,876][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:13:45,207][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:13:45,211][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:13:48,120][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:13:48,123][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:13:48,123][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:13:48,123][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:13:48,124][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:13:48,127][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:13:48,130][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:13:48,131][dance][wrapped_func] Took 0:00:04.238994 to load and process data.
[WARNING][2024-03-21 22:13:48,155][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:13:48,157][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:13:48,159][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:13:48,160][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 22:13:48,161][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:13:48,195][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:13:48,205][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 22:13:48,227][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:13:48,230][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:13:48,231][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 22:13:52,748][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:13:52,749][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.83333
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run sleek-sweep-153 at: https://wandb.ai/xzy11632/dance-dev/runs/yw19pggc
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_221315-yw19pggc/logs
wandb: Agent Starting Run: svm54f4w with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_221414-svm54f4w
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rare-sweep-154
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/svm54f4w
[INFO][2024-03-21 22:14:34,979][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:14:34,980][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:14:34,982][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 22:14:34,988][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:14:35,658][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:14:35,976][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:14:35,979][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:14:36,906][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:14:36,907][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:14:36,907][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:14:36,907][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:14:36,907][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:14:36,916][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:14:36,917][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:14:36,917][dance][wrapped_func] Took 0:00:01.929575 to load and process data.
[WARNING][2024-03-21 22:14:36,929][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:14:36,930][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:14:36,930][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:14:36,973][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:14:36,989][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 22:14:37,007][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:14:42,639][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 22088) (k=185)
[INFO][2024-03-21 22:14:42,641][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.12%
[INFO][2024-03-21 22:14:42,827][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:14:42,828][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.013 MB uploadedwandb: \ 0.012 MB of 0.013 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.60606
wandb:  test_acc 0.22464
wandb: train_acc 0.76336
wandb: 
wandb: üöÄ View run rare-sweep-154 at: https://wandb.ai/xzy11632/dance-dev/runs/svm54f4w
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_221414-svm54f4w/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: mqjndwff with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_221514-mqjndwff
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rare-sweep-155
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/mqjndwff
[INFO][2024-03-21 22:15:33,349][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:15:33,349][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:15:33,351][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 22:15:33,356][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:15:34,755][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:15:35,156][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:15:35,161][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:15:36,081][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:15:36,083][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:15:36,093][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:15:36,094][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:15:36,095][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:15:36,100][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:15:36,107][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:15:36,116][dance][wrapped_func] Took 0:00:02.760948 to load and process data.
[WARNING][2024-03-21 22:15:36,149][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:15:36,150][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:15:36,150][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:15:36,182][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:15:36,194][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 22:15:36,244][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:16:50,868][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 22088) (k=208)
[INFO][2024-03-21 22:16:50,870][dance.WeightedFeatureSVD][__call__] Total explained variance: 93.43%
[INFO][2024-03-21 22:16:50,945][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:16:50,946][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.60606
wandb:  test_acc 0.21739
wandb: train_acc 0.73664
wandb: 
wandb: üöÄ View run rare-sweep-155 at: https://wandb.ai/xzy11632/dance-dev/runs/mqjndwff
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_221514-mqjndwff/logs
wandb: Agent Starting Run: cucfxmbl with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_221708-cucfxmbl
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lyric-sweep-156
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/cucfxmbl
[INFO][2024-03-21 22:17:15,230][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:17:15,230][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:17:15,231][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder', 'Log1P', 'FilterGenesRegression', 'CellPCA', None][0m
[INFO][2024-03-21 22:17:15,236][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:17:15,722][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:17:15,986][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:17:15,989][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:17:16,193][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:17:16,194][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:17:16,194][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:17:16,195][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:17:16,195][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:17:16,197][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:17:16,198][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:17:16,199][dance][wrapped_func] Took 0:00:00.962466 to load and process data.
[WARNING][2024-03-21 22:17:16,210][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:17:16,211][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:17:16,229][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:17:16,230][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 22:17:16,402][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 22:17:26,568][dance.CellPCA][__call__] Generating cell PCA features (466, 22088) (k=362)
[INFO][2024-03-21 22:17:26,571][dance.CellPCA][__call__] Top 10 explained variances: [0.1143287  0.03756818 0.02089324 0.01997864 0.01090698 0.00894295
 0.00699869 0.00616712 0.00582356 0.00529302]
[INFO][2024-03-21 22:17:26,572][dance.CellPCA][__call__] Total explained variance: 90.07%
[INFO][2024-03-21 22:17:26,573][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:17:26,574][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.39394
wandb:  test_acc 0.26087
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run lyric-sweep-156 at: https://wandb.ai/xzy11632/dance-dev/runs/cucfxmbl
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_221708-cucfxmbl/logs
wandb: Agent Starting Run: a6banbnd with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_221745-a6banbnd
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fancy-sweep-157
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/a6banbnd
[INFO][2024-03-21 22:17:53,595][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:17:53,595][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:17:53,597][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder', 'Log1P', 'FilterGenesRegression', 'CellSVD', None][0m
[INFO][2024-03-21 22:17:53,602][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:17:54,122][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:17:54,311][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:17:54,314][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:17:54,511][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:17:54,511][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:17:54,512][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:17:54,512][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:17:54,512][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:17:54,514][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:17:54,514][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:17:54,514][dance][wrapped_func] Took 0:00:00.912820 to load and process data.
[WARNING][2024-03-21 22:17:54,524][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:17:54,533][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:17:54,553][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:17:54,554][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 22:17:54,732][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 22:20:02,522][dance.CellSVD][__call__] Generating cell SVD features (466, 22088) (k=363)
[INFO][2024-03-21 22:20:02,523][dance.CellSVD][__call__] Top 10 explained variances: [0.09542988 0.0379401  0.03076899 0.02067343 0.01136558 0.01016332
 0.00801424 0.00698474 0.00615151 0.00575116]
[INFO][2024-03-21 22:20:02,523][dance.CellSVD][__call__] Total explained variance: 89.72%
[INFO][2024-03-21 22:20:02,525][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:20:02,525][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.37879
wandb:  test_acc 0.30435
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run fancy-sweep-157 at: https://wandb.ai/xzy11632/dance-dev/runs/a6banbnd
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_221745-a6banbnd/logs
wandb: Agent Starting Run: 461ez7rn with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_222020-461ez7rn
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run light-sweep-158
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/461ez7rn
[INFO][2024-03-21 22:20:29,465][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:20:29,465][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:20:29,467][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'FilterGenesRegression',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 22:20:29,472][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:20:30,125][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:20:30,320][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:20:30,326][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:20:30,597][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:20:30,598][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:20:30,599][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:20:30,599][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:20:30,600][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:20:30,603][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:20:30,604][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:20:30,605][dance][wrapped_func] Took 0:00:01.133840 to load and process data.
[WARNING][2024-03-21 22:20:30,625][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:20:30,625][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:20:30,626][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 22:20:30,626][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:20:30,645][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:20:30,646][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 22:20:30,858][dance][_filter_enclasc] Start generating cell features using EnClaSC
[WARNING][2024-03-21 22:20:30,890][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:20:30,891][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 22:20:33,495][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:20:33,496][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.83333
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run light-sweep-158 at: https://wandb.ai/xzy11632/dance-dev/runs/461ez7rn
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_222020-461ez7rn/logs
wandb: Agent Starting Run: 175dri2f with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_222052-175dri2f
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run true-sweep-159
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/175dri2f
[INFO][2024-03-21 22:21:01,779][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:21:01,780][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:21:01,803][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 22:21:01,816][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:21:02,820][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:21:03,046][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:21:03,050][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:21:05,379][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:21:05,379][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:21:05,380][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:21:05,380][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:21:05,380][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:21:05,382][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:21:05,383][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:21:05,383][dance][wrapped_func] Took 0:00:03.567220 to load and process data.
[WARNING][2024-03-21 22:21:05,393][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:21:05,395][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:21:05,438][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:21:05,442][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 22:21:05,897][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 22:21:10,395][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 22088) (k=185)
[INFO][2024-03-21 22:21:10,395][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.12%
[INFO][2024-03-21 22:21:10,747][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:21:10,747][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.60606
wandb:  test_acc 0.22464
wandb: train_acc 0.76336
wandb: 
wandb: üöÄ View run true-sweep-159 at: https://wandb.ai/xzy11632/dance-dev/runs/175dri2f
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_222052-175dri2f/logs
wandb: Agent Starting Run: uc9v7l7l with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_222129-uc9v7l7l
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run solar-sweep-160
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/uc9v7l7l
[INFO][2024-03-21 22:21:39,096][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:21:39,097][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:21:39,098][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 22:21:39,110][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:21:39,849][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:21:40,026][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:21:40,030][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:21:41,180][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:21:41,188][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:21:41,190][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:21:41,190][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:21:41,191][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:21:41,194][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:21:41,201][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:21:41,203][dance][wrapped_func] Took 0:00:02.093200 to load and process data.
[WARNING][2024-03-21 22:21:41,240][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:21:41,243][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:21:41,311][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:21:41,320][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 22:21:41,709][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 22:23:02,999][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 22088) (k=208)
[INFO][2024-03-21 22:23:03,001][dance.WeightedFeatureSVD][__call__] Total explained variance: 93.43%
[INFO][2024-03-21 22:23:03,616][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:23:03,617][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.013 MB of 0.026 MB uploadedwandb: \ 0.013 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.60606
wandb:  test_acc 0.21739
wandb: train_acc 0.73664
wandb: 
wandb: üöÄ View run solar-sweep-160 at: https://wandb.ai/xzy11632/dance-dev/runs/uc9v7l7l
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_222129-uc9v7l7l/logs
wandb: Agent Starting Run: 2pmjceui with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_222321-2pmjceui
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run swept-sweep-161
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/2pmjceui
[INFO][2024-03-21 22:23:35,117][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:23:35,117][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:23:35,119][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder', 'Log1P', 'FilterGenesTopK', 'CellPCA', None][0m
[INFO][2024-03-21 22:23:35,135][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:23:36,096][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:23:36,264][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:23:36,268][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:23:37,222][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:23:37,222][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:23:37,222][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:23:37,222][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:23:37,222][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:23:37,224][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:23:37,224][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:23:37,224][dance][wrapped_func] Took 0:00:02.089552 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 22:23:37,239][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:23:37,240][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:23:37,268][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:23:37,269][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 22:23:58,536][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=213)
[INFO][2024-03-21 22:23:58,536][dance.CellPCA][__call__] Top 10 explained variances: [0.07902199 0.01458714 0.01205022 0.01095151 0.01079713 0.0103516
 0.01023789 0.01015549 0.00944025 0.00873434]
[INFO][2024-03-21 22:23:58,536][dance.CellPCA][__call__] Total explained variance: 90.10%
[INFO][2024-03-21 22:23:58,537][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:23:58,537][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.58397
wandb: 
wandb: üöÄ View run swept-sweep-161 at: https://wandb.ai/xzy11632/dance-dev/runs/2pmjceui
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_222321-2pmjceui/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: peuk5k6p with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_222422-peuk5k6p
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run comfy-sweep-162
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/peuk5k6p
[INFO][2024-03-21 22:24:35,391][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:24:35,392][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:24:35,393][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder', 'Log1P', 'FilterGenesTopK', 'CellSVD', None][0m
[INFO][2024-03-21 22:24:35,398][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:24:36,135][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:24:36,352][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:24:36,356][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:24:37,843][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:24:37,843][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:24:37,843][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:24:37,843][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:24:37,844][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:24:37,846][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:24:37,847][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:24:37,847][dance][wrapped_func] Took 0:00:02.448746 to load and process data.
[WARNING][2024-03-21 22:24:37,856][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:24:37,857][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:24:37,879][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:24:37,880][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 22:26:47,508][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=213)
[INFO][2024-03-21 22:26:47,509][dance.CellSVD][__call__] Top 10 explained variances: [0.07899692 0.01457518 0.01202486 0.01094823 0.01078471 0.01033875
 0.01023467 0.0101459  0.00941532 0.00871388]
[INFO][2024-03-21 22:26:47,509][dance.CellSVD][__call__] Total explained variance: 89.96%
[INFO][2024-03-21 22:26:47,511][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:26:47,511][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.55725
wandb: 
wandb: üöÄ View run comfy-sweep-162 at: https://wandb.ai/xzy11632/dance-dev/runs/peuk5k6p
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_222422-peuk5k6p/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: c0wfu067 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_222711-c0wfu067
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run tough-sweep-163
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/c0wfu067
[INFO][2024-03-21 22:27:18,892][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:27:18,893][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:27:18,895][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'FilterGenesTopK',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 22:27:18,900][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:27:19,369][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:27:19,536][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:27:19,540][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:27:19,724][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:27:19,724][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:27:19,725][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:27:19,725][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:27:19,725][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:27:19,727][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:27:19,728][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:27:19,728][dance][wrapped_func] Took 0:00:00.828286 to load and process data.
[WARNING][2024-03-21 22:27:19,736][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:27:19,737][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:27:19,737][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 22:27:19,737][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:27:19,754][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:27:19,755][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[WARNING][2024-03-21 22:27:19,809][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:27:19,809][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 22:27:19,822][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:27:19,823][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.71374
wandb: 
wandb: üöÄ View run tough-sweep-163 at: https://wandb.ai/xzy11632/dance-dev/runs/c0wfu067
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_222711-c0wfu067/logs
wandb: Agent Starting Run: armo6dr8 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_222732-armo6dr8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run azure-sweep-164
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/armo6dr8
[INFO][2024-03-21 22:27:40,697][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:27:40,697][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:27:40,699][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 22:27:40,718][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:27:41,322][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:27:41,605][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:27:41,614][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:27:41,830][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:27:41,831][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:27:41,831][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:27:41,832][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:27:41,832][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:27:41,833][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:27:41,834][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:27:41,834][dance][wrapped_func] Took 0:00:01.117035 to load and process data.
[WARNING][2024-03-21 22:27:41,844][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:27:41,845][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:27:41,863][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:27:41,864][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 22:27:44,627][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=133)
[INFO][2024-03-21 22:27:44,636][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.22%
[INFO][2024-03-21 22:27:44,701][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:27:44,701][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.31818
wandb:  test_acc 0.06522
wandb: train_acc 0.41985
wandb: 
wandb: üöÄ View run azure-sweep-164 at: https://wandb.ai/xzy11632/dance-dev/runs/armo6dr8
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_222732-armo6dr8/logs
wandb: Agent Starting Run: extommd6 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_222800-extommd6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run happy-sweep-165
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/extommd6
[INFO][2024-03-21 22:28:08,124][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:28:08,125][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:28:08,127][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 22:28:08,132][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:28:08,807][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:28:09,033][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:28:09,036][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:28:09,245][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:28:09,246][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:28:09,246][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:28:09,247][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:28:09,247][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:28:09,249][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:28:09,249][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:28:09,250][dance][wrapped_func] Took 0:00:01.117717 to load and process data.
[WARNING][2024-03-21 22:28:09,257][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:28:09,258][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:28:09,275][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:28:09,276][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 22:29:05,553][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=130)
[INFO][2024-03-21 22:29:05,567][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.50%
[INFO][2024-03-21 22:29:05,627][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:29:05,630][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.013 MB uploadedwandb: - 0.012 MB of 0.013 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.41221
wandb: 
wandb: üöÄ View run happy-sweep-165 at: https://wandb.ai/xzy11632/dance-dev/runs/extommd6
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_222800-extommd6/logs
wandb: Agent Starting Run: 3b5rvosb with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_222919-3b5rvosb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run unique-sweep-166
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/3b5rvosb
[INFO][2024-03-21 22:29:26,638][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:29:26,639][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:29:26,642][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellPCA',
 None][0m
[INFO][2024-03-21 22:29:26,647][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:29:27,160][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:29:27,371][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:29:27,375][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:29:27,586][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:29:27,587][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:29:27,587][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:29:27,587][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:29:27,587][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:29:27,589][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:29:27,590][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:29:27,590][dance][wrapped_func] Took 0:00:00.942765 to load and process data.
[WARNING][2024-03-21 22:29:27,598][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:29:27,598][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:29:27,615][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:29:27,616][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[INFO][2024-03-21 22:29:49,136][dance.CellPCA][__call__] Generating cell PCA features (466, 5166) (k=324)
[INFO][2024-03-21 22:29:49,137][dance.CellPCA][__call__] Top 10 explained variances: [0.03051768 0.01999152 0.01843243 0.01425795 0.01263489 0.00925367
 0.0078904  0.0068543  0.00649024 0.00627628]
[INFO][2024-03-21 22:29:49,137][dance.CellPCA][__call__] Total explained variance: 90.03%
[INFO][2024-03-21 22:29:49,139][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:29:49,139][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.018 MB uploadedwandb: | 0.012 MB of 0.018 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.4697
wandb:  test_acc 0.44203
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run unique-sweep-166 at: https://wandb.ai/xzy11632/dance-dev/runs/3b5rvosb
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_222919-3b5rvosb/logs
wandb: Agent Starting Run: kx11u5fv with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_223002-kx11u5fv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run good-sweep-167
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/kx11u5fv
[INFO][2024-03-21 22:30:10,373][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:30:10,373][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:30:10,375][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellSVD',
 None][0m
[INFO][2024-03-21 22:30:10,379][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:30:11,204][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:30:11,372][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:30:11,375][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:30:12,534][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:30:12,534][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:30:12,535][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:30:12,535][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:30:12,535][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:30:12,537][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:30:12,538][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:30:12,538][dance][wrapped_func] Took 0:00:02.158976 to load and process data.
[WARNING][2024-03-21 22:30:12,546][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:30:12,546][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:30:12,589][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:30:12,591][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[INFO][2024-03-21 22:33:15,183][dance.CellSVD][__call__] Generating cell SVD features (466, 5166) (k=325)
[INFO][2024-03-21 22:33:15,184][dance.CellSVD][__call__] Top 10 explained variances: [0.02598929 0.02072845 0.01850967 0.01447393 0.01275148 0.00960892
 0.00789251 0.00689171 0.00677916 0.00638179]
[INFO][2024-03-21 22:33:15,184][dance.CellSVD][__call__] Total explained variance: 89.88%
[INFO][2024-03-21 22:33:15,199][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:33:15,199][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.48485
wandb:  test_acc 0.32609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run good-sweep-167 at: https://wandb.ai/xzy11632/dance-dev/runs/kx11u5fv
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_223002-kx11u5fv/logs
wandb: Agent Starting Run: evsc9jj4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_223336-evsc9jj4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run breezy-sweep-168
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/evsc9jj4
[INFO][2024-03-21 22:33:44,805][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:33:44,805][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:33:44,806][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 22:33:44,822][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:33:45,491][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:33:45,712][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:33:45,716][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:33:46,075][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:33:46,076][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:33:46,077][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:33:46,092][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:33:46,098][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:33:46,101][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:33:46,101][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:33:46,101][dance][wrapped_func] Took 0:00:01.279411 to load and process data.
[WARNING][2024-03-21 22:33:46,147][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:33:46,148][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:33:46,163][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 22:33:46,164][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:33:46,195][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:33:46,196][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 22:33:47,044][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:33:47,045][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 22:33:47,398][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:33:47,398][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.018 MB of 0.026 MB uploadedwandb: | 0.018 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.77273
wandb:  test_acc 0.58696
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run breezy-sweep-168 at: https://wandb.ai/xzy11632/dance-dev/runs/evsc9jj4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_223336-evsc9jj4/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: nzn5439r with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_223418-nzn5439r
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run playful-sweep-169
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/nzn5439r
[INFO][2024-03-21 22:34:28,536][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:34:28,537][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:34:28,538][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 22:34:28,543][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:34:29,339][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:34:29,539][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:34:29,556][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:34:29,929][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:34:29,930][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:34:29,930][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:34:29,930][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:34:29,930][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:34:29,932][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:34:29,933][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:34:29,933][dance][wrapped_func] Took 0:00:01.389868 to load and process data.
[WARNING][2024-03-21 22:34:29,942][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:34:29,943][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:34:29,962][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:34:29,963][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[INFO][2024-03-21 22:34:35,719][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 5166) (k=192)
[INFO][2024-03-21 22:34:35,720][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.12%
[INFO][2024-03-21 22:34:35,911][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:34:35,913][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.013 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.5303
wandb:  test_acc 0.15942
wandb: train_acc 0.79008
wandb: 
wandb: üöÄ View run playful-sweep-169 at: https://wandb.ai/xzy11632/dance-dev/runs/nzn5439r
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_223418-nzn5439r/logs
wandb: Agent Starting Run: uojdecul with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_223459-uojdecul
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run daily-sweep-170
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/uojdecul
[INFO][2024-03-21 22:35:07,887][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:35:07,888][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:35:07,889][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 22:35:07,894][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:35:08,495][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:35:08,668][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:35:08,671][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:35:08,899][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:35:08,899][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:35:08,899][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:35:08,900][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:35:08,900][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:35:08,902][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:35:08,903][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:35:08,903][dance][wrapped_func] Took 0:00:01.009579 to load and process data.
[WARNING][2024-03-21 22:35:08,912][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:35:08,913][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:35:08,933][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:35:08,934][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[INFO][2024-03-21 22:36:31,114][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 5166) (k=194)
[INFO][2024-03-21 22:36:31,115][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.39%
[INFO][2024-03-21 22:36:31,133][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:36:31,133][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.51515
wandb:  test_acc 0.13043
wandb: train_acc 0.77099
wandb: 
wandb: üöÄ View run daily-sweep-170 at: https://wandb.ai/xzy11632/dance-dev/runs/uojdecul
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_223459-uojdecul/logs
wandb: Agent Starting Run: wmgcyy4u with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_223647-wmgcyy4u
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fanciful-sweep-171
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/wmgcyy4u
[INFO][2024-03-21 22:36:53,940][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:36:53,940][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:36:53,941][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellPCA',
 None][0m
[INFO][2024-03-21 22:36:53,946][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:36:54,457][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:36:54,659][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:36:54,662][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:36:54,947][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:36:54,947][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:36:54,947][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:36:54,948][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:36:54,948][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:36:54,949][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:36:54,950][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:36:54,950][dance][wrapped_func] Took 0:00:01.003707 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 22:36:54,958][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:36:54,958][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:36:54,983][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:36:54,984][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[INFO][2024-03-21 22:37:12,230][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=260)
[INFO][2024-03-21 22:37:12,230][dance.CellPCA][__call__] Top 10 explained variances: [0.10815546 0.06093514 0.0503205  0.03343059 0.0207466  0.01769995
 0.01320446 0.01139363 0.00851412 0.00704547]
[INFO][2024-03-21 22:37:12,230][dance.CellPCA][__call__] Total explained variance: 90.04%
[INFO][2024-03-21 22:37:12,231][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:37:12,236][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.63636
wandb:  test_acc 0.65942
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run fanciful-sweep-171 at: https://wandb.ai/xzy11632/dance-dev/runs/wmgcyy4u
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_223647-wmgcyy4u/logs
wandb: Agent Starting Run: 4m20mzp9 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_223726-4m20mzp9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run breezy-sweep-172
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/4m20mzp9
[INFO][2024-03-21 22:37:32,791][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:37:32,791][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:37:32,793][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellSVD',
 None][0m
[INFO][2024-03-21 22:37:32,798][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:37:33,522][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:37:33,698][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:37:33,702][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:37:33,933][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:37:33,934][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:37:33,934][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:37:33,934][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:37:33,934][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:37:33,937][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:37:33,937][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:37:33,938][dance][wrapped_func] Took 0:00:01.140207 to load and process data.
[WARNING][2024-03-21 22:37:33,945][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:37:33,946][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:37:33,964][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:37:33,965][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[INFO][2024-03-21 22:39:43,357][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=261)
[INFO][2024-03-21 22:39:43,358][dance.CellSVD][__call__] Top 10 explained variances: [0.07853089 0.07220817 0.05519099 0.03538553 0.02842766 0.01770387
 0.01322001 0.01144179 0.00860502 0.00714867]
[INFO][2024-03-21 22:39:43,358][dance.CellSVD][__call__] Total explained variance: 89.96%
[INFO][2024-03-21 22:39:43,360][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:39:43,360][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.71212
wandb:  test_acc 0.71014
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run breezy-sweep-172 at: https://wandb.ai/xzy11632/dance-dev/runs/4m20mzp9
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_223726-4m20mzp9/logs
wandb: Agent Starting Run: 21urtpd6 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_224006-21urtpd6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run expert-sweep-173
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/21urtpd6
[INFO][2024-03-21 22:40:15,017][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:40:15,018][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:40:15,019][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 22:40:15,025][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:40:15,504][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:40:15,703][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:40:15,707][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:40:15,912][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:40:15,912][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:40:15,913][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:40:15,913][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:40:15,913][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:40:15,916][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:40:15,916][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:40:15,917][dance][wrapped_func] Took 0:00:00.892141 to load and process data.
[WARNING][2024-03-21 22:40:15,927][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:40:15,928][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:40:15,929][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 22:40:15,929][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:40:15,969][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:40:15,970][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 22:40:16,429][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:40:16,430][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 22:40:16,541][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:40:16,551][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.026 MB uploadedwandb: \ 0.018 MB of 0.026 MB uploadedwandb: | 0.018 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.83333
wandb:  test_acc 0.77536
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run expert-sweep-173 at: https://wandb.ai/xzy11632/dance-dev/runs/21urtpd6
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_224006-21urtpd6/logs
wandb: Agent Starting Run: 82qctr4v with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_224038-82qctr4v
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run clean-sweep-174
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/82qctr4v
[INFO][2024-03-21 22:40:47,149][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:40:47,149][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:40:47,150][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 22:40:47,162][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:40:47,579][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:40:47,780][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:40:47,783][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:40:48,562][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:40:48,563][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:40:48,564][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:40:48,564][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:40:48,564][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:40:48,567][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:40:48,567][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:40:48,568][dance][wrapped_func] Took 0:00:01.405408 to load and process data.
[WARNING][2024-03-21 22:40:48,578][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:40:48,579][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:40:48,599][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:40:48,600][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[INFO][2024-03-21 22:40:54,291][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=151)
[INFO][2024-03-21 22:40:54,291][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.07%
[INFO][2024-03-21 22:40:54,355][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:40:54,355][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.75758
wandb:  test_acc 0.72464
wandb: train_acc 0.87405
wandb: 
wandb: üöÄ View run clean-sweep-174 at: https://wandb.ai/xzy11632/dance-dev/runs/82qctr4v
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_224038-82qctr4v/logs
wandb: Agent Starting Run: tb5kty32 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_224111-tb5kty32
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run brisk-sweep-175
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/tb5kty32
[INFO][2024-03-21 22:41:19,024][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:41:19,031][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:41:19,032][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 22:41:19,040][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:41:19,531][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:41:19,730][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:41:19,733][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:41:19,925][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:41:19,926][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:41:19,926][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:41:19,926][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:41:19,926][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:41:19,928][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:41:19,929][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:41:19,929][dance][wrapped_func] Took 0:00:00.888729 to load and process data.
[WARNING][2024-03-21 22:41:19,937][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:41:19,938][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:41:19,955][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:41:19,955][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[INFO][2024-03-21 22:42:24,773][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=170)
[INFO][2024-03-21 22:42:24,781][dance.WeightedFeatureSVD][__call__] Total explained variance: 92.53%
[INFO][2024-03-21 22:42:24,814][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:42:24,814][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.72727
wandb:  test_acc 0.69565
wandb: train_acc 0.8626
wandb: 
wandb: üöÄ View run brisk-sweep-175 at: https://wandb.ai/xzy11632/dance-dev/runs/tb5kty32
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_224111-tb5kty32/logs
wandb: Agent Starting Run: k8sz9npu with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_224241-k8sz9npu
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dark-sweep-176
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/k8sz9npu
[INFO][2024-03-21 22:42:53,038][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:42:53,039][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:42:53,040][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'CellPCA',
 None][0m
[INFO][2024-03-21 22:42:53,072][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:42:53,992][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:42:54,321][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:42:54,325][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:42:54,652][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:42:54,657][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:42:54,657][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:42:54,657][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:42:54,658][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:42:54,661][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:42:54,662][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:42:54,662][dance][wrapped_func] Took 0:00:01.590847 to load and process data.
[WARNING][2024-03-21 22:42:54,685][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:42:54,686][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:42:54,742][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:42:54,750][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-21 22:43:08,609][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=245)
[INFO][2024-03-21 22:43:08,610][dance.CellPCA][__call__] Top 10 explained variances: [0.13259834 0.10301735 0.06155786 0.04138483 0.02537913 0.01580641
 0.01493982 0.0122245  0.00982008 0.00759228]
[INFO][2024-03-21 22:43:08,610][dance.CellPCA][__call__] Total explained variance: 90.01%
[INFO][2024-03-21 22:43:08,610][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:43:08,610][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.017 MB of 0.026 MB uploadedwandb: | 0.017 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.81818
wandb:  test_acc 0.73188
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run dark-sweep-176 at: https://wandb.ai/xzy11632/dance-dev/runs/k8sz9npu
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_224241-k8sz9npu/logs
wandb: Agent Starting Run: gsok2txv with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_224329-gsok2txv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run deft-sweep-177
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/gsok2txv
[INFO][2024-03-21 22:43:46,865][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:43:46,865][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:43:46,866][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'CellSVD',
 None][0m
[INFO][2024-03-21 22:43:46,898][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:43:48,256][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:43:48,812][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:43:48,815][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:43:49,372][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:43:49,389][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:43:49,389][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:43:49,390][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:43:49,390][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:43:49,392][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:43:49,397][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:43:49,398][dance][wrapped_func] Took 0:00:02.500039 to load and process data.
[WARNING][2024-03-21 22:43:49,422][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:43:49,423][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:43:49,472][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:43:49,481][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-21 22:46:51,007][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=246)
[INFO][2024-03-21 22:46:51,022][dance.CellSVD][__call__] Top 10 explained variances: [0.10206942 0.10410195 0.06188485 0.06017731 0.02800551 0.01585024
 0.01494228 0.01222911 0.01110993 0.00915971]
[INFO][2024-03-21 22:46:51,022][dance.CellSVD][__call__] Total explained variance: 89.93%
[INFO][2024-03-21 22:46:51,024][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:46:51,024][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.017 MB of 0.026 MB uploadedwandb: / 0.017 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.80303
wandb:  test_acc 0.6087
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run deft-sweep-177 at: https://wandb.ai/xzy11632/dance-dev/runs/gsok2txv
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_224329-gsok2txv/logs
wandb: Agent Starting Run: akwaczhi with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_224710-akwaczhi
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rich-sweep-178
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/akwaczhi
[INFO][2024-03-21 22:47:19,765][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:47:19,765][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:47:19,767][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 22:47:19,776][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:47:20,809][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:47:21,188][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:47:21,192][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:47:21,616][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:47:21,617][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:47:21,617][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:47:21,618][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:47:21,618][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:47:21,620][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:47:21,621][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:47:21,621][dance][wrapped_func] Took 0:00:01.849019 to load and process data.
[WARNING][2024-03-21 22:47:21,630][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:47:21,630][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:47:21,630][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 22:47:21,631][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:47:21,651][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:47:21,652][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-21 22:47:22,621][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:47:22,621][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 22:47:22,920][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:47:22,920][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.81818
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run rich-sweep-178 at: https://wandb.ai/xzy11632/dance-dev/runs/akwaczhi
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_224710-akwaczhi/logs
wandb: Agent Starting Run: vh9coias with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_224741-vh9coias
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sage-sweep-179
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/vh9coias
[INFO][2024-03-21 22:47:51,229][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:47:51,229][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:47:51,230][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 22:47:51,236][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:47:52,370][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:47:52,564][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:47:52,574][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:47:52,813][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:47:52,813][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:47:52,813][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:47:52,814][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:47:52,814][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:47:52,816][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:47:52,816][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:47:52,817][dance][wrapped_func] Took 0:00:01.581221 to load and process data.
[WARNING][2024-03-21 22:47:52,825][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:47:52,826][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:47:52,850][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:47:52,851][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-21 22:47:54,786][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=118)
[INFO][2024-03-21 22:47:54,792][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.04%
[INFO][2024-03-21 22:47:54,856][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:47:54,856][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.72727
wandb:  test_acc 0.68116
wandb: train_acc 0.84733
wandb: 
wandb: üöÄ View run sage-sweep-179 at: https://wandb.ai/xzy11632/dance-dev/runs/vh9coias
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_224741-vh9coias/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: dyf6b1yo with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_224821-dyf6b1yo
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run stoic-sweep-180
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/dyf6b1yo
[INFO][2024-03-21 22:48:43,043][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:48:43,043][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:48:43,045][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 22:48:43,050][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:48:43,943][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:48:44,453][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:48:44,471][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:48:44,752][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:48:44,752][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:48:44,753][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:48:44,753][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:48:44,753][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:48:44,755][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:48:44,755][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:48:44,756][dance][wrapped_func] Took 0:00:01.705721 to load and process data.
[WARNING][2024-03-21 22:48:44,764][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:48:44,765][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:48:44,797][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:48:44,798][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-21 22:50:06,101][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=162)
[INFO][2024-03-21 22:50:06,110][dance.WeightedFeatureSVD][__call__] Total explained variance: 94.43%
[INFO][2024-03-21 22:50:06,131][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:50:06,131][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.71212
wandb:  test_acc 0.68841
wandb: train_acc 0.84733
wandb: 
wandb: üöÄ View run stoic-sweep-180 at: https://wandb.ai/xzy11632/dance-dev/runs/dyf6b1yo
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_224821-dyf6b1yo/logs
wandb: Agent Starting Run: jnnk9zqr with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_225025-jnnk9zqr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run good-sweep-181
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/jnnk9zqr
[INFO][2024-03-21 22:50:35,392][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:50:35,392][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:50:35,394][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesNumberPlaceHolder',
 'CellPCA',
 None][0m
[INFO][2024-03-21 22:50:35,398][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:50:36,805][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:50:37,227][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:50:37,243][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:50:37,711][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:50:37,711][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:50:37,711][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:50:37,712][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:50:37,712][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:50:37,714][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:50:37,714][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:50:37,715][dance][wrapped_func] Took 0:00:02.316601 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 22:50:37,749][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:50:37,750][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:50:37,750][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:50:37,751][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:50:37,777][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:50:37,778][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 22:50:37,779][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:50:37,779][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:51:01,796][dance.CellPCA][__call__] Generating cell PCA features (466, 22088) (k=2)
[INFO][2024-03-21 22:51:01,797][dance.CellPCA][__call__] Top 10 explained variances: [0.8552931 0.1436817]
[INFO][2024-03-21 22:51:01,797][dance.CellPCA][__call__] Total explained variance: 99.90%
[INFO][2024-03-21 22:51:01,799][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:51:01,799][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.017 MB of 0.026 MB uploadedwandb: | 0.017 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.31818
wandb:  test_acc 0.07246
wandb: train_acc 0.39313
wandb: 
wandb: üöÄ View run good-sweep-181 at: https://wandb.ai/xzy11632/dance-dev/runs/jnnk9zqr
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_225025-jnnk9zqr/logs
wandb: Agent Starting Run: 1dk3222o with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_225121-1dk3222o
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run chocolate-sweep-182
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/1dk3222o
[INFO][2024-03-21 22:51:34,372][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:51:34,372][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:51:34,374][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesNumberPlaceHolder',
 'CellSVD',
 None][0m
[INFO][2024-03-21 22:51:34,379][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:51:35,270][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:51:35,640][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:51:35,643][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:51:35,879][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:51:35,880][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:51:35,881][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:51:35,881][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:51:35,881][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:51:35,883][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:51:35,885][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:51:35,886][dance][wrapped_func] Took 0:00:01.506989 to load and process data.
[WARNING][2024-03-21 22:51:35,894][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:51:35,894][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:51:35,895][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:51:35,895][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:51:35,921][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:51:35,922][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 22:51:35,923][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:51:35,923][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:53:31,362][dance.CellSVD][__call__] Generating cell SVD features (466, 22088) (k=2)
[INFO][2024-03-21 22:53:31,362][dance.CellSVD][__call__] Top 10 explained variances: [0.83317566 0.16575265]
[INFO][2024-03-21 22:53:31,363][dance.CellSVD][__call__] Total explained variance: 99.89%
[INFO][2024-03-21 22:53:31,364][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:53:31,373][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.39394
wandb:  test_acc 0.02174
wandb: train_acc 0.30153
wandb: 
wandb: üöÄ View run chocolate-sweep-182 at: https://wandb.ai/xzy11632/dance-dev/runs/1dk3222o
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_225121-1dk3222o/logs
wandb: Agent Starting Run: 1kv413d1 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_225349-1kv413d1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run summer-sweep-183
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/1kv413d1
[INFO][2024-03-21 22:54:01,616][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:54:01,637][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:54:01,638][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesNumberPlaceHolder',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 22:54:01,644][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:54:02,237][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:54:02,431][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:54:02,434][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:54:02,641][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:54:02,642][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:54:02,642][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:54:02,643][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:54:02,643][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:54:02,645][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:54:02,646][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:54:02,646][dance][wrapped_func] Took 0:00:01.002040 to load and process data.
[WARNING][2024-03-21 22:54:02,656][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:54:02,657][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:54:02,657][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:54:02,658][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:54:02,658][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 22:54:02,658][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:54:02,679][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:54:02,680][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 22:54:02,681][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:54:02,681][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:54:02,682][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:54:02,682][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 22:54:04,089][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:54:04,090][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.027 MB uploadedwandb: \ 0.012 MB of 0.027 MB uploadedwandb: | 0.027 MB of 0.027 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.74242
wandb:  test_acc 0.27536
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run summer-sweep-183 at: https://wandb.ai/xzy11632/dance-dev/runs/1kv413d1
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_225349-1kv413d1/logs
wandb: Agent Starting Run: 0prt0y9r with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_225428-0prt0y9r
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wild-sweep-184
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/0prt0y9r
[INFO][2024-03-21 22:54:40,219][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:54:40,219][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:54:40,221][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 22:54:40,225][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:54:43,505][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:54:43,815][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:54:43,819][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:54:44,766][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:54:44,766][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:54:44,767][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:54:44,767][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:54:44,767][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:54:44,773][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:54:44,780][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:54:44,780][dance][wrapped_func] Took 0:00:04.554873 to load and process data.
[WARNING][2024-03-21 22:54:44,788][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:54:44,788][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:54:44,789][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:54:44,789][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:54:44,813][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:54:44,814][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 22:54:44,814][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:54:44,815][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:54:48,758][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 22088) (k=1)
[INFO][2024-03-21 22:54:48,768][dance.WeightedFeaturePCA][__call__] Total explained variance: 95.82%
[INFO][2024-03-21 22:54:48,974][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:54:48,974][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.017 MB of 0.026 MB uploadedwandb: | 0.017 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.01515
wandb:  test_acc 0.0
wandb: train_acc 0.06489
wandb: 
wandb: üöÄ View run wild-sweep-184 at: https://wandb.ai/xzy11632/dance-dev/runs/0prt0y9r
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_225428-0prt0y9r/logs
wandb: Agent Starting Run: 7qddrw0s with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_225507-7qddrw0s
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run visionary-sweep-185
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/7qddrw0s
[INFO][2024-03-21 22:55:16,888][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:55:16,889][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:55:16,890][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 22:55:16,895][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:55:17,723][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:55:18,027][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:55:18,030][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:55:18,259][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:55:18,259][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:55:18,259][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:55:18,259][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:55:18,260][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:55:18,261][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:55:18,262][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:55:18,262][dance][wrapped_func] Took 0:00:01.367369 to load and process data.
[WARNING][2024-03-21 22:55:18,270][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:55:18,271][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:55:18,271][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:55:18,271][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:55:18,292][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:55:18,293][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 22:55:18,293][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:55:18,293][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:56:19,909][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 22088) (k=2)
[INFO][2024-03-21 22:56:19,910][dance.WeightedFeatureSVD][__call__] Total explained variance: 99.98%
[INFO][2024-03-21 22:56:20,891][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:56:20,892][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.16667
wandb:  test_acc 0.0
wandb: train_acc 0.1145
wandb: 
wandb: üöÄ View run visionary-sweep-185 at: https://wandb.ai/xzy11632/dance-dev/runs/7qddrw0s
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_225507-7qddrw0s/logs
wandb: Agent Starting Run: ir6rodos with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_225635-ir6rodos
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run eternal-sweep-186
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ir6rodos
[INFO][2024-03-21 22:56:45,591][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:56:45,592][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:56:45,593][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'CellPCA',
 None][0m
[INFO][2024-03-21 22:56:45,648][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:56:47,958][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:56:48,235][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:56:48,269][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:56:55,809][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:56:55,818][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:56:55,818][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:56:55,818][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:56:55,819][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:56:55,833][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:56:55,835][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:56:55,836][dance][wrapped_func] Took 0:00:10.187628 to load and process data.
[WARNING][2024-03-21 22:56:55,852][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:56:55,853][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:56:55,853][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:56:55,978][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:56:55,980][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 22:56:55,981][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:56:56,426][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 22:57:10,765][dance.CellPCA][__call__] Generating cell PCA features (466, 22088) (k=2)
[INFO][2024-03-21 22:57:10,766][dance.CellPCA][__call__] Top 10 explained variances: [0.8552931 0.1436817]
[INFO][2024-03-21 22:57:10,766][dance.CellPCA][__call__] Total explained variance: 99.90%
[INFO][2024-03-21 22:57:10,773][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:57:10,773][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.021 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.31818
wandb:  test_acc 0.07246
wandb: train_acc 0.39313
wandb: 
wandb: üöÄ View run eternal-sweep-186 at: https://wandb.ai/xzy11632/dance-dev/runs/ir6rodos
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_225635-ir6rodos/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: dk89p100 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_225738-dk89p100
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run restful-sweep-187
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/dk89p100
[INFO][2024-03-21 22:57:55,752][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 22:57:55,752][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 22:57:55,754][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'CellSVD',
 None][0m
[INFO][2024-03-21 22:57:55,773][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 22:57:58,490][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 22:57:59,105][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 22:57:59,110][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 22:58:04,975][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 22:58:04,979][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 22:58:04,979][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 22:58:04,979][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 22:58:04,980][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 22:58:05,004][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 22:58:05,019][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 22:58:05,020][dance][wrapped_func] Took 0:00:09.248994 to load and process data.
[WARNING][2024-03-21 22:58:05,036][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:58:05,037][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:58:05,038][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 22:58:05,073][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 22:58:05,075][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 22:58:05,075][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 22:58:05,530][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 22:59:59,278][dance.CellSVD][__call__] Generating cell SVD features (466, 22088) (k=2)
[INFO][2024-03-21 22:59:59,281][dance.CellSVD][__call__] Top 10 explained variances: [0.83317566 0.16575265]
[INFO][2024-03-21 22:59:59,281][dance.CellSVD][__call__] Total explained variance: 99.89%
[INFO][2024-03-21 22:59:59,283][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 22:59:59,283][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.018 MB of 0.026 MB uploadedwandb: | 0.018 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.39394
wandb:  test_acc 0.02174
wandb: train_acc 0.30153
wandb: 
wandb: üöÄ View run restful-sweep-187 at: https://wandb.ai/xzy11632/dance-dev/runs/dk89p100
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_225738-dk89p100/logs
wandb: Agent Starting Run: cfloys4q with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_230016-cfloys4q
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fiery-sweep-188
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/cfloys4q
[INFO][2024-03-21 23:00:34,052][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:00:34,053][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:00:34,054][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 23:00:34,059][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:00:34,551][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:00:34,718][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:00:34,722][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:00:34,926][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:00:34,927][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:00:34,927][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:00:34,927][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:00:34,928][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:00:34,929][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:00:34,930][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:00:34,930][dance][wrapped_func] Took 0:00:00.870913 to load and process data.
[WARNING][2024-03-21 23:00:34,938][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:00:34,939][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:00:34,939][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:00:34,939][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 23:00:34,939][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:00:34,956][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:00:34,957][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:00:34,958][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:00:35,227][dance][_filter_enclasc] Start generating cell features using EnClaSC
[WARNING][2024-03-21 23:00:35,258][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:00:35,259][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 23:00:46,741][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:00:46,742][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.017 MB of 0.026 MB uploadedwandb: - 0.017 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.74242
wandb:  test_acc 0.27536
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run fiery-sweep-188 at: https://wandb.ai/xzy11632/dance-dev/runs/cfloys4q
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_230016-cfloys4q/logs
wandb: Agent Starting Run: p4qbxct2 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_230104-p4qbxct2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run effortless-sweep-189
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/p4qbxct2
[INFO][2024-03-21 23:01:13,579][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:01:13,589][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:01:13,590][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 23:01:13,598][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:01:17,254][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:01:17,899][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:01:17,904][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:01:25,053][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:01:25,054][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:01:25,054][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:01:25,054][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:01:25,055][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:01:25,067][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:01:25,067][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:01:25,068][dance][wrapped_func] Took 0:00:11.469974 to load and process data.
[WARNING][2024-03-21 23:01:25,079][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:01:25,080][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:01:25,081][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:01:25,106][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:01:25,107][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:01:25,108][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:01:27,143][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 23:01:35,402][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 22088) (k=1)
[INFO][2024-03-21 23:01:35,402][dance.WeightedFeaturePCA][__call__] Total explained variance: 95.82%
[INFO][2024-03-21 23:01:37,151][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:01:37,151][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.018 MB of 0.026 MB uploadedwandb: \ 0.018 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.01515
wandb:  test_acc 0.0
wandb: train_acc 0.06489
wandb: 
wandb: üöÄ View run effortless-sweep-189 at: https://wandb.ai/xzy11632/dance-dev/runs/p4qbxct2
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_230104-p4qbxct2/logs
wandb: Agent Starting Run: 7gt98578 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_230154-7gt98578
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run restful-sweep-190
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/7gt98578
[INFO][2024-03-21 23:02:05,167][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:02:05,167][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:02:05,169][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 23:02:05,174][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:02:06,949][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:02:07,308][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:02:07,312][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:02:16,813][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:02:16,814][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:02:16,814][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:02:16,814][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:02:16,814][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:02:16,841][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:02:16,842][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:02:16,842][dance][wrapped_func] Took 0:00:11.668132 to load and process data.
[WARNING][2024-03-21 23:02:16,864][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:02:16,865][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:02:16,866][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:02:16,925][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:02:16,926][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:02:16,927][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:02:18,700][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 23:03:17,616][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 22088) (k=2)
[INFO][2024-03-21 23:03:17,621][dance.WeightedFeatureSVD][__call__] Total explained variance: 99.98%
[INFO][2024-03-21 23:03:18,972][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:03:18,981][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.013 MB of 0.026 MB uploadedwandb: \ 0.013 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.16667
wandb:  test_acc 0.0
wandb: train_acc 0.1145
wandb: 
wandb: üöÄ View run restful-sweep-190 at: https://wandb.ai/xzy11632/dance-dev/runs/7gt98578
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_230154-7gt98578/logs
wandb: Agent Starting Run: o5z5nfug with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_230335-o5z5nfug
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run earthy-sweep-191
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/o5z5nfug
[INFO][2024-03-21 23:03:44,456][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:03:44,456][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:03:44,458][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'CellPCA',
 None][0m
[INFO][2024-03-21 23:03:44,464][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:03:46,541][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:03:46,786][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:03:46,790][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:03:48,705][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:03:48,706][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:03:48,706][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:03:48,706][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:03:48,707][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:03:48,720][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:03:48,720][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:03:48,721][dance][wrapped_func] Took 0:00:04.257127 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 23:03:48,736][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:03:48,737][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:03:48,737][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:03:48,764][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:03:48,772][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:03:48,792][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 23:03:57,148][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=55)
[INFO][2024-03-21 23:03:57,148][dance.CellPCA][__call__] Top 10 explained variances: [0.16844612 0.1322545  0.09476218 0.06954926 0.04885819 0.03440032
 0.03236063 0.02847997 0.02214933 0.01987045]
[INFO][2024-03-21 23:03:57,149][dance.CellPCA][__call__] Total explained variance: 90.03%
[INFO][2024-03-21 23:03:57,149][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:03:57,150][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.018 MB of 0.026 MB uploadedwandb: | 0.018 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.34848
wandb:  test_acc 0.10145
wandb: train_acc 0.56107
wandb: 
wandb: üöÄ View run earthy-sweep-191 at: https://wandb.ai/xzy11632/dance-dev/runs/o5z5nfug
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_230335-o5z5nfug/logs
wandb: Agent Starting Run: uo0kvcdk with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_230416-uo0kvcdk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run royal-sweep-192
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/uo0kvcdk
[INFO][2024-03-21 23:04:26,474][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:04:26,474][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:04:26,475][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'CellSVD',
 None][0m
[INFO][2024-03-21 23:04:26,481][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:04:29,156][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:04:29,654][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:04:29,662][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:04:36,903][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:04:36,903][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:04:36,903][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:04:36,904][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:04:36,904][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:04:36,928][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:04:36,936][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:04:36,961][dance][wrapped_func] Took 0:00:10.480320 to load and process data.
[WARNING][2024-03-21 23:04:36,982][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:04:36,983][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:04:36,984][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:04:37,006][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:04:37,007][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:04:37,008][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 23:06:23,192][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=55)
[INFO][2024-03-21 23:06:23,193][dance.CellSVD][__call__] Top 10 explained variances: [0.1684352  0.13225268 0.09476031 0.06954776 0.04885579 0.03439301
 0.03236081 0.02847993 0.02214614 0.01986784]
[INFO][2024-03-21 23:06:23,193][dance.CellSVD][__call__] Total explained variance: 90.00%
[INFO][2024-03-21 23:06:23,225][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:06:23,225][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.018 MB of 0.026 MB uploadedwandb: | 0.018 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.31818
wandb:  test_acc 0.0942
wandb: train_acc 0.5916
wandb: 
wandb: üöÄ View run royal-sweep-192 at: https://wandb.ai/xzy11632/dance-dev/runs/uo0kvcdk
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_230416-uo0kvcdk/logs
wandb: Agent Starting Run: aql6aeoh with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_230643-aql6aeoh
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run blooming-sweep-193
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/aql6aeoh
[INFO][2024-03-21 23:07:03,872][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:07:03,873][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:07:03,874][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 23:07:03,880][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:07:05,712][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:07:05,930][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:07:05,935][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:07:12,949][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:07:12,950][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:07:12,950][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:07:12,950][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:07:12,950][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:07:12,962][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:07:12,963][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:07:12,963][dance][wrapped_func] Took 0:00:09.083311 to load and process data.
[WARNING][2024-03-21 23:07:12,972][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:07:12,973][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:07:12,973][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:07:12,974][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 23:07:12,974][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:07:12,992][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:07:12,993][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:07:12,993][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[WARNING][2024-03-21 23:07:13,571][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:07:13,571][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 23:07:13,709][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:07:13,712][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.027 MB uploadedwandb: - 0.012 MB of 0.027 MB uploadedwandb: \ 0.027 MB of 0.027 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.34848
wandb:  test_acc 0.16667
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run blooming-sweep-193 at: https://wandb.ai/xzy11632/dance-dev/runs/aql6aeoh
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_230643-aql6aeoh/logs
wandb: Agent Starting Run: ug74df0c with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_230731-ug74df0c
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run distinctive-sweep-194
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ug74df0c
[INFO][2024-03-21 23:07:40,200][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:07:40,214][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:07:40,215][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 23:07:40,221][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:07:43,320][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:07:44,533][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:07:44,536][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:07:51,787][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:07:51,788][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:07:51,789][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:07:51,789][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:07:51,790][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:07:51,805][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:07:51,806][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:07:51,806][dance][wrapped_func] Took 0:00:11.585536 to load and process data.
[WARNING][2024-03-21 23:07:51,819][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:07:51,821][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:07:51,822][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:07:51,844][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:07:51,845][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:07:51,846][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 23:07:54,747][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=36)
[INFO][2024-03-21 23:07:54,759][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.08%
[INFO][2024-03-21 23:07:54,826][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:07:54,827][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.013 MB of 0.026 MB uploadedwandb: | 0.013 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.25758
wandb:  test_acc 0.0942
wandb: train_acc 0.54198
wandb: 
wandb: üöÄ View run distinctive-sweep-194 at: https://wandb.ai/xzy11632/dance-dev/runs/ug74df0c
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_230731-ug74df0c/logs
wandb: Agent Starting Run: 7n39sqf9 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_230814-7n39sqf9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run warm-sweep-195
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/7n39sqf9
[INFO][2024-03-21 23:08:24,443][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:08:24,443][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:08:24,445][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 23:08:24,469][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:08:27,648][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:08:28,635][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:08:28,638][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:08:39,095][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:08:39,095][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:08:39,095][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:08:39,095][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:08:39,095][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:08:39,106][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:08:39,107][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:08:39,107][dance][wrapped_func] Took 0:00:14.638267 to load and process data.
[WARNING][2024-03-21 23:08:39,115][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:08:39,115][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:08:39,116][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:08:39,134][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:08:39,135][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:08:39,136][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 23:09:25,774][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=36)
[INFO][2024-03-21 23:09:25,782][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.07%
[INFO][2024-03-21 23:09:25,802][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:09:25,802][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.25758
wandb:  test_acc 0.1087
wandb: train_acc 0.5687
wandb: 
wandb: üöÄ View run warm-sweep-195 at: https://wandb.ai/xzy11632/dance-dev/runs/7n39sqf9
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_230814-7n39sqf9/logs
wandb: Agent Starting Run: nhssgcnv with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_230939-nhssgcnv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run different-sweep-196
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/nhssgcnv
[INFO][2024-03-21 23:09:46,102][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:09:46,102][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:09:46,104][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellPCA',
 None][0m
[INFO][2024-03-21 23:09:46,108][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:09:47,983][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:09:48,410][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:09:48,414][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:09:52,630][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:09:52,630][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:09:52,630][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:09:52,631][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:09:52,631][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:09:52,642][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:09:52,643][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:09:52,643][dance][wrapped_func] Took 0:00:06.535086 to load and process data.
[WARNING][2024-03-21 23:09:52,651][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:09:52,652][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:09:52,652][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:09:52,672][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:09:52,673][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:09:52,674][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.017 MB of 0.026 MB uploadedwandb: | 0.017 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run different-sweep-196 at: https://wandb.ai/xzy11632/dance-dev/runs/nhssgcnv
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_230939-nhssgcnv/logs
wandb: ERROR Run nhssgcnv errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: n7nf2yd6 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_231009-n7nf2yd6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run floral-sweep-197
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/n7nf2yd6
[INFO][2024-03-21 23:10:17,073][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:10:17,074][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:10:17,075][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellSVD',
 None][0m
[INFO][2024-03-21 23:10:17,080][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:10:18,395][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:10:18,603][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:10:18,606][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:10:19,569][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:10:19,569][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:10:19,569][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:10:19,569][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:10:19,570][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:10:19,572][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:10:19,572][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:10:19,572][dance][wrapped_func] Took 0:00:02.492581 to load and process data.
[WARNING][2024-03-21 23:10:19,586][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:10:19,586][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:10:19,587][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:10:19,609][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:10:19,610][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:10:19,611][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run floral-sweep-197 at: https://wandb.ai/xzy11632/dance-dev/runs/n7nf2yd6
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_231009-n7nf2yd6/logs
wandb: ERROR Run n7nf2yd6 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: mh2pln12 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_231036-mh2pln12
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run jolly-sweep-198
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/mh2pln12
[INFO][2024-03-21 23:10:43,625][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:10:43,626][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:10:43,627][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 23:10:43,632][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:10:45,334][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:10:45,498][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:10:45,502][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:10:51,748][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:10:51,749][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:10:51,749][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:10:51,749][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:10:51,749][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:10:51,759][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:10:51,760][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:10:51,760][dance][wrapped_func] Took 0:00:08.129020 to load and process data.
[WARNING][2024-03-21 23:10:51,768][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:10:51,768][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:10:51,769][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:10:51,769][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 23:10:51,769][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:10:51,789][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:10:51,790][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:10:51,791][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.018 MB of 0.026 MB uploadedwandb: \ 0.018 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run jolly-sweep-198 at: https://wandb.ai/xzy11632/dance-dev/runs/mh2pln12
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_231036-mh2pln12/logs
wandb: ERROR Run mh2pln12 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: ln86tf58 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_231111-ln86tf58
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run spring-sweep-199
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ln86tf58
[INFO][2024-03-21 23:11:18,835][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:11:18,835][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:11:18,837][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 23:11:18,841][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:11:19,276][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:11:19,490][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:11:19,494][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:11:19,699][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:11:19,700][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:11:19,700][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:11:19,700][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:11:19,700][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:11:19,702][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:11:19,703][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:11:19,703][dance][wrapped_func] Took 0:00:00.861910 to load and process data.
[WARNING][2024-03-21 23:11:19,711][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:11:19,711][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:11:19,712][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:11:19,729][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:11:19,729][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:11:19,730][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run spring-sweep-199 at: https://wandb.ai/xzy11632/dance-dev/runs/ln86tf58
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_231111-ln86tf58/logs
wandb: ERROR Run ln86tf58 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: chw3djlu with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_231133-chw3djlu
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run swept-sweep-200
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/chw3djlu
[INFO][2024-03-21 23:11:40,471][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:11:40,472][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:11:40,473][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 23:11:40,484][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:11:43,065][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:11:43,263][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:11:43,272][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:11:48,265][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:11:48,265][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:11:48,266][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:11:48,266][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:11:48,266][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:11:48,278][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:11:48,279][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:11:48,279][dance][wrapped_func] Took 0:00:07.795717 to load and process data.
[WARNING][2024-03-21 23:11:48,289][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:11:48,290][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:11:48,291][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:11:48,311][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:11:48,313][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:11:48,313][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.018 MB uploadedwandb: \ 0.012 MB of 0.018 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run swept-sweep-200 at: https://wandb.ai/xzy11632/dance-dev/runs/chw3djlu
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_231133-chw3djlu/logs
wandb: ERROR Run chw3djlu errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: li7lhsja with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_231207-li7lhsja
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run revived-sweep-201
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/li7lhsja
[INFO][2024-03-21 23:12:14,368][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:12:14,369][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:12:14,370][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellPCA',
 None][0m
[INFO][2024-03-21 23:12:14,376][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:12:15,960][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:12:16,232][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:12:16,238][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:12:20,821][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:12:20,822][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:12:20,822][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:12:20,822][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:12:20,822][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:12:20,839][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:12:20,839][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:12:20,840][dance][wrapped_func] Took 0:00:06.463622 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 23:12:20,852][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:12:20,855][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:12:20,856][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:12:20,967][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:12:20,968][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:12:20,969][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run revived-sweep-201 at: https://wandb.ai/xzy11632/dance-dev/runs/li7lhsja
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_231207-li7lhsja/logs
wandb: ERROR Run li7lhsja errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: b8bzmjvj with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_231237-b8bzmjvj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run logical-sweep-202
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/b8bzmjvj
[INFO][2024-03-21 23:12:43,889][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:12:43,889][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:12:43,890][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellSVD',
 None][0m
[INFO][2024-03-21 23:12:43,895][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:12:45,935][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:12:47,408][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:12:47,418][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:12:51,706][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:12:51,706][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:12:51,706][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:12:51,706][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:12:51,706][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:12:51,718][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:12:51,719][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:12:51,719][dance][wrapped_func] Took 0:00:07.823740 to load and process data.
[WARNING][2024-03-21 23:12:51,727][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:12:51,728][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:12:51,729][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:12:51,751][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:12:51,752][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:12:51,753][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.013 MB uploadedwandb: \ 0.012 MB of 0.013 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run logical-sweep-202 at: https://wandb.ai/xzy11632/dance-dev/runs/b8bzmjvj
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_231237-b8bzmjvj/logs
wandb: ERROR Run b8bzmjvj errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: raggpmde with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_231306-raggpmde
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ruby-sweep-203
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/raggpmde
[INFO][2024-03-21 23:13:13,162][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:13:13,163][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:13:13,164][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 23:13:13,172][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:13:13,785][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:13:13,975][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:13:13,978][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:13:14,252][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:13:14,253][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:13:14,253][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:13:14,253][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:13:14,254][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:13:14,255][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:13:14,256][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:13:14,256][dance][wrapped_func] Took 0:00:01.084055 to load and process data.
[WARNING][2024-03-21 23:13:14,264][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:13:14,264][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:13:14,265][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:13:14,265][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 23:13:14,265][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:13:14,281][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:13:14,282][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:13:14,283][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.012 MB of 0.018 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run ruby-sweep-203 at: https://wandb.ai/xzy11632/dance-dev/runs/raggpmde
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_231306-raggpmde/logs
wandb: ERROR Run raggpmde errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: m2us207g with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_231328-m2us207g
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run faithful-sweep-204
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/m2us207g
[INFO][2024-03-21 23:13:35,837][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:13:35,837][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:13:35,839][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 23:13:35,852][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:13:37,729][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:13:37,955][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:13:37,961][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:13:43,667][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:13:43,667][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:13:43,667][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:13:43,668][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:13:43,668][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:13:43,697][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:13:43,698][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:13:43,710][dance][wrapped_func] Took 0:00:07.857633 to load and process data.
[WARNING][2024-03-21 23:13:43,728][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:13:43,736][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:13:43,737][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:13:43,772][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:13:43,781][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:13:43,781][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run faithful-sweep-204 at: https://wandb.ai/xzy11632/dance-dev/runs/m2us207g
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_231328-m2us207g/logs
wandb: ERROR Run m2us207g errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: 3jvul51m with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_231401-3jvul51m
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run legendary-sweep-205
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/3jvul51m
[INFO][2024-03-21 23:14:09,487][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:14:09,487][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:14:09,489][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 23:14:09,494][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:14:10,040][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:14:10,214][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:14:10,255][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:14:10,537][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:14:10,537][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:14:10,538][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:14:10,538][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:14:10,538][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:14:10,540][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:14:10,541][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:14:10,541][dance][wrapped_func] Took 0:00:01.046988 to load and process data.
[WARNING][2024-03-21 23:14:10,548][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:14:10,549][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:14:10,549][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:14:10,566][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:14:10,567][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:14:10,568][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run legendary-sweep-205 at: https://wandb.ai/xzy11632/dance-dev/runs/3jvul51m
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_231401-3jvul51m/logs
wandb: ERROR Run 3jvul51m errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: z61ssndd with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_231432-z61ssndd
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run worldly-sweep-206
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/z61ssndd
[INFO][2024-03-21 23:14:39,965][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:14:39,965][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:14:39,966][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'CellPCA',
 None][0m
[INFO][2024-03-21 23:14:39,972][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:14:41,219][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:14:41,415][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:14:41,420][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:14:41,752][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:14:41,753][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:14:41,753][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:14:41,753][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:14:41,753][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:14:41,756][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:14:41,756][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:14:41,757][dance][wrapped_func] Took 0:00:01.785014 to load and process data.
[WARNING][2024-03-21 23:14:41,766][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:14:41,767][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:14:41,768][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:14:41,787][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:14:41,788][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:14:41,789][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:14:57,938][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=64)
[INFO][2024-03-21 23:14:57,940][dance.CellPCA][__call__] Top 10 explained variances: [0.2849135  0.23399706 0.10491209 0.03121686 0.02249993 0.01565635
 0.01399426 0.01239254 0.011291   0.00947875]
[INFO][2024-03-21 23:14:57,940][dance.CellPCA][__call__] Total explained variance: 90.04%
[INFO][2024-03-21 23:14:57,941][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:14:57,941][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.016 MB of 0.026 MB uploadedwandb: \ 0.016 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.72727
wandb:  test_acc 0.72464
wandb: train_acc 0.98855
wandb: 
wandb: üöÄ View run worldly-sweep-206 at: https://wandb.ai/xzy11632/dance-dev/runs/z61ssndd
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_231432-z61ssndd/logs
wandb: Agent Starting Run: i25b8r1e with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_231511-i25b8r1e
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run driven-sweep-207
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/i25b8r1e
[INFO][2024-03-21 23:15:18,938][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:15:18,939][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:15:18,950][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'CellSVD',
 None][0m
[INFO][2024-03-21 23:15:18,955][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:15:19,417][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:15:19,642][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:15:19,645][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:15:19,852][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:15:19,852][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:15:19,853][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:15:19,853][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:15:19,853][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:15:19,855][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:15:19,855][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:15:19,856][dance][wrapped_func] Took 0:00:00.900846 to load and process data.
[WARNING][2024-03-21 23:15:19,864][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:15:19,865][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:15:19,865][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:15:19,882][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:15:19,883][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:15:19,884][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:16:15,866][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=64)
[INFO][2024-03-21 23:16:15,876][dance.CellSVD][__call__] Top 10 explained variances: [0.19580242 0.2467493  0.17537901 0.03233096 0.02503031 0.01577302
 0.01404966 0.01250683 0.01131116 0.00951184]
[INFO][2024-03-21 23:16:15,876][dance.CellSVD][__call__] Total explained variance: 89.99%
[INFO][2024-03-21 23:16:15,877][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:16:15,877][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.72727
wandb:  test_acc 0.71739
wandb: train_acc 0.98092
wandb: 
wandb: üöÄ View run driven-sweep-207 at: https://wandb.ai/xzy11632/dance-dev/runs/i25b8r1e
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_231511-i25b8r1e/logs
wandb: Agent Starting Run: lgn7tjzd with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_231632-lgn7tjzd
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run scarlet-sweep-208
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/lgn7tjzd
[INFO][2024-03-21 23:16:39,195][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:16:39,196][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:16:39,197][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 23:16:39,202][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:16:44,079][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:16:44,406][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:16:44,416][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:16:48,540][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:16:48,540][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:16:48,541][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:16:48,541][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:16:48,541][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:16:48,566][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:16:48,567][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:16:48,567][dance][wrapped_func] Took 0:00:09.365208 to load and process data.
[WARNING][2024-03-21 23:16:48,599][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:16:48,601][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:16:48,601][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:16:48,602][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 23:16:48,602][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:16:48,645][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:16:48,646][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:16:48,647][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:17:02,741][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:17:02,742][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 23:17:02,781][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:17:02,781][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.013 MB of 0.026 MB uploadedwandb: - 0.013 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.77273
wandb:  test_acc 0.7029
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run scarlet-sweep-208 at: https://wandb.ai/xzy11632/dance-dev/runs/lgn7tjzd
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_231632-lgn7tjzd/logs
wandb: Agent Starting Run: o0bkiauw with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_231716-o0bkiauw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rosy-sweep-209
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/o0bkiauw
[INFO][2024-03-21 23:17:23,786][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:17:23,786][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:17:23,789][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 23:17:23,802][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:17:26,096][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:17:27,147][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:17:27,151][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:17:32,162][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:17:32,162][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:17:32,163][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:17:32,163][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:17:32,163][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:17:32,175][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:17:32,176][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:17:32,185][dance][wrapped_func] Took 0:00:08.383633 to load and process data.
[WARNING][2024-03-21 23:17:32,200][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:17:32,201][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:17:32,202][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:17:32,221][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:17:32,222][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:17:32,222][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:17:42,930][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=37)
[INFO][2024-03-21 23:17:42,934][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.21%
[INFO][2024-03-21 23:17:43,004][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:17:43,009][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.77273
wandb:  test_acc 0.77536
wandb: train_acc 0.9084
wandb: 
wandb: üöÄ View run rosy-sweep-209 at: https://wandb.ai/xzy11632/dance-dev/runs/o0bkiauw
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_231716-o0bkiauw/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 6ih5nsqq with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_231804-6ih5nsqq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run proud-sweep-210
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/6ih5nsqq
[INFO][2024-03-21 23:18:12,477][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:18:12,477][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:18:12,478][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 23:18:12,490][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:18:14,628][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:18:14,839][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:18:14,843][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:18:18,241][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:18:18,251][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:18:18,252][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:18:18,252][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:18:18,252][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:18:18,276][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:18:18,277][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:18:18,277][dance][wrapped_func] Took 0:00:05.786701 to load and process data.
[WARNING][2024-03-21 23:18:18,286][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:18:18,287][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:18:18,288][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:18:18,310][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:18:18,311][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:18:18,312][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:19:00,869][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=44)
[INFO][2024-03-21 23:19:00,870][dance.WeightedFeatureSVD][__call__] Total explained variance: 91.56%
[INFO][2024-03-21 23:19:00,931][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:19:00,937][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.018 MB of 0.026 MB uploadedwandb: \ 0.018 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.87879
wandb:  test_acc 0.7971
wandb: train_acc 0.92748
wandb: 
wandb: üöÄ View run proud-sweep-210 at: https://wandb.ai/xzy11632/dance-dev/runs/6ih5nsqq
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_231804-6ih5nsqq/logs
wandb: Agent Starting Run: kl1w8kt3 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_231914-kl1w8kt3
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run azure-sweep-2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/kl1w8kt3
[INFO][2024-03-21 23:19:20,989][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:19:20,990][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:19:20,991][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'FilterGenesNumberPlaceHolder',
 'CellPCA',
 None][0m
[INFO][2024-03-21 23:19:20,996][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:19:22,248][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:19:22,458][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:19:22,462][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:19:26,611][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:19:26,612][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:19:26,613][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:19:26,613][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:19:26,613][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:19:26,626][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:19:26,626][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:19:26,627][dance][wrapped_func] Took 0:00:05.631363 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 23:19:26,638][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:19:26,640][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:19:26,641][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:19:26,662][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:19:26,663][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:19:27,091][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:20:05,319][dance.CellPCA][__call__] Generating cell PCA features (466, 22088) (k=2)
[INFO][2024-03-21 23:20:05,320][dance.CellPCA][__call__] Top 10 explained variances: [0.89597726 0.1034189 ]
[INFO][2024-03-21 23:20:05,320][dance.CellPCA][__call__] Total explained variance: 99.94%
[INFO][2024-03-21 23:20:05,326][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:20:05,326][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.43939
wandb:  test_acc 0.02174
wandb: train_acc 0.3626
wandb: 
wandb: üöÄ View run azure-sweep-2 at: https://wandb.ai/xzy11632/dance-dev/runs/kl1w8kt3
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_231914-kl1w8kt3/logs
wandb: Agent Starting Run: 4uq5x7aw with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_232019-4uq5x7aw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fanciful-sweep-3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/4uq5x7aw
[INFO][2024-03-21 23:20:26,386][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:20:26,387][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:20:26,388][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'FilterGenesNumberPlaceHolder',
 'CellSVD',
 None][0m
[INFO][2024-03-21 23:20:26,393][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:20:27,743][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:20:27,941][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:20:27,944][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:20:36,169][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:20:36,169][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:20:36,170][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:20:36,170][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:20:36,170][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:20:36,193][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:20:36,199][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:20:36,201][dance][wrapped_func] Took 0:00:09.808212 to load and process data.
[WARNING][2024-03-21 23:20:36,232][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:20:36,233][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:20:36,234][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:20:36,279][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:20:36,280][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:20:36,339][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:22:04,912][dance.CellSVD][__call__] Generating cell SVD features (466, 22088) (k=2)
[INFO][2024-03-21 23:22:04,913][dance.CellSVD][__call__] Top 10 explained variances: [0.8949671  0.10436006]
[INFO][2024-03-21 23:22:04,914][dance.CellSVD][__call__] Total explained variance: 99.93%
[INFO][2024-03-21 23:22:04,945][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:22:04,946][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.27273
wandb:  test_acc 0.01449
wandb: train_acc 0.21756
wandb: 
wandb: üöÄ View run fanciful-sweep-3 at: https://wandb.ai/xzy11632/dance-dev/runs/4uq5x7aw
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_232019-4uq5x7aw/logs
wandb: Agent Starting Run: e98sjj4t with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_232221-e98sjj4t
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run flowing-sweep-4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/e98sjj4t
[INFO][2024-03-21 23:22:28,603][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:22:28,604][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:22:28,609][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'FilterGenesNumberPlaceHolder',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 23:22:28,614][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:22:30,360][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:22:30,552][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:22:30,556][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:22:35,522][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:22:35,522][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:22:35,522][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:22:35,522][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:22:35,523][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:22:35,531][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:22:35,531][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:22:35,531][dance][wrapped_func] Took 0:00:06.917790 to load and process data.
[WARNING][2024-03-21 23:22:35,540][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:22:35,541][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:22:35,541][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:22:35,542][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 23:22:35,542][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:22:35,564][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:22:35,565][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:22:35,611][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:22:35,612][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:22:35,613][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 23:22:45,568][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:22:45,569][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.81818
wandb:  test_acc 0.32609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run flowing-sweep-4 at: https://wandb.ai/xzy11632/dance-dev/runs/e98sjj4t
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_232221-e98sjj4t/logs
wandb: Agent Starting Run: b8uuqws8 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_232306-b8uuqws8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run vivid-sweep-5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/b8uuqws8
[INFO][2024-03-21 23:23:13,327][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:23:13,327][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:23:13,328][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 23:23:13,340][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:23:14,784][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:23:15,129][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:23:15,134][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:23:17,972][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:23:17,973][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:23:17,973][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:23:17,973][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:23:17,973][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:23:17,985][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:23:17,986][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:23:17,986][dance][wrapped_func] Took 0:00:04.646640 to load and process data.
[WARNING][2024-03-21 23:23:17,995][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:23:17,996][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:23:17,996][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:23:18,020][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:23:18,021][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:23:18,292][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:23:25,501][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 22088) (k=1)
[INFO][2024-03-21 23:23:25,502][dance.WeightedFeaturePCA][__call__] Total explained variance: 97.25%
[INFO][2024-03-21 23:23:26,134][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:23:26,138][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run vivid-sweep-5 at: https://wandb.ai/xzy11632/dance-dev/runs/b8uuqws8
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_232306-b8uuqws8/logs
wandb: Agent Starting Run: v85ll38u with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_232342-v85ll38u
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run skilled-sweep-6
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/v85ll38u
[INFO][2024-03-21 23:23:48,697][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:23:48,697][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:23:48,698][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 23:23:48,703][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:23:50,529][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:23:50,965][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:23:50,969][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:23:55,288][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:23:55,288][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:23:55,289][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:23:55,289][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:23:55,289][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:23:55,303][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:23:55,304][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:23:55,305][dance][wrapped_func] Took 0:00:06.601628 to load and process data.
[WARNING][2024-03-21 23:23:55,315][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:23:55,316][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:23:55,316][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:23:55,353][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:23:55,354][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-21 23:23:56,211][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:24:36,782][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 22088) (k=1)
[INFO][2024-03-21 23:24:36,782][dance.WeightedFeatureSVD][__call__] Total explained variance: 97.25%
[INFO][2024-03-21 23:24:37,899][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:24:37,899][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run skilled-sweep-6 at: https://wandb.ai/xzy11632/dance-dev/runs/v85ll38u
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_232342-v85ll38u/logs
wandb: Agent Starting Run: 16rim9va with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_232452-16rim9va
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run avid-sweep-7
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/16rim9va
[INFO][2024-03-21 23:24:59,504][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:24:59,504][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:24:59,510][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'FilterGenesRegression',
 'CellPCA',
 None][0m
[INFO][2024-03-21 23:24:59,518][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:25:00,029][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:25:00,309][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:25:00,323][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:25:03,915][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:25:03,915][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:25:03,915][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:25:03,916][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:25:03,916][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:25:03,924][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:25:03,925][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:25:03,925][dance][wrapped_func] Took 0:00:04.407080 to load and process data.
[WARNING][2024-03-21 23:25:03,933][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:25:03,934][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:25:03,952][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:25:03,953][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 23:25:04,907][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 23:25:38,524][dance.CellPCA][__call__] Generating cell PCA features (466, 22088) (k=2)
[INFO][2024-03-21 23:25:38,525][dance.CellPCA][__call__] Top 10 explained variances: [0.89597726 0.1034189 ]
[INFO][2024-03-21 23:25:38,526][dance.CellPCA][__call__] Total explained variance: 99.94%
[INFO][2024-03-21 23:25:38,536][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:25:38,536][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.43939
wandb:  test_acc 0.02174
wandb: train_acc 0.3626
wandb: 
wandb: üöÄ View run avid-sweep-7 at: https://wandb.ai/xzy11632/dance-dev/runs/16rim9va
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_232452-16rim9va/logs
wandb: Agent Starting Run: ug0t9mud with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_232552-ug0t9mud
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run desert-sweep-8
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ug0t9mud
[INFO][2024-03-21 23:26:04,029][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:26:04,029][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:26:04,031][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'FilterGenesRegression',
 'CellSVD',
 None][0m
[INFO][2024-03-21 23:26:04,035][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:26:05,852][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:26:06,204][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:26:06,208][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:26:10,967][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:26:10,967][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:26:10,973][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:26:10,973][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:26:10,974][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:26:10,987][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:26:10,988][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:26:10,988][dance][wrapped_func] Took 0:00:06.953130 to load and process data.
[WARNING][2024-03-21 23:26:10,997][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:26:10,998][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:26:11,017][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:26:11,018][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 23:26:11,262][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 23:27:36,720][dance.CellSVD][__call__] Generating cell SVD features (466, 22088) (k=2)
[INFO][2024-03-21 23:27:36,728][dance.CellSVD][__call__] Top 10 explained variances: [0.8949671  0.10436006]
[INFO][2024-03-21 23:27:36,728][dance.CellSVD][__call__] Total explained variance: 99.93%
[INFO][2024-03-21 23:27:36,730][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:27:36,730][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.27273
wandb:  test_acc 0.01449
wandb: train_acc 0.21756
wandb: 
wandb: üöÄ View run desert-sweep-8 at: https://wandb.ai/xzy11632/dance-dev/runs/ug0t9mud
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_232552-ug0t9mud/logs
wandb: Agent Starting Run: m70p1mwd with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_232754-m70p1mwd
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run charmed-sweep-9
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/m70p1mwd
[INFO][2024-03-21 23:28:01,257][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:28:01,257][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:28:01,259][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'FilterGenesRegression',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 23:28:01,264][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:28:04,333][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:28:04,545][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:28:04,549][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:28:08,462][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:28:08,463][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:28:08,463][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:28:08,463][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:28:08,464][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:28:08,476][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:28:08,477][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:28:08,477][dance][wrapped_func] Took 0:00:07.213182 to load and process data.
[WARNING][2024-03-21 23:28:08,486][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:28:08,487][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:28:08,487][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 23:28:08,487][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:28:08,506][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:28:08,507][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 23:28:10,134][dance][_filter_enclasc] Start generating cell features using EnClaSC
[WARNING][2024-03-21 23:28:10,185][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:28:10,186][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 23:28:19,288][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:28:19,289][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.81818
wandb:  test_acc 0.32609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run charmed-sweep-9 at: https://wandb.ai/xzy11632/dance-dev/runs/m70p1mwd
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_232754-m70p1mwd/logs
wandb: Agent Starting Run: ijj9w9t4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_232838-ijj9w9t4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run autumn-sweep-10
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ijj9w9t4
[INFO][2024-03-21 23:28:45,725][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:28:45,726][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:28:45,727][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 23:28:45,732][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:28:48,715][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:28:48,919][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:28:48,923][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:28:52,212][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:28:52,220][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:28:52,220][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:28:52,220][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:28:52,220][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:28:52,233][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:28:52,233][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:28:52,234][dance][wrapped_func] Took 0:00:06.501743 to load and process data.
[WARNING][2024-03-21 23:28:52,243][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:28:52,244][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:28:52,273][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:28:52,274][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 23:28:52,523][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 23:29:02,145][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 22088) (k=1)
[INFO][2024-03-21 23:29:02,146][dance.WeightedFeaturePCA][__call__] Total explained variance: 97.25%
[INFO][2024-03-21 23:29:03,454][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:29:03,454][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run autumn-sweep-10 at: https://wandb.ai/xzy11632/dance-dev/runs/ijj9w9t4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_232838-ijj9w9t4/logs
wandb: Agent Starting Run: tzgibu1i with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_232920-tzgibu1i
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lemon-sweep-11
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/tzgibu1i
[INFO][2024-03-21 23:29:27,889][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:29:27,889][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:29:27,890][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 23:29:27,896][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:29:29,126][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:29:29,474][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:29:29,478][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:29:33,948][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:29:33,949][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:29:33,949][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:29:33,949][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:29:33,949][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:29:33,960][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:29:33,961][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:29:33,961][dance][wrapped_func] Took 0:00:06.065577 to load and process data.
[WARNING][2024-03-21 23:29:33,969][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:29:33,970][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:29:33,989][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:29:33,990][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 23:29:35,589][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 23:30:16,778][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 22088) (k=1)
[INFO][2024-03-21 23:30:16,779][dance.WeightedFeatureSVD][__call__] Total explained variance: 97.25%
[INFO][2024-03-21 23:30:17,873][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:30:17,873][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run lemon-sweep-11 at: https://wandb.ai/xzy11632/dance-dev/runs/tzgibu1i
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_232920-tzgibu1i/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 9e8t4yvc with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_233040-9e8t4yvc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run visionary-sweep-12
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/9e8t4yvc
[INFO][2024-03-21 23:30:47,229][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:30:47,230][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:30:47,231][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder', 'NormalizeTotal', 'FilterGenesTopK', 'CellPCA', None][0m
[INFO][2024-03-21 23:30:47,236][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:30:50,047][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:30:50,207][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:30:50,210][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:30:55,213][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:30:55,214][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:30:55,214][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:30:55,215][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:30:55,215][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:30:55,224][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:30:55,225][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:30:55,225][dance][wrapped_func] Took 0:00:07.989136 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 23:30:55,233][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:30:55,234][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:30:55,253][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:30:55,254][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 23:31:10,833][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=57)
[INFO][2024-03-21 23:31:10,834][dance.CellPCA][__call__] Top 10 explained variances: [0.13273126 0.07043404 0.06966697 0.0533112  0.05175133 0.04008397
 0.03945327 0.02878772 0.02790851 0.01852542]
[INFO][2024-03-21 23:31:10,834][dance.CellPCA][__call__] Total explained variance: 90.02%
[INFO][2024-03-21 23:31:10,837][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:31:10,837][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.28788
wandb:  test_acc 0.07971
wandb: train_acc 0.54198
wandb: 
wandb: üöÄ View run visionary-sweep-12 at: https://wandb.ai/xzy11632/dance-dev/runs/9e8t4yvc
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_233040-9e8t4yvc/logs
wandb: Agent Starting Run: iua1pf7r with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_233123-iua1pf7r
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run flowing-sweep-13
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/iua1pf7r
[INFO][2024-03-21 23:31:32,038][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:31:32,038][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:31:32,041][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder', 'NormalizeTotal', 'FilterGenesTopK', 'CellSVD', None][0m
[INFO][2024-03-21 23:31:32,062][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:31:33,026][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:31:33,525][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:31:33,530][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:31:37,462][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:31:37,463][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:31:37,463][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:31:37,463][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:31:37,463][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:31:37,480][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:31:37,481][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:31:37,481][dance][wrapped_func] Took 0:00:05.419500 to load and process data.
[WARNING][2024-03-21 23:31:37,490][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:31:37,491][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:31:37,510][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:31:37,511][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 23:32:58,880][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=57)
[INFO][2024-03-21 23:32:58,890][dance.CellSVD][__call__] Top 10 explained variances: [0.1327237  0.07039138 0.06969662 0.05329774 0.05175721 0.04006456
 0.03946847 0.02877926 0.02791193 0.01851693]
[INFO][2024-03-21 23:32:58,892][dance.CellSVD][__call__] Total explained variance: 90.00%
[INFO][2024-03-21 23:32:58,894][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:32:58,894][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.28788
wandb:  test_acc 0.1087
wandb: train_acc 0.55725
wandb: 
wandb: üöÄ View run flowing-sweep-13 at: https://wandb.ai/xzy11632/dance-dev/runs/iua1pf7r
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_233123-iua1pf7r/logs
wandb: Agent Starting Run: tja2yaxf with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_233314-tja2yaxf
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ruby-sweep-14
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/tja2yaxf
[INFO][2024-03-21 23:33:22,608][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:33:22,608][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:33:22,611][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'FilterGenesTopK',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 23:33:22,616][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:33:23,777][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:33:24,040][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:33:24,045][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:33:28,606][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:33:28,607][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:33:28,607][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:33:28,607][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:33:28,607][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:33:28,630][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:33:28,631][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:33:28,631][dance][wrapped_func] Took 0:00:06.015482 to load and process data.
[WARNING][2024-03-21 23:33:28,641][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:33:28,642][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:33:28,642][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 23:33:28,642][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:33:28,663][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:33:28,664][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[WARNING][2024-03-21 23:33:28,759][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:33:28,759][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 23:33:28,872][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:33:28,873][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.33333
wandb:  test_acc 0.0942
wandb: train_acc 0.98092
wandb: 
wandb: üöÄ View run ruby-sweep-14 at: https://wandb.ai/xzy11632/dance-dev/runs/tja2yaxf
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_233314-tja2yaxf/logs
wandb: Agent Starting Run: 7eca4n7q with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_233346-7eca4n7q
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lilac-sweep-15
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/7eca4n7q
[INFO][2024-03-21 23:33:53,603][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:33:53,603][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:33:53,605][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 23:33:53,614][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:33:55,646][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:33:55,952][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:33:55,956][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:33:59,847][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:33:59,848][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:33:59,848][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:33:59,849][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:33:59,849][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:33:59,864][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:33:59,865][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:33:59,866][dance][wrapped_func] Took 0:00:06.251843 to load and process data.
[WARNING][2024-03-21 23:33:59,875][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:33:59,876][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:33:59,895][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:33:59,896][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 23:34:03,766][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=32)
[INFO][2024-03-21 23:34:03,766][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.21%
[INFO][2024-03-21 23:34:03,800][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:34:03,800][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.018 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.22727
wandb:  test_acc 0.10145
wandb: train_acc 0.51527
wandb: 
wandb: üöÄ View run lilac-sweep-15 at: https://wandb.ai/xzy11632/dance-dev/runs/7eca4n7q
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_233346-7eca4n7q/logs
wandb: Agent Starting Run: q660z99z with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_233417-q660z99z
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run drawn-sweep-16
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/q660z99z
[INFO][2024-03-21 23:34:24,322][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:34:24,323][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:34:24,324][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 23:34:24,336][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:34:26,077][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:34:26,852][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:34:26,866][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:34:32,183][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:34:32,184][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:34:32,184][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:34:32,184][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:34:32,184][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:34:32,202][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:34:32,202][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:34:32,203][dance][wrapped_func] Took 0:00:07.867069 to load and process data.
[WARNING][2024-03-21 23:34:32,211][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:34:32,212][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:34:32,229][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:34:32,230][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 23:35:12,379][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=32)
[INFO][2024-03-21 23:35:12,380][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.20%
[INFO][2024-03-21 23:35:12,411][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:35:12,411][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.24242
wandb:  test_acc 0.0942
wandb: train_acc 0.50382
wandb: 
wandb: üöÄ View run drawn-sweep-16 at: https://wandb.ai/xzy11632/dance-dev/runs/q660z99z
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_233417-q660z99z/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: nwrmsk72 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_233536-nwrmsk72
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ethereal-sweep-17
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/nwrmsk72
[INFO][2024-03-21 23:35:44,184][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:35:44,184][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:35:44,192][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellPCA',
 None][0m
[INFO][2024-03-21 23:35:44,196][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:35:44,877][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:35:45,047][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:35:45,050][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:35:47,550][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:35:47,550][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:35:47,551][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:35:47,551][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:35:47,551][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:35:47,559][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:35:47,559][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:35:47,560][dance][wrapped_func] Took 0:00:03.363564 to load and process data.
[WARNING][2024-03-21 23:35:47,568][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:35:47,569][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:35:47,586][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:35:47,588][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run ethereal-sweep-17 at: https://wandb.ai/xzy11632/dance-dev/runs/nwrmsk72
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_233536-nwrmsk72/logs
wandb: ERROR Run nwrmsk72 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: adcf29m4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_233606-adcf29m4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run hopeful-sweep-18
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/adcf29m4
[INFO][2024-03-21 23:36:14,410][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:36:14,411][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:36:14,412][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellSVD',
 None][0m
[INFO][2024-03-21 23:36:14,424][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:36:17,066][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:36:17,261][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:36:17,264][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:36:20,345][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:36:20,345][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:36:20,346][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:36:20,347][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:36:20,347][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:36:20,367][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:36:20,370][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:36:20,370][dance][wrapped_func] Took 0:00:05.946269 to load and process data.
[WARNING][2024-03-21 23:36:20,379][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:36:20,380][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:36:20,398][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:36:20,399][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run hopeful-sweep-18 at: https://wandb.ai/xzy11632/dance-dev/runs/adcf29m4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_233606-adcf29m4/logs
wandb: ERROR Run adcf29m4 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: ck2jebkv with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_233638-ck2jebkv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run likely-sweep-19
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ck2jebkv
[INFO][2024-03-21 23:36:45,511][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:36:45,511][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:36:45,514][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 23:36:45,521][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:36:48,056][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:36:48,255][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:36:48,259][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:36:54,140][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:36:54,140][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:36:54,140][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:36:54,141][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:36:54,141][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:36:54,153][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:36:54,154][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:36:54,154][dance][wrapped_func] Took 0:00:08.633496 to load and process data.
[WARNING][2024-03-21 23:36:54,162][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:36:54,163][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:36:54,163][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 23:36:54,163][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:36:54,181][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:36:54,181][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run likely-sweep-19 at: https://wandb.ai/xzy11632/dance-dev/runs/ck2jebkv
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_233638-ck2jebkv/logs
wandb: ERROR Run ck2jebkv errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: fkh1g1fp with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_233710-fkh1g1fp
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run usual-sweep-20
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/fkh1g1fp
[INFO][2024-03-21 23:37:18,228][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:37:18,228][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:37:18,229][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 23:37:18,235][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:37:20,146][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:37:20,554][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:37:20,558][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:37:24,684][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:37:24,684][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:37:24,684][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:37:24,685][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:37:24,685][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:37:24,696][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:37:24,697][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:37:24,697][dance][wrapped_func] Took 0:00:06.461936 to load and process data.
[WARNING][2024-03-21 23:37:24,706][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:37:24,707][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:37:24,725][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:37:24,726][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run usual-sweep-20 at: https://wandb.ai/xzy11632/dance-dev/runs/fkh1g1fp
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_233710-fkh1g1fp/logs
wandb: ERROR Run fkh1g1fp errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: pcfhgu93 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_233741-pcfhgu93
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run celestial-sweep-21
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/pcfhgu93
[INFO][2024-03-21 23:37:46,925][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:37:46,926][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:37:46,928][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 23:37:46,932][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:37:48,571][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:37:48,740][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:37:48,743][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:37:52,064][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:37:52,064][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:37:52,064][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:37:52,064][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:37:52,065][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:37:52,078][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:37:52,079][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:37:52,079][dance][wrapped_func] Took 0:00:05.147064 to load and process data.
[WARNING][2024-03-21 23:37:52,089][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:37:52,092][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:37:52,114][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:37:52,115][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.021 MB uploadedwandb: - 0.012 MB of 0.021 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run celestial-sweep-21 at: https://wandb.ai/xzy11632/dance-dev/runs/pcfhgu93
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_233741-pcfhgu93/logs
wandb: ERROR Run pcfhgu93 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: bu6fyk9h with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_233811-bu6fyk9h
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run quiet-sweep-22
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/bu6fyk9h
[INFO][2024-03-21 23:38:17,166][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:38:17,167][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:38:17,169][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellPCA',
 None][0m
[INFO][2024-03-21 23:38:17,174][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:38:18,940][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:38:19,135][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:38:19,138][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:38:22,305][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:38:22,305][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:38:22,305][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:38:22,305][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:38:22,305][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:38:22,320][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:38:22,320][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:38:22,320][dance][wrapped_func] Took 0:00:05.146619 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 23:38:22,328][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:38:22,330][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:38:22,349][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:38:22,350][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.017 MB of 0.025 MB uploadedwandb: \ 0.017 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run quiet-sweep-22 at: https://wandb.ai/xzy11632/dance-dev/runs/bu6fyk9h
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_233811-bu6fyk9h/logs
wandb: ERROR Run bu6fyk9h errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: tw3t4lt4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_233837-tw3t4lt4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wobbly-sweep-23
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/tw3t4lt4
[INFO][2024-03-21 23:38:43,059][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:38:43,060][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:38:43,061][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellSVD',
 None][0m
[INFO][2024-03-21 23:38:43,067][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:38:44,474][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:38:44,666][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:38:44,670][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:38:50,648][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:38:50,648][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:38:50,649][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:38:50,649][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:38:50,649][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:38:50,660][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:38:50,661][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:38:50,661][dance][wrapped_func] Took 0:00:07.594329 to load and process data.
[WARNING][2024-03-21 23:38:50,670][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:38:50,671][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:38:50,691][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:38:50,692][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.018 MB of 0.025 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run wobbly-sweep-23 at: https://wandb.ai/xzy11632/dance-dev/runs/tw3t4lt4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_233837-tw3t4lt4/logs
wandb: ERROR Run tw3t4lt4 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: g1psb1m1 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_233905-g1psb1m1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run bumbling-sweep-24
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/g1psb1m1
[INFO][2024-03-21 23:39:11,249][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:39:11,249][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:39:11,251][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 23:39:11,256][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:39:13,089][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:39:13,284][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:39:13,289][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:39:16,165][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:39:16,165][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:39:16,166][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:39:16,166][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:39:16,166][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:39:16,173][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:39:16,174][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:39:16,174][dance][wrapped_func] Took 0:00:04.918411 to load and process data.
[WARNING][2024-03-21 23:39:16,181][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:39:16,182][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:39:16,182][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 23:39:16,182][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:39:16,199][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:39:16,200][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.013 MB of 0.026 MB uploadedwandb: - 0.013 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run bumbling-sweep-24 at: https://wandb.ai/xzy11632/dance-dev/runs/g1psb1m1
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_233905-g1psb1m1/logs
wandb: ERROR Run g1psb1m1 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: udq0zm0s with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_233932-udq0zm0s
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run zany-sweep-25
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/udq0zm0s
[INFO][2024-03-21 23:39:38,116][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:39:38,117][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:39:38,118][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 23:39:38,124][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:39:40,994][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:39:42,541][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:39:42,544][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:39:45,216][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:39:45,216][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:39:45,216][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:39:45,216][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:39:45,216][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:39:45,229][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:39:45,230][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:39:45,230][dance][wrapped_func] Took 0:00:07.106173 to load and process data.
[WARNING][2024-03-21 23:39:45,236][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:39:45,237][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:39:45,254][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:39:45,255][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.013 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run zany-sweep-25 at: https://wandb.ai/xzy11632/dance-dev/runs/udq0zm0s
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_233932-udq0zm0s/logs
wandb: ERROR Run udq0zm0s errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: 00i8566m with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_233958-00i8566m
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run stoic-sweep-26
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/00i8566m
[INFO][2024-03-21 23:40:04,002][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:40:04,003][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:40:04,005][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 23:40:04,010][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:40:05,534][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:40:05,957][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:40:05,961][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:40:11,322][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:40:11,323][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:40:11,323][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:40:11,323][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:40:11,323][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:40:11,336][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:40:11,336][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:40:11,337][dance][wrapped_func] Took 0:00:07.326636 to load and process data.
[WARNING][2024-03-21 23:40:11,348][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:40:11,350][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:40:11,371][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:40:11,372][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run stoic-sweep-26 at: https://wandb.ai/xzy11632/dance-dev/runs/00i8566m
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_233958-00i8566m/logs
wandb: ERROR Run 00i8566m errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: jnzudckn with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_234028-jnzudckn
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run robust-sweep-27
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/jnzudckn
[INFO][2024-03-21 23:40:34,205][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:40:34,212][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:40:34,213][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'CellPCA',
 None][0m
[INFO][2024-03-21 23:40:34,220][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:40:35,332][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:40:35,503][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:40:35,506][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:40:37,650][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:40:37,651][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:40:37,651][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:40:37,651][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:40:37,651][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:40:37,657][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:40:37,657][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:40:37,657][dance][wrapped_func] Took 0:00:03.438015 to load and process data.
[WARNING][2024-03-21 23:40:37,665][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:40:37,666][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:40:37,685][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:40:37,686][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-21 23:40:54,913][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=95)
[INFO][2024-03-21 23:40:54,914][dance.CellPCA][__call__] Top 10 explained variances: [0.21199825 0.17749694 0.08609482 0.05468857 0.03186015 0.02881278
 0.01711577 0.01555634 0.01358382 0.0108237 ]
[INFO][2024-03-21 23:40:54,914][dance.CellPCA][__call__] Total explained variance: 90.01%
[INFO][2024-03-21 23:40:54,915][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:40:54,915][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.75758
wandb:  test_acc 0.58696
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run robust-sweep-27 at: https://wandb.ai/xzy11632/dance-dev/runs/jnzudckn
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_234028-jnzudckn/logs
wandb: Agent Starting Run: kefze5ag with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_234110-kefze5ag
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run major-sweep-28
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/kefze5ag
[INFO][2024-03-21 23:41:15,963][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:41:15,963][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:41:15,965][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'CellSVD',
 None][0m
[INFO][2024-03-21 23:41:15,970][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:41:19,068][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:41:19,238][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:41:19,242][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:41:27,810][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:41:27,810][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:41:27,810][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:41:27,811][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:41:27,811][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:41:27,820][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:41:27,821][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:41:27,821][dance][wrapped_func] Took 0:00:11.851412 to load and process data.
[WARNING][2024-03-21 23:41:27,828][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:41:27,829][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:41:27,846][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:41:27,847][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-21 23:42:05,867][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=96)
[INFO][2024-03-21 23:42:05,868][dance.CellSVD][__call__] Top 10 explained variances: [0.09854332 0.202814   0.14497645 0.07338345 0.03358687 0.03017136
 0.01806461 0.01555801 0.01369496 0.011122  ]
[INFO][2024-03-21 23:42:05,869][dance.CellSVD][__call__] Total explained variance: 90.02%
[INFO][2024-03-21 23:42:05,872][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:42:05,882][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.74242
wandb:  test_acc 0.56522
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run major-sweep-28 at: https://wandb.ai/xzy11632/dance-dev/runs/kefze5ag
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_234110-kefze5ag/logs
wandb: Agent Starting Run: bgmd0wjo with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_234221-bgmd0wjo
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run divine-sweep-29
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/bgmd0wjo
[INFO][2024-03-21 23:42:27,189][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:42:27,190][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:42:27,191][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 23:42:27,196][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:42:28,784][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:42:29,031][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:42:29,036][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:42:32,550][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:42:32,550][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:42:32,550][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:42:32,550][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:42:32,550][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:42:32,558][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:42:32,558][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:42:32,558][dance][wrapped_func] Took 0:00:05.362321 to load and process data.
[WARNING][2024-03-21 23:42:32,565][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:42:32,565][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:42:32,565][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 23:42:32,566][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:42:32,581][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:42:32,582][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-21 23:42:38,907][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:42:38,909][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 23:42:38,971][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:42:38,971][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.77273
wandb:  test_acc 0.71739
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run divine-sweep-29 at: https://wandb.ai/xzy11632/dance-dev/runs/bgmd0wjo
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_234221-bgmd0wjo/logs
wandb: Agent Starting Run: pa87h6wc with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_234251-pa87h6wc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run misty-sweep-30
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/pa87h6wc
[INFO][2024-03-21 23:42:58,800][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:42:58,801][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:42:58,803][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 23:42:58,810][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:43:00,156][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:43:00,318][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:43:00,321][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:43:03,894][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:43:03,894][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:43:03,894][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:43:03,894][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:43:03,894][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:43:03,905][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:43:03,906][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:43:03,908][dance][wrapped_func] Took 0:00:05.098548 to load and process data.
[WARNING][2024-03-21 23:43:03,919][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:43:03,920][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:43:03,941][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:43:03,942][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-21 23:43:16,436][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=47)
[INFO][2024-03-21 23:43:16,450][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.16%
[INFO][2024-03-21 23:43:16,490][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:43:16,490][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.74242
wandb:  test_acc 0.76087
wandb: train_acc 0.88931
wandb: 
wandb: üöÄ View run misty-sweep-30 at: https://wandb.ai/xzy11632/dance-dev/runs/pa87h6wc
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_234251-pa87h6wc/logs
wandb: Agent Starting Run: f2e0lw1t with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_234335-f2e0lw1t
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run polished-sweep-31
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/f2e0lw1t
[INFO][2024-03-21 23:43:42,200][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:43:42,200][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:43:42,201][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 23:43:42,208][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:43:44,189][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:43:44,399][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:43:44,403][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:43:50,910][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:43:50,910][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:43:50,911][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:43:50,911][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:43:50,911][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:43:50,921][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:43:50,921][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:43:50,922][dance][wrapped_func] Took 0:00:08.714508 to load and process data.
[WARNING][2024-03-21 23:43:50,929][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:43:50,930][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:43:50,948][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:43:50,949][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-21 23:44:38,103][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=56)
[INFO][2024-03-21 23:44:38,104][dance.WeightedFeatureSVD][__call__] Total explained variance: 91.72%
[INFO][2024-03-21 23:44:38,152][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:44:38,152][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.81818
wandb:  test_acc 0.73913
wandb: train_acc 0.98092
wandb: 
wandb: üöÄ View run polished-sweep-31 at: https://wandb.ai/xzy11632/dance-dev/runs/f2e0lw1t
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_234335-f2e0lw1t/logs
wandb: Agent Starting Run: zahb21ws with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_234454-zahb21ws
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run earthy-sweep-32
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/zahb21ws
[INFO][2024-03-21 23:45:02,222][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:45:02,223][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:45:02,224][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'FilterGenesNumberPlaceHolder',
 'CellPCA',
 None][0m
[INFO][2024-03-21 23:45:02,229][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:45:03,564][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:45:03,786][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:45:03,790][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:45:07,498][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:45:07,498][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:45:07,499][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:45:07,499][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:45:07,499][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:45:07,511][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:45:07,512][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:45:07,512][dance][wrapped_func] Took 0:00:05.283651 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 23:45:07,520][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:45:07,521][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:45:07,521][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:45:07,543][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:45:07,544][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 23:45:29,776][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:45:54,225][dance.CellPCA][__call__] Generating cell PCA features (466, 22088) (k=370)
[INFO][2024-03-21 23:45:54,226][dance.CellPCA][__call__] Top 10 explained variances: [0.02552739 0.01960257 0.01769765 0.01600726 0.01088694 0.00800511
 0.00752265 0.00625853 0.00570241 0.00544346]
[INFO][2024-03-21 23:45:54,226][dance.CellPCA][__call__] Total explained variance: 90.10%
[INFO][2024-03-21 23:45:54,234][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:45:54,235][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.018 MB of 0.026 MB uploadedwandb: - 0.018 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.43939
wandb:  test_acc 0.22464
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run earthy-sweep-32 at: https://wandb.ai/xzy11632/dance-dev/runs/zahb21ws
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_234454-zahb21ws/logs
wandb: Agent Starting Run: 1sfyw8lg with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_234607-1sfyw8lg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run neat-sweep-33
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/1sfyw8lg
[INFO][2024-03-21 23:46:13,050][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:46:13,051][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:46:13,052][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'FilterGenesNumberPlaceHolder',
 'CellSVD',
 None][0m
[INFO][2024-03-21 23:46:13,058][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:46:14,530][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:46:14,689][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:46:14,692][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:46:17,578][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:46:17,579][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:46:17,579][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:46:17,579][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:46:17,579][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:46:17,592][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:46:17,593][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:46:17,593][dance][wrapped_func] Took 0:00:04.535389 to load and process data.
[WARNING][2024-03-21 23:46:17,601][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:46:17,601][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:46:17,601][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:46:17,622][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:46:17,623][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 23:46:37,311][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:47:35,326][dance.CellSVD][__call__] Generating cell SVD features (466, 22088) (k=371)
[INFO][2024-03-21 23:47:35,328][dance.CellSVD][__call__] Top 10 explained variances: [0.01237719 0.02545229 0.01935173 0.01716428 0.01156089 0.00819509
 0.00757654 0.00639829 0.00588768 0.00557079]
[INFO][2024-03-21 23:47:35,328][dance.CellSVD][__call__] Total explained variance: 89.76%
[INFO][2024-03-21 23:47:35,330][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:47:35,330][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.4697
wandb:  test_acc 0.35507
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run neat-sweep-33 at: https://wandb.ai/xzy11632/dance-dev/runs/1sfyw8lg
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_234607-1sfyw8lg/logs
wandb: Agent Starting Run: 0kv6gz1w with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_234750-0kv6gz1w
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run comic-sweep-34
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/0kv6gz1w
[INFO][2024-03-21 23:47:56,179][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:47:56,180][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:47:56,211][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'FilterGenesNumberPlaceHolder',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 23:47:56,219][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:47:57,486][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:47:57,677][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:47:57,681][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:48:00,588][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:48:00,589][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:48:00,589][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:48:00,589][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:48:00,589][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:48:00,603][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:48:00,605][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:48:00,605][dance][wrapped_func] Took 0:00:04.386568 to load and process data.
[WARNING][2024-03-21 23:48:00,616][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:48:00,618][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:48:00,618][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:48:00,618][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 23:48:00,619][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:48:00,638][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:48:00,639][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 23:48:19,237][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:48:19,239][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:48:19,239][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 23:48:30,481][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:48:30,482][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.78788
wandb:  test_acc 0.76087
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run comic-sweep-34 at: https://wandb.ai/xzy11632/dance-dev/runs/0kv6gz1w
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_234750-0kv6gz1w/logs
wandb: Agent Starting Run: 5cia3l5u with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_234846-5cia3l5u
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run graceful-sweep-35
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/5cia3l5u
[INFO][2024-03-21 23:48:52,890][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:48:52,890][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:48:52,892][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 23:48:52,899][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:48:54,649][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:48:54,813][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:48:54,817][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:48:58,443][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:48:58,444][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:48:58,444][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:48:58,444][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:48:58,444][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:48:58,451][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:48:58,452][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:48:58,452][dance][wrapped_func] Took 0:00:05.553084 to load and process data.
[WARNING][2024-03-21 23:48:58,459][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:48:58,459][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:48:58,459][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:48:58,475][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:48:58,476][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 23:49:17,884][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:49:22,708][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 22088) (k=207)
[INFO][2024-03-21 23:49:22,709][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.20%
[INFO][2024-03-21 23:49:24,052][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:49:24,053][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.60606
wandb:  test_acc 0.16667
wandb: train_acc 0.75954
wandb: 
wandb: üöÄ View run graceful-sweep-35 at: https://wandb.ai/xzy11632/dance-dev/runs/5cia3l5u
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_234846-5cia3l5u/logs
wandb: Agent Starting Run: zsdmv0r5 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_234940-zsdmv0r5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fast-sweep-36
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/zsdmv0r5
[INFO][2024-03-21 23:49:46,402][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:49:46,402][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:49:46,404][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 23:49:46,410][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:49:47,098][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:49:47,325][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:49:47,327][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:49:50,203][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:49:50,203][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:49:50,204][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:49:50,204][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:49:50,204][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:49:50,217][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:49:50,217][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:49:50,217][dance][wrapped_func] Took 0:00:03.808007 to load and process data.
[WARNING][2024-03-21 23:49:50,226][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:49:50,227][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:49:50,227][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:49:50,251][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:49:50,252][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-21 23:50:11,833][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:50:50,207][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 22088) (k=208)
[INFO][2024-03-21 23:50:50,209][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.17%
[INFO][2024-03-21 23:50:51,176][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:50:51,176][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.59091
wandb:  test_acc 0.15942
wandb: train_acc 0.66031
wandb: 
wandb: üöÄ View run fast-sweep-36 at: https://wandb.ai/xzy11632/dance-dev/runs/zsdmv0r5
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_234940-zsdmv0r5/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: lt5izj0o with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_235116-lt5izj0o
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run snowy-sweep-37
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/lt5izj0o
[INFO][2024-03-21 23:51:22,921][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:51:22,921][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:51:22,923][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'FilterGenesRegression',
 'CellPCA',
 None][0m
[INFO][2024-03-21 23:51:22,934][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:51:25,002][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:51:25,159][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:51:25,162][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:51:27,472][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:51:27,472][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:51:27,472][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:51:27,473][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:51:27,473][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:51:27,485][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:51:27,485][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:51:27,486][dance][wrapped_func] Took 0:00:04.552185 to load and process data.
[WARNING][2024-03-21 23:51:27,494][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:51:27,495][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:51:27,514][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:51:27,515][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 23:51:47,440][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 23:52:09,345][dance.CellPCA][__call__] Generating cell PCA features (466, 22088) (k=370)
[INFO][2024-03-21 23:52:09,346][dance.CellPCA][__call__] Top 10 explained variances: [0.02552739 0.01960257 0.01769765 0.01600726 0.01088694 0.00800511
 0.00752265 0.00625853 0.00570241 0.00544346]
[INFO][2024-03-21 23:52:09,346][dance.CellPCA][__call__] Total explained variance: 90.10%
[INFO][2024-03-21 23:52:09,350][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:52:09,350][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.43939
wandb:  test_acc 0.22464
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run snowy-sweep-37 at: https://wandb.ai/xzy11632/dance-dev/runs/lt5izj0o
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_235116-lt5izj0o/logs
wandb: Agent Starting Run: d0skwny2 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_235222-d0skwny2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run curious-sweep-38
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/d0skwny2
[INFO][2024-03-21 23:52:28,343][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:52:28,343][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:52:28,345][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'FilterGenesRegression',
 'CellSVD',
 None][0m
[INFO][2024-03-21 23:52:28,354][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:52:29,282][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:52:29,779][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:52:29,783][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:52:33,244][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:52:33,245][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:52:33,245][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:52:33,245][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:52:33,245][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:52:33,258][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:52:33,259][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:52:33,259][dance][wrapped_func] Took 0:00:04.906187 to load and process data.
[WARNING][2024-03-21 23:52:33,267][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:52:33,268][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:52:33,290][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:52:33,291][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 23:52:53,027][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 23:54:17,620][dance.CellSVD][__call__] Generating cell SVD features (466, 22088) (k=371)
[INFO][2024-03-21 23:54:17,621][dance.CellSVD][__call__] Top 10 explained variances: [0.01237719 0.02545229 0.01935173 0.01716428 0.01156089 0.00819509
 0.00757654 0.00639829 0.00588768 0.00557079]
[INFO][2024-03-21 23:54:17,621][dance.CellSVD][__call__] Total explained variance: 89.76%
[INFO][2024-03-21 23:54:17,623][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:54:17,623][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.016 MB of 0.026 MB uploadedwandb: / 0.016 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.4697
wandb:  test_acc 0.35507
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run curious-sweep-38 at: https://wandb.ai/xzy11632/dance-dev/runs/d0skwny2
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_235222-d0skwny2/logs
wandb: Agent Starting Run: ul44wrr9 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_235430-ul44wrr9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run worthy-sweep-39
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ul44wrr9
[INFO][2024-03-21 23:54:36,047][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:54:36,048][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:54:36,054][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'FilterGenesRegression',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-21 23:54:36,060][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:54:39,105][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:54:39,290][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:54:39,293][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:54:44,062][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:54:44,063][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:54:44,063][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:54:44,063][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:54:44,064][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:54:44,077][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:54:44,078][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:54:44,078][dance][wrapped_func] Took 0:00:08.018940 to load and process data.
[WARNING][2024-03-21 23:54:44,088][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:54:44,091][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:54:44,091][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-21 23:54:44,091][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:54:44,112][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:54:44,113][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 23:55:05,799][dance][_filter_enclasc] Start generating cell features using EnClaSC
[WARNING][2024-03-21 23:55:05,837][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-21 23:55:05,838][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-21 23:55:15,140][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:55:15,141][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.78788
wandb:  test_acc 0.76087
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run worthy-sweep-39 at: https://wandb.ai/xzy11632/dance-dev/runs/ul44wrr9
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_235430-ul44wrr9/logs
wandb: Agent Starting Run: a9ptvtjw with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_235528-a9ptvtjw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run woven-sweep-40
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/a9ptvtjw
[INFO][2024-03-21 23:55:34,637][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:55:34,637][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:55:34,639][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-21 23:55:34,646][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:55:35,755][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:55:36,003][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:55:36,006][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:55:39,645][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:55:39,645][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:55:39,645][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:55:39,645][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:55:39,646][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:55:39,651][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:55:39,652][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:55:39,652][dance][wrapped_func] Took 0:00:05.006780 to load and process data.
[WARNING][2024-03-21 23:55:39,660][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:55:39,661][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:55:39,682][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:55:39,683][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 23:56:03,575][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 23:56:05,328][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 22088) (k=207)
[INFO][2024-03-21 23:56:05,329][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.20%
[INFO][2024-03-21 23:56:05,812][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:56:05,812][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.60606
wandb:  test_acc 0.16667
wandb: train_acc 0.75954
wandb: 
wandb: üöÄ View run woven-sweep-40 at: https://wandb.ai/xzy11632/dance-dev/runs/a9ptvtjw
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_235528-a9ptvtjw/logs
wandb: Agent Starting Run: 05a0nj5h with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_235619-05a0nj5h
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sage-sweep-41
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/05a0nj5h
[INFO][2024-03-21 23:56:24,965][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:56:24,972][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:56:24,973][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-21 23:56:24,979][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:56:26,364][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:56:26,629][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:56:26,634][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:56:29,768][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:56:29,769][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:56:29,769][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:56:29,769][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:56:29,769][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:56:29,783][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:56:29,784][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:56:29,784][dance][wrapped_func] Took 0:00:04.805655 to load and process data.
[WARNING][2024-03-21 23:56:29,795][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:56:29,796][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:56:29,819][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:56:29,820][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-21 23:56:54,011][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-21 23:57:21,567][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 22088) (k=208)
[INFO][2024-03-21 23:57:21,568][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.17%
[INFO][2024-03-21 23:57:22,186][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:57:22,187][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.59091
wandb:  test_acc 0.15942
wandb: train_acc 0.66031
wandb: 
wandb: üöÄ View run sage-sweep-41 at: https://wandb.ai/xzy11632/dance-dev/runs/05a0nj5h
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_235619-05a0nj5h/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 3bdsmus1 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_235745-3bdsmus1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run charmed-sweep-42
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/3bdsmus1
[INFO][2024-03-21 23:57:50,963][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:57:50,964][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:57:50,965][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder', 'ScTransform', 'FilterGenesTopK', 'CellPCA', None][0m
[INFO][2024-03-21 23:57:50,971][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:57:52,719][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:57:52,920][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:57:52,924][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:57:55,748][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:57:55,748][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:57:55,749][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:57:55,749][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:57:55,749][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:57:55,757][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:57:55,757][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:57:55,758][dance][wrapped_func] Took 0:00:04.786643 to load and process data.
[WARNING][2024-03-21 23:57:55,764][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:57:55,764][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:57:55,783][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:57:55,784][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-21 23:58:30,854][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=291)
[INFO][2024-03-21 23:58:30,855][dance.CellPCA][__call__] Top 10 explained variances: [0.10293843 0.01460796 0.0128779  0.00991173 0.00848681 0.00784603
 0.00756613 0.00735646 0.00672952 0.00639822]
[INFO][2024-03-21 23:58:30,855][dance.CellPCA][__call__] Total explained variance: 90.04%
[INFO][2024-03-21 23:58:30,857][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-21 23:58:30,857][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.31818
wandb:  test_acc 0.08696
wandb: train_acc 0.89313
wandb: 
wandb: üöÄ View run charmed-sweep-42 at: https://wandb.ai/xzy11632/dance-dev/runs/3bdsmus1
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_235745-3bdsmus1/logs
wandb: Agent Starting Run: 1nccbrz7 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240321_235844-1nccbrz7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run polar-sweep-43
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/1nccbrz7
[INFO][2024-03-21 23:58:49,621][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-21 23:58:49,622][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-21 23:58:49,623][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder', 'ScTransform', 'FilterGenesTopK', 'CellSVD', None][0m
[INFO][2024-03-21 23:58:49,635][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-21 23:58:50,659][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-21 23:58:51,166][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-21 23:58:51,169][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-21 23:58:52,035][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-21 23:58:52,035][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-21 23:58:52,035][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-21 23:58:52,035][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-21 23:58:52,036][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-21 23:58:52,044][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-21 23:58:52,046][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-21 23:58:52,047][dance][wrapped_func] Took 0:00:02.412221 to load and process data.
[WARNING][2024-03-21 23:58:52,055][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:58:52,056][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-21 23:58:52,072][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-21 23:58:52,073][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-22 00:00:37,380][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=292)
[INFO][2024-03-22 00:00:37,381][dance.CellSVD][__call__] Top 10 explained variances: [0.10280826 0.01460042 0.01284616 0.00968645 0.0083369  0.0078053
 0.00752532 0.00716898 0.00650336 0.00610819]
[INFO][2024-03-22 00:00:37,381][dance.CellSVD][__call__] Total explained variance: 89.95%
[INFO][2024-03-22 00:00:37,382][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:00:37,383][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.07246
wandb: train_acc 0.86641
wandb: 
wandb: üöÄ View run polar-sweep-43 at: https://wandb.ai/xzy11632/dance-dev/runs/1nccbrz7
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240321_235844-1nccbrz7/logs
wandb: Agent Starting Run: aixgipxu with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_000053-aixgipxu
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run logical-sweep-44
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/aixgipxu
[INFO][2024-03-22 00:01:00,494][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:01:00,494][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:01:00,496][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'FilterGenesTopK',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 00:01:00,516][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:01:01,809][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:01:02,582][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:01:02,585][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:01:05,761][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:01:05,762][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:01:05,762][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:01:05,762][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:01:05,763][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:01:05,779][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:01:05,780][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:01:05,780][dance][wrapped_func] Took 0:00:05.264812 to load and process data.
[WARNING][2024-03-22 00:01:05,788][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:01:05,789][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:01:05,789][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 00:01:05,789][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:01:05,806][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:01:05,807][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[WARNING][2024-03-22 00:01:32,749][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:01:32,750][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 00:01:32,781][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:01:32,782][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.37879
wandb:  test_acc 0.07971
wandb: train_acc 0.98855
wandb: 
wandb: üöÄ View run logical-sweep-44 at: https://wandb.ai/xzy11632/dance-dev/runs/aixgipxu
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_000053-aixgipxu/logs
wandb: Agent Starting Run: it4db4me with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_000146-it4db4me
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run woven-sweep-45
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/it4db4me
[INFO][2024-03-22 00:01:52,214][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:01:52,214][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:01:52,216][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 00:01:52,223][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:01:53,614][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:01:53,810][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:01:53,813][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:01:55,068][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:01:55,068][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:01:55,068][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:01:55,068][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:01:55,068][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:01:55,072][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:01:55,073][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:01:55,073][dance][wrapped_func] Took 0:00:02.850823 to load and process data.
[WARNING][2024-03-22 00:01:55,081][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:01:55,081][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:01:55,102][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:01:55,103][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-22 00:02:20,526][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=172)
[INFO][2024-03-22 00:02:20,527][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.16%
[INFO][2024-03-22 00:02:20,586][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:02:20,587][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.4313
wandb: 
wandb: üöÄ View run woven-sweep-45 at: https://wandb.ai/xzy11632/dance-dev/runs/it4db4me
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_000146-it4db4me/logs
wandb: Agent Starting Run: d77vuvzt with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_000230-d77vuvzt
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run smart-sweep-46
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/d77vuvzt
[INFO][2024-03-22 00:02:41,147][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:02:41,147][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:02:41,155][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 00:02:41,164][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:02:42,880][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:02:43,099][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:02:43,102][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:02:45,640][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:02:45,640][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:02:45,641][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:02:45,641][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:02:45,641][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:02:45,658][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:02:45,670][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:02:45,671][dance][wrapped_func] Took 0:00:04.507303 to load and process data.
[WARNING][2024-03-22 00:02:45,680][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:02:45,688][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:02:45,714][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:02:45,715][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-22 00:03:33,764][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=169)
[INFO][2024-03-22 00:03:33,785][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.47%
[INFO][2024-03-22 00:03:33,862][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:03:33,862][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.42748
wandb: 
wandb: üöÄ View run smart-sweep-46 at: https://wandb.ai/xzy11632/dance-dev/runs/d77vuvzt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_000230-d77vuvzt/logs
wandb: Agent Starting Run: z5ow6pql with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_000347-z5ow6pql
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run amber-sweep-47
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/z5ow6pql
[INFO][2024-03-22 00:03:53,505][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:03:53,505][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:03:53,506][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellPCA',
 None][0m
[INFO][2024-03-22 00:03:53,512][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:03:53,919][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:03:54,082][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:03:54,085][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:03:56,704][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:03:56,704][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:03:56,705][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:03:56,705][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:03:56,705][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:03:56,718][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:03:56,719][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:03:56,720][dance][wrapped_func] Took 0:00:03.208455 to load and process data.
[WARNING][2024-03-22 00:03:56,729][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:03:56,730][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:03:56,747][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:03:56,748][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[INFO][2024-03-22 00:04:39,428][dance.CellPCA][__call__] Generating cell PCA features (466, 7100) (k=355)
[INFO][2024-03-22 00:04:39,431][dance.CellPCA][__call__] Top 10 explained variances: [0.02818817 0.02682859 0.02100192 0.01488322 0.0127485  0.01067478
 0.00963917 0.00771214 0.0069042  0.00566548]
[INFO][2024-03-22 00:04:39,431][dance.CellPCA][__call__] Total explained variance: 90.08%
[INFO][2024-03-22 00:04:39,436][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:04:39,436][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.5303
wandb:  test_acc 0.36957
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run amber-sweep-47 at: https://wandb.ai/xzy11632/dance-dev/runs/z5ow6pql
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_000347-z5ow6pql/logs
wandb: Agent Starting Run: z9v7ad09 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_000452-z9v7ad09
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dashing-sweep-48
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/z9v7ad09
[INFO][2024-03-22 00:04:57,991][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:04:57,992][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:04:57,993][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellSVD',
 None][0m
[INFO][2024-03-22 00:04:58,017][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:04:58,992][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:04:59,536][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:04:59,542][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:05:03,588][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:05:03,588][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:05:03,588][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:05:03,589][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:05:03,589][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:05:03,603][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:05:03,604][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:05:03,604][dance][wrapped_func] Took 0:00:05.587650 to load and process data.
[WARNING][2024-03-22 00:05:03,612][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:05:03,612][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:05:03,637][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:05:03,638][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[INFO][2024-03-22 00:06:13,788][dance.CellSVD][__call__] Generating cell SVD features (466, 7100) (k=356)
[INFO][2024-03-22 00:06:13,791][dance.CellSVD][__call__] Top 10 explained variances: [0.01244695 0.02811806 0.02053966 0.02090238 0.01431629 0.01237167
 0.01065986 0.00963271 0.00710145 0.00584131]
[INFO][2024-03-22 00:06:13,791][dance.CellSVD][__call__] Total explained variance: 89.82%
[INFO][2024-03-22 00:06:13,796][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:06:13,796][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.54545
wandb:  test_acc 0.36232
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run dashing-sweep-48 at: https://wandb.ai/xzy11632/dance-dev/runs/z9v7ad09
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_000452-z9v7ad09/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: k8tr9zj5 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_000638-k8tr9zj5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dark-sweep-49
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/k8tr9zj5
[INFO][2024-03-22 00:06:46,097][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:06:46,097][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:06:46,098][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 00:06:46,106][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:06:47,690][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:06:48,004][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:06:48,008][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:06:50,868][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:06:50,868][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:06:50,868][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:06:50,868][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:06:50,869][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:06:50,881][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:06:50,881][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:06:50,881][dance][wrapped_func] Took 0:00:04.775887 to load and process data.
[WARNING][2024-03-22 00:06:50,889][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:06:50,891][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:06:50,891][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 00:06:50,891][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:06:50,910][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:06:50,911][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 00:07:17,242][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:07:17,243][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 00:07:18,016][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:07:18,017][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.77273
wandb:  test_acc 0.65217
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run dark-sweep-49 at: https://wandb.ai/xzy11632/dance-dev/runs/k8tr9zj5
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_000638-k8tr9zj5/logs
wandb: Agent Starting Run: hftrso6a with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_000736-hftrso6a
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run bright-sweep-50
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/hftrso6a
[INFO][2024-03-22 00:07:43,769][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:07:43,769][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:07:43,770][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 00:07:43,789][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:07:46,439][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:07:46,910][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:07:46,921][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:07:48,470][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:07:48,471][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:07:48,471][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:07:48,471][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:07:48,471][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:07:48,474][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:07:48,474][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:07:48,475][dance][wrapped_func] Took 0:00:04.686258 to load and process data.
[WARNING][2024-03-22 00:07:48,484][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:07:48,485][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:07:48,505][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:07:48,505][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[INFO][2024-03-22 00:08:14,616][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 7100) (k=204)
[INFO][2024-03-22 00:08:14,618][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.19%
[INFO][2024-03-22 00:08:14,676][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:08:14,685][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.65152
wandb:  test_acc 0.45652
wandb: train_acc 0.80153
wandb: 
wandb: üöÄ View run bright-sweep-50 at: https://wandb.ai/xzy11632/dance-dev/runs/hftrso6a
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_000736-hftrso6a/logs
wandb: Agent Starting Run: mpwry30n with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_000828-mpwry30n
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run pleasant-sweep-51
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/mpwry30n
[INFO][2024-03-22 00:08:35,726][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:08:35,727][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:08:35,728][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 00:08:35,734][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:08:37,082][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:08:37,271][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:08:37,275][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:08:39,095][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:08:39,096][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:08:39,096][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:08:39,096][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:08:39,097][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:08:39,098][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:08:39,099][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:08:39,099][dance][wrapped_func] Took 0:00:03.365628 to load and process data.
[WARNING][2024-03-22 00:08:39,109][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:08:39,110][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:08:39,129][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:08:39,130][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[INFO][2024-03-22 00:09:52,933][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 7100) (k=205)
[INFO][2024-03-22 00:09:52,933][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.19%
[INFO][2024-03-22 00:09:53,030][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:09:53,030][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.63636
wandb:  test_acc 0.17391
wandb: train_acc 0.77481
wandb: 
wandb: üöÄ View run pleasant-sweep-51 at: https://wandb.ai/xzy11632/dance-dev/runs/mpwry30n
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_000828-mpwry30n/logs
wandb: Agent Starting Run: 8yo65fcc with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_001006-8yo65fcc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lively-sweep-52
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/8yo65fcc
[INFO][2024-03-22 00:10:13,090][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:10:13,121][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:10:13,122][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellPCA',
 None][0m
[INFO][2024-03-22 00:10:13,129][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:10:13,846][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:10:14,078][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:10:14,082][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:10:14,591][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:10:14,592][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:10:14,592][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:10:14,592][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:10:14,592][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:10:14,596][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:10:14,596][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:10:14,597][dance][wrapped_func] Took 0:00:01.468279 to load and process data.
[WARNING][2024-03-22 00:10:14,605][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:10:14,606][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:10:14,622][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:10:14,623][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[INFO][2024-03-22 00:10:45,119][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=312)
[INFO][2024-03-22 00:10:45,120][dance.CellPCA][__call__] Top 10 explained variances: [0.04179496 0.03714315 0.03415542 0.02454581 0.01893899 0.01197701
 0.0096669  0.00789065 0.00703448 0.00653765]
[INFO][2024-03-22 00:10:45,121][dance.CellPCA][__call__] Total explained variance: 90.03%
[INFO][2024-03-22 00:10:45,122][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:10:45,122][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.62121
wandb:  test_acc 0.32609
wandb: train_acc 0.99237
wandb: 
wandb: üöÄ View run lively-sweep-52 at: https://wandb.ai/xzy11632/dance-dev/runs/8yo65fcc
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_001006-8yo65fcc/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 6evwvpum with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_001108-6evwvpum
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dutiful-sweep-53
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/6evwvpum
[INFO][2024-03-22 00:11:14,962][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:11:14,962][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:11:14,964][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellSVD',
 None][0m
[INFO][2024-03-22 00:11:14,976][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:11:15,586][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:11:15,715][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:11:15,718][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:11:17,584][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:11:17,584][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:11:17,584][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:11:17,585][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:11:17,585][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:11:17,593][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:11:17,594][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:11:17,594][dance][wrapped_func] Took 0:00:02.617895 to load and process data.
[WARNING][2024-03-22 00:11:17,600][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:11:17,601][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:11:17,617][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:11:17,618][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[INFO][2024-03-22 00:12:18,597][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=313)
[INFO][2024-03-22 00:12:18,608][dance.CellSVD][__call__] Top 10 explained variances: [0.02058381 0.03970439 0.03709516 0.02586659 0.02226623 0.01639983
 0.01176316 0.00965954 0.00752304 0.00656317]
[INFO][2024-03-22 00:12:18,608][dance.CellSVD][__call__] Total explained variance: 89.89%
[INFO][2024-03-22 00:12:18,622][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:12:18,622][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.65152
wandb:  test_acc 0.34058
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run dutiful-sweep-53 at: https://wandb.ai/xzy11632/dance-dev/runs/6evwvpum
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_001108-6evwvpum/logs
wandb: Agent Starting Run: 5ud9b4oc with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_001231-5ud9b4oc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run comic-sweep-54
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/5ud9b4oc
[INFO][2024-03-22 00:12:38,217][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:12:38,217][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:12:38,219][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 00:12:38,228][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:12:39,636][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:12:39,814][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:12:39,817][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:12:43,572][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:12:43,573][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:12:43,573][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:12:43,573][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:12:43,573][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:12:43,582][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:12:43,583][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:12:43,583][dance][wrapped_func] Took 0:00:05.354982 to load and process data.
[WARNING][2024-03-22 00:12:43,592][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:12:43,594][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:12:43,595][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 00:12:43,595][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:12:43,622][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:12:43,623][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 00:13:01,979][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:13:01,979][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 00:13:02,051][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:13:02,051][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.75758
wandb:  test_acc 0.63043
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run comic-sweep-54 at: https://wandb.ai/xzy11632/dance-dev/runs/5ud9b4oc
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_001231-5ud9b4oc/logs
wandb: Agent Starting Run: 05lz04k6 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: - Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_001315-05lz04k6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run helpful-sweep-55
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/05lz04k6
[INFO][2024-03-22 00:13:25,189][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:13:25,189][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:13:25,191][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 00:13:25,197][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:13:28,226][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:13:28,383][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:13:28,386][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:13:30,922][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:13:30,922][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:13:30,922][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:13:30,923][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:13:30,923][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:13:30,937][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:13:30,937][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:13:30,937][dance][wrapped_func] Took 0:00:05.740704 to load and process data.
[WARNING][2024-03-22 00:13:30,946][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:13:30,947][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:13:30,966][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:13:30,967][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[INFO][2024-03-22 00:13:53,272][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=189)
[INFO][2024-03-22 00:13:53,273][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.15%
[INFO][2024-03-22 00:13:53,294][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:13:53,294][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.71212
wandb:  test_acc 0.57971
wandb: train_acc 0.85115
wandb: 
wandb: üöÄ View run helpful-sweep-55 at: https://wandb.ai/xzy11632/dance-dev/runs/05lz04k6
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_001315-05lz04k6/logs
wandb: Agent Starting Run: pa6d950h with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_001406-pa6d950h
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resilient-sweep-56
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/pa6d950h
[INFO][2024-03-22 00:14:11,988][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:14:11,988][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:14:11,990][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 00:14:11,996][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:14:13,456][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:14:14,155][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:14:14,159][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:14:15,736][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:14:15,737][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:14:15,737][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:14:15,737][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:14:15,738][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:14:15,751][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:14:15,752][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:14:15,752][dance][wrapped_func] Took 0:00:03.755687 to load and process data.
[WARNING][2024-03-22 00:14:15,761][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:14:15,762][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:14:15,779][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:14:15,780][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[INFO][2024-03-22 00:15:41,344][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=190)
[INFO][2024-03-22 00:15:41,345][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.20%
[INFO][2024-03-22 00:15:41,386][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:15:41,387][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.63636
wandb:  test_acc 0.22464
wandb: train_acc 0.78626
wandb: 
wandb: üöÄ View run resilient-sweep-56 at: https://wandb.ai/xzy11632/dance-dev/runs/pa6d950h
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_001406-pa6d950h/logs
wandb: Agent Starting Run: 6j0pay5f with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_001601-6j0pay5f
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run hardy-sweep-57
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/6j0pay5f
[INFO][2024-03-22 00:16:20,506][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:16:20,507][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:16:20,509][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'CellPCA',
 None][0m
[INFO][2024-03-22 00:16:20,539][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:16:25,639][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:16:26,472][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:16:26,487][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:16:35,484][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:16:35,485][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:16:35,485][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:16:35,485][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:16:35,485][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:16:35,497][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:16:35,498][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:16:35,498][dance][wrapped_func] Took 0:00:14.959706 to load and process data.
[WARNING][2024-03-22 00:16:35,507][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:16:35,508][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:16:35,527][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:16:35,528][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-22 00:17:14,536][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=303)
[INFO][2024-03-22 00:17:14,546][dance.CellPCA][__call__] Top 10 explained variances: [0.04505318 0.04050852 0.0352695  0.02558029 0.02013048 0.01898708
 0.01008148 0.00973301 0.00762922 0.00711978]
[INFO][2024-03-22 00:17:14,546][dance.CellPCA][__call__] Total explained variance: 90.09%
[INFO][2024-03-22 00:17:14,547][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:17:14,547][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.021 MB of 0.026 MB uploadedwandb: - 0.021 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.65152
wandb:  test_acc 0.28261
wandb: train_acc 0.99237
wandb: 
wandb: üöÄ View run hardy-sweep-57 at: https://wandb.ai/xzy11632/dance-dev/runs/6j0pay5f
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_001601-6j0pay5f/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: q6l7lxvc with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_001742-q6l7lxvc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run desert-sweep-58
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/q6l7lxvc
[INFO][2024-03-22 00:17:50,885][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:17:50,885][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:17:50,887][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'CellSVD',
 None][0m
[INFO][2024-03-22 00:17:50,945][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:17:52,897][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:17:53,529][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:17:53,537][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:18:03,427][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:18:03,428][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:18:03,428][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:18:03,428][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:18:03,428][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:18:03,502][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:18:03,503][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:18:03,503][dance][wrapped_func] Took 0:00:12.559305 to load and process data.
[WARNING][2024-03-22 00:18:03,560][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:18:03,561][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:18:03,632][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:18:03,642][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-22 00:19:17,808][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=303)
[INFO][2024-03-22 00:19:17,824][dance.CellSVD][__call__] Top 10 explained variances: [0.02707326 0.04097577 0.04042094 0.02561136 0.0213724  0.02005839
 0.01513628 0.01000452 0.00965946 0.00740115]
[INFO][2024-03-22 00:19:17,825][dance.CellSVD][__call__] Total explained variance: 89.87%
[INFO][2024-03-22 00:19:17,828][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:19:17,832][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.65152
wandb:  test_acc 0.25362
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run desert-sweep-58 at: https://wandb.ai/xzy11632/dance-dev/runs/q6l7lxvc
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_001742-q6l7lxvc/logs
wandb: Agent Starting Run: w9md1v7u with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_001932-w9md1v7u
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run devoted-sweep-59
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/w9md1v7u
[INFO][2024-03-22 00:19:40,678][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:19:40,678][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:19:40,679][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 00:19:40,694][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:19:44,901][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:19:45,186][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:19:45,190][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:19:50,719][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:19:50,721][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:19:50,722][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:19:50,722][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:19:50,723][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:19:50,733][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:19:50,733][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:19:50,733][dance][wrapped_func] Took 0:00:10.040149 to load and process data.
[WARNING][2024-03-22 00:19:50,744][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:19:50,745][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:19:50,745][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 00:19:50,745][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:19:50,765][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:19:50,765][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 00:20:30,859][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:20:30,861][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 00:20:30,956][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:20:30,965][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.016 MB of 0.026 MB uploadedwandb: \ 0.016 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.75758
wandb:  test_acc 0.57971
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run devoted-sweep-59 at: https://wandb.ai/xzy11632/dance-dev/runs/w9md1v7u
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_001932-w9md1v7u/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: w2ubi8w4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_002055-w2ubi8w4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run blooming-sweep-60
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/w2ubi8w4
[INFO][2024-03-22 00:21:02,853][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:21:02,853][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:21:02,854][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 00:21:02,882][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:21:04,569][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:21:04,927][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:21:04,931][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:21:09,000][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:21:09,001][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:21:09,001][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:21:09,001][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:21:09,001][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:21:09,010][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:21:09,010][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:21:09,011][dance][wrapped_func] Took 0:00:06.128966 to load and process data.
[WARNING][2024-03-22 00:21:09,019][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:21:09,021][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:21:09,045][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:21:09,046][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-22 00:21:41,573][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=184)
[INFO][2024-03-22 00:21:41,575][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.17%
[INFO][2024-03-22 00:21:41,650][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:21:41,653][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.71212
wandb:  test_acc 0.36232
wandb: train_acc 0.83206
wandb: 
wandb: üöÄ View run blooming-sweep-60 at: https://wandb.ai/xzy11632/dance-dev/runs/w2ubi8w4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_002055-w2ubi8w4/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: x113xlpr with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_002209-x113xlpr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resilient-sweep-61
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/x113xlpr
[INFO][2024-03-22 00:22:16,838][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:22:16,839][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:22:16,840][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 00:22:16,853][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:22:18,540][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:22:18,944][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:22:18,956][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:22:24,656][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:22:24,656][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:22:24,657][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:22:24,657][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:22:24,657][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:22:24,670][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:22:24,671][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:22:24,671][dance][wrapped_func] Took 0:00:07.818759 to load and process data.
[WARNING][2024-03-22 00:22:24,682][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:22:24,683][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:22:24,709][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:22:24,711][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-22 00:23:58,162][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=185)
[INFO][2024-03-22 00:23:58,163][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.22%
[INFO][2024-03-22 00:23:58,184][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:23:58,184][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.65152
wandb:  test_acc 0.23913
wandb: train_acc 0.79771
wandb: 
wandb: üöÄ View run resilient-sweep-61 at: https://wandb.ai/xzy11632/dance-dev/runs/x113xlpr
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_002209-x113xlpr/logs
wandb: Agent Starting Run: nsj8yb5e with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_002413-nsj8yb5e
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run golden-sweep-62
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/nsj8yb5e
[INFO][2024-03-22 00:24:21,218][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:24:21,218][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:24:21,220][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'FilterGenesNumberPlaceHolder',
 'CellPCA',
 None][0m
[INFO][2024-03-22 00:24:21,227][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:24:23,269][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:24:23,878][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:24:23,885][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:24:27,917][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:24:27,918][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:24:27,918][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:24:27,918][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:24:27,919][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:24:27,933][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:24:27,934][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:24:27,934][dance][wrapped_func] Took 0:00:06.707558 to load and process data.
[WARNING][2024-03-22 00:24:27,942][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:24:27,943][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:24:27,944][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:24:27,961][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:24:27,962][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 00:24:29,065][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:24:50,510][dance.CellPCA][__call__] Generating cell PCA features (466, 22088) (k=324)
[INFO][2024-03-22 00:24:50,511][dance.CellPCA][__call__] Top 10 explained variances: [0.12958685 0.01239259 0.00985504 0.00651825 0.00609908 0.00596351
 0.00579562 0.00568436 0.00540956 0.00529544]
[INFO][2024-03-22 00:24:50,512][dance.CellPCA][__call__] Total explained variance: 90.04%
[INFO][2024-03-22 00:24:50,517][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:24:50,518][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.018 MB of 0.026 MB uploadedwandb: - 0.018 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.51908
wandb: 
wandb: üöÄ View run golden-sweep-62 at: https://wandb.ai/xzy11632/dance-dev/runs/nsj8yb5e
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_002413-nsj8yb5e/logs
wandb: Agent Starting Run: k20w0j8o with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_002505-k20w0j8o
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run firm-sweep-63
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/k20w0j8o
[INFO][2024-03-22 00:25:12,694][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:25:12,694][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:25:12,696][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'FilterGenesNumberPlaceHolder',
 'CellSVD',
 None][0m
[INFO][2024-03-22 00:25:12,702][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:25:14,728][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:25:14,901][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:25:14,904][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:25:21,517][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:25:21,518][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:25:21,519][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:25:21,519][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:25:21,519][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:25:21,547][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:25:21,549][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:25:21,549][dance][wrapped_func] Took 0:00:08.848218 to load and process data.
[WARNING][2024-03-22 00:25:21,577][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:25:21,580][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:25:21,582][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:25:21,638][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:25:21,647][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 00:25:24,366][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:27:49,916][dance.CellSVD][__call__] Generating cell SVD features (466, 22088) (k=325)
[INFO][2024-03-22 00:27:49,917][dance.CellSVD][__call__] Top 10 explained variances: [0.12953383 0.00948768 0.00703633 0.00953922 0.00611397 0.00597787
 0.00596349 0.00579546 0.00567895 0.00532768]
[INFO][2024-03-22 00:27:49,918][dance.CellSVD][__call__] Total explained variance: 89.87%
[INFO][2024-03-22 00:27:49,919][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:27:49,919][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.018 MB uploadedwandb: / 0.018 MB of 0.026 MB uploadedwandb: - 0.018 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.50382
wandb: 
wandb: üöÄ View run firm-sweep-63 at: https://wandb.ai/xzy11632/dance-dev/runs/k20w0j8o
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_002505-k20w0j8o/logs
wandb: Agent Starting Run: 4t6f2p00 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_002804-4t6f2p00
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run cool-sweep-64
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/4t6f2p00
[INFO][2024-03-22 00:28:11,836][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:28:11,837][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:28:11,838][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'FilterGenesNumberPlaceHolder',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 00:28:11,843][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:28:14,425][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:28:14,744][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:28:14,747][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:28:21,319][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:28:21,321][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:28:21,322][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:28:21,322][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:28:21,322][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:28:21,350][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:28:21,356][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:28:21,357][dance][wrapped_func] Took 0:00:09.514641 to load and process data.
[WARNING][2024-03-22 00:28:21,381][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:28:21,385][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:28:21,388][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:28:21,389][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 00:28:21,390][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:28:21,451][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:28:21,455][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 00:28:23,336][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:28:23,338][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:28:23,342][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 00:28:33,964][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:28:33,983][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.62121
wandb:  test_acc 0.14493
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run cool-sweep-64 at: https://wandb.ai/xzy11632/dance-dev/runs/4t6f2p00
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_002804-4t6f2p00/logs
wandb: Agent Starting Run: jgnw4m0a with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_002853-jgnw4m0a
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run major-sweep-65
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/jgnw4m0a
[INFO][2024-03-22 00:29:04,034][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:29:04,035][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:29:04,036][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 00:29:04,041][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:29:06,702][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:29:07,163][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:29:07,168][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:29:12,270][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:29:12,270][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:29:12,270][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:29:12,271][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:29:12,271][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:29:12,284][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:29:12,285][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:29:12,286][dance][wrapped_func] Took 0:00:08.244507 to load and process data.
[WARNING][2024-03-22 00:29:12,296][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:29:12,297][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:29:12,298][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:29:12,321][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:29:12,323][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 00:29:13,236][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:29:17,706][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 22088) (k=183)
[INFO][2024-03-22 00:29:17,707][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.05%
[INFO][2024-03-22 00:29:18,993][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:29:18,993][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.021 MB uploadedwandb: | 0.018 MB of 0.026 MB uploadedwandb: / 0.018 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run major-sweep-65 at: https://wandb.ai/xzy11632/dance-dev/runs/jgnw4m0a
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_002853-jgnw4m0a/logs
wandb: Agent Starting Run: qg77sb9h with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_002934-qg77sb9h
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fiery-sweep-66
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/qg77sb9h
[INFO][2024-03-22 00:29:41,467][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:29:41,467][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:29:41,469][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 00:29:41,480][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:29:43,420][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:29:43,647][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:29:43,651][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:29:48,580][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:29:48,581][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:29:48,581][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:29:48,581][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:29:48,582][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:29:48,597][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:29:48,599][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:29:48,599][dance][wrapped_func] Took 0:00:07.119231 to load and process data.
[WARNING][2024-03-22 00:29:48,610][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:29:48,611][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:29:48,612][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:29:48,632][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:29:48,633][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 00:29:49,820][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:30:57,918][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 22088) (k=183)
[INFO][2024-03-22 00:30:57,919][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.89%
[INFO][2024-03-22 00:31:00,404][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:31:00,426][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.017 MB of 0.026 MB uploadedwandb: - 0.017 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run fiery-sweep-66 at: https://wandb.ai/xzy11632/dance-dev/runs/qg77sb9h
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_002934-qg77sb9h/logs
wandb: Agent Starting Run: an0ilp01 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_003118-an0ilp01
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run olive-sweep-67
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/an0ilp01
[INFO][2024-03-22 00:31:25,537][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:31:25,538][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:31:25,541][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'FilterGenesRegression',
 'CellPCA',
 None][0m
[INFO][2024-03-22 00:31:25,545][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:31:27,234][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:31:27,485][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:31:27,489][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:31:30,412][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:31:30,413][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:31:30,413][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:31:30,414][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:31:30,414][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:31:30,423][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:31:30,423][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:31:30,424][dance][wrapped_func] Took 0:00:04.879050 to load and process data.
[WARNING][2024-03-22 00:31:30,432][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:31:30,433][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:31:30,454][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:31:30,456][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 00:31:31,536][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-22 00:31:51,147][dance.CellPCA][__call__] Generating cell PCA features (466, 22088) (k=324)
[INFO][2024-03-22 00:31:51,148][dance.CellPCA][__call__] Top 10 explained variances: [0.12958685 0.01239259 0.00985504 0.00651825 0.00609908 0.00596351
 0.00579562 0.00568436 0.00540956 0.00529544]
[INFO][2024-03-22 00:31:51,148][dance.CellPCA][__call__] Total explained variance: 90.04%
[INFO][2024-03-22 00:31:51,160][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:31:51,161][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.51908
wandb: 
wandb: üöÄ View run olive-sweep-67 at: https://wandb.ai/xzy11632/dance-dev/runs/an0ilp01
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_003118-an0ilp01/logs
wandb: Agent Starting Run: vaw1j9yz with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_003209-vaw1j9yz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run quiet-sweep-68
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/vaw1j9yz
[INFO][2024-03-22 00:32:16,333][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:32:16,333][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:32:16,336][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'FilterGenesRegression',
 'CellSVD',
 None][0m
[INFO][2024-03-22 00:32:16,354][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:32:18,198][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:32:18,434][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:32:18,438][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:32:22,672][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:32:22,673][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:32:22,673][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:32:22,673][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:32:22,673][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:32:22,680][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:32:22,681][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:32:22,681][dance][wrapped_func] Took 0:00:06.340782 to load and process data.
[WARNING][2024-03-22 00:32:22,690][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:32:22,691][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:32:22,709][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:32:22,711][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 00:32:24,187][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-22 00:34:53,330][dance.CellSVD][__call__] Generating cell SVD features (466, 22088) (k=325)
[INFO][2024-03-22 00:34:53,331][dance.CellSVD][__call__] Top 10 explained variances: [0.12953383 0.00948768 0.00703633 0.00953922 0.00611397 0.00597787
 0.00596349 0.00579546 0.00567895 0.00532768]
[INFO][2024-03-22 00:34:53,332][dance.CellSVD][__call__] Total explained variance: 89.87%
[INFO][2024-03-22 00:34:53,333][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:34:53,333][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.026 MB uploadedwandb: \ 0.018 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.50382
wandb: 
wandb: üöÄ View run quiet-sweep-68 at: https://wandb.ai/xzy11632/dance-dev/runs/vaw1j9yz
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_003209-vaw1j9yz/logs
wandb: Agent Starting Run: jw3r74nr with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_003510-jw3r74nr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dark-sweep-69
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/jw3r74nr
[INFO][2024-03-22 00:35:16,680][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:35:16,680][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:35:16,683][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'FilterGenesRegression',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 00:35:16,688][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:35:18,086][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:35:18,241][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:35:18,244][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:35:19,322][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:35:19,323][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:35:19,323][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:35:19,323][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:35:19,323][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:35:19,328][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:35:19,329][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:35:19,329][dance][wrapped_func] Took 0:00:02.641613 to load and process data.
[WARNING][2024-03-22 00:35:19,335][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:35:19,336][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:35:19,336][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 00:35:19,336][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:35:19,353][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:35:19,353][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 00:35:20,126][dance][_filter_enclasc] Start generating cell features using EnClaSC
[WARNING][2024-03-22 00:35:20,159][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:35:20,160][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 00:35:30,700][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:35:30,701][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.62121
wandb:  test_acc 0.14493
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run dark-sweep-69 at: https://wandb.ai/xzy11632/dance-dev/runs/jw3r74nr
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_003510-jw3r74nr/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: y1vcuacy with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_003554-y1vcuacy
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run celestial-sweep-70
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/y1vcuacy
[INFO][2024-03-22 00:36:02,353][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:36:02,353][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:36:02,354][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 00:36:02,368][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:36:04,365][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:36:04,688][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:36:04,692][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:36:07,963][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:36:07,964][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:36:07,964][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:36:07,964][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:36:07,964][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:36:07,973][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:36:07,974][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:36:07,974][dance][wrapped_func] Took 0:00:05.606293 to load and process data.
[WARNING][2024-03-22 00:36:07,983][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:36:07,984][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:36:08,018][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:36:08,019][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 00:36:09,300][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-22 00:36:14,510][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 22088) (k=183)
[INFO][2024-03-22 00:36:14,545][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.05%
[INFO][2024-03-22 00:36:15,582][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:36:15,583][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run celestial-sweep-70 at: https://wandb.ai/xzy11632/dance-dev/runs/y1vcuacy
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_003554-y1vcuacy/logs
wandb: Agent Starting Run: jo10865w with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_003633-jo10865w
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run exalted-sweep-71
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/jo10865w
[INFO][2024-03-22 00:36:40,722][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:36:40,723][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:36:40,726][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 00:36:40,733][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:36:42,365][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:36:42,628][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:36:42,632][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:36:45,895][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:36:45,895][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:36:45,895][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:36:45,895][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:36:45,895][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:36:45,905][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:36:45,905][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:36:45,906][dance][wrapped_func] Took 0:00:05.173379 to load and process data.
[WARNING][2024-03-22 00:36:45,916][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:36:45,917][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:36:45,941][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:36:45,942][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 00:36:47,435][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-22 00:37:40,903][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 22088) (k=183)
[INFO][2024-03-22 00:37:40,904][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.89%
[INFO][2024-03-22 00:37:41,979][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:37:41,979][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.018 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run exalted-sweep-71 at: https://wandb.ai/xzy11632/dance-dev/runs/jo10865w
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_003633-jo10865w/logs
wandb: Agent Starting Run: 8xxil6bu with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_003805-8xxil6bu
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lyric-sweep-72
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/8xxil6bu
[INFO][2024-03-22 00:38:11,753][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:38:11,753][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:38:11,755][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder', 'ScaleFeature', 'FilterGenesTopK', 'CellPCA', None][0m
[INFO][2024-03-22 00:38:11,761][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:38:13,151][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:38:13,321][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:38:13,325][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:38:18,085][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:38:18,085][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:38:18,085][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:38:18,086][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:38:18,086][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:38:18,094][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:38:18,095][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:38:18,095][dance][wrapped_func] Took 0:00:06.334261 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 00:38:18,104][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:38:18,105][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:38:18,126][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:38:18,127][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-22 00:38:26,565][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=273)
[INFO][2024-03-22 00:38:26,566][dance.CellPCA][__call__] Top 10 explained variances: [0.18763506 0.01687237 0.01127613 0.00824903 0.00726683 0.00700421
 0.00639412 0.00617347 0.00613042 0.00600407]
[INFO][2024-03-22 00:38:26,566][dance.CellPCA][__call__] Total explained variance: 90.09%
[INFO][2024-03-22 00:38:26,567][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:38:26,568][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.39695
wandb: 
wandb: üöÄ View run lyric-sweep-72 at: https://wandb.ai/xzy11632/dance-dev/runs/8xxil6bu
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_003805-8xxil6bu/logs
wandb: Agent Starting Run: klrvp0eq with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_003839-klrvp0eq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run playful-sweep-73
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/klrvp0eq
[INFO][2024-03-22 00:38:51,931][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:38:51,931][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:38:51,933][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder', 'ScaleFeature', 'FilterGenesTopK', 'CellSVD', None][0m
[INFO][2024-03-22 00:38:51,948][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:38:54,241][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:38:54,519][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:38:54,522][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:38:57,480][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:38:57,481][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:38:57,481][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:38:57,481][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:38:57,481][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:38:57,489][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:38:57,490][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:38:57,490][dance][wrapped_func] Took 0:00:05.542607 to load and process data.
[WARNING][2024-03-22 00:38:57,496][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:38:57,497][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:38:57,514][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:38:57,515][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-22 00:39:56,130][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=273)
[INFO][2024-03-22 00:39:56,133][dance.CellSVD][__call__] Top 10 explained variances: [0.1876312  0.01686738 0.01127027 0.00824199 0.00725938 0.00699835
 0.00638682 0.00616329 0.00612435 0.00599736]
[INFO][2024-03-22 00:39:56,134][dance.CellSVD][__call__] Total explained variance: 89.89%
[INFO][2024-03-22 00:39:56,136][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:39:56,138][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run playful-sweep-73 at: https://wandb.ai/xzy11632/dance-dev/runs/klrvp0eq
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_003839-klrvp0eq/logs
wandb: Agent Starting Run: jkjuq9eo with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_004009-jkjuq9eo
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glad-sweep-74
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/jkjuq9eo
[INFO][2024-03-22 00:40:15,629][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:40:15,630][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:40:15,632][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'FilterGenesTopK',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 00:40:15,637][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:40:16,487][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:40:16,701][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:40:16,705][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:40:17,988][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:40:17,989][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:40:17,989][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:40:17,989][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:40:17,989][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:40:17,991][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:40:17,992][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:40:17,992][dance][wrapped_func] Took 0:00:02.355584 to load and process data.
[WARNING][2024-03-22 00:40:18,000][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:40:18,001][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:40:18,002][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 00:40:18,002][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:40:18,019][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:40:18,020][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[WARNING][2024-03-22 00:40:18,175][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:40:18,175][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 00:40:18,189][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:40:18,189][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.56107
wandb: 
wandb: üöÄ View run glad-sweep-74 at: https://wandb.ai/xzy11632/dance-dev/runs/jkjuq9eo
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_004009-jkjuq9eo/logs
wandb: Agent Starting Run: oanhove5 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_004031-oanhove5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run pious-sweep-75
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/oanhove5
[INFO][2024-03-22 00:40:36,523][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:40:36,523][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:40:36,526][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 00:40:36,534][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:40:38,086][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:40:38,232][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:40:38,236][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:40:40,866][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:40:40,867][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:40:40,867][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:40:40,867][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:40:40,868][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:40:40,875][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:40:40,876][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:40:40,876][dance][wrapped_func] Took 0:00:04.342930 to load and process data.
[WARNING][2024-03-22 00:40:40,885][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:40:40,886][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:40:40,901][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:40:40,902][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-22 00:40:43,472][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=159)
[INFO][2024-03-22 00:40:43,472][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.06%
[INFO][2024-03-22 00:40:43,574][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:40:43,580][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run pious-sweep-75 at: https://wandb.ai/xzy11632/dance-dev/runs/oanhove5
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_004031-oanhove5/logs
wandb: Agent Starting Run: 8yxd7bu5 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_004059-8yxd7bu5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run whole-sweep-76
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/8yxd7bu5
[INFO][2024-03-22 00:41:04,825][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:41:04,825][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:41:04,826][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 00:41:04,833][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:41:05,775][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:41:05,944][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:41:05,948][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:41:08,357][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:41:08,357][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:41:08,357][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:41:08,357][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:41:08,358][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:41:08,371][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:41:08,372][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:41:08,372][dance][wrapped_func] Took 0:00:03.539463 to load and process data.
[WARNING][2024-03-22 00:41:08,382][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:41:08,384][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:41:08,418][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:41:08,419][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-22 00:41:23,234][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=157)
[INFO][2024-03-22 00:41:23,234][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.55%
[INFO][2024-03-22 00:41:23,316][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:41:23,316][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run whole-sweep-76 at: https://wandb.ai/xzy11632/dance-dev/runs/8yxd7bu5
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_004059-8yxd7bu5/logs
wandb: Agent Starting Run: h0zf5eff with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_004136-h0zf5eff
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lilac-sweep-77
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/h0zf5eff
[INFO][2024-03-22 00:41:42,091][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:41:42,097][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:41:42,099][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellPCA',
 None][0m
[INFO][2024-03-22 00:41:42,103][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:41:42,942][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:41:43,113][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:41:43,116][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:41:46,529][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:41:46,529][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:41:46,529][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:41:46,530][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:41:46,530][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:41:46,544][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:41:46,544][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:41:46,545][dance][wrapped_func] Took 0:00:04.441863 to load and process data.
[WARNING][2024-03-22 00:41:46,552][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:41:46,552][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:41:46,569][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:41:46,569][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run lilac-sweep-77 at: https://wandb.ai/xzy11632/dance-dev/runs/h0zf5eff
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_004136-h0zf5eff/logs
wandb: ERROR Run h0zf5eff errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/cell_feature.py", line 142, in __call__
wandb: ERROR     cell_feat = pca.fit_transform(feat)
wandb: ERROR                 ^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
wandb: ERROR     data_to_wrap = f(self, X, *args, **kwargs)
wandb: ERROR                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 1152, in wrapper
wandb: ERROR     return fit_method(estimator, *args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 460, in fit_transform
wandb: ERROR     U, S, Vt = self._fit(X)
wandb: ERROR                ^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 483, in _fit
wandb: ERROR     X = self._validate_data(
wandb: ERROR         ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 605, in _validate_data
wandb: ERROR     out = check_array(X, input_name="X", **check_params)
wandb: ERROR           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/validation.py", line 976, in check_array
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: Found array with 0 feature(s) (shape=(466, 0)) while a minimum of 1 is required by PCA.
wandb: ERROR 
wandb: Agent Starting Run: efr1ijyr with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_004203-efr1ijyr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run eager-sweep-78
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/efr1ijyr
[INFO][2024-03-22 00:42:09,921][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:42:09,921][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:42:09,923][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellSVD',
 None][0m
[INFO][2024-03-22 00:42:09,940][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:42:11,074][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:42:11,264][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:42:11,269][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:42:14,255][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:42:14,255][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:42:14,255][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:42:14,255][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:42:14,256][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:42:14,271][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:42:14,272][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:42:14,272][dance][wrapped_func] Took 0:00:04.332729 to load and process data.
[WARNING][2024-03-22 00:42:14,280][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:42:14,282][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:42:14,315][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:42:14,316][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run eager-sweep-78 at: https://wandb.ai/xzy11632/dance-dev/runs/efr1ijyr
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_004203-efr1ijyr/logs
wandb: ERROR Run efr1ijyr errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/cell_feature.py", line 179, in __call__
wandb: ERROR     svd.fit_transform(feat)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
wandb: ERROR     data_to_wrap = f(self, X, *args, **kwargs)
wandb: ERROR                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 1145, in wrapper
wandb: ERROR     estimator._validate_params()
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 638, in _validate_params
wandb: ERROR     validate_parameter_constraints(
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_param_validation.py", line 96, in validate_parameter_constraints
wandb: ERROR     raise InvalidParameterError(
wandb: ERROR sklearn.utils._param_validation.InvalidParameterError: The 'n_components' parameter of TruncatedSVD must be an int in the range [1, inf). Got -1 instead.
wandb: ERROR 
wandb: Agent Starting Run: ul5lp5g4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_004231-ul5lp5g4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run peachy-sweep-79
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ul5lp5g4
[INFO][2024-03-22 00:42:37,888][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:42:37,888][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:42:37,890][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 00:42:37,894][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:42:39,684][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:42:39,899][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:42:39,902][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:42:42,704][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:42:42,704][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:42:42,704][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:42:42,704][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:42:42,705][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:42:42,712][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:42:42,735][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:42:42,736][dance][wrapped_func] Took 0:00:04.841805 to load and process data.
[WARNING][2024-03-22 00:42:42,744][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:42:42,745][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:42:42,745][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 00:42:42,745][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:42:42,767][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:42:42,769][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 00:42:44,215][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:42:44,217][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 00:42:44,217][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:42:44,218][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/torch/nn/init.py:405: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/torch/nn/modules/linear.py:114: UserWarning: An output with one or more elements was resized since it had shape [128, 2000], which does not match the required output shape [2000]. This behavior is deprecated, and in a future PyTorch release outputs will not be resized unless they have zero elements. You can explicitly reuse an out tensor t by resizing it, inplace, to zero elements with t.resize_(0). (Triggered internally at ../aten/src/ATen/native/Resize.cpp:26.)
  return F.linear(input, self.weight, self.bias)
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.017 MB of 0.026 MB uploadedwandb: / 0.017 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run peachy-sweep-79 at: https://wandb.ai/xzy11632/dance-dev/runs/ul5lp5g4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_004231-ul5lp5g4/logs
wandb: ERROR Run ul5lp5g4 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 83, in evaluate_pipeline
wandb: ERROR     model.fit(x_train, y_train, seed=args.seed, lr=args.learning_rate, num_epochs=args.num_epochs,
wandb: ERROR   File "/home/zyxing/dance/dance/modules/single_modality/cell_type_annotation/actinn.py", line 162, in fit
wandb: ERROR     batch_cost = self.compute_loss(self.model(batch_x), batch_y)
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/modules/single_modality/cell_type_annotation/actinn.py", line 87, in compute_loss
wandb: ERROR     loss = nn.NLLLoss()(log_prob, y)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
wandb: ERROR     return forward_call(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 216, in forward
wandb: ERROR     return F.nll_loss(input, target, weight=self.weight, ignore_index=self.ignore_index, reduction=self.reduction)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/torch/nn/functional.py", line 2704, in nll_loss
wandb: ERROR     return torch._C._nn.nll_loss_nd(input, target, weight, _Reduction.get_enum(reduction), ignore_index)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR RuntimeError: size mismatch (got input: [8], target: [128])
wandb: ERROR 
wandb: Agent Starting Run: kh0sqzea with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_004259-kh0sqzea
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run silvery-sweep-80
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/kh0sqzea
[INFO][2024-03-22 00:43:13,555][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:43:13,556][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:43:13,557][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 00:43:13,565][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:43:17,517][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:43:18,179][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:43:18,183][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:43:23,668][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:43:23,668][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:43:23,669][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:43:23,669][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:43:23,669][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:43:23,690][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:43:23,690][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:43:23,691][dance][wrapped_func] Took 0:00:10.125403 to load and process data.
[WARNING][2024-03-22 00:43:23,701][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:43:23,703][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:43:23,724][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:43:23,725][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.017 MB of 0.025 MB uploadedwandb: - 0.017 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run silvery-sweep-80 at: https://wandb.ai/xzy11632/dance-dev/runs/kh0sqzea
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_004259-kh0sqzea/logs
wandb: ERROR Run kh0sqzea errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/cell_feature.py", line 50, in __call__
wandb: ERROR     gene_feat = gene_pca.fit_transform(feat.T)  # decompose into gene features
wandb: ERROR                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
wandb: ERROR     data_to_wrap = f(self, X, *args, **kwargs)
wandb: ERROR                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 1152, in wrapper
wandb: ERROR     return fit_method(estimator, *args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 460, in fit_transform
wandb: ERROR     U, S, Vt = self._fit(X)
wandb: ERROR                ^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 483, in _fit
wandb: ERROR     X = self._validate_data(
wandb: ERROR         ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 605, in _validate_data
wandb: ERROR     out = check_array(X, input_name="X", **check_params)
wandb: ERROR           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/validation.py", line 967, in check_array
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: Found array with 0 sample(s) (shape=(0, 262)) while a minimum of 1 is required by PCA.
wandb: ERROR 
wandb: Agent Starting Run: pep1zw3z with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_004343-pep1zw3z
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fearless-sweep-81
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/pep1zw3z
[INFO][2024-03-22 00:43:49,759][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:43:49,759][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:43:49,760][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 00:43:49,766][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:43:50,219][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:43:50,380][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:43:50,383][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:43:50,793][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:43:50,793][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:43:50,793][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:43:50,793][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:43:50,793][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:43:50,794][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:43:50,795][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:43:50,795][dance][wrapped_func] Took 0:00:01.030324 to load and process data.
[WARNING][2024-03-22 00:43:50,801][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:43:50,801][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:43:50,817][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:43:50,818][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run fearless-sweep-81 at: https://wandb.ai/xzy11632/dance-dev/runs/pep1zw3z
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_004343-pep1zw3z/logs
wandb: ERROR Run pep1zw3z errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/cell_feature.py", line 97, in __call__
wandb: ERROR     svd.fit_transform(feat)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
wandb: ERROR     data_to_wrap = f(self, X, *args, **kwargs)
wandb: ERROR                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 1145, in wrapper
wandb: ERROR     estimator._validate_params()
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 638, in _validate_params
wandb: ERROR     validate_parameter_constraints(
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_param_validation.py", line 96, in validate_parameter_constraints
wandb: ERROR     raise InvalidParameterError(
wandb: ERROR sklearn.utils._param_validation.InvalidParameterError: The 'n_components' parameter of TruncatedSVD must be an int in the range [1, inf). Got -1 instead.
wandb: ERROR 
wandb: Agent Starting Run: udatwzd2 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_004406-udatwzd2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run blooming-sweep-82
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/udatwzd2
[INFO][2024-03-22 00:44:26,346][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:44:26,346][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:44:26,347][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellPCA',
 None][0m
[INFO][2024-03-22 00:44:26,352][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:44:28,590][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:44:29,680][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:44:29,737][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:44:31,055][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:44:31,056][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:44:31,057][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:44:31,057][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:44:31,058][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:44:31,060][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:44:31,061][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:44:31,061][dance][wrapped_func] Took 0:00:04.709068 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 00:44:31,072][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:44:31,073][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:44:31,092][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:44:31,093][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[INFO][2024-03-22 00:44:43,503][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=285)
[INFO][2024-03-22 00:44:43,504][dance.CellPCA][__call__] Top 10 explained variances: [0.03139258 0.01045073 0.01032011 0.00917854 0.0077524  0.00746582
 0.00717331 0.00693294 0.00683321 0.00676207]
[INFO][2024-03-22 00:44:43,504][dance.CellPCA][__call__] Total explained variance: 90.03%
[INFO][2024-03-22 00:44:43,513][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:44:43,513][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.017 MB of 0.025 MB uploadedwandb: | 0.017 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run blooming-sweep-82 at: https://wandb.ai/xzy11632/dance-dev/runs/udatwzd2
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_004406-udatwzd2/logs
wandb: Agent Starting Run: tantog04 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_004452-tantog04
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run vague-sweep-83
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/tantog04
[INFO][2024-03-22 00:44:57,685][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:44:57,685][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:44:57,686][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellSVD',
 None][0m
[INFO][2024-03-22 00:44:57,691][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:44:58,120][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:44:58,272][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:44:58,276][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:44:58,481][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:44:58,482][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:44:58,482][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:44:58,482][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:44:58,482][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:44:58,484][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:44:58,484][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:44:58,484][dance][wrapped_func] Took 0:00:00.793534 to load and process data.
[WARNING][2024-03-22 00:44:58,492][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:44:58,493][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:44:58,513][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:44:58,514][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[INFO][2024-03-22 00:46:57,758][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=286)
[INFO][2024-03-22 00:46:57,759][dance.CellSVD][__call__] Top 10 explained variances: [0.03101945 0.00693138 0.01036143 0.00945273 0.00801185 0.00773874
 0.00726704 0.00717067 0.00690783 0.00677396]
[INFO][2024-03-22 00:46:57,759][dance.CellSVD][__call__] Total explained variance: 89.94%
[INFO][2024-03-22 00:46:57,761][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:46:57,761][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run vague-sweep-83 at: https://wandb.ai/xzy11632/dance-dev/runs/tantog04
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_004452-tantog04/logs
wandb: Agent Starting Run: sdr92wn7 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_004712-sdr92wn7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fast-sweep-84
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/sdr92wn7
[INFO][2024-03-22 00:47:18,475][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:47:18,488][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:47:18,490][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 00:47:18,502][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:47:19,565][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:47:19,717][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:47:19,720][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:47:21,769][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:47:21,769][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:47:21,769][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:47:21,770][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:47:21,770][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:47:21,779][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:47:21,780][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:47:21,780][dance][wrapped_func] Took 0:00:03.278054 to load and process data.
[WARNING][2024-03-22 00:47:21,786][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:47:21,787][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:47:21,787][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 00:47:21,788][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:47:21,805][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:47:21,806][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 00:47:24,574][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:47:24,575][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 00:47:24,664][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:47:24,681][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.39313
wandb: 
wandb: üöÄ View run fast-sweep-84 at: https://wandb.ai/xzy11632/dance-dev/runs/sdr92wn7
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_004712-sdr92wn7/logs
wandb: Agent Starting Run: vxiebrhi with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_004738-vxiebrhi
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dandy-sweep-85
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/vxiebrhi
[INFO][2024-03-22 00:47:45,520][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:47:45,520][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:47:45,522][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 00:47:45,529][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:47:48,835][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:47:49,063][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:47:49,066][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:47:52,373][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:47:52,374][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:47:52,374][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:47:52,376][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:47:52,376][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:47:52,387][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:47:52,388][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:47:52,388][dance][wrapped_func] Took 0:00:06.858932 to load and process data.
[WARNING][2024-03-22 00:47:52,397][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:47:52,398][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:47:52,415][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:47:52,416][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[INFO][2024-03-22 00:47:57,070][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=165)
[INFO][2024-03-22 00:47:57,071][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.05%
[INFO][2024-03-22 00:47:57,084][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:47:57,085][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run dandy-sweep-85 at: https://wandb.ai/xzy11632/dance-dev/runs/vxiebrhi
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_004738-vxiebrhi/logs
wandb: Agent Starting Run: 9k3o90up with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_004811-9k3o90up
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run brisk-sweep-86
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/9k3o90up
[INFO][2024-03-22 00:48:19,229][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:48:19,232][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:48:19,234][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 00:48:19,242][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:48:20,537][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:48:20,981][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:48:20,985][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:48:23,699][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:48:23,700][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:48:23,701][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:48:23,701][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:48:23,701][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:48:23,706][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:48:23,711][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:48:23,713][dance][wrapped_func] Took 0:00:04.471244 to load and process data.
[WARNING][2024-03-22 00:48:23,729][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:48:23,732][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:48:23,769][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:48:23,771][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[INFO][2024-03-22 00:48:43,635][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=165)
[INFO][2024-03-22 00:48:43,635][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.93%
[INFO][2024-03-22 00:48:43,654][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:48:43,654][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run brisk-sweep-86 at: https://wandb.ai/xzy11632/dance-dev/runs/9k3o90up
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_004811-9k3o90up/logs
wandb: Agent Starting Run: 5ion3wzl with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_004857-5ion3wzl
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dandy-sweep-87
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/5ion3wzl
[INFO][2024-03-22 00:49:03,506][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:49:03,506][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:49:03,507][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'CellPCA',
 None][0m
[INFO][2024-03-22 00:49:03,512][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:49:04,514][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:49:04,867][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:49:04,872][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:49:08,505][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:49:08,505][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:49:08,505][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:49:08,505][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:49:08,505][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:49:08,516][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:49:08,516][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:49:08,517][dance][wrapped_func] Took 0:00:05.004882 to load and process data.
[WARNING][2024-03-22 00:49:08,522][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:49:08,523][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:49:08,540][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:49:08,541][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-22 00:49:25,190][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=297)
[INFO][2024-03-22 00:49:25,192][dance.CellPCA][__call__] Top 10 explained variances: [0.0345167  0.01102691 0.00993729 0.00891768 0.00884216 0.00859279
 0.00799642 0.00778452 0.00742274 0.00717619]
[INFO][2024-03-22 00:49:25,192][dance.CellPCA][__call__] Total explained variance: 90.03%
[INFO][2024-03-22 00:49:25,193][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:49:25,194][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.026 MB uploadedwandb: \ 0.018 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run dandy-sweep-87 at: https://wandb.ai/xzy11632/dance-dev/runs/5ion3wzl
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_004857-5ion3wzl/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: ms8i35hb with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_004950-ms8i35hb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run graceful-sweep-88
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ms8i35hb
[INFO][2024-03-22 00:49:58,747][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:49:58,747][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:49:58,749][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'CellSVD',
 None][0m
[INFO][2024-03-22 00:49:58,756][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:50:00,128][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:50:00,378][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:50:00,386][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:50:00,934][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:50:00,935][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:50:00,935][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:50:00,936][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:50:00,936][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:50:00,939][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:50:00,939][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:50:00,940][dance][wrapped_func] Took 0:00:02.184220 to load and process data.
[WARNING][2024-03-22 00:50:00,950][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:50:00,951][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:50:00,972][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:50:00,973][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-22 00:51:31,784][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=298)
[INFO][2024-03-22 00:51:31,805][dance.CellSVD][__call__] Top 10 explained variances: [0.03423054 0.00638252 0.01088636 0.00982812 0.00888679 0.00860182
 0.00823249 0.00796118 0.00747683 0.00726142]
[INFO][2024-03-22 00:51:31,805][dance.CellSVD][__call__] Total explained variance: 89.92%
[INFO][2024-03-22 00:51:31,807][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:51:31,807][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.026 MB uploadedwandb: \ 0.018 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run graceful-sweep-88 at: https://wandb.ai/xzy11632/dance-dev/runs/ms8i35hb
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_004950-ms8i35hb/logs
wandb: Agent Starting Run: twdxxog9 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_005150-twdxxog9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run swept-sweep-89
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/twdxxog9
[INFO][2024-03-22 00:51:58,660][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:51:58,661][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:51:58,662][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 00:51:58,667][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:51:59,720][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:52:00,118][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:52:00,125][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:52:00,971][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:52:00,972][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:52:00,972][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:52:00,972][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:52:00,972][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:52:00,983][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:52:00,984][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:52:00,985][dance][wrapped_func] Took 0:00:02.317547 to load and process data.
[WARNING][2024-03-22 00:52:00,994][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:52:00,995][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:52:00,995][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 00:52:00,995][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:52:01,013][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:52:01,014][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 00:52:05,688][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:52:05,689][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 00:52:05,738][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:52:05,738][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.40076
wandb: 
wandb: üöÄ View run swept-sweep-89 at: https://wandb.ai/xzy11632/dance-dev/runs/twdxxog9
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_005150-twdxxog9/logs
wandb: Agent Starting Run: 4i3z3j8o with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_005219-4i3z3j8o
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run stilted-sweep-90
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/4i3z3j8o
[INFO][2024-03-22 00:52:27,069][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:52:27,069][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:52:27,070][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 00:52:27,076][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:52:28,003][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:52:28,181][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:52:28,184][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:52:28,385][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:52:28,385][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:52:28,385][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:52:28,385][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:52:28,385][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:52:28,387][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:52:28,388][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:52:28,388][dance][wrapped_func] Took 0:00:01.312496 to load and process data.
[WARNING][2024-03-22 00:52:28,397][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:52:28,397][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:52:28,433][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:52:28,434][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-22 00:52:34,810][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=174)
[INFO][2024-03-22 00:52:34,811][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.15%
[INFO][2024-03-22 00:52:34,866][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:52:34,867][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run stilted-sweep-90 at: https://wandb.ai/xzy11632/dance-dev/runs/4i3z3j8o
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_005219-4i3z3j8o/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: m7pzv2g6 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_005259-m7pzv2g6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run devoted-sweep-91
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/m7pzv2g6
[INFO][2024-03-22 00:53:06,461][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:53:06,462][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:53:06,463][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 00:53:06,469][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:53:07,486][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:53:07,728][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:53:07,732][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:53:07,976][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:53:07,976][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:53:07,977][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:53:07,977][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:53:07,977][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:53:07,980][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:53:07,980][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:53:07,981][dance][wrapped_func] Took 0:00:01.512308 to load and process data.
[WARNING][2024-03-22 00:53:07,991][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:53:07,999][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:53:08,021][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 00:53:08,022][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-22 00:53:59,250][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=174)
[INFO][2024-03-22 00:53:59,251][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.03%
[INFO][2024-03-22 00:53:59,299][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:53:59,300][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run devoted-sweep-91 at: https://wandb.ai/xzy11632/dance-dev/runs/m7pzv2g6
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_005259-m7pzv2g6/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: gxe6brck with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_005423-gxe6brck
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run exalted-sweep-92
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/gxe6brck
[INFO][2024-03-22 00:54:30,854][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:54:30,854][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:54:30,857][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'FilterGenesNumberPlaceHolder',
 'CellPCA',
 None][0m
[INFO][2024-03-22 00:54:30,867][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:54:32,429][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:54:32,735][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:54:32,739][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:54:36,335][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:54:36,336][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:54:36,337][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:54:36,337][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:54:36,337][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:54:36,350][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:54:36,351][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:54:36,352][dance][wrapped_func] Took 0:00:05.485410 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 00:54:36,364][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:54:36,370][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 00:54:37,147][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 00:54:37,169][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 00:54:37,576][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 00:54:38,208][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:54:50,442][dance.CellPCA][__call__] Generating cell PCA features (466, 21314) (k=361)
[INFO][2024-03-22 00:54:50,469][dance.CellPCA][__call__] Top 10 explained variances: [0.11173801 0.03466618 0.019481   0.01819568 0.01006901 0.00866675
 0.00688794 0.00607348 0.00575122 0.00526939]
[INFO][2024-03-22 00:54:50,469][dance.CellPCA][__call__] Total explained variance: 90.03%
[INFO][2024-03-22 00:54:50,487][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:54:50,487][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.51515
wandb:  test_acc 0.26087
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run exalted-sweep-92 at: https://wandb.ai/xzy11632/dance-dev/runs/gxe6brck
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_005423-gxe6brck/logs
wandb: Agent Starting Run: 8fl5lfkd with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_005503-8fl5lfkd
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run noble-sweep-93
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/8fl5lfkd
[INFO][2024-03-22 00:55:11,189][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:55:11,189][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:55:11,191][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'FilterGenesNumberPlaceHolder',
 'CellSVD',
 None][0m
[INFO][2024-03-22 00:55:11,210][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:55:11,975][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:55:12,246][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:55:12,250][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:55:13,847][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:55:13,848][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:55:13,848][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:55:13,848][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:55:13,849][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:55:13,850][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:55:13,851][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:55:13,851][dance][wrapped_func] Took 0:00:02.641403 to load and process data.
[WARNING][2024-03-22 00:55:13,863][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:55:13,870][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 00:55:14,154][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 00:55:14,176][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 00:55:14,400][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 00:55:14,751][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:57:02,838][dance.CellSVD][__call__] Generating cell SVD features (466, 21314) (k=362)
[INFO][2024-03-22 00:57:02,840][dance.CellSVD][__call__] Top 10 explained variances: [0.09945752 0.03510975 0.02505326 0.019312   0.01030318 0.0094451
 0.00689794 0.00646892 0.00593033 0.00553649]
[INFO][2024-03-22 00:57:02,841][dance.CellSVD][__call__] Total explained variance: 89.68%
[INFO][2024-03-22 00:57:02,844][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:57:02,844][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.020 MB of 0.026 MB uploadedwandb: \ 0.020 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.37879
wandb:  test_acc 0.23188
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run noble-sweep-93 at: https://wandb.ai/xzy11632/dance-dev/runs/8fl5lfkd
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_005503-8fl5lfkd/logs
wandb: Agent Starting Run: 1ltzx4f0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_005720-1ltzx4f0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run driven-sweep-94
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/1ltzx4f0
[INFO][2024-03-22 00:57:27,526][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:57:27,527][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:57:27,528][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'FilterGenesNumberPlaceHolder',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 00:57:27,543][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:57:29,125][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:57:29,372][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:57:29,377][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:57:33,098][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:57:33,098][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:57:33,098][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:57:33,099][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:57:33,099][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:57:33,110][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:57:33,111][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:57:33,111][dance][wrapped_func] Took 0:00:05.568234 to load and process data.
[WARNING][2024-03-22 00:57:33,123][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:57:33,123][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:57:33,124][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 00:57:33,130][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 00:57:33,746][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 00:57:33,766][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 00:57:34,076][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 00:57:35,022][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:57:35,023][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:57:35,032][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 00:57:41,929][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:57:41,929][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.78986
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run driven-sweep-94 at: https://wandb.ai/xzy11632/dance-dev/runs/1ltzx4f0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_005720-1ltzx4f0/logs
wandb: Agent Starting Run: hrm3iupd with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_005759-hrm3iupd
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run unique-sweep-95
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/hrm3iupd
[INFO][2024-03-22 00:58:06,903][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:58:06,904][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:58:06,908][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 00:58:06,915][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:58:08,021][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:58:08,175][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:58:08,178][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:58:10,875][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:58:10,875][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:58:10,875][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:58:10,875][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:58:10,876][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:58:10,891][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:58:10,891][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:58:10,892][dance][wrapped_func] Took 0:00:03.976744 to load and process data.
[WARNING][2024-03-22 00:58:10,901][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:58:10,907][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 00:58:10,978][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 00:58:10,995][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 00:58:11,084][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 00:58:11,181][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:58:13,284][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 21314) (k=190)
[INFO][2024-03-22 00:58:13,285][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.09%
[INFO][2024-03-22 00:58:13,409][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:58:13,409][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.60606
wandb:  test_acc 0.19565
wandb: train_acc 0.77863
wandb: 
wandb: üöÄ View run unique-sweep-95 at: https://wandb.ai/xzy11632/dance-dev/runs/hrm3iupd
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_005759-hrm3iupd/logs
wandb: Agent Starting Run: o91kvohs with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_005830-o91kvohs
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run cool-sweep-96
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/o91kvohs
[INFO][2024-03-22 00:58:37,377][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 00:58:37,378][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 00:58:37,379][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 00:58:37,386][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 00:58:39,079][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 00:58:39,284][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 00:58:39,287][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 00:58:42,721][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 00:58:42,722][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 00:58:42,729][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 00:58:42,729][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 00:58:42,729][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 00:58:42,739][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 00:58:42,739][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 00:58:42,740][dance][wrapped_func] Took 0:00:05.354188 to load and process data.
[WARNING][2024-03-22 00:58:42,749][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 00:58:42,755][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 00:58:43,932][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 00:58:43,951][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 00:58:44,581][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 00:58:45,085][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 00:59:51,915][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 21314) (k=207)
[INFO][2024-03-22 00:59:51,916][dance.WeightedFeatureSVD][__call__] Total explained variance: 92.71%
[INFO][2024-03-22 00:59:52,123][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 00:59:52,124][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.60606
wandb:  test_acc 0.18116
wandb: train_acc 0.75191
wandb: 
wandb: üöÄ View run cool-sweep-96 at: https://wandb.ai/xzy11632/dance-dev/runs/o91kvohs
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_005830-o91kvohs/logs
wandb: Agent Starting Run: 8aamixoh with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_010010-8aamixoh
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run colorful-sweep-97
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/8aamixoh
[INFO][2024-03-22 01:00:20,027][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:00:20,027][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:00:20,029][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder', 'Log1P', 'FilterGenesRegression', 'CellPCA', None][0m
[INFO][2024-03-22 01:00:20,038][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:00:20,738][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:00:20,976][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:00:20,980][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:00:21,770][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:00:21,788][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:00:21,788][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:00:21,788][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:00:21,789][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:00:21,792][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:00:21,794][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:00:21,795][dance][wrapped_func] Took 0:00:01.757124 to load and process data.
[WARNING][2024-03-22 01:00:21,811][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:00:21,886][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:00:21,904][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:00:22,054][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 01:00:23,285][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-22 01:00:46,026][dance.CellPCA][__call__] Generating cell PCA features (466, 21314) (k=361)
[INFO][2024-03-22 01:00:46,029][dance.CellPCA][__call__] Top 10 explained variances: [0.11173801 0.03466618 0.019481   0.01819568 0.01006901 0.00866675
 0.00688794 0.00607348 0.00575122 0.00526939]
[INFO][2024-03-22 01:00:46,029][dance.CellPCA][__call__] Total explained variance: 90.03%
[INFO][2024-03-22 01:00:46,030][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:00:46,030][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.51515
wandb:  test_acc 0.26087
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run colorful-sweep-97 at: https://wandb.ai/xzy11632/dance-dev/runs/8aamixoh
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_010010-8aamixoh/logs
wandb: Agent Starting Run: 45j3defd with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_010059-45j3defd
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run warm-sweep-98
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/45j3defd
[INFO][2024-03-22 01:01:06,388][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:01:06,388][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:01:06,390][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder', 'Log1P', 'FilterGenesRegression', 'CellSVD', None][0m
[INFO][2024-03-22 01:01:06,406][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:01:07,543][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:01:07,884][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:01:07,888][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:01:11,383][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:01:11,384][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:01:11,384][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:01:11,384][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:01:11,384][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:01:11,399][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:01:11,400][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:01:11,400][dance][wrapped_func] Took 0:00:04.993982 to load and process data.
[WARNING][2024-03-22 01:01:11,418][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:01:12,144][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:01:12,189][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:01:12,794][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 01:01:13,506][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-22 01:03:48,247][dance.CellSVD][__call__] Generating cell SVD features (466, 21314) (k=362)
[INFO][2024-03-22 01:03:48,258][dance.CellSVD][__call__] Top 10 explained variances: [0.09945752 0.03510975 0.02505326 0.019312   0.01030318 0.0094451
 0.00689794 0.00646892 0.00593033 0.00553649]
[INFO][2024-03-22 01:03:48,258][dance.CellSVD][__call__] Total explained variance: 89.68%
[INFO][2024-03-22 01:03:48,260][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:03:48,260][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.37879
wandb:  test_acc 0.23188
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run warm-sweep-98 at: https://wandb.ai/xzy11632/dance-dev/runs/45j3defd
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_010059-45j3defd/logs
wandb: Agent Starting Run: oiy45xsq with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_010406-oiy45xsq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run pleasant-sweep-99
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/oiy45xsq
[INFO][2024-03-22 01:04:13,338][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:04:13,339][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:04:13,340][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'FilterGenesRegression',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 01:04:13,355][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:04:14,843][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:04:15,180][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:04:15,183][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:04:18,110][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:04:18,111][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:04:18,111][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:04:18,111][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:04:18,111][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:04:18,121][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:04:18,121][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:04:18,121][dance][wrapped_func] Took 0:00:04.767043 to load and process data.
[WARNING][2024-03-22 01:04:18,133][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:04:18,133][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 01:04:18,141][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:04:18,726][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:04:18,761][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:04:19,533][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 01:04:20,503][dance][_filter_enclasc] Start generating cell features using EnClaSC
[WARNING][2024-03-22 01:04:20,535][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:04:20,536][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 01:04:30,175][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:04:30,196][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.78986
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run pleasant-sweep-99 at: https://wandb.ai/xzy11632/dance-dev/runs/oiy45xsq
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_010406-oiy45xsq/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: kano1hou with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_010457-kano1hou
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run celestial-sweep-100
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/kano1hou
[INFO][2024-03-22 01:05:06,166][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:05:06,166][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:05:06,168][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 01:05:06,181][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:05:08,670][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:05:09,218][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:05:09,222][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:05:13,812][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:05:13,813][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:05:13,813][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:05:13,813][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:05:13,814][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:05:13,827][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:05:13,828][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:05:13,828][dance][wrapped_func] Took 0:00:07.648005 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 01:05:13,843][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:05:14,950][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:05:14,995][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:05:15,930][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 01:05:16,246][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-22 01:05:18,598][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 21314) (k=190)
[INFO][2024-03-22 01:05:18,605][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.09%
[INFO][2024-03-22 01:05:18,762][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:05:18,762][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.60606
wandb:  test_acc 0.19565
wandb: train_acc 0.77863
wandb: 
wandb: üöÄ View run celestial-sweep-100 at: https://wandb.ai/xzy11632/dance-dev/runs/kano1hou
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_010457-kano1hou/logs
wandb: Agent Starting Run: tf5cl7df with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_010533-tf5cl7df
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run cool-sweep-101
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/tf5cl7df
[INFO][2024-03-22 01:05:40,586][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:05:40,586][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:05:40,588][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 01:05:40,605][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:05:41,957][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:05:42,813][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:05:42,816][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:05:44,597][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:05:44,597][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:05:44,598][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:05:44,598][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:05:44,598][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:05:44,611][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:05:44,612][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:05:44,613][dance][wrapped_func] Took 0:00:04.016405 to load and process data.
[WARNING][2024-03-22 01:05:44,630][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:05:45,465][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:05:45,484][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:05:46,464][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 01:05:47,955][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-22 01:06:57,261][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 21314) (k=207)
[INFO][2024-03-22 01:06:57,263][dance.WeightedFeatureSVD][__call__] Total explained variance: 92.71%
[INFO][2024-03-22 01:06:58,325][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:06:58,326][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.60606
wandb:  test_acc 0.18116
wandb: train_acc 0.75191
wandb: 
wandb: üöÄ View run cool-sweep-101 at: https://wandb.ai/xzy11632/dance-dev/runs/tf5cl7df
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_010533-tf5cl7df/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: m4zo426m with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_010720-m4zo426m
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run vocal-sweep-102
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/m4zo426m
[INFO][2024-03-22 01:07:28,628][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:07:28,628][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:07:28,630][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder', 'Log1P', 'FilterGenesTopK', 'CellPCA', None][0m
[INFO][2024-03-22 01:07:28,649][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:07:29,514][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:07:30,246][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:07:30,249][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:07:32,948][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:07:32,948][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:07:32,948][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:07:32,948][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:07:32,949][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:07:32,967][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:07:32,967][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:07:32,967][dance][wrapped_func] Took 0:00:04.318871 to load and process data.
[WARNING][2024-03-22 01:07:32,984][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:07:34,775][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:07:34,797][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:07:35,700][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[INFO][2024-03-22 01:07:47,789][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=213)
[INFO][2024-03-22 01:07:47,790][dance.CellPCA][__call__] Top 10 explained variances: [0.07902199 0.01458714 0.01205022 0.01095151 0.01079713 0.0103516
 0.01023789 0.01015549 0.00944025 0.00873434]
[INFO][2024-03-22 01:07:47,790][dance.CellPCA][__call__] Total explained variance: 90.10%
[INFO][2024-03-22 01:07:47,791][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:07:47,791][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.017 MB of 0.025 MB uploadedwandb: | 0.017 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.58397
wandb: 
wandb: üöÄ View run vocal-sweep-102 at: https://wandb.ai/xzy11632/dance-dev/runs/m4zo426m
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_010720-m4zo426m/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: fdy7bnel with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_010811-fdy7bnel
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lilac-sweep-103
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/fdy7bnel
[INFO][2024-03-22 01:08:18,620][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:08:18,621][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:08:18,622][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder', 'Log1P', 'FilterGenesTopK', 'CellSVD', None][0m
[INFO][2024-03-22 01:08:18,636][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:08:19,464][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:08:19,644][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:08:19,648][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:08:23,601][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:08:23,602][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:08:23,602][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:08:23,602][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:08:23,603][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:08:23,620][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:08:23,621][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:08:23,622][dance][wrapped_func] Took 0:00:04.986312 to load and process data.
[WARNING][2024-03-22 01:08:23,643][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:08:24,439][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:08:24,484][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:08:25,255][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[INFO][2024-03-22 01:09:50,100][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=213)
[INFO][2024-03-22 01:09:50,101][dance.CellSVD][__call__] Top 10 explained variances: [0.07899692 0.01457518 0.01202486 0.01094823 0.01078471 0.01033875
 0.01023467 0.0101459  0.00941532 0.00871388]
[INFO][2024-03-22 01:09:50,101][dance.CellSVD][__call__] Total explained variance: 89.96%
[INFO][2024-03-22 01:09:50,103][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:09:50,103][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.55725
wandb: 
wandb: üöÄ View run lilac-sweep-103 at: https://wandb.ai/xzy11632/dance-dev/runs/fdy7bnel
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_010811-fdy7bnel/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 4p68de15 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_011012-4p68de15
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run avid-sweep-104
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/4p68de15
[INFO][2024-03-22 01:10:19,228][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:10:19,248][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:10:19,250][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'FilterGenesTopK',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 01:10:19,257][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:10:20,153][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:10:20,340][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:10:20,344][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:10:23,203][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:10:23,204][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:10:23,204][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:10:23,204][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:10:23,205][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:10:23,216][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:10:23,216][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:10:23,217][dance][wrapped_func] Took 0:00:03.960378 to load and process data.
[WARNING][2024-03-22 01:10:23,227][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:10:23,228][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 01:10:23,234][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:10:24,221][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:10:24,241][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:10:25,316][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:10:26,510][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:10:26,510][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 01:10:26,573][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:10:26,578][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.71374
wandb: 
wandb: üöÄ View run avid-sweep-104 at: https://wandb.ai/xzy11632/dance-dev/runs/4p68de15
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_011012-4p68de15/logs
wandb: Agent Starting Run: hd8wpjcq with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_011040-hd8wpjcq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run grateful-sweep-105
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/hd8wpjcq
[INFO][2024-03-22 01:10:46,919][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:10:46,920][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:10:46,922][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 01:10:46,944][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:10:47,752][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:10:47,947][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:10:47,950][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:10:51,215][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:10:51,215][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:10:51,216][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:10:51,216][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:10:51,216][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:10:51,230][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:10:51,231][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:10:51,231][dance][wrapped_func] Took 0:00:04.287316 to load and process data.
[WARNING][2024-03-22 01:10:51,251][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:10:52,020][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:10:52,038][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:10:52,650][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[INFO][2024-03-22 01:10:53,970][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=133)
[INFO][2024-03-22 01:10:53,971][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.22%
[INFO][2024-03-22 01:10:54,054][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:10:54,059][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.018 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.31818
wandb:  test_acc 0.06522
wandb: train_acc 0.41985
wandb: 
wandb: üöÄ View run grateful-sweep-105 at: https://wandb.ai/xzy11632/dance-dev/runs/hd8wpjcq
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_011040-hd8wpjcq/logs
wandb: Agent Starting Run: gmalphk4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_011108-gmalphk4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run leafy-sweep-106
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/gmalphk4
[INFO][2024-03-22 01:11:14,324][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:11:14,324][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:11:14,326][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 01:11:14,333][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:11:15,129][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:11:15,292][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:11:15,295][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:11:16,389][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:11:16,389][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:11:16,389][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:11:16,389][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:11:16,389][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:11:16,398][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:11:16,398][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:11:16,399][dance][wrapped_func] Took 0:00:02.066188 to load and process data.
[WARNING][2024-03-22 01:11:16,414][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:11:16,917][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:11:16,934][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:11:17,849][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[INFO][2024-03-22 01:11:53,045][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=130)
[INFO][2024-03-22 01:11:53,046][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.50%
[INFO][2024-03-22 01:11:53,124][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:11:53,128][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.41221
wandb: 
wandb: üöÄ View run leafy-sweep-106 at: https://wandb.ai/xzy11632/dance-dev/runs/gmalphk4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_011108-gmalphk4/logs
wandb: Agent Starting Run: rdqnbm2j with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_011207-rdqnbm2j
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run summer-sweep-107
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/rdqnbm2j
[INFO][2024-03-22 01:12:15,278][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:12:15,278][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:12:15,280][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellPCA',
 None][0m
[INFO][2024-03-22 01:12:15,288][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:12:16,401][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:12:16,611][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:12:16,622][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:12:19,915][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:12:19,915][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:12:19,916][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:12:19,916][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:12:19,916][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:12:19,928][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:12:19,929][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:12:19,929][dance][wrapped_func] Took 0:00:04.641876 to load and process data.
[WARNING][2024-03-22 01:12:19,947][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:12:21,057][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:12:21,079][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:12:22,324][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[INFO][2024-03-22 01:12:33,813][dance.CellPCA][__call__] Generating cell PCA features (466, 4817) (k=319)
[INFO][2024-03-22 01:12:33,814][dance.CellPCA][__call__] Top 10 explained variances: [0.03097016 0.02126014 0.01892343 0.01509431 0.01324928 0.00987759
 0.00799955 0.00720089 0.00661814 0.00652019]
[INFO][2024-03-22 01:12:33,814][dance.CellPCA][__call__] Total explained variance: 90.05%
[INFO][2024-03-22 01:12:33,815][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:12:33,815][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.4697
wandb:  test_acc 0.37681
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run summer-sweep-107 at: https://wandb.ai/xzy11632/dance-dev/runs/rdqnbm2j
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_011207-rdqnbm2j/logs
wandb: Agent Starting Run: 0x6k1h7f with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_011246-0x6k1h7f
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run feasible-sweep-108
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/0x6k1h7f
[INFO][2024-03-22 01:12:53,829][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:12:53,829][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:12:53,831][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellSVD',
 None][0m
[INFO][2024-03-22 01:12:53,835][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:12:54,636][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:12:55,092][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:12:55,096][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:12:57,630][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:12:57,632][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:12:57,633][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:12:57,633][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:12:57,634][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:12:57,648][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:12:57,649][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:12:57,649][dance][wrapped_func] Took 0:00:03.813899 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 01:12:57,671][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:12:59,159][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:12:59,179][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:12:59,879][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[INFO][2024-03-22 01:14:23,727][dance.CellSVD][__call__] Generating cell SVD features (466, 4817) (k=320)
[INFO][2024-03-22 01:14:23,728][dance.CellSVD][__call__] Top 10 explained variances: [0.02624414 0.02201362 0.01909136 0.01532566 0.01328268 0.01026864
 0.00800871 0.00720445 0.00717986 0.00655819]
[INFO][2024-03-22 01:14:23,728][dance.CellSVD][__call__] Total explained variance: 89.91%
[INFO][2024-03-22 01:14:23,740][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:14:23,740][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.39394
wandb:  test_acc 0.31159
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run feasible-sweep-108 at: https://wandb.ai/xzy11632/dance-dev/runs/0x6k1h7f
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_011246-0x6k1h7f/logs
wandb: Agent Starting Run: icyf0x6u with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_011437-icyf0x6u
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run tough-sweep-109
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/icyf0x6u
[INFO][2024-03-22 01:14:44,181][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:14:44,182][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:14:44,183][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 01:14:44,192][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:14:46,381][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:14:46,637][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:14:46,641][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:14:49,796][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:14:49,796][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:14:49,796][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:14:49,797][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:14:49,797][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:14:49,809][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:14:49,810][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:14:49,810][dance][wrapped_func] Took 0:00:05.619142 to load and process data.
[WARNING][2024-03-22 01:14:49,820][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:14:49,820][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 01:14:49,826][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:14:50,730][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:14:50,748][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:14:52,312][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:14:54,030][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:14:54,030][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 01:14:54,538][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:14:54,538][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.75758
wandb:  test_acc 0.54348
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run tough-sweep-109 at: https://wandb.ai/xzy11632/dance-dev/runs/icyf0x6u
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_011437-icyf0x6u/logs
wandb: Agent Starting Run: tun945vv with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_011510-tun945vv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run summer-sweep-110
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/tun945vv
[INFO][2024-03-22 01:15:16,081][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:15:16,081][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:15:16,082][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 01:15:16,089][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:15:17,102][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:15:17,277][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:15:17,280][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:15:19,750][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:15:19,751][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:15:19,751][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:15:19,751][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:15:19,751][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:15:19,757][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:15:19,757][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:15:19,758][dance][wrapped_func] Took 0:00:03.669373 to load and process data.
[WARNING][2024-03-22 01:15:19,773][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:15:20,041][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:15:20,062][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:15:20,326][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[INFO][2024-03-22 01:15:26,095][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 4817) (k=190)
[INFO][2024-03-22 01:15:26,097][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.13%
[INFO][2024-03-22 01:15:26,205][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:15:26,206][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.57576
wandb:  test_acc 0.15217
wandb: train_acc 0.75573
wandb: 
wandb: üöÄ View run summer-sweep-110 at: https://wandb.ai/xzy11632/dance-dev/runs/tun945vv
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_011510-tun945vv/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: g9d7zrvb with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_011551-g9d7zrvb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sweepy-sweep-111
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/g9d7zrvb
[INFO][2024-03-22 01:15:58,236][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:15:58,236][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:15:58,238][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 01:15:58,245][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:16:00,218][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:16:00,411][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:16:00,415][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:16:04,996][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:16:04,996][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:16:04,997][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:16:04,997][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:16:04,997][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:16:05,017][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:16:05,020][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:16:05,020][dance][wrapped_func] Took 0:00:06.775630 to load and process data.
[WARNING][2024-03-22 01:16:05,041][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:16:06,112][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:16:06,136][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:16:06,611][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[INFO][2024-03-22 01:16:53,673][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 4817) (k=193)
[INFO][2024-03-22 01:16:53,674][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.58%
[INFO][2024-03-22 01:16:53,752][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:16:53,752][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.57576
wandb:  test_acc 0.14493
wandb: train_acc 0.79771
wandb: 
wandb: üöÄ View run sweepy-sweep-111 at: https://wandb.ai/xzy11632/dance-dev/runs/g9d7zrvb
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_011551-g9d7zrvb/logs
wandb: Agent Starting Run: p1w2bja4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_011709-p1w2bja4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run genial-sweep-112
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/p1w2bja4
[INFO][2024-03-22 01:17:16,730][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:17:16,731][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:17:16,733][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellPCA',
 None][0m
[INFO][2024-03-22 01:17:16,741][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:17:17,417][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:17:17,552][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:17:17,554][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:17:19,680][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:17:19,680][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:17:19,681][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:17:19,681][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:17:19,681][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:17:19,696][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:17:19,697][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:17:19,697][dance][wrapped_func] Took 0:00:02.956124 to load and process data.
[WARNING][2024-03-22 01:17:19,719][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:17:20,100][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:17:20,116][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:17:20,518][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[INFO][2024-03-22 01:17:36,563][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=255)
[INFO][2024-03-22 01:17:36,563][dance.CellPCA][__call__] Top 10 explained variances: [0.08710474 0.0545078  0.0503921  0.03621919 0.01943227 0.01751891
 0.01368564 0.01177173 0.00846684 0.00743488]
[INFO][2024-03-22 01:17:36,563][dance.CellPCA][__call__] Total explained variance: 90.06%
[INFO][2024-03-22 01:17:36,564][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:17:36,564][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.69697
wandb:  test_acc 0.62319
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run genial-sweep-112 at: https://wandb.ai/xzy11632/dance-dev/runs/p1w2bja4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_011709-p1w2bja4/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: hjykyeda with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_011800-hjykyeda
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run feasible-sweep-113
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/hjykyeda
[INFO][2024-03-22 01:18:07,353][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:18:07,353][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:18:07,355][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellSVD',
 None][0m
[INFO][2024-03-22 01:18:07,361][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:18:09,082][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:18:09,398][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:18:09,401][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:18:12,691][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:18:12,692][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:18:12,692][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:18:12,693][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:18:12,693][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:18:12,709][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:18:12,710][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:18:12,710][dance][wrapped_func] Took 0:00:05.349601 to load and process data.
[WARNING][2024-03-22 01:18:12,732][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:18:13,438][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:18:13,456][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:18:14,611][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[INFO][2024-03-22 01:19:40,869][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=255)
[INFO][2024-03-22 01:19:40,887][dance.CellSVD][__call__] Top 10 explained variances: [0.06307839 0.06555654 0.05208004 0.03856108 0.02540536 0.01766445
 0.01377655 0.01183942 0.00856863 0.00761389]
[INFO][2024-03-22 01:19:40,888][dance.CellSVD][__call__] Total explained variance: 89.90%
[INFO][2024-03-22 01:19:40,890][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:19:40,890][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.021 MB of 0.025 MB uploadedwandb: \ 0.021 MB of 0.025 MB uploadedwandb: | 0.021 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.60606
wandb:  test_acc 0.56522
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run feasible-sweep-113 at: https://wandb.ai/xzy11632/dance-dev/runs/hjykyeda
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_011800-hjykyeda/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: z9oi0rfr with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_012006-z9oi0rfr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run distinctive-sweep-114
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/z9oi0rfr
[INFO][2024-03-22 01:20:12,860][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:20:12,861][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:20:12,863][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 01:20:12,872][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:20:14,368][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:20:14,589][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:20:14,592][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:20:18,398][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:20:18,399][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:20:18,400][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:20:18,400][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:20:18,400][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:20:18,406][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:20:18,407][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:20:18,407][dance][wrapped_func] Took 0:00:05.535085 to load and process data.
[WARNING][2024-03-22 01:20:18,420][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:20:18,420][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 01:20:18,427][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:20:18,538][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:20:18,575][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:20:18,682][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:20:19,725][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:20:19,726][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 01:20:19,832][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:20:19,841][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.013 MB of 0.026 MB uploadedwandb: \ 0.013 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.78788
wandb:  test_acc 0.78986
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run distinctive-sweep-114 at: https://wandb.ai/xzy11632/dance-dev/runs/z9oi0rfr
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_012006-z9oi0rfr/logs
wandb: Agent Starting Run: q28n5yls with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_012034-q28n5yls
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fearless-sweep-115
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/q28n5yls
[INFO][2024-03-22 01:20:41,144][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:20:41,145][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:20:41,146][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 01:20:41,154][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:20:42,709][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:20:42,889][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:20:42,892][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:20:46,720][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:20:46,721][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:20:46,721][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:20:46,721][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:20:46,721][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:20:46,737][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:20:46,737][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:20:46,737][dance][wrapped_func] Took 0:00:05.583368 to load and process data.
[WARNING][2024-03-22 01:20:46,756][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:20:47,413][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:20:47,438][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:20:48,319][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[INFO][2024-03-22 01:20:52,235][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=153)
[INFO][2024-03-22 01:20:52,236][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.12%
[INFO][2024-03-22 01:20:52,349][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:20:52,353][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.74242
wandb:  test_acc 0.63768
wandb: train_acc 0.87023
wandb: 
wandb: üöÄ View run fearless-sweep-115 at: https://wandb.ai/xzy11632/dance-dev/runs/q28n5yls
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_012034-q28n5yls/logs
wandb: Agent Starting Run: 8i7dagy4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_012109-8i7dagy4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sandy-sweep-116
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/8i7dagy4
[INFO][2024-03-22 01:21:16,996][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:21:16,996][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:21:16,997][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 01:21:17,014][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:21:18,590][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:21:19,007][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:21:19,018][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:21:20,374][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:21:20,374][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:21:20,375][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:21:20,375][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:21:20,375][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:21:20,382][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:21:20,383][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:21:20,383][dance][wrapped_func] Took 0:00:03.369625 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 01:21:20,403][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:21:20,481][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:21:20,502][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:21:20,597][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[INFO][2024-03-22 01:22:08,455][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=168)
[INFO][2024-03-22 01:22:08,470][dance.WeightedFeatureSVD][__call__] Total explained variance: 92.14%
[INFO][2024-03-22 01:22:08,516][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:22:08,520][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.022 MB of 0.025 MB uploadedwandb: | 0.022 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.72727
wandb:  test_acc 0.58696
wandb: train_acc 0.86641
wandb: 
wandb: üöÄ View run sandy-sweep-116 at: https://wandb.ai/xzy11632/dance-dev/runs/8i7dagy4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_012109-8i7dagy4/logs
wandb: Agent Starting Run: p0rb8teb with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_012227-p0rb8teb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run bumbling-sweep-117
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/p0rb8teb
[INFO][2024-03-22 01:22:34,490][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:22:34,490][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:22:34,492][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'CellPCA',
 None][0m
[INFO][2024-03-22 01:22:34,501][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:22:36,165][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:22:36,964][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:22:36,969][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:22:41,936][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:22:41,937][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:22:41,937][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:22:41,938][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:22:41,938][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:22:41,956][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:22:41,957][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:22:41,957][dance][wrapped_func] Took 0:00:07.456009 to load and process data.
[WARNING][2024-03-22 01:22:41,977][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:22:42,958][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:22:42,981][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:22:44,079][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-22 01:22:55,432][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=249)
[INFO][2024-03-22 01:22:55,461][dance.CellPCA][__call__] Top 10 explained variances: [0.1106152  0.09349933 0.05685675 0.03247556 0.02576189 0.01670849
 0.01566476 0.01303279 0.01053218 0.00840633]
[INFO][2024-03-22 01:22:55,466][dance.CellPCA][__call__] Total explained variance: 90.08%
[INFO][2024-03-22 01:22:55,467][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:22:55,467][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.72727
wandb:  test_acc 0.63768
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run bumbling-sweep-117 at: https://wandb.ai/xzy11632/dance-dev/runs/p0rb8teb
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_012227-p0rb8teb/logs
wandb: Agent Starting Run: vl47igla with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_012308-vl47igla
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run playful-sweep-118
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/vl47igla
[INFO][2024-03-22 01:23:15,975][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:23:15,975][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:23:15,977][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'CellSVD',
 None][0m
[INFO][2024-03-22 01:23:15,984][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:23:17,195][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:23:17,450][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:23:17,458][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:23:20,496][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:23:20,496][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:23:20,497][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:23:20,497][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:23:20,497][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:23:20,511][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:23:20,512][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:23:20,512][dance][wrapped_func] Took 0:00:04.528922 to load and process data.
[WARNING][2024-03-22 01:23:20,533][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:23:21,577][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:23:21,623][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:23:23,058][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-22 01:25:09,008][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=249)
[INFO][2024-03-22 01:25:09,022][dance.CellSVD][__call__] Top 10 explained variances: [0.0886889  0.09410524 0.05735019 0.0450135  0.02978307 0.01670943
 0.01567531 0.01305182 0.010874   0.00841008]
[INFO][2024-03-22 01:25:09,022][dance.CellSVD][__call__] Total explained variance: 89.91%
[INFO][2024-03-22 01:25:09,024][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:25:09,024][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.77273
wandb:  test_acc 0.62319
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run playful-sweep-118 at: https://wandb.ai/xzy11632/dance-dev/runs/vl47igla
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_012308-vl47igla/logs
wandb: Agent Starting Run: zclzxpyd with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_012524-zclzxpyd
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run tough-sweep-119
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/zclzxpyd
[INFO][2024-03-22 01:25:30,834][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:25:30,834][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:25:30,836][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 01:25:30,851][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:25:32,592][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:25:32,795][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:25:32,799][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:25:37,105][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:25:37,105][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:25:37,106][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:25:37,106][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:25:37,106][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:25:37,117][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:25:37,118][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:25:37,118][dance][wrapped_func] Took 0:00:06.267517 to load and process data.
[WARNING][2024-03-22 01:25:37,129][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:25:37,129][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 01:25:37,135][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:25:38,328][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:25:38,346][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:25:38,590][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 01:25:40,643][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:25:40,645][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 01:25:40,797][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:25:40,800][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.013 MB of 0.026 MB uploadedwandb: | 0.016 MB of 0.026 MB uploadedwandb: / 0.016 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.80303
wandb:  test_acc 0.81884
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run tough-sweep-119 at: https://wandb.ai/xzy11632/dance-dev/runs/zclzxpyd
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_012524-zclzxpyd/logs
wandb: Agent Starting Run: 18uegw3t with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_012558-18uegw3t
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sage-sweep-120
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/18uegw3t
[INFO][2024-03-22 01:26:05,359][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:26:05,359][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:26:05,361][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 01:26:05,368][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:26:07,106][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:26:07,288][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:26:07,304][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:26:08,408][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:26:08,408][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:26:08,408][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:26:08,408][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:26:08,408][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:26:08,410][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:26:08,410][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:26:08,410][dance][wrapped_func] Took 0:00:03.042629 to load and process data.
[WARNING][2024-03-22 01:26:08,424][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:26:08,543][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:26:08,573][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:26:08,778][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-22 01:26:15,236][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=139)
[INFO][2024-03-22 01:26:15,237][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.07%
[INFO][2024-03-22 01:26:15,287][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:26:15,288][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.75758
wandb:  test_acc 0.7029
wandb: train_acc 0.8855
wandb: 
wandb: üöÄ View run sage-sweep-120 at: https://wandb.ai/xzy11632/dance-dev/runs/18uegw3t
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_012558-18uegw3t/logs
wandb: Agent Starting Run: ahuyxhqi with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: Log1P
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_012629-ahuyxhqi
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run firm-sweep-121
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ahuyxhqi
[INFO][2024-03-22 01:26:35,147][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:26:35,147][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:26:35,149][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 01:26:35,156][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:26:36,976][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:26:37,319][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:26:37,323][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:26:41,919][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:26:41,920][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:26:41,920][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:26:41,920][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:26:41,921][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:26:41,935][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:26:41,936][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:26:41,936][dance][wrapped_func] Took 0:00:06.780394 to load and process data.
[WARNING][2024-03-22 01:26:41,957][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:26:42,488][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:26:42,508][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:26:42,629][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-22 01:27:03,177][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=163)
[INFO][2024-03-22 01:27:03,179][dance.WeightedFeatureSVD][__call__] Total explained variance: 92.94%
[INFO][2024-03-22 01:27:03,199][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:27:03,199][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.72727
wandb:  test_acc 0.66667
wandb: train_acc 0.86641
wandb: 
wandb: üöÄ View run firm-sweep-121 at: https://wandb.ai/xzy11632/dance-dev/runs/ahuyxhqi
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_012629-ahuyxhqi/logs
wandb: Agent Starting Run: zl4ljx5v with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_012716-zl4ljx5v
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run breezy-sweep-122
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/zl4ljx5v
[INFO][2024-03-22 01:27:21,639][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:27:21,640][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:27:21,642][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesNumberPlaceHolder',
 'CellPCA',
 None][0m
[INFO][2024-03-22 01:27:21,653][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:27:22,411][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:27:23,024][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:27:23,027][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:27:24,721][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:27:24,722][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:27:24,722][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:27:24,722][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:27:24,722][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:27:24,732][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:27:24,733][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:27:24,734][dance][wrapped_func] Took 0:00:03.080812 to load and process data.
[WARNING][2024-03-22 01:27:24,743][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:27:24,744][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:27:24,750][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:27:24,822][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:27:24,841][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:27:25,007][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:27:25,819][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:27:25,821][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:27:49,790][dance.CellPCA][__call__] Generating cell PCA features (466, 21314) (k=273)
[INFO][2024-03-22 01:27:49,791][dance.CellPCA][__call__] Top 10 explained variances: [0.05831508 0.04337211 0.03213546 0.01890128 0.01690834 0.01571444
 0.01409994 0.01328084 0.01013962 0.00918135]
[INFO][2024-03-22 01:27:49,791][dance.CellPCA][__call__] Total explained variance: 90.01%
[INFO][2024-03-22 01:27:49,796][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:27:49,796][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.40909
wandb:  test_acc 0.26812
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run breezy-sweep-122 at: https://wandb.ai/xzy11632/dance-dev/runs/zl4ljx5v
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_012716-zl4ljx5v/logs
wandb: Agent Starting Run: yzn0uic8 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_012802-yzn0uic8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run bumbling-sweep-123
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/yzn0uic8
[INFO][2024-03-22 01:28:08,145][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:28:08,145][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:28:08,147][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesNumberPlaceHolder',
 'CellSVD',
 None][0m
[INFO][2024-03-22 01:28:08,163][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:28:10,383][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:28:10,592][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:28:10,596][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:28:13,771][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:28:13,771][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:28:13,772][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:28:13,772][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:28:13,772][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:28:13,785][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:28:13,786][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:28:13,786][dance][wrapped_func] Took 0:00:05.622962 to load and process data.
[WARNING][2024-03-22 01:28:13,798][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:28:13,798][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:28:13,805][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:28:14,956][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:28:14,976][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:28:15,831][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:28:17,554][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:28:17,555][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:29:15,318][dance.CellSVD][__call__] Generating cell SVD features (466, 21314) (k=274)
[INFO][2024-03-22 01:29:15,319][dance.CellSVD][__call__] Top 10 explained variances: [0.05103253 0.04338986 0.03287553 0.02013231 0.01771633 0.0162809
 0.01418619 0.01386122 0.01019254 0.00928133]
[INFO][2024-03-22 01:29:15,319][dance.CellSVD][__call__] Total explained variance: 89.92%
[INFO][2024-03-22 01:29:15,328][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:29:15,328][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.4697
wandb:  test_acc 0.46377
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run bumbling-sweep-123 at: https://wandb.ai/xzy11632/dance-dev/runs/yzn0uic8
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_012802-yzn0uic8/logs
wandb: Agent Starting Run: naw89j5h with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_012934-naw89j5h
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run cosmic-sweep-124
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/naw89j5h
[INFO][2024-03-22 01:29:39,844][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:29:39,844][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:29:39,847][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesNumberPlaceHolder',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 01:29:39,856][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:29:41,115][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:29:41,481][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:29:41,485][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:29:46,322][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:29:46,323][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:29:46,323][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:29:46,323][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:29:46,323][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:29:46,339][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:29:46,340][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:29:46,340][dance][wrapped_func] Took 0:00:06.484635 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 01:29:46,351][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:29:46,351][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:29:46,351][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:29:46,352][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 01:29:46,358][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:29:47,023][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:29:47,042][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:29:47,638][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:29:49,682][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:29:49,683][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:29:49,683][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:29:49,683][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 01:29:58,193][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:29:58,194][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.027 MB uploadedwandb: - 0.012 MB of 0.027 MB uploadedwandb: \ 0.027 MB of 0.027 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.80303
wandb:  test_acc 0.63043
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run cosmic-sweep-124 at: https://wandb.ai/xzy11632/dance-dev/runs/naw89j5h
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_012934-naw89j5h/logs
wandb: Agent Starting Run: mnnax3pv with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_013014-mnnax3pv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wise-sweep-125
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/mnnax3pv
[INFO][2024-03-22 01:30:26,341][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:30:26,341][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:30:26,342][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 01:30:26,350][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:30:28,217][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:30:28,462][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:30:28,466][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:30:30,183][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:30:30,183][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:30:30,184][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:30:30,184][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:30:30,184][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:30:30,197][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:30:30,198][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:30:30,198][dance][wrapped_func] Took 0:00:03.848815 to load and process data.
[WARNING][2024-03-22 01:30:30,209][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:30:30,210][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:30:30,218][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:30:31,058][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:30:31,078][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:30:31,579][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:30:32,190][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:30:32,191][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:30:35,870][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 21314) (k=147)
[INFO][2024-03-22 01:30:35,871][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.16%
[INFO][2024-03-22 01:30:36,328][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:30:36,328][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.017 MB of 0.026 MB uploadedwandb: \ 0.017 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.81818
wandb:  test_acc 0.73913
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run wise-sweep-125 at: https://wandb.ai/xzy11632/dance-dev/runs/mnnax3pv
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_013014-mnnax3pv/logs
wandb: Agent Starting Run: 02yic44p with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_013102-02yic44p
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run laced-sweep-126
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/02yic44p
[INFO][2024-03-22 01:31:13,372][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:31:13,372][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:31:13,374][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 01:31:13,380][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:31:14,219][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:31:14,656][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:31:14,665][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:31:16,701][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:31:16,701][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:31:16,702][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:31:16,702][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:31:16,702][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:31:16,708][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:31:16,708][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:31:16,709][dance][wrapped_func] Took 0:00:03.328716 to load and process data.
[WARNING][2024-03-22 01:31:16,721][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:31:16,721][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:31:16,729][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:31:17,019][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:31:17,054][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:31:17,163][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:31:17,280][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:31:17,281][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:32:21,726][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 21314) (k=154)
[INFO][2024-03-22 01:32:21,727][dance.WeightedFeatureSVD][__call__] Total explained variance: 91.23%
[INFO][2024-03-22 01:32:23,740][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:32:23,741][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.018 MB of 0.026 MB uploadedwandb: / 0.018 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.80303
wandb:  test_acc 0.71014
wandb: train_acc 0.99237
wandb: 
wandb: üöÄ View run laced-sweep-126 at: https://wandb.ai/xzy11632/dance-dev/runs/02yic44p
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_013102-02yic44p/logs
wandb: Agent Starting Run: j3371m2p with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_013234-j3371m2p
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run divine-sweep-127
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/j3371m2p
[INFO][2024-03-22 01:32:52,628][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:32:52,629][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:32:52,630][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'CellPCA',
 None][0m
[INFO][2024-03-22 01:32:52,648][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:32:55,906][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:32:57,852][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:32:57,855][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:33:09,824][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:33:09,842][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:33:09,842][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:33:09,843][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:33:09,844][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:33:09,913][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:33:09,914][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:33:09,914][dance][wrapped_func] Took 0:00:17.266566 to load and process data.
[WARNING][2024-03-22 01:33:09,984][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:33:10,000][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:33:12,312][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:33:12,359][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:33:13,237][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:33:14,455][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:33:14,915][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-22 01:33:30,188][dance.CellPCA][__call__] Generating cell PCA features (466, 21314) (k=273)
[INFO][2024-03-22 01:33:30,189][dance.CellPCA][__call__] Top 10 explained variances: [0.05831508 0.04337211 0.03213546 0.01890128 0.01690834 0.01571444
 0.01409994 0.01328084 0.01013962 0.00918135]
[INFO][2024-03-22 01:33:30,189][dance.CellPCA][__call__] Total explained variance: 90.01%
[INFO][2024-03-22 01:33:30,191][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:33:30,191][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.40909
wandb:  test_acc 0.26812
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run divine-sweep-127 at: https://wandb.ai/xzy11632/dance-dev/runs/j3371m2p
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_013234-j3371m2p/logs
wandb: Agent Starting Run: 9vknfl9z with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_013345-9vknfl9z
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run woven-sweep-128
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/9vknfl9z
[INFO][2024-03-22 01:34:01,738][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:34:01,739][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:34:01,740][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'CellSVD',
 None][0m
[INFO][2024-03-22 01:34:01,754][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:34:07,185][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:34:07,645][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:34:07,674][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:34:15,648][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:34:15,649][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:34:15,649][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:34:15,649][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:34:15,649][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:34:15,664][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:34:15,665][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:34:15,665][dance][wrapped_func] Took 0:00:13.911763 to load and process data.
[WARNING][2024-03-22 01:34:15,674][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:34:15,682][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:34:16,482][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:34:16,501][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:34:17,111][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:34:17,854][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:34:18,128][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-22 01:35:24,072][dance.CellSVD][__call__] Generating cell SVD features (466, 21314) (k=274)
[INFO][2024-03-22 01:35:24,073][dance.CellSVD][__call__] Top 10 explained variances: [0.05103253 0.04338986 0.03287553 0.02013231 0.01771633 0.0162809
 0.01418619 0.01386122 0.01019254 0.00928133]
[INFO][2024-03-22 01:35:24,073][dance.CellSVD][__call__] Total explained variance: 89.92%
[INFO][2024-03-22 01:35:24,081][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:35:24,081][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.4697
wandb:  test_acc 0.46377
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run woven-sweep-128 at: https://wandb.ai/xzy11632/dance-dev/runs/9vknfl9z
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_013345-9vknfl9z/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 2mgtoax0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_013550-2mgtoax0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run earnest-sweep-129
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/2mgtoax0
[INFO][2024-03-22 01:35:56,869][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:35:56,869][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:35:56,871][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 01:35:56,883][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:35:58,045][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:35:58,715][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:35:58,719][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:36:02,827][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:36:02,828][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:36:02,828][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:36:02,828][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:36:02,828][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:36:02,843][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:36:02,844][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:36:02,845][dance][wrapped_func] Took 0:00:05.962393 to load and process data.
[WARNING][2024-03-22 01:36:02,856][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:36:02,856][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:36:02,857][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 01:36:02,864][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:36:03,502][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:36:03,520][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:36:03,661][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:36:03,811][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:36:03,991][dance][_filter_enclasc] Start generating cell features using EnClaSC
[WARNING][2024-03-22 01:36:04,014][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:36:04,015][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 01:36:13,235][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:36:13,236][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.021 MB uploadedwandb: / 0.017 MB of 0.026 MB uploadedwandb: - 0.017 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.80303
wandb:  test_acc 0.63043
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run earnest-sweep-129 at: https://wandb.ai/xzy11632/dance-dev/runs/2mgtoax0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_013550-2mgtoax0/logs
wandb: Agent Starting Run: 7anxc3wt with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_013634-7anxc3wt
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run laced-sweep-130
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/7anxc3wt
[INFO][2024-03-22 01:36:39,817][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:36:39,818][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:36:39,819][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 01:36:39,827][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:36:42,071][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:36:42,509][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:36:42,513][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:36:47,042][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:36:47,043][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:36:47,043][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:36:47,043][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:36:47,044][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:36:47,055][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:36:47,056][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:36:47,056][dance][wrapped_func] Took 0:00:07.229527 to load and process data.
[WARNING][2024-03-22 01:36:47,067][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:36:47,075][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:36:48,194][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:36:48,216][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:36:48,883][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:36:49,745][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:36:50,380][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-22 01:36:54,630][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 21314) (k=147)
[INFO][2024-03-22 01:36:54,631][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.16%
[INFO][2024-03-22 01:36:54,804][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:36:54,804][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.81818
wandb:  test_acc 0.73913
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run laced-sweep-130 at: https://wandb.ai/xzy11632/dance-dev/runs/7anxc3wt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_013634-7anxc3wt/logs
wandb: Agent Starting Run: t1jzzbn5 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_013708-t1jzzbn5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run warm-sweep-131
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/t1jzzbn5
[INFO][2024-03-22 01:37:14,208][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:37:14,208][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:37:14,210][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 01:37:14,217][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:37:15,971][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:37:16,134][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:37:16,138][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:37:21,277][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:37:21,278][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:37:21,278][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:37:21,278][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:37:21,278][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:37:21,287][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:37:21,287][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:37:21,287][dance][wrapped_func] Took 0:00:07.070635 to load and process data.
[WARNING][2024-03-22 01:37:21,296][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:37:21,306][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:37:21,859][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:37:21,875][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:37:22,887][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:37:24,198][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:37:24,779][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-22 01:37:55,282][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 21314) (k=154)
[INFO][2024-03-22 01:37:55,283][dance.WeightedFeatureSVD][__call__] Total explained variance: 91.23%
[INFO][2024-03-22 01:37:56,515][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:37:56,519][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.018 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.80303
wandb:  test_acc 0.71014
wandb: train_acc 0.99237
wandb: 
wandb: üöÄ View run warm-sweep-131 at: https://wandb.ai/xzy11632/dance-dev/runs/t1jzzbn5
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_013708-t1jzzbn5/logs
wandb: Agent Starting Run: akf0sl47 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_013808-akf0sl47
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run eager-sweep-132
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/akf0sl47
[INFO][2024-03-22 01:38:14,621][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:38:14,622][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:38:14,623][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'CellPCA',
 None][0m
[INFO][2024-03-22 01:38:14,630][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:38:17,593][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:38:18,511][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:38:18,516][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:38:21,589][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:38:21,589][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:38:21,590][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:38:21,590][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:38:21,590][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:38:21,596][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:38:21,596][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:38:21,596][dance][wrapped_func] Took 0:00:06.966808 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 01:38:21,608][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:38:21,614][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:38:21,684][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:38:21,701][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:38:21,790][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:38:21,879][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:38:25,199][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=55)
[INFO][2024-03-22 01:38:25,200][dance.CellPCA][__call__] Top 10 explained variances: [0.16844612 0.1322545  0.09476218 0.06954926 0.04885819 0.03440032
 0.03236063 0.02847997 0.02214933 0.01987045]
[INFO][2024-03-22 01:38:25,200][dance.CellPCA][__call__] Total explained variance: 90.03%
[INFO][2024-03-22 01:38:25,200][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:38:25,201][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.34848
wandb:  test_acc 0.10145
wandb: train_acc 0.56107
wandb: 
wandb: üöÄ View run eager-sweep-132 at: https://wandb.ai/xzy11632/dance-dev/runs/akf0sl47
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_013808-akf0sl47/logs
wandb: Agent Starting Run: 3nkwe3kj with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_013838-3nkwe3kj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sleek-sweep-133
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/3nkwe3kj
[INFO][2024-03-22 01:38:44,523][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:38:44,523][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:38:44,525][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'CellSVD',
 None][0m
[INFO][2024-03-22 01:38:44,531][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:38:46,174][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:38:46,429][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:38:46,433][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:38:48,992][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:38:48,993][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:38:48,993][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:38:48,993][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:38:48,993][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:38:49,002][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:38:49,002][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:38:49,003][dance][wrapped_func] Took 0:00:04.471392 to load and process data.
[WARNING][2024-03-22 01:38:49,014][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:38:49,020][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:38:50,562][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:38:50,581][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:38:51,253][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:38:52,251][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:39:12,961][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=55)
[INFO][2024-03-22 01:39:12,962][dance.CellSVD][__call__] Top 10 explained variances: [0.1684352  0.13225268 0.09476031 0.06954776 0.04885579 0.03439301
 0.03236081 0.02847993 0.02214614 0.01986784]
[INFO][2024-03-22 01:39:12,962][dance.CellSVD][__call__] Total explained variance: 90.00%
[INFO][2024-03-22 01:39:12,963][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:39:12,963][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.018 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.016 MB of 0.026 MB uploadedwandb: / 0.016 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.31818
wandb:  test_acc 0.0942
wandb: train_acc 0.5916
wandb: 
wandb: üöÄ View run sleek-sweep-133 at: https://wandb.ai/xzy11632/dance-dev/runs/3nkwe3kj
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_013838-3nkwe3kj/logs
wandb: Agent Starting Run: xqd39izd with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_013929-xqd39izd
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run splendid-sweep-134
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/xqd39izd
[INFO][2024-03-22 01:39:35,090][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:39:35,091][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:39:35,092][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 01:39:35,099][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:39:36,639][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:39:37,357][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:39:37,361][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:39:43,553][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:39:43,553][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:39:43,553][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:39:43,553][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:39:43,553][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:39:43,564][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:39:43,565][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:39:43,565][dance][wrapped_func] Took 0:00:08.466026 to load and process data.
[WARNING][2024-03-22 01:39:43,579][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:39:43,579][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:39:43,580][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 01:39:43,588][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:39:44,248][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:39:44,267][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:39:44,956][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:39:45,583][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:39:45,765][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:39:45,766][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 01:39:45,778][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:39:45,778][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.013 MB of 0.026 MB uploadedwandb: - 0.013 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.34848
wandb:  test_acc 0.16667
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run splendid-sweep-134 at: https://wandb.ai/xzy11632/dance-dev/runs/xqd39izd
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_013929-xqd39izd/logs
wandb: Agent Starting Run: jfbic23m with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_014004-jfbic23m
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rare-sweep-135
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/jfbic23m
[INFO][2024-03-22 01:40:27,138][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:40:27,139][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:40:27,140][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 01:40:27,215][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:40:29,609][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:40:29,865][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:40:29,869][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:40:33,244][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:40:33,245][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:40:33,245][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:40:33,245][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:40:33,245][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:40:33,253][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:40:33,253][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:40:33,253][dance][wrapped_func] Took 0:00:06.038894 to load and process data.
[WARNING][2024-03-22 01:40:33,263][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:40:33,271][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:40:33,476][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:40:33,497][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:40:33,722][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:40:33,848][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:40:37,010][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=36)
[INFO][2024-03-22 01:40:37,010][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.08%
[INFO][2024-03-22 01:40:37,016][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:40:37,017][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.018 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.25758
wandb:  test_acc 0.0942
wandb: train_acc 0.54198
wandb: 
wandb: üöÄ View run rare-sweep-135 at: https://wandb.ai/xzy11632/dance-dev/runs/jfbic23m
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_014004-jfbic23m/logs
wandb: Agent Starting Run: v8uz5clt with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_014052-v8uz5clt
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run helpful-sweep-136
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/v8uz5clt
[INFO][2024-03-22 01:41:08,969][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:41:08,970][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:41:08,971][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 01:41:09,009][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:41:12,204][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:41:12,973][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:41:13,002][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:41:22,891][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:41:22,891][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:41:22,892][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:41:22,892][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:41:22,892][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:41:22,905][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:41:22,905][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:41:22,906][dance][wrapped_func] Took 0:00:13.896936 to load and process data.
[WARNING][2024-03-22 01:41:22,915][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:41:22,924][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:41:25,168][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:41:25,218][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:41:27,353][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:41:29,414][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:41:46,287][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=36)
[INFO][2024-03-22 01:41:46,287][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.07%
[INFO][2024-03-22 01:41:46,303][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:41:46,303][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.012 MB of 0.018 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.25758
wandb:  test_acc 0.1087
wandb: train_acc 0.5687
wandb: 
wandb: üöÄ View run helpful-sweep-136 at: https://wandb.ai/xzy11632/dance-dev/runs/v8uz5clt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_014052-v8uz5clt/logs
wandb: Agent Starting Run: zz14q5m4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_014201-zz14q5m4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fallen-sweep-137
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/zz14q5m4
[INFO][2024-03-22 01:42:24,623][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:42:24,623][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:42:24,646][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellPCA',
 None][0m
[INFO][2024-03-22 01:42:24,653][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:42:27,876][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:42:28,133][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:42:28,138][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:42:30,899][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:42:30,900][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:42:30,900][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:42:30,900][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:42:30,900][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:42:30,907][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:42:30,907][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:42:30,908][dance][wrapped_func] Took 0:00:06.254696 to load and process data.
[WARNING][2024-03-22 01:42:30,921][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:42:30,927][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:42:31,005][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:42:31,025][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:42:31,214][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:42:33,327][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run fallen-sweep-137 at: https://wandb.ai/xzy11632/dance-dev/runs/zz14q5m4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_014201-zz14q5m4/logs
wandb: ERROR Run zz14q5m4 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: fphnlbvi with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_014246-fphnlbvi
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run volcanic-sweep-138
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/fphnlbvi
[INFO][2024-03-22 01:43:01,907][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:43:01,908][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:43:01,909][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellSVD',
 None][0m
[INFO][2024-03-22 01:43:01,927][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:43:06,488][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:43:07,181][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:43:07,189][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:43:10,995][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:43:10,998][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:43:11,013][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:43:11,013][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:43:11,013][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:43:11,017][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:43:11,017][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:43:11,018][dance][wrapped_func] Took 0:00:09.090881 to load and process data.
[WARNING][2024-03-22 01:43:11,041][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:43:11,048][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:43:13,191][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:43:13,432][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:43:15,108][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:43:16,394][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run volcanic-sweep-138 at: https://wandb.ai/xzy11632/dance-dev/runs/fphnlbvi
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_014246-fphnlbvi/logs
wandb: ERROR Run fphnlbvi errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: 9b2qrrgs with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_014334-9b2qrrgs
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dandy-sweep-139
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/9b2qrrgs
[INFO][2024-03-22 01:43:39,896][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:43:39,896][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:43:39,898][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 01:43:39,904][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:43:41,483][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:43:41,654][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:43:41,658][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:43:43,074][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:43:43,074][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:43:43,074][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:43:43,074][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:43:43,075][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:43:43,078][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:43:43,078][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:43:43,079][dance][wrapped_func] Took 0:00:03.174772 to load and process data.
[WARNING][2024-03-22 01:43:43,089][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:43:43,089][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:43:43,090][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 01:43:43,096][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:43:44,731][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:43:44,749][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:43:45,764][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:43:46,486][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run dandy-sweep-139 at: https://wandb.ai/xzy11632/dance-dev/runs/9b2qrrgs
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_014334-9b2qrrgs/logs
wandb: ERROR Run 9b2qrrgs errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: a0q2sj4q with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_014402-a0q2sj4q
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run distinctive-sweep-140
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/a0q2sj4q
[INFO][2024-03-22 01:44:13,216][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:44:13,216][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:44:13,224][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 01:44:13,231][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:44:15,686][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:44:16,028][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:44:16,032][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:44:19,921][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:44:19,922][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:44:19,922][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:44:19,922][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:44:19,922][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:44:19,939][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:44:19,940][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:44:19,941][dance][wrapped_func] Took 0:00:06.709462 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 01:44:19,956][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:44:19,965][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:44:21,275][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:44:21,296][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:44:22,801][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:44:24,093][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run distinctive-sweep-140 at: https://wandb.ai/xzy11632/dance-dev/runs/a0q2sj4q
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_014402-a0q2sj4q/logs
wandb: ERROR Run a0q2sj4q errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: rnynwp1l with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_014439-rnynwp1l
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run toasty-sweep-141
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/rnynwp1l
[INFO][2024-03-22 01:44:46,819][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:44:46,819][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:44:46,821][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 01:44:46,828][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:44:49,633][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:44:49,829][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:44:49,834][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:44:56,066][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:44:56,066][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:44:56,067][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:44:56,067][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:44:56,067][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:44:56,080][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:44:56,081][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:44:56,082][dance][wrapped_func] Took 0:00:09.254301 to load and process data.
[WARNING][2024-03-22 01:44:56,097][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:44:56,106][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:44:57,058][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:44:57,078][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:44:58,570][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:44:59,650][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run toasty-sweep-141 at: https://wandb.ai/xzy11632/dance-dev/runs/rnynwp1l
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_014439-rnynwp1l/logs
wandb: ERROR Run rnynwp1l errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: ge6jnhaz with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_014516-ge6jnhaz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dutiful-sweep-142
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ge6jnhaz
[INFO][2024-03-22 01:45:26,226][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:45:26,227][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:45:26,228][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellPCA',
 None][0m
[INFO][2024-03-22 01:45:26,241][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:45:28,268][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:45:28,421][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:45:28,424][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:45:30,829][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:45:30,830][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:45:30,830][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:45:30,830][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:45:30,831][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:45:30,842][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:45:30,842][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:45:30,843][dance][wrapped_func] Took 0:00:04.603076 to load and process data.
[WARNING][2024-03-22 01:45:30,852][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:45:30,860][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:45:31,851][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:45:31,869][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:45:33,733][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:45:34,994][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.013 MB uploadedwandb: / 0.013 MB of 0.026 MB uploadedwandb: - 0.013 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run dutiful-sweep-142 at: https://wandb.ai/xzy11632/dance-dev/runs/ge6jnhaz
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_014516-ge6jnhaz/logs
wandb: ERROR Run ge6jnhaz errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: wn7cvbs4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_014557-wn7cvbs4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run helpful-sweep-143
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/wn7cvbs4
[INFO][2024-03-22 01:46:04,894][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:46:04,894][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:46:04,904][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellSVD',
 None][0m
[INFO][2024-03-22 01:46:04,911][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:46:07,049][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:46:07,227][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:46:07,231][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:46:11,057][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:46:11,057][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:46:11,058][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:46:11,058][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:46:11,058][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:46:11,073][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:46:11,073][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:46:11,074][dance][wrapped_func] Took 0:00:06.163009 to load and process data.
[WARNING][2024-03-22 01:46:11,091][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:46:11,111][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:46:11,697][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:46:11,716][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:46:12,338][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:46:13,076][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.018 MB of 0.026 MB uploadedwandb: - 0.018 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run helpful-sweep-143 at: https://wandb.ai/xzy11632/dance-dev/runs/wn7cvbs4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_014557-wn7cvbs4/logs
wandb: ERROR Run wn7cvbs4 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: 2luj3zc9 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_014630-2luj3zc9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run vivid-sweep-144
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/2luj3zc9
[INFO][2024-03-22 01:46:37,723][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:46:37,724][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:46:37,725][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 01:46:37,732][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:46:38,936][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:46:39,122][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:46:39,126][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:46:40,713][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:46:40,714][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:46:40,714][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:46:40,714][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:46:40,715][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:46:40,722][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:46:40,723][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:46:40,723][dance][wrapped_func] Took 0:00:02.991288 to load and process data.
[WARNING][2024-03-22 01:46:40,735][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:46:40,736][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:46:40,736][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 01:46:40,743][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:46:41,826][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:46:41,845][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:46:42,485][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:46:42,879][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run vivid-sweep-144 at: https://wandb.ai/xzy11632/dance-dev/runs/2luj3zc9
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_014630-2luj3zc9/logs
wandb: ERROR Run 2luj3zc9 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: t23mpjkq with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_014656-t23mpjkq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run effortless-sweep-145
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/t23mpjkq
[INFO][2024-03-22 01:47:03,657][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:47:03,657][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:47:03,659][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 01:47:03,679][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:47:04,878][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:47:05,048][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:47:05,053][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:47:09,042][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:47:09,043][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:47:09,043][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:47:09,044][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:47:09,044][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:47:09,055][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:47:09,056][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:47:09,056][dance][wrapped_func] Took 0:00:05.377427 to load and process data.
[WARNING][2024-03-22 01:47:09,066][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:47:09,072][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:47:11,508][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:47:11,527][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:47:12,386][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:47:13,734][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.013 MB uploadedwandb: \ 0.012 MB of 0.013 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run effortless-sweep-145 at: https://wandb.ai/xzy11632/dance-dev/runs/t23mpjkq
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_014656-t23mpjkq/logs
wandb: ERROR Run t23mpjkq errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: pl8fs9mq with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_014728-pl8fs9mq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run robust-sweep-146
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/pl8fs9mq
[INFO][2024-03-22 01:47:36,128][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:47:36,133][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:47:36,134][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 01:47:36,152][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:47:38,102][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:47:38,392][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:47:38,400][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:47:42,087][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:47:42,088][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:47:42,088][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:47:42,088][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:47:42,088][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:47:42,099][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:47:42,100][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:47:42,101][dance][wrapped_func] Took 0:00:05.949047 to load and process data.
[WARNING][2024-03-22 01:47:42,112][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:47:42,118][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:47:42,863][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:47:42,885][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:47:45,216][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:47:46,180][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.013 MB of 0.026 MB uploadedwandb: | 0.013 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run robust-sweep-146 at: https://wandb.ai/xzy11632/dance-dev/runs/pl8fs9mq
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_014728-pl8fs9mq/logs
wandb: ERROR Run pl8fs9mq errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: yy8y3z0t with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_014805-yy8y3z0t
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run firm-sweep-147
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/yy8y3z0t
[INFO][2024-03-22 01:48:12,357][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:48:12,358][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:48:12,360][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'CellPCA',
 None][0m
[INFO][2024-03-22 01:48:12,367][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:48:14,010][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:48:14,221][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:48:14,227][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:48:17,245][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:48:17,245][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:48:17,246][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:48:17,246][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:48:17,246][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:48:17,257][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:48:17,257][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:48:17,258][dance][wrapped_func] Took 0:00:04.891298 to load and process data.
[WARNING][2024-03-22 01:48:17,275][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:48:17,289][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:48:17,943][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:48:17,962][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:48:18,891][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:48:19,620][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:48:27,650][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=176)
[INFO][2024-03-22 01:48:27,651][dance.CellPCA][__call__] Top 10 explained variances: [0.07626154 0.06266606 0.03966478 0.03540966 0.02989831 0.02389505
 0.02146254 0.01854997 0.01537886 0.01457178]
[INFO][2024-03-22 01:48:27,651][dance.CellPCA][__call__] Total explained variance: 90.08%
[INFO][2024-03-22 01:48:27,652][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:48:27,653][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.018 MB of 0.026 MB uploadedwandb: - 0.018 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.62121
wandb:  test_acc 0.34783
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run firm-sweep-147 at: https://wandb.ai/xzy11632/dance-dev/runs/yy8y3z0t
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_014805-yy8y3z0t/logs
wandb: Agent Starting Run: qylofqan with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_014843-qylofqan
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run valiant-sweep-148
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/qylofqan
[INFO][2024-03-22 01:48:49,533][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:48:49,533][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:48:49,535][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'CellSVD',
 None][0m
[INFO][2024-03-22 01:48:49,542][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:48:52,179][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:48:52,333][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:48:52,336][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:48:58,694][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:48:58,695][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:48:58,695][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:48:58,695][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:48:58,696][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:48:58,707][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:48:58,708][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:48:58,708][dance][wrapped_func] Took 0:00:09.166615 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 01:48:58,718][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:48:58,725][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:48:59,585][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:48:59,611][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:49:00,220][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:49:00,934][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:49:57,384][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=176)
[INFO][2024-03-22 01:49:57,386][dance.CellSVD][__call__] Top 10 explained variances: [0.05785745 0.06641623 0.04380992 0.03896301 0.03187447 0.0240389
 0.02155236 0.01975834 0.01565214 0.01459087]
[INFO][2024-03-22 01:49:57,386][dance.CellSVD][__call__] Total explained variance: 89.98%
[INFO][2024-03-22 01:49:57,388][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:49:57,388][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.60606
wandb:  test_acc 0.35507
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run valiant-sweep-148 at: https://wandb.ai/xzy11632/dance-dev/runs/qylofqan
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_014843-qylofqan/logs
wandb: Agent Starting Run: ysjj1mas with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_015013-ysjj1mas
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run trim-sweep-149
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ysjj1mas
[INFO][2024-03-22 01:50:20,490][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:50:20,491][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:50:20,492][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 01:50:20,500][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:50:22,341][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:50:22,614][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:50:22,619][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:50:25,195][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:50:25,195][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:50:25,195][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:50:25,195][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:50:25,196][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:50:25,206][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:50:25,206][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:50:25,207][dance][wrapped_func] Took 0:00:04.706500 to load and process data.
[WARNING][2024-03-22 01:50:25,217][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:50:25,217][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:50:25,217][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 01:50:25,224][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:50:25,730][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:50:25,748][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:50:26,160][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:50:26,814][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:50:32,272][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:50:32,273][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 01:50:32,343][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:50:32,343][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.53623
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run trim-sweep-149 at: https://wandb.ai/xzy11632/dance-dev/runs/ysjj1mas
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_015013-ysjj1mas/logs
wandb: Agent Starting Run: q6igixdt with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_015044-q6igixdt
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run celestial-sweep-150
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/q6igixdt
[INFO][2024-03-22 01:50:50,451][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:50:50,452][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:50:50,453][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 01:50:50,463][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:50:51,629][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:50:51,798][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:50:51,802][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:50:54,435][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:50:54,436][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:50:54,436][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:50:54,436][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:50:54,437][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:50:54,450][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:50:54,450][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:50:54,451][dance][wrapped_func] Took 0:00:03.987531 to load and process data.
[WARNING][2024-03-22 01:50:54,465][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:50:54,472][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:50:55,009][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:50:55,028][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:50:55,931][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:50:56,624][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:50:57,991][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=103)
[INFO][2024-03-22 01:50:57,992][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.11%
[INFO][2024-03-22 01:50:58,059][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:50:58,060][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.018 MB of 0.026 MB uploadedwandb: - 0.018 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.77273
wandb:  test_acc 0.58696
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run celestial-sweep-150 at: https://wandb.ai/xzy11632/dance-dev/runs/q6igixdt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_015044-q6igixdt/logs
wandb: Agent Starting Run: 8cos40bt with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizePlaceHolder
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_015109-8cos40bt
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run blooming-sweep-151
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/8cos40bt
[INFO][2024-03-22 01:51:14,977][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:51:14,977][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:51:14,979][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 01:51:14,987][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:51:16,259][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:51:16,432][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:51:16,436][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:51:18,554][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:51:18,555][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:51:18,555][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:51:18,555][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:51:18,555][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:51:18,569][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:51:18,569][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:51:18,569][dance][wrapped_func] Took 0:00:03.582502 to load and process data.
[WARNING][2024-03-22 01:51:18,584][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:51:18,593][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:51:19,174][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:51:19,193][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:51:20,106][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:51:20,939][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:51:44,122][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=106)
[INFO][2024-03-22 01:51:44,124][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.56%
[INFO][2024-03-22 01:51:44,163][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:51:44,163][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.017 MB of 0.026 MB uploadedwandb: | 0.022 MB of 0.026 MB uploadedwandb: / 0.022 MB of 0.026 MB uploadedwandb: - 0.022 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.74242
wandb:  test_acc 0.7029
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run blooming-sweep-151 at: https://wandb.ai/xzy11632/dance-dev/runs/8cos40bt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_015109-8cos40bt/logs
wandb: Agent Starting Run: zip4gfo0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_015159-zip4gfo0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run crimson-sweep-152
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/zip4gfo0
[INFO][2024-03-22 01:52:04,593][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:52:04,593][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:52:04,595][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'FilterGenesNumberPlaceHolder',
 'CellPCA',
 None][0m
[INFO][2024-03-22 01:52:04,601][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:52:05,500][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:52:05,707][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:52:05,711][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:52:08,717][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:52:08,718][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:52:08,719][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:52:08,719][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:52:08,719][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:52:08,733][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:52:08,734][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:52:08,735][dance][wrapped_func] Took 0:00:04.133788 to load and process data.
[WARNING][2024-03-22 01:52:08,745][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:52:08,752][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:52:09,375][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:52:09,395][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:52:10,091][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:52:11,382][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:52:31,148][dance.CellPCA][__call__] Generating cell PCA features (466, 21314) (k=292)
[INFO][2024-03-22 01:52:31,149][dance.CellPCA][__call__] Top 10 explained variances: [0.03079597 0.02735261 0.0223159  0.02063387 0.01749895 0.01450944
 0.01193754 0.01083606 0.00946006 0.00908297]
[INFO][2024-03-22 01:52:31,149][dance.CellPCA][__call__] Total explained variance: 90.09%
[INFO][2024-03-22 01:52:31,154][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:52:31,154][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.59091
wandb:  test_acc 0.34058
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run crimson-sweep-152 at: https://wandb.ai/xzy11632/dance-dev/runs/zip4gfo0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_015159-zip4gfo0/logs
wandb: Agent Starting Run: e1tdch6a with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_015244-e1tdch6a
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run decent-sweep-153
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/e1tdch6a
[INFO][2024-03-22 01:52:50,115][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:52:50,115][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:52:50,117][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'FilterGenesNumberPlaceHolder',
 'CellSVD',
 None][0m
[INFO][2024-03-22 01:52:50,123][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:52:51,625][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:52:51,784][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:52:51,787][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:52:54,093][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:52:54,093][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:52:54,093][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:52:54,093][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:52:54,094][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:52:54,102][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:52:54,103][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:52:54,103][dance][wrapped_func] Took 0:00:03.979959 to load and process data.
[WARNING][2024-03-22 01:52:54,112][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:52:54,117][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:52:54,939][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:52:54,956][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:52:56,048][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:52:56,995][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:53:59,156][dance.CellSVD][__call__] Generating cell SVD features (466, 21314) (k=293)
[INFO][2024-03-22 01:53:59,157][dance.CellSVD][__call__] Top 10 explained variances: [0.00110909 0.03079589 0.02730461 0.02231482 0.02042443 0.01738429
 0.01450929 0.01180426 0.01083601 0.00945836]
[INFO][2024-03-22 01:53:59,157][dance.CellSVD][__call__] Total explained variance: 89.94%
[INFO][2024-03-22 01:53:59,163][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:53:59,163][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.013 MB of 0.026 MB uploadedwandb: - 0.013 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.57576
wandb:  test_acc 0.31159
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run decent-sweep-153 at: https://wandb.ai/xzy11632/dance-dev/runs/e1tdch6a
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_015244-e1tdch6a/logs
wandb: Agent Starting Run: s9nt01j2 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_015412-s9nt01j2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run kind-sweep-154
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/s9nt01j2
[INFO][2024-03-22 01:54:17,818][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:54:17,818][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:54:17,820][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'FilterGenesNumberPlaceHolder',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 01:54:17,832][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:54:19,184][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:54:19,402][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:54:19,406][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:54:21,701][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:54:21,702][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:54:21,702][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:54:21,702][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:54:21,702][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:54:21,708][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:54:21,709][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:54:21,709][dance][wrapped_func] Took 0:00:03.877347 to load and process data.
[WARNING][2024-03-22 01:54:21,719][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:54:21,719][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:54:21,720][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 01:54:21,726][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:54:22,225][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:54:22,245][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:54:22,986][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:54:24,112][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:54:24,113][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:54:24,113][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 01:54:31,430][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:54:31,430][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.016 MB of 0.026 MB uploadedwandb: \ 0.016 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.74242
wandb:  test_acc 0.74638
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run kind-sweep-154 at: https://wandb.ai/xzy11632/dance-dev/runs/s9nt01j2
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_015412-s9nt01j2/logs
wandb: Agent Starting Run: 7zxwpb2d with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_015450-7zxwpb2d
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run feasible-sweep-155
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/7zxwpb2d
[INFO][2024-03-22 01:54:56,733][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:54:56,733][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:54:56,735][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 01:54:56,741][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:54:57,802][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:54:57,957][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:54:57,961][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:55:00,634][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:55:00,634][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:55:00,634][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:55:00,634][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:55:00,635][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:55:00,643][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:55:00,643][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:55:00,643][dance][wrapped_func] Took 0:00:03.902660 to load and process data.
[WARNING][2024-03-22 01:55:00,651][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:55:00,657][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:55:01,169][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:55:01,189][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:55:01,740][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:55:02,858][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:55:09,255][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 21314) (k=158)
[INFO][2024-03-22 01:55:09,265][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.03%
[INFO][2024-03-22 01:55:09,776][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:55:09,776][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.80303
wandb:  test_acc 0.75362
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run feasible-sweep-155 at: https://wandb.ai/xzy11632/dance-dev/runs/7zxwpb2d
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_015450-7zxwpb2d/logs
wandb: Agent Starting Run: ftz00fli with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_015528-ftz00fli
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run spring-sweep-156
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ftz00fli
[INFO][2024-03-22 01:55:41,656][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:55:41,656][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:55:41,658][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 01:55:41,672][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:55:43,662][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:55:44,101][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:55:44,109][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:55:49,354][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:55:49,354][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:55:49,354][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:55:49,355][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:55:49,355][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:55:49,369][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:55:49,388][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:55:49,388][dance][wrapped_func] Took 0:00:07.716567 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 01:55:49,426][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 01:55:49,472][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:55:50,321][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:55:50,339][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:55:51,395][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:55:51,844][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 01:56:48,172][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 21314) (k=165)
[INFO][2024-03-22 01:56:48,173][dance.WeightedFeatureSVD][__call__] Total explained variance: 91.08%
[INFO][2024-03-22 01:56:49,165][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:56:49,165][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.77273
wandb:  test_acc 0.73913
wandb: train_acc 0.99237
wandb: 
wandb: üöÄ View run spring-sweep-156 at: https://wandb.ai/xzy11632/dance-dev/runs/ftz00fli
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_015528-ftz00fli/logs
wandb: Agent Starting Run: dycyhj7p with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_015707-dycyhj7p
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run super-sweep-157
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/dycyhj7p
[INFO][2024-03-22 01:57:13,828][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:57:13,828][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:57:13,831][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'FilterGenesRegression',
 'CellPCA',
 None][0m
[INFO][2024-03-22 01:57:13,840][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:57:15,678][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:57:15,875][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:57:15,879][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:57:18,062][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:57:18,063][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:57:18,063][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:57:18,063][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:57:18,063][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:57:18,065][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:57:18,066][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:57:18,066][dance][wrapped_func] Took 0:00:04.226340 to load and process data.
[WARNING][2024-03-22 01:57:18,082][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:57:18,171][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:57:18,192][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:57:18,309][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 01:57:18,875][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-22 01:57:43,889][dance.CellPCA][__call__] Generating cell PCA features (466, 21314) (k=292)
[INFO][2024-03-22 01:57:43,889][dance.CellPCA][__call__] Top 10 explained variances: [0.03079597 0.02735261 0.0223159  0.02063387 0.01749895 0.01450944
 0.01193754 0.01083606 0.00946006 0.00908297]
[INFO][2024-03-22 01:57:43,889][dance.CellPCA][__call__] Total explained variance: 90.09%
[INFO][2024-03-22 01:57:43,894][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:57:43,894][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.59091
wandb:  test_acc 0.34058
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run super-sweep-157 at: https://wandb.ai/xzy11632/dance-dev/runs/dycyhj7p
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_015707-dycyhj7p/logs
wandb: Agent Starting Run: s3eqyb9z with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_015802-s3eqyb9z
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run still-sweep-158
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/s3eqyb9z
[INFO][2024-03-22 01:58:08,649][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 01:58:08,659][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 01:58:08,661][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'FilterGenesRegression',
 'CellSVD',
 None][0m
[INFO][2024-03-22 01:58:08,673][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 01:58:09,865][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 01:58:10,018][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 01:58:10,021][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 01:58:10,778][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 01:58:10,781][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 01:58:10,781][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 01:58:10,781][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 01:58:10,781][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 01:58:10,783][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 01:58:10,784][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 01:58:10,784][dance][wrapped_func] Took 0:00:02.111723 to load and process data.
[WARNING][2024-03-22 01:58:10,800][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:58:10,886][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 01:58:10,907][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 01:58:11,022][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 01:58:11,638][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-22 01:59:43,860][dance.CellSVD][__call__] Generating cell SVD features (466, 21314) (k=293)
[INFO][2024-03-22 01:59:43,862][dance.CellSVD][__call__] Top 10 explained variances: [0.00110909 0.03079589 0.02730461 0.02231482 0.02042443 0.01738429
 0.01450929 0.01180426 0.01083601 0.00945836]
[INFO][2024-03-22 01:59:43,862][dance.CellSVD][__call__] Total explained variance: 89.94%
[INFO][2024-03-22 01:59:43,863][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 01:59:43,863][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.57576
wandb:  test_acc 0.31159
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run still-sweep-158 at: https://wandb.ai/xzy11632/dance-dev/runs/s3eqyb9z
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_015802-s3eqyb9z/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: lusl8y04 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_020010-lusl8y04
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run driven-sweep-159
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/lusl8y04
[INFO][2024-03-22 02:00:17,465][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:00:17,465][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:00:17,467][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'FilterGenesRegression',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 02:00:17,480][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:00:19,500][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:00:19,835][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:00:19,839][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:00:22,439][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:00:22,439][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:00:22,440][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:00:22,440][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:00:22,440][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:00:22,450][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:00:22,450][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:00:22,451][dance][wrapped_func] Took 0:00:04.970797 to load and process data.
[WARNING][2024-03-22 02:00:22,461][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:00:22,461][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 02:00:22,467][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:00:23,060][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:00:23,080][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:00:23,761][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 02:00:25,739][dance][_filter_enclasc] Start generating cell features using EnClaSC
[WARNING][2024-03-22 02:00:25,796][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:00:25,797][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 02:00:31,569][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:00:31,569][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.74242
wandb:  test_acc 0.74638
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run driven-sweep-159 at: https://wandb.ai/xzy11632/dance-dev/runs/lusl8y04
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_020010-lusl8y04/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 5ubfgaz2 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_020056-5ubfgaz2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run kind-sweep-160
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/5ubfgaz2
[INFO][2024-03-22 02:01:03,950][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:01:03,951][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:01:03,952][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 02:01:03,969][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:01:05,694][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:01:06,270][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:01:06,273][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:01:09,797][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:01:09,797][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:01:09,797][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:01:09,797][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:01:09,798][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:01:09,809][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:01:09,809][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:01:09,809][dance][wrapped_func] Took 0:00:05.841152 to load and process data.
[WARNING][2024-03-22 02:01:09,827][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:01:10,383][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:01:10,402][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:01:11,387][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 02:01:12,699][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-22 02:01:19,169][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 21314) (k=158)
[INFO][2024-03-22 02:01:19,169][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.03%
[INFO][2024-03-22 02:01:19,818][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:01:19,819][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.013 MB uploadedwandb: - 0.012 MB of 0.013 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.80303
wandb:  test_acc 0.75362
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run kind-sweep-160 at: https://wandb.ai/xzy11632/dance-dev/runs/5ubfgaz2
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_020056-5ubfgaz2/logs
wandb: Agent Starting Run: hgfdjchw with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_020134-hgfdjchw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run pretty-sweep-161
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/hgfdjchw
[INFO][2024-03-22 02:01:40,419][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:01:40,419][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:01:40,420][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 02:01:40,450][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:01:42,396][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:01:43,211][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:01:43,215][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:01:47,544][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:01:47,544][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:01:47,544][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:01:47,545][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:01:47,545][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:01:47,558][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:01:47,558][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:01:47,559][dance][wrapped_func] Took 0:00:07.108676 to load and process data.
[WARNING][2024-03-22 02:01:47,591][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:01:49,036][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:01:49,058][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:01:49,180][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 02:01:51,041][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-22 02:02:49,565][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 21314) (k=165)
[INFO][2024-03-22 02:02:49,565][dance.WeightedFeatureSVD][__call__] Total explained variance: 91.08%
[INFO][2024-03-22 02:02:51,004][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:02:51,005][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.021 MB of 0.025 MB uploadedwandb: \ 0.021 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.77273
wandb:  test_acc 0.73913
wandb: train_acc 0.99237
wandb: 
wandb: üöÄ View run pretty-sweep-161 at: https://wandb.ai/xzy11632/dance-dev/runs/hgfdjchw
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_020134-hgfdjchw/logs
wandb: Agent Starting Run: 8qm9jvr3 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_020307-8qm9jvr3
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run frosty-sweep-162
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/8qm9jvr3
[INFO][2024-03-22 02:03:16,337][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:03:16,337][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:03:16,338][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder', 'NormalizeTotal', 'FilterGenesTopK', 'CellPCA', None][0m
[INFO][2024-03-22 02:03:16,345][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:03:18,043][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:03:18,499][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:03:18,502][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:03:22,190][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:03:22,190][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:03:22,190][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:03:22,191][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:03:22,191][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:03:22,197][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:03:22,198][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:03:22,198][dance][wrapped_func] Took 0:00:05.853325 to load and process data.
[WARNING][2024-03-22 02:03:22,212][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:03:22,480][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:03:22,497][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:03:22,654][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[INFO][2024-03-22 02:03:31,592][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=61)
[INFO][2024-03-22 02:03:31,593][dance.CellPCA][__call__] Top 10 explained variances: [0.12022029 0.06991412 0.06455553 0.05615183 0.04351121 0.04220634
 0.03466527 0.02852044 0.02521703 0.02498391]
[INFO][2024-03-22 02:03:31,593][dance.CellPCA][__call__] Total explained variance: 90.24%
[INFO][2024-03-22 02:03:31,594][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:03:31,594][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.25758
wandb:  test_acc 0.07246
wandb: train_acc 0.54962
wandb: 
wandb: üöÄ View run frosty-sweep-162 at: https://wandb.ai/xzy11632/dance-dev/runs/8qm9jvr3
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_020307-8qm9jvr3/logs
wandb: Agent Starting Run: a42s1am2 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_020351-a42s1am2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run robust-sweep-163
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/a42s1am2
[INFO][2024-03-22 02:03:59,338][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:03:59,338][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:03:59,343][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder', 'NormalizeTotal', 'FilterGenesTopK', 'CellSVD', None][0m
[INFO][2024-03-22 02:03:59,368][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:04:00,764][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:04:00,955][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:04:00,960][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:04:03,681][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:04:03,681][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:04:03,682][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:04:03,682][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:04:03,682][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:04:03,696][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:04:03,698][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:04:03,698][dance][wrapped_func] Took 0:00:04.330834 to load and process data.
[WARNING][2024-03-22 02:04:03,720][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:04:04,465][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:04:04,486][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:04:04,950][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[INFO][2024-03-22 02:04:24,307][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=61)
[INFO][2024-03-22 02:04:24,309][dance.CellSVD][__call__] Top 10 explained variances: [0.12021112 0.06990291 0.06455185 0.05614913 0.0435008  0.04220947
 0.03466147 0.0285134  0.0252137  0.02498652]
[INFO][2024-03-22 02:04:24,309][dance.CellSVD][__call__] Total explained variance: 90.22%
[INFO][2024-03-22 02:04:24,317][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:04:24,317][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.018 MB of 0.025 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.27273
wandb:  test_acc 0.08696
wandb: train_acc 0.58779
wandb: 
wandb: üöÄ View run robust-sweep-163 at: https://wandb.ai/xzy11632/dance-dev/runs/a42s1am2
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_020351-a42s1am2/logs
wandb: Agent Starting Run: feg63u0k with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_020436-feg63u0k
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run chocolate-sweep-164
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/feg63u0k
[INFO][2024-03-22 02:04:43,346][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:04:43,347][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:04:43,348][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'FilterGenesTopK',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 02:04:43,355][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:04:44,601][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:04:44,906][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:04:44,910][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:04:47,278][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:04:47,293][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:04:47,293][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:04:47,293][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:04:47,293][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:04:47,307][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:04:47,308][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:04:47,308][dance][wrapped_func] Took 0:00:03.953369 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 02:04:47,318][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:04:47,318][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 02:04:47,325][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:04:48,135][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:04:48,219][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:04:49,301][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:04:51,262][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:04:51,263][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 02:04:51,321][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:04:51,328][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.0942
wandb: train_acc 0.98855
wandb: 
wandb: üöÄ View run chocolate-sweep-164 at: https://wandb.ai/xzy11632/dance-dev/runs/feg63u0k
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_020436-feg63u0k/logs
wandb: Agent Starting Run: 83qgibgr with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_020509-83qgibgr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run deep-sweep-165
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/83qgibgr
[INFO][2024-03-22 02:05:16,407][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:05:16,408][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:05:16,414][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 02:05:16,440][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:05:18,083][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:05:18,257][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:05:18,262][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:05:21,366][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:05:21,367][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:05:21,367][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:05:21,367][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:05:21,367][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:05:21,380][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:05:21,380][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:05:21,381][dance][wrapped_func] Took 0:00:04.940646 to load and process data.
[WARNING][2024-03-22 02:05:21,402][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:05:22,091][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:05:22,127][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:05:22,857][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[INFO][2024-03-22 02:05:27,756][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=34)
[INFO][2024-03-22 02:05:27,756][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.26%
[INFO][2024-03-22 02:05:27,779][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:05:27,779][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.22727
wandb:  test_acc 0.1087
wandb: train_acc 0.55344
wandb: 
wandb: üöÄ View run deep-sweep-165 at: https://wandb.ai/xzy11632/dance-dev/runs/83qgibgr
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_020509-83qgibgr/logs
wandb: Agent Starting Run: mn4weaxf with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_020540-mn4weaxf
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ethereal-sweep-166
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/mn4weaxf
[INFO][2024-03-22 02:05:48,126][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:05:48,126][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:05:48,128][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 02:05:48,135][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:05:49,664][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:05:49,844][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:05:49,847][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:05:51,912][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:05:51,924][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:05:51,924][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:05:51,924][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:05:51,925][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:05:51,937][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:05:51,938][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:05:51,938][dance][wrapped_func] Took 0:00:03.802960 to load and process data.
[WARNING][2024-03-22 02:05:51,960][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:05:52,568][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:05:52,591][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:05:53,612][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[INFO][2024-03-22 02:06:13,510][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=34)
[INFO][2024-03-22 02:06:13,512][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.25%
[INFO][2024-03-22 02:06:13,521][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:06:13,521][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.22727
wandb:  test_acc 0.11594
wandb: train_acc 0.5458
wandb: 
wandb: üöÄ View run ethereal-sweep-166 at: https://wandb.ai/xzy11632/dance-dev/runs/mn4weaxf
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_020540-mn4weaxf/logs
wandb: Agent Starting Run: nqpxo8wh with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_020629-nqpxo8wh
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run unique-sweep-167
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/nqpxo8wh
[INFO][2024-03-22 02:06:36,099][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:06:36,099][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:06:36,101][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellPCA',
 None][0m
[INFO][2024-03-22 02:06:36,107][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:06:37,687][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:06:37,906][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:06:37,910][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:06:41,126][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:06:41,128][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:06:41,128][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:06:41,128][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:06:41,129][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:06:41,140][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:06:41,141][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:06:41,141][dance][wrapped_func] Took 0:00:05.034961 to load and process data.
[WARNING][2024-03-22 02:06:41,159][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:06:41,942][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:06:41,960][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:06:42,632][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run unique-sweep-167 at: https://wandb.ai/xzy11632/dance-dev/runs/nqpxo8wh
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_020629-nqpxo8wh/logs
wandb: ERROR Run nqpxo8wh errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 84b7khyx with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_020709-84b7khyx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run pretty-sweep-168
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/84b7khyx
[INFO][2024-03-22 02:07:16,410][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:07:16,411][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:07:16,417][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellSVD',
 None][0m
[INFO][2024-03-22 02:07:16,428][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:07:17,830][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:07:18,030][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:07:18,033][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:07:21,472][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:07:21,473][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:07:21,473][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:07:21,473][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:07:21,474][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:07:21,490][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:07:21,490][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:07:21,491][dance][wrapped_func] Took 0:00:05.063409 to load and process data.
[WARNING][2024-03-22 02:07:21,511][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:07:22,010][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:07:22,029][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:07:22,534][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run pretty-sweep-168 at: https://wandb.ai/xzy11632/dance-dev/runs/84b7khyx
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_020709-84b7khyx/logs
wandb: ERROR Run 84b7khyx errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: c174bqek with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_020739-c174bqek
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run twilight-sweep-169
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/c174bqek
[INFO][2024-03-22 02:07:47,458][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:07:47,459][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:07:47,461][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 02:07:47,474][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:07:49,343][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:07:49,607][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:07:49,611][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:07:52,981][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:07:52,981][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:07:52,981][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:07:52,982][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:07:52,982][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:07:52,995][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:07:52,996][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:07:52,996][dance][wrapped_func] Took 0:00:05.522396 to load and process data.
[WARNING][2024-03-22 02:07:53,007][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:07:53,007][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 02:07:53,013][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:07:53,644][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:07:53,666][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:07:54,316][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run twilight-sweep-169 at: https://wandb.ai/xzy11632/dance-dev/runs/c174bqek
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_020739-c174bqek/logs
wandb: ERROR Run c174bqek errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: ghzo3zcy with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_020810-ghzo3zcy
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run misty-sweep-170
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ghzo3zcy
[INFO][2024-03-22 02:08:18,052][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:08:18,053][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:08:18,054][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 02:08:18,061][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:08:19,225][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:08:19,403][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:08:19,428][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:08:22,124][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:08:22,125][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:08:22,125][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:08:22,125][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:08:22,125][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:08:22,138][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:08:22,139][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:08:22,139][dance][wrapped_func] Took 0:00:04.078261 to load and process data.
[WARNING][2024-03-22 02:08:22,162][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:08:22,831][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:08:22,862][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:08:23,664][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.018 MB uploadedwandb: \ 0.012 MB of 0.018 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run misty-sweep-170 at: https://wandb.ai/xzy11632/dance-dev/runs/ghzo3zcy
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_020810-ghzo3zcy/logs
wandb: ERROR Run ghzo3zcy errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: sqlcwoxo with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_020839-sqlcwoxo
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run proud-sweep-171
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/sqlcwoxo
[INFO][2024-03-22 02:08:45,928][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:08:45,935][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:08:45,937][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 02:08:45,944][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:08:47,960][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:08:48,145][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:08:48,149][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:08:50,943][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:08:50,944][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:08:50,944][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:08:50,944][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:08:50,945][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:08:50,969][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:08:50,973][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:08:50,973][dance][wrapped_func] Took 0:00:05.030074 to load and process data.
[WARNING][2024-03-22 02:08:51,007][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:08:51,743][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:08:51,763][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:08:52,995][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run proud-sweep-171 at: https://wandb.ai/xzy11632/dance-dev/runs/sqlcwoxo
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_020839-sqlcwoxo/logs
wandb: ERROR Run sqlcwoxo errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: 27vz62bp with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_020909-27vz62bp
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dazzling-sweep-172
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/27vz62bp
[INFO][2024-03-22 02:09:19,209][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:09:19,209][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:09:19,210][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellPCA',
 None][0m
[INFO][2024-03-22 02:09:19,220][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:09:20,198][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:09:20,382][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:09:20,385][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:09:23,474][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:09:23,475][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:09:23,476][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:09:23,476][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:09:23,477][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:09:23,491][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:09:23,492][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:09:23,493][dance][wrapped_func] Took 0:00:04.273231 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 02:09:23,514][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:09:24,543][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:09:24,568][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:09:25,407][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.021 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run dazzling-sweep-172 at: https://wandb.ai/xzy11632/dance-dev/runs/27vz62bp
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_020909-27vz62bp/logs
wandb: ERROR Run 27vz62bp errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: fmphvqie with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_020941-fmphvqie
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run clear-sweep-173
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/fmphvqie
[INFO][2024-03-22 02:09:47,604][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:09:47,605][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:09:47,606][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellSVD',
 None][0m
[INFO][2024-03-22 02:09:47,613][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:09:49,390][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:09:49,602][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:09:49,606][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:09:52,347][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:09:52,347][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:09:52,347][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:09:52,347][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:09:52,348][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:09:52,359][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:09:52,360][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:09:52,360][dance][wrapped_func] Took 0:00:04.747394 to load and process data.
[WARNING][2024-03-22 02:09:52,376][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:09:52,818][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:09:52,842][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:09:53,303][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run clear-sweep-173 at: https://wandb.ai/xzy11632/dance-dev/runs/fmphvqie
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_020941-fmphvqie/logs
wandb: ERROR Run fmphvqie errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: w5f7bbgw with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_021007-w5f7bbgw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run crimson-sweep-174
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/w5f7bbgw
[INFO][2024-03-22 02:10:14,529][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:10:14,529][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:10:14,530][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 02:10:14,542][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:10:16,501][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:10:16,689][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:10:16,693][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:10:19,384][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:10:19,384][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:10:19,384][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:10:19,385][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:10:19,385][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:10:19,387][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:10:19,387][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:10:19,387][dance][wrapped_func] Took 0:00:04.845283 to load and process data.
[WARNING][2024-03-22 02:10:19,400][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:10:19,400][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 02:10:19,408][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:10:19,708][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:10:19,729][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:10:20,458][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run crimson-sweep-174 at: https://wandb.ai/xzy11632/dance-dev/runs/w5f7bbgw
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_021007-w5f7bbgw/logs
wandb: ERROR Run w5f7bbgw errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: ueilg81l with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_021034-ueilg81l
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run young-sweep-175
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ueilg81l
[INFO][2024-03-22 02:10:40,717][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:10:40,718][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:10:40,719][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 02:10:40,727][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:10:41,469][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:10:41,798][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:10:41,801][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:10:43,792][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:10:43,792][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:10:43,792][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:10:43,792][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:10:43,793][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:10:43,801][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:10:43,802][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:10:43,802][dance][wrapped_func] Took 0:00:03.075644 to load and process data.
[WARNING][2024-03-22 02:10:43,815][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:10:44,504][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:10:44,520][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:10:45,174][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run young-sweep-175 at: https://wandb.ai/xzy11632/dance-dev/runs/ueilg81l
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_021034-ueilg81l/logs
wandb: ERROR Run ueilg81l errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: yzsbrp54 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_021106-yzsbrp54
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run hearty-sweep-176
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/yzsbrp54
[INFO][2024-03-22 02:11:14,796][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:11:14,797][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:11:14,798][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 02:11:14,811][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:11:16,041][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:11:16,208][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:11:16,211][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:11:18,663][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:11:18,663][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:11:18,663][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:11:18,663][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:11:18,664][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:11:18,673][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:11:18,673][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:11:18,673][dance][wrapped_func] Took 0:00:03.862653 to load and process data.
[WARNING][2024-03-22 02:11:18,687][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:11:19,009][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:11:19,027][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:11:19,423][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run hearty-sweep-176 at: https://wandb.ai/xzy11632/dance-dev/runs/yzsbrp54
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_021106-yzsbrp54/logs
wandb: ERROR Run yzsbrp54 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: 2shzof61 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_021137-2shzof61
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run vibrant-sweep-177
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/2shzof61
[INFO][2024-03-22 02:11:44,005][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:11:44,005][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:11:44,007][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'CellPCA',
 None][0m
[INFO][2024-03-22 02:11:44,032][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:11:45,673][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:11:45,895][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:11:45,899][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:11:50,398][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:11:50,399][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:11:50,399][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:11:50,399][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:11:50,400][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:11:50,426][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:11:50,434][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:11:50,434][dance][wrapped_func] Took 0:00:06.402504 to load and process data.
[WARNING][2024-03-22 02:11:50,467][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:11:51,346][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:11:51,367][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:11:52,494][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-22 02:12:08,793][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=188)
[INFO][2024-03-22 02:12:08,793][dance.CellPCA][__call__] Top 10 explained variances: [0.05494886 0.03801747 0.03513849 0.02841627 0.02357708 0.02250028
 0.02190465 0.01939504 0.01530432 0.01458907]
[INFO][2024-03-22 02:12:08,793][dance.CellPCA][__call__] Total explained variance: 90.07%
[INFO][2024-03-22 02:12:08,794][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:12:08,794][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.60606
wandb:  test_acc 0.28986
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run vibrant-sweep-177 at: https://wandb.ai/xzy11632/dance-dev/runs/2shzof61
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_021137-2shzof61/logs
wandb: Agent Starting Run: 59kxiz5w with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_021222-59kxiz5w
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sandy-sweep-178
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/59kxiz5w
[INFO][2024-03-22 02:12:29,695][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:12:29,695][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:12:29,704][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'CellSVD',
 None][0m
[INFO][2024-03-22 02:12:29,710][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:12:31,232][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:12:31,452][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:12:31,455][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:12:33,300][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:12:33,301][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:12:33,302][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:12:33,302][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:12:33,302][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:12:33,309][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:12:33,309][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:12:33,310][dance][wrapped_func] Took 0:00:03.599651 to load and process data.
[WARNING][2024-03-22 02:12:33,331][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:12:33,608][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:12:33,653][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:12:34,039][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-22 02:14:01,849][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=188)
[INFO][2024-03-22 02:14:01,857][dance.CellSVD][__call__] Top 10 explained variances: [0.02734241 0.04279074 0.03515654 0.03107569 0.02800347 0.02342082
 0.02192143 0.02032903 0.01939104 0.01529557]
[INFO][2024-03-22 02:14:01,858][dance.CellSVD][__call__] Total explained variance: 89.94%
[INFO][2024-03-22 02:14:01,861][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:14:01,861][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.5
wandb:  test_acc 0.34058
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run sandy-sweep-178 at: https://wandb.ai/xzy11632/dance-dev/runs/59kxiz5w
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_021222-59kxiz5w/logs
wandb: Agent Starting Run: w9wimpwz with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_021415-w9wimpwz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run generous-sweep-179
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/w9wimpwz
[INFO][2024-03-22 02:14:24,700][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:14:24,700][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:14:24,702][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 02:14:24,722][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:14:26,575][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:14:26,747][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:14:26,750][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:14:31,011][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:14:31,012][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:14:31,013][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:14:31,013][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:14:31,013][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:14:31,026][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:14:31,026][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:14:31,027][dance][wrapped_func] Took 0:00:06.318410 to load and process data.
[WARNING][2024-03-22 02:14:31,040][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:14:31,040][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 02:14:31,049][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:14:32,412][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:14:32,431][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:14:32,937][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 02:14:39,832][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:14:39,833][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 02:14:40,027][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:14:40,039][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.013 MB of 0.026 MB uploadedwandb: / 0.023 MB of 0.026 MB uploadedwandb: - 0.023 MB of 0.026 MB uploadedwandb: \ 0.023 MB of 0.026 MB uploadedwandb: | 0.023 MB of 0.026 MB uploadedwandb: / 0.023 MB of 0.026 MB uploadedwandb: - 0.023 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.69697
wandb:  test_acc 0.55072
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run generous-sweep-179 at: https://wandb.ai/xzy11632/dance-dev/runs/w9wimpwz
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_021415-w9wimpwz/logs
wandb: Agent Starting Run: ygb0lg7k with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_021459-ygb0lg7k
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run crimson-sweep-180
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ygb0lg7k
[INFO][2024-03-22 02:15:11,768][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:15:11,769][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:15:11,770][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 02:15:11,778][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:15:13,397][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:15:13,737][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:15:13,742][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:15:15,992][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:15:15,992][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:15:15,992][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:15:15,992][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:15:15,993][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:15:16,008][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:15:16,009][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:15:16,009][dance][wrapped_func] Took 0:00:04.231621 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 02:15:16,028][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:15:16,524][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:15:16,553][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:15:16,841][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-22 02:15:22,018][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=108)
[INFO][2024-03-22 02:15:22,023][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.06%
[INFO][2024-03-22 02:15:22,148][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:15:22,148][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.66667
wandb:  test_acc 0.63768
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run crimson-sweep-180 at: https://wandb.ai/xzy11632/dance-dev/runs/ygb0lg7k
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_021459-ygb0lg7k/logs
wandb: Agent Starting Run: 9f16mf4z with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: NormalizeTotal
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_021540-9f16mf4z
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wild-sweep-181
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/9f16mf4z
[INFO][2024-03-22 02:15:47,334][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:15:47,334][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:15:47,335][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 02:15:47,342][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:15:48,754][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:15:48,922][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:15:48,926][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:15:50,954][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:15:50,954][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:15:50,954][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:15:50,954][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:15:50,955][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:15:50,956][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:15:50,956][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:15:50,957][dance][wrapped_func] Took 0:00:03.614519 to load and process data.
[WARNING][2024-03-22 02:15:50,973][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:15:51,713][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:15:51,733][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:15:52,114][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-22 02:16:33,555][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=111)
[INFO][2024-03-22 02:16:33,567][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.50%
[INFO][2024-03-22 02:16:33,586][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:16:33,586][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.74242
wandb:  test_acc 0.5942
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run wild-sweep-181 at: https://wandb.ai/xzy11632/dance-dev/runs/9f16mf4z
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_021540-9f16mf4z/logs
wandb: Agent Starting Run: urk1k2yd with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_021647-urk1k2yd
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run skilled-sweep-182
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/urk1k2yd
[INFO][2024-03-22 02:16:53,833][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:16:53,833][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:16:53,839][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'FilterGenesNumberPlaceHolder',
 'CellPCA',
 None][0m
[INFO][2024-03-22 02:16:53,846][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:16:54,965][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:16:55,161][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:16:55,164][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:16:57,207][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:16:57,208][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:16:57,208][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:16:57,208][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:16:57,209][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:16:57,222][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:16:57,223][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:16:57,223][dance][wrapped_func] Took 0:00:03.377337 to load and process data.
[WARNING][2024-03-22 02:16:57,236][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 02:16:57,246][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:16:57,519][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:16:57,539][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:16:57,883][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 02:17:23,417][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:17:35,908][dance.CellPCA][__call__] Generating cell PCA features (466, 21314) (k=388)
[INFO][2024-03-22 02:17:35,917][dance.CellPCA][__call__] Top 10 explained variances: [0.01973604 0.01538584 0.0135405  0.01156849 0.00977277 0.00765575
 0.0064728  0.00568484 0.00528783 0.00484125]
[INFO][2024-03-22 02:17:35,917][dance.CellPCA][__call__] Total explained variance: 90.06%
[INFO][2024-03-22 02:17:35,927][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:17:35,927][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.018 MB of 0.026 MB uploadedwandb: - 0.018 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.42424
wandb:  test_acc 0.18841
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run skilled-sweep-182 at: https://wandb.ai/xzy11632/dance-dev/runs/urk1k2yd
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_021647-urk1k2yd/logs
wandb: Agent Starting Run: ktdlff6c with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_021749-ktdlff6c
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fresh-sweep-183
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ktdlff6c
[INFO][2024-03-22 02:17:56,004][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:17:56,005][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:17:56,006][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'FilterGenesNumberPlaceHolder',
 'CellSVD',
 None][0m
[INFO][2024-03-22 02:17:56,015][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:17:57,735][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:17:57,914][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:17:57,918][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:18:00,909][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:18:00,909][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:18:00,910][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:18:00,910][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:18:00,910][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:18:00,920][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:18:00,921][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:18:00,921][dance][wrapped_func] Took 0:00:04.906494 to load and process data.
[WARNING][2024-03-22 02:18:00,933][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 02:18:00,941][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:18:01,479][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:18:01,499][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:18:02,166][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 02:18:23,109][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:19:20,563][dance.CellSVD][__call__] Generating cell SVD features (466, 21314) (k=389)
[INFO][2024-03-22 02:19:20,565][dance.CellSVD][__call__] Top 10 explained variances: [0.00155777 0.0196487  0.01529276 0.0135012  0.01140817 0.00969121
 0.00764633 0.00647008 0.00568415 0.00518301]
[INFO][2024-03-22 02:19:20,565][dance.CellSVD][__call__] Total explained variance: 89.54%
[INFO][2024-03-22 02:19:20,567][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:19:20,567][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.11594
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run fresh-sweep-183 at: https://wandb.ai/xzy11632/dance-dev/runs/ktdlff6c
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_021749-ktdlff6c/logs
wandb: Agent Starting Run: wdi8sdq0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_021934-wdi8sdq0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run proud-sweep-184
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/wdi8sdq0
[INFO][2024-03-22 02:19:39,815][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:19:39,816][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:19:39,817][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'FilterGenesNumberPlaceHolder',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 02:19:39,830][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:19:40,882][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:19:41,049][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:19:41,053][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:19:43,405][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:19:43,406][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:19:43,406][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:19:43,406][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:19:43,406][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:19:43,416][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:19:43,417][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:19:43,417][dance][wrapped_func] Took 0:00:03.586973 to load and process data.
[WARNING][2024-03-22 02:19:43,426][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 02:19:43,427][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:19:43,427][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 02:19:43,432][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:19:44,278][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:19:44,296][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:19:44,933][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 02:20:04,464][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 02:20:04,466][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:20:04,466][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 02:20:12,563][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:20:12,564][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.012 MB of 0.018 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.77273
wandb:  test_acc 0.76812
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run proud-sweep-184 at: https://wandb.ai/xzy11632/dance-dev/runs/wdi8sdq0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_021934-wdi8sdq0/logs
wandb: Agent Starting Run: wcq7ve4z with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_022027-wcq7ve4z
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run eager-sweep-185
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/wcq7ve4z
[INFO][2024-03-22 02:20:33,199][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:20:33,199][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:20:33,207][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 02:20:33,216][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:20:33,635][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:20:33,802][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:20:33,806][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:20:33,985][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:20:33,985][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:20:33,986][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:20:33,986][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:20:33,986][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:20:33,988][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:20:33,988][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:20:33,989][dance][wrapped_func] Took 0:00:00.773233 to load and process data.
[WARNING][2024-03-22 02:20:33,999][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 02:20:34,004][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:20:34,073][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:20:34,091][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:20:34,171][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 02:21:21,007][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:21:24,731][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 21314) (k=219)
[INFO][2024-03-22 02:21:24,734][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.14%
[INFO][2024-03-22 02:21:24,853][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:21:24,860][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.018 MB of 0.026 MB uploadedwandb: - 0.018 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.60606
wandb:  test_acc 0.15942
wandb: train_acc 0.67557
wandb: 
wandb: üöÄ View run eager-sweep-185 at: https://wandb.ai/xzy11632/dance-dev/runs/wcq7ve4z
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_022027-wcq7ve4z/logs
wandb: Agent Starting Run: 0mvxlagf with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_022138-0mvxlagf
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run serene-sweep-186
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/0mvxlagf
[INFO][2024-03-22 02:21:49,897][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:21:49,897][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:21:49,900][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 02:21:49,930][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:21:50,989][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:21:51,428][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:21:51,452][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:21:51,983][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:21:51,983][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:21:51,983][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:21:51,983][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:21:51,983][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:21:51,986][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:21:51,986][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:21:51,987][dance][wrapped_func] Took 0:00:02.056491 to load and process data.
[WARNING][2024-03-22 02:21:52,029][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 02:21:52,044][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:21:52,535][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:21:52,680][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:21:53,233][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 02:22:30,426][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:23:27,931][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 21314) (k=220)
[INFO][2024-03-22 02:23:27,932][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.03%
[INFO][2024-03-22 02:23:27,982][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:23:27,982][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.021 MB uploadedwandb: \ 0.018 MB of 0.026 MB uploadedwandb: | 0.018 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.59091
wandb:  test_acc 0.14493
wandb: train_acc 0.62214
wandb: 
wandb: üöÄ View run serene-sweep-186 at: https://wandb.ai/xzy11632/dance-dev/runs/0mvxlagf
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_022138-0mvxlagf/logs
wandb: Agent Starting Run: rzx6qrp8 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_022346-rzx6qrp8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run amber-sweep-187
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/rzx6qrp8
[INFO][2024-03-22 02:24:09,278][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:24:09,278][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:24:09,281][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'FilterGenesRegression',
 'CellPCA',
 None][0m
[INFO][2024-03-22 02:24:11,997][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:24:13,256][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:24:13,979][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:24:13,982][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:24:14,782][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:24:14,782][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:24:14,782][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:24:14,782][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:24:14,782][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:24:14,784][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:24:14,785][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:24:14,785][dance][wrapped_func] Took 0:00:02.788316 to load and process data.
[WARNING][2024-03-22 02:24:14,798][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:24:14,874][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:24:14,891][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:24:14,975][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 02:24:32,552][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-22 02:24:44,800][dance.CellPCA][__call__] Generating cell PCA features (466, 21314) (k=388)
[INFO][2024-03-22 02:24:44,801][dance.CellPCA][__call__] Top 10 explained variances: [0.01973604 0.01538584 0.0135405  0.01156849 0.00977277 0.00765575
 0.0064728  0.00568484 0.00528783 0.00484125]
[INFO][2024-03-22 02:24:44,801][dance.CellPCA][__call__] Total explained variance: 90.06%
[INFO][2024-03-22 02:24:44,803][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:24:44,803][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.026 MB uploadedwandb: \ 0.018 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.42424
wandb:  test_acc 0.18841
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run amber-sweep-187 at: https://wandb.ai/xzy11632/dance-dev/runs/rzx6qrp8
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_022346-rzx6qrp8/logs
wandb: Agent Starting Run: rwtwlk48 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_022459-rwtwlk48
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run divine-sweep-188
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/rwtwlk48
[INFO][2024-03-22 02:25:07,146][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:25:07,147][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:25:07,149][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'FilterGenesRegression',
 'CellSVD',
 None][0m
[INFO][2024-03-22 02:25:07,158][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:25:08,841][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:25:09,184][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:25:09,188][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:25:13,695][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:25:13,695][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:25:13,696][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:25:13,696][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:25:13,696][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:25:13,706][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:25:13,707][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:25:13,707][dance][wrapped_func] Took 0:00:06.550785 to load and process data.
[WARNING][2024-03-22 02:25:13,737][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:25:14,151][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:25:14,192][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:25:14,692][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 02:25:50,385][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-22 02:28:14,465][dance.CellSVD][__call__] Generating cell SVD features (466, 21314) (k=389)
[INFO][2024-03-22 02:28:14,471][dance.CellSVD][__call__] Top 10 explained variances: [0.00155777 0.0196487  0.01529276 0.0135012  0.01140817 0.00969121
 0.00764633 0.00647008 0.00568415 0.00518301]
[INFO][2024-03-22 02:28:14,473][dance.CellSVD][__call__] Total explained variance: 89.54%
[INFO][2024-03-22 02:28:14,480][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:28:14,480][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.022 MB of 0.026 MB uploadedwandb: - 0.022 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.11594
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run divine-sweep-188 at: https://wandb.ai/xzy11632/dance-dev/runs/rwtwlk48
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_022459-rwtwlk48/logs
wandb: Agent Starting Run: jpc2fdsx with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_022832-jpc2fdsx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glamorous-sweep-189
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/jpc2fdsx
[INFO][2024-03-22 02:28:41,654][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:28:41,655][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:28:41,658][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'FilterGenesRegression',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 02:28:41,674][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:28:43,255][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:28:43,675][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:28:43,692][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:28:48,802][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:28:48,805][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:28:48,806][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:28:48,806][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:28:48,806][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:28:48,847][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:28:48,851][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:28:48,854][dance][wrapped_func] Took 0:00:07.180001 to load and process data.
[WARNING][2024-03-22 02:28:48,898][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:28:48,899][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 02:28:48,931][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:28:49,514][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:28:49,554][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:28:50,065][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 02:29:23,097][dance][_filter_enclasc] Start generating cell features using EnClaSC
[WARNING][2024-03-22 02:29:23,164][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:29:23,164][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 02:29:31,873][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:29:31,882][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.77273
wandb:  test_acc 0.76812
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run glamorous-sweep-189 at: https://wandb.ai/xzy11632/dance-dev/runs/jpc2fdsx
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_022832-jpc2fdsx/logs
wandb: Agent Starting Run: 94dz0tdy with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_022953-94dz0tdy
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run summer-sweep-190
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/94dz0tdy
[INFO][2024-03-22 02:30:02,582][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:30:02,582][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:30:02,584][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 02:30:02,593][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:30:05,814][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:30:06,243][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:30:06,259][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:30:11,992][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:30:11,993][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:30:11,993][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:30:11,994][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:30:11,994][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:30:12,012][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:30:12,012][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:30:12,012][dance][wrapped_func] Took 0:00:09.419949 to load and process data.
[WARNING][2024-03-22 02:30:12,048][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:30:12,572][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:30:12,607][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:30:13,361][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 02:30:47,977][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-22 02:30:54,433][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 21314) (k=219)
[INFO][2024-03-22 02:30:54,439][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.14%
[INFO][2024-03-22 02:30:55,468][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:30:55,478][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.60606
wandb:  test_acc 0.15942
wandb: train_acc 0.67557
wandb: 
wandb: üöÄ View run summer-sweep-190 at: https://wandb.ai/xzy11632/dance-dev/runs/94dz0tdy
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_022953-94dz0tdy/logs
wandb: Agent Starting Run: ko5ldndz with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_023113-ko5ldndz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run quiet-sweep-191
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ko5ldndz
[INFO][2024-03-22 02:31:21,691][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:31:21,692][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:31:21,694][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 02:31:21,706][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:31:24,397][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:31:24,743][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:31:24,753][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:31:30,252][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:31:30,253][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:31:30,253][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:31:30,253][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:31:30,253][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:31:30,265][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:31:30,266][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:31:30,266][dance][wrapped_func] Took 0:00:08.560830 to load and process data.
[WARNING][2024-03-22 02:31:30,282][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:31:31,307][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:31:31,331][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:31:32,239][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 02:32:09,936][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-22 02:33:25,454][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 21314) (k=220)
[INFO][2024-03-22 02:33:25,455][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.03%
[INFO][2024-03-22 02:33:26,680][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:33:26,681][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.59091
wandb:  test_acc 0.14493
wandb: train_acc 0.62214
wandb: 
wandb: üöÄ View run quiet-sweep-191 at: https://wandb.ai/xzy11632/dance-dev/runs/ko5ldndz
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_023113-ko5ldndz/logs
wandb: Agent Starting Run: 8pbwepvp with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_023341-8pbwepvp
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run grateful-sweep-192
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/8pbwepvp
[INFO][2024-03-22 02:33:49,503][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:33:49,504][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:33:49,506][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder', 'ScTransform', 'FilterGenesTopK', 'CellPCA', None][0m
[INFO][2024-03-22 02:33:49,524][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:33:53,178][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:33:53,460][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:33:53,464][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:33:58,750][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:33:58,751][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:33:58,751][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:33:58,751][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:33:58,751][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:33:58,766][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:33:58,767][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:33:58,767][dance][wrapped_func] Took 0:00:09.243530 to load and process data.
[WARNING][2024-03-22 02:33:58,791][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:33:59,469][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:33:59,489][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:33:59,869][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-22 02:34:40,823][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=283)
[INFO][2024-03-22 02:34:40,824][dance.CellPCA][__call__] Top 10 explained variances: [0.11817327 0.01378304 0.01337624 0.00966471 0.00901788 0.00833352
 0.00716342 0.00682885 0.00659354 0.00659058]
[INFO][2024-03-22 02:34:40,824][dance.CellPCA][__call__] Total explained variance: 90.01%
[INFO][2024-03-22 02:34:40,825][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:34:40,825][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.33333
wandb:  test_acc 0.11594
wandb: train_acc 0.89313
wandb: 
wandb: üöÄ View run grateful-sweep-192 at: https://wandb.ai/xzy11632/dance-dev/runs/8pbwepvp
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_023341-8pbwepvp/logs
wandb: Agent Starting Run: 1s2wiys9 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_023459-1s2wiys9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rose-sweep-193
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/1s2wiys9
[INFO][2024-03-22 02:35:07,258][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:35:07,258][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:35:07,264][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder', 'ScTransform', 'FilterGenesTopK', 'CellSVD', None][0m
[INFO][2024-03-22 02:35:07,296][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:35:09,139][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:35:09,507][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:35:09,511][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:35:12,830][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:35:12,830][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:35:12,830][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:35:12,830][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:35:12,831][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:35:12,841][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:35:12,842][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:35:12,842][dance][wrapped_func] Took 0:00:05.546186 to load and process data.
[WARNING][2024-03-22 02:35:12,863][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:35:12,963][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:35:12,985][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:35:13,347][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-22 02:36:57,148][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=284)
[INFO][2024-03-22 02:36:57,150][dance.CellSVD][__call__] Top 10 explained variances: [0.11806114 0.01378288 0.01335761 0.00947916 0.00899789 0.00831187
 0.00712591 0.00651261 0.00655415 0.00659287]
[INFO][2024-03-22 02:36:57,150][dance.CellSVD][__call__] Total explained variance: 89.92%
[INFO][2024-03-22 02:36:57,152][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:36:57,152][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.33333
wandb:  test_acc 0.07246
wandb: train_acc 0.84733
wandb: 
wandb: üöÄ View run rose-sweep-193 at: https://wandb.ai/xzy11632/dance-dev/runs/1s2wiys9
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_023459-1s2wiys9/logs
wandb: Agent Starting Run: hyi7qhq0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_023710-hyi7qhq0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run silvery-sweep-194
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/hyi7qhq0
[INFO][2024-03-22 02:37:16,827][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:37:16,827][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:37:16,835][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'FilterGenesTopK',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 02:37:16,844][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:37:18,528][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:37:18,810][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:37:18,814][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:37:22,988][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:37:22,990][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:37:22,990][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:37:22,991][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:37:22,991][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:37:23,005][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:37:23,006][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:37:23,007][dance][wrapped_func] Took 0:00:06.162682 to load and process data.
[WARNING][2024-03-22 02:37:23,023][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:37:23,023][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 02:37:23,029][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:37:24,397][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:37:24,423][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:37:25,345][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[WARNING][2024-03-22 02:37:59,321][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:37:59,322][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 02:37:59,383][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:37:59,385][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.37879
wandb:  test_acc 0.07246
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run silvery-sweep-194 at: https://wandb.ai/xzy11632/dance-dev/runs/hyi7qhq0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_023710-hyi7qhq0/logs
wandb: Agent Starting Run: t2fij6ur with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_023814-t2fij6ur
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run silvery-sweep-195
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/t2fij6ur
[INFO][2024-03-22 02:38:28,953][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:38:28,954][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:38:28,956][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 02:38:29,003][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:38:31,100][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:38:31,352][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:38:31,357][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:38:36,664][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:38:36,665][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:38:36,665][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:38:36,665][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:38:36,665][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:38:36,674][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:38:36,675][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:38:36,675][dance][wrapped_func] Took 0:00:07.676144 to load and process data.
[WARNING][2024-03-22 02:38:36,696][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:38:37,123][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:38:37,148][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:38:37,867][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-22 02:39:16,588][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=170)
[INFO][2024-03-22 02:39:16,589][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.14%
[INFO][2024-03-22 02:39:16,715][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:39:16,725][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.45802
wandb: 
wandb: üöÄ View run silvery-sweep-195 at: https://wandb.ai/xzy11632/dance-dev/runs/t2fij6ur
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_023814-t2fij6ur/logs
wandb: Agent Starting Run: rb1gusjr with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_023934-rb1gusjr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sparkling-sweep-196
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/rb1gusjr
[INFO][2024-03-22 02:39:39,985][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:39:39,987][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:39:39,988][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 02:39:40,004][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:39:40,430][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:39:40,605][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:39:40,608][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:39:40,797][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:39:40,797][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:39:40,797][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:39:40,797][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:39:40,797][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:39:40,799][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:39:40,799][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:39:40,799][dance][wrapped_func] Took 0:00:00.795638 to load and process data.
[WARNING][2024-03-22 02:39:40,814][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:39:40,886][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:39:40,902][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:39:40,992][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/dance/dance/transforms/filter.py:404: RuntimeWarning: invalid value encountered in divide
  gene_summary = np.nan_to_num(np.array(x.std(0) / x.mean(0)), posinf=0, neginf=0).ravel()
[INFO][2024-03-22 02:40:10,822][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=166)
[INFO][2024-03-22 02:40:10,822][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.22%
[INFO][2024-03-22 02:40:10,840][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:40:10,840][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.021 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.41985
wandb: 
wandb: üöÄ View run sparkling-sweep-196 at: https://wandb.ai/xzy11632/dance-dev/runs/rb1gusjr
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_023934-rb1gusjr/logs
wandb: Agent Starting Run: mf8mtm5q with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_024023-mf8mtm5q
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run expert-sweep-197
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/mf8mtm5q
[INFO][2024-03-22 02:40:28,080][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:40:28,080][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:40:28,082][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellPCA',
 None][0m
[INFO][2024-03-22 02:40:28,088][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:40:28,444][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:40:28,583][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:40:28,586][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:40:28,758][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:40:28,758][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:40:28,758][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:40:28,758][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:40:28,759][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:40:28,760][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:40:28,760][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:40:28,760][dance][wrapped_func] Took 0:00:00.672205 to load and process data.
[WARNING][2024-03-22 02:40:28,774][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:40:28,842][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:40:28,860][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:40:28,941][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[INFO][2024-03-22 02:40:51,857][dance.CellPCA][__call__] Generating cell PCA features (466, 6835) (k=360)
[INFO][2024-03-22 02:40:51,858][dance.CellPCA][__call__] Top 10 explained variances: [0.02263632 0.0213134  0.02015747 0.01598101 0.01374835 0.01077366
 0.00885395 0.00701967 0.00635185 0.0056723 ]
[INFO][2024-03-22 02:40:51,858][dance.CellPCA][__call__] Total explained variance: 90.05%
[INFO][2024-03-22 02:40:51,859][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:40:51,859][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.54545
wandb:  test_acc 0.28261
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run expert-sweep-197 at: https://wandb.ai/xzy11632/dance-dev/runs/mf8mtm5q
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_024023-mf8mtm5q/logs
wandb: Agent Starting Run: oyzwnhch with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_024105-oyzwnhch
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run robust-sweep-198
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/oyzwnhch
[INFO][2024-03-22 02:41:10,785][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:41:10,786][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:41:10,787][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellSVD',
 None][0m
[INFO][2024-03-22 02:41:10,794][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:41:11,793][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:41:12,127][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:41:12,129][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:41:14,439][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:41:14,439][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:41:14,439][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:41:14,440][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:41:14,440][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:41:14,449][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:41:14,449][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:41:14,449][dance][wrapped_func] Took 0:00:03.655620 to load and process data.
[WARNING][2024-03-22 02:41:14,464][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:41:14,812][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:41:14,831][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:41:16,237][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[INFO][2024-03-22 02:41:58,729][dance.CellSVD][__call__] Generating cell SVD features (466, 6835) (k=361)
[INFO][2024-03-22 02:41:58,730][dance.CellSVD][__call__] Top 10 explained variances: [0.00689668 0.02234696 0.02059854 0.01822234 0.01479021 0.01366367
 0.01051491 0.00885325 0.00701965 0.00633633]
[INFO][2024-03-22 02:41:58,730][dance.CellSVD][__call__] Total explained variance: 89.76%
[INFO][2024-03-22 02:41:58,732][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:41:58,732][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.43939
wandb:  test_acc 0.31159
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run robust-sweep-198 at: https://wandb.ai/xzy11632/dance-dev/runs/oyzwnhch
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_024105-oyzwnhch/logs
wandb: Agent Starting Run: po4imrb9 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_024213-po4imrb9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run playful-sweep-199
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/po4imrb9
[INFO][2024-03-22 02:42:18,443][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:42:18,443][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:42:18,445][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 02:42:18,451][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:42:19,353][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:42:19,529][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:42:19,532][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:42:20,597][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:42:20,597][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:42:20,597][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:42:20,597][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:42:20,597][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:42:20,603][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:42:20,604][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:42:20,604][dance][wrapped_func] Took 0:00:02.153204 to load and process data.
[WARNING][2024-03-22 02:42:20,616][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:42:20,616][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 02:42:20,624][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:42:20,717][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:42:20,740][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:42:20,850][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 02:42:54,718][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:42:54,719][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 02:42:56,635][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:42:56,636][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.022 MB of 0.026 MB uploadedwandb: / 0.022 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.77273
wandb:  test_acc 0.65217
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run playful-sweep-199 at: https://wandb.ai/xzy11632/dance-dev/runs/po4imrb9
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_024213-po4imrb9/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: modoh7l3 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_024327-modoh7l3
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run flowing-sweep-200
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/modoh7l3
[INFO][2024-03-22 02:43:32,705][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:43:32,705][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:43:32,707][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 02:43:32,714][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:43:33,078][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:43:33,219][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:43:33,222][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:43:33,406][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:43:33,407][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:43:33,407][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:43:33,407][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:43:33,407][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:43:33,409][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:43:33,409][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:43:33,409][dance][wrapped_func] Took 0:00:00.695022 to load and process data.
[WARNING][2024-03-22 02:43:33,421][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:43:33,491][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:43:33,508][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:43:33,599][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[INFO][2024-03-22 02:44:20,418][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 6835) (k=208)
[INFO][2024-03-22 02:44:20,419][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.05%
[INFO][2024-03-22 02:44:20,485][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:44:20,494][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.68182
wandb:  test_acc 0.21739
wandb: train_acc 0.77099
wandb: 
wandb: üöÄ View run flowing-sweep-200 at: https://wandb.ai/xzy11632/dance-dev/runs/modoh7l3
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_024327-modoh7l3/logs
wandb: Agent Starting Run: e514rruv with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_024437-e514rruv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run usual-sweep-201
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/e514rruv
[INFO][2024-03-22 02:44:57,864][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:44:57,864][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:44:57,866][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 02:44:57,894][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:44:59,023][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:44:59,327][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:44:59,331][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:45:05,339][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:45:05,340][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:45:05,340][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:45:05,340][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:45:05,340][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:45:05,341][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:45:05,342][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:45:05,342][dance][wrapped_func] Took 0:00:07.448247 to load and process data.
[WARNING][2024-03-22 02:45:05,355][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:45:05,432][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:45:05,451][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:45:05,545][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[INFO][2024-03-22 02:46:16,526][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 6835) (k=209)
[INFO][2024-03-22 02:46:16,532][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.06%
[INFO][2024-03-22 02:46:16,564][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:46:16,564][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.62121
wandb:  test_acc 0.15942
wandb: train_acc 0.72137
wandb: 
wandb: üöÄ View run usual-sweep-201 at: https://wandb.ai/xzy11632/dance-dev/runs/e514rruv
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_024437-e514rruv/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 79kiwfzv with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_024638-79kiwfzv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run frosty-sweep-202
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/79kiwfzv
[INFO][2024-03-22 02:46:44,217][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:46:44,217][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:46:44,219][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellPCA',
 None][0m
[INFO][2024-03-22 02:46:44,228][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:46:45,978][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:46:46,128][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:46:46,131][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:46:48,759][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:46:48,760][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:46:48,761][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:46:48,761][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:46:48,762][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:46:48,780][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:46:48,782][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:46:48,782][dance][wrapped_func] Took 0:00:04.554348 to load and process data.
[WARNING][2024-03-22 02:46:48,817][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:46:49,021][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:46:49,059][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:46:49,706][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[INFO][2024-03-22 02:47:18,973][dance.CellPCA][__call__] Generating cell PCA features (466, 2296) (k=325)
[INFO][2024-03-22 02:47:18,974][dance.CellPCA][__call__] Top 10 explained variances: [0.0379055  0.02924827 0.02408514 0.02132398 0.01583711 0.00993171
 0.00917971 0.00825346 0.00692788 0.00678761]
[INFO][2024-03-22 02:47:18,974][dance.CellPCA][__call__] Total explained variance: 90.07%
[INFO][2024-03-22 02:47:18,975][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:47:18,976][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.017 MB of 0.025 MB uploadedwandb: | 0.017 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.65152
wandb:  test_acc 0.17391
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run frosty-sweep-202 at: https://wandb.ai/xzy11632/dance-dev/runs/79kiwfzv
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_024638-79kiwfzv/logs
wandb: Agent Starting Run: d3ffqf8e with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_024733-d3ffqf8e
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run iconic-sweep-203
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/d3ffqf8e
[INFO][2024-03-22 02:47:40,197][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:47:40,197][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:47:40,198][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellSVD',
 None][0m
[INFO][2024-03-22 02:47:40,216][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:47:42,390][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:47:42,562][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:47:42,566][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:47:44,409][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:47:44,409][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:47:44,409][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:47:44,409][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:47:44,410][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:47:44,423][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:47:44,424][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:47:44,424][dance][wrapped_func] Took 0:00:04.208628 to load and process data.
[WARNING][2024-03-22 02:47:44,440][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:47:44,710][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:47:44,728][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:47:45,090][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[INFO][2024-03-22 02:49:00,291][dance.CellSVD][__call__] Generating cell SVD features (466, 2296) (k=326)
[INFO][2024-03-22 02:49:00,292][dance.CellSVD][__call__] Top 10 explained variances: [0.01596527 0.0328958  0.02780004 0.02120864 0.01933991 0.01469328
 0.00983881 0.00917859 0.00824456 0.00692697]
[INFO][2024-03-22 02:49:00,292][dance.CellSVD][__call__] Total explained variance: 89.92%
[INFO][2024-03-22 02:49:00,302][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:49:00,302][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.45455
wandb:  test_acc 0.21739
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run iconic-sweep-203 at: https://wandb.ai/xzy11632/dance-dev/runs/d3ffqf8e
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_024733-d3ffqf8e/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: qbzh2b1u with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_024923-qbzh2b1u
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run desert-sweep-204
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/qbzh2b1u
[INFO][2024-03-22 02:49:30,312][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:49:30,313][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:49:30,314][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 02:49:30,323][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:49:31,545][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:49:31,680][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:49:31,683][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:49:33,421][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:49:33,422][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:49:33,422][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:49:33,422][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:49:33,422][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:49:33,433][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:49:33,433][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:49:33,434][dance][wrapped_func] Took 0:00:03.111244 to load and process data.
[WARNING][2024-03-22 02:49:33,444][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:49:33,445][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 02:49:33,451][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:49:33,684][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:49:33,703][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:49:34,124][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 02:49:56,089][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:49:56,089][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 02:49:56,156][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:49:56,156][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.013 MB of 0.026 MB uploadedwandb: - 0.013 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.78788
wandb:  test_acc 0.55797
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run desert-sweep-204 at: https://wandb.ai/xzy11632/dance-dev/runs/qbzh2b1u
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_024923-qbzh2b1u/logs
wandb: Agent Starting Run: 056p85ud with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_025007-056p85ud
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sparkling-sweep-205
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/056p85ud
[INFO][2024-03-22 02:50:14,421][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:50:14,422][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:50:14,424][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 02:50:14,443][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:50:15,518][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:50:16,113][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:50:16,121][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:50:17,858][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:50:17,858][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:50:17,858][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:50:17,858][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:50:17,858][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:50:17,861][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:50:17,861][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:50:17,862][dance][wrapped_func] Took 0:00:03.419051 to load and process data.
[WARNING][2024-03-22 02:50:17,880][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:50:17,965][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:50:17,984][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:50:18,657][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[INFO][2024-03-22 02:50:45,983][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2296) (k=196)
[INFO][2024-03-22 02:50:45,984][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.15%
[INFO][2024-03-22 02:50:46,029][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:50:46,035][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.021 MB uploadedwandb: \ 0.012 MB of 0.021 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.71212
wandb:  test_acc 0.27536
wandb: train_acc 0.83969
wandb: 
wandb: üöÄ View run sparkling-sweep-205 at: https://wandb.ai/xzy11632/dance-dev/runs/056p85ud
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_025007-056p85ud/logs
wandb: Agent Starting Run: l2kbv50f with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_025101-l2kbv50f
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glamorous-sweep-206
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/l2kbv50f
[INFO][2024-03-22 02:51:08,535][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:51:08,536][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:51:08,537][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 02:51:08,545][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:51:09,855][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:51:10,005][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:51:10,008][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:51:11,253][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:51:11,257][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:51:11,259][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:51:11,260][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:51:11,261][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:51:11,273][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:51:11,279][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:51:11,280][dance][wrapped_func] Took 0:00:02.735112 to load and process data.
[WARNING][2024-03-22 02:51:11,337][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:51:11,619][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:51:11,663][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:51:11,881][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[INFO][2024-03-22 02:51:43,002][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2296) (k=196)
[INFO][2024-03-22 02:51:43,002][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.99%
[INFO][2024-03-22 02:51:43,049][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:51:43,050][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.018 MB of 0.025 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.62121
wandb:  test_acc 0.15942
wandb: train_acc 0.76718
wandb: 
wandb: üöÄ View run glamorous-sweep-206 at: https://wandb.ai/xzy11632/dance-dev/runs/l2kbv50f
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_025101-l2kbv50f/logs
wandb: Agent Starting Run: dgu7fnsz with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_025156-dgu7fnsz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run graceful-sweep-207
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/dgu7fnsz
[INFO][2024-03-22 02:52:03,567][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:52:03,568][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:52:03,570][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'CellPCA',
 None][0m
[INFO][2024-03-22 02:52:03,580][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:52:05,783][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:52:06,056][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:52:06,060][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:52:09,803][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:52:09,804][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:52:09,804][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:52:09,804][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:52:09,804][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:52:09,816][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:52:09,817][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:52:09,817][dance][wrapped_func] Took 0:00:06.237598 to load and process data.
[WARNING][2024-03-22 02:52:09,845][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:52:10,041][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:52:10,063][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:52:10,524][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-22 02:52:51,449][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=306)
[INFO][2024-03-22 02:52:51,451][dance.CellPCA][__call__] Top 10 explained variances: [0.04497409 0.03510593 0.02455817 0.02267311 0.02109618 0.01747309
 0.00956023 0.00910447 0.00861497 0.00702199]
[INFO][2024-03-22 02:52:51,451][dance.CellPCA][__call__] Total explained variance: 90.04%
[INFO][2024-03-22 02:52:51,452][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:52:51,452][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.57576
wandb:  test_acc 0.18116
wandb: train_acc 0.98855
wandb: 
wandb: üöÄ View run graceful-sweep-207 at: https://wandb.ai/xzy11632/dance-dev/runs/dgu7fnsz
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_025156-dgu7fnsz/logs
wandb: Agent Starting Run: qhknb7y0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_025305-qhknb7y0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run golden-sweep-208
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/qhknb7y0
[INFO][2024-03-22 02:53:13,274][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:53:13,274][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:53:13,276][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'CellSVD',
 None][0m
[INFO][2024-03-22 02:53:13,297][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:53:13,770][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:53:14,022][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:53:14,026][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:53:16,990][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:53:16,991][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:53:16,991][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:53:16,991][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:53:16,991][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:53:17,002][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:53:17,002][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:53:17,003][dance][wrapped_func] Took 0:00:03.706221 to load and process data.
[WARNING][2024-03-22 02:53:17,030][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:53:17,404][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:53:17,433][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:53:17,815][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-22 02:54:31,269][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=307)
[INFO][2024-03-22 02:54:31,271][dance.CellSVD][__call__] Top 10 explained variances: [0.02617697 0.03712542 0.0279174  0.0227546  0.02230513 0.01920128
 0.01441949 0.00946147 0.00905585 0.00860561]
[INFO][2024-03-22 02:54:31,271][dance.CellSVD][__call__] Total explained variance: 89.92%
[INFO][2024-03-22 02:54:31,273][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:54:31,273][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.021 MB of 0.025 MB uploadedwandb: \ 0.021 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.63636
wandb:  test_acc 0.21014
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run golden-sweep-208 at: https://wandb.ai/xzy11632/dance-dev/runs/qhknb7y0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_025305-qhknb7y0/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: g727cgc8 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_025455-g727cgc8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glowing-sweep-209
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/g727cgc8
[INFO][2024-03-22 02:55:03,821][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:55:03,821][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:55:03,823][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 02:55:03,831][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:55:04,829][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:55:05,390][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:55:05,398][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:55:09,026][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:55:09,027][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:55:09,027][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:55:09,027][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:55:09,027][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:55:09,054][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:55:09,055][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:55:09,055][dance][wrapped_func] Took 0:00:05.224536 to load and process data.
[WARNING][2024-03-22 02:55:09,082][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:55:09,082][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 02:55:09,115][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:55:10,064][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:55:10,107][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:55:11,068][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 02:55:51,571][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:55:51,573][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 02:55:51,676][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:55:51,693][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.77273
wandb:  test_acc 0.5942
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run glowing-sweep-209 at: https://wandb.ai/xzy11632/dance-dev/runs/g727cgc8
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_025455-g727cgc8/logs
wandb: Agent Starting Run: 13mirlf2 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_025608-13mirlf2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run atomic-sweep-210
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/13mirlf2
[INFO][2024-03-22 02:56:17,450][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:56:17,451][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:56:17,452][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 02:56:17,480][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:56:18,568][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:56:18,805][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:56:18,809][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:56:21,978][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:56:21,979][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:56:21,979][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:56:21,980][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:56:21,987][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:56:22,011][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:56:22,012][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:56:22,012][dance][wrapped_func] Took 0:00:04.531983 to load and process data.
[WARNING][2024-03-22 02:56:22,033][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:56:22,861][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:56:22,919][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:56:23,550][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-22 02:56:59,241][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=188)
[INFO][2024-03-22 02:56:59,246][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.18%
[INFO][2024-03-22 02:56:59,291][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:56:59,299][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.013 MB uploadedwandb: / 0.012 MB of 0.013 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.69697
wandb:  test_acc 0.28261
wandb: train_acc 0.82061
wandb: 
wandb: üöÄ View run atomic-sweep-210 at: https://wandb.ai/xzy11632/dance-dev/runs/13mirlf2
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_025608-13mirlf2/logs
wandb: Agent Starting Run: gwk15bio with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScTransform
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_025713-gwk15bio
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run olive-sweep-211
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/gwk15bio
[INFO][2024-03-22 02:57:21,411][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:57:21,412][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:57:21,414][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 02:57:21,430][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:57:24,216][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:57:24,617][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:57:24,621][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:57:27,408][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:57:27,408][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:57:27,408][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:57:27,408][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:57:27,409][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:57:27,419][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:57:27,420][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:57:27,420][dance][wrapped_func] Took 0:00:05.990954 to load and process data.
[WARNING][2024-03-22 02:57:27,443][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:57:28,225][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:57:28,262][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:57:29,093][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-22 02:58:53,439][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=188)
[INFO][2024-03-22 02:58:53,453][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.03%
[INFO][2024-03-22 02:58:53,497][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:58:53,497][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.63636
wandb:  test_acc 0.2029
wandb: train_acc 0.77863
wandb: 
wandb: üöÄ View run olive-sweep-211 at: https://wandb.ai/xzy11632/dance-dev/runs/gwk15bio
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_025713-gwk15bio/logs
wandb: Agent Starting Run: ag31ediw with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_025911-ag31ediw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run bumbling-sweep-212
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ag31ediw
[INFO][2024-03-22 02:59:18,059][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 02:59:18,059][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 02:59:18,061][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'FilterGenesNumberPlaceHolder',
 'CellPCA',
 None][0m
[INFO][2024-03-22 02:59:18,072][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 02:59:19,623][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 02:59:19,843][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 02:59:19,846][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 02:59:23,095][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 02:59:23,096][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 02:59:23,096][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 02:59:23,096][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 02:59:23,096][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 02:59:23,104][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 02:59:23,105][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 02:59:23,105][dance][wrapped_func] Took 0:00:05.032982 to load and process data.
[WARNING][2024-03-22 02:59:23,114][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 02:59:23,122][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:59:23,210][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:59:23,232][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 02:59:23,818][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 02:59:24,978][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 02:59:40,474][dance.CellPCA][__call__] Generating cell PCA features (466, 21314) (k=324)
[INFO][2024-03-22 02:59:40,479][dance.CellPCA][__call__] Top 10 explained variances: [0.12963216 0.01239662 0.00985826 0.00650997 0.00610035 0.00596492
 0.00579493 0.00568509 0.00540011 0.00529227]
[INFO][2024-03-22 02:59:40,479][dance.CellPCA][__call__] Total explained variance: 90.04%
[INFO][2024-03-22 02:59:40,484][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 02:59:40,484][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.5229
wandb: 
wandb: üöÄ View run bumbling-sweep-212 at: https://wandb.ai/xzy11632/dance-dev/runs/ag31ediw
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_025911-ag31ediw/logs
wandb: Agent Starting Run: dfrswaqe with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_025958-dfrswaqe
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run vital-sweep-213
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/dfrswaqe
[INFO][2024-03-22 03:00:04,998][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:00:04,998][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:00:05,000][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'FilterGenesNumberPlaceHolder',
 'CellSVD',
 None][0m
[INFO][2024-03-22 03:00:05,017][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:00:06,393][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:00:06,594][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:00:06,598][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:00:09,772][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:00:09,772][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:00:09,773][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:00:09,773][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:00:09,773][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:00:09,782][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:00:09,783][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:00:09,783][dance][wrapped_func] Took 0:00:04.766945 to load and process data.
[WARNING][2024-03-22 03:00:09,793][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:00:09,805][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:00:10,139][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:00:10,158][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:00:10,481][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:00:11,356][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:00:50,787][dance.CellSVD][__call__] Generating cell SVD features (466, 21314) (k=325)
[INFO][2024-03-22 03:00:50,788][dance.CellSVD][__call__] Top 10 explained variances: [0.12957996 0.00982959 0.00674468 0.00948886 0.00611339 0.00597399
 0.00596491 0.00579461 0.00567812 0.00532595]
[INFO][2024-03-22 03:00:50,788][dance.CellSVD][__call__] Total explained variance: 89.87%
[INFO][2024-03-22 03:00:50,790][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:00:50,790][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.012 MB of 0.018 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.50763
wandb: 
wandb: üöÄ View run vital-sweep-213 at: https://wandb.ai/xzy11632/dance-dev/runs/dfrswaqe
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_025958-dfrswaqe/logs
wandb: Agent Starting Run: pyiqmvff with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_030105-pyiqmvff
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run northern-sweep-214
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/pyiqmvff
[INFO][2024-03-22 03:01:12,945][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:01:12,945][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:01:12,947][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'FilterGenesNumberPlaceHolder',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 03:01:12,955][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:01:16,473][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:01:16,833][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:01:16,844][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:01:20,422][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:01:20,422][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:01:20,423][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:01:20,423][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:01:20,423][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:01:20,440][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:01:20,442][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:01:20,442][dance][wrapped_func] Took 0:00:07.487548 to load and process data.
[WARNING][2024-03-22 03:01:20,457][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:01:20,458][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:01:20,458][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 03:01:20,470][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:01:21,456][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:01:21,487][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:01:22,584][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:01:24,828][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:01:24,830][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:01:24,830][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 03:01:34,503][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:01:34,504][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.60606
wandb:  test_acc 0.14493
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run northern-sweep-214 at: https://wandb.ai/xzy11632/dance-dev/runs/pyiqmvff
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_030105-pyiqmvff/logs
wandb: Agent Starting Run: 5eae4xh2 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_030155-5eae4xh2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run solar-sweep-215
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/5eae4xh2
[INFO][2024-03-22 03:02:02,043][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:02:02,044][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:02:02,045][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 03:02:02,060][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:02:04,647][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:02:05,074][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:02:05,090][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:02:08,854][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:02:08,854][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:02:08,854][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:02:08,854][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:02:08,855][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:02:08,870][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:02:08,871][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:02:08,871][dance][wrapped_func] Took 0:00:06.812193 to load and process data.
[WARNING][2024-03-22 03:02:08,884][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:02:08,892][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:02:09,539][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:02:09,558][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:02:10,627][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:02:12,464][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:02:16,153][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 21314) (k=183)
[INFO][2024-03-22 03:02:16,156][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.06%
[INFO][2024-03-22 03:02:16,899][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:02:16,900][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.018 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run solar-sweep-215 at: https://wandb.ai/xzy11632/dance-dev/runs/5eae4xh2
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_030155-5eae4xh2/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 3pe6gosu with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesNumberPlaceHolder
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_030239-3pe6gosu
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run clean-sweep-216
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/3pe6gosu
[INFO][2024-03-22 03:02:45,197][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:02:45,198][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:02:45,199][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'FilterGenesNumberPlaceHolder',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 03:02:45,209][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:02:46,001][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:02:46,148][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:02:46,151][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:02:47,799][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:02:47,799][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:02:47,799][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:02:47,799][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:02:47,799][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:02:47,812][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:02:47,812][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:02:47,813][dance][wrapped_func] Took 0:00:02.604236 to load and process data.
[WARNING][2024-03-22 03:02:47,824][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:02:47,831][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:02:48,274][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:02:48,289][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:02:48,596][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:02:49,442][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:02:59,299][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 21314) (k=183)
[INFO][2024-03-22 03:02:59,300][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.89%
[INFO][2024-03-22 03:02:59,650][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:02:59,651][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.021 MB uploadedwandb: / 0.012 MB of 0.021 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run clean-sweep-216 at: https://wandb.ai/xzy11632/dance-dev/runs/3pe6gosu
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_030239-3pe6gosu/logs
wandb: Agent Starting Run: xczch5f4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_030314-xczch5f4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run pleasant-sweep-217
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/xczch5f4
[INFO][2024-03-22 03:03:21,387][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:03:21,387][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:03:21,389][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'FilterGenesRegression',
 'CellPCA',
 None][0m
[INFO][2024-03-22 03:03:21,398][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:03:23,342][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:03:23,536][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:03:23,540][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:03:25,546][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:03:25,547][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:03:25,547][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:03:25,547][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:03:25,547][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:03:25,552][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:03:25,553][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:03:25,553][dance][wrapped_func] Took 0:00:04.156012 to load and process data.
[WARNING][2024-03-22 03:03:25,569][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:03:25,702][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:03:25,743][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:03:25,946][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:03:26,634][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-22 03:03:56,447][dance.CellPCA][__call__] Generating cell PCA features (466, 21314) (k=324)
[INFO][2024-03-22 03:03:56,448][dance.CellPCA][__call__] Top 10 explained variances: [0.12963216 0.01239662 0.00985826 0.00650997 0.00610035 0.00596492
 0.00579493 0.00568509 0.00540011 0.00529227]
[INFO][2024-03-22 03:03:56,448][dance.CellPCA][__call__] Total explained variance: 90.04%
[INFO][2024-03-22 03:03:56,451][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:03:56,451][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.5229
wandb: 
wandb: üöÄ View run pleasant-sweep-217 at: https://wandb.ai/xzy11632/dance-dev/runs/xczch5f4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_030314-xczch5f4/logs
wandb: Agent Starting Run: raya4174 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_030409-raya4174
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run peachy-sweep-218
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/raya4174
[INFO][2024-03-22 03:04:15,616][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:04:15,617][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:04:15,618][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'FilterGenesRegression',
 'CellSVD',
 None][0m
[INFO][2024-03-22 03:04:15,638][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:04:16,948][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:04:17,121][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:04:17,124][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:04:19,626][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:04:19,629][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:04:19,629][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:04:19,629][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:04:19,630][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:04:19,655][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:04:19,656][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:04:19,657][dance][wrapped_func] Took 0:00:04.018752 to load and process data.
[WARNING][2024-03-22 03:04:19,688][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:04:19,839][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:04:19,887][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:04:20,681][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:04:21,979][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-22 03:05:32,178][dance.CellSVD][__call__] Generating cell SVD features (466, 21314) (k=325)
[INFO][2024-03-22 03:05:32,179][dance.CellSVD][__call__] Top 10 explained variances: [0.12957996 0.00982959 0.00674468 0.00948886 0.00611339 0.00597399
 0.00596491 0.00579461 0.00567812 0.00532595]
[INFO][2024-03-22 03:05:32,179][dance.CellSVD][__call__] Total explained variance: 89.87%
[INFO][2024-03-22 03:05:32,181][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:05:32,181][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.50763
wandb: 
wandb: üöÄ View run peachy-sweep-218 at: https://wandb.ai/xzy11632/dance-dev/runs/raya4174
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_030409-raya4174/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: tl86jlfo with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_030556-tl86jlfo
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run different-sweep-219
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/tl86jlfo
[INFO][2024-03-22 03:06:03,185][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:06:03,185][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:06:03,187][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'FilterGenesRegression',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 03:06:03,194][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:06:04,240][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:06:04,495][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:06:04,505][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:06:07,735][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:06:07,736][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:06:07,736][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:06:07,736][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:06:07,736][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:06:07,774][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:06:07,775][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:06:07,775][dance][wrapped_func] Took 0:00:04.581810 to load and process data.
[WARNING][2024-03-22 03:06:07,795][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:06:07,795][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 03:06:07,803][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:06:07,890][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:06:07,912][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:06:08,534][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:06:10,227][dance][_filter_enclasc] Start generating cell features using EnClaSC
[WARNING][2024-03-22 03:06:10,310][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:06:10,310][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 03:06:18,808][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:06:18,809][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.60606
wandb:  test_acc 0.14493
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run different-sweep-219 at: https://wandb.ai/xzy11632/dance-dev/runs/tl86jlfo
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_030556-tl86jlfo/logs
wandb: Agent Starting Run: mu0ob0ro with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_030634-mu0ob0ro
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glad-sweep-220
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/mu0ob0ro
[INFO][2024-03-22 03:06:40,944][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:06:40,945][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:06:40,946][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 03:06:40,968][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:06:41,871][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:06:42,070][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:06:42,074][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:06:44,216][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:06:44,216][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:06:44,217][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:06:44,217][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:06:44,217][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:06:44,224][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:06:44,225][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:06:44,225][dance][wrapped_func] Took 0:00:03.257332 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 03:06:44,245][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:06:44,335][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:06:44,369][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:06:44,597][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:06:46,555][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-22 03:06:50,619][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 21314) (k=183)
[INFO][2024-03-22 03:06:50,628][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.06%
[INFO][2024-03-22 03:06:51,815][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:06:51,816][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run glad-sweep-220 at: https://wandb.ai/xzy11632/dance-dev/runs/mu0ob0ro
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_030634-mu0ob0ro/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: aatnda5k with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesRegression
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_030713-aatnda5k
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dulcet-sweep-221
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/aatnda5k
[INFO][2024-03-22 03:07:20,487][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:07:20,487][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:07:20,489][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 03:07:20,502][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:07:22,161][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:07:22,441][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:07:22,445][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:07:24,887][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:07:24,887][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:07:24,887][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:07:24,888][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:07:24,888][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:07:24,897][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:07:24,898][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:07:24,898][dance][wrapped_func] Took 0:00:04.395790 to load and process data.
[WARNING][2024-03-22 03:07:24,917][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:07:25,019][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:07:25,049][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:07:25,504][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:07:26,922][dance][_filter_enclasc] Start generating cell features using EnClaSC
[INFO][2024-03-22 03:08:20,097][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 21314) (k=183)
[INFO][2024-03-22 03:08:20,098][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.89%
[INFO][2024-03-22 03:08:21,083][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:08:21,083][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.018 MB uploadedwandb: | 0.012 MB of 0.018 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run dulcet-sweep-221 at: https://wandb.ai/xzy11632/dance-dev/runs/aatnda5k
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_030713-aatnda5k/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: bjwnom2g with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: - Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_030845-bjwnom2g
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run noble-sweep-222
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/bjwnom2g
[INFO][2024-03-22 03:08:56,555][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:08:56,555][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:08:56,557][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder', 'ScaleFeature', 'FilterGenesTopK', 'CellPCA', None][0m
[INFO][2024-03-22 03:08:56,582][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:08:58,560][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:08:58,827][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:08:58,831][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:09:01,552][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:09:01,553][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:09:01,554][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:09:01,554][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:09:01,554][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:09:01,563][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:09:01,564][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:09:01,564][dance][wrapped_func] Took 0:00:04.982881 to load and process data.
[WARNING][2024-03-22 03:09:01,584][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:09:01,663][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:09:01,685][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:09:01,930][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[INFO][2024-03-22 03:09:14,031][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=273)
[INFO][2024-03-22 03:09:14,031][dance.CellPCA][__call__] Top 10 explained variances: [0.18763506 0.01687237 0.01127613 0.00824903 0.00726683 0.00700421
 0.00639412 0.00617347 0.00613042 0.00600407]
[INFO][2024-03-22 03:09:14,032][dance.CellPCA][__call__] Total explained variance: 90.09%
[INFO][2024-03-22 03:09:14,032][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:09:14,032][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.018 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.39695
wandb: 
wandb: üöÄ View run noble-sweep-222 at: https://wandb.ai/xzy11632/dance-dev/runs/bjwnom2g
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_030845-bjwnom2g/logs
wandb: Agent Starting Run: 5dy1n0vx with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_030929-5dy1n0vx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rich-sweep-223
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/5dy1n0vx
[INFO][2024-03-22 03:09:35,764][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:09:35,764][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:09:35,766][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder', 'ScaleFeature', 'FilterGenesTopK', 'CellSVD', None][0m
[INFO][2024-03-22 03:09:35,779][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:09:37,903][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:09:38,128][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:09:38,132][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:09:40,700][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:09:40,701][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:09:40,701][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:09:40,701][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:09:40,701][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:09:40,709][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:09:40,709][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:09:40,710][dance][wrapped_func] Took 0:00:04.937259 to load and process data.
[WARNING][2024-03-22 03:09:40,732][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:09:40,870][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:09:40,916][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:09:41,267][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[INFO][2024-03-22 03:11:23,111][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=273)
[INFO][2024-03-22 03:11:23,112][dance.CellSVD][__call__] Top 10 explained variances: [0.1876312  0.01686738 0.01127027 0.00824199 0.00725938 0.00699835
 0.00638682 0.00616329 0.00612435 0.00599736]
[INFO][2024-03-22 03:11:23,113][dance.CellSVD][__call__] Total explained variance: 89.89%
[INFO][2024-03-22 03:11:23,115][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:11:23,115][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run rich-sweep-223 at: https://wandb.ai/xzy11632/dance-dev/runs/5dy1n0vx
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_030929-5dy1n0vx/logs
wandb: Agent Starting Run: 14ujqgg2 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_031142-14ujqgg2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dainty-sweep-224
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/14ujqgg2
[INFO][2024-03-22 03:11:48,174][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:11:48,175][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:11:48,177][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'FilterGenesTopK',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 03:11:48,196][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:11:50,529][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:11:50,839][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:11:50,871][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:11:53,903][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:11:53,908][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:11:53,908][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:11:53,909][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:11:53,909][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:11:53,915][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:11:53,915][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:11:53,915][dance][wrapped_func] Took 0:00:05.732419 to load and process data.
[WARNING][2024-03-22 03:11:53,926][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:11:53,927][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 03:11:53,933][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:11:54,010][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:11:54,034][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:11:54,603][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:11:55,439][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:11:55,440][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 03:11:55,476][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:11:55,477][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.017 MB of 0.026 MB uploadedwandb: \ 0.017 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.56107
wandb: 
wandb: üöÄ View run dainty-sweep-224 at: https://wandb.ai/xzy11632/dance-dev/runs/14ujqgg2
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_031142-14ujqgg2/logs
wandb: Agent Starting Run: 98wvfsdw with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_031213-98wvfsdw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dashing-sweep-225
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/98wvfsdw
[INFO][2024-03-22 03:12:19,363][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:12:19,363][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:12:19,365][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 03:12:19,374][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:12:20,433][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:12:20,595][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:12:20,598][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:12:22,748][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:12:22,748][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:12:22,749][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:12:22,749][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:12:22,749][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:12:22,754][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:12:22,755][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:12:22,755][dance][wrapped_func] Took 0:00:03.381226 to load and process data.
[WARNING][2024-03-22 03:12:22,769][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:12:22,840][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:12:22,857][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:12:23,231][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[INFO][2024-03-22 03:12:24,456][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=159)
[INFO][2024-03-22 03:12:24,457][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.06%
[INFO][2024-03-22 03:12:24,486][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:12:24,489][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.021 MB uploadedwandb: / 0.012 MB of 0.021 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run dashing-sweep-225 at: https://wandb.ai/xzy11632/dance-dev/runs/98wvfsdw
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_031213-98wvfsdw/logs
wandb: Agent Starting Run: pwop6bh3 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: FilterGenesTopK
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_031235-pwop6bh3
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run youthful-sweep-226
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/pwop6bh3
[INFO][2024-03-22 03:12:40,106][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:12:40,106][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:12:40,108][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 03:12:40,115][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:12:40,516][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:12:40,708][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:12:40,712][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:12:41,226][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:12:41,227][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:12:41,227][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:12:41,227][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:12:41,227][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:12:41,229][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:12:41,229][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:12:41,229][dance][wrapped_func] Took 0:00:01.114802 to load and process data.
[WARNING][2024-03-22 03:12:41,246][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:12:41,322][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:12:41,340][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:12:41,427][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[INFO][2024-03-22 03:12:49,107][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=157)
[INFO][2024-03-22 03:12:49,110][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.55%
[INFO][2024-03-22 03:12:49,121][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:12:49,122][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.018 MB uploadedwandb: / 0.018 MB of 0.025 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run youthful-sweep-226 at: https://wandb.ai/xzy11632/dance-dev/runs/pwop6bh3
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_031235-pwop6bh3/logs
wandb: Agent Starting Run: tidvb6ht with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_031301-tidvb6ht
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run daily-sweep-227
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/tidvb6ht
[INFO][2024-03-22 03:13:06,880][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:13:06,880][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:13:06,882][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellPCA',
 None][0m
[INFO][2024-03-22 03:13:06,896][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:13:08,311][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:13:08,547][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:13:08,550][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:13:10,716][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:13:10,716][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:13:10,716][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:13:10,717][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:13:10,717][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:13:10,730][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:13:10,731][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:13:10,731][dance][wrapped_func] Took 0:00:03.835159 to load and process data.
[WARNING][2024-03-22 03:13:10,753][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:13:11,030][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:13:11,047][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:13:11,470][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run daily-sweep-227 at: https://wandb.ai/xzy11632/dance-dev/runs/tidvb6ht
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_031301-tidvb6ht/logs
wandb: ERROR Run tidvb6ht errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/cell_feature.py", line 142, in __call__
wandb: ERROR     cell_feat = pca.fit_transform(feat)
wandb: ERROR                 ^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
wandb: ERROR     data_to_wrap = f(self, X, *args, **kwargs)
wandb: ERROR                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 1152, in wrapper
wandb: ERROR     return fit_method(estimator, *args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 460, in fit_transform
wandb: ERROR     U, S, Vt = self._fit(X)
wandb: ERROR                ^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 483, in _fit
wandb: ERROR     X = self._validate_data(
wandb: ERROR         ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 605, in _validate_data
wandb: ERROR     out = check_array(X, input_name="X", **check_params)
wandb: ERROR           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/validation.py", line 976, in check_array
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: Found array with 0 feature(s) (shape=(466, 0)) while a minimum of 1 is required by PCA.
wandb: ERROR 
wandb: Agent Starting Run: 42rkyk44 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_031328-42rkyk44
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run giddy-sweep-228
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/42rkyk44
[INFO][2024-03-22 03:13:34,344][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:13:34,345][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:13:34,347][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'CellSVD',
 None][0m
[INFO][2024-03-22 03:13:34,355][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:13:35,657][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:13:35,798][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:13:35,801][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:13:38,089][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:13:38,090][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:13:38,090][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:13:38,090][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:13:38,090][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:13:38,100][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:13:38,101][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:13:38,101][dance][wrapped_func] Took 0:00:03.746429 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 03:13:38,117][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:13:38,652][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:13:38,675][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:13:39,317][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run giddy-sweep-228 at: https://wandb.ai/xzy11632/dance-dev/runs/42rkyk44
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_031328-42rkyk44/logs
wandb: ERROR Run 42rkyk44 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/cell_feature.py", line 179, in __call__
wandb: ERROR     svd.fit_transform(feat)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
wandb: ERROR     data_to_wrap = f(self, X, *args, **kwargs)
wandb: ERROR                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 1145, in wrapper
wandb: ERROR     estimator._validate_params()
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 638, in _validate_params
wandb: ERROR     validate_parameter_constraints(
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_param_validation.py", line 96, in validate_parameter_constraints
wandb: ERROR     raise InvalidParameterError(
wandb: ERROR sklearn.utils._param_validation.InvalidParameterError: The 'n_components' parameter of TruncatedSVD must be an int in the range [1, inf). Got -1 instead.
wandb: ERROR 
wandb: Agent Starting Run: yxj88xhi with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_031355-yxj88xhi
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run classic-sweep-229
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/yxj88xhi
[INFO][2024-03-22 03:14:00,588][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:14:00,592][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:14:00,594][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 03:14:00,601][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:14:02,265][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:14:02,410][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:14:02,412][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:14:05,258][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:14:05,258][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:14:05,258][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:14:05,258][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:14:05,259][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:14:05,272][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:14:05,272][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:14:05,272][dance][wrapped_func] Took 0:00:04.671688 to load and process data.
[WARNING][2024-03-22 03:14:05,284][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:14:05,284][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 03:14:05,292][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:14:05,647][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:14:05,666][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:14:06,040][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:14:07,703][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:14:07,703][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 03:14:07,703][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:14:07,703][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/torch/nn/init.py:405: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/torch/nn/modules/linear.py:114: UserWarning: An output with one or more elements was resized since it had shape [128, 2000], which does not match the required output shape [2000]. This behavior is deprecated, and in a future PyTorch release outputs will not be resized unless they have zero elements. You can explicitly reuse an out tensor t by resizing it, inplace, to zero elements with t.resize_(0). (Triggered internally at ../aten/src/ATen/native/Resize.cpp:26.)
  return F.linear(input, self.weight, self.bias)
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: üöÄ View run classic-sweep-229 at: https://wandb.ai/xzy11632/dance-dev/runs/yxj88xhi
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_031355-yxj88xhi/logs
wandb: ERROR Run yxj88xhi errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 83, in evaluate_pipeline
wandb: ERROR     model.fit(x_train, y_train, seed=args.seed, lr=args.learning_rate, num_epochs=args.num_epochs,
wandb: ERROR   File "/home/zyxing/dance/dance/modules/single_modality/cell_type_annotation/actinn.py", line 162, in fit
wandb: ERROR     batch_cost = self.compute_loss(self.model(batch_x), batch_y)
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/modules/single_modality/cell_type_annotation/actinn.py", line 87, in compute_loss
wandb: ERROR     loss = nn.NLLLoss()(log_prob, y)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
wandb: ERROR     return forward_call(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/torch/nn/modules/loss.py", line 216, in forward
wandb: ERROR     return F.nll_loss(input, target, weight=self.weight, ignore_index=self.ignore_index, reduction=self.reduction)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/torch/nn/functional.py", line 2704, in nll_loss
wandb: ERROR     return torch._C._nn.nll_loss_nd(input, target, weight, _Reduction.get_enum(reduction), ignore_index)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR RuntimeError: size mismatch (got input: [8], target: [128])
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: m1qv0fby with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_031427-m1qv0fby
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run vivid-sweep-230
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/m1qv0fby
[INFO][2024-03-22 03:14:32,124][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:14:32,138][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:14:32,141][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 03:14:32,147][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:14:33,210][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:14:33,410][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:14:33,413][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:14:35,587][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:14:35,588][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:14:35,588][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:14:35,588][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:14:35,588][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:14:35,600][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:14:35,600][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:14:35,600][dance][wrapped_func] Took 0:00:03.453801 to load and process data.
[WARNING][2024-03-22 03:14:35,618][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:14:35,857][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:14:35,874][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:14:36,358][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run vivid-sweep-230 at: https://wandb.ai/xzy11632/dance-dev/runs/m1qv0fby
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_031427-m1qv0fby/logs
wandb: ERROR Run m1qv0fby errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/cell_feature.py", line 50, in __call__
wandb: ERROR     gene_feat = gene_pca.fit_transform(feat.T)  # decompose into gene features
wandb: ERROR                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
wandb: ERROR     data_to_wrap = f(self, X, *args, **kwargs)
wandb: ERROR                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 1152, in wrapper
wandb: ERROR     return fit_method(estimator, *args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 460, in fit_transform
wandb: ERROR     U, S, Vt = self._fit(X)
wandb: ERROR                ^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 483, in _fit
wandb: ERROR     X = self._validate_data(
wandb: ERROR         ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 605, in _validate_data
wandb: ERROR     out = check_array(X, input_name="X", **check_params)
wandb: ERROR           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/validation.py", line 967, in check_array
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: Found array with 0 sample(s) (shape=(0, 262)) while a minimum of 1 is required by PCA.
wandb: ERROR 
wandb: Agent Starting Run: 58qn4s5b with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_031451-58qn4s5b
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run graceful-sweep-231
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/58qn4s5b
[INFO][2024-03-22 03:14:56,497][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:14:56,503][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:14:56,505][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 03:14:56,511][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:14:57,650][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:14:57,789][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:14:57,791][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:15:00,378][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:15:00,378][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:15:00,378][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:15:00,379][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:15:00,379][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:15:00,392][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:15:00,393][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:15:00,393][dance][wrapped_func] Took 0:00:03.882147 to load and process data.
[WARNING][2024-03-22 03:15:00,413][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:15:00,651][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:15:00,669][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:15:01,164][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.017 MB of 0.024 MB uploadedwandb: | 0.017 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run graceful-sweep-231 at: https://wandb.ai/xzy11632/dance-dev/runs/58qn4s5b
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_031451-58qn4s5b/logs
wandb: ERROR Run 58qn4s5b errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cta_actinn/main.py", line 74, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/cell_feature.py", line 97, in __call__
wandb: ERROR     svd.fit_transform(feat)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
wandb: ERROR     data_to_wrap = f(self, X, *args, **kwargs)
wandb: ERROR                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 1145, in wrapper
wandb: ERROR     estimator._validate_params()
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 638, in _validate_params
wandb: ERROR     validate_parameter_constraints(
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_param_validation.py", line 96, in validate_parameter_constraints
wandb: ERROR     raise InvalidParameterError(
wandb: ERROR sklearn.utils._param_validation.InvalidParameterError: The 'n_components' parameter of TruncatedSVD must be an int in the range [1, inf). Got -1 instead.
wandb: ERROR 
wandb: Agent Starting Run: vx5hbk51 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_031517-vx5hbk51
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run apricot-sweep-232
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/vx5hbk51
[INFO][2024-03-22 03:15:25,337][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:15:25,337][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:15:25,339][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellPCA',
 None][0m
[INFO][2024-03-22 03:15:25,345][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:15:26,730][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:15:26,892][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:15:26,894][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:15:29,215][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:15:29,215][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:15:29,216][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:15:29,216][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:15:29,216][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:15:29,230][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:15:29,230][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:15:29,230][dance][wrapped_func] Took 0:00:03.885054 to load and process data.
[WARNING][2024-03-22 03:15:29,246][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:15:29,629][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:15:29,650][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:15:29,843][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[INFO][2024-03-22 03:15:37,724][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=281)
[INFO][2024-03-22 03:15:37,725][dance.CellPCA][__call__] Top 10 explained variances: [0.02660689 0.00988498 0.00888929 0.00870028 0.00849265 0.00836059
 0.00821814 0.00795827 0.00785627 0.00769365]
[INFO][2024-03-22 03:15:37,725][dance.CellPCA][__call__] Total explained variance: 90.02%
[INFO][2024-03-22 03:15:37,732][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:15:37,732][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run apricot-sweep-232 at: https://wandb.ai/xzy11632/dance-dev/runs/vx5hbk51
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_031517-vx5hbk51/logs
wandb: Agent Starting Run: ou2fqigb with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_031553-ou2fqigb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run magic-sweep-233
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ou2fqigb
[INFO][2024-03-22 03:16:01,125][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:16:01,133][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:16:01,134][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'CellSVD',
 None][0m
[INFO][2024-03-22 03:16:01,152][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:16:06,780][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:16:07,453][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:16:07,460][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:16:14,925][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:16:14,926][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:16:14,926][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:16:14,926][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:16:14,926][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:16:14,941][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:16:14,942][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:16:14,942][dance][wrapped_func] Took 0:00:13.790795 to load and process data.
[WARNING][2024-03-22 03:16:14,965][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:16:16,969][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:16:17,005][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:16:19,608][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[INFO][2024-03-22 03:16:52,167][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=282)
[INFO][2024-03-22 03:16:52,169][dance.CellSVD][__call__] Top 10 explained variances: [0.02613588 0.00623101 0.00951328 0.00870897 0.00847692 0.00849127
 0.00833757 0.00807551 0.00794428 0.00771567]
[INFO][2024-03-22 03:16:52,169][dance.CellSVD][__call__] Total explained variance: 89.92%
[INFO][2024-03-22 03:16:52,183][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:16:52,183][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run magic-sweep-233 at: https://wandb.ai/xzy11632/dance-dev/runs/ou2fqigb
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_031553-ou2fqigb/logs
wandb: Agent Starting Run: igaf42s7 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_031708-igaf42s7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run visionary-sweep-234
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/igaf42s7
[INFO][2024-03-22 03:17:22,833][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:17:22,833][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:17:22,835][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 03:17:22,876][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:17:28,051][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:17:28,623][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:17:28,649][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:17:35,611][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:17:35,612][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:17:35,612][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:17:35,612][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:17:35,612][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:17:35,622][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:17:35,622][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:17:35,623][dance][wrapped_func] Took 0:00:12.746510 to load and process data.
[WARNING][2024-03-22 03:17:35,632][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:17:35,632][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 03:17:35,637][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:17:36,325][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:17:36,349][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:17:36,932][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:17:39,266][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:17:39,266][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 03:17:39,312][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:17:39,312][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run visionary-sweep-234 at: https://wandb.ai/xzy11632/dance-dev/runs/igaf42s7
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_031708-igaf42s7/logs
wandb: Agent Starting Run: v5pef9z3 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_031750-v5pef9z3
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run deep-sweep-235
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/v5pef9z3
[INFO][2024-03-22 03:18:08,289][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:18:08,289][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:18:08,291][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 03:18:08,339][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:18:12,424][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:18:14,263][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:18:14,281][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:18:23,940][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:18:23,952][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:18:23,952][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:18:23,952][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:18:23,953][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:18:24,026][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:18:24,027][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:18:24,027][dance][wrapped_func] Took 0:00:15.687665 to load and process data.
[WARNING][2024-03-22 03:18:24,070][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:18:24,748][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:18:24,871][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:18:26,928][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[INFO][2024-03-22 03:18:28,612][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=164)
[INFO][2024-03-22 03:18:28,614][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.17%
[INFO][2024-03-22 03:18:28,664][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:18:28,668][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run deep-sweep-235 at: https://wandb.ai/xzy11632/dance-dev/runs/v5pef9z3
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_031750-v5pef9z3/logs
wandb: Agent Starting Run: f0gc5brw with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_031843-f0gc5brw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run worldly-sweep-236
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/f0gc5brw
[INFO][2024-03-22 03:19:00,505][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:19:00,505][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:19:00,506][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 03:19:00,540][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:19:04,770][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:19:05,952][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:19:06,002][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:19:13,912][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:19:13,928][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:19:13,929][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:19:13,929][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:19:13,930][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:19:13,966][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:19:13,986][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:19:13,989][dance][wrapped_func] Took 0:00:13.449577 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 03:19:14,034][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:19:14,746][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:19:14,772][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:19:15,462][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[INFO][2024-03-22 03:19:29,845][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=164)
[INFO][2024-03-22 03:19:29,856][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.03%
[INFO][2024-03-22 03:19:29,886][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:19:29,887][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.013 MB uploadedwandb: \ 0.012 MB of 0.013 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run worldly-sweep-236 at: https://wandb.ai/xzy11632/dance-dev/runs/f0gc5brw
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_031843-f0gc5brw/logs
wandb: Agent Starting Run: k37zs6kk with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellPCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_031943-k37zs6kk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run earthy-sweep-237
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/k37zs6kk
[INFO][2024-03-22 03:19:48,317][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:19:48,317][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:19:48,319][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'CellPCA',
 None][0m
[INFO][2024-03-22 03:19:48,326][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:19:49,593][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:19:49,755][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:19:49,758][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:19:51,618][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:19:51,618][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:19:51,618][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:19:51,618][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:19:51,619][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:19:51,625][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:19:51,625][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:19:51,625][dance][wrapped_func] Took 0:00:03.299988 to load and process data.
[WARNING][2024-03-22 03:19:51,639][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:19:51,708][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:19:51,726][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:19:51,962][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-22 03:19:55,560][dance.CellPCA][__call__] Generating cell PCA features (466, 2208) (k=290)
[INFO][2024-03-22 03:19:55,561][dance.CellPCA][__call__] Top 10 explained variances: [0.07225805 0.01279961 0.01253712 0.00897847 0.00877077 0.00780795
 0.00735008 0.00714814 0.00687133 0.00671322]
[INFO][2024-03-22 03:19:55,562][dance.CellPCA][__call__] Total explained variance: 90.02%
[INFO][2024-03-22 03:19:55,563][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:19:55,563][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run earthy-sweep-237 at: https://wandb.ai/xzy11632/dance-dev/runs/k37zs6kk
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_031943-k37zs6kk/logs
wandb: Agent Starting Run: 4qz4ww12 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: CellSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_032008-4qz4ww12
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ruby-sweep-238
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/4qz4ww12
[INFO][2024-03-22 03:20:14,101][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:20:14,101][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:20:14,103][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'CellSVD',
 None][0m
[INFO][2024-03-22 03:20:14,110][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:20:15,561][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:20:15,848][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:20:15,851][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:20:18,409][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:20:18,409][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:20:18,409][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:20:18,409][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:20:18,409][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:20:18,419][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:20:18,420][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:20:18,420][dance][wrapped_func] Took 0:00:04.310253 to load and process data.
[WARNING][2024-03-22 03:20:18,435][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:20:18,830][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:20:18,846][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:20:19,096][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-22 03:20:39,478][dance.CellSVD][__call__] Generating cell SVD features (466, 2208) (k=291)
[INFO][2024-03-22 03:20:39,479][dance.CellSVD][__call__] Top 10 explained variances: [0.0721445  0.01060494 0.01236983 0.00786215 0.00897471 0.00827991
 0.00762222 0.00729574 0.00712331 0.00676495]
[INFO][2024-03-22 03:20:39,479][dance.CellSVD][__call__] Total explained variance: 89.93%
[INFO][2024-03-22 03:20:39,480][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:20:39,480][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.017 MB of 0.025 MB uploadedwandb: | 0.017 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run ruby-sweep-238 at: https://wandb.ai/xzy11632/dance-dev/runs/4qz4ww12
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_032008-4qz4ww12/logs
wandb: Agent Starting Run: 2ndvd2nh with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: FeatureCellPlaceHolder
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_032054-2ndvd2nh
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run astral-sweep-239
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/2ndvd2nh
[INFO][2024-03-22 03:20:59,659][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:20:59,660][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:20:59,661][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'FeatureCellPlaceHolder',
 None][0m
[INFO][2024-03-22 03:20:59,677][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:21:00,804][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:21:00,980][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:21:00,983][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:21:02,572][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:21:02,573][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:21:02,573][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:21:02,573][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:21:02,573][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:21:02,586][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:21:02,587][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:21:02,587][dance][wrapped_func] Took 0:00:02.909864 to load and process data.
[WARNING][2024-03-22 03:21:02,603][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:21:02,604][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[WARNING][2024-03-22 03:21:02,612][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:21:02,815][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:21:02,831][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:21:03,085][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 03:21:05,765][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:21:05,766][dance.FeatureCellPlaceHolder][__init__] n_components in FeatureCellPlaceHolder is used to make the parameters consistent and will not have any actual effect.
[INFO][2024-03-22 03:21:05,799][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:21:05,799][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.4084
wandb: 
wandb: üöÄ View run astral-sweep-239 at: https://wandb.ai/xzy11632/dance-dev/runs/2ndvd2nh
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_032054-2ndvd2nh/logs
wandb: Agent Starting Run: rg0ny4w4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_032120-rg0ny4w4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run happy-sweep-240
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/rg0ny4w4
[INFO][2024-03-22 03:21:25,823][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:21:25,823][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:21:25,825][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None][0m
[INFO][2024-03-22 03:21:25,832][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:21:27,393][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:21:27,814][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:21:27,818][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:21:29,855][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:21:29,856][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:21:29,856][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:21:29,856][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:21:29,856][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:21:29,866][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:21:29,867][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:21:29,867][dance][wrapped_func] Took 0:00:04.035734 to load and process data.
[WARNING][2024-03-22 03:21:29,882][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:21:30,300][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:21:30,317][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:21:30,491][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-22 03:21:35,014][dance.WeightedFeaturePCA][__call__] Decomposing train features (262, 2208) (k=170)
[INFO][2024-03-22 03:21:35,014][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.13%
[INFO][2024-03-22 03:21:35,025][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:21:35,026][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run happy-sweep-240 at: https://wandb.ai/xzy11632/dance-dev/runs/rg0ny4w4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_032120-rg0ny4w4/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: ysdbi8tx with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.normalize: ScaleFeature
wandb: 	pipeline.2.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.3.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_032156-ysdbi8tx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run jumping-sweep-241
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/ek4kaw79
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ysdbi8tx
[INFO][2024-03-22 03:22:01,951][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:22:01,951][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-22 03:22:01,954][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None][0m
[INFO][2024-03-22 03:22:01,963][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:22:03,628][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:22:03,777][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:22:03,780][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:22:06,410][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:22:06,410][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:22:06,411][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:22:06,411][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:22:06,411][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:22:06,422][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:22:06,422][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:22:06,422][dance][wrapped_func] Took 0:00:04.458876 to load and process data.
[WARNING][2024-03-22 03:22:06,435][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:22:06,935][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
[WARNING][2024-03-22 03:22:06,956][dance.FilterGenesScanpy][__call__] n_counts will be added to the data
[WARNING][2024-03-22 03:22:07,570][dance.FilterGenesScanpy][__call__] n_cells will be added to the data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-22 03:22:20,799][dance.WeightedFeatureSVD][__call__] Decomposing train features (262, 2208) (k=170)
[INFO][2024-03-22 03:22:20,817][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.00%
[INFO][2024-03-22 03:22:20,840][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:22:20,841][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.30303
wandb:  test_acc 0.06522
wandb: train_acc 0.38931
wandb: 
wandb: üöÄ View run jumping-sweep-241 at: https://wandb.ai/xzy11632/dance-dev/runs/ysdbi8tx
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_032156-ysdbi8tx/logs
wandb: Sweep Agent: Waiting for job.
wandb: Sweep Agent: Exiting.
[INFO][2024-03-22 03:22:54,956][dance][wandb_sweep] Sweep config:
{'entity': 'xzy11632',
 'method': 'bayes',
 'metric': {'goal': 'maximize', 'name': 'acc'},
 'parameters': {'params.1.Log1P.base': {'max': 10.0, 'min': 1.0}},
 'project': 'dance-dev'}
[INFO][2024-03-22 03:22:55,589][dance][wandb_sweep] [94m

	[*] Sweep ID: 1zctuqgy
[0m
[INFO][2024-03-22 03:22:55,589][dance][wandb_sweep_agent] Spawning agent: sweep_id='1zctuqgy', entity='xzy11632', project='dance-dev', count=20
wandb: Agent Starting Run: ukr2b6rn with config:
wandb: 	params.1.Log1P.base: 3.714415231148644
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_032258-ukr2b6rn
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run denim-sweep-1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/1zctuqgy
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ukr2b6rn
[INFO][2024-03-22 03:23:03,918][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:23:03,920][dance][_sanitize_params] Params plan:
[92m[None, {'base': 3.714415231148644}, None, None, None][0m
[INFO][2024-03-22 03:23:03,925][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:23:04,524][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:23:04,690][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:23:04,693][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:23:04,884][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:23:04,884][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:23:04,884][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:23:04,884][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:23:04,884][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:23:04,886][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:23:04,886][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:23:04,887][dance][wrapped_func] Took 0:00:00.962217 to load and process data.
[WARNING][2024-03-22 03:23:04,894][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:23:04,895][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:23:04,895][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:23:04,895][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:23:04,912][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:23:04,913][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 03:23:04,928][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:23:04,928][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:23:13,144][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:23:13,145][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.015 MB of 0.026 MB uploadedwandb: - 0.015 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.86364
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run denim-sweep-1 at: https://wandb.ai/xzy11632/dance-dev/runs/ukr2b6rn
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_032258-ukr2b6rn/logs
wandb: Agent Starting Run: 3zg3n1bq with config:
wandb: 	params.1.Log1P.base: 9.269179480724771
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_032325-3zg3n1bq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run honest-sweep-2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/1zctuqgy
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/3zg3n1bq
[INFO][2024-03-22 03:23:31,276][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:23:31,278][dance][_sanitize_params] Params plan:
[92m[None, {'base': 9.269179480724771}, None, None, None][0m
[INFO][2024-03-22 03:23:31,283][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:23:31,646][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:23:31,777][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:23:31,780][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:23:31,952][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:23:31,952][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:23:31,952][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:23:31,952][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:23:31,952][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:23:31,953][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:23:31,954][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:23:31,954][dance][wrapped_func] Took 0:00:00.671131 to load and process data.
[WARNING][2024-03-22 03:23:31,960][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:23:31,960][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:23:31,960][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:23:31,961][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:23:31,976][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:23:31,977][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 03:23:31,988][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:23:31,988][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:23:39,155][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:23:39,155][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.017 MB of 0.026 MB uploadedwandb: \ 0.017 MB of 0.026 MB uploadedwandb: | 0.017 MB of 0.026 MB uploadedwandb: / 0.017 MB of 0.026 MB uploadedwandb: - 0.017 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run honest-sweep-2 at: https://wandb.ai/xzy11632/dance-dev/runs/3zg3n1bq
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_032325-3zg3n1bq/logs
wandb: Agent Starting Run: sx6ptffo with config:
wandb: 	params.1.Log1P.base: 3.81388344824665
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_032402-sx6ptffo
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run generous-sweep-3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/1zctuqgy
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/sx6ptffo
[INFO][2024-03-22 03:24:11,108][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:24:11,110][dance][_sanitize_params] Params plan:
[92m[None, {'base': 3.81388344824665}, None, None, None][0m
[INFO][2024-03-22 03:24:11,116][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:24:11,865][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:24:12,196][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:24:12,206][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:24:12,495][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:24:12,496][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:24:12,496][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:24:12,496][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:24:12,497][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:24:12,499][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:24:12,499][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:24:12,500][dance][wrapped_func] Took 0:00:01.384133 to load and process data.
[WARNING][2024-03-22 03:24:12,509][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:24:12,510][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:24:12,510][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:24:12,511][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:24:12,529][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:24:12,530][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 03:24:12,547][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:24:12,548][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:24:24,163][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:24:24,164][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run generous-sweep-3 at: https://wandb.ai/xzy11632/dance-dev/runs/sx6ptffo
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_032402-sx6ptffo/logs
wandb: Agent Starting Run: sqiklvca with config:
wandb: 	params.1.Log1P.base: 3.5106318748921455
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_032439-sqiklvca
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run comic-sweep-4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/1zctuqgy
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/sqiklvca
[INFO][2024-03-22 03:24:44,146][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:24:44,148][dance][_sanitize_params] Params plan:
[92m[None, {'base': 3.5106318748921455}, None, None, None][0m
[INFO][2024-03-22 03:24:44,164][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:24:44,578][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:24:45,141][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:24:45,151][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:24:45,681][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:24:45,690][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:24:45,690][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:24:45,691][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:24:45,691][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:24:45,693][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:24:45,696][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:24:45,696][dance][wrapped_func] Took 0:00:01.532949 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellPCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: CellSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1
    max_counts: 134732
    min_cells: 1
    max_cells: 401
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2208
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Create sweep with ID: 1zctuqgy
Sweep URL: https://wandb.ai/xzy11632/dance-dev/sweeps/1zctuqgy
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 3.714415231148644
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 9.269179480724771
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 3.81388344824665
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 03:24:45,721][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:24:45,730][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:24:45,731][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:24:45,732][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:24:45,870][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:24:45,885][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 03:24:45,983][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:24:45,984][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:24:50,196][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:24:50,198][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.86364
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run comic-sweep-4 at: https://wandb.ai/xzy11632/dance-dev/runs/sqiklvca
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_032439-sqiklvca/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 2nblwg7r with config:
wandb: 	params.1.Log1P.base: 8.551458679678692
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_032525-2nblwg7r
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run stoic-sweep-5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/1zctuqgy
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/2nblwg7r
[INFO][2024-03-22 03:25:30,879][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:25:30,880][dance][_sanitize_params] Params plan:
[92m[None, {'base': 8.551458679678692}, None, None, None][0m
[INFO][2024-03-22 03:25:30,886][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:25:31,224][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:25:31,373][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:25:31,377][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:25:31,555][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:25:31,555][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:25:31,556][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:25:31,556][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:25:31,556][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:25:31,557][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:25:31,558][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:25:31,558][dance][wrapped_func] Took 0:00:00.672966 to load and process data.
[WARNING][2024-03-22 03:25:31,565][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:25:31,565][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:25:31,565][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:25:31,566][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:25:31,584][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:25:31,585][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 03:25:31,599][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:25:31,600][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:25:32,916][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:25:32,917][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.86364
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run stoic-sweep-5 at: https://wandb.ai/xzy11632/dance-dev/runs/2nblwg7r
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_032525-2nblwg7r/logs
wandb: Agent Starting Run: 5ad4cltz with config:
wandb: 	params.1.Log1P.base: 3.2956998128659594
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_032550-5ad4cltz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run earthy-sweep-6
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/1zctuqgy
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/5ad4cltz
[INFO][2024-03-22 03:26:11,691][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:26:11,693][dance][_sanitize_params] Params plan:
[92m[None, {'base': 3.2956998128659594}, None, None, None][0m
[INFO][2024-03-22 03:26:11,714][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:26:13,655][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:26:14,291][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:26:14,375][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:26:15,094][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:26:15,094][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:26:15,094][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:26:15,095][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:26:15,095][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:26:15,097][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:26:15,098][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:26:15,098][dance][wrapped_func] Took 0:00:03.383990 to load and process data.
[WARNING][2024-03-22 03:26:15,108][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:26:15,108][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:26:15,109][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:26:15,109][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:26:15,129][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:26:15,130][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 03:26:15,148][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:26:15,149][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:26:18,086][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:26:18,086][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.86364
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run earthy-sweep-6 at: https://wandb.ai/xzy11632/dance-dev/runs/5ad4cltz
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_032550-5ad4cltz/logs
wandb: Agent Starting Run: d11bbqyk with config:
wandb: 	params.1.Log1P.base: 6.184978180971216
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_032634-d11bbqyk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run effortless-sweep-7
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/1zctuqgy
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/d11bbqyk
[INFO][2024-03-22 03:26:52,035][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:26:52,038][dance][_sanitize_params] Params plan:
[92m[None, {'base': 6.184978180971216}, None, None, None][0m
[INFO][2024-03-22 03:26:52,043][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:26:52,725][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:26:53,081][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:26:53,085][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:26:53,599][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:26:53,599][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:26:53,600][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:26:53,600][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:26:53,600][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:26:53,604][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:26:53,620][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:26:53,620][dance][wrapped_func] Took 0:00:01.577772 to load and process data.
[WARNING][2024-03-22 03:26:53,629][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:26:53,629][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:26:53,630][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:26:53,630][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:26:53,660][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:26:53,661][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 03:26:53,676][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:26:53,677][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:26:58,254][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:26:58,254][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.86364
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run effortless-sweep-7 at: https://wandb.ai/xzy11632/dance-dev/runs/d11bbqyk
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_032634-d11bbqyk/logs
wandb: Agent Starting Run: qpwv6c5m with config:
wandb: 	params.1.Log1P.base: 6.121387606494441
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_032723-qpwv6c5m
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run silver-sweep-8
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/1zctuqgy
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/qpwv6c5m
[INFO][2024-03-22 03:27:28,437][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:27:28,445][dance][_sanitize_params] Params plan:
[92m[None, {'base': 6.121387606494441}, None, None, None][0m
[INFO][2024-03-22 03:27:28,451][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:27:28,767][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:27:28,983][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:27:28,986][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:27:29,165][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:27:29,165][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:27:29,165][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:27:29,165][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:27:29,165][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:27:29,167][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:27:29,167][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:27:29,167][dance][wrapped_func] Took 0:00:00.715739 to load and process data.
[WARNING][2024-03-22 03:27:29,173][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:27:29,173][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:27:29,173][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:27:29,174][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:27:29,189][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:27:29,189][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 03:27:29,202][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:27:29,202][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:27:34,056][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:27:34,056][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.012 MB of 0.018 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.87879
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run silver-sweep-8 at: https://wandb.ai/xzy11632/dance-dev/runs/qpwv6c5m
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_032723-qpwv6c5m/logs
wandb: Agent Starting Run: 98i3z443 with config:
wandb: 	params.1.Log1P.base: 1.7715237361032172
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_032750-98i3z443
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run revived-sweep-9
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/1zctuqgy
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/98i3z443
[INFO][2024-03-22 03:27:57,873][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:27:57,875][dance][_sanitize_params] Params plan:
[92m[None, {'base': 1.7715237361032172}, None, None, None][0m
[INFO][2024-03-22 03:27:57,882][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:27:58,459][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:27:58,639][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:27:58,643][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:27:58,872][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:27:58,873][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:27:58,873][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:27:58,874][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:27:58,874][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:27:58,876][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:27:58,878][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:27:58,879][dance][wrapped_func] Took 0:00:00.997562 to load and process data.
[WARNING][2024-03-22 03:27:58,889][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:27:58,889][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:27:58,890][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:27:58,890][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:27:58,926][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:27:58,927][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 03:27:58,950][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:27:58,951][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:28:03,432][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:28:03,433][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.83333
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run revived-sweep-9 at: https://wandb.ai/xzy11632/dance-dev/runs/98i3z443
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_032750-98i3z443/logs
wandb: Agent Starting Run: f82um7yz with config:
wandb: 	params.1.Log1P.base: 1.0202257317811054
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_032821-f82um7yz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run iconic-sweep-10
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/1zctuqgy
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/f82um7yz
[INFO][2024-03-22 03:28:28,357][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:28:28,358][dance][_sanitize_params] Params plan:
[92m[None, {'base': 1.0202257317811054}, None, None, None][0m
[INFO][2024-03-22 03:28:28,363][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:28:28,887][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:28:29,073][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:28:29,077][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:28:29,278][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:28:29,278][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:28:29,279][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:28:29,279][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:28:29,279][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:28:29,281][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:28:29,282][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:28:29,282][dance][wrapped_func] Took 0:00:00.918539 to load and process data.
[WARNING][2024-03-22 03:28:29,292][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:28:29,292][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:28:29,293][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:28:29,293][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:28:29,318][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:28:29,319][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 03:28:29,334][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:28:29,335][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:28:34,836][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:28:34,836][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.75758
wandb:  test_acc 0.78986
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run iconic-sweep-10 at: https://wandb.ai/xzy11632/dance-dev/runs/f82um7yz
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_032821-f82um7yz/logs
wandb: Agent Starting Run: 6f6h8r6u with config:
wandb: 	params.1.Log1P.base: 4.422816588155083
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_032854-6f6h8r6u
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run efficient-sweep-11
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/1zctuqgy
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/6f6h8r6u
[INFO][2024-03-22 03:29:00,790][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:29:00,792][dance][_sanitize_params] Params plan:
[92m[None, {'base': 4.422816588155083}, None, None, None][0m
[INFO][2024-03-22 03:29:00,797][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:29:01,424][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:29:01,771][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:29:01,779][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:29:02,119][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:29:02,119][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:29:02,119][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:29:02,119][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:29:02,119][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:29:02,121][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:29:02,121][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:29:02,122][dance][wrapped_func] Took 0:00:01.324880 to load and process data.
[WARNING][2024-03-22 03:29:02,147][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:29:02,147][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:29:02,148][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:29:02,148][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:29:02,173][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:29:02,174][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 03:29:02,189][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:29:02,190][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:29:08,007][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:29:08,008][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.86364
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run efficient-sweep-11 at: https://wandb.ai/xzy11632/dance-dev/runs/6f6h8r6u
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_032854-6f6h8r6u/logs
wandb: Agent Starting Run: 4p3eohxz with config:
wandb: 	params.1.Log1P.base: 7.4243340388868
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_032925-4p3eohxz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run summer-sweep-12
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/1zctuqgy
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/4p3eohxz
[INFO][2024-03-22 03:29:32,710][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:29:32,712][dance][_sanitize_params] Params plan:
[92m[None, {'base': 7.4243340388868}, None, None, None][0m
[INFO][2024-03-22 03:29:32,731][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:29:33,316][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:29:33,707][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:29:33,711][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:29:33,942][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:29:33,942][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:29:33,942][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:29:33,942][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:29:33,943][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:29:33,945][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:29:33,946][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:29:33,946][dance][wrapped_func] Took 0:00:01.216046 to load and process data.
[WARNING][2024-03-22 03:29:33,956][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:29:33,957][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:29:33,957][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:29:33,958][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:29:33,982][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:29:33,983][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 03:29:33,998][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:29:33,998][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:29:39,170][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:29:39,170][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.017 MB of 0.026 MB uploadedwandb: - 0.017 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run summer-sweep-12 at: https://wandb.ai/xzy11632/dance-dev/runs/4p3eohxz
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_032925-4p3eohxz/logs
wandb: Agent Starting Run: 5kf042nw with config:
wandb: 	params.1.Log1P.base: 5.259616496101411
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_032958-5kf042nw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fallen-sweep-13
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/1zctuqgy
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/5kf042nw
[INFO][2024-03-22 03:30:04,439][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:30:04,441][dance][_sanitize_params] Params plan:
[92m[None, {'base': 5.259616496101411}, None, None, None][0m
[INFO][2024-03-22 03:30:04,446][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:30:04,981][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:30:05,186][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:30:05,191][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:30:05,408][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:30:05,409][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:30:05,409][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:30:05,409][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:30:05,410][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:30:05,413][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:30:05,414][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:30:05,414][dance][wrapped_func] Took 0:00:00.968882 to load and process data.
[WARNING][2024-03-22 03:30:05,426][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:30:05,432][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:30:05,442][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:30:05,442][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:30:05,462][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:30:05,464][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 03:30:05,479][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:30:05,480][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:30:09,901][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:30:09,902][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.87879
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run fallen-sweep-13 at: https://wandb.ai/xzy11632/dance-dev/runs/5kf042nw
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_032958-5kf042nw/logs
wandb: Agent Starting Run: 5je11sch with config:
wandb: 	params.1.Log1P.base: 9.087941669373755
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_033024-5je11sch
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run chocolate-sweep-14
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/1zctuqgy
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/5je11sch
[INFO][2024-03-22 03:30:29,851][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:30:29,854][dance][_sanitize_params] Params plan:
[92m[None, {'base': 9.087941669373755}, None, None, None][0m
[INFO][2024-03-22 03:30:29,859][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:30:30,276][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:30:30,434][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:30:30,438][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:30:30,625][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:30:30,626][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:30:30,626][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:30:30,626][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:30:30,626][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:30:30,628][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:30:30,629][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:30:30,629][dance][wrapped_func] Took 0:00:00.769764 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 3.5106318748921455
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 8.551458679678692
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 3.2956998128659594
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 6.184978180971216
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 6.121387606494441
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 1.7715237361032172
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 1.0202257317811054
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 4.422816588155083
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 7.4243340388868
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 5.259616496101411
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 03:30:30,637][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:30:30,637][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:30:30,638][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:30:30,638][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:30:30,655][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:30:30,656][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 03:30:30,670][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:30:30,671][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:30:37,682][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:30:37,683][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run chocolate-sweep-14 at: https://wandb.ai/xzy11632/dance-dev/runs/5je11sch
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_033024-5je11sch/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 0d4i4j0j with config:
wandb: 	params.1.Log1P.base: 2.2175848576586303
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_033100-0d4i4j0j
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fast-sweep-15
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/1zctuqgy
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/0d4i4j0j
[INFO][2024-03-22 03:31:06,314][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:31:06,317][dance][_sanitize_params] Params plan:
[92m[None, {'base': 2.2175848576586303}, None, None, None][0m
[INFO][2024-03-22 03:31:06,322][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:31:06,704][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:31:06,865][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:31:06,869][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:31:07,045][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:31:07,045][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:31:07,045][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:31:07,045][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:31:07,046][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:31:07,047][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:31:07,048][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:31:07,048][dance][wrapped_func] Took 0:00:00.725859 to load and process data.
[WARNING][2024-03-22 03:31:07,055][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:31:07,056][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:31:07,056][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:31:07,056][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:31:07,073][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:31:07,074][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 03:31:07,088][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:31:07,089][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:31:13,830][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:31:13,830][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.83333
wandb:  test_acc 0.7971
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run fast-sweep-15 at: https://wandb.ai/xzy11632/dance-dev/runs/0d4i4j0j
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_033100-0d4i4j0j/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: d8i0iuez with config:
wandb: 	params.1.Log1P.base: 6.645527910398513
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_033139-d8i0iuez
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fragrant-sweep-16
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/1zctuqgy
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/d8i0iuez
[INFO][2024-03-22 03:31:44,477][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:31:44,479][dance][_sanitize_params] Params plan:
[92m[None, {'base': 6.645527910398513}, None, None, None][0m
[INFO][2024-03-22 03:31:44,485][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:31:44,891][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:31:45,055][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:31:45,058][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:31:45,243][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:31:45,243][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:31:45,243][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:31:45,243][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:31:45,244][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:31:45,245][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:31:45,246][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:31:45,246][dance][wrapped_func] Took 0:00:00.761961 to load and process data.
[WARNING][2024-03-22 03:31:45,254][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:31:45,254][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:31:45,255][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:31:45,255][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:31:45,272][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:31:45,273][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 03:31:45,287][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:31:45,288][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:31:46,655][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:31:46,656][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run fragrant-sweep-16 at: https://wandb.ai/xzy11632/dance-dev/runs/d8i0iuez
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_033139-d8i0iuez/logs
wandb: Agent Starting Run: j2ym4ppg with config:
wandb: 	params.1.Log1P.base: 7.807727964992942
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_033201-j2ym4ppg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dandy-sweep-17
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/1zctuqgy
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/j2ym4ppg
[INFO][2024-03-22 03:32:07,056][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:32:07,059][dance][_sanitize_params] Params plan:
[92m[None, {'base': 7.807727964992942}, None, None, None][0m
[INFO][2024-03-22 03:32:07,065][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:32:07,455][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:32:07,593][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:32:07,595][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:32:07,831][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:32:07,831][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:32:07,831][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:32:07,832][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:32:07,832][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:32:07,834][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:32:07,834][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:32:07,834][dance][wrapped_func] Took 0:00:00.769315 to load and process data.
[WARNING][2024-03-22 03:32:07,841][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:32:07,841][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:32:07,841][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:32:07,841][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:32:07,856][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:32:07,857][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 03:32:07,869][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:32:07,869][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:32:16,316][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:32:16,316][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run dandy-sweep-17 at: https://wandb.ai/xzy11632/dance-dev/runs/j2ym4ppg
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_033201-j2ym4ppg/logs
wandb: Agent Starting Run: tov99vn4 with config:
wandb: 	params.1.Log1P.base: 5.853487340756915
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_033228-tov99vn4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run tough-sweep-18
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/1zctuqgy
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/tov99vn4
[INFO][2024-03-22 03:32:33,677][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:32:33,680][dance][_sanitize_params] Params plan:
[92m[None, {'base': 5.853487340756915}, None, None, None][0m
[INFO][2024-03-22 03:32:33,692][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:32:35,132][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:32:35,432][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:32:35,436][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:32:38,620][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:32:38,621][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:32:38,621][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:32:38,621][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:32:38,621][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:32:38,632][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:32:38,633][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:32:38,633][dance][wrapped_func] Took 0:00:04.947887 to load and process data.
[WARNING][2024-03-22 03:32:38,641][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:32:38,642][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:32:38,642][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:32:38,643][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:32:38,659][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:32:38,660][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 03:32:38,671][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:32:38,672][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:32:49,511][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:32:49,512][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.87879
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run tough-sweep-18 at: https://wandb.ai/xzy11632/dance-dev/runs/tov99vn4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_033228-tov99vn4/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: tl7octib with config:
wandb: 	params.1.Log1P.base: 6.982992405286596
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_033313-tl7octib
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run misunderstood-sweep-19
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/1zctuqgy
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/tl7octib
[INFO][2024-03-22 03:33:25,051][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:33:25,054][dance][_sanitize_params] Params plan:
[92m[None, {'base': 6.982992405286596}, None, None, None][0m
[INFO][2024-03-22 03:33:25,060][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:33:26,233][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:33:26,445][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:33:26,449][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:33:29,805][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:33:29,805][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:33:29,805][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:33:29,805][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:33:29,805][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:33:29,811][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:33:29,812][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:33:29,812][dance][wrapped_func] Took 0:00:04.752126 to load and process data.
[WARNING][2024-03-22 03:33:29,821][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:33:29,822][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:33:29,822][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:33:29,822][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:33:29,841][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:33:29,842][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 03:33:29,858][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:33:29,858][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:33:36,716][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:33:36,717][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.026 MB uploadedwandb: \ 0.018 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run misunderstood-sweep-19 at: https://wandb.ai/xzy11632/dance-dev/runs/tl7octib
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_033313-tl7octib/logs
wandb: Agent Starting Run: mrpk7g94 with config:
wandb: 	params.1.Log1P.base: 9.289692253075316
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_033350-mrpk7g94
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run apricot-sweep-20
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/1zctuqgy
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/mrpk7g94
[INFO][2024-03-22 03:33:55,864][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:33:55,866][dance][_sanitize_params] Params plan:
[92m[None, {'base': 9.289692253075316}, None, None, None][0m
[INFO][2024-03-22 03:33:55,871][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:33:56,197][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:33:56,330][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:33:56,333][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:33:56,509][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:33:56,509][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:33:56,509][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:33:56,509][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:33:56,509][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:33:56,510][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:33:56,511][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:33:56,511][dance][wrapped_func] Took 0:00:00.640450 to load and process data.
[WARNING][2024-03-22 03:33:56,517][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:33:56,517][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:33:56,517][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:33:56,517][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:33:56,532][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:33:56,533][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
[WARNING][2024-03-22 03:33:56,544][dance][wrapped_func] The function 'FilterGenesNumberPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:33:56,545][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:34:04,080][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:34:04,081][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run apricot-sweep-20 at: https://wandb.ai/xzy11632/dance-dev/runs/mrpk7g94
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_033350-mrpk7g94/logs
[INFO][2024-03-22 03:34:16,859][dance][wandb_sweep] Sweep config:
{'entity': 'xzy11632',
 'method': 'bayes',
 'metric': {'goal': 'maximize', 'name': 'acc'},
 'parameters': {'params.1.Log1P.base': {'max': 10.0, 'min': 1.0},
                'params.2.FilterGenesRegression.method': {'values': ['enclasc',
                                                                     'seurat3',
                                                                     'scmap']},
                'params.2.FilterGenesRegression.num_genes': {'max': 10000,
                                                             'min': 100}},
 'project': 'dance-dev'}
[INFO][2024-03-22 03:34:17,633][dance][wandb_sweep] [94m

	[*] Sweep ID: 8hvzawkk
[0m
[INFO][2024-03-22 03:34:17,633][dance][wandb_sweep_agent] Spawning agent: sweep_id='8hvzawkk', entity='xzy11632', project='dance-dev', count=20
wandb: Agent Starting Run: cnm1gq09 with config:
wandb: 	params.1.Log1P.base: 3.799270039302918
wandb: 	params.2.FilterGenesRegression.method: scmap
wandb: 	params.2.FilterGenesRegression.num_genes: 6668
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_033423-cnm1gq09
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run floral-sweep-1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/8hvzawkk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/cnm1gq09
[INFO][2024-03-22 03:34:46,950][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:34:46,952][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 3.799270039302918},
 {'method': 'scmap', 'num_genes': 6668},
 None,
 None][0m
[INFO][2024-03-22 03:34:46,961][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:34:47,433][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:34:47,605][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:34:47,609][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:34:47,820][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:34:47,820][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:34:47,821][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:34:47,821][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:34:47,821][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:34:47,823][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:34:47,823][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:34:47,823][dance][wrapped_func] Took 0:00:00.862993 to load and process data.
[WARNING][2024-03-22 03:34:47,832][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:34:47,832][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:34:47,832][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:34:47,850][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:34:47,851][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:34:48,023][dance][_filter_scmap] Start generating cell features using scmap
[WARNING][2024-03-22 03:34:48,057][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:34:49,505][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:34:49,505][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.87879
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run floral-sweep-1 at: https://wandb.ai/xzy11632/dance-dev/runs/cnm1gq09
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_033423-cnm1gq09/logs
wandb: Agent Starting Run: 7w5g31by with config:
wandb: 	params.1.Log1P.base: 3.118436048333748
wandb: 	params.2.FilterGenesRegression.method: seurat3
wandb: 	params.2.FilterGenesRegression.num_genes: 5802
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_033506-7w5g31by
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run twilight-sweep-2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/8hvzawkk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/7w5g31by
[INFO][2024-03-22 03:35:16,741][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:35:16,742][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 3.118436048333748},
 {'method': 'seurat3', 'num_genes': 5802},
 None,
 None][0m
[INFO][2024-03-22 03:35:16,748][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:35:17,315][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:35:17,608][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:35:17,620][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:35:17,890][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:35:17,890][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:35:17,891][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:35:17,891][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:35:17,891][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:35:17,893][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:35:17,893][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:35:17,894][dance][wrapped_func] Took 0:00:01.145465 to load and process data.
[WARNING][2024-03-22 03:35:17,904][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:35:17,904][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:35:17,905][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:35:17,925][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:35:17,926][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:35:18,104][dance][_filter_seurat3] Start generating cell features using Seurat v3.0
[WARNING][2024-03-22 03:35:18,315][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:35:22,331][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:35:22,345][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.86364
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run twilight-sweep-2 at: https://wandb.ai/xzy11632/dance-dev/runs/7w5g31by
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_033506-7w5g31by/logs
wandb: Agent Starting Run: u5wtim4d with config:
wandb: 	params.1.Log1P.base: 8.13416056921542
wandb: 	params.2.FilterGenesRegression.method: seurat3
wandb: 	params.2.FilterGenesRegression.num_genes: 7559
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_033546-u5wtim4d
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run prime-sweep-3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/8hvzawkk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/u5wtim4d
[INFO][2024-03-22 03:35:51,212][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:35:51,225][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 8.13416056921542},
 {'method': 'seurat3', 'num_genes': 7559},
 None,
 None][0m
[INFO][2024-03-22 03:35:51,238][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:35:51,607][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:35:51,758][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:35:51,762][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:35:51,952][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:35:51,952][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:35:51,952][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:35:51,952][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:35:51,952][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:35:51,954][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:35:51,955][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:35:51,955][dance][wrapped_func] Took 0:00:00.716855 to load and process data.
[WARNING][2024-03-22 03:35:51,963][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:35:51,964][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:35:51,964][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:35:51,981][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:35:51,982][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:35:52,145][dance][_filter_seurat3] Start generating cell features using Seurat v3.0
[WARNING][2024-03-22 03:35:52,224][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:35:53,553][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:35:53,553][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.018 MB of 0.026 MB uploadedwandb: - 0.018 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run prime-sweep-3 at: https://wandb.ai/xzy11632/dance-dev/runs/u5wtim4d
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_033546-u5wtim4d/logs
wandb: Agent Starting Run: j728qu2l with config:
wandb: 	params.1.Log1P.base: 2.3933792496690662
wandb: 	params.2.FilterGenesRegression.method: seurat3
wandb: 	params.2.FilterGenesRegression.num_genes: 2863
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_033614-j728qu2l
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run happy-sweep-4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/8hvzawkk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/j728qu2l
[INFO][2024-03-22 03:36:36,986][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:36:36,991][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 2.3933792496690662},
 {'method': 'seurat3', 'num_genes': 2863},
 None,
 None][0m
[INFO][2024-03-22 03:36:37,008][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:36:37,419][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:36:37,576][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:36:37,580][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:36:37,755][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:36:37,756][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:36:37,756][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:36:37,756][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:36:37,756][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:36:37,757][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:36:37,758][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:36:37,758][dance][wrapped_func] Took 0:00:00.750466 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 9.087941669373755
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 2.2175848576586303
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 6.645527910398513
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 7.807727964992942
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 5.853487340756915
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 6.982992405286596
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 9.289692253075316
- type: filter.gene
  desc: null
  target: FilterGenesNumberPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Create sweep with ID: 8hvzawkk
Sweep URL: https://wandb.ai/xzy11632/dance-dev/sweeps/8hvzawkk
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 3.799270039302918
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    method: scmap
    num_genes: 6668
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 3.118436048333748
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    method: seurat3
    num_genes: 5802
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 8.13416056921542
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    method: seurat3
    num_genes: 7559
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 03:36:37,764][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:36:37,764][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:36:37,764][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:36:37,779][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:36:37,780][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:36:37,928][dance][_filter_seurat3] Start generating cell features using Seurat v3.0
[WARNING][2024-03-22 03:36:37,962][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:36:39,433][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:36:39,433][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.87879
wandb:  test_acc 0.80435
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run happy-sweep-4 at: https://wandb.ai/xzy11632/dance-dev/runs/j728qu2l
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_033614-j728qu2l/logs
wandb: Agent Starting Run: z2cpsip4 with config:
wandb: 	params.1.Log1P.base: 8.190392076514904
wandb: 	params.2.FilterGenesRegression.method: scmap
wandb: 	params.2.FilterGenesRegression.num_genes: 5028
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_033656-z2cpsip4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sweet-sweep-5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/8hvzawkk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/z2cpsip4
[INFO][2024-03-22 03:37:13,064][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:37:13,066][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 8.190392076514904},
 {'method': 'scmap', 'num_genes': 5028},
 None,
 None][0m
[INFO][2024-03-22 03:37:13,072][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:37:14,356][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:37:14,916][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:37:14,926][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:37:15,948][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:37:15,948][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:37:15,952][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:37:15,953][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:37:15,953][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:37:15,956][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:37:15,962][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:37:15,963][dance][wrapped_func] Took 0:00:02.891028 to load and process data.
[WARNING][2024-03-22 03:37:15,991][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:37:15,992][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:37:15,994][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:37:16,040][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:37:16,049][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:37:16,721][dance][_filter_scmap] Start generating cell features using scmap
[WARNING][2024-03-22 03:37:16,750][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:37:23,082][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:37:23,091][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run sweet-sweep-5 at: https://wandb.ai/xzy11632/dance-dev/runs/z2cpsip4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_033656-z2cpsip4/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: c67n2pxx with config:
wandb: 	params.1.Log1P.base: 2.8390874777273414
wandb: 	params.2.FilterGenesRegression.method: scmap
wandb: 	params.2.FilterGenesRegression.num_genes: 2848
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_033749-c67n2pxx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run misty-sweep-6
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/8hvzawkk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/c67n2pxx
[INFO][2024-03-22 03:37:55,905][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:37:55,907][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 2.8390874777273414},
 {'method': 'scmap', 'num_genes': 2848},
 None,
 None][0m
[INFO][2024-03-22 03:37:55,914][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:37:56,324][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:37:56,469][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:37:56,472][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:37:56,648][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:37:56,649][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:37:56,649][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:37:56,649][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:37:56,649][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:37:56,651][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:37:56,651][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:37:56,651][dance][wrapped_func] Took 0:00:00.737586 to load and process data.
[WARNING][2024-03-22 03:37:56,658][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:37:56,659][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:37:56,659][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:37:56,674][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:37:56,675][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:37:56,814][dance][_filter_scmap] Start generating cell features using scmap
[WARNING][2024-03-22 03:37:56,836][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:38:01,685][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:38:01,685][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.86364
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run misty-sweep-6 at: https://wandb.ai/xzy11632/dance-dev/runs/c67n2pxx
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_033749-c67n2pxx/logs
wandb: Agent Starting Run: ortqmer6 with config:
wandb: 	params.1.Log1P.base: 3.078841259067676
wandb: 	params.2.FilterGenesRegression.method: seurat3
wandb: 	params.2.FilterGenesRegression.num_genes: 2804
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_033817-ortqmer6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run vivid-sweep-7
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/8hvzawkk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ortqmer6
[INFO][2024-03-22 03:38:24,255][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:38:24,257][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 3.078841259067676},
 {'method': 'seurat3', 'num_genes': 2804},
 None,
 None][0m
[INFO][2024-03-22 03:38:24,263][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:38:25,031][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:38:25,244][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:38:25,248][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:38:25,472][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:38:25,472][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:38:25,472][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:38:25,473][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:38:25,473][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:38:25,475][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:38:25,475][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:38:25,475][dance][wrapped_func] Took 0:00:01.212325 to load and process data.
[WARNING][2024-03-22 03:38:25,484][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:38:25,485][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:38:25,485][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:38:25,508][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:38:25,509][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:38:25,718][dance][_filter_seurat3] Start generating cell features using Seurat v3.0
[WARNING][2024-03-22 03:38:25,821][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:38:35,142][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:38:35,143][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run vivid-sweep-7 at: https://wandb.ai/xzy11632/dance-dev/runs/ortqmer6
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_033817-ortqmer6/logs
wandb: Agent Starting Run: e1lhartn with config:
wandb: 	params.1.Log1P.base: 8.613409216216226
wandb: 	params.2.FilterGenesRegression.method: seurat3
wandb: 	params.2.FilterGenesRegression.num_genes: 244
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_033853-e1lhartn
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glamorous-sweep-8
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/8hvzawkk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/e1lhartn
[INFO][2024-03-22 03:39:00,837][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:39:00,838][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 8.613409216216226},
 {'method': 'seurat3', 'num_genes': 244},
 None,
 None][0m
[INFO][2024-03-22 03:39:00,845][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:39:01,482][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:39:01,813][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:39:01,824][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:39:02,180][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:39:02,181][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:39:02,181][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:39:02,181][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:39:02,181][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:39:02,183][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:39:02,184][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:39:02,184][dance][wrapped_func] Took 0:00:01.339559 to load and process data.
[WARNING][2024-03-22 03:39:02,195][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:39:02,196][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:39:02,197][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:39:02,220][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:39:02,221][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:39:02,412][dance][_filter_seurat3] Start generating cell features using Seurat v3.0
[WARNING][2024-03-22 03:39:02,484][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:39:08,657][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:39:08,657][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.015 MB of 0.026 MB uploadedwandb: - 0.015 MB of 0.026 MB uploadedwandb: \ 0.015 MB of 0.026 MB uploadedwandb: | 0.015 MB of 0.026 MB uploadedwandb: / 0.015 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.86364
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run glamorous-sweep-8 at: https://wandb.ai/xzy11632/dance-dev/runs/e1lhartn
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_033853-e1lhartn/logs
wandb: Agent Starting Run: vbktwln7 with config:
wandb: 	params.1.Log1P.base: 3.915640734850713
wandb: 	params.2.FilterGenesRegression.method: enclasc
wandb: 	params.2.FilterGenesRegression.num_genes: 2664
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_033928-vbktwln7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run solar-sweep-9
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/8hvzawkk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/vbktwln7
[INFO][2024-03-22 03:39:36,528][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:39:36,530][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 3.915640734850713},
 {'method': 'enclasc', 'num_genes': 2664},
 None,
 None][0m
[INFO][2024-03-22 03:39:36,544][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:39:38,210][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:39:38,435][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:39:38,439][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:39:40,417][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:39:40,417][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:39:40,417][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:39:40,417][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:39:40,417][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:39:40,423][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:39:40,424][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:39:40,425][dance][wrapped_func] Took 0:00:03.880928 to load and process data.
[WARNING][2024-03-22 03:39:40,440][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:39:40,441][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:39:40,442][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:39:40,474][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:39:40,482][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:39:40,788][dance][_filter_enclasc] Start generating cell features using EnClaSC
[WARNING][2024-03-22 03:39:40,846][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:39:48,100][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:39:48,100][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run solar-sweep-9 at: https://wandb.ai/xzy11632/dance-dev/runs/vbktwln7
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_033928-vbktwln7/logs
wandb: Agent Starting Run: pr965ty1 with config:
wandb: 	params.1.Log1P.base: 3.854220335889322
wandb: 	params.2.FilterGenesRegression.method: seurat3
wandb: 	params.2.FilterGenesRegression.num_genes: 4208
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_034003-pr965ty1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fast-sweep-10
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/8hvzawkk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/pr965ty1
[INFO][2024-03-22 03:40:11,097][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:40:11,099][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 3.854220335889322},
 {'method': 'seurat3', 'num_genes': 4208},
 None,
 None][0m
[INFO][2024-03-22 03:40:11,107][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:40:11,710][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:40:11,933][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:40:11,937][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:40:12,159][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:40:12,160][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:40:12,160][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:40:12,161][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:40:12,161][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:40:12,164][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:40:12,165][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:40:12,165][dance][wrapped_func] Took 0:00:01.058300 to load and process data.
[WARNING][2024-03-22 03:40:12,177][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:40:12,178][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:40:12,178][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:40:12,201][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:40:12,202][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:40:12,410][dance][_filter_seurat3] Start generating cell features using Seurat v3.0
[WARNING][2024-03-22 03:40:12,486][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:40:20,398][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:40:20,399][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run fast-sweep-10 at: https://wandb.ai/xzy11632/dance-dev/runs/pr965ty1
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_034003-pr965ty1/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: frmkj49x with config:
wandb: 	params.1.Log1P.base: 3.265642507907537
wandb: 	params.2.FilterGenesRegression.method: scmap
wandb: 	params.2.FilterGenesRegression.num_genes: 1380
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_034050-frmkj49x
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run denim-sweep-11
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/8hvzawkk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/frmkj49x
[INFO][2024-03-22 03:40:59,092][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:40:59,094][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 3.265642507907537},
 {'method': 'scmap', 'num_genes': 1380},
 None,
 None][0m
[INFO][2024-03-22 03:40:59,102][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:40:59,598][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:40:59,814][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:40:59,819][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:41:00,020][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:41:00,021][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:41:00,022][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:41:00,022][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:41:00,022][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:41:00,025][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:41:00,025][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:41:00,026][dance][wrapped_func] Took 0:00:00.924383 to load and process data.
[WARNING][2024-03-22 03:41:00,036][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:41:00,037][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:41:00,037][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:41:00,062][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:41:00,063][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:41:00,235][dance][_filter_scmap] Start generating cell features using scmap
[WARNING][2024-03-22 03:41:00,262][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:41:07,262][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:41:07,263][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.026 MB uploadedwandb: \ 0.018 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run denim-sweep-11 at: https://wandb.ai/xzy11632/dance-dev/runs/frmkj49x
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_034050-frmkj49x/logs
wandb: Agent Starting Run: nxgzae5q with config:
wandb: 	params.1.Log1P.base: 7.611165846464612
wandb: 	params.2.FilterGenesRegression.method: seurat3
wandb: 	params.2.FilterGenesRegression.num_genes: 4206
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_034125-nxgzae5q
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run magic-sweep-12
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/8hvzawkk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/nxgzae5q
[INFO][2024-03-22 03:41:32,782][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:41:32,784][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 7.611165846464612},
 {'method': 'seurat3', 'num_genes': 4206},
 None,
 None][0m
[INFO][2024-03-22 03:41:32,802][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:41:33,430][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:41:33,630][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:41:33,634][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:41:33,859][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:41:33,860][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:41:33,860][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:41:33,861][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:41:33,861][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:41:33,864][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:41:33,865][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:41:33,866][dance][wrapped_func] Took 0:00:01.064019 to load and process data.
[WARNING][2024-03-22 03:41:33,876][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:41:33,877][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:41:33,877][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:41:33,898][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:41:33,901][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:41:34,096][dance][_filter_seurat3] Start generating cell features using Seurat v3.0
[WARNING][2024-03-22 03:41:34,156][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:41:41,495][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:41:41,496][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run magic-sweep-12 at: https://wandb.ai/xzy11632/dance-dev/runs/nxgzae5q
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_034125-nxgzae5q/logs
wandb: Agent Starting Run: x47wr0zs with config:
wandb: 	params.1.Log1P.base: 1.1422479596490405
wandb: 	params.2.FilterGenesRegression.method: scmap
wandb: 	params.2.FilterGenesRegression.num_genes: 8023
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_034156-x47wr0zs
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run blooming-sweep-13
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/8hvzawkk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/x47wr0zs
[INFO][2024-03-22 03:42:04,939][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:42:04,940][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 1.1422479596490405},
 {'method': 'scmap', 'num_genes': 8023},
 None,
 None][0m
[INFO][2024-03-22 03:42:04,946][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:42:05,631][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:42:05,807][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:42:05,810][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:42:06,001][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:42:06,002][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:42:06,003][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:42:06,003][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:42:06,004][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:42:06,006][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:42:06,007][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:42:06,007][dance][wrapped_func] Took 0:00:01.061216 to load and process data.
[WARNING][2024-03-22 03:42:06,016][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:42:06,017][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:42:06,018][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:42:06,037][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:42:06,038][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:42:06,262][dance][_filter_scmap] Start generating cell features using scmap
[WARNING][2024-03-22 03:42:06,295][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:42:13,909][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:42:13,910][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.018 MB of 0.026 MB uploadedwandb: - 0.018 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.78788
wandb:  test_acc 0.83333
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run blooming-sweep-13 at: https://wandb.ai/xzy11632/dance-dev/runs/x47wr0zs
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_034156-x47wr0zs/logs
wandb: Agent Starting Run: 86jsgi93 with config:
wandb: 	params.1.Log1P.base: 5.054195198483312
wandb: 	params.2.FilterGenesRegression.method: scmap
wandb: 	params.2.FilterGenesRegression.num_genes: 8059
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_034229-86jsgi93
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glad-sweep-14
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/8hvzawkk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/86jsgi93
[INFO][2024-03-22 03:42:36,457][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:42:36,459][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 5.054195198483312},
 {'method': 'scmap', 'num_genes': 8059},
 None,
 None][0m
[INFO][2024-03-22 03:42:36,465][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:42:37,151][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:42:37,335][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:42:37,339][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:42:37,599][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:42:37,600][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:42:37,600][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:42:37,600][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:42:37,600][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:42:37,603][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:42:37,612][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:42:37,613][dance][wrapped_func] Took 0:00:01.148206 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 2.3933792496690662
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    method: seurat3
    num_genes: 2863
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 8.190392076514904
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    method: scmap
    num_genes: 5028
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 2.8390874777273414
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    method: scmap
    num_genes: 2848
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 3.078841259067676
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    method: seurat3
    num_genes: 2804
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 8.613409216216226
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    method: seurat3
    num_genes: 244
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 3.915640734850713
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    method: enclasc
    num_genes: 2664
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 3.854220335889322
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    method: seurat3
    num_genes: 4208
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 3.265642507907537
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    method: scmap
    num_genes: 1380
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 7.611165846464612
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    method: seurat3
    num_genes: 4206
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 1.1422479596490405
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    method: scmap
    num_genes: 8023
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 03:42:37,623][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:42:37,624][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:42:37,624][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:42:37,646][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:42:37,647][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:42:37,828][dance][_filter_scmap] Start generating cell features using scmap
[WARNING][2024-03-22 03:42:37,851][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:42:48,049][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:42:48,049][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.018 MB of 0.026 MB uploadedwandb: / 0.018 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.89394
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run glad-sweep-14 at: https://wandb.ai/xzy11632/dance-dev/runs/86jsgi93
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_034229-86jsgi93/logs
wandb: Agent Starting Run: bfvx705r with config:
wandb: 	params.1.Log1P.base: 1.3637018004726795
wandb: 	params.2.FilterGenesRegression.method: seurat3
wandb: 	params.2.FilterGenesRegression.num_genes: 403
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_034305-bfvx705r
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run twilight-sweep-15
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/8hvzawkk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/bfvx705r
[INFO][2024-03-22 03:43:14,252][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:43:14,272][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 1.3637018004726795},
 {'method': 'seurat3', 'num_genes': 403},
 None,
 None][0m
[INFO][2024-03-22 03:43:14,291][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:43:15,660][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:43:15,811][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:43:15,815][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:43:17,293][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:43:17,293][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:43:17,293][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:43:17,293][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:43:17,294][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:43:17,296][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:43:17,297][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:43:17,297][dance][wrapped_func] Took 0:00:03.006859 to load and process data.
[WARNING][2024-03-22 03:43:17,309][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:43:17,311][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:43:17,312][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:43:17,331][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:43:17,332][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:43:17,632][dance][_filter_seurat3] Start generating cell features using Seurat v3.0
[WARNING][2024-03-22 03:43:17,721][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:43:25,184][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:43:25,184][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.86364
wandb:  test_acc 0.83333
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run twilight-sweep-15 at: https://wandb.ai/xzy11632/dance-dev/runs/bfvx705r
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_034305-bfvx705r/logs
wandb: Agent Starting Run: q597hk21 with config:
wandb: 	params.1.Log1P.base: 8.349036802847873
wandb: 	params.2.FilterGenesRegression.method: enclasc
wandb: 	params.2.FilterGenesRegression.num_genes: 8746
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_034338-q597hk21
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run comfy-sweep-16
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/8hvzawkk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/q597hk21
[INFO][2024-03-22 03:43:45,942][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:43:45,944][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 8.349036802847873},
 {'method': 'enclasc', 'num_genes': 8746},
 None,
 None][0m
[INFO][2024-03-22 03:43:45,951][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:43:46,484][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:43:46,706][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:43:46,711][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:43:47,616][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:43:47,617][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:43:47,617][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:43:47,617][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:43:47,617][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:43:47,619][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:43:47,620][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:43:47,620][dance][wrapped_func] Took 0:00:01.668744 to load and process data.
[WARNING][2024-03-22 03:43:47,630][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:43:47,631][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:43:47,631][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:43:47,653][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:43:47,654][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:43:47,822][dance][_filter_enclasc] Start generating cell features using EnClaSC
[WARNING][2024-03-22 03:43:47,848][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:43:55,370][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:43:55,371][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.018 MB uploadedwandb: \ 0.012 MB of 0.018 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run comfy-sweep-16 at: https://wandb.ai/xzy11632/dance-dev/runs/q597hk21
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_034338-q597hk21/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: edns81vz with config:
wandb: 	params.1.Log1P.base: 4.781635688946061
wandb: 	params.2.FilterGenesRegression.method: scmap
wandb: 	params.2.FilterGenesRegression.num_genes: 3304
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_034420-edns81vz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run chocolate-sweep-17
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/8hvzawkk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/edns81vz
[INFO][2024-03-22 03:44:29,123][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:44:29,125][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 4.781635688946061},
 {'method': 'scmap', 'num_genes': 3304},
 None,
 None][0m
[INFO][2024-03-22 03:44:29,134][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:44:30,187][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:44:30,448][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:44:30,452][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:44:33,248][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:44:33,249][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:44:33,249][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:44:33,249][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:44:33,249][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:44:33,255][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:44:33,255][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:44:33,256][dance][wrapped_func] Took 0:00:04.121785 to load and process data.
[WARNING][2024-03-22 03:44:33,264][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:44:33,264][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:44:33,265][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:44:33,284][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:44:33,285][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:44:33,464][dance][_filter_scmap] Start generating cell features using scmap
[WARNING][2024-03-22 03:44:33,488][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:44:40,133][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:44:40,134][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.021 MB uploadedwandb: - 0.018 MB of 0.026 MB uploadedwandb: \ 0.018 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.89394
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run chocolate-sweep-17 at: https://wandb.ai/xzy11632/dance-dev/runs/edns81vz
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_034420-edns81vz/logs
wandb: Agent Starting Run: pv1uddwm with config:
wandb: 	params.1.Log1P.base: 4.400328047503414
wandb: 	params.2.FilterGenesRegression.method: scmap
wandb: 	params.2.FilterGenesRegression.num_genes: 6946
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_034457-pv1uddwm
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run woven-sweep-18
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/8hvzawkk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/pv1uddwm
[INFO][2024-03-22 03:45:05,375][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:45:05,377][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 4.400328047503414},
 {'method': 'scmap', 'num_genes': 6946},
 None,
 None][0m
[INFO][2024-03-22 03:45:05,384][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:45:06,104][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:45:06,448][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:45:06,459][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:45:07,187][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:45:07,188][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:45:07,188][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:45:07,188][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:45:07,188][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:45:07,193][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:45:07,194][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:45:07,194][dance][wrapped_func] Took 0:00:01.811100 to load and process data.
[WARNING][2024-03-22 03:45:07,206][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:45:07,207][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:45:07,207][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:45:07,232][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:45:07,233][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:45:07,441][dance][_filter_scmap] Start generating cell features using scmap
[WARNING][2024-03-22 03:45:07,468][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:45:17,604][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:45:17,605][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.86364
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run woven-sweep-18 at: https://wandb.ai/xzy11632/dance-dev/runs/pv1uddwm
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_034457-pv1uddwm/logs
wandb: Agent Starting Run: 5p2mjy0o with config:
wandb: 	params.1.Log1P.base: 6.621034545272517
wandb: 	params.2.FilterGenesRegression.method: scmap
wandb: 	params.2.FilterGenesRegression.num_genes: 4010
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_034535-5p2mjy0o
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run solar-sweep-19
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/8hvzawkk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/5p2mjy0o
[INFO][2024-03-22 03:45:43,402][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:45:43,453][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 6.621034545272517},
 {'method': 'scmap', 'num_genes': 4010},
 None,
 None][0m
[INFO][2024-03-22 03:45:43,462][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:45:43,977][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:45:44,176][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:45:44,179][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:45:44,412][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:45:44,412][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:45:44,413][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:45:44,413][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:45:44,413][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:45:44,415][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:45:44,416][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:45:44,416][dance][wrapped_func] Took 0:00:00.954174 to load and process data.
[WARNING][2024-03-22 03:45:44,424][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:45:44,425][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:45:44,425][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:45:44,446][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:45:44,447][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:45:44,627][dance][_filter_scmap] Start generating cell features using scmap
[WARNING][2024-03-22 03:45:44,657][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:45:54,095][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:45:54,096][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run solar-sweep-19 at: https://wandb.ai/xzy11632/dance-dev/runs/5p2mjy0o
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_034535-5p2mjy0o/logs
wandb: Agent Starting Run: ld5szp2c with config:
wandb: 	params.1.Log1P.base: 1.5683962537790612
wandb: 	params.2.FilterGenesRegression.method: seurat3
wandb: 	params.2.FilterGenesRegression.num_genes: 8875
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_034615-ld5szp2c
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run laced-sweep-20
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/8hvzawkk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ld5szp2c
[INFO][2024-03-22 03:46:22,674][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:46:22,676][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 1.5683962537790612},
 {'method': 'seurat3', 'num_genes': 8875},
 None,
 None][0m
[INFO][2024-03-22 03:46:22,682][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:46:23,435][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:46:23,758][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:46:23,770][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:46:24,004][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:46:24,006][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:46:24,007][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:46:24,007][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:46:24,007][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:46:24,009][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:46:24,012][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:46:24,015][dance][wrapped_func] Took 0:00:01.332827 to load and process data.
[WARNING][2024-03-22 03:46:24,032][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:46:24,033][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:46:24,033][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:46:24,061][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:46:24,062][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/dance/dance/transforms/filter.py:698: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-22 03:46:24,408][dance][_filter_seurat3] Start generating cell features using Seurat v3.0
[WARNING][2024-03-22 03:46:24,481][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:46:34,287][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:46:34,288][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.75758
wandb:  test_acc 0.83333
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run laced-sweep-20 at: https://wandb.ai/xzy11632/dance-dev/runs/ld5szp2c
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_034615-ld5szp2c/logs
[INFO][2024-03-22 03:46:52,275][dance][wandb_sweep] Sweep config:
{'entity': 'xzy11632',
 'method': 'bayes',
 'metric': {'goal': 'maximize', 'name': 'acc'},
 'parameters': {'params.1.Log1P.base': {'max': 10.0, 'min': 1.0},
                'params.2.HighlyVariableGenesRawCount.n_top_genes': {'max': 10000,
                                                                     'min': 100},
                'params.2.HighlyVariableGenesRawCount.span': {'max': 0.6,
                                                              'min': 0.1}},
 'project': 'dance-dev'}
[INFO][2024-03-22 03:46:53,305][dance][wandb_sweep] [94m

	[*] Sweep ID: b2dkln4o
[0m
[INFO][2024-03-22 03:46:53,306][dance][wandb_sweep_agent] Spawning agent: sweep_id='b2dkln4o', entity='xzy11632', project='dance-dev', count=20
wandb: Agent Starting Run: i4bb5awf with config:
wandb: 	params.1.Log1P.base: 7.7101335019221215
wandb: 	params.2.HighlyVariableGenesRawCount.n_top_genes: 803
wandb: 	params.2.HighlyVariableGenesRawCount.span: 0.21949676048710337
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_034657-i4bb5awf
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run volcanic-sweep-1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/b2dkln4o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/i4bb5awf
[INFO][2024-03-22 03:47:03,143][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:47:03,145][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 7.7101335019221215},
 {'n_top_genes': 803, 'span': 0.21949676048710337},
 None,
 None][0m
[INFO][2024-03-22 03:47:03,156][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:47:03,790][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:47:04,106][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:47:04,110][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:47:04,529][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:47:04,530][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:47:04,530][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:47:04,530][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:47:04,530][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:47:04,533][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:47:04,534][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:47:04,534][dance][wrapped_func] Took 0:00:01.378605 to load and process data.
[WARNING][2024-03-22 03:47:04,545][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:47:04,547][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:47:04,547][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:47:04,569][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:47:04,570][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 03:47:05,993][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:47:06,002][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:47:06,002][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.78788
wandb:  test_acc 0.81884
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run volcanic-sweep-1 at: https://wandb.ai/xzy11632/dance-dev/runs/i4bb5awf
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_034657-i4bb5awf/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: gyfsq99z with config:
wandb: 	params.1.Log1P.base: 4.4178003285328415
wandb: 	params.2.HighlyVariableGenesRawCount.n_top_genes: 1608
wandb: 	params.2.HighlyVariableGenesRawCount.span: 0.40782796744662575
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_034726-gyfsq99z
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run serene-sweep-2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/b2dkln4o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/gyfsq99z
[INFO][2024-03-22 03:47:31,204][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:47:31,206][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 4.4178003285328415},
 {'n_top_genes': 1608, 'span': 0.40782796744662575},
 None,
 None][0m
[INFO][2024-03-22 03:47:31,218][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:47:31,607][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:47:31,761][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:47:31,765][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:47:31,945][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:47:31,945][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:47:31,945][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:47:31,945][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:47:31,945][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:47:31,947][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:47:31,948][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:47:31,948][dance][wrapped_func] Took 0:00:00.729509 to load and process data.
[WARNING][2024-03-22 03:47:31,954][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:47:31,955][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:47:31,955][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:47:31,971][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:47:31,971][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 03:47:32,384][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:47:32,391][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:47:32,391][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.81818
wandb:  test_acc 0.80435
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run serene-sweep-2 at: https://wandb.ai/xzy11632/dance-dev/runs/gyfsq99z
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_034726-gyfsq99z/logs
wandb: Agent Starting Run: ttllz3pu with config:
wandb: 	params.1.Log1P.base: 5.059545765332878
wandb: 	params.2.HighlyVariableGenesRawCount.n_top_genes: 1771
wandb: 	params.2.HighlyVariableGenesRawCount.span: 0.4032547631196338
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_034745-ttllz3pu
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run light-sweep-3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/b2dkln4o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ttllz3pu
[INFO][2024-03-22 03:47:55,521][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:47:55,523][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 5.059545765332878},
 {'n_top_genes': 1771, 'span': 0.4032547631196338},
 None,
 None][0m
[INFO][2024-03-22 03:47:55,531][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:47:56,039][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:47:56,248][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:47:56,252][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:47:56,903][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:47:56,903][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:47:56,903][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:47:56,903][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:47:56,903][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:47:56,905][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:47:56,905][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:47:56,906][dance][wrapped_func] Took 0:00:01.374504 to load and process data.
[WARNING][2024-03-22 03:47:56,914][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:47:56,915][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:47:56,915][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:47:56,935][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:47:56,935][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 03:47:58,147][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:47:58,165][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:47:58,166][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.81159
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run light-sweep-3 at: https://wandb.ai/xzy11632/dance-dev/runs/ttllz3pu
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_034745-ttllz3pu/logs
wandb: Agent Starting Run: fcb0hc3a with config:
wandb: 	params.1.Log1P.base: 5.229518978282538
wandb: 	params.2.HighlyVariableGenesRawCount.n_top_genes: 5125
wandb: 	params.2.HighlyVariableGenesRawCount.span: 0.17766281324485458
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_034809-fcb0hc3a
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wandering-sweep-4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/b2dkln4o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/fcb0hc3a
[INFO][2024-03-22 03:48:15,049][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:48:15,052][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 5.229518978282538},
 {'n_top_genes': 5125, 'span': 0.17766281324485458},
 None,
 None][0m
[INFO][2024-03-22 03:48:15,060][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:48:16,367][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:48:16,509][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:48:16,512][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:48:18,651][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:48:18,651][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:48:18,652][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:48:18,652][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:48:18,652][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:48:18,659][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:48:18,660][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:48:18,660][dance][wrapped_func] Took 0:00:03.600360 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 5.054195198483312
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    method: scmap
    num_genes: 8059
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 1.3637018004726795
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    method: seurat3
    num_genes: 403
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 8.349036802847873
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    method: enclasc
    num_genes: 8746
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 4.781635688946061
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    method: scmap
    num_genes: 3304
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 4.400328047503414
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    method: scmap
    num_genes: 6946
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 6.621034545272517
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    method: scmap
    num_genes: 4010
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 1.5683962537790612
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    method: seurat3
    num_genes: 8875
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Create sweep with ID: b2dkln4o
Sweep URL: https://wandb.ai/xzy11632/dance-dev/sweeps/b2dkln4o
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 7.7101335019221215
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 803
    span: 0.21949676048710337
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 4.4178003285328415
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 1608
    span: 0.40782796744662575
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 5.059545765332878
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 1771
    span: 0.4032547631196338
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 03:48:18,670][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:48:18,671][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:48:18,672][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:48:18,694][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:48:18,695][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 03:48:19,226][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:48:19,381][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:48:19,382][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.012 MB of 0.018 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.81818
wandb:  test_acc 0.82609
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run wandering-sweep-4 at: https://wandb.ai/xzy11632/dance-dev/runs/fcb0hc3a
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_034809-fcb0hc3a/logs
wandb: Agent Starting Run: akik58ko with config:
wandb: 	params.1.Log1P.base: 1.9825003929222245
wandb: 	params.2.HighlyVariableGenesRawCount.n_top_genes: 4841
wandb: 	params.2.HighlyVariableGenesRawCount.span: 0.37022214754744664
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_034834-akik58ko
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run valiant-sweep-5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/b2dkln4o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/akik58ko
[INFO][2024-03-22 03:48:39,529][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:48:39,948][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 1.9825003929222245},
 {'n_top_genes': 4841, 'span': 0.37022214754744664},
 None,
 None][0m
[INFO][2024-03-22 03:48:39,954][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:48:42,320][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:48:42,543][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:48:42,546][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:48:46,291][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:48:46,292][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:48:46,292][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:48:46,292][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:48:46,292][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:48:46,301][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:48:46,301][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:48:46,301][dance][wrapped_func] Took 0:00:06.347750 to load and process data.
[WARNING][2024-03-22 03:48:46,308][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:48:46,308][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:48:46,308][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:48:46,323][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:48:46,323][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 03:48:51,140][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:48:51,818][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:48:51,818][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.76812
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run valiant-sweep-5 at: https://wandb.ai/xzy11632/dance-dev/runs/akik58ko
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_034834-akik58ko/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 0z95dogk with config:
wandb: 	params.1.Log1P.base: 1.262133521727597
wandb: 	params.2.HighlyVariableGenesRawCount.n_top_genes: 2557
wandb: 	params.2.HighlyVariableGenesRawCount.span: 0.146523973104095
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_034911-0z95dogk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wild-sweep-6
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/b2dkln4o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/0z95dogk
[INFO][2024-03-22 03:49:17,746][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:49:17,747][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 1.262133521727597},
 {'n_top_genes': 2557, 'span': 0.146523973104095},
 None,
 None][0m
[INFO][2024-03-22 03:49:17,754][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:49:20,606][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:49:21,163][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:49:21,168][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:49:26,385][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:49:26,385][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:49:26,385][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:49:26,385][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:49:26,385][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:49:26,400][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:49:26,400][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:49:26,401][dance][wrapped_func] Took 0:00:08.647182 to load and process data.
[WARNING][2024-03-22 03:49:26,410][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:49:26,412][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:49:26,412][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:49:26,435][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:49:26,436][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 03:49:31,523][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:49:31,579][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:49:31,579][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.80303
wandb:  test_acc 0.81884
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run wild-sweep-6 at: https://wandb.ai/xzy11632/dance-dev/runs/0z95dogk
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_034911-0z95dogk/logs
wandb: Agent Starting Run: 10iivze9 with config:
wandb: 	params.1.Log1P.base: 4.257127305633192
wandb: 	params.2.HighlyVariableGenesRawCount.n_top_genes: 338
wandb: 	params.2.HighlyVariableGenesRawCount.span: 0.15437077681861325
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_034944-10iivze9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run summer-sweep-7
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/b2dkln4o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/10iivze9
[INFO][2024-03-22 03:49:49,023][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:49:49,025][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 4.257127305633192},
 {'n_top_genes': 338, 'span': 0.15437077681861325},
 None,
 None][0m
[INFO][2024-03-22 03:49:49,034][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:49:50,929][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:49:51,241][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:49:51,244][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:49:55,804][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:49:55,804][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:49:55,805][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:49:55,805][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:49:55,805][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:49:55,819][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:49:55,819][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:49:55,819][dance][wrapped_func] Took 0:00:06.785705 to load and process data.
[WARNING][2024-03-22 03:49:55,828][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:49:55,829][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:49:55,829][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:49:55,849][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:49:55,850][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 03:50:03,519][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:50:03,523][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:50:03,523][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.018 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.78788
wandb:  test_acc 0.83333
wandb: train_acc 0.98473
wandb: 
wandb: üöÄ View run summer-sweep-7 at: https://wandb.ai/xzy11632/dance-dev/runs/10iivze9
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_034944-10iivze9/logs
wandb: Agent Starting Run: v5lgyj5k with config:
wandb: 	params.1.Log1P.base: 2.5073875351531507
wandb: 	params.2.HighlyVariableGenesRawCount.n_top_genes: 4373
wandb: 	params.2.HighlyVariableGenesRawCount.span: 0.15852481119593362
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_035016-v5lgyj5k
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run brisk-sweep-8
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/b2dkln4o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/v5lgyj5k
[INFO][2024-03-22 03:50:22,468][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:50:22,470][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 2.5073875351531507},
 {'n_top_genes': 4373, 'span': 0.15852481119593362},
 None,
 None][0m
[INFO][2024-03-22 03:50:22,482][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:50:22,862][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:50:23,006][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:50:23,008][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:50:23,187][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:50:23,187][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:50:23,187][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:50:23,187][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:50:23,187][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:50:23,189][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:50:23,189][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:50:23,189][dance][wrapped_func] Took 0:00:00.712951 to load and process data.
[WARNING][2024-03-22 03:50:23,196][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:50:23,197][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:50:23,198][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:50:23,213][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:50:23,213][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 03:50:23,612][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:50:23,726][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:50:23,727][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.80303
wandb:  test_acc 0.7971
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run brisk-sweep-8 at: https://wandb.ai/xzy11632/dance-dev/runs/v5lgyj5k
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_035016-v5lgyj5k/logs
wandb: Agent Starting Run: cgxqxuuj with config:
wandb: 	params.1.Log1P.base: 8.099574649809234
wandb: 	params.2.HighlyVariableGenesRawCount.n_top_genes: 7084
wandb: 	params.2.HighlyVariableGenesRawCount.span: 0.4966857501203064
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_035037-cgxqxuuj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run neat-sweep-9
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/b2dkln4o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/cgxqxuuj
[INFO][2024-03-22 03:50:43,108][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:50:43,110][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 8.099574649809234},
 {'n_top_genes': 7084, 'span': 0.4966857501203064},
 None,
 None][0m
[INFO][2024-03-22 03:50:43,116][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:50:44,726][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:50:44,910][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:50:44,914][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:50:48,370][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:50:48,370][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:50:48,370][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:50:48,370][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:50:48,371][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:50:48,381][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:50:48,381][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:50:48,382][dance][wrapped_func] Took 0:00:05.265438 to load and process data.
[WARNING][2024-03-22 03:50:48,391][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:50:48,393][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:50:48,394][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:50:48,411][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:50:48,412][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 03:50:52,383][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:50:53,313][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:50:53,314][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.80303
wandb:  test_acc 0.81159
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run neat-sweep-9 at: https://wandb.ai/xzy11632/dance-dev/runs/cgxqxuuj
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_035037-cgxqxuuj/logs
wandb: Agent Starting Run: 7dc21hof with config:
wandb: 	params.1.Log1P.base: 4.680226067221721
wandb: 	params.2.HighlyVariableGenesRawCount.n_top_genes: 3140
wandb: 	params.2.HighlyVariableGenesRawCount.span: 0.5547242525761577
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_035103-7dc21hof
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run genial-sweep-10
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/b2dkln4o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/7dc21hof
[INFO][2024-03-22 03:51:09,736][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:51:09,738][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 4.680226067221721},
 {'n_top_genes': 3140, 'span': 0.5547242525761577},
 None,
 None][0m
[INFO][2024-03-22 03:51:09,745][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:51:10,325][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:51:10,508][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:51:10,512][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:51:10,712][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:51:10,712][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:51:10,712][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:51:10,713][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:51:10,713][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:51:10,715][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:51:10,715][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:51:10,715][dance][wrapped_func] Took 0:00:00.971070 to load and process data.
[WARNING][2024-03-22 03:51:10,724][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:51:10,729][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:51:10,729][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:51:10,746][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:51:10,747][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 03:51:13,261][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:51:13,312][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:51:13,313][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.86364
wandb:  test_acc 0.81884
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run genial-sweep-10 at: https://wandb.ai/xzy11632/dance-dev/runs/7dc21hof
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_035103-7dc21hof/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: pyn3zyi8 with config:
wandb: 	params.1.Log1P.base: 8.554465415898497
wandb: 	params.2.HighlyVariableGenesRawCount.n_top_genes: 754
wandb: 	params.2.HighlyVariableGenesRawCount.span: 0.4869833163909941
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_035139-pyn3zyi8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wandering-sweep-11
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/b2dkln4o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/pyn3zyi8
[INFO][2024-03-22 03:51:51,328][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:51:51,330][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 8.554465415898497},
 {'n_top_genes': 754, 'span': 0.4869833163909941},
 None,
 None][0m
[INFO][2024-03-22 03:51:51,375][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:51:53,745][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:51:54,061][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:51:54,064][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:51:55,371][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:51:55,372][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:51:55,372][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:51:55,373][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:51:55,373][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:51:55,375][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:51:55,375][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:51:55,376][dance][wrapped_func] Took 0:00:04.019347 to load and process data.
[WARNING][2024-03-22 03:51:55,384][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:51:55,384][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:51:55,385][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:51:55,404][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:51:55,405][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 03:51:56,463][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:51:56,469][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:51:56,469][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.017 MB of 0.026 MB uploadedwandb: \ 0.017 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.81818
wandb:  test_acc 0.81884
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run wandering-sweep-11 at: https://wandb.ai/xzy11632/dance-dev/runs/pyn3zyi8
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_035139-pyn3zyi8/logs
wandb: Agent Starting Run: 2hnq6z22 with config:
wandb: 	params.1.Log1P.base: 6.583564420504855
wandb: 	params.2.HighlyVariableGenesRawCount.n_top_genes: 1866
wandb: 	params.2.HighlyVariableGenesRawCount.span: 0.3394695997651892
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_035210-2hnq6z22
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run solar-sweep-12
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/b2dkln4o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/2hnq6z22
[INFO][2024-03-22 03:52:23,594][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:52:23,596][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 6.583564420504855},
 {'n_top_genes': 1866, 'span': 0.3394695997651892},
 None,
 None][0m
[INFO][2024-03-22 03:52:23,604][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:52:24,330][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:52:24,661][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:52:24,668][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:52:28,706][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:52:28,707][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:52:28,708][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:52:28,709][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:52:28,710][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:52:28,713][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:52:28,720][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:52:28,739][dance][wrapped_func] Took 0:00:05.135834 to load and process data.
[WARNING][2024-03-22 03:52:28,779][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:52:28,781][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:52:28,785][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:52:28,852][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:52:28,861][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 03:52:34,151][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:52:34,364][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:52:34,364][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.81818
wandb:  test_acc 0.81884
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run solar-sweep-12 at: https://wandb.ai/xzy11632/dance-dev/runs/2hnq6z22
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_035210-2hnq6z22/logs
wandb: Agent Starting Run: wspnnpoo with config:
wandb: 	params.1.Log1P.base: 9.370424719407085
wandb: 	params.2.HighlyVariableGenesRawCount.n_top_genes: 6368
wandb: 	params.2.HighlyVariableGenesRawCount.span: 0.23504858979396323
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_035254-wspnnpoo
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run stellar-sweep-13
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/b2dkln4o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/wspnnpoo
[INFO][2024-03-22 03:53:00,398][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:53:00,400][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 9.370424719407085},
 {'n_top_genes': 6368, 'span': 0.23504858979396323},
 None,
 None][0m
[INFO][2024-03-22 03:53:00,406][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:53:00,768][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:53:00,954][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:53:00,958][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:53:01,176][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:53:01,176][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:53:01,176][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:53:01,176][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:53:01,177][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:53:01,179][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:53:01,180][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:53:01,180][dance][wrapped_func] Took 0:00:00.773969 to load and process data.
[WARNING][2024-03-22 03:53:01,190][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:53:01,191][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:53:01,192][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:53:01,216][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:53:01,217][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 03:53:01,747][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:53:01,849][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:53:01,850][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.80303
wandb:  test_acc 0.81159
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run stellar-sweep-13 at: https://wandb.ai/xzy11632/dance-dev/runs/wspnnpoo
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_035254-wspnnpoo/logs
wandb: Agent Starting Run: 2t6g9ro2 with config:
wandb: 	params.1.Log1P.base: 9.206581979768952
wandb: 	params.2.HighlyVariableGenesRawCount.n_top_genes: 9873
wandb: 	params.2.HighlyVariableGenesRawCount.span: 0.26978083947355846
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_035321-2t6g9ro2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run peachy-sweep-14
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/b2dkln4o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/2t6g9ro2
[INFO][2024-03-22 03:53:40,630][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:53:40,632][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 9.206581979768952},
 {'n_top_genes': 9873, 'span': 0.26978083947355846},
 None,
 None][0m
[INFO][2024-03-22 03:53:40,646][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:53:42,127][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:53:42,662][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:53:42,678][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:53:42,976][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:53:42,977][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:53:42,977][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:53:42,977][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:53:42,977][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:53:42,979][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:53:42,980][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:53:42,980][dance][wrapped_func] Took 0:00:02.333998 to load and process data.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 5.229518978282538
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 5125
    span: 0.17766281324485458
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 1.9825003929222245
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 4841
    span: 0.37022214754744664
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 1.262133521727597
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 2557
    span: 0.146523973104095
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 4.257127305633192
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 338
    span: 0.15437077681861325
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 2.5073875351531507
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 4373
    span: 0.15852481119593362
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 8.099574649809234
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 7084
    span: 0.4966857501203064
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 4.680226067221721
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 3140
    span: 0.5547242525761577
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 8.554465415898497
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 754
    span: 0.4869833163909941
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 6.583564420504855
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 1866
    span: 0.3394695997651892
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 9.370424719407085
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 6368
    span: 0.23504858979396323
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

[WARNING][2024-03-22 03:53:42,994][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:53:42,995][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:53:42,995][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:53:43,020][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:53:43,021][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 03:53:44,335][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:53:45,741][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:53:45,750][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.77273
wandb:  test_acc 0.80435
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run peachy-sweep-14 at: https://wandb.ai/xzy11632/dance-dev/runs/2t6g9ro2
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_035321-2t6g9ro2/logs
wandb: Agent Starting Run: 0ydtq95q with config:
wandb: 	params.1.Log1P.base: 9.544665379196298
wandb: 	params.2.HighlyVariableGenesRawCount.n_top_genes: 373
wandb: 	params.2.HighlyVariableGenesRawCount.span: 0.2784398487682679
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_035401-0ydtq95q
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sparkling-sweep-15
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/b2dkln4o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/0ydtq95q
[INFO][2024-03-22 03:54:09,145][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:54:09,147][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 9.544665379196298},
 {'n_top_genes': 373, 'span': 0.2784398487682679},
 None,
 None][0m
[INFO][2024-03-22 03:54:09,175][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:54:10,925][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:54:11,570][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:54:11,573][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:54:11,985][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:54:11,985][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:54:11,985][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:54:11,986][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:54:11,986][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:54:11,989][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:54:11,989][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:54:11,990][dance][wrapped_func] Took 0:00:02.815310 to load and process data.
[WARNING][2024-03-22 03:54:12,002][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:54:12,003][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:54:12,003][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:54:12,024][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:54:12,038][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 03:54:15,141][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:54:15,144][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:54:15,145][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.020 MB of 0.026 MB uploadedwandb: - 0.020 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.81818
wandb:  test_acc 0.83333
wandb: train_acc 0.98092
wandb: 
wandb: üöÄ View run sparkling-sweep-15 at: https://wandb.ai/xzy11632/dance-dev/runs/0ydtq95q
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_035401-0ydtq95q/logs
wandb: Agent Starting Run: 20njqfrk with config:
wandb: 	params.1.Log1P.base: 2.294798436447565
wandb: 	params.2.HighlyVariableGenesRawCount.n_top_genes: 5291
wandb: 	params.2.HighlyVariableGenesRawCount.span: 0.36112135297278225
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_035437-20njqfrk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run major-sweep-16
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/b2dkln4o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/20njqfrk
[INFO][2024-03-22 03:54:49,927][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:54:49,928][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 2.294798436447565},
 {'n_top_genes': 5291, 'span': 0.36112135297278225},
 None,
 None][0m
[INFO][2024-03-22 03:54:49,938][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:54:50,311][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:54:50,520][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:54:50,523][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:54:50,726][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:54:50,726][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:54:50,726][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:54:50,727][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:54:50,727][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:54:50,729][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:54:50,729][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:54:50,729][dance][wrapped_func] Took 0:00:00.791930 to load and process data.
[WARNING][2024-03-22 03:54:50,739][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:54:50,740][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:54:50,740][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:54:50,763][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:54:50,764][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 03:54:51,210][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:54:51,471][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:54:51,471][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.017 MB of 0.026 MB uploadedwandb: \ 0.017 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.83333
wandb:  test_acc 0.80435
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run major-sweep-16 at: https://wandb.ai/xzy11632/dance-dev/runs/20njqfrk
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_035437-20njqfrk/logs
wandb: Agent Starting Run: av073wxf with config:
wandb: 	params.1.Log1P.base: 6.843046799207333
wandb: 	params.2.HighlyVariableGenesRawCount.n_top_genes: 8957
wandb: 	params.2.HighlyVariableGenesRawCount.span: 0.5202403618953619
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_035505-av073wxf
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wandering-sweep-17
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/b2dkln4o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/av073wxf
[INFO][2024-03-22 03:55:11,593][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:55:11,594][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 6.843046799207333},
 {'n_top_genes': 8957, 'span': 0.5202403618953619},
 None,
 None][0m
[INFO][2024-03-22 03:55:11,601][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:55:12,156][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:55:12,645][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:55:12,651][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:55:14,109][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:55:14,110][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:55:14,110][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:55:14,110][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:55:14,110][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:55:14,112][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:55:14,113][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:55:14,113][dance][wrapped_func] Took 0:00:02.512203 to load and process data.
[WARNING][2024-03-22 03:55:14,121][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:55:14,122][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:55:14,123][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:55:14,150][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:55:14,151][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 03:55:17,796][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:55:18,258][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:55:18,258][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.84848
wandb:  test_acc 0.7971
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run wandering-sweep-17 at: https://wandb.ai/xzy11632/dance-dev/runs/av073wxf
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_035505-av073wxf/logs
wandb: Agent Starting Run: fzhhpai1 with config:
wandb: 	params.1.Log1P.base: 1.3384993820772724
wandb: 	params.2.HighlyVariableGenesRawCount.n_top_genes: 195
wandb: 	params.2.HighlyVariableGenesRawCount.span: 0.11879563045359127
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_035532-fzhhpai1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run splendid-sweep-18
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/b2dkln4o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/fzhhpai1
[INFO][2024-03-22 03:55:39,213][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:55:39,217][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 1.3384993820772724},
 {'n_top_genes': 195, 'span': 0.11879563045359127},
 None,
 None][0m
[INFO][2024-03-22 03:55:39,228][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:55:43,129][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:55:43,479][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:55:43,483][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:55:47,604][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:55:47,604][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:55:47,604][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:55:47,605][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:55:47,605][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:55:47,618][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:55:47,618][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:55:47,618][dance][wrapped_func] Took 0:00:08.390519 to load and process data.
[WARNING][2024-03-22 03:55:47,627][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:55:47,629][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:55:47,629][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:55:47,647][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:55:47,648][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 03:55:54,163][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:55:54,173][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:55:54,174][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.80303
wandb:  test_acc 0.81159
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run splendid-sweep-18 at: https://wandb.ai/xzy11632/dance-dev/runs/fzhhpai1
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_035532-fzhhpai1/logs
wandb: Agent Starting Run: 8j1kytvg with config:
wandb: 	params.1.Log1P.base: 6.334795253364226
wandb: 	params.2.HighlyVariableGenesRawCount.n_top_genes: 8300
wandb: 	params.2.HighlyVariableGenesRawCount.span: 0.5692558281324022
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_035609-8j1kytvg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lucky-sweep-19
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/b2dkln4o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/8j1kytvg
[INFO][2024-03-22 03:56:16,358][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:56:16,360][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 6.334795253364226},
 {'n_top_genes': 8300, 'span': 0.5692558281324022},
 None,
 None][0m
[INFO][2024-03-22 03:56:16,366][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:56:19,268][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:56:19,624][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:56:19,627][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:56:23,278][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:56:23,279][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:56:23,279][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:56:23,280][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:56:23,280][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:56:23,293][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:56:23,294][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:56:23,294][dance][wrapped_func] Took 0:00:06.928187 to load and process data.
[WARNING][2024-03-22 03:56:23,305][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:56:23,306][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:56:23,306][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:56:23,327][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:56:23,328][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 03:56:31,537][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:56:32,901][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:56:32,902][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.018 MB of 0.026 MB uploadedwandb: - 0.018 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.81818
wandb:  test_acc 0.81159
wandb: train_acc 1.0
wandb: 
wandb: üöÄ View run lucky-sweep-19 at: https://wandb.ai/xzy11632/dance-dev/runs/8j1kytvg
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_035609-8j1kytvg/logs
wandb: Agent Starting Run: treo6mod with config:
wandb: 	params.1.Log1P.base: 4.242684727203432
wandb: 	params.2.HighlyVariableGenesRawCount.n_top_genes: 669
wandb: 	params.2.HighlyVariableGenesRawCount.span: 0.3348271742231017
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cta_actinn/wandb/run-20240322_035647-treo6mod
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sage-sweep-20
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/b2dkln4o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/treo6mod
[INFO][2024-03-22 03:56:53,571][dance][set_seed] Setting global random seed to 0
[INFO][2024-03-22 03:56:53,573][dance][_sanitize_params] Params plan:
[92m[None,
 {'base': 4.242684727203432},
 {'n_top_genes': 669, 'span': 0.3348271742231017},
 None,
 None][0m
[INFO][2024-03-22 03:56:53,579][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_data.csv
[INFO][2024-03-22 03:56:55,956][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_data.csv
[INFO][2024-03-22 03:56:56,213][dance][_load_dfs] Loading data from ./temp_data/train/human/human_Brain328_celltype.csv
[INFO][2024-03-22 03:56:56,217][dance][_load_dfs] Loading data from ./temp_data/test/human/human_Brain138_celltype.csv
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-22 03:57:00,393][dance][_load_raw_data] Loaded expression data: AnnData object with n_obs √ó n_vars = 466 √ó 22088
[INFO][2024-03-22 03:57:00,393][dance][_load_raw_data] Number of training samples: 262
[INFO][2024-03-22 03:57:00,394][dance][_load_raw_data] Number of valid samples: 66
[INFO][2024-03-22 03:57:00,394][dance][_load_raw_data] Number of testing samples: 138
[INFO][2024-03-22 03:57:00,394][dance][_load_raw_data] Cell-types (n=8):
['OPC',
 'astrocytes',
 'endothelial',
 'fetal_quiescent',
 'hybrid',
 'microglia',
 'neurons',
 'oligodendrocytes']
[WARNING][2024-03-22 03:57:00,411][dance][cell_label_to_df] 25 cells (out of 466) did not match any training cell-types.
[INFO][2024-03-22 03:57:00,412][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 466 √ó 22088
    uns: 'dance_config'
    obsm: 'cell_type'
[INFO][2024-03-22 03:57:00,412][dance][wrapped_func] Took 0:00:06.832852 to load and process data.
[WARNING][2024-03-22 03:57:00,422][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:57:00,423][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:57:00,424][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-22 03:57:00,446][dance.FilterGenesPlaceHolder][__call__] n_counts will be added to the var of data
[WARNING][2024-03-22 03:57:00,447][dance.FilterGenesPlaceHolder][__call__] n_cells will be added to the var of data
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[WARNING][2024-03-22 03:57:06,081][dance][wrapped_func] The function 'FeatureCellPlaceHolder' (/home/zyxing/dance/dance/transforms/cell_feature.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-22 03:57:06,085][dance][set_config_from_dict] Setting config 'feature_channel' to 'feature.cell'
[INFO][2024-03-22 03:57:06,085][dance][set_config_from_dict] Setting config 'label_channel' to 'cell_type'
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.018 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:       acc ‚ñÅ
wandb:  test_acc ‚ñÅ
wandb: train_acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb:       acc 0.86364
wandb:  test_acc 0.83333
wandb: train_acc 0.99618
wandb: 
wandb: üöÄ View run sage-sweep-20 at: https://wandb.ai/xzy11632/dance-dev/runs/treo6mod
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240322_035647-treo6mod/logs
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 9.206581979768952
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 9873
    span: 0.26978083947355846
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 9.544665379196298
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 373
    span: 0.2784398487682679
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 2.294798436447565
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 5291
    span: 0.36112135297278225
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 6.843046799207333
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 8957
    span: 0.5202403618953619
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 1.3384993820772724
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 195
    span: 0.11879563045359127
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 6.334795253364226
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 8300
    span: 0.5692558281324022
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 4.242684727203432
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 669
    span: 0.3348271742231017
- type: feature.cell
  desc: null
  target: FeatureCellPlaceHolder
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: feature.cell
      label_channel: cell_type

