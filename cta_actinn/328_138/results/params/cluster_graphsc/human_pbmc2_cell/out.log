/home/zyxing/dance/dance/utils/matrix.py:178: NumbaExperimentalFeatureWarning: First-class function type feature is experimental
  for j in numba.prange(n):
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numba/np/ufunc/parallel.py:371: NumbaWarning: The TBB threading layer requires TBB version 2021 update 6 or later i.e., TBB_INTERFACE_VERSION >= 12060. Found TBB_INTERFACE_VERSION = 12050. The TBB threading layer is disabled.
  warnings.warn(problem)
[INFO][2024-03-15 23:10:27,301][dance][<module>] 
{'activation': 'relu',
 'agg': 'sum',
 'batch_size': 128,
 'cache': False,
 'count': 400,
 'data_dir': './temp_data',
 'dataset': 'human_pbmc2_cell',
 'device': 'cuda:1',
 'dropout': 0.1,
 'edge_norm': True,
 'epochs': 100,
 'eval_epoch': False,
 'hidden_1': 300,
 'hidden_2': 0,
 'hidden_bn': False,
 'hidden_dim': 200,
 'hidden_relu': False,
 'learning_rate': 1e-05,
 'n_hidden': 1,
 'n_layers': 1,
 'nb_genes': 3000,
 'node_features': 'scale',
 'normalize_weights': 'log_per_cell',
 'num_run': 1,
 'num_workers': 1,
 'plot': False,
 'root_path': '/home/zyxing/dance/examples/tuning/cluster_graphsc',
 'same_edge_values': False,
 'seed': 0,
 'show_epoch_ari': False,
 'summary_file_path': 'results/pipeline/best_test_acc.csv',
 'sweep_id': None,
 'tune_mode': 'pipeline_params'}
[INFO][2024-03-15 23:10:27,301][dance][<module>] 
 files is saved in /home/zyxing/dance/examples/tuning/cluster_graphsc/human_pbmc2_cell
[INFO][2024-03-15 23:10:27,323][dance][config] tune mode is set to pipeline_params,tune_mode will first be converted to pipeline
[INFO][2024-03-15 23:10:27,326][dance][wandb_sweep] Sweep config:
{'entity': 'xzy11632',
 'method': 'grid',
 'metric': {'goal': 'maximize', 'name': 'acc'},
 'parameters': {'pipeline.0.filter.gene': {'values': ['FilterGenesPercentile',
                                                      'FilterGenesPlaceHolder',
                                                      'FilterGenesScanpyOrder']},
                'pipeline.1.filter.cell': {'values': ['FilterCellsPlaceHolder',
                                                      'FilterCellsScanpyOrder']},
                'pipeline.2.normalize': {'values': ['Log1P',
                                                    'NormalizePlaceHolder',
                                                    'NormalizeTotal',
                                                    'ScTransform',
                                                    'ScaleFeature']},
                'pipeline.3.filter.gene': {'values': ['FilterGenesPlaceHolder',
                                                      'FilterGenesRegression',
                                                      'FilterGenesTopK',
                                                      'HighlyVariableGenesLogarithmizedByMeanAndDisp',
                                                      'HighlyVariableGenesLogarithmizedByTopGenes',
                                                      'HighlyVariableGenesRawCount']},
                'pipeline.4.feature.cell': {'values': ['WeightedFeaturePCA',
                                                       'WeightedFeatureSVD']}},
 'project': 'dance-dev'}
[INFO][2024-03-15 23:10:28,617][dance][wandb_sweep] [94m

	[*] Sweep ID: twij69w5
[0m
[INFO][2024-03-15 23:10:28,617][dance][wandb_sweep_agent] Spawning agent: sweep_id='twij69w5', entity='xzy11632', project='dance-dev', count=400
wandb: Agent Starting Run: wwq2dzc0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: Currently logged in as: xzy11632. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240315_231031-wwq2dzc0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fallen-sweep-1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/wwq2dzc0
[INFO][2024-03-15 23:10:37,884][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-15 23:10:38,108][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-15 23:10:38,109][dance][wrapped_func] Took 0:00:00.224454 to load and process data.
[INFO][2024-03-15 23:10:38,109][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-15 23:10:38,111][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'Log1P',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-15 23:10:38,138][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-15 23:10:38,139][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-15 23:10:38,205][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-15 23:10:38,216][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-15 23:11:08,812][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 980) (k=313)
[INFO][2024-03-15 23:11:08,813][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.02%
[INFO][2024-03-15 23:24:33,451][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-15 23:24:33,458][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-15 23:24:33,458][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-15 23:24:33,459][dance][get_feature] Indexing option for 'uns' not implemented yet.
Create sweep with ID: twij69w5
Sweep URL: https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:10<17:20, 10.51s/it]  2%|‚ñè         | 2/100 [00:17<13:35,  8.32s/it]  3%|‚ñé         | 3/100 [00:23<11:34,  7.16s/it]  4%|‚ñç         | 4/100 [00:29<11:11,  6.99s/it]  5%|‚ñå         | 5/100 [00:36<10:39,  6.74s/it]  6%|‚ñå         | 6/100 [00:43<11:04,  7.07s/it]  7%|‚ñã         | 7/100 [00:51<11:10,  7.21s/it]  8%|‚ñä         | 8/100 [00:57<10:48,  7.04s/it]  9%|‚ñâ         | 9/100 [01:03<10:09,  6.70s/it] 10%|‚ñà         | 10/100 [01:09<09:39,  6.44s/it] 11%|‚ñà         | 11/100 [01:16<09:27,  6.38s/it] 12%|‚ñà‚ñè        | 12/100 [01:22<09:14,  6.30s/it] 13%|‚ñà‚ñé        | 13/100 [01:28<09:01,  6.22s/it] 14%|‚ñà‚ñç        | 14/100 [01:34<08:48,  6.15s/it] 15%|‚ñà‚ñå        | 15/100 [01:40<08:35,  6.06s/it] 16%|‚ñà‚ñå        | 16/100 [01:45<08:18,  5.93s/it] 17%|‚ñà‚ñã        | 17/100 [01:52<08:41,  6.28s/it] 18%|‚ñà‚ñä        | 18/100 [01:59<08:50,  6.47s/it] 19%|‚ñà‚ñâ        | 19/100 [02:06<08:44,  6.48s/it] 20%|‚ñà‚ñà        | 20/100 [02:11<08:13,  6.17s/it] 21%|‚ñà‚ñà        | 21/100 [02:18<08:15,  6.28s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [02:24<08:00,  6.16s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [02:30<07:59,  6.23s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [02:36<07:41,  6.07s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [02:41<07:27,  5.97s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [02:47<07:09,  5.81s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [02:54<07:43,  6.35s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [03:01<07:34,  6.32s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [03:08<07:43,  6.52s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [03:13<07:16,  6.24s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [03:18<06:45,  5.87s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [03:25<06:52,  6.07s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [03:30<06:39,  5.96s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [03:37<06:40,  6.07s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [03:43<06:31,  6.03s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [03:50<06:48,  6.38s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [03:56<06:35,  6.28s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [04:06<07:32,  7.29s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [04:14<07:39,  7.52s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [04:21<07:31,  7.53s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [04:26<06:34,  6.69s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [04:33<06:28,  6.69s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [04:38<05:55,  6.23s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [04:43<05:34,  5.97s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [04:51<05:51,  6.39s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [04:57<05:49,  6.47s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [05:02<05:17,  6.00s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [05:09<05:20,  6.16s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [05:14<04:57,  5.84s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [05:19<04:41,  5.64s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [05:26<04:54,  6.02s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [05:31<04:41,  5.86s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [05:36<04:21,  5.56s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [05:43<04:30,  5.88s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [05:47<04:04,  5.43s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [05:52<03:56,  5.37s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [05:58<03:53,  5.42s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [06:02<03:37,  5.17s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [06:08<03:33,  5.22s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [06:12<03:19,  4.99s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [06:17<03:08,  4.82s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [06:21<03:00,  4.75s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [06:26<02:55,  4.74s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [06:32<02:58,  4.97s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [06:36<02:47,  4.78s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [06:41<02:46,  4.90s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [06:47<02:52,  5.22s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [06:51<02:31,  4.75s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [06:55<02:19,  4.50s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [06:59<02:12,  4.40s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [07:03<02:04,  4.28s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [07:07<01:56,  4.15s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [07:11<01:50,  4.09s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [07:15<01:47,  4.13s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [07:18<01:40,  4.01s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [07:23<01:37,  4.06s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [07:27<01:33,  4.06s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [07:31<01:28,  4.01s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [07:35<01:23,  3.99s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [07:39<01:19,  3.99s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [07:44<01:22,  4.36s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [07:48<01:15,  4.20s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [07:51<01:08,  4.02s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [07:55<01:03,  3.95s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [07:59<01:00,  4.01s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [08:03<00:55,  3.95s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [08:07<00:52,  4.03s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [08:11<00:47,  4.00s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [08:15<00:43,  3.99s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [08:19<00:39,  3.91s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [08:22<00:34,  3.86s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [08:26<00:30,  3.78s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [08:30<00:26,  3.82s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [08:34<00:22,  3.82s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [08:38<00:19,  3.81s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [08:41<00:15,  3.80s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [08:45<00:11,  3.77s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [08:49<00:07,  3.75s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [08:52<00:03,  3.70s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [08:56<00:00,  3.75s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [08:56<00:00,  5.37s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.015 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.28145
wandb: 
wandb: üöÄ View run fallen-sweep-1 at: https://wandb.ai/xzy11632/dance-dev/runs/wwq2dzc0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240315_231031-wwq2dzc0/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 950olu2p with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240315_233527-950olu2p
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run hopeful-sweep-2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/950olu2p
[INFO][2024-03-15 23:35:32,895][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-15 23:35:32,983][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-15 23:35:32,983][dance][wrapped_func] Took 0:00:00.087736 to load and process data.
[INFO][2024-03-15 23:35:32,983][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-15 23:35:32,986][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'Log1P',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-15 23:35:33,003][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-15 23:35:33,004][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-15 23:35:33,057][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-15 23:35:33,063][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-15 23:35:41,610][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 980) (k=623)
[INFO][2024-03-15 23:35:41,611][dance.WeightedFeatureSVD][__call__] Total explained variance: 96.20%
[INFO][2024-03-15 23:35:44,041][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-15 23:35:44,042][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-15 23:35:44,042][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-15 23:35:44,042][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:02<03:34,  2.17s/it]  2%|‚ñè         | 2/100 [00:04<03:50,  2.35s/it]  3%|‚ñé         | 3/100 [00:06<03:20,  2.06s/it]  4%|‚ñç         | 4/100 [00:07<02:47,  1.74s/it]  5%|‚ñå         | 5/100 [00:08<02:30,  1.59s/it]  6%|‚ñå         | 6/100 [00:10<02:19,  1.48s/it]  7%|‚ñã         | 7/100 [00:11<02:20,  1.51s/it]  8%|‚ñä         | 8/100 [00:13<02:15,  1.47s/it]  9%|‚ñâ         | 9/100 [00:14<02:10,  1.44s/it] 10%|‚ñà         | 10/100 [00:17<03:05,  2.06s/it] 11%|‚ñà         | 11/100 [00:22<04:05,  2.76s/it] 12%|‚ñà‚ñè        | 12/100 [00:26<04:30,  3.07s/it] 13%|‚ñà‚ñé        | 13/100 [00:30<04:49,  3.33s/it] 14%|‚ñà‚ñç        | 14/100 [00:34<05:05,  3.55s/it] 15%|‚ñà‚ñå        | 15/100 [00:37<05:07,  3.62s/it] 16%|‚ñà‚ñå        | 16/100 [00:40<04:28,  3.20s/it] 17%|‚ñà‚ñã        | 17/100 [00:42<04:07,  2.98s/it] 18%|‚ñà‚ñä        | 18/100 [00:45<04:03,  2.97s/it] 19%|‚ñà‚ñâ        | 19/100 [00:47<03:33,  2.64s/it] 20%|‚ñà‚ñà        | 20/100 [00:51<04:14,  3.18s/it] 21%|‚ñà‚ñà        | 21/100 [00:56<04:38,  3.52s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [01:00<04:48,  3.69s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [01:04<05:05,  3.97s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [01:07<04:30,  3.55s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [01:09<03:50,  3.07s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [01:11<03:19,  2.69s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [01:13<02:59,  2.45s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [01:14<02:42,  2.26s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [01:17<02:38,  2.23s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [01:19<02:36,  2.24s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [01:21<02:27,  2.14s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:23<02:26,  2.15s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:25<02:27,  2.20s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:27<02:20,  2.13s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:29<02:21,  2.18s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:34<02:58,  2.79s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:38<03:25,  3.27s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:43<03:50,  3.72s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:46<03:44,  3.68s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:50<03:37,  3.63s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:53<03:25,  3.49s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:57<03:22,  3.48s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [02:00<03:16,  3.44s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [02:03<03:13,  3.45s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [02:07<03:06,  3.40s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [02:10<03:03,  3.40s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [02:13<02:57,  3.34s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [02:17<02:51,  3.30s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [02:20<02:49,  3.32s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [02:23<02:45,  3.31s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [02:26<02:42,  3.32s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [02:30<02:34,  3.23s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [02:32<02:18,  2.94s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [02:34<02:03,  2.67s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [02:36<01:53,  2.53s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [02:38<01:45,  2.39s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [02:41<01:45,  2.45s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [02:43<01:39,  2.37s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [02:45<01:33,  2.27s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [02:47<01:29,  2.23s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [02:49<01:26,  2.21s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [02:52<01:25,  2.25s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [02:54<01:23,  2.26s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [02:56<01:19,  2.21s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [02:58<01:17,  2.20s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [03:01<01:17,  2.27s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [03:02<01:11,  2.17s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [03:04<01:07,  2.11s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [03:07<01:06,  2.14s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [03:09<01:03,  2.11s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [03:11<00:59,  2.06s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [03:13<00:58,  2.09s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [03:15<00:53,  1.98s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [03:16<00:50,  1.95s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [03:18<00:47,  1.92s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [03:20<00:43,  1.82s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [03:21<00:40,  1.77s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [03:23<00:38,  1.75s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [03:27<00:51,  2.47s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [03:34<01:15,  3.79s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [03:39<01:16,  4.05s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [03:46<01:32,  5.12s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [03:55<01:43,  6.11s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [04:02<01:42,  6.38s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [04:08<01:35,  6.40s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [04:14<01:27,  6.25s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [04:20<01:20,  6.15s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [04:27<01:16,  6.39s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [04:35<01:14,  6.81s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [04:41<01:06,  6.66s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [04:47<00:58,  6.48s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [04:53<00:50,  6.27s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [05:01<00:46,  6.67s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [05:08<00:40,  6.77s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [05:13<00:32,  6.45s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [05:19<00:24,  6.17s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [05:24<00:17,  5.96s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [05:30<00:11,  5.77s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [05:36<00:05,  5.97s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [05:41<00:00,  5.77s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [05:41<00:00,  3.42s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.022 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.253
wandb: 
wandb: üöÄ View run hopeful-sweep-2 at: https://wandb.ai/xzy11632/dance-dev/runs/950olu2p
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240315_233527-950olu2p/logs
wandb: Agent Starting Run: 88sro6a0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240315_234330-88sro6a0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run atomic-sweep-3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/88sro6a0
[INFO][2024-03-15 23:43:38,720][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-15 23:43:38,990][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-15 23:43:38,991][dance][wrapped_func] Took 0:00:00.139742 to load and process data.
[INFO][2024-03-15 23:43:38,991][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-15 23:43:38,995][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'Log1P',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-15 23:43:39,019][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-15 23:43:39,125][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-15 23:43:39,359][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.017 MB of 0.024 MB uploadedwandb: \ 0.017 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run atomic-sweep-3 at: https://wandb.ai/xzy11632/dance-dev/runs/88sro6a0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240315_234330-88sro6a0/logs
wandb: ERROR Run 88sro6a0 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1020) out of bounds (980)
wandb: ERROR 
wandb: Agent Starting Run: 3xt3vxbg with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240315_234357-3xt3vxbg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run zany-sweep-4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/3xt3vxbg
[INFO][2024-03-15 23:44:08,970][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-15 23:44:09,108][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-15 23:44:09,108][dance][wrapped_func] Took 0:00:00.137650 to load and process data.
[INFO][2024-03-15 23:44:09,109][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-15 23:44:09,111][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'Log1P',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-15 23:44:09,137][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-15 23:44:09,214][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-15 23:44:09,445][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.018 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run zany-sweep-4 at: https://wandb.ai/xzy11632/dance-dev/runs/3xt3vxbg
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240315_234357-3xt3vxbg/logs
wandb: ERROR Run 3xt3vxbg errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1020) out of bounds (980)
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: hl4fueqw with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240315_234432-hl4fueqw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rose-sweep-5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/hl4fueqw
[INFO][2024-03-15 23:44:40,579][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-15 23:44:40,712][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-15 23:44:40,712][dance][wrapped_func] Took 0:00:00.132770 to load and process data.
[INFO][2024-03-15 23:44:40,712][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-15 23:44:40,714][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'Log1P',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-15 23:44:40,733][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-15 23:44:40,788][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-15 23:44:57,729][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=124)
[INFO][2024-03-15 23:44:57,735][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.11%
[INFO][2024-03-15 23:59:58,791][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-15 23:59:58,791][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-15 23:59:58,792][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-15 23:59:58,792][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:25,  1.47s/it]  2%|‚ñè         | 2/100 [00:02<02:20,  1.43s/it]  3%|‚ñé         | 3/100 [00:04<02:21,  1.46s/it]  4%|‚ñç         | 4/100 [00:05<02:21,  1.48s/it]  5%|‚ñå         | 5/100 [00:07<02:24,  1.52s/it]  6%|‚ñå         | 6/100 [00:08<02:17,  1.46s/it]  7%|‚ñã         | 7/100 [00:10<02:14,  1.44s/it]  8%|‚ñä         | 8/100 [00:11<02:15,  1.47s/it]  9%|‚ñâ         | 9/100 [00:13<02:18,  1.52s/it] 10%|‚ñà         | 10/100 [00:16<03:01,  2.02s/it] 11%|‚ñà         | 11/100 [00:19<03:13,  2.17s/it] 12%|‚ñà‚ñè        | 12/100 [00:21<03:08,  2.14s/it] 13%|‚ñà‚ñé        | 13/100 [00:22<02:53,  1.99s/it] 14%|‚ñà‚ñç        | 14/100 [00:24<02:34,  1.80s/it] 15%|‚ñà‚ñå        | 15/100 [00:25<02:25,  1.71s/it] 16%|‚ñà‚ñå        | 16/100 [00:26<02:15,  1.61s/it] 17%|‚ñà‚ñã        | 17/100 [00:28<02:09,  1.56s/it] 18%|‚ñà‚ñä        | 18/100 [00:29<02:04,  1.51s/it] 19%|‚ñà‚ñâ        | 19/100 [00:31<01:57,  1.46s/it] 20%|‚ñà‚ñà        | 20/100 [00:32<01:50,  1.38s/it] 21%|‚ñà‚ñà        | 21/100 [00:33<01:44,  1.33s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:34<01:44,  1.34s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:36<01:42,  1.33s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:37<01:40,  1.32s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:38<01:37,  1.30s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:40<01:38,  1.33s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:41<01:34,  1.29s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:42<01:33,  1.29s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:43<01:29,  1.26s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:45<01:25,  1.23s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:46<01:27,  1.27s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:47<01:31,  1.34s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:49<01:33,  1.39s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:52<01:58,  1.79s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:54<02:03,  1.90s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:55<01:56,  1.82s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:57<01:46,  1.70s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:58<01:35,  1.54s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:59<01:27,  1.44s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:01<01:23,  1.40s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:02<01:22,  1.40s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:03<01:23,  1.44s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:05<01:17,  1.36s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:06<01:15,  1.36s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:07<01:14,  1.36s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:09<01:16,  1.42s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:11<01:18,  1.47s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:12<01:14,  1.43s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:13<01:10,  1.39s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:15<01:13,  1.46s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:16<01:08,  1.40s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:18<01:08,  1.44s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:19<01:07,  1.44s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:20<01:02,  1.37s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:22<01:02,  1.39s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:23<01:02,  1.42s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:25<01:02,  1.44s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:26<00:56,  1.35s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:27<00:54,  1.32s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:28<00:52,  1.31s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:29<00:48,  1.25s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:31<00:47,  1.24s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:32<00:46,  1.26s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:33<00:42,  1.19s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:34<00:40,  1.15s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:36<00:43,  1.27s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:37<00:42,  1.28s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:38<00:40,  1.27s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:39<00:39,  1.29s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:41<00:38,  1.27s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:42<00:37,  1.28s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:43<00:34,  1.22s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:44<00:34,  1.27s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:46<00:31,  1.23s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:48<00:36,  1.48s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:49<00:33,  1.41s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:50<00:31,  1.37s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:51<00:28,  1.31s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:52<00:26,  1.24s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:54<00:25,  1.28s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:55<00:24,  1.27s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:56<00:23,  1.32s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:58<00:21,  1.27s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:59<00:19,  1.23s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:00<00:17,  1.19s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:01<00:16,  1.18s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:02<00:14,  1.15s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:03<00:14,  1.19s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:05<00:12,  1.17s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:06<00:11,  1.15s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:07<00:10,  1.17s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:08<00:09,  1.16s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:09<00:08,  1.17s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:10<00:06,  1.13s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:11<00:05,  1.12s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:13<00:04,  1.15s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:14<00:03,  1.19s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:15<00:02,  1.31s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:17<00:01,  1.54s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:20<00:00,  1.86s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:20<00:00,  1.41s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.31606
wandb: 
wandb: üöÄ View run rose-sweep-5 at: https://wandb.ai/xzy11632/dance-dev/runs/hl4fueqw
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240315_234432-hl4fueqw/logs
wandb: Agent Starting Run: jf96bmer with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_000525-jf96bmer
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glad-sweep-6
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/jf96bmer
[INFO][2024-03-16 00:05:31,683][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 00:05:31,776][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 00:05:31,777][dance][wrapped_func] Took 0:00:00.093064 to load and process data.
[INFO][2024-03-16 00:05:31,777][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 00:05:31,779][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'Log1P',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 00:05:31,795][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 00:05:31,881][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 00:05:36,366][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=120)
[INFO][2024-03-16 00:05:36,367][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.03%
[INFO][2024-03-16 00:05:41,305][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 00:05:41,306][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 00:05:41,307][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 00:05:41,307][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:57,  1.79s/it]  2%|‚ñè         | 2/100 [00:03<02:54,  1.78s/it]  3%|‚ñé         | 3/100 [00:04<02:24,  1.49s/it]  4%|‚ñç         | 4/100 [00:05<02:12,  1.38s/it]  5%|‚ñå         | 5/100 [00:07<02:07,  1.34s/it]  6%|‚ñå         | 6/100 [00:08<02:09,  1.37s/it]  7%|‚ñã         | 7/100 [00:09<02:07,  1.37s/it]  8%|‚ñä         | 8/100 [00:11<02:01,  1.32s/it]  9%|‚ñâ         | 9/100 [00:12<01:56,  1.28s/it] 10%|‚ñà         | 10/100 [00:13<01:53,  1.26s/it] 11%|‚ñà         | 11/100 [00:14<01:47,  1.21s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<01:52,  1.28s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<02:05,  1.45s/it] 14%|‚ñà‚ñç        | 14/100 [00:20<02:43,  1.91s/it] 15%|‚ñà‚ñå        | 15/100 [00:23<03:07,  2.21s/it] 16%|‚ñà‚ñå        | 16/100 [00:27<03:51,  2.76s/it] 17%|‚ñà‚ñã        | 17/100 [00:30<03:55,  2.84s/it] 18%|‚ñà‚ñä        | 18/100 [00:32<03:18,  2.43s/it] 19%|‚ñà‚ñâ        | 19/100 [00:33<02:45,  2.04s/it] 20%|‚ñà‚ñà        | 20/100 [00:34<02:27,  1.84s/it] 21%|‚ñà‚ñà        | 21/100 [00:36<02:13,  1.69s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:37<02:06,  1.63s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:39<01:58,  1.53s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:40<01:56,  1.53s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:41<01:50,  1.48s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:43<01:53,  1.53s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:45<01:54,  1.56s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:46<01:54,  1.60s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:48<01:57,  1.66s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:50<01:49,  1.57s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:51<01:44,  1.51s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:53<01:47,  1.58s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:54<01:38,  1.47s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:55<01:32,  1.40s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:56<01:29,  1.38s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:58<01:24,  1.32s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:59<01:21,  1.30s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:00<01:18,  1.26s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:01<01:18,  1.29s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:03<01:15,  1.26s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:04<01:10,  1.20s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:05<01:06,  1.15s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:06<01:07,  1.19s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:07<01:06,  1.20s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:08<01:06,  1.21s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:10<01:03,  1.18s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:11<01:04,  1.21s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:12<01:08,  1.31s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:14<01:05,  1.28s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:15<01:03,  1.27s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:18<01:29,  1.82s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:20<01:34,  1.96s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:22<01:30,  1.92s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:24<01:26,  1.88s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:25<01:17,  1.72s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:26<01:07,  1.55s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:28<01:04,  1.51s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:29<00:59,  1.41s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:30<00:55,  1.34s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:31<00:52,  1.31s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:33<00:51,  1.31s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:34<00:47,  1.25s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:35<00:44,  1.21s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:36<00:42,  1.19s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:37<00:41,  1.19s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:39<00:41,  1.22s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:40<00:39,  1.19s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:41<00:36,  1.14s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:42<00:38,  1.23s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:43<00:36,  1.22s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:44<00:34,  1.20s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:47<00:41,  1.50s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:48<00:38,  1.42s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:49<00:34,  1.31s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:50<00:32,  1.30s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:51<00:30,  1.27s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:52<00:28,  1.22s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:53<00:25,  1.15s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:56<00:29,  1.42s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:58<00:33,  1.67s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:59<00:31,  1.65s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:01<00:27,  1.55s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:04<00:34,  2.06s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:09<00:45,  2.84s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:11<00:41,  2.78s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:14<00:40,  2.88s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:17<00:37,  2.85s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:20<00:33,  2.78s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:22<00:29,  2.69s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:25<00:27,  2.76s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:28<00:25,  2.84s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:31<00:22,  2.83s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:34<00:19,  2.85s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:36<00:16,  2.78s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:39<00:14,  2.82s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:42<00:11,  2.80s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:45<00:08,  2.82s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:48<00:05,  2.86s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:51<00:03,  3.00s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:55<00:00,  3.22s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:55<00:00,  1.76s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.33306
wandb: 
wandb: üöÄ View run glad-sweep-6 at: https://wandb.ai/xzy11632/dance-dev/runs/jf96bmer
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_000525-jf96bmer/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: zivqmauz with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_001232-zivqmauz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run summer-sweep-7
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/zivqmauz
[INFO][2024-03-16 00:12:46,783][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 00:12:47,001][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 00:12:47,002][dance][wrapped_func] Took 0:00:00.218659 to load and process data.
[INFO][2024-03-16 00:12:47,010][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 00:12:47,012][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 00:12:47,058][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 00:12:47,199][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 00:13:05,129][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 161) (k=67)
[INFO][2024-03-16 00:13:05,130][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.02%
[INFO][2024-03-16 00:24:11,582][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 00:24:11,584][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 00:24:11,584][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 00:24:11,584][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:17,  1.39s/it]  2%|‚ñè         | 2/100 [00:02<02:12,  1.35s/it]  3%|‚ñé         | 3/100 [00:03<02:01,  1.25s/it]  4%|‚ñç         | 4/100 [00:05<01:58,  1.23s/it]  5%|‚ñå         | 5/100 [00:06<01:54,  1.21s/it]  6%|‚ñå         | 6/100 [00:07<01:49,  1.17s/it]  7%|‚ñã         | 7/100 [00:08<01:44,  1.12s/it]  8%|‚ñä         | 8/100 [00:09<01:40,  1.09s/it]  9%|‚ñâ         | 9/100 [00:10<01:38,  1.08s/it] 10%|‚ñà         | 10/100 [00:11<01:37,  1.08s/it] 11%|‚ñà         | 11/100 [00:12<01:33,  1.05s/it] 12%|‚ñà‚ñè        | 12/100 [00:13<01:31,  1.03s/it] 13%|‚ñà‚ñé        | 13/100 [00:14<01:30,  1.04s/it] 14%|‚ñà‚ñç        | 14/100 [00:15<01:29,  1.04s/it] 15%|‚ñà‚ñå        | 15/100 [00:16<01:28,  1.04s/it] 16%|‚ñà‚ñå        | 16/100 [00:17<01:30,  1.08s/it] 17%|‚ñà‚ñã        | 17/100 [00:18<01:27,  1.06s/it] 18%|‚ñà‚ñä        | 18/100 [00:19<01:25,  1.04s/it] 19%|‚ñà‚ñâ        | 19/100 [00:20<01:23,  1.03s/it] 20%|‚ñà‚ñà        | 20/100 [00:21<01:22,  1.03s/it] 21%|‚ñà‚ñà        | 21/100 [00:23<01:25,  1.08s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:24<01:26,  1.11s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:25<01:23,  1.08s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:26<01:22,  1.08s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:27<01:21,  1.09s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:28<01:28,  1.20s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:30<01:27,  1.20s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:31<01:25,  1.19s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:32<01:26,  1.21s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:33<01:26,  1.23s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:34<01:22,  1.19s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:36<01:19,  1.17s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:37<01:18,  1.18s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:38<01:14,  1.13s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:39<01:13,  1.13s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:40<01:10,  1.10s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:41<01:09,  1.11s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:42<01:08,  1.10s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:43<01:06,  1.09s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:44<01:06,  1.10s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:45<01:05,  1.11s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:46<01:03,  1.09s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:48<01:03,  1.11s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:49<01:02,  1.12s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:50<01:03,  1.15s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:51<01:01,  1.14s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:52<00:59,  1.12s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:53<00:57,  1.10s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:54<00:58,  1.14s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:56<01:02,  1.24s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:57<00:57,  1.17s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:58<00:57,  1.20s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:00<01:01,  1.30s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:01<01:05,  1.43s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:03<01:01,  1.38s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:04<01:00,  1.38s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:05<00:56,  1.31s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:06<00:52,  1.26s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:07<00:47,  1.15s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:08<00:43,  1.09s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:09<00:42,  1.09s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:10<00:39,  1.04s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:11<00:39,  1.07s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:12<00:37,  1.05s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:14<00:37,  1.06s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:15<00:36,  1.08s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:16<00:35,  1.08s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:17<00:34,  1.08s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:18<00:35,  1.15s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:19<00:33,  1.12s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:20<00:31,  1.10s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:21<00:29,  1.07s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:22<00:28,  1.07s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:23<00:27,  1.06s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:24<00:26,  1.05s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:25<00:25,  1.05s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:26<00:23,  1.04s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:27<00:22,  1.03s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:29<00:21,  1.05s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:30<00:20,  1.05s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:31<00:20,  1.07s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:32<00:19,  1.10s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:33<00:19,  1.13s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:34<00:18,  1.14s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:35<00:16,  1.11s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:37<00:18,  1.33s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:39<00:19,  1.49s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:41<00:19,  1.60s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:42<00:17,  1.55s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:44<00:14,  1.47s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:45<00:12,  1.40s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:46<00:10,  1.29s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:47<00:08,  1.22s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:48<00:07,  1.17s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:49<00:05,  1.17s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:50<00:04,  1.11s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:51<00:03,  1.06s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:52<00:02,  1.05s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:53<00:01,  1.04s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:54<00:00,  1.05s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:54<00:00,  1.15s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.29038
wandb: 
wandb: üöÄ View run summer-sweep-7 at: https://wandb.ai/xzy11632/dance-dev/runs/zivqmauz
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_001232-zivqmauz/logs
wandb: Agent Starting Run: qy7stlbe with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_002823-qy7stlbe
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run vibrant-sweep-8
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/qy7stlbe
[INFO][2024-03-16 00:28:33,772][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 00:28:33,895][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 00:28:33,896][dance][wrapped_func] Took 0:00:00.122653 to load and process data.
[INFO][2024-03-16 00:28:33,896][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 00:28:33,900][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 00:28:33,923][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 00:28:34,018][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 00:28:57,770][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 161) (k=79)
[INFO][2024-03-16 00:28:57,771][dance.WeightedFeatureSVD][__call__] Total explained variance: 91.89%
[INFO][2024-03-16 00:43:20,784][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 00:43:20,785][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 00:43:20,785][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 00:43:20,786][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:53,  1.14s/it]  2%|‚ñè         | 2/100 [00:02<01:48,  1.10s/it]  3%|‚ñé         | 3/100 [00:03<01:45,  1.09s/it]  4%|‚ñç         | 4/100 [00:04<01:48,  1.13s/it]  5%|‚ñå         | 5/100 [00:05<01:45,  1.12s/it]  6%|‚ñå         | 6/100 [00:06<01:42,  1.09s/it]  7%|‚ñã         | 7/100 [00:07<01:38,  1.06s/it]  8%|‚ñä         | 8/100 [00:08<01:34,  1.03s/it]  9%|‚ñâ         | 9/100 [00:09<01:38,  1.09s/it] 10%|‚ñà         | 10/100 [00:10<01:37,  1.08s/it] 11%|‚ñà         | 11/100 [00:11<01:33,  1.05s/it] 12%|‚ñà‚ñè        | 12/100 [00:12<01:29,  1.02s/it] 13%|‚ñà‚ñé        | 13/100 [00:13<01:29,  1.02s/it] 14%|‚ñà‚ñç        | 14/100 [00:14<01:29,  1.04s/it] 15%|‚ñà‚ñå        | 15/100 [00:15<01:29,  1.06s/it] 16%|‚ñà‚ñå        | 16/100 [00:17<01:27,  1.05s/it] 17%|‚ñà‚ñã        | 17/100 [00:18<01:29,  1.08s/it] 18%|‚ñà‚ñä        | 18/100 [00:19<01:27,  1.07s/it] 19%|‚ñà‚ñâ        | 19/100 [00:20<01:27,  1.08s/it] 20%|‚ñà‚ñà        | 20/100 [00:21<01:24,  1.06s/it] 21%|‚ñà‚ñà        | 21/100 [00:22<01:24,  1.07s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:23<01:23,  1.07s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:24<01:20,  1.05s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:25<01:18,  1.03s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:26<01:16,  1.02s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:27<01:17,  1.05s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:28<01:16,  1.04s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:29<01:14,  1.04s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:30<01:15,  1.07s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:31<01:16,  1.09s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:33<01:15,  1.09s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:34<01:15,  1.11s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:35<01:17,  1.16s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:36<01:14,  1.12s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:37<01:12,  1.11s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:38<01:11,  1.12s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:39<01:06,  1.06s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:40<01:04,  1.05s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:41<01:03,  1.04s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:42<01:01,  1.03s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:43<00:59,  1.01s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:44<01:00,  1.05s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:46<01:03,  1.11s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:47<01:01,  1.10s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:48<01:00,  1.10s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:49<00:59,  1.10s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:50<00:59,  1.12s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:51<00:57,  1.10s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:52<00:57,  1.12s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:54<01:05,  1.30s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:55<01:00,  1.24s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:56<00:56,  1.18s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:57<00:54,  1.16s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:58<00:52,  1.14s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:59<00:51,  1.16s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:01<00:49,  1.13s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:02<00:48,  1.12s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:03<00:45,  1.09s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:04<00:45,  1.11s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:05<00:46,  1.16s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:06<00:45,  1.16s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:07<00:44,  1.16s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:08<00:42,  1.14s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:10<00:40,  1.12s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:11<00:38,  1.10s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:12<00:37,  1.10s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:13<00:35,  1.09s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:14<00:34,  1.08s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:15<00:33,  1.09s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:16<00:32,  1.10s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:17<00:32,  1.13s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:19<00:35,  1.27s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:21<00:38,  1.43s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:22<00:38,  1.49s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:24<00:35,  1.43s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:25<00:33,  1.38s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:26<00:31,  1.39s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:28<00:32,  1.46s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:29<00:31,  1.49s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:31<00:30,  1.51s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:33<00:28,  1.51s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:34<00:26,  1.49s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:35<00:24,  1.43s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:36<00:21,  1.33s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:37<00:19,  1.27s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:38<00:16,  1.19s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:39<00:14,  1.13s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:41<00:13,  1.11s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:42<00:11,  1.08s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:43<00:10,  1.06s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:44<00:09,  1.07s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:45<00:08,  1.11s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:46<00:07,  1.08s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:47<00:06,  1.07s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:48<00:05,  1.07s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:49<00:04,  1.07s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:50<00:03,  1.05s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:51<00:02,  1.09s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:53<00:01,  1.18s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:54<00:00,  1.23s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:54<00:00,  1.14s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.022 MB of 0.025 MB uploadedwandb: / 0.022 MB of 0.025 MB uploadedwandb: - 0.022 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.27337
wandb: 
wandb: üöÄ View run vibrant-sweep-8 at: https://wandb.ai/xzy11632/dance-dev/runs/qy7stlbe
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_002823-qy7stlbe/logs
wandb: Agent Starting Run: rmghay2y with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_004741-rmghay2y
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run cool-sweep-9
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/rmghay2y
[INFO][2024-03-16 00:47:50,226][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 00:47:50,369][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 00:47:50,369][dance][wrapped_func] Took 0:00:00.143078 to load and process data.
[INFO][2024-03-16 00:47:50,370][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 00:47:50,372][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 00:47:50,394][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 00:47:50,458][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 00:48:08,069][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=42)
[INFO][2024-03-16 00:48:08,070][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.07%
[INFO][2024-03-16 01:06:27,516][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 01:06:27,517][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 01:06:27,517][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 01:06:27,517][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:21,  1.43s/it]  2%|‚ñè         | 2/100 [00:02<02:19,  1.43s/it]  3%|‚ñé         | 3/100 [00:04<02:19,  1.44s/it]  4%|‚ñç         | 4/100 [00:05<02:21,  1.47s/it]  5%|‚ñå         | 5/100 [00:07<02:18,  1.46s/it]  6%|‚ñå         | 6/100 [00:08<02:11,  1.40s/it]  7%|‚ñã         | 7/100 [00:09<02:09,  1.39s/it]  8%|‚ñä         | 8/100 [00:11<02:09,  1.41s/it]  9%|‚ñâ         | 9/100 [00:12<02:07,  1.40s/it] 10%|‚ñà         | 10/100 [00:13<02:00,  1.34s/it] 11%|‚ñà         | 11/100 [00:15<01:55,  1.30s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<01:52,  1.28s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<01:46,  1.22s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<01:45,  1.22s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<01:40,  1.18s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<01:36,  1.14s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:32,  1.12s/it] 18%|‚ñà‚ñä        | 18/100 [00:22<01:30,  1.10s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<01:31,  1.13s/it] 20%|‚ñà‚ñà        | 20/100 [00:25<01:31,  1.14s/it] 21%|‚ñà‚ñà        | 21/100 [00:26<01:33,  1.19s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:27<01:34,  1.21s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:28<01:30,  1.18s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:30<01:30,  1.19s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:31<01:24,  1.13s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:32<01:20,  1.09s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:33<01:22,  1.13s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:34<01:19,  1.10s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:35<01:16,  1.08s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:36<01:16,  1.09s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:37<01:14,  1.09s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:38<01:11,  1.05s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:39<01:09,  1.04s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:40<01:11,  1.08s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:42<01:13,  1.13s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:43<01:13,  1.14s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:44<01:11,  1.14s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:45<01:07,  1.09s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:46<01:04,  1.06s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:47<01:05,  1.10s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:48<01:05,  1.10s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:49<01:03,  1.09s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:50<01:02,  1.10s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:51<01:02,  1.11s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:52<00:59,  1.08s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:54<00:57,  1.07s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:55<00:55,  1.05s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:56<00:53,  1.04s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:57<00:52,  1.02s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:58<00:52,  1.04s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:59<00:51,  1.05s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:00<00:49,  1.03s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:01<00:48,  1.03s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:02<00:46,  1.01s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:03<00:45,  1.00s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:04<00:43,  1.02it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:05<00:42,  1.02it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:06<00:42,  1.01s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:07<00:42,  1.04s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:08<00:41,  1.03s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:09<00:41,  1.07s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:10<00:39,  1.05s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:11<00:39,  1.07s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:13<00:44,  1.25s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:14<00:48,  1.39s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:18<01:05,  1.93s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:20<01:07,  2.04s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:22<01:07,  2.10s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:25<01:08,  2.22s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:27<01:06,  2.20s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:29<01:04,  2.21s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:32<01:04,  2.30s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:34<01:03,  2.36s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:36<00:59,  2.30s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:38<00:55,  2.22s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:40<00:51,  2.16s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:43<00:50,  2.18s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:45<00:49,  2.25s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:47<00:47,  2.25s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:50<00:45,  2.29s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:52<00:43,  2.31s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:54<00:42,  2.36s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:57<00:40,  2.39s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:59<00:37,  2.37s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:01<00:34,  2.32s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:04<00:32,  2.33s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:06<00:30,  2.34s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:08<00:27,  2.26s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:10<00:24,  2.26s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:13<00:22,  2.25s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:15<00:19,  2.20s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:17<00:17,  2.20s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:19<00:15,  2.17s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:21<00:13,  2.18s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:23<00:10,  2.17s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:25<00:08,  2.13s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:28<00:06,  2.13s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:30<00:04,  2.09s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:32<00:02,  2.13s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:34<00:00,  2.15s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:34<00:00,  1.54s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.22991
wandb: 
wandb: üöÄ View run cool-sweep-9 at: https://wandb.ai/xzy11632/dance-dev/runs/rmghay2y
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_004741-rmghay2y/logs
wandb: Agent Starting Run: vseesm9m with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_011136-vseesm9m
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fast-sweep-10
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/vseesm9m
[INFO][2024-03-16 01:11:44,560][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 01:11:44,672][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 01:11:44,673][dance][wrapped_func] Took 0:00:00.111913 to load and process data.
[INFO][2024-03-16 01:11:44,673][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 01:11:44,677][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 01:11:44,723][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 01:11:44,881][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 01:12:36,792][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=97)
[INFO][2024-03-16 01:12:36,794][dance.WeightedFeatureSVD][__call__] Total explained variance: 95.21%
[INFO][2024-03-16 01:25:23,566][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 01:25:23,567][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 01:25:23,568][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 01:25:23,568][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:27,  1.49s/it]  2%|‚ñè         | 2/100 [00:02<02:19,  1.43s/it]  3%|‚ñé         | 3/100 [00:04<02:08,  1.33s/it]  4%|‚ñç         | 4/100 [00:05<01:54,  1.19s/it]  5%|‚ñå         | 5/100 [00:06<01:49,  1.16s/it]  6%|‚ñå         | 6/100 [00:07<01:45,  1.12s/it]  7%|‚ñã         | 7/100 [00:08<01:40,  1.08s/it]  8%|‚ñä         | 8/100 [00:09<01:40,  1.10s/it]  9%|‚ñâ         | 9/100 [00:10<01:41,  1.11s/it] 10%|‚ñà         | 10/100 [00:11<01:40,  1.12s/it] 11%|‚ñà         | 11/100 [00:12<01:43,  1.16s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:46,  1.21s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:43,  1.19s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:42,  1.20s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:41,  1.20s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<01:40,  1.19s/it] 17%|‚ñà‚ñã        | 17/100 [00:20<01:40,  1.21s/it] 18%|‚ñà‚ñä        | 18/100 [00:21<01:43,  1.26s/it] 19%|‚ñà‚ñâ        | 19/100 [00:22<01:42,  1.26s/it] 20%|‚ñà‚ñà        | 20/100 [00:23<01:37,  1.22s/it] 21%|‚ñà‚ñà        | 21/100 [00:25<01:35,  1.21s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:26<01:33,  1.20s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:27<01:35,  1.24s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:28<01:36,  1.26s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:30<01:38,  1.31s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:31<01:41,  1.37s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:33<01:45,  1.44s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:35<01:46,  1.48s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:36<01:37,  1.38s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:37<01:31,  1.31s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:38<01:28,  1.29s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:39<01:24,  1.25s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:41<01:23,  1.24s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:42<01:21,  1.24s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:43<01:21,  1.25s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:44<01:20,  1.26s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:45<01:17,  1.23s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:47<01:18,  1.27s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:48<01:20,  1.32s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:50<01:20,  1.34s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:51<01:18,  1.32s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:52<01:14,  1.28s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:53<01:09,  1.22s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:54<01:08,  1.23s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:56<01:07,  1.22s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:57<01:05,  1.22s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:58<01:05,  1.24s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:00<01:07,  1.29s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:01<01:03,  1.24s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:02<01:01,  1.22s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:03<01:01,  1.25s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:04<01:00,  1.26s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:06<00:58,  1.25s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:07<00:56,  1.24s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:08<00:55,  1.23s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:09<00:53,  1.21s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:10<00:52,  1.21s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:12<00:50,  1.20s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:13<00:49,  1.21s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:15<00:53,  1.34s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:16<00:57,  1.47s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:18<00:53,  1.40s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:19<00:50,  1.36s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:20<00:46,  1.30s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:21<00:42,  1.21s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:22<00:39,  1.16s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:23<00:37,  1.13s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:24<00:35,  1.12s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:25<00:35,  1.14s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:26<00:33,  1.11s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:27<00:31,  1.09s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:29<00:31,  1.12s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:30<00:31,  1.18s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:31<00:30,  1.16s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:32<00:29,  1.18s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:33<00:27,  1.14s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:35<00:26,  1.16s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:36<00:26,  1.19s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:37<00:25,  1.21s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:38<00:24,  1.21s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:39<00:22,  1.20s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:41<00:21,  1.20s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:42<00:20,  1.19s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:43<00:19,  1.20s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:44<00:18,  1.23s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:46<00:17,  1.24s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:47<00:17,  1.34s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:48<00:15,  1.25s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:50<00:14,  1.31s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:51<00:13,  1.31s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:52<00:11,  1.33s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:54<00:11,  1.49s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:56<00:11,  1.66s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:59<00:11,  1.90s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:00<00:08,  1.76s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:02<00:06,  1.70s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:03<00:05,  1.72s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:05<00:03,  1.79s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:08<00:01,  1.97s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:10<00:00,  1.96s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:10<00:00,  1.30s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.017 MB of 0.025 MB uploadedwandb: | 0.017 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.22651
wandb: 
wandb: üöÄ View run fast-sweep-10 at: https://wandb.ai/xzy11632/dance-dev/runs/vseesm9m
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_011136-vseesm9m/logs
wandb: Agent Starting Run: 2ndx4p1l with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_012940-2ndx4p1l
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run driven-sweep-11
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/2ndx4p1l
[INFO][2024-03-16 01:29:48,813][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 01:29:48,900][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 01:29:48,909][dance][wrapped_func] Took 0:00:00.095445 to load and process data.
[INFO][2024-03-16 01:29:48,910][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 01:29:48,913][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 01:29:48,951][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 01:29:49,011][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 01:30:04,766][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=35)
[INFO][2024-03-16 01:30:04,766][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.02%
[INFO][2024-03-16 01:43:11,259][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 01:43:11,260][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 01:43:11,260][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 01:43:11,261][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:07,  1.28s/it]  2%|‚ñè         | 2/100 [00:02<01:56,  1.19s/it]  3%|‚ñé         | 3/100 [00:03<01:45,  1.09s/it]  4%|‚ñç         | 4/100 [00:04<01:41,  1.06s/it]  5%|‚ñå         | 5/100 [00:05<01:40,  1.06s/it]  6%|‚ñå         | 6/100 [00:06<01:39,  1.06s/it]  7%|‚ñã         | 7/100 [00:07<01:42,  1.11s/it]  8%|‚ñä         | 8/100 [00:08<01:41,  1.10s/it]  9%|‚ñâ         | 9/100 [00:10<01:43,  1.14s/it] 10%|‚ñà         | 10/100 [00:11<01:44,  1.16s/it] 11%|‚ñà         | 11/100 [00:12<01:43,  1.16s/it] 12%|‚ñà‚ñè        | 12/100 [00:13<01:40,  1.15s/it] 13%|‚ñà‚ñé        | 13/100 [00:14<01:43,  1.19s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:43,  1.20s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:42,  1.21s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<01:44,  1.24s/it] 17%|‚ñà‚ñã        | 17/100 [00:19<01:38,  1.19s/it] 18%|‚ñà‚ñä        | 18/100 [00:20<01:36,  1.18s/it] 19%|‚ñà‚ñâ        | 19/100 [00:21<01:34,  1.16s/it] 20%|‚ñà‚ñà        | 20/100 [00:23<01:36,  1.21s/it] 21%|‚ñà‚ñà        | 21/100 [00:24<01:37,  1.23s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:25<01:36,  1.23s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:26<01:35,  1.24s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:28<01:34,  1.24s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:29<01:31,  1.22s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:30<01:31,  1.24s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:31<01:30,  1.24s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:33<01:27,  1.21s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:34<01:24,  1.19s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:35<01:22,  1.18s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:36<01:25,  1.24s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:37<01:23,  1.23s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:39<01:23,  1.25s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:40<01:21,  1.24s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:41<01:18,  1.21s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:42<01:17,  1.21s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:44<01:23,  1.33s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:45<01:25,  1.39s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:47<01:25,  1.40s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:48<01:20,  1.35s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:49<01:15,  1.29s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:50<01:12,  1.25s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:52<01:08,  1.21s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:53<01:07,  1.20s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:54<01:03,  1.16s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:55<01:03,  1.18s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:56<01:02,  1.18s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:57<00:59,  1.15s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:58<00:58,  1.14s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:00<00:57,  1.15s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:01<00:58,  1.19s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:02<00:57,  1.19s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:03<00:54,  1.16s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:04<00:53,  1.17s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:06<01:00,  1.35s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:07<01:00,  1.37s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:09<00:57,  1.34s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:10<00:54,  1.29s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:11<00:50,  1.24s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:12<00:48,  1.21s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:13<00:47,  1.22s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:15<00:46,  1.22s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:16<00:46,  1.24s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:17<00:43,  1.22s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:18<00:42,  1.23s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:19<00:39,  1.16s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:21<00:38,  1.16s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:22<00:36,  1.14s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:23<00:34,  1.12s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:24<00:34,  1.15s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:25<00:34,  1.20s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:26<00:32,  1.17s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:27<00:30,  1.12s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:28<00:29,  1.12s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:30<00:28,  1.16s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:31<00:28,  1.17s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:32<00:26,  1.14s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:33<00:25,  1.16s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:34<00:24,  1.16s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:36<00:27,  1.38s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:39<00:34,  1.83s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:41<00:35,  1.95s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:43<00:32,  1.88s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:45<00:29,  1.82s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:46<00:26,  1.75s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:48<00:24,  1.74s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:50<00:22,  1.75s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:51<00:20,  1.67s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:53<00:17,  1.59s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:54<00:15,  1.55s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:56<00:13,  1.51s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:57<00:12,  1.56s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:59<00:10,  1.57s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:01<00:09,  1.64s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:02<00:08,  1.67s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:04<00:06,  1.68s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:06<00:05,  1.76s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:08<00:03,  1.76s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:10<00:01,  1.76s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:11<00:00,  1.77s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:11<00:00,  1.32s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.21717
wandb: 
wandb: üöÄ View run driven-sweep-11 at: https://wandb.ai/xzy11632/dance-dev/runs/2ndx4p1l
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_012940-2ndx4p1l/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: asl1yye1 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_014818-asl1yye1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run celestial-sweep-12
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/asl1yye1
[INFO][2024-03-16 01:48:31,624][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 01:48:31,833][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 01:48:31,834][dance][wrapped_func] Took 0:00:00.209012 to load and process data.
[INFO][2024-03-16 01:48:31,834][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 01:48:31,837][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 01:48:31,889][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 01:48:32,026][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 01:49:26,382][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=98)
[INFO][2024-03-16 01:49:26,398][dance.WeightedFeatureSVD][__call__] Total explained variance: 95.48%
[INFO][2024-03-16 02:02:34,825][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 02:02:34,825][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 02:02:34,825][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 02:02:34,826][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:50,  1.11s/it]  2%|‚ñè         | 2/100 [00:02<01:44,  1.07s/it]  3%|‚ñé         | 3/100 [00:03<01:46,  1.09s/it]  4%|‚ñç         | 4/100 [00:04<01:47,  1.12s/it]  5%|‚ñå         | 5/100 [00:05<01:47,  1.13s/it]  6%|‚ñå         | 6/100 [00:06<01:40,  1.07s/it]  7%|‚ñã         | 7/100 [00:07<01:36,  1.04s/it]  8%|‚ñä         | 8/100 [00:08<01:36,  1.04s/it]  9%|‚ñâ         | 9/100 [00:09<01:33,  1.03s/it] 10%|‚ñà         | 10/100 [00:10<01:36,  1.07s/it] 11%|‚ñà         | 11/100 [00:11<01:37,  1.10s/it] 12%|‚ñà‚ñè        | 12/100 [00:12<01:36,  1.10s/it] 13%|‚ñà‚ñé        | 13/100 [00:14<01:33,  1.08s/it] 14%|‚ñà‚ñç        | 14/100 [00:15<01:31,  1.06s/it] 15%|‚ñà‚ñå        | 15/100 [00:16<01:40,  1.19s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<02:01,  1.44s/it] 17%|‚ñà‚ñã        | 17/100 [00:20<02:17,  1.65s/it] 18%|‚ñà‚ñä        | 18/100 [00:22<02:15,  1.65s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<02:20,  1.74s/it] 20%|‚ñà‚ñà        | 20/100 [00:25<02:14,  1.68s/it] 21%|‚ñà‚ñà        | 21/100 [00:27<02:14,  1.71s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:28<02:04,  1.59s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:30<02:08,  1.67s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:33<02:20,  1.85s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:34<02:18,  1.85s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:36<02:11,  1.78s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:37<01:57,  1.62s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:38<01:45,  1.46s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:40<01:37,  1.37s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:41<01:29,  1.28s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:42<01:25,  1.24s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:43<01:22,  1.22s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:44<01:19,  1.19s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:45<01:15,  1.14s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:46<01:11,  1.10s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:47<01:11,  1.11s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:48<01:12,  1.14s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:49<01:09,  1.12s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:51<01:06,  1.10s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:52<01:06,  1.10s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:53<01:05,  1.11s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:54<01:05,  1.12s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:55<01:09,  1.22s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:57<01:08,  1.22s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:58<01:09,  1.27s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:59<01:07,  1.24s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:00<01:04,  1.22s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:01<01:00,  1.17s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:03<01:01,  1.21s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:04<01:01,  1.24s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:06<01:07,  1.38s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:07<01:05,  1.37s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:08<01:00,  1.29s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:09<00:57,  1.25s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:10<00:53,  1.19s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:11<00:50,  1.15s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:12<00:47,  1.11s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:13<00:45,  1.08s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:15<00:46,  1.12s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:16<00:48,  1.21s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:17<00:46,  1.20s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:18<00:44,  1.18s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:19<00:43,  1.16s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:21<00:43,  1.20s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:22<00:42,  1.21s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:23<00:43,  1.29s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:25<00:41,  1.26s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:26<00:40,  1.26s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:27<00:38,  1.25s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:28<00:37,  1.26s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:30<00:36,  1.25s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:31<00:35,  1.26s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:32<00:34,  1.28s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:33<00:32,  1.24s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:35<00:30,  1.23s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:36<00:29,  1.21s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:37<00:28,  1.25s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:38<00:27,  1.25s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:40<00:26,  1.27s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:41<00:24,  1.24s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:42<00:23,  1.26s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:44<00:23,  1.28s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:45<00:22,  1.31s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:46<00:20,  1.27s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:47<00:19,  1.27s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:49<00:17,  1.27s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:50<00:16,  1.25s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:51<00:16,  1.37s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:53<00:16,  1.47s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:55<00:14,  1.45s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:56<00:12,  1.40s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:57<00:10,  1.32s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:58<00:09,  1.29s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:59<00:07,  1.22s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:00<00:06,  1.22s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:01<00:04,  1.15s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:03<00:03,  1.15s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:04<00:02,  1.16s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:05<00:01,  1.16s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:06<00:00,  1.14s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:06<00:00,  1.27s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.22524
wandb: 
wandb: üöÄ View run celestial-sweep-12 at: https://wandb.ai/xzy11632/dance-dev/runs/asl1yye1
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_014818-asl1yye1/logs
wandb: Agent Starting Run: 4et286cc with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_020623-4et286cc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run light-sweep-13
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/4et286cc
[INFO][2024-03-16 02:06:31,261][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 02:06:31,428][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 02:06:31,429][dance][wrapped_func] Took 0:00:00.166638 to load and process data.
[INFO][2024-03-16 02:06:31,429][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 02:06:31,433][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 02:06:31,468][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 02:06:31,469][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 02:06:31,469][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 02:06:31,560][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 02:06:31,561][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 02:06:31,562][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 02:08:52,015][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 980) (k=5)
[INFO][2024-03-16 02:08:52,016][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.99%
[INFO][2024-03-16 02:22:02,001][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 02:22:02,001][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 02:22:02,001][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 02:22:02,001][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<03:13,  1.96s/it]  2%|‚ñè         | 2/100 [00:03<02:52,  1.77s/it]  3%|‚ñé         | 3/100 [00:05<02:36,  1.61s/it]  4%|‚ñç         | 4/100 [00:06<02:26,  1.53s/it]  5%|‚ñå         | 5/100 [00:07<02:21,  1.49s/it]  6%|‚ñå         | 6/100 [00:09<02:14,  1.43s/it]  7%|‚ñã         | 7/100 [00:10<02:07,  1.37s/it]  8%|‚ñä         | 8/100 [00:11<02:05,  1.36s/it]  9%|‚ñâ         | 9/100 [00:13<02:03,  1.36s/it] 10%|‚ñà         | 10/100 [00:14<02:08,  1.43s/it] 11%|‚ñà         | 11/100 [00:16<02:14,  1.51s/it] 12%|‚ñà‚ñè        | 12/100 [00:18<02:34,  1.76s/it] 13%|‚ñà‚ñé        | 13/100 [00:20<02:35,  1.79s/it] 14%|‚ñà‚ñç        | 14/100 [00:22<02:35,  1.81s/it] 15%|‚ñà‚ñå        | 15/100 [00:24<02:37,  1.85s/it] 16%|‚ñà‚ñå        | 16/100 [00:26<02:45,  1.97s/it] 17%|‚ñà‚ñã        | 17/100 [00:28<02:37,  1.90s/it] 18%|‚ñà‚ñä        | 18/100 [00:30<02:32,  1.86s/it] 19%|‚ñà‚ñâ        | 19/100 [00:31<02:28,  1.83s/it] 20%|‚ñà‚ñà        | 20/100 [00:33<02:21,  1.77s/it] 21%|‚ñà‚ñà        | 21/100 [00:35<02:13,  1.69s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:36<02:06,  1.62s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:37<01:57,  1.52s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:39<01:53,  1.50s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:40<01:50,  1.48s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:41<01:44,  1.42s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:43<01:46,  1.46s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:44<01:41,  1.42s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:46<01:38,  1.38s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:47<01:36,  1.38s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:48<01:32,  1.34s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:49<01:28,  1.31s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:51<01:25,  1.27s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:52<01:22,  1.25s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:53<01:19,  1.23s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:54<01:19,  1.24s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:55<01:15,  1.20s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:57<01:16,  1.23s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:58<01:14,  1.22s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:59<01:16,  1.27s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:01<01:18,  1.33s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:02<01:18,  1.35s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:04<01:18,  1.38s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:05<01:13,  1.31s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:06<01:11,  1.29s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:07<01:10,  1.31s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:08<01:05,  1.24s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:10<01:04,  1.24s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:11<01:03,  1.25s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:13<01:09,  1.40s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:14<01:12,  1.47s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:16<01:11,  1.50s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:17<01:05,  1.39s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:18<01:00,  1.31s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:19<00:58,  1.31s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:21<00:54,  1.24s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:22<00:50,  1.18s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:23<00:50,  1.21s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:24<00:50,  1.23s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:26<00:51,  1.30s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:28<01:01,  1.58s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:29<00:58,  1.55s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:31<01:00,  1.63s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:33<01:02,  1.72s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:34<00:56,  1.62s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:36<00:52,  1.54s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:37<00:47,  1.43s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:38<00:44,  1.40s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:40<00:42,  1.38s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:41<00:42,  1.41s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:43<00:41,  1.43s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:44<00:39,  1.40s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:45<00:37,  1.37s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:46<00:35,  1.35s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:48<00:34,  1.38s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:49<00:33,  1.41s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:51<00:31,  1.36s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:52<00:29,  1.34s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:53<00:27,  1.31s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:54<00:25,  1.29s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:56<00:24,  1.28s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:57<00:22,  1.27s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:58<00:20,  1.23s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:59<00:19,  1.24s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:01<00:18,  1.23s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:02<00:17,  1.22s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:03<00:16,  1.26s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:04<00:14,  1.23s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:05<00:13,  1.21s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:07<00:11,  1.19s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:08<00:10,  1.21s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:09<00:09,  1.19s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:10<00:08,  1.24s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:12<00:07,  1.27s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:13<00:06,  1.25s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:14<00:04,  1.22s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:16<00:03,  1.33s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:17<00:02,  1.29s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:18<00:01,  1.26s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:19<00:00,  1.31s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:19<00:00,  1.40s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.021 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.19726
wandb: 
wandb: üöÄ View run light-sweep-13 at: https://wandb.ai/xzy11632/dance-dev/runs/4et286cc
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_020623-4et286cc/logs
wandb: Agent Starting Run: 2w05lgnc with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_022554-2w05lgnc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run neat-sweep-14
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/2w05lgnc
[INFO][2024-03-16 02:26:01,207][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 02:26:01,295][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 02:26:01,295][dance][wrapped_func] Took 0:00:00.087669 to load and process data.
[INFO][2024-03-16 02:26:01,296][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 02:26:01,297][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 02:26:01,310][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 02:26:01,310][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 02:26:01,310][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 02:26:01,346][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 02:26:01,346][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 02:26:01,346][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 02:26:20,684][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 980) (k=33)
[INFO][2024-03-16 02:26:20,684][dance.WeightedFeatureSVD][__call__] Total explained variance: 95.65%
[INFO][2024-03-16 02:26:38,748][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 02:26:38,749][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 02:26:38,749][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 02:26:38,749][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:02<04:12,  2.55s/it]  2%|‚ñè         | 2/100 [00:04<03:13,  1.97s/it]  3%|‚ñé         | 3/100 [00:05<02:46,  1.71s/it]  4%|‚ñç         | 4/100 [00:07<02:37,  1.64s/it]  5%|‚ñå         | 5/100 [00:08<02:18,  1.45s/it]  6%|‚ñå         | 6/100 [00:09<02:07,  1.36s/it]  7%|‚ñã         | 7/100 [00:10<02:05,  1.35s/it]  8%|‚ñä         | 8/100 [00:11<01:57,  1.27s/it]  9%|‚ñâ         | 9/100 [00:12<01:53,  1.25s/it] 10%|‚ñà         | 10/100 [00:14<01:51,  1.24s/it] 11%|‚ñà         | 11/100 [00:15<01:47,  1.21s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<01:51,  1.27s/it] 13%|‚ñà‚ñé        | 13/100 [00:18<01:52,  1.29s/it] 14%|‚ñà‚ñç        | 14/100 [00:19<01:48,  1.27s/it] 15%|‚ñà‚ñå        | 15/100 [00:20<01:45,  1.24s/it] 16%|‚ñà‚ñå        | 16/100 [00:21<01:51,  1.32s/it] 17%|‚ñà‚ñã        | 17/100 [00:23<01:54,  1.37s/it] 18%|‚ñà‚ñä        | 18/100 [00:25<01:57,  1.43s/it] 19%|‚ñà‚ñâ        | 19/100 [00:26<02:01,  1.50s/it] 20%|‚ñà‚ñà        | 20/100 [00:27<01:54,  1.43s/it] 21%|‚ñà‚ñà        | 21/100 [00:29<01:48,  1.37s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:30<01:46,  1.37s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:31<01:42,  1.33s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:33<01:40,  1.32s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:34<01:49,  1.46s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:38<02:41,  2.18s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:40<02:31,  2.08s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:42<02:16,  1.90s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:43<02:02,  1.72s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:46<02:27,  2.11s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:52<03:46,  3.28s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:56<03:57,  3.50s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:00<04:00,  3.59s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:04<04:02,  3.67s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:08<04:05,  3.78s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:12<04:07,  3.86s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:16<04:08,  3.94s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:20<04:11,  4.05s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:25<04:16,  4.21s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:29<04:11,  4.20s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:33<04:06,  4.17s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:37<03:57,  4.09s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:41<03:53,  4.09s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:46<03:59,  4.28s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:49<03:41,  4.03s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:52<03:27,  3.83s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:56<03:17,  3.72s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [02:00<03:11,  3.68s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [02:03<03:07,  3.67s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [02:07<03:03,  3.67s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [02:12<03:17,  4.02s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [02:20<04:16,  5.35s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [02:27<04:35,  5.86s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [02:36<05:16,  6.88s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [02:44<05:16,  7.03s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [02:51<05:14,  7.14s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [02:58<04:57,  6.93s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [03:05<04:50,  6.93s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [03:12<04:54,  7.19s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [03:20<04:47,  7.19s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [03:26<04:25,  6.81s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [03:32<04:15,  6.73s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [03:39<04:06,  6.67s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [03:50<04:48,  8.01s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [04:00<05:02,  8.65s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [04:12<05:29,  9.69s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [04:25<05:50, 10.63s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [04:34<05:24, 10.14s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [04:43<05:07,  9.92s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [04:55<05:16, 10.54s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [05:06<05:06, 10.56s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [05:14<04:34,  9.82s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [05:23<04:17,  9.55s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [05:34<04:18,  9.92s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [05:43<04:00,  9.63s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [05:51<03:41,  9.23s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [06:01<03:40,  9.60s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [06:11<03:33,  9.70s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [06:19<03:08,  8.99s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [06:26<02:52,  8.63s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [06:35<02:43,  8.60s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [06:42<02:24,  8.03s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [06:50<02:20,  8.27s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [06:58<02:08,  8.00s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [07:04<01:50,  7.38s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [07:10<01:36,  6.93s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [07:15<01:25,  6.56s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [07:22<01:18,  6.58s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [07:29<01:12,  6.61s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [07:35<01:04,  6.46s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [07:40<00:54,  6.10s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [07:46<00:48,  6.06s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [07:51<00:40,  5.78s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [07:57<00:34,  5.70s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [08:02<00:28,  5.62s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [08:08<00:23,  5.86s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [08:14<00:17,  5.73s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [08:19<00:11,  5.67s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [08:24<00:05,  5.45s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [08:30<00:00,  5.40s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [08:30<00:00,  5.10s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.32055
wandb: 
wandb: üöÄ View run neat-sweep-14 at: https://wandb.ai/xzy11632/dance-dev/runs/2w05lgnc
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_022554-2w05lgnc/logs
wandb: Agent Starting Run: nquwckwg with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_023720-nquwckwg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glorious-sweep-15
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/nquwckwg
[INFO][2024-03-16 02:37:27,018][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 02:37:27,117][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 02:37:27,117][dance][wrapped_func] Took 0:00:00.098261 to load and process data.
[INFO][2024-03-16 02:37:27,118][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 02:37:27,120][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 02:37:27,137][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 02:37:27,138][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 02:37:27,190][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 02:37:27,194][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 02:37:27,361][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run glorious-sweep-15 at: https://wandb.ai/xzy11632/dance-dev/runs/nquwckwg
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_023720-nquwckwg/logs
wandb: ERROR Run nquwckwg errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1020) out of bounds (980)
wandb: ERROR 
wandb: Agent Starting Run: 0su4d0ff with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_023741-0su4d0ff
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run silvery-sweep-16
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/0su4d0ff
[INFO][2024-03-16 02:37:47,918][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 02:37:48,110][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 02:37:48,111][dance][wrapped_func] Took 0:00:00.191326 to load and process data.
[INFO][2024-03-16 02:37:48,111][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 02:37:48,113][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 02:37:48,131][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 02:37:48,131][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 02:37:48,188][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 02:37:48,188][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 02:37:48,438][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.020 MB of 0.024 MB uploadedwandb: / 0.020 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run silvery-sweep-16 at: https://wandb.ai/xzy11632/dance-dev/runs/0su4d0ff
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_023741-0su4d0ff/logs
wandb: ERROR Run 0su4d0ff errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1020) out of bounds (980)
wandb: ERROR 
wandb: Agent Starting Run: 6m3d5rxf with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_023808-6m3d5rxf
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lively-sweep-17
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/6m3d5rxf
[INFO][2024-03-16 02:38:14,185][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 02:38:14,304][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 02:38:14,305][dance][wrapped_func] Took 0:00:00.118957 to load and process data.
[INFO][2024-03-16 02:38:14,305][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 02:38:14,308][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 02:38:14,330][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 02:38:14,331][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 02:38:14,381][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 02:38:14,382][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 02:38:14,681][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=6)
[INFO][2024-03-16 02:38:14,681][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.93%
[INFO][2024-03-16 02:38:17,638][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 02:38:17,639][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 02:38:17,639][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 02:38:17,639][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:53,  1.15s/it]  2%|‚ñè         | 2/100 [00:02<01:57,  1.20s/it]  3%|‚ñé         | 3/100 [00:03<01:56,  1.20s/it]  4%|‚ñç         | 4/100 [00:04<01:51,  1.16s/it]  5%|‚ñå         | 5/100 [00:05<01:46,  1.12s/it]  6%|‚ñå         | 6/100 [00:06<01:43,  1.10s/it]  7%|‚ñã         | 7/100 [00:07<01:41,  1.09s/it]  8%|‚ñä         | 8/100 [00:08<01:41,  1.10s/it]  9%|‚ñâ         | 9/100 [00:10<01:40,  1.10s/it] 10%|‚ñà         | 10/100 [00:11<01:40,  1.11s/it] 11%|‚ñà         | 11/100 [00:12<01:38,  1.11s/it] 12%|‚ñà‚ñè        | 12/100 [00:13<01:32,  1.05s/it] 13%|‚ñà‚ñé        | 13/100 [00:14<01:32,  1.07s/it] 14%|‚ñà‚ñç        | 14/100 [00:15<01:31,  1.07s/it] 15%|‚ñà‚ñå        | 15/100 [00:16<01:33,  1.10s/it] 16%|‚ñà‚ñå        | 16/100 [00:17<01:33,  1.11s/it] 17%|‚ñà‚ñã        | 17/100 [00:18<01:31,  1.10s/it] 18%|‚ñà‚ñä        | 18/100 [00:19<01:30,  1.10s/it] 19%|‚ñà‚ñâ        | 19/100 [00:20<01:28,  1.09s/it] 20%|‚ñà‚ñà        | 20/100 [00:21<01:24,  1.05s/it] 21%|‚ñà‚ñà        | 21/100 [00:22<01:22,  1.04s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:23<01:21,  1.04s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:25<01:21,  1.06s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:26<01:23,  1.10s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:27<01:21,  1.08s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:28<01:18,  1.06s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:29<01:17,  1.06s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:30<01:14,  1.03s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:31<01:15,  1.06s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:32<01:18,  1.13s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:33<01:18,  1.14s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:34<01:14,  1.10s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:36<01:14,  1.12s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:37<01:12,  1.10s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:38<01:10,  1.08s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:39<01:09,  1.09s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:40<01:13,  1.17s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:41<01:12,  1.17s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:43<01:13,  1.20s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:44<01:10,  1.17s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:45<01:07,  1.15s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:46<01:04,  1.10s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:47<01:02,  1.09s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:48<01:01,  1.11s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:49<01:01,  1.12s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:50<01:03,  1.17s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:52<01:01,  1.16s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:53<01:02,  1.19s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:54<01:01,  1.20s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:55<01:00,  1.21s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:56<00:57,  1.16s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:58<00:56,  1.17s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:59<00:53,  1.14s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:00<00:52,  1.13s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:01<00:50,  1.13s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:02<00:49,  1.13s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:03<00:49,  1.16s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:04<00:48,  1.15s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:06<00:48,  1.19s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:07<00:47,  1.19s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:08<00:46,  1.20s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:09<00:43,  1.14s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:10<00:41,  1.14s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:11<00:39,  1.08s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:12<00:38,  1.11s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:13<00:36,  1.09s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:15<00:36,  1.11s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:16<00:35,  1.10s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:17<00:34,  1.11s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:18<00:33,  1.13s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:19<00:32,  1.13s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:20<00:30,  1.10s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:21<00:29,  1.08s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:22<00:29,  1.12s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:23<00:28,  1.15s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:25<00:26,  1.11s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:26<00:25,  1.11s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:27<00:24,  1.12s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:28<00:23,  1.10s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:29<00:22,  1.12s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:30<00:20,  1.10s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:31<00:20,  1.13s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:32<00:18,  1.12s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:33<00:17,  1.10s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:34<00:15,  1.05s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:35<00:14,  1.05s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:37<00:14,  1.09s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:38<00:12,  1.08s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:39<00:12,  1.09s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:40<00:10,  1.07s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:41<00:09,  1.06s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:42<00:08,  1.09s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:43<00:07,  1.07s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:44<00:06,  1.08s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:45<00:05,  1.08s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:46<00:04,  1.09s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:47<00:03,  1.10s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:49<00:02,  1.12s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:50<00:01,  1.22s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:51<00:00,  1.21s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:51<00:00,  1.12s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.018 MB of 0.025 MB uploadedwandb: / 0.018 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.20404
wandb: 
wandb: üöÄ View run lively-sweep-17 at: https://wandb.ai/xzy11632/dance-dev/runs/6m3d5rxf
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_023808-6m3d5rxf/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: j1hqz3pp with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_024227-j1hqz3pp
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wobbly-sweep-18
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/j1hqz3pp
[INFO][2024-03-16 02:42:36,330][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 02:42:36,441][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 02:42:36,442][dance][wrapped_func] Took 0:00:00.104743 to load and process data.
[INFO][2024-03-16 02:42:36,442][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 02:42:36,444][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 02:42:36,463][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 02:42:36,463][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 02:42:36,522][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 02:42:36,522][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 02:43:15,400][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=6)
[INFO][2024-03-16 02:43:15,401][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.88%
[INFO][2024-03-16 02:57:04,197][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 02:57:04,198][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 02:57:04,198][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 02:57:04,198][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:40,  1.62s/it]  2%|‚ñè         | 2/100 [00:03<02:43,  1.67s/it]  3%|‚ñé         | 3/100 [00:05<02:47,  1.73s/it]  4%|‚ñç         | 4/100 [00:06<02:45,  1.72s/it]  5%|‚ñå         | 5/100 [00:08<02:39,  1.68s/it]  6%|‚ñå         | 6/100 [00:10<02:41,  1.72s/it]  7%|‚ñã         | 7/100 [00:12<02:43,  1.76s/it]  8%|‚ñä         | 8/100 [00:13<02:34,  1.68s/it]  9%|‚ñâ         | 9/100 [00:15<02:29,  1.64s/it] 10%|‚ñà         | 10/100 [00:16<02:19,  1.55s/it] 11%|‚ñà         | 11/100 [00:17<02:14,  1.51s/it] 12%|‚ñà‚ñè        | 12/100 [00:19<02:08,  1.46s/it] 13%|‚ñà‚ñé        | 13/100 [00:20<02:06,  1.45s/it] 14%|‚ñà‚ñç        | 14/100 [00:22<02:03,  1.44s/it] 15%|‚ñà‚ñå        | 15/100 [00:23<02:05,  1.48s/it] 16%|‚ñà‚ñå        | 16/100 [00:25<02:06,  1.51s/it] 17%|‚ñà‚ñã        | 17/100 [00:26<02:08,  1.55s/it] 18%|‚ñà‚ñä        | 18/100 [00:28<02:02,  1.49s/it] 19%|‚ñà‚ñâ        | 19/100 [00:29<02:01,  1.50s/it] 20%|‚ñà‚ñà        | 20/100 [00:31<02:01,  1.52s/it] 21%|‚ñà‚ñà        | 21/100 [00:32<01:57,  1.49s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:34<01:56,  1.50s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:35<01:53,  1.47s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:37<01:51,  1.47s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:38<01:47,  1.43s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:39<01:43,  1.40s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:41<01:41,  1.39s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:42<01:42,  1.42s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:44<01:41,  1.43s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:45<01:42,  1.46s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:47<01:38,  1.43s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:48<01:34,  1.40s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:49<01:33,  1.40s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:51<01:33,  1.42s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:52<01:31,  1.41s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:53<01:29,  1.40s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:55<01:31,  1.45s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:56<01:28,  1.43s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:58<01:29,  1.46s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:59<01:25,  1.42s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:01<01:22,  1.40s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:02<01:22,  1.41s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:03<01:19,  1.40s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:05<01:19,  1.42s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:06<01:18,  1.43s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:08<01:13,  1.37s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:09<01:07,  1.27s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:10<01:05,  1.26s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:11<01:03,  1.25s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:12<01:02,  1.25s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:14<01:00,  1.23s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:15<00:56,  1.18s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:16<00:56,  1.19s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:17<00:54,  1.18s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:18<00:54,  1.21s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:19<00:51,  1.17s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:21<00:53,  1.24s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:22<00:51,  1.23s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:23<00:50,  1.23s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:24<00:46,  1.17s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:25<00:44,  1.15s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:27<00:45,  1.19s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:28<00:42,  1.16s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:29<00:43,  1.20s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:30<00:41,  1.19s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:31<00:39,  1.17s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:32<00:38,  1.16s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:34<00:37,  1.16s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:35<00:35,  1.16s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:36<00:35,  1.19s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:37<00:33,  1.16s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:38<00:33,  1.21s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:40<00:32,  1.20s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:41<00:30,  1.19s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:42<00:29,  1.20s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:43<00:29,  1.22s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:44<00:27,  1.20s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:46<00:26,  1.21s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:47<00:25,  1.20s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:48<00:23,  1.20s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:49<00:22,  1.18s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:50<00:20,  1.16s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:51<00:19,  1.16s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:53<00:18,  1.17s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:54<00:17,  1.18s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:55<00:16,  1.19s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:56<00:15,  1.21s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:57<00:14,  1.20s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:58<00:12,  1.14s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:59<00:10,  1.08s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:01<00:09,  1.11s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:02<00:08,  1.10s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:03<00:08,  1.16s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:04<00:06,  1.15s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:05<00:05,  1.15s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:06<00:04,  1.13s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:07<00:03,  1.07s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:08<00:02,  1.12s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:10<00:01,  1.17s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:11<00:00,  1.20s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:11<00:00,  1.32s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.17584
wandb: 
wandb: üöÄ View run wobbly-sweep-18 at: https://wandb.ai/xzy11632/dance-dev/runs/j1hqz3pp
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_024227-j1hqz3pp/logs
wandb: Agent Starting Run: ulcbh8oe with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_030101-ulcbh8oe
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run distinctive-sweep-19
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ulcbh8oe
[INFO][2024-03-16 03:01:29,853][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 03:01:29,991][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 03:01:29,992][dance][wrapped_func] Took 0:00:00.137415 to load and process data.
[INFO][2024-03-16 03:01:29,993][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 03:01:29,997][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 03:01:30,023][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 03:01:30,023][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 03:01:30,092][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 03:01:30,092][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run distinctive-sweep-19 at: https://wandb.ai/xzy11632/dance-dev/runs/ulcbh8oe
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_030101-ulcbh8oe/logs
wandb: ERROR Run ulcbh8oe errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 23or59tc with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_030158-23or59tc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run brisk-sweep-20
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/23or59tc
[INFO][2024-03-16 03:02:26,525][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 03:02:26,668][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 03:02:26,668][dance][wrapped_func] Took 0:00:00.142871 to load and process data.
[INFO][2024-03-16 03:02:26,669][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 03:02:26,671][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 03:02:26,691][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 03:02:26,692][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 03:02:26,773][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 03:02:26,774][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.013 MB uploadedwandb: / 0.012 MB of 0.013 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run brisk-sweep-20 at: https://wandb.ai/xzy11632/dance-dev/runs/23or59tc
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_030158-23or59tc/logs
wandb: ERROR Run 23or59tc errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: 4aqdctsm with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_030246-4aqdctsm
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run balmy-sweep-21
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/4aqdctsm
[INFO][2024-03-16 03:03:10,436][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 03:03:10,597][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 03:03:10,598][dance][wrapped_func] Took 0:00:00.161798 to load and process data.
[INFO][2024-03-16 03:03:10,599][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 03:03:10,601][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 03:03:10,640][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 03:03:10,641][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 03:03:10,710][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 03:03:10,711][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run balmy-sweep-21 at: https://wandb.ai/xzy11632/dance-dev/runs/4aqdctsm
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_030246-4aqdctsm/logs
wandb: ERROR Run 4aqdctsm errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: xbb5z8bm with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_030334-xbb5z8bm
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run valiant-sweep-22
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/xbb5z8bm
[INFO][2024-03-16 03:03:45,591][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 03:03:45,773][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 03:03:45,773][dance][wrapped_func] Took 0:00:00.181590 to load and process data.
[INFO][2024-03-16 03:03:45,774][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 03:03:45,778][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 03:03:45,849][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 03:03:45,850][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 03:03:45,967][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 03:03:45,980][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run valiant-sweep-22 at: https://wandb.ai/xzy11632/dance-dev/runs/xbb5z8bm
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_030334-xbb5z8bm/logs
wandb: ERROR Run xbb5z8bm errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: fu4pt5ts with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_030405-fu4pt5ts
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run daily-sweep-23
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/fu4pt5ts
[INFO][2024-03-16 03:04:21,744][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 03:04:21,879][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 03:04:21,880][dance][wrapped_func] Took 0:00:00.135338 to load and process data.
[INFO][2024-03-16 03:04:21,880][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 03:04:21,883][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 03:04:21,903][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 03:04:21,904][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 03:04:21,966][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 03:04:21,967][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 03:04:31,475][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=6)
[INFO][2024-03-16 03:04:31,484][dance.WeightedFeaturePCA][__call__] Total explained variance: 91.20%
[INFO][2024-03-16 03:15:56,146][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 03:15:56,147][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 03:15:56,147][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 03:15:56,147][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:27,  1.49s/it]  2%|‚ñè         | 2/100 [00:02<02:24,  1.47s/it]  3%|‚ñé         | 3/100 [00:04<02:19,  1.43s/it]  4%|‚ñç         | 4/100 [00:05<02:12,  1.38s/it]  5%|‚ñå         | 5/100 [00:07<02:12,  1.39s/it]  6%|‚ñå         | 6/100 [00:08<02:15,  1.44s/it]  7%|‚ñã         | 7/100 [00:10<02:16,  1.47s/it]  8%|‚ñä         | 8/100 [00:11<02:16,  1.49s/it]  9%|‚ñâ         | 9/100 [00:13<02:12,  1.45s/it] 10%|‚ñà         | 10/100 [00:14<02:11,  1.46s/it] 11%|‚ñà         | 11/100 [00:15<02:06,  1.42s/it] 12%|‚ñà‚ñè        | 12/100 [00:17<02:05,  1.42s/it] 13%|‚ñà‚ñé        | 13/100 [00:18<02:06,  1.46s/it] 14%|‚ñà‚ñç        | 14/100 [00:20<02:01,  1.41s/it] 15%|‚ñà‚ñå        | 15/100 [00:21<02:04,  1.47s/it] 16%|‚ñà‚ñå        | 16/100 [00:23<02:03,  1.47s/it] 17%|‚ñà‚ñã        | 17/100 [00:24<02:03,  1.49s/it] 18%|‚ñà‚ñä        | 18/100 [00:26<02:01,  1.48s/it] 19%|‚ñà‚ñâ        | 19/100 [00:28<02:10,  1.62s/it] 20%|‚ñà‚ñà        | 20/100 [00:29<02:11,  1.64s/it] 21%|‚ñà‚ñà        | 21/100 [00:31<02:01,  1.54s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:32<01:55,  1.48s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:33<01:47,  1.39s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:34<01:40,  1.32s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:35<01:35,  1.27s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:36<01:27,  1.18s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:38<01:25,  1.18s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:39<01:22,  1.15s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:40<01:21,  1.15s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:41<01:18,  1.11s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:42<01:20,  1.16s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:43<01:18,  1.15s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:44<01:16,  1.15s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:45<01:14,  1.13s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:47<01:12,  1.11s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:48<01:11,  1.11s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:49<01:11,  1.14s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:50<01:11,  1.15s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:51<01:08,  1.13s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:52<01:05,  1.10s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:53<01:04,  1.09s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:54<01:02,  1.08s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:55<01:01,  1.09s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:56<01:00,  1.09s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:58<01:01,  1.12s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:59<00:59,  1.10s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:00<00:56,  1.07s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:01<00:56,  1.10s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:02<00:56,  1.10s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:03<00:56,  1.13s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:04<00:54,  1.10s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:05<00:52,  1.09s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:06<00:50,  1.07s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:07<00:50,  1.10s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:09<00:51,  1.15s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:10<00:50,  1.14s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:11<00:49,  1.15s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:12<00:46,  1.10s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:13<00:43,  1.07s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:14<00:42,  1.07s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:15<00:41,  1.06s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:16<00:41,  1.09s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:17<00:41,  1.11s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:18<00:39,  1.11s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:20<00:37,  1.08s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:20<00:35,  1.05s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:21<00:34,  1.03s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:22<00:32,  1.03s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:23<00:31,  1.02s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:24<00:30,  1.00s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:25<00:28,  1.00it/s] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:27<00:31,  1.12s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:28<00:32,  1.21s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:30<00:33,  1.28s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:31<00:29,  1.17s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:32<00:26,  1.11s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:33<00:25,  1.11s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:34<00:23,  1.08s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:35<00:22,  1.05s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:36<00:20,  1.04s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:37<00:19,  1.01s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:38<00:18,  1.04s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:39<00:18,  1.06s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:40<00:16,  1.03s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:41<00:16,  1.12s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:42<00:15,  1.09s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:43<00:13,  1.05s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:44<00:12,  1.07s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:45<00:11,  1.04s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:46<00:10,  1.03s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:47<00:09,  1.10s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:49<00:08,  1.12s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:50<00:07,  1.11s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:51<00:06,  1.12s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:52<00:05,  1.17s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:53<00:04,  1.15s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:55<00:03,  1.32s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:56<00:02,  1.28s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:57<00:01,  1.24s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:58<00:00,  1.18s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:58<00:00,  1.19s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.18727
wandb: 
wandb: üöÄ View run daily-sweep-23 at: https://wandb.ai/xzy11632/dance-dev/runs/fu4pt5ts
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_030405-fu4pt5ts/logs
wandb: Agent Starting Run: t9xpewfr with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_032031-t9xpewfr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run cool-sweep-24
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/t9xpewfr
[INFO][2024-03-16 03:20:37,514][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 03:20:37,748][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 03:20:37,748][dance][wrapped_func] Took 0:00:00.233590 to load and process data.
[INFO][2024-03-16 03:20:37,748][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 03:20:37,752][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 03:20:37,785][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 03:20:37,785][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 03:20:37,846][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 03:20:37,847][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 03:21:02,060][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=8)
[INFO][2024-03-16 03:21:02,069][dance.WeightedFeatureSVD][__call__] Total explained variance: 93.16%
[INFO][2024-03-16 03:36:24,388][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 03:36:24,389][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 03:36:24,389][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 03:36:24,389][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<03:06,  1.89s/it]  2%|‚ñè         | 2/100 [00:03<03:02,  1.86s/it]  3%|‚ñé         | 3/100 [00:05<02:51,  1.77s/it]  4%|‚ñç         | 4/100 [00:06<02:43,  1.70s/it]  5%|‚ñå         | 5/100 [00:08<02:49,  1.79s/it]  6%|‚ñå         | 6/100 [00:10<02:46,  1.77s/it]  7%|‚ñã         | 7/100 [00:12<02:38,  1.71s/it]  8%|‚ñä         | 8/100 [00:13<02:38,  1.72s/it]  9%|‚ñâ         | 9/100 [00:15<02:30,  1.66s/it] 10%|‚ñà         | 10/100 [00:16<02:16,  1.52s/it] 11%|‚ñà         | 11/100 [00:17<02:04,  1.40s/it] 12%|‚ñà‚ñè        | 12/100 [00:18<01:56,  1.32s/it] 13%|‚ñà‚ñé        | 13/100 [00:20<01:51,  1.28s/it] 14%|‚ñà‚ñç        | 14/100 [00:21<01:48,  1.27s/it] 15%|‚ñà‚ñå        | 15/100 [00:22<01:47,  1.27s/it] 16%|‚ñà‚ñå        | 16/100 [00:23<01:41,  1.21s/it] 17%|‚ñà‚ñã        | 17/100 [00:25<01:44,  1.25s/it] 18%|‚ñà‚ñä        | 18/100 [00:26<01:42,  1.25s/it] 19%|‚ñà‚ñâ        | 19/100 [00:27<01:39,  1.22s/it] 20%|‚ñà‚ñà        | 20/100 [00:28<01:36,  1.21s/it] 21%|‚ñà‚ñà        | 21/100 [00:29<01:37,  1.23s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:31<01:31,  1.18s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:32<01:28,  1.15s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:33<01:27,  1.16s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:34<01:24,  1.13s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:35<01:25,  1.16s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:36<01:26,  1.18s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:38<01:26,  1.20s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:39<01:23,  1.17s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:40<01:19,  1.13s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:41<01:18,  1.13s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:42<01:19,  1.16s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:43<01:18,  1.17s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:44<01:17,  1.17s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:46<01:15,  1.16s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:47<01:13,  1.14s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:48<01:12,  1.15s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:49<01:12,  1.17s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:50<01:10,  1.16s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:51<01:08,  1.14s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:52<01:08,  1.16s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:54<01:08,  1.17s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:55<01:06,  1.17s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:56<01:04,  1.14s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:57<01:02,  1.13s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:58<01:01,  1.14s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:59<01:00,  1.13s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:00<00:59,  1.14s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:02<00:57,  1.13s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:03<00:57,  1.16s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:04<00:57,  1.18s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:05<00:56,  1.19s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:06<00:55,  1.19s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:08<00:55,  1.22s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:09<00:53,  1.19s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:10<00:54,  1.24s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:11<00:53,  1.24s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:13<00:51,  1.23s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:15<00:59,  1.46s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:17<01:05,  1.63s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:18<00:59,  1.52s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:19<00:54,  1.44s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:21<00:52,  1.41s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:22<00:47,  1.31s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:23<00:42,  1.23s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:24<00:40,  1.18s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:25<00:39,  1.19s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:26<00:37,  1.18s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:30<01:00,  1.96s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:35<01:27,  2.92s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:39<01:32,  3.20s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:43<01:36,  3.44s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:46<01:31,  3.40s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:48<01:14,  2.85s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:50<01:06,  2.65s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:53<01:08,  2.87s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:56<01:05,  2.83s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:58<00:59,  2.70s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:01<00:57,  2.75s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:04<00:55,  2.79s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:08<01:00,  3.20s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:12<01:02,  3.47s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:15<00:55,  3.25s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:16<00:41,  2.60s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:18<00:35,  2.37s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:20<00:29,  2.09s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:21<00:24,  1.85s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:22<00:20,  1.67s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:23<00:16,  1.49s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:24<00:13,  1.37s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:25<00:11,  1.27s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:26<00:09,  1.22s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:28<00:08,  1.20s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:29<00:06,  1.16s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:30<00:05,  1.14s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:31<00:04,  1.12s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:32<00:03,  1.12s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:33<00:02,  1.12s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:34<00:01,  1.12s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:35<00:00,  1.15s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:35<00:00,  1.56s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.24054
wandb: 
wandb: üöÄ View run cool-sweep-24 at: https://wandb.ai/xzy11632/dance-dev/runs/t9xpewfr
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_032031-t9xpewfr/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 002nywvh with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_034049-002nywvh
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rural-sweep-25
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/002nywvh
[INFO][2024-03-16 03:40:54,929][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 03:40:55,012][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 03:40:55,012][dance][wrapped_func] Took 0:00:00.082227 to load and process data.
[INFO][2024-03-16 03:40:55,012][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 03:40:55,014][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 03:40:55,027][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 03:40:55,027][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 03:40:55,090][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 03:40:55,160][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 03:40:57,080][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 980) (k=10)
[INFO][2024-03-16 03:40:57,080][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.21%
[INFO][2024-03-16 03:40:59,690][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 03:40:59,691][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 03:40:59,691][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 03:40:59,692][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:08,  1.30s/it]  2%|‚ñè         | 2/100 [00:02<01:54,  1.17s/it]  3%|‚ñé         | 3/100 [00:03<01:50,  1.14s/it]  4%|‚ñç         | 4/100 [00:04<01:55,  1.21s/it]  5%|‚ñå         | 5/100 [00:05<01:50,  1.17s/it]  6%|‚ñå         | 6/100 [00:06<01:47,  1.15s/it]  7%|‚ñã         | 7/100 [00:08<01:50,  1.18s/it]  8%|‚ñä         | 8/100 [00:09<01:50,  1.20s/it]  9%|‚ñâ         | 9/100 [00:10<01:48,  1.20s/it] 10%|‚ñà         | 10/100 [00:11<01:45,  1.17s/it] 11%|‚ñà         | 11/100 [00:12<01:45,  1.18s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:43,  1.18s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:44,  1.20s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<02:00,  1.40s/it] 15%|‚ñà‚ñå        | 15/100 [00:28<06:07,  4.32s/it] 16%|‚ñà‚ñå        | 16/100 [00:38<08:33,  6.11s/it] 17%|‚ñà‚ñã        | 17/100 [00:42<07:28,  5.40s/it] 18%|‚ñà‚ñä        | 18/100 [00:55<10:38,  7.79s/it] 19%|‚ñà‚ñâ        | 19/100 [01:04<11:03,  8.19s/it] 20%|‚ñà‚ñà        | 20/100 [01:11<10:27,  7.84s/it] 21%|‚ñà‚ñà        | 21/100 [01:18<09:40,  7.35s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [01:22<08:34,  6.60s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [01:28<08:08,  6.35s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [01:33<07:16,  5.75s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [01:37<06:46,  5.42s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [01:42<06:30,  5.27s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [01:46<06:00,  4.93s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [01:51<05:41,  4.75s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [01:54<05:16,  4.45s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [01:59<05:14,  4.49s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [02:03<05:05,  4.42s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [02:08<05:00,  4.42s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [02:12<04:52,  4.36s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [02:16<04:44,  4.31s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [02:20<04:37,  4.27s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [02:24<04:30,  4.23s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [02:28<04:15,  4.05s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [02:32<04:18,  4.17s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [02:37<04:20,  4.26s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [02:41<04:08,  4.15s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [02:45<04:05,  4.17s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [02:49<03:55,  4.06s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [02:53<03:54,  4.11s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [02:57<03:51,  4.13s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [03:02<04:04,  4.44s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [03:06<03:51,  4.28s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [03:10<03:39,  4.14s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [03:14<03:31,  4.06s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [03:18<03:26,  4.06s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [03:22<03:19,  3.99s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [03:26<03:18,  4.06s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [03:30<03:13,  4.02s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [03:34<03:03,  3.91s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [03:38<02:59,  3.90s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [03:41<02:53,  3.85s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [03:45<02:51,  3.91s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [03:49<02:45,  3.86s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [03:54<02:49,  4.03s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [03:58<02:49,  4.13s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [04:02<02:41,  4.03s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [04:06<02:42,  4.18s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [04:10<02:33,  4.05s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [04:14<02:28,  4.01s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [04:18<02:23,  3.97s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [04:22<02:25,  4.16s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [04:26<02:16,  4.01s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [04:30<02:15,  4.12s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [04:34<02:06,  3.96s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [04:38<02:07,  4.13s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [04:42<01:59,  3.99s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [04:47<01:59,  4.13s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [04:51<01:53,  4.07s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [04:54<01:48,  4.02s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [04:58<01:42,  3.96s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [05:02<01:35,  3.81s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [05:05<01:29,  3.74s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [05:10<01:31,  3.97s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [05:14<01:28,  4.04s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [05:18<01:23,  3.95s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [05:22<01:18,  3.93s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [05:25<01:12,  3.82s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [05:29<01:09,  3.85s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [05:33<01:04,  3.79s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [05:37<01:05,  4.06s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [05:42<01:05,  4.36s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [05:46<00:57,  4.14s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [05:50<00:52,  4.01s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [05:54<00:47,  3.96s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [05:57<00:42,  3.84s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [06:01<00:37,  3.79s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [06:05<00:34,  3.80s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [06:09<00:31,  3.90s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [06:13<00:26,  3.85s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [06:17<00:23,  3.94s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [06:20<00:19,  3.86s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [06:24<00:15,  3.80s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [06:28<00:11,  3.75s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [06:31<00:07,  3.75s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [06:35<00:03,  3.65s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [06:39<00:00,  3.68s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [06:39<00:00,  3.99s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.20809
wandb: 
wandb: üöÄ View run rural-sweep-25 at: https://wandb.ai/xzy11632/dance-dev/runs/002nywvh
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_034049-002nywvh/logs
wandb: Agent Starting Run: ggzr0tzs with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_035005-ggzr0tzs
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lemon-sweep-26
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ggzr0tzs
[INFO][2024-03-16 03:50:12,520][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 03:50:12,626][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 03:50:12,626][dance][wrapped_func] Took 0:00:00.105992 to load and process data.
[INFO][2024-03-16 03:50:12,627][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 03:50:12,630][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 03:50:12,652][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 03:50:12,653][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 03:50:12,721][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 03:50:12,799][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 03:54:32,103][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 980) (k=92)
[INFO][2024-03-16 03:54:32,104][dance.WeightedFeatureSVD][__call__] Total explained variance: 96.56%
[INFO][2024-03-16 03:56:06,907][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 03:56:06,908][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 03:56:06,909][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 03:56:06,910][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:03<05:27,  3.31s/it]  2%|‚ñè         | 2/100 [00:06<05:35,  3.42s/it]  3%|‚ñé         | 3/100 [00:09<05:12,  3.22s/it]  4%|‚ñç         | 4/100 [00:13<05:26,  3.40s/it]  5%|‚ñå         | 5/100 [00:17<05:59,  3.78s/it]  6%|‚ñå         | 6/100 [00:22<06:08,  3.92s/it]  7%|‚ñã         | 7/100 [00:26<06:09,  3.97s/it]  8%|‚ñä         | 8/100 [00:30<06:05,  3.98s/it]  9%|‚ñâ         | 9/100 [00:34<05:58,  3.94s/it] 10%|‚ñà         | 10/100 [00:38<05:58,  3.98s/it] 11%|‚ñà         | 11/100 [00:42<05:54,  3.98s/it] 12%|‚ñà‚ñè        | 12/100 [00:46<05:53,  4.02s/it] 13%|‚ñà‚ñé        | 13/100 [00:50<05:45,  3.97s/it] 14%|‚ñà‚ñç        | 14/100 [00:54<05:51,  4.08s/it] 15%|‚ñà‚ñå        | 15/100 [00:58<05:36,  3.96s/it] 16%|‚ñà‚ñå        | 16/100 [01:02<05:34,  3.98s/it] 17%|‚ñà‚ñã        | 17/100 [01:06<05:34,  4.03s/it] 18%|‚ñà‚ñä        | 18/100 [01:10<05:27,  3.99s/it] 19%|‚ñà‚ñâ        | 19/100 [01:12<04:46,  3.54s/it] 20%|‚ñà‚ñà        | 20/100 [01:14<04:05,  3.07s/it] 21%|‚ñà‚ñà        | 21/100 [01:16<03:25,  2.61s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [01:17<02:56,  2.27s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [01:19<02:46,  2.16s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [01:21<02:33,  2.02s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [01:22<02:26,  1.95s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [01:24<02:16,  1.85s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [01:26<02:05,  1.72s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [01:27<02:00,  1.68s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [01:29<01:56,  1.64s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [01:30<01:48,  1.55s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [01:32<01:46,  1.55s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:33<01:46,  1.56s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:35<01:41,  1.51s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:36<01:42,  1.56s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:38<01:44,  1.61s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:39<01:40,  1.57s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:41<01:39,  1.58s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:43<01:37,  1.57s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:44<01:38,  1.62s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:46<01:30,  1.51s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:47<01:24,  1.44s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:48<01:22,  1.42s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:50<01:21,  1.42s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:51<01:18,  1.39s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:52<01:17,  1.40s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:54<01:17,  1.43s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:55<01:14,  1.40s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:57<01:12,  1.39s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:58<01:09,  1.37s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:59<01:06,  1.34s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [02:01<01:06,  1.35s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [02:02<01:04,  1.34s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [02:03<01:03,  1.34s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [02:04<01:00,  1.32s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [02:07<01:10,  1.57s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [02:11<01:40,  2.28s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [02:12<01:27,  2.04s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [02:14<01:19,  1.89s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [02:15<01:12,  1.76s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [02:17<01:10,  1.77s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [02:33<04:01,  6.18s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [02:44<04:50,  7.65s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [03:05<07:07, 11.56s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [03:16<06:52, 11.46s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [03:18<05:01,  8.61s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [03:22<04:07,  7.28s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [03:25<03:11,  5.81s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [03:27<02:28,  4.65s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [03:29<02:00,  3.87s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [03:31<01:38,  3.29s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [03:33<01:23,  2.87s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [03:34<01:08,  2.45s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [03:36<00:57,  2.14s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [03:37<00:49,  1.92s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [03:38<00:44,  1.79s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [03:40<00:40,  1.67s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [03:41<00:36,  1.60s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [03:42<00:32,  1.48s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [03:44<00:30,  1.46s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [03:45<00:28,  1.42s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [03:47<00:27,  1.43s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [03:48<00:25,  1.41s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [03:49<00:23,  1.40s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [03:51<00:22,  1.40s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [03:52<00:20,  1.39s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [03:54<00:21,  1.54s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [03:56<00:22,  1.70s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [03:58<00:20,  1.72s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [04:00<00:20,  1.90s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [04:02<00:19,  1.99s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [04:04<00:17,  1.90s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [04:06<00:14,  1.82s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [04:07<00:12,  1.77s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [04:09<00:10,  1.75s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [04:11<00:08,  1.71s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [04:14<00:08,  2.23s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [04:17<00:07,  2.51s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [04:19<00:04,  2.29s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [04:21<00:02,  2.17s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [04:23<00:00,  2.15s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [04:23<00:00,  2.64s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.31044
wandb: 
wandb: üöÄ View run lemon-sweep-26 at: https://wandb.ai/xzy11632/dance-dev/runs/ggzr0tzs
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_035005-ggzr0tzs/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: zavtb5tf with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_040157-zavtb5tf
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run hopeful-sweep-27
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/zavtb5tf
[INFO][2024-03-16 04:02:03,474][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 04:02:03,569][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 04:02:03,570][dance][wrapped_func] Took 0:00:00.087478 to load and process data.
[INFO][2024-03-16 04:02:03,570][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 04:02:03,573][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 04:02:03,594][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 04:02:03,650][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 04:02:03,909][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.018 MB of 0.024 MB uploadedwandb: / 0.018 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run hopeful-sweep-27 at: https://wandb.ai/xzy11632/dance-dev/runs/zavtb5tf
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_040157-zavtb5tf/logs
wandb: ERROR Run zavtb5tf errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1020) out of bounds (980)
wandb: ERROR 
wandb: Agent Starting Run: ciwxedp1 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_040218-ciwxedp1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lunar-sweep-28
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ciwxedp1
[INFO][2024-03-16 04:02:38,734][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 04:02:39,012][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 04:02:39,013][dance][wrapped_func] Took 0:00:00.278382 to load and process data.
[INFO][2024-03-16 04:02:39,014][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 04:02:39,016][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 04:02:39,036][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 04:02:39,211][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 04:02:40,011][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run lunar-sweep-28 at: https://wandb.ai/xzy11632/dance-dev/runs/ciwxedp1
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_040218-ciwxedp1/logs
wandb: ERROR Run ciwxedp1 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1020) out of bounds (980)
wandb: ERROR 
wandb: Agent Starting Run: m43trv7g with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: W&B API key is configured. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_040307-m43trv7g
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run solar-sweep-29
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/m43trv7g
[INFO][2024-03-16 04:03:16,578][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 04:03:16,718][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 04:03:16,719][dance][wrapped_func] Took 0:00:00.137054 to load and process data.
[INFO][2024-03-16 04:03:16,720][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 04:03:16,723][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 04:03:16,746][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 04:03:16,816][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 04:03:29,327][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=7)
[INFO][2024-03-16 04:03:29,327][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.74%
[INFO][2024-03-16 04:16:15,296][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 04:16:15,298][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 04:16:15,298][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 04:16:15,298][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:20,  1.42s/it]  2%|‚ñè         | 2/100 [00:02<02:16,  1.39s/it]  3%|‚ñé         | 3/100 [00:04<02:06,  1.31s/it]  4%|‚ñç         | 4/100 [00:05<01:55,  1.21s/it]  5%|‚ñå         | 5/100 [00:06<01:53,  1.19s/it]  6%|‚ñå         | 6/100 [00:07<01:51,  1.18s/it]  7%|‚ñã         | 7/100 [00:08<01:47,  1.15s/it]  8%|‚ñä         | 8/100 [00:09<01:43,  1.13s/it]  9%|‚ñâ         | 9/100 [00:10<01:43,  1.14s/it] 10%|‚ñà         | 10/100 [00:11<01:39,  1.11s/it] 11%|‚ñà         | 11/100 [00:12<01:39,  1.11s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:53,  1.29s/it] 13%|‚ñà‚ñé        | 13/100 [00:18<02:54,  2.00s/it] 14%|‚ñà‚ñç        | 14/100 [00:22<03:49,  2.67s/it] 15%|‚ñà‚ñå        | 15/100 [00:29<05:37,  3.97s/it] 16%|‚ñà‚ñå        | 16/100 [00:35<06:31,  4.66s/it] 17%|‚ñà‚ñã        | 17/100 [00:38<05:52,  4.24s/it] 18%|‚ñà‚ñä        | 18/100 [00:42<05:25,  3.96s/it] 19%|‚ñà‚ñâ        | 19/100 [00:46<05:33,  4.11s/it] 20%|‚ñà‚ñà        | 20/100 [00:53<06:22,  4.78s/it] 21%|‚ñà‚ñà        | 21/100 [00:57<06:18,  4.79s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [01:04<06:49,  5.25s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [01:06<05:40,  4.42s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [01:07<04:22,  3.45s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [01:09<03:41,  2.96s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [01:11<03:13,  2.62s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [01:13<02:46,  2.29s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [01:14<02:19,  1.94s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [01:15<01:59,  1.69s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [01:16<01:45,  1.50s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [01:17<01:35,  1.38s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:18<01:28,  1.30s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:19<01:22,  1.24s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:20<01:18,  1.20s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:21<01:14,  1.14s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:22<01:12,  1.14s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:23<01:11,  1.13s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:25<01:08,  1.10s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:26<01:06,  1.10s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:27<01:07,  1.13s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:28<01:04,  1.10s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:29<01:01,  1.07s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:30<01:01,  1.08s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:31<00:59,  1.06s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:32<00:58,  1.07s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:33<00:58,  1.08s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:34<00:56,  1.07s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:35<00:54,  1.06s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:36<00:53,  1.06s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:37<00:53,  1.08s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:38<00:51,  1.05s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:39<00:50,  1.04s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:40<00:49,  1.05s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:42<00:48,  1.05s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:43<00:47,  1.05s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:44<00:45,  1.03s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:45<00:44,  1.04s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:46<00:44,  1.06s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:47<00:44,  1.09s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:48<00:46,  1.15s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:50<00:54,  1.39s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:51<00:50,  1.32s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:52<00:46,  1.27s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:54<00:44,  1.24s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:55<00:41,  1.19s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:56<00:38,  1.13s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:57<00:36,  1.10s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:58<00:34,  1.07s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:59<00:32,  1.05s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:00<00:31,  1.05s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:01<00:29,  1.02s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:02<00:28,  1.02s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:03<00:27,  1.02s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:04<00:26,  1.03s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:05<00:26,  1.06s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:06<00:26,  1.09s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:07<00:26,  1.14s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:09<00:25,  1.15s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:10<00:23,  1.12s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:11<00:21,  1.08s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:12<00:20,  1.06s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:13<00:19,  1.06s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:14<00:18,  1.07s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:15<00:17,  1.09s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:16<00:16,  1.08s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:17<00:15,  1.08s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:18<00:14,  1.11s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:20<00:15,  1.33s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:22<00:15,  1.39s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:24<00:15,  1.57s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:25<00:13,  1.52s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:26<00:11,  1.41s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:27<00:09,  1.31s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:28<00:07,  1.22s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:29<00:06,  1.21s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:30<00:04,  1.15s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:31<00:03,  1.11s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:32<00:02,  1.07s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:33<00:01,  1.06s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:34<00:00,  1.03s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:34<00:00,  1.55s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.16468
wandb: 
wandb: üöÄ View run solar-sweep-29 at: https://wandb.ai/xzy11632/dance-dev/runs/m43trv7g
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_040307-m43trv7g/logs
wandb: Agent Starting Run: 3hx4d3ew with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_042104-3hx4d3ew
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run charmed-sweep-30
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/3hx4d3ew
[INFO][2024-03-16 04:21:09,908][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 04:21:09,994][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 04:21:09,995][dance][wrapped_func] Took 0:00:00.086044 to load and process data.
[INFO][2024-03-16 04:21:09,995][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 04:21:09,997][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 04:21:10,010][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 04:21:10,055][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 04:21:11,804][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=7)
[INFO][2024-03-16 04:21:11,804][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.70%
[INFO][2024-03-16 04:21:14,469][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 04:21:14,470][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 04:21:14,470][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 04:21:14,470][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:55,  1.17s/it]  2%|‚ñè         | 2/100 [00:02<01:40,  1.03s/it]  3%|‚ñé         | 3/100 [00:03<01:37,  1.01s/it]  4%|‚ñç         | 4/100 [00:04<01:58,  1.23s/it]  5%|‚ñå         | 5/100 [00:07<02:48,  1.77s/it]  6%|‚ñå         | 6/100 [00:10<03:29,  2.23s/it]  7%|‚ñã         | 7/100 [00:12<03:16,  2.11s/it]  8%|‚ñä         | 8/100 [00:14<03:06,  2.03s/it]  9%|‚ñâ         | 9/100 [00:16<02:58,  1.96s/it] 10%|‚ñà         | 10/100 [00:18<02:57,  1.98s/it] 11%|‚ñà         | 11/100 [00:19<02:49,  1.91s/it] 12%|‚ñà‚ñè        | 12/100 [00:21<02:51,  1.95s/it] 13%|‚ñà‚ñé        | 13/100 [00:23<02:46,  1.92s/it] 14%|‚ñà‚ñç        | 14/100 [00:25<02:44,  1.91s/it] 15%|‚ñà‚ñå        | 15/100 [00:27<02:46,  1.96s/it] 16%|‚ñà‚ñå        | 16/100 [00:29<02:44,  1.96s/it] 17%|‚ñà‚ñã        | 17/100 [00:31<02:41,  1.95s/it] 18%|‚ñà‚ñä        | 18/100 [00:33<02:38,  1.93s/it] 19%|‚ñà‚ñâ        | 19/100 [00:35<02:34,  1.90s/it] 20%|‚ñà‚ñà        | 20/100 [00:37<02:31,  1.89s/it] 21%|‚ñà‚ñà        | 21/100 [00:39<02:31,  1.92s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:40<02:26,  1.88s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:42<02:22,  1.85s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:44<02:20,  1.85s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:46<02:16,  1.83s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:48<02:14,  1.82s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:49<02:11,  1.80s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:51<02:08,  1.78s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:53<02:05,  1.77s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:54<01:59,  1.71s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:56<02:00,  1.75s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:58<01:59,  1.76s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:00<01:57,  1.75s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:01<01:54,  1.73s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:03<01:55,  1.77s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:05<01:52,  1.75s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:07<01:50,  1.76s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:09<01:50,  1.78s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:11<01:51,  1.83s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:13<01:58,  1.97s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:15<01:59,  2.03s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:17<02:02,  2.11s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:20<02:03,  2.16s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:22<02:03,  2.21s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:24<01:59,  2.18s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:26<01:56,  2.15s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:29<01:58,  2.24s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:31<01:59,  2.31s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:33<01:58,  2.33s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:36<01:55,  2.30s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:38<01:55,  2.35s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:40<01:50,  2.30s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:42<01:44,  2.23s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:45<01:44,  2.27s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:47<01:38,  2.19s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:49<01:36,  2.20s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:51<01:36,  2.24s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:54<01:33,  2.23s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:56<01:34,  2.30s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:58<01:32,  2.32s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [02:01<01:32,  2.37s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [02:03<01:30,  2.39s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [02:05<01:23,  2.27s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [02:08<01:23,  2.33s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [02:10<01:23,  2.38s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [02:12<01:15,  2.23s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [02:14<01:13,  2.23s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [02:16<01:10,  2.19s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:19<01:09,  2.23s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:21<01:04,  2.15s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:23<01:04,  2.23s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:25<01:01,  2.20s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:27<00:59,  2.20s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:30<00:56,  2.17s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:32<00:54,  2.16s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:34<00:52,  2.19s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:36<00:51,  2.24s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:38<00:47,  2.18s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:40<00:45,  2.16s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:43<00:43,  2.15s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:45<00:40,  2.11s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:47<00:38,  2.13s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:49<00:36,  2.13s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:51<00:34,  2.13s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:53<00:31,  2.13s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:55<00:29,  2.13s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:57<00:27,  2.13s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [03:00<00:26,  2.23s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [03:02<00:23,  2.16s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [03:04<00:21,  2.16s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [03:06<00:19,  2.15s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [03:08<00:17,  2.15s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [03:10<00:14,  2.08s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [03:12<00:12,  2.11s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [03:15<00:10,  2.14s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [03:20<00:12,  3.21s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [03:27<00:12,  4.32s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [03:32<00:08,  4.46s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [03:44<00:06,  6.74s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:54<00:00,  7.63s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:54<00:00,  2.34s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.021 MB uploadedwandb: | 0.012 MB of 0.021 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.16159
wandb: 
wandb: üöÄ View run charmed-sweep-30 at: https://wandb.ai/xzy11632/dance-dev/runs/3hx4d3ew
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_042104-3hx4d3ew/logs
wandb: Agent Starting Run: 2qza0afx with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_042850-2qza0afx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run treasured-sweep-31
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/2qza0afx
[INFO][2024-03-16 04:28:56,747][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 04:28:56,865][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 04:28:56,866][dance][wrapped_func] Took 0:00:00.118468 to load and process data.
[INFO][2024-03-16 04:28:56,866][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 04:28:56,869][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 04:28:56,890][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 04:28:56,944][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run treasured-sweep-31 at: https://wandb.ai/xzy11632/dance-dev/runs/2qza0afx
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_042850-2qza0afx/logs
wandb: ERROR Run 2qza0afx errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: bcsoev55 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_042911-bcsoev55
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sandy-sweep-32
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/bcsoev55
[INFO][2024-03-16 04:29:16,777][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 04:29:16,861][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 04:29:16,861][dance][wrapped_func] Took 0:00:00.083794 to load and process data.
[INFO][2024-03-16 04:29:16,862][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 04:29:16,863][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 04:29:16,876][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 04:29:16,921][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.013 MB of 0.024 MB uploadedwandb: \ 0.013 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run sandy-sweep-32 at: https://wandb.ai/xzy11632/dance-dev/runs/bcsoev55
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_042911-bcsoev55/logs
wandb: ERROR Run bcsoev55 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: 5dukx7te with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_042932-5dukx7te
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run generous-sweep-33
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/5dukx7te
[INFO][2024-03-16 04:29:42,774][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 04:29:42,861][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 04:29:42,861][dance][wrapped_func] Took 0:00:00.086205 to load and process data.
[INFO][2024-03-16 04:29:42,861][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 04:29:42,862][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 04:29:42,876][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 04:29:42,919][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run generous-sweep-33 at: https://wandb.ai/xzy11632/dance-dev/runs/5dukx7te
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_042932-5dukx7te/logs
wandb: ERROR Run 5dukx7te errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: qfosqy1c with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_042956-qfosqy1c
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run charmed-sweep-34
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/qfosqy1c
[INFO][2024-03-16 04:30:01,834][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 04:30:01,927][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 04:30:01,928][dance][wrapped_func] Took 0:00:00.093207 to load and process data.
[INFO][2024-03-16 04:30:01,928][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 04:30:01,929][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 04:30:01,946][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 04:30:01,989][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run charmed-sweep-34 at: https://wandb.ai/xzy11632/dance-dev/runs/qfosqy1c
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_042956-qfosqy1c/logs
wandb: ERROR Run qfosqy1c errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: mxlbn3ut with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_043030-mxlbn3ut
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run efficient-sweep-35
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/mxlbn3ut
[INFO][2024-03-16 04:30:37,564][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 04:30:37,755][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 04:30:37,756][dance][wrapped_func] Took 0:00:00.191196 to load and process data.
[INFO][2024-03-16 04:30:37,757][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 04:30:37,760][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 04:30:37,796][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 04:30:37,863][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 04:30:50,961][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=9)
[INFO][2024-03-16 04:30:50,972][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.65%
[INFO][2024-03-16 04:38:34,132][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 04:38:34,133][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 04:38:34,133][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 04:38:34,133][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:44,  1.05s/it]  2%|‚ñè         | 2/100 [00:02<01:40,  1.03s/it]  3%|‚ñé         | 3/100 [00:03<01:48,  1.12s/it]  4%|‚ñç         | 4/100 [00:04<01:45,  1.10s/it]  5%|‚ñå         | 5/100 [00:05<02:00,  1.26s/it]  6%|‚ñå         | 6/100 [00:07<02:12,  1.41s/it]  7%|‚ñã         | 7/100 [00:09<02:11,  1.41s/it]  8%|‚ñä         | 8/100 [00:10<02:03,  1.34s/it]  9%|‚ñâ         | 9/100 [00:11<01:55,  1.27s/it] 10%|‚ñà         | 10/100 [00:12<01:49,  1.22s/it] 11%|‚ñà         | 11/100 [00:13<01:47,  1.21s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:44,  1.19s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:39,  1.14s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:37,  1.13s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:34,  1.11s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:32,  1.11s/it] 17%|‚ñà‚ñã        | 17/100 [00:20<01:32,  1.11s/it] 18%|‚ñà‚ñä        | 18/100 [00:21<01:30,  1.11s/it] 19%|‚ñà‚ñâ        | 19/100 [00:22<01:29,  1.11s/it] 20%|‚ñà‚ñà        | 20/100 [00:23<01:25,  1.07s/it] 21%|‚ñà‚ñà        | 21/100 [00:24<01:22,  1.04s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:25<01:25,  1.09s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:26<01:22,  1.07s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:27<01:23,  1.09s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:28<01:19,  1.06s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:29<01:17,  1.05s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:30<01:15,  1.04s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:31<01:16,  1.06s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:32<01:15,  1.06s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:33<01:13,  1.05s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:35<01:15,  1.10s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:36<01:13,  1.08s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:37<01:11,  1.06s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:38<01:08,  1.03s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:39<01:07,  1.03s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:40<01:08,  1.06s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:41<01:09,  1.10s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:42<01:08,  1.10s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:43<01:04,  1.06s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:44<01:02,  1.05s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:45<01:01,  1.04s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:46<00:59,  1.03s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:47<00:57,  1.01s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:48<00:59,  1.07s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:49<00:57,  1.04s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:50<00:58,  1.08s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:51<00:55,  1.05s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:53<00:54,  1.06s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:53<00:52,  1.02s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:54<00:50,  1.01s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:55<00:49,  1.00s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:56<00:48,  1.01s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:57<00:46,  1.01it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:58<00:46,  1.02s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:00<00:47,  1.05s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:01<00:51,  1.17s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:02<00:51,  1.20s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:04<00:51,  1.22s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:05<00:47,  1.17s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:06<00:46,  1.16s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:07<00:43,  1.12s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:08<00:40,  1.08s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:09<00:38,  1.03s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:10<00:36,  1.00s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:11<00:34,  1.02it/s] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:12<00:33,  1.03it/s] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:13<00:32,  1.02it/s] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:14<00:35,  1.12s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:16<00:39,  1.27s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:17<00:40,  1.34s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:19<00:40,  1.41s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:20<00:40,  1.46s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:22<00:40,  1.51s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:24<00:47,  1.82s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:28<00:56,  2.26s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:32<01:06,  2.75s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:34<00:59,  2.60s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:36<00:55,  2.51s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:38<00:51,  2.45s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:41<00:46,  2.34s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:43<00:42,  2.23s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:45<00:39,  2.22s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:48<00:40,  2.41s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:50<00:39,  2.47s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:53<00:36,  2.47s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:55<00:34,  2.47s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:58<00:31,  2.45s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:00<00:29,  2.43s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:02<00:26,  2.38s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:04<00:23,  2.31s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:07<00:20,  2.31s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:09<00:18,  2.34s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:11<00:15,  2.25s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:13<00:13,  2.27s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:15<00:10,  2.17s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:18<00:08,  2.22s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:20<00:06,  2.24s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:22<00:04,  2.27s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:25<00:02,  2.31s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:27<00:00,  2.24s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:27<00:00,  1.47s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.27763
wandb: 
wandb: üöÄ View run efficient-sweep-35 at: https://wandb.ai/xzy11632/dance-dev/runs/mxlbn3ut
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_043030-mxlbn3ut/logs
wandb: Agent Starting Run: v5rn9iy6 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_044341-v5rn9iy6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run avid-sweep-36
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/v5rn9iy6
[INFO][2024-03-16 04:43:53,292][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 04:43:53,663][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 04:43:53,663][dance][wrapped_func] Took 0:00:00.347033 to load and process data.
[INFO][2024-03-16 04:43:53,668][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 04:43:53,671][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 04:43:53,724][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 04:43:53,880][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 04:44:35,277][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=14)
[INFO][2024-03-16 04:44:35,280][dance.WeightedFeatureSVD][__call__] Total explained variance: 93.15%
[INFO][2024-03-16 05:00:49,679][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 05:00:49,681][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 05:00:49,681][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 05:00:49,681][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:42,  1.64s/it]  2%|‚ñè         | 2/100 [00:03<02:43,  1.67s/it]  3%|‚ñé         | 3/100 [00:04<02:29,  1.55s/it]  4%|‚ñç         | 4/100 [00:06<02:19,  1.45s/it]  5%|‚ñå         | 5/100 [00:07<02:07,  1.35s/it]  6%|‚ñå         | 6/100 [00:08<02:01,  1.29s/it]  7%|‚ñã         | 7/100 [00:09<01:56,  1.25s/it]  8%|‚ñä         | 8/100 [00:10<01:54,  1.25s/it]  9%|‚ñâ         | 9/100 [00:12<01:57,  1.29s/it] 10%|‚ñà         | 10/100 [00:13<02:05,  1.40s/it] 11%|‚ñà         | 11/100 [00:15<02:12,  1.48s/it] 12%|‚ñà‚ñè        | 12/100 [00:17<02:23,  1.63s/it] 13%|‚ñà‚ñé        | 13/100 [00:19<02:22,  1.63s/it] 14%|‚ñà‚ñç        | 14/100 [00:20<02:15,  1.57s/it] 15%|‚ñà‚ñå        | 15/100 [00:22<02:12,  1.56s/it] 16%|‚ñà‚ñå        | 16/100 [00:23<02:12,  1.58s/it] 17%|‚ñà‚ñã        | 17/100 [00:25<02:07,  1.54s/it] 18%|‚ñà‚ñä        | 18/100 [00:26<02:01,  1.48s/it] 19%|‚ñà‚ñâ        | 19/100 [00:27<01:53,  1.41s/it] 20%|‚ñà‚ñà        | 20/100 [00:28<01:49,  1.36s/it] 21%|‚ñà‚ñà        | 21/100 [00:30<01:46,  1.34s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:31<01:43,  1.33s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:32<01:41,  1.32s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:34<01:37,  1.28s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:35<01:33,  1.25s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:36<01:33,  1.26s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:37<01:29,  1.22s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:38<01:28,  1.22s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:40<01:25,  1.20s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:41<01:22,  1.18s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:42<01:22,  1.20s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:43<01:24,  1.24s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:45<01:26,  1.29s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:46<01:25,  1.30s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:47<01:20,  1.24s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:48<01:18,  1.23s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:49<01:14,  1.18s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:51<01:14,  1.20s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:52<01:10,  1.15s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:53<01:08,  1.13s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:54<01:06,  1.13s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:55<01:07,  1.16s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:56<01:04,  1.14s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:57<01:03,  1.13s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:58<01:00,  1.11s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:00<01:02,  1.15s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:01<01:02,  1.18s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:02<01:01,  1.18s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:03<00:59,  1.17s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:04<00:57,  1.14s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:05<00:56,  1.15s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:06<00:54,  1.14s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:08<00:52,  1.13s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:09<00:50,  1.11s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:10<00:50,  1.11s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:11<00:49,  1.13s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:12<00:48,  1.12s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:13<00:46,  1.11s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:14<00:44,  1.08s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:15<00:43,  1.09s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:16<00:43,  1.11s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:17<00:41,  1.09s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:18<00:38,  1.04s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:19<00:36,  1.01s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:20<00:36,  1.04s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:21<00:35,  1.04s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:23<00:34,  1.06s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:24<00:34,  1.07s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:25<00:33,  1.07s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:26<00:31,  1.06s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:27<00:30,  1.06s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:28<00:31,  1.14s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:29<00:31,  1.18s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:31<00:30,  1.18s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:32<00:28,  1.16s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:33<00:27,  1.16s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:34<00:26,  1.16s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:35<00:26,  1.19s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:36<00:25,  1.19s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:38<00:23,  1.19s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:39<00:23,  1.25s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:40<00:22,  1.24s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:42<00:21,  1.25s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:43<00:20,  1.26s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:44<00:18,  1.25s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:45<00:17,  1.25s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:46<00:15,  1.22s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:48<00:14,  1.20s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:49<00:13,  1.25s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:50<00:12,  1.22s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:51<00:10,  1.20s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:52<00:09,  1.17s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:54<00:08,  1.16s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:55<00:06,  1.14s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:56<00:05,  1.18s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:57<00:04,  1.18s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:58<00:03,  1.18s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:59<00:02,  1.17s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:01<00:01,  1.20s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:02<00:00,  1.18s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:02<00:00,  1.22s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.017 MB of 0.025 MB uploadedwandb: | 0.017 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.2774
wandb: 
wandb: üöÄ View run avid-sweep-36 at: https://wandb.ai/xzy11632/dance-dev/runs/v5rn9iy6
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_044341-v5rn9iy6/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: cdcwmdsb with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_050433-cdcwmdsb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fresh-sweep-37
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/cdcwmdsb
[INFO][2024-03-16 05:04:39,243][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 05:04:39,379][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 05:04:39,379][dance][wrapped_func] Took 0:00:00.127581 to load and process data.
[INFO][2024-03-16 05:04:39,380][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 05:04:39,382][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 05:04:39,401][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 05:04:39,402][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 05:04:39,471][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[WARNING][2024-03-16 05:05:39,845][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 05:05:41,911][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 980) (k=546)
[INFO][2024-03-16 05:05:41,911][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.02%
[INFO][2024-03-16 05:05:44,739][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 05:05:44,740][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 05:05:44,740][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 05:05:44,740][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:26,  1.48s/it]  2%|‚ñè         | 2/100 [00:02<02:10,  1.34s/it]  3%|‚ñé         | 3/100 [00:03<02:04,  1.29s/it]  4%|‚ñç         | 4/100 [00:05<02:01,  1.26s/it]  5%|‚ñå         | 5/100 [00:06<01:58,  1.25s/it]  6%|‚ñå         | 6/100 [00:07<01:57,  1.25s/it]  7%|‚ñã         | 7/100 [00:08<01:54,  1.23s/it]  8%|‚ñä         | 8/100 [00:10<01:54,  1.25s/it]  9%|‚ñâ         | 9/100 [00:11<01:51,  1.23s/it] 10%|‚ñà         | 10/100 [00:12<01:52,  1.25s/it] 11%|‚ñà         | 11/100 [00:13<01:50,  1.24s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:46,  1.20s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:42,  1.18s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:44,  1.21s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:51,  1.31s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<01:46,  1.27s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:46,  1.28s/it] 18%|‚ñà‚ñä        | 18/100 [00:22<01:40,  1.23s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<01:52,  1.38s/it] 20%|‚ñà‚ñà        | 20/100 [00:26<02:15,  1.70s/it] 21%|‚ñà‚ñà        | 21/100 [00:29<02:31,  1.91s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:31<02:39,  2.04s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:32<02:22,  1.85s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:34<02:07,  1.68s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:35<01:52,  1.50s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:36<01:48,  1.47s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:37<01:43,  1.42s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:39<01:37,  1.35s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:40<01:34,  1.32s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:41<01:32,  1.31s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:42<01:28,  1.28s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:44<01:28,  1.31s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:45<01:30,  1.36s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:46<01:25,  1.30s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:48<01:22,  1.27s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:49<01:18,  1.22s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:50<01:20,  1.27s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:52<01:25,  1.38s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:53<01:27,  1.44s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:55<01:29,  1.50s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:56<01:27,  1.48s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:58<01:25,  1.48s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:59<01:22,  1.45s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:03<01:53,  2.04s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:04<01:45,  1.93s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:05<01:33,  1.72s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:07<01:26,  1.63s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:08<01:22,  1.58s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:10<01:16,  1.50s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:11<01:12,  1.44s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:12<01:09,  1.41s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:14<01:07,  1.41s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:15<01:10,  1.51s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:21<02:05,  2.73s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:26<02:35,  3.46s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:35<03:46,  5.14s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:43<04:15,  5.95s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:51<04:31,  6.46s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:56<04:13,  6.19s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [02:02<03:59,  6.00s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [02:08<03:57,  6.09s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [02:14<03:44,  5.91s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [02:19<03:34,  5.79s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [02:24<03:19,  5.54s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [02:29<03:10,  5.44s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [02:35<03:04,  5.41s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [02:41<03:07,  5.68s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [02:46<02:56,  5.52s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:51<02:48,  5.44s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:57<02:41,  5.38s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [03:02<02:33,  5.28s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [03:07<02:30,  5.39s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [03:13<02:27,  5.48s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [03:18<02:22,  5.47s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [03:24<02:18,  5.55s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [03:30<02:13,  5.58s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [03:36<02:09,  5.64s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [03:41<02:02,  5.55s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [03:46<01:55,  5.50s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [03:52<01:49,  5.49s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [03:57<01:44,  5.50s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [04:03<01:37,  5.42s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [04:11<01:46,  6.26s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [04:19<01:48,  6.81s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [04:26<01:44,  6.97s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [04:33<01:35,  6.85s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [04:40<01:30,  6.93s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [04:48<01:28,  7.39s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [04:56<01:23,  7.55s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [05:03<01:14,  7.41s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [05:11<01:07,  7.45s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [05:19<01:01,  7.67s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [05:26<00:52,  7.48s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [05:34<00:44,  7.50s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [05:41<00:37,  7.41s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [05:49<00:30,  7.65s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [05:58<00:23,  7.95s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [06:05<00:15,  7.64s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [06:12<00:07,  7.68s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [06:21<00:00,  7.89s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [06:21<00:00,  3.81s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.018 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.26402
wandb: 
wandb: üöÄ View run fresh-sweep-37 at: https://wandb.ai/xzy11632/dance-dev/runs/cdcwmdsb
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_050433-cdcwmdsb/logs
wandb: Agent Starting Run: 7rkjnhvj with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_051453-7rkjnhvj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run balmy-sweep-38
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/7rkjnhvj
[INFO][2024-03-16 05:15:04,010][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 05:15:04,127][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 05:15:04,127][dance][wrapped_func] Took 0:00:00.109750 to load and process data.
[INFO][2024-03-16 05:15:04,128][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 05:15:04,130][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 05:15:04,153][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 05:15:04,154][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 05:15:04,213][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[WARNING][2024-03-16 05:16:40,661][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 05:19:54,528][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 980) (k=552)
[INFO][2024-03-16 05:19:54,540][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.97%
[INFO][2024-03-16 05:20:29,665][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 05:20:29,665][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 05:20:29,665][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 05:20:29,666][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:18,  1.40s/it]  2%|‚ñè         | 2/100 [00:02<02:23,  1.47s/it]  3%|‚ñé         | 3/100 [00:04<02:28,  1.54s/it]  4%|‚ñç         | 4/100 [00:05<02:18,  1.44s/it]  5%|‚ñå         | 5/100 [00:07<02:18,  1.45s/it]  6%|‚ñå         | 6/100 [00:08<02:13,  1.42s/it]  7%|‚ñã         | 7/100 [00:10<02:14,  1.45s/it]  8%|‚ñä         | 8/100 [00:11<02:20,  1.53s/it]  9%|‚ñâ         | 9/100 [00:13<02:17,  1.51s/it] 10%|‚ñà         | 10/100 [00:14<02:15,  1.50s/it] 11%|‚ñà         | 11/100 [00:16<02:12,  1.49s/it] 12%|‚ñà‚ñè        | 12/100 [00:17<02:14,  1.53s/it] 13%|‚ñà‚ñé        | 13/100 [00:19<02:22,  1.64s/it] 14%|‚ñà‚ñç        | 14/100 [00:21<02:15,  1.58s/it] 15%|‚ñà‚ñå        | 15/100 [00:22<02:09,  1.52s/it] 16%|‚ñà‚ñå        | 16/100 [00:24<02:05,  1.50s/it] 17%|‚ñà‚ñã        | 17/100 [00:25<02:04,  1.50s/it] 18%|‚ñà‚ñä        | 18/100 [00:27<02:01,  1.49s/it] 19%|‚ñà‚ñâ        | 19/100 [00:28<02:00,  1.49s/it] 20%|‚ñà‚ñà        | 20/100 [00:29<01:56,  1.46s/it] 21%|‚ñà‚ñà        | 21/100 [00:31<01:57,  1.49s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:32<01:56,  1.50s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:34<01:54,  1.48s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:35<01:52,  1.49s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:37<01:51,  1.48s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:38<01:43,  1.40s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:39<01:38,  1.35s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:41<01:41,  1.40s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:42<01:37,  1.38s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:43<01:34,  1.35s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:45<01:33,  1.35s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:46<01:31,  1.35s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:47<01:29,  1.34s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:49<01:28,  1.34s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:50<01:28,  1.36s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:52<01:25,  1.34s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:53<01:23,  1.33s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:54<01:22,  1.33s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:56<01:23,  1.37s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:57<01:26,  1.44s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:59<01:31,  1.55s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:01<01:32,  1.60s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:02<01:33,  1.64s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:04<01:26,  1.54s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:05<01:23,  1.51s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:07<01:18,  1.45s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:08<01:15,  1.43s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:11<01:33,  1.81s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:13<01:47,  2.10s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:16<01:47,  2.16s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:17<01:37,  1.98s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:19<01:27,  1.83s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:20<01:21,  1.73s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:22<01:14,  1.62s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:23<01:11,  1.58s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:25<01:09,  1.58s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:26<01:04,  1.50s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:27<01:03,  1.51s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:29<01:00,  1.47s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:30<00:58,  1.47s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:32<00:55,  1.43s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:33<00:55,  1.47s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:35<00:56,  1.52s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:36<00:53,  1.49s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:38<00:51,  1.48s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:39<00:51,  1.52s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:41<00:49,  1.50s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:42<00:47,  1.47s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:44<00:46,  1.48s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:45<00:44,  1.47s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:47<00:42,  1.45s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:48<00:41,  1.48s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:50<00:39,  1.46s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:51<00:38,  1.49s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:53<00:38,  1.53s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:55<00:43,  1.80s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:58<00:46,  2.01s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:59<00:40,  1.84s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:00<00:35,  1.67s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:02<00:31,  1.56s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:03<00:28,  1.47s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:04<00:26,  1.44s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:06<00:23,  1.36s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:07<00:21,  1.33s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:08<00:19,  1.29s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:09<00:17,  1.24s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:10<00:15,  1.20s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:11<00:14,  1.20s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:13<00:13,  1.23s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:14<00:12,  1.21s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:15<00:10,  1.18s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:16<00:09,  1.20s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:17<00:08,  1.20s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:19<00:07,  1.31s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:21<00:07,  1.47s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:22<00:05,  1.40s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:24<00:04,  1.41s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:25<00:02,  1.48s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:27<00:01,  1.53s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:28<00:00,  1.55s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:28<00:00,  1.49s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.25913
wandb: 
wandb: üöÄ View run balmy-sweep-38 at: https://wandb.ai/xzy11632/dance-dev/runs/7rkjnhvj
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_051453-7rkjnhvj/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: oo89l5s7 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_052507-oo89l5s7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wild-sweep-39
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/oo89l5s7
[INFO][2024-03-16 05:25:15,735][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 05:25:15,882][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 05:25:15,883][dance][wrapped_func] Took 0:00:00.146827 to load and process data.
[INFO][2024-03-16 05:25:15,883][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 05:25:15,887][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 05:25:15,914][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 05:25:16,030][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 05:27:03,450][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run wild-sweep-39 at: https://wandb.ai/xzy11632/dance-dev/runs/oo89l5s7
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_052507-oo89l5s7/logs
wandb: ERROR Run oo89l5s7 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1020) out of bounds (980)
wandb: ERROR 
wandb: Agent Starting Run: xv38tkbw with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_052724-xv38tkbw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run smart-sweep-40
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/xv38tkbw
[INFO][2024-03-16 05:27:36,812][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 05:27:36,981][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 05:27:36,982][dance][wrapped_func] Took 0:00:00.169289 to load and process data.
[INFO][2024-03-16 05:27:36,983][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 05:27:36,985][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 05:27:37,008][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 05:27:37,072][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 05:29:25,206][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.018 MB of 0.024 MB uploadedwandb: | 0.018 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run smart-sweep-40 at: https://wandb.ai/xzy11632/dance-dev/runs/xv38tkbw
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_052724-xv38tkbw/logs
wandb: ERROR Run xv38tkbw errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1020) out of bounds (980)
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: sj8pm7v8 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_052954-sj8pm7v8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run floral-sweep-41
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/sj8pm7v8
[INFO][2024-03-16 05:30:04,090][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 05:30:04,255][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 05:30:04,256][dance][wrapped_func] Took 0:00:00.165035 to load and process data.
[INFO][2024-03-16 05:30:04,256][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 05:30:04,259][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 05:30:04,300][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 05:30:04,440][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-16 05:31:57,881][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=78)
[INFO][2024-03-16 05:31:57,884][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.14%
[INFO][2024-03-16 05:37:14,045][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 05:37:14,047][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 05:37:14,047][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 05:37:14,047][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:10,  1.32s/it]  2%|‚ñè         | 2/100 [00:02<01:57,  1.20s/it]  3%|‚ñé         | 3/100 [00:03<01:46,  1.10s/it]  4%|‚ñç         | 4/100 [00:04<01:44,  1.09s/it]  5%|‚ñå         | 5/100 [00:05<01:41,  1.07s/it]  6%|‚ñå         | 6/100 [00:06<01:38,  1.04s/it]  7%|‚ñã         | 7/100 [00:07<01:34,  1.02s/it]  8%|‚ñä         | 8/100 [00:08<01:35,  1.04s/it]  9%|‚ñâ         | 9/100 [00:09<01:35,  1.05s/it] 10%|‚ñà         | 10/100 [00:10<01:36,  1.07s/it] 11%|‚ñà         | 11/100 [00:11<01:33,  1.06s/it] 12%|‚ñà‚ñè        | 12/100 [00:12<01:34,  1.08s/it] 13%|‚ñà‚ñé        | 13/100 [00:13<01:33,  1.08s/it] 14%|‚ñà‚ñç        | 14/100 [00:15<01:31,  1.06s/it] 15%|‚ñà‚ñå        | 15/100 [00:16<01:31,  1.08s/it] 16%|‚ñà‚ñå        | 16/100 [00:17<01:31,  1.08s/it] 17%|‚ñà‚ñã        | 17/100 [00:18<01:34,  1.14s/it] 18%|‚ñà‚ñä        | 18/100 [00:19<01:32,  1.12s/it] 19%|‚ñà‚ñâ        | 19/100 [00:20<01:29,  1.11s/it] 20%|‚ñà‚ñà        | 20/100 [00:21<01:31,  1.14s/it] 21%|‚ñà‚ñà        | 21/100 [00:22<01:25,  1.09s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:23<01:25,  1.09s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:25<01:23,  1.08s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:26<01:20,  1.06s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:27<01:21,  1.08s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:28<01:19,  1.07s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:29<01:15,  1.03s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:30<01:16,  1.07s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:31<01:17,  1.09s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:32<01:18,  1.12s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:33<01:18,  1.13s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:35<01:19,  1.17s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:36<01:17,  1.16s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:37<01:20,  1.23s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:38<01:18,  1.21s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:39<01:16,  1.20s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:41<01:13,  1.17s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:42<01:12,  1.18s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:43<01:11,  1.17s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:44<01:13,  1.22s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:45<01:11,  1.21s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:47<01:10,  1.22s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:48<01:10,  1.24s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:49<01:10,  1.25s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:51<01:10,  1.28s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:52<01:10,  1.30s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:53<01:10,  1.34s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:55<01:11,  1.37s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:56<01:10,  1.38s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:58<01:08,  1.38s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:59<01:07,  1.37s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:00<01:04,  1.34s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:01<01:01,  1.32s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:03<00:58,  1.27s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:04<00:55,  1.23s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:05<00:55,  1.25s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:06<00:52,  1.22s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:07<00:52,  1.25s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:09<00:50,  1.23s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:10<00:51,  1.30s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:12<00:52,  1.35s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:13<00:50,  1.32s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:14<00:48,  1.30s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:15<00:44,  1.24s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:16<00:41,  1.20s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:17<00:40,  1.19s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:19<00:38,  1.17s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:20<00:38,  1.20s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:22<00:42,  1.36s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:23<00:40,  1.36s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:24<00:39,  1.36s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:25<00:36,  1.29s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:27<00:34,  1.29s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:28<00:33,  1.27s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:29<00:30,  1.23s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:30<00:28,  1.19s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:31<00:27,  1.19s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:33<00:26,  1.20s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:34<00:24,  1.16s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:35<00:22,  1.15s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:36<00:21,  1.11s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:37<00:19,  1.07s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:38<00:18,  1.09s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:39<00:16,  1.06s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:40<00:16,  1.09s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:41<00:15,  1.08s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:42<00:14,  1.10s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:44<00:16,  1.37s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:47<00:19,  1.78s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:50<00:20,  2.03s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:52<00:18,  2.00s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:53<00:15,  1.96s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:55<00:13,  1.93s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:57<00:11,  1.88s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:59<00:09,  1.84s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:01<00:07,  1.82s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:03<00:05,  1.86s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:04<00:03,  1.88s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:06<00:01,  1.92s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:09<00:00,  1.99s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:09<00:00,  1.29s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.27009
wandb: 
wandb: üöÄ View run floral-sweep-41 at: https://wandb.ai/xzy11632/dance-dev/runs/sj8pm7v8
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_052954-sj8pm7v8/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: h04nm7sr with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_054414-h04nm7sr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run vague-sweep-42
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/h04nm7sr
[INFO][2024-03-16 05:44:24,920][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 05:44:25,068][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 05:44:25,069][dance][wrapped_func] Took 0:00:00.147929 to load and process data.
[INFO][2024-03-16 05:44:25,069][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 05:44:25,072][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 05:44:25,099][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 05:44:25,203][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-16 05:46:52,450][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=75)
[INFO][2024-03-16 05:46:52,473][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.56%
[INFO][2024-03-16 05:50:14,755][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 05:50:14,755][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 05:50:14,756][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 05:50:14,756][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:00,  1.22s/it]  2%|‚ñè         | 2/100 [00:02<01:51,  1.13s/it]  3%|‚ñé         | 3/100 [00:03<01:44,  1.08s/it]  4%|‚ñç         | 4/100 [00:04<01:46,  1.11s/it]  5%|‚ñå         | 5/100 [00:05<01:42,  1.08s/it]  6%|‚ñå         | 6/100 [00:06<01:43,  1.10s/it]  7%|‚ñã         | 7/100 [00:07<01:43,  1.12s/it]  8%|‚ñä         | 8/100 [00:08<01:43,  1.13s/it]  9%|‚ñâ         | 9/100 [00:10<01:41,  1.11s/it] 10%|‚ñà         | 10/100 [00:11<01:42,  1.14s/it] 11%|‚ñà         | 11/100 [00:12<01:40,  1.13s/it] 12%|‚ñà‚ñè        | 12/100 [00:13<01:41,  1.15s/it] 13%|‚ñà‚ñé        | 13/100 [00:14<01:40,  1.15s/it] 14%|‚ñà‚ñç        | 14/100 [00:15<01:37,  1.13s/it] 15%|‚ñà‚ñå        | 15/100 [00:16<01:33,  1.10s/it] 16%|‚ñà‚ñå        | 16/100 [00:17<01:33,  1.11s/it] 17%|‚ñà‚ñã        | 17/100 [00:19<01:32,  1.12s/it] 18%|‚ñà‚ñä        | 18/100 [00:20<01:29,  1.10s/it] 19%|‚ñà‚ñâ        | 19/100 [00:21<01:29,  1.11s/it] 20%|‚ñà‚ñà        | 20/100 [00:22<01:27,  1.10s/it] 21%|‚ñà‚ñà        | 21/100 [00:23<01:25,  1.08s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:24<01:25,  1.10s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:25<01:27,  1.14s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:26<01:28,  1.16s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:28<01:24,  1.13s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:29<01:22,  1.11s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:30<01:19,  1.08s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:31<01:16,  1.07s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:32<01:14,  1.04s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:33<01:15,  1.07s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:34<01:14,  1.07s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:35<01:14,  1.10s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:36<01:12,  1.09s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:37<01:12,  1.09s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:38<01:10,  1.09s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:40<01:13,  1.15s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:41<01:15,  1.20s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:42<01:14,  1.21s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:43<01:12,  1.19s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:44<01:11,  1.20s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:46<01:09,  1.18s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:47<01:08,  1.17s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:48<01:07,  1.18s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:49<01:05,  1.18s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:51<01:08,  1.25s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:52<01:12,  1.34s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:53<01:11,  1.35s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:55<01:06,  1.27s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:56<01:01,  1.20s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:57<00:56,  1.14s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:58<00:53,  1.10s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:59<00:50,  1.05s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:00<00:48,  1.04s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:01<00:48,  1.06s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:02<00:56,  1.25s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:04<01:01,  1.39s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:06<01:02,  1.45s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:07<01:00,  1.45s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:08<00:55,  1.36s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:09<00:52,  1.31s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:10<00:47,  1.23s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:12<00:44,  1.18s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:13<00:43,  1.18s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:14<00:43,  1.20s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:15<00:40,  1.14s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:16<00:38,  1.12s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:17<00:36,  1.11s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:18<00:36,  1.13s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:19<00:34,  1.10s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:20<00:33,  1.10s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:22<00:31,  1.10s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:23<00:31,  1.11s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:24<00:30,  1.12s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:25<00:29,  1.15s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:26<00:28,  1.16s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:27<00:27,  1.16s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:29<00:26,  1.16s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:30<00:24,  1.13s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:31<00:23,  1.13s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:32<00:21,  1.10s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:33<00:21,  1.13s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:34<00:20,  1.12s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:35<00:19,  1.13s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:36<00:18,  1.14s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:37<00:16,  1.11s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:38<00:15,  1.10s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:40<00:14,  1.13s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:41<00:13,  1.14s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:42<00:12,  1.16s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:43<00:11,  1.18s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:44<00:10,  1.18s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:46<00:09,  1.17s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:47<00:08,  1.18s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:48<00:07,  1.17s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:49<00:06,  1.20s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:50<00:04,  1.17s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:51<00:03,  1.14s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:53<00:02,  1.14s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:54<00:01,  1.16s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:55<00:00,  1.17s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:55<00:00,  1.15s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.35031
wandb: 
wandb: üöÄ View run vague-sweep-42 at: https://wandb.ai/xzy11632/dance-dev/runs/h04nm7sr
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_054414-h04nm7sr/logs
wandb: Agent Starting Run: zsuhxk4g with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_055527-zsuhxk4g
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run faithful-sweep-43
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/zsuhxk4g
[INFO][2024-03-16 05:55:36,675][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 05:55:36,980][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 05:55:36,981][dance][wrapped_func] Took 0:00:00.304832 to load and process data.
[INFO][2024-03-16 05:55:36,982][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 05:55:36,985][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 05:55:37,026][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 05:55:37,191][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-16 05:57:41,912][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 246) (k=201)
[INFO][2024-03-16 05:57:41,913][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.14%
[INFO][2024-03-16 06:08:26,180][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 06:08:26,180][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 06:08:26,181][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 06:08:26,181][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:04<07:05,  4.30s/it]  2%|‚ñè         | 2/100 [00:08<07:15,  4.45s/it]  3%|‚ñé         | 3/100 [00:13<07:26,  4.60s/it]  4%|‚ñç         | 4/100 [00:18<07:24,  4.64s/it]  5%|‚ñå         | 5/100 [00:23<07:47,  4.92s/it]  6%|‚ñå         | 6/100 [00:28<07:33,  4.83s/it]  7%|‚ñã         | 7/100 [00:33<07:27,  4.81s/it]  8%|‚ñä         | 8/100 [00:37<07:13,  4.71s/it]  9%|‚ñâ         | 9/100 [00:41<06:46,  4.47s/it] 10%|‚ñà         | 10/100 [00:46<06:41,  4.46s/it] 11%|‚ñà         | 11/100 [00:50<06:41,  4.51s/it] 12%|‚ñà‚ñè        | 12/100 [00:55<06:56,  4.73s/it] 13%|‚ñà‚ñé        | 13/100 [01:00<06:45,  4.66s/it] 14%|‚ñà‚ñç        | 14/100 [01:04<06:37,  4.62s/it] 15%|‚ñà‚ñå        | 15/100 [01:09<06:31,  4.60s/it] 16%|‚ñà‚ñå        | 16/100 [01:14<06:30,  4.64s/it] 17%|‚ñà‚ñã        | 17/100 [01:19<06:29,  4.69s/it] 18%|‚ñà‚ñä        | 18/100 [01:23<06:28,  4.73s/it] 19%|‚ñà‚ñâ        | 19/100 [01:28<06:18,  4.68s/it] 20%|‚ñà‚ñà        | 20/100 [01:33<06:12,  4.65s/it] 21%|‚ñà‚ñà        | 21/100 [01:39<06:57,  5.28s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [01:46<07:35,  5.84s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [01:52<07:31,  5.87s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [01:59<07:50,  6.19s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [02:08<08:31,  6.82s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [02:15<08:42,  7.06s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [02:22<08:28,  6.97s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [02:27<07:44,  6.45s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [02:33<07:16,  6.14s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [02:39<07:14,  6.20s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [02:45<06:57,  6.05s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [02:51<06:47,  5.99s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [02:56<06:36,  5.92s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [03:01<06:15,  5.69s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [03:07<06:05,  5.62s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [03:13<06:03,  5.68s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [03:18<05:49,  5.55s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [03:24<05:48,  5.61s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [03:30<05:45,  5.67s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [03:34<05:27,  5.46s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [03:39<05:02,  5.12s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [03:44<04:53,  5.06s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [03:49<04:49,  5.08s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [03:55<05:02,  5.40s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [04:01<05:01,  5.49s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [04:07<05:02,  5.61s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [04:12<04:49,  5.45s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [04:16<04:29,  5.18s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [04:21<04:24,  5.18s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [04:27<04:19,  5.20s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [04:33<04:31,  5.55s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [04:39<04:27,  5.58s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [04:45<04:34,  5.85s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [04:50<04:21,  5.69s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [04:56<04:07,  5.51s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [05:01<03:56,  5.37s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [05:07<04:02,  5.64s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [05:14<04:12,  6.01s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [05:19<04:03,  5.93s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [05:24<03:39,  5.48s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [05:28<03:20,  5.13s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [05:33<03:06,  4.91s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [05:39<03:16,  5.31s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [05:43<03:02,  5.06s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [05:48<02:55,  5.02s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [05:53<02:48,  4.97s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [05:59<02:57,  5.37s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [06:03<02:37,  4.93s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [06:07<02:22,  4.61s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [06:11<02:11,  4.37s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [06:14<01:57,  4.07s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [06:16<01:37,  3.47s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [06:19<01:23,  3.10s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [06:24<01:35,  3.65s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [06:28<01:33,  3.75s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [06:32<01:32,  3.85s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [06:36<01:32,  4.04s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [06:41<01:33,  4.24s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [06:46<01:33,  4.45s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [06:50<01:28,  4.43s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [06:55<01:28,  4.67s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [06:59<01:19,  4.41s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [07:05<01:20,  4.76s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [07:09<01:15,  4.69s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [07:13<01:07,  4.50s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [07:16<00:53,  3.84s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [07:18<00:44,  3.40s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [07:20<00:35,  2.94s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [07:22<00:28,  2.56s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [07:23<00:23,  2.31s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [07:25<00:19,  2.18s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [07:27<00:16,  2.04s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [07:29<00:13,  1.93s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [07:30<00:11,  1.85s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [07:32<00:08,  1.77s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [07:33<00:06,  1.74s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [07:35<00:05,  1.72s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [07:37<00:03,  1.67s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [07:39<00:01,  1.91s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [07:42<00:00,  2.07s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [07:42<00:00,  4.62s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.29555
wandb: 
wandb: üöÄ View run faithful-sweep-43 at: https://wandb.ai/xzy11632/dance-dev/runs/zsuhxk4g
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_055527-zsuhxk4g/logs
wandb: Agent Starting Run: u85shdc0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_061928-u85shdc0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run young-sweep-44
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/u85shdc0
[INFO][2024-03-16 06:19:34,830][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 06:19:35,003][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 06:19:35,004][dance][wrapped_func] Took 0:00:00.172993 to load and process data.
[INFO][2024-03-16 06:19:35,005][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 06:19:35,014][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 06:19:35,037][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 06:19:35,148][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-16 06:21:01,753][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 246) (k=201)
[INFO][2024-03-16 06:21:01,754][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.56%
[INFO][2024-03-16 06:21:17,154][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 06:21:17,155][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 06:21:17,155][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 06:21:17,155][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<03:04,  1.86s/it]  2%|‚ñè         | 2/100 [00:03<02:25,  1.48s/it]  3%|‚ñé         | 3/100 [00:04<02:09,  1.34s/it]  4%|‚ñç         | 4/100 [00:05<02:04,  1.30s/it]  5%|‚ñå         | 5/100 [00:06<02:06,  1.33s/it]  6%|‚ñå         | 6/100 [00:08<02:05,  1.34s/it]  7%|‚ñã         | 7/100 [00:09<02:04,  1.34s/it]  8%|‚ñä         | 8/100 [00:10<02:01,  1.32s/it]  9%|‚ñâ         | 9/100 [00:12<01:58,  1.30s/it] 10%|‚ñà         | 10/100 [00:13<02:02,  1.36s/it] 11%|‚ñà         | 11/100 [00:16<02:31,  1.70s/it] 12%|‚ñà‚ñè        | 12/100 [00:19<03:08,  2.14s/it] 13%|‚ñà‚ñé        | 13/100 [00:21<03:08,  2.16s/it] 14%|‚ñà‚ñç        | 14/100 [00:23<03:06,  2.17s/it] 15%|‚ñà‚ñå        | 15/100 [00:25<03:00,  2.12s/it] 16%|‚ñà‚ñå        | 16/100 [00:27<02:53,  2.06s/it] 17%|‚ñà‚ñã        | 17/100 [00:29<02:52,  2.08s/it] 18%|‚ñà‚ñä        | 18/100 [00:31<02:51,  2.09s/it] 19%|‚ñà‚ñâ        | 19/100 [00:33<02:51,  2.12s/it] 20%|‚ñà‚ñà        | 20/100 [00:36<02:55,  2.19s/it] 21%|‚ñà‚ñà        | 21/100 [00:38<02:55,  2.22s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:40<02:54,  2.24s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:43<02:53,  2.25s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:45<02:46,  2.19s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:47<02:37,  2.10s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:48<02:27,  1.99s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:50<02:26,  2.01s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:53<02:28,  2.07s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:55<02:24,  2.03s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:57<02:22,  2.03s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:59<02:23,  2.08s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:01<02:24,  2.12s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:03<02:22,  2.13s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:06<02:25,  2.20s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:07<02:15,  2.09s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:09<02:14,  2.11s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:11<02:10,  2.08s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:13<02:05,  2.02s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:15<02:00,  1.98s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:17<01:56,  1.94s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:19<01:55,  1.95s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:21<01:59,  2.05s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:23<01:49,  1.92s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:24<01:39,  1.78s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:26<01:33,  1.69s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:28<01:31,  1.69s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:29<01:29,  1.68s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:31<01:24,  1.62s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:32<01:21,  1.60s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:34<01:20,  1.61s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:36<01:22,  1.68s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:37<01:20,  1.68s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:39<01:15,  1.60s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:40<01:11,  1.56s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:42<01:11,  1.59s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:44<01:10,  1.61s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:45<01:07,  1.57s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:47<01:05,  1.56s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:48<01:03,  1.54s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:50<01:02,  1.56s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:52<01:03,  1.62s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:53<01:01,  1.61s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:55<00:58,  1.57s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:56<00:55,  1.54s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:59<01:06,  1.90s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [02:00<01:00,  1.78s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [02:02<00:57,  1.73s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [02:03<00:53,  1.67s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:05<00:51,  1.67s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:07<00:51,  1.72s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:09<00:49,  1.70s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:14<01:17,  2.77s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:18<01:29,  3.31s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:23<01:39,  3.81s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:28<01:42,  4.12s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:33<01:39,  4.16s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:37<01:39,  4.32s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:43<01:41,  4.63s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:48<01:41,  4.84s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:54<01:43,  5.17s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [03:01<01:51,  5.89s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [03:07<01:45,  5.85s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [03:13<01:40,  5.92s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [03:20<01:38,  6.18s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [03:27<01:35,  6.38s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [03:32<01:25,  6.07s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [03:37<01:12,  5.60s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [03:43<01:08,  5.68s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [03:48<01:02,  5.68s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [03:54<00:57,  5.75s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [04:01<00:54,  6.04s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [04:08<00:49,  6.24s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [04:14<00:44,  6.32s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [04:22<00:39,  6.66s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [04:29<00:34,  6.94s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [04:36<00:27,  6.93s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [04:44<00:21,  7.12s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [04:49<00:13,  6.58s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [04:56<00:06,  6.57s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [05:02<00:00,  6.43s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [05:02<00:00,  3.02s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.24357
wandb: 
wandb: üöÄ View run young-sweep-44 at: https://wandb.ai/xzy11632/dance-dev/runs/u85shdc0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_061928-u85shdc0/logs
wandb: Agent Starting Run: fqqfwy7t with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_062916-fqqfwy7t
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dulcet-sweep-45
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/fqqfwy7t
[INFO][2024-03-16 06:29:22,832][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 06:29:22,929][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 06:29:22,929][dance][wrapped_func] Took 0:00:00.096719 to load and process data.
[INFO][2024-03-16 06:29:22,930][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 06:29:22,932][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 06:29:22,951][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 06:29:23,000][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-16 06:30:46,701][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=135)
[INFO][2024-03-16 06:30:46,702][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.08%
[INFO][2024-03-16 06:38:01,423][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 06:38:01,423][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 06:38:01,424][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 06:38:01,424][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:03<05:43,  3.47s/it]  2%|‚ñè         | 2/100 [00:07<06:03,  3.71s/it]  3%|‚ñé         | 3/100 [00:10<05:56,  3.67s/it]  4%|‚ñç         | 4/100 [00:14<05:40,  3.55s/it]  5%|‚ñå         | 5/100 [00:17<05:32,  3.50s/it]  6%|‚ñå         | 6/100 [00:21<05:41,  3.63s/it]  7%|‚ñã         | 7/100 [00:25<05:31,  3.57s/it]  8%|‚ñä         | 8/100 [00:28<05:19,  3.47s/it]  9%|‚ñâ         | 9/100 [00:31<05:18,  3.50s/it] 10%|‚ñà         | 10/100 [00:35<05:12,  3.48s/it] 11%|‚ñà         | 11/100 [00:38<05:13,  3.52s/it] 12%|‚ñà‚ñè        | 12/100 [00:42<05:11,  3.54s/it] 13%|‚ñà‚ñé        | 13/100 [00:45<04:59,  3.44s/it] 14%|‚ñà‚ñç        | 14/100 [00:49<05:05,  3.55s/it] 15%|‚ñà‚ñå        | 15/100 [00:53<05:01,  3.54s/it] 16%|‚ñà‚ñå        | 16/100 [00:56<05:00,  3.58s/it] 17%|‚ñà‚ñã        | 17/100 [01:00<04:51,  3.51s/it] 18%|‚ñà‚ñä        | 18/100 [01:03<04:33,  3.34s/it] 19%|‚ñà‚ñâ        | 19/100 [01:05<04:18,  3.19s/it] 20%|‚ñà‚ñà        | 20/100 [01:08<03:57,  2.97s/it] 21%|‚ñà‚ñà        | 21/100 [01:09<03:14,  2.46s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [01:10<02:45,  2.12s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [01:11<02:18,  1.79s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [01:13<02:02,  1.61s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [01:14<01:48,  1.45s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [01:15<01:43,  1.40s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [01:16<01:35,  1.31s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [01:17<01:30,  1.26s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [01:18<01:24,  1.19s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [01:19<01:23,  1.20s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [01:21<01:19,  1.16s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:22<01:17,  1.15s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:23<01:14,  1.11s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:24<01:18,  1.19s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:25<01:15,  1.16s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:26<01:13,  1.15s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:27<01:10,  1.12s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:28<01:10,  1.14s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:30<01:10,  1.15s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:31<01:11,  1.19s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:32<01:09,  1.18s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:33<01:06,  1.15s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:34<01:06,  1.17s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:36<01:05,  1.18s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:37<01:03,  1.16s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:38<01:03,  1.18s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:39<01:01,  1.16s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:40<01:00,  1.17s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:41<00:57,  1.13s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:43<00:58,  1.18s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:44<00:55,  1.14s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:45<00:57,  1.19s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:46<00:57,  1.22s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:47<00:56,  1.23s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:48<00:51,  1.15s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:50<00:51,  1.17s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:51<00:48,  1.13s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:52<00:48,  1.15s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:53<00:46,  1.13s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:54<00:47,  1.19s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:55<00:43,  1.12s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:56<00:41,  1.09s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:57<00:40,  1.09s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:58<00:39,  1.09s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [02:00<00:38,  1.10s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [02:02<00:47,  1.40s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [02:05<01:05,  1.97s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [02:08<01:09,  2.17s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:10<01:08,  2.21s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:12<01:06,  2.23s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:14<00:59,  2.06s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:16<00:57,  2.07s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:18<00:54,  2.01s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:20<00:51,  1.97s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:21<00:45,  1.83s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:23<00:43,  1.80s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:24<00:38,  1.66s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:26<00:37,  1.71s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:28<00:35,  1.70s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:31<00:44,  2.24s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:34<00:47,  2.51s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:38<00:50,  2.79s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:40<00:45,  2.68s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:43<00:41,  2.61s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:45<00:38,  2.55s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:47<00:32,  2.29s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:49<00:28,  2.17s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:50<00:24,  2.04s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:52<00:21,  1.97s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:55<00:20,  2.09s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:57<00:18,  2.03s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:58<00:15,  1.98s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [03:00<00:13,  1.89s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [03:02<00:11,  1.91s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [03:04<00:09,  1.89s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [03:06<00:07,  1.92s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [03:07<00:05,  1.82s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [03:10<00:03,  1.95s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [03:11<00:01,  1.90s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:13<00:00,  1.85s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:13<00:00,  1.94s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.34346
wandb: 
wandb: üöÄ View run dulcet-sweep-45 at: https://wandb.ai/xzy11632/dance-dev/runs/fqqfwy7t
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_062916-fqqfwy7t/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: hi4jy6u1 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_064530-hi4jy6u1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run hardy-sweep-46
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/hi4jy6u1
[INFO][2024-03-16 06:45:36,471][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 06:45:36,581][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 06:45:36,581][dance][wrapped_func] Took 0:00:00.109415 to load and process data.
[INFO][2024-03-16 06:45:36,581][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 06:45:36,585][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 06:45:36,612][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 06:45:36,651][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-16 06:47:22,124][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=136)
[INFO][2024-03-16 06:47:22,134][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.87%
[INFO][2024-03-16 06:55:36,032][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 06:55:36,033][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 06:55:36,034][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 06:55:36,034][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:39,  1.61s/it]  2%|‚ñè         | 2/100 [00:02<02:07,  1.30s/it]  3%|‚ñé         | 3/100 [00:03<02:01,  1.25s/it]  4%|‚ñç         | 4/100 [00:04<01:53,  1.19s/it]  5%|‚ñå         | 5/100 [00:06<01:47,  1.14s/it]  6%|‚ñå         | 6/100 [00:07<02:02,  1.31s/it]  7%|‚ñã         | 7/100 [00:08<01:58,  1.27s/it]  8%|‚ñä         | 8/100 [00:10<01:58,  1.29s/it]  9%|‚ñâ         | 9/100 [00:11<01:55,  1.27s/it] 10%|‚ñà         | 10/100 [00:13<02:07,  1.42s/it] 11%|‚ñà         | 11/100 [00:16<02:45,  1.86s/it] 12%|‚ñà‚ñè        | 12/100 [00:18<03:02,  2.07s/it] 13%|‚ñà‚ñé        | 13/100 [00:20<03:01,  2.09s/it] 14%|‚ñà‚ñç        | 14/100 [00:22<02:57,  2.06s/it] 15%|‚ñà‚ñå        | 15/100 [00:25<03:04,  2.17s/it] 16%|‚ñà‚ñå        | 16/100 [00:27<02:59,  2.13s/it] 17%|‚ñà‚ñã        | 17/100 [00:29<03:00,  2.17s/it] 18%|‚ñà‚ñä        | 18/100 [00:31<03:00,  2.20s/it] 19%|‚ñà‚ñâ        | 19/100 [00:33<02:52,  2.13s/it] 20%|‚ñà‚ñà        | 20/100 [00:35<02:46,  2.08s/it] 21%|‚ñà‚ñà        | 21/100 [00:37<02:44,  2.08s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:40<02:50,  2.18s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:42<02:47,  2.17s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:44<02:41,  2.12s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:46<02:35,  2.07s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:48<02:31,  2.05s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:50<02:32,  2.09s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:52<02:29,  2.08s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:54<02:19,  1.97s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:56<02:19,  2.00s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:58<02:17,  1.99s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:00<02:19,  2.04s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:02<02:21,  2.11s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:04<02:19,  2.11s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:06<02:12,  2.04s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:08<02:07,  1.99s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:10<02:02,  1.95s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:12<01:57,  1.90s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:13<01:51,  1.84s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:15<01:46,  1.77s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:17<01:43,  1.75s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:18<01:40,  1.73s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:20<01:43,  1.81s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:22<01:35,  1.70s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:23<01:31,  1.66s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:25<01:29,  1.66s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:27<01:28,  1.68s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:30<01:46,  2.04s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:33<02:05,  2.47s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:37<02:17,  2.76s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:40<02:30,  3.07s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:44<02:38,  3.30s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:48<02:35,  3.32s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:51<02:38,  3.44s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:55<02:40,  3.56s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:59<02:45,  3.76s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [02:04<02:47,  3.90s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [02:07<02:40,  3.82s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [02:11<02:33,  3.75s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [02:14<02:23,  3.58s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [02:17<02:19,  3.57s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [02:21<02:15,  3.55s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [02:24<02:10,  3.53s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [02:28<02:05,  3.49s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [02:31<01:58,  3.38s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [02:34<01:55,  3.40s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [02:38<01:50,  3.35s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [02:41<01:44,  3.26s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:44<01:43,  3.34s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:47<01:39,  3.31s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:51<01:38,  3.39s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:54<01:32,  3.30s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:57<01:28,  3.29s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [03:01<01:27,  3.35s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [03:04<01:22,  3.31s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [03:08<01:21,  3.38s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [03:10<01:13,  3.18s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [03:14<01:12,  3.30s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [03:17<01:10,  3.34s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [03:20<01:02,  3.14s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [03:23<00:59,  3.14s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [03:26<00:56,  3.15s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [03:31<01:02,  3.69s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [03:37<01:07,  4.24s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [03:42<01:06,  4.41s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [03:46<01:00,  4.32s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [03:49<00:51,  3.93s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [03:52<00:43,  3.63s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [03:55<00:38,  3.50s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [03:58<00:33,  3.33s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [04:01<00:28,  3.18s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [04:04<00:25,  3.14s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [04:07<00:22,  3.20s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [04:10<00:19,  3.25s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [04:13<00:15,  3.12s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [04:16<00:12,  3.03s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [04:19<00:08,  2.93s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [04:21<00:05,  2.86s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [04:24<00:02,  2.84s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [04:27<00:00,  2.82s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [04:27<00:00,  2.68s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.37705
wandb: 
wandb: üöÄ View run hardy-sweep-46 at: https://wandb.ai/xzy11632/dance-dev/runs/hi4jy6u1
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_064530-hi4jy6u1/logs
wandb: Agent Starting Run: 9modjdet with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_070206-9modjdet
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run leafy-sweep-47
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/9modjdet
[INFO][2024-03-16 07:02:12,206][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 07:02:12,312][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 07:02:12,312][dance][wrapped_func] Took 0:00:00.104718 to load and process data.
[INFO][2024-03-16 07:02:12,312][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 07:02:12,314][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 07:02:12,339][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 07:02:12,399][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 07:03:40,945][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=101)
[INFO][2024-03-16 07:03:40,946][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.01%
[INFO][2024-03-16 07:03:46,964][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 07:03:46,965][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 07:03:46,965][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 07:03:46,965][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<03:07,  1.89s/it]  2%|‚ñè         | 2/100 [00:03<02:37,  1.60s/it]  3%|‚ñé         | 3/100 [00:04<02:20,  1.45s/it]  4%|‚ñç         | 4/100 [00:05<02:16,  1.42s/it]  5%|‚ñå         | 5/100 [00:07<02:13,  1.41s/it]  6%|‚ñå         | 6/100 [00:08<02:13,  1.42s/it]  7%|‚ñã         | 7/100 [00:10<02:08,  1.38s/it]  8%|‚ñä         | 8/100 [00:11<02:02,  1.33s/it]  9%|‚ñâ         | 9/100 [00:12<01:58,  1.30s/it] 10%|‚ñà         | 10/100 [00:13<01:57,  1.30s/it] 11%|‚ñà         | 11/100 [00:15<01:56,  1.31s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<01:57,  1.34s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<01:52,  1.30s/it] 14%|‚ñà‚ñç        | 14/100 [00:19<01:51,  1.30s/it] 15%|‚ñà‚ñå        | 15/100 [00:20<01:53,  1.34s/it] 16%|‚ñà‚ñå        | 16/100 [00:21<01:56,  1.38s/it] 17%|‚ñà‚ñã        | 17/100 [00:23<01:55,  1.40s/it] 18%|‚ñà‚ñä        | 18/100 [00:24<01:52,  1.37s/it] 19%|‚ñà‚ñâ        | 19/100 [00:25<01:45,  1.31s/it] 20%|‚ñà‚ñà        | 20/100 [00:27<01:45,  1.31s/it] 21%|‚ñà‚ñà        | 21/100 [00:28<01:40,  1.28s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:29<01:38,  1.26s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:30<01:35,  1.24s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:31<01:32,  1.21s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:33<01:27,  1.17s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:34<01:26,  1.17s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:35<01:24,  1.15s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:36<01:25,  1.18s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:37<01:23,  1.17s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:38<01:19,  1.14s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:39<01:16,  1.11s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:40<01:15,  1.11s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:42<01:16,  1.13s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:43<01:17,  1.17s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:44<01:17,  1.19s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:45<01:14,  1.16s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:46<01:10,  1.13s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:47<01:09,  1.11s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:48<01:07,  1.11s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:49<01:04,  1.07s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:51<01:03,  1.08s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:52<01:01,  1.07s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:53<01:01,  1.07s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:54<01:09,  1.24s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:56<01:15,  1.38s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:58<01:19,  1.48s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:59<01:14,  1.41s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:00<01:10,  1.36s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:01<01:05,  1.29s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:03<01:04,  1.30s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:04<01:02,  1.28s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:05<01:00,  1.26s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:06<00:57,  1.22s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:07<00:56,  1.23s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:09<00:54,  1.21s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:10<00:53,  1.22s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:11<00:55,  1.30s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:12<00:52,  1.24s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:14<00:53,  1.29s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:15<00:51,  1.29s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:16<00:48,  1.25s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:18<00:47,  1.25s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:19<00:46,  1.26s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:20<00:45,  1.25s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:21<00:44,  1.27s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:23<00:41,  1.23s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:24<00:40,  1.23s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:25<00:39,  1.25s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:26<00:38,  1.24s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:27<00:35,  1.19s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:29<00:36,  1.27s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:30<00:36,  1.29s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:31<00:33,  1.25s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:33<00:32,  1.27s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:34<00:31,  1.25s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:35<00:30,  1.27s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:36<00:28,  1.23s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:37<00:26,  1.22s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:39<00:25,  1.24s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:40<00:25,  1.25s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:41<00:23,  1.25s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:43<00:22,  1.25s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:44<00:20,  1.23s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:45<00:19,  1.22s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:46<00:18,  1.21s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:47<00:17,  1.26s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:49<00:15,  1.21s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:50<00:14,  1.20s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:51<00:13,  1.20s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:52<00:12,  1.27s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:53<00:10,  1.22s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:55<00:09,  1.17s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:56<00:07,  1.13s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:57<00:06,  1.13s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:58<00:05,  1.13s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:59<00:04,  1.17s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:00<00:03,  1.15s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:01<00:02,  1.14s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:03<00:01,  1.41s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:06<00:00,  1.64s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:06<00:00,  1.26s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.26808
wandb: 
wandb: üöÄ View run leafy-sweep-47 at: https://wandb.ai/xzy11632/dance-dev/runs/9modjdet
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_070206-9modjdet/logs
wandb: Agent Starting Run: j2bv9b5c with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_070839-j2bv9b5c
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run golden-sweep-48
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/j2bv9b5c
[INFO][2024-03-16 07:08:46,856][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 07:08:46,995][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 07:08:46,996][dance][wrapped_func] Took 0:00:00.138135 to load and process data.
[INFO][2024-03-16 07:08:46,996][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 07:08:46,999][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 07:08:47,026][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 07:08:47,127][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 07:10:46,709][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=100)
[INFO][2024-03-16 07:10:46,711][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.63%
[INFO][2024-03-16 07:30:35,562][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 07:30:35,563][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 07:30:35,563][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 07:30:35,563][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:02<04:47,  2.91s/it]  2%|‚ñè         | 2/100 [00:05<04:43,  2.89s/it]  3%|‚ñé         | 3/100 [00:08<04:42,  2.91s/it]  4%|‚ñç         | 4/100 [00:11<04:28,  2.80s/it]  5%|‚ñå         | 5/100 [00:14<04:30,  2.85s/it]  6%|‚ñå         | 6/100 [00:17<04:36,  2.94s/it]  7%|‚ñã         | 7/100 [00:22<05:40,  3.66s/it]  8%|‚ñä         | 8/100 [00:27<06:09,  4.02s/it]  9%|‚ñâ         | 9/100 [00:31<06:23,  4.21s/it] 10%|‚ñà         | 10/100 [00:36<06:21,  4.24s/it] 11%|‚ñà         | 11/100 [00:40<06:18,  4.26s/it] 12%|‚ñà‚ñè        | 12/100 [00:44<06:03,  4.13s/it] 13%|‚ñà‚ñé        | 13/100 [00:47<05:31,  3.81s/it] 14%|‚ñà‚ñç        | 14/100 [00:50<05:17,  3.69s/it] 15%|‚ñà‚ñå        | 15/100 [00:54<05:05,  3.59s/it] 16%|‚ñà‚ñå        | 16/100 [00:57<04:43,  3.38s/it] 17%|‚ñà‚ñã        | 17/100 [01:00<04:31,  3.27s/it] 18%|‚ñà‚ñä        | 18/100 [01:03<04:36,  3.38s/it] 19%|‚ñà‚ñâ        | 19/100 [01:07<04:32,  3.36s/it] 20%|‚ñà‚ñà        | 20/100 [01:10<04:36,  3.46s/it] 21%|‚ñà‚ñà        | 21/100 [01:13<04:22,  3.32s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [01:16<04:09,  3.20s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [01:19<03:54,  3.05s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [01:22<03:45,  2.97s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [01:24<03:35,  2.88s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [01:27<03:37,  2.94s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [01:30<03:27,  2.84s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [01:33<03:24,  2.84s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [01:35<03:13,  2.73s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [01:37<02:58,  2.55s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [01:40<02:48,  2.45s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:42<02:44,  2.42s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:44<02:37,  2.35s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:46<02:16,  2.06s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:47<02:03,  1.90s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:49<01:54,  1.78s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:50<01:49,  1.74s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:52<01:42,  1.65s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:53<01:36,  1.59s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:55<01:35,  1.59s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:56<01:31,  1.56s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:58<01:29,  1.53s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:59<01:26,  1.52s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [02:01<01:26,  1.54s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [02:02<01:26,  1.57s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [02:04<01:22,  1.54s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [02:05<01:22,  1.55s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [02:07<01:21,  1.56s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [02:09<01:19,  1.56s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [02:10<01:18,  1.58s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [02:12<01:16,  1.55s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [02:13<01:13,  1.54s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [02:15<01:10,  1.50s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [02:16<01:09,  1.51s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [02:18<01:05,  1.45s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [02:19<01:03,  1.45s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [02:21<01:03,  1.48s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [02:22<01:00,  1.45s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [02:23<01:00,  1.49s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [02:25<00:56,  1.42s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [02:26<00:55,  1.42s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [02:28<00:53,  1.40s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [02:29<00:52,  1.41s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [02:30<00:49,  1.38s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [02:32<00:47,  1.36s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [02:33<00:46,  1.35s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [02:34<00:43,  1.31s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [02:36<00:43,  1.35s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:37<00:41,  1.33s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:38<00:38,  1.29s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:39<00:38,  1.32s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:41<00:36,  1.31s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:42<00:34,  1.28s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:43<00:35,  1.37s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:46<00:39,  1.60s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:47<00:40,  1.68s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:49<00:40,  1.78s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:52<00:41,  1.88s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:54<00:40,  1.91s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:55<00:34,  1.75s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:56<00:31,  1.66s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:58<00:28,  1.57s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:59<00:26,  1.57s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [03:01<00:24,  1.54s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [03:02<00:22,  1.51s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [03:04<00:20,  1.46s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [03:05<00:18,  1.43s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [03:06<00:17,  1.45s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [03:08<00:15,  1.41s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [03:09<00:14,  1.46s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [03:11<00:12,  1.44s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [03:12<00:11,  1.47s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [03:14<00:10,  1.46s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [03:15<00:08,  1.44s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [03:17<00:07,  1.42s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [03:18<00:05,  1.47s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [03:19<00:04,  1.38s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [03:20<00:02,  1.31s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [03:22<00:01,  1.25s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:23<00:00,  1.24s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:23<00:00,  2.03s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.30953
wandb: 
wandb: üöÄ View run golden-sweep-48 at: https://wandb.ai/xzy11632/dance-dev/runs/j2bv9b5c
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_070839-j2bv9b5c/logs
wandb: Agent Starting Run: p1g8gg4k with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_073646-p1g8gg4k
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run restful-sweep-49
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/p1g8gg4k
[INFO][2024-03-16 07:36:55,586][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 07:36:55,746][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 07:36:55,747][dance][wrapped_func] Took 0:00:00.152192 to load and process data.
[INFO][2024-03-16 07:36:55,747][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 07:36:55,750][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 07:36:55,774][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 07:36:55,775][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 07:36:55,871][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 07:36:55,934][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 07:39:03,505][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 980) (k=452)
[INFO][2024-03-16 07:39:03,512][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.04%
[INFO][2024-03-16 07:57:25,179][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 07:57:25,180][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 07:57:25,183][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 07:57:25,184][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:03<05:46,  3.50s/it]  2%|‚ñè         | 2/100 [00:06<05:31,  3.38s/it]  3%|‚ñé         | 3/100 [00:08<04:28,  2.77s/it]  4%|‚ñç         | 4/100 [00:10<03:52,  2.42s/it]  5%|‚ñå         | 5/100 [00:12<03:37,  2.29s/it]  6%|‚ñå         | 6/100 [00:14<03:22,  2.15s/it]  7%|‚ñã         | 7/100 [00:16<03:21,  2.16s/it]  8%|‚ñä         | 8/100 [00:18<03:13,  2.10s/it]  9%|‚ñâ         | 9/100 [00:20<03:05,  2.03s/it] 10%|‚ñà         | 10/100 [00:22<03:07,  2.08s/it] 11%|‚ñà         | 11/100 [00:24<02:57,  1.99s/it] 12%|‚ñà‚ñè        | 12/100 [00:26<02:59,  2.04s/it] 13%|‚ñà‚ñé        | 13/100 [00:28<02:50,  1.96s/it] 14%|‚ñà‚ñç        | 14/100 [00:30<02:42,  1.88s/it] 15%|‚ñà‚ñå        | 15/100 [00:32<02:36,  1.84s/it] 16%|‚ñà‚ñå        | 16/100 [00:34<02:45,  1.97s/it] 17%|‚ñà‚ñã        | 17/100 [00:36<02:38,  1.90s/it] 18%|‚ñà‚ñä        | 18/100 [00:37<02:30,  1.83s/it] 19%|‚ñà‚ñâ        | 19/100 [00:39<02:28,  1.84s/it] 20%|‚ñà‚ñà        | 20/100 [00:41<02:28,  1.86s/it] 21%|‚ñà‚ñà        | 21/100 [00:43<02:31,  1.92s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:45<02:18,  1.78s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:46<02:09,  1.68s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:47<02:01,  1.59s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:49<01:59,  1.59s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:50<01:56,  1.57s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:52<01:51,  1.53s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:53<01:50,  1.53s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:55<01:52,  1.58s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:57<01:55,  1.64s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:59<01:52,  1.63s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:00<01:48,  1.59s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:01<01:42,  1.53s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:03<01:39,  1.50s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:04<01:34,  1.45s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:06<01:31,  1.43s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:07<01:28,  1.41s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:08<01:27,  1.41s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:10<01:26,  1.42s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:11<01:25,  1.42s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:13<01:22,  1.40s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:14<01:18,  1.35s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:16<01:34,  1.66s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:21<02:32,  2.72s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:25<02:44,  2.99s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:29<02:53,  3.22s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:33<03:09,  3.58s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:38<03:27,  3.98s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:43<03:34,  4.21s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:47<03:28,  4.16s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:51<03:20,  4.09s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:57<03:40,  4.58s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [02:02<03:49,  4.88s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [02:06<03:34,  4.66s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [02:12<03:37,  4.84s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [02:16<03:21,  4.59s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [02:20<03:11,  4.44s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [02:24<03:01,  4.32s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [02:27<02:48,  4.11s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [02:31<02:37,  3.94s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [02:35<02:38,  4.06s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [02:39<02:37,  4.14s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [02:43<02:27,  4.00s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [02:47<02:20,  3.91s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [02:50<02:12,  3.79s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [02:54<02:05,  3.69s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [02:57<01:57,  3.56s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [03:00<01:44,  3.27s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [03:02<01:34,  3.05s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [03:04<01:18,  2.61s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [03:05<01:05,  2.25s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [03:07<00:56,  2.01s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [03:08<00:50,  1.88s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [03:10<00:47,  1.82s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [03:12<00:44,  1.77s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [03:13<00:39,  1.65s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [03:14<00:36,  1.57s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [03:16<00:34,  1.55s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [03:17<00:32,  1.54s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [03:19<00:31,  1.57s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [03:20<00:29,  1.56s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [03:22<00:27,  1.50s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [03:23<00:25,  1.48s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [03:25<00:23,  1.46s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [03:26<00:22,  1.48s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [03:28<00:20,  1.43s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [03:29<00:17,  1.38s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [03:30<00:16,  1.41s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [03:32<00:15,  1.38s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [03:33<00:13,  1.38s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [03:34<00:12,  1.35s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [03:36<00:10,  1.35s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [03:37<00:09,  1.35s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [03:38<00:08,  1.39s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [03:40<00:06,  1.40s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [03:41<00:05,  1.36s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [03:43<00:04,  1.41s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [03:44<00:02,  1.42s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [03:48<00:02,  2.17s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:50<00:00,  1.97s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:50<00:00,  2.30s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.024 MB of 0.025 MB uploadedwandb: - 0.024 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.12852
wandb: 
wandb: üöÄ View run restful-sweep-49 at: https://wandb.ai/xzy11632/dance-dev/runs/p1g8gg4k
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_073646-p1g8gg4k/logs
wandb: Agent Starting Run: j9xqyheg with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_080305-j9xqyheg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fanciful-sweep-50
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/j9xqyheg
[INFO][2024-03-16 08:03:10,842][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 08:03:10,909][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 08:03:10,909][dance][wrapped_func] Took 0:00:00.066162 to load and process data.
[INFO][2024-03-16 08:03:10,909][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 08:03:10,911][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 08:03:10,929][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 08:03:10,929][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 08:03:10,985][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 08:03:11,027][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 08:03:18,114][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 980) (k=435)
[INFO][2024-03-16 08:03:18,115][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.08%
[INFO][2024-03-16 08:03:20,397][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 08:03:20,397][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 08:03:20,397][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 08:03:20,397][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:15,  1.37s/it]  2%|‚ñè         | 2/100 [00:02<02:25,  1.48s/it]  3%|‚ñé         | 3/100 [00:04<02:21,  1.45s/it]  4%|‚ñç         | 4/100 [00:05<02:13,  1.39s/it]  5%|‚ñå         | 5/100 [00:06<02:09,  1.37s/it]  6%|‚ñå         | 6/100 [00:08<02:08,  1.36s/it]  7%|‚ñã         | 7/100 [00:09<02:04,  1.34s/it]  8%|‚ñä         | 8/100 [00:10<02:01,  1.32s/it]  9%|‚ñâ         | 9/100 [00:12<02:00,  1.33s/it] 10%|‚ñà         | 10/100 [00:13<02:00,  1.33s/it] 11%|‚ñà         | 11/100 [00:15<02:02,  1.37s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<01:59,  1.36s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<01:56,  1.34s/it] 14%|‚ñà‚ñç        | 14/100 [00:19<01:56,  1.36s/it] 15%|‚ñà‚ñå        | 15/100 [00:20<01:52,  1.32s/it] 16%|‚ñà‚ñå        | 16/100 [00:21<01:54,  1.37s/it] 17%|‚ñà‚ñã        | 17/100 [00:23<01:52,  1.35s/it] 18%|‚ñà‚ñä        | 18/100 [00:24<01:51,  1.36s/it] 19%|‚ñà‚ñâ        | 19/100 [00:25<01:50,  1.36s/it] 20%|‚ñà‚ñà        | 20/100 [00:27<01:45,  1.32s/it] 21%|‚ñà‚ñà        | 21/100 [00:29<01:59,  1.51s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:30<01:57,  1.50s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:32<01:56,  1.52s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:33<01:52,  1.48s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:34<01:48,  1.44s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:36<01:45,  1.43s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:37<01:44,  1.43s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:38<01:40,  1.40s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:40<01:42,  1.44s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:41<01:38,  1.41s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:43<01:39,  1.44s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:45<01:46,  1.56s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:46<01:41,  1.51s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:47<01:37,  1.48s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:49<01:30,  1.39s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:50<01:25,  1.33s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:51<01:20,  1.29s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:52<01:21,  1.31s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:54<01:17,  1.27s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:55<01:16,  1.27s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:56<01:14,  1.27s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:57<01:14,  1.28s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:59<01:13,  1.29s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:00<01:09,  1.25s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:01<01:06,  1.22s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:02<01:06,  1.24s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:04<01:08,  1.29s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:05<01:07,  1.29s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:06<01:04,  1.26s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:08<01:03,  1.27s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:09<01:01,  1.25s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:10<00:58,  1.22s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:11<00:56,  1.19s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:12<00:53,  1.16s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:13<00:52,  1.16s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:14<00:50,  1.15s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:16<00:50,  1.18s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:18<01:01,  1.45s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:20<01:11,  1.73s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:22<01:08,  1.71s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:23<01:01,  1.58s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:24<00:58,  1.54s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:26<00:54,  1.47s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:29<01:15,  2.10s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:31<01:05,  1.86s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:34<01:14,  2.19s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:37<01:22,  2.50s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:39<01:19,  2.49s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:41<01:10,  2.28s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:43<01:04,  2.14s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:45<01:01,  2.11s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:47<00:57,  2.06s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:49<00:53,  2.00s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:50<00:49,  1.91s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:52<00:47,  1.91s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:54<00:43,  1.82s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:56<00:42,  1.84s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:58<00:40,  1.84s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:59<00:38,  1.82s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:01<00:35,  1.77s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:03<00:33,  1.77s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:05<00:31,  1.74s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:07<00:31,  1.82s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:08<00:28,  1.81s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:10<00:26,  1.77s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:12<00:24,  1.75s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:13<00:22,  1.75s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:16<00:22,  1.84s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:17<00:20,  1.84s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:19<00:17,  1.79s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:21<00:15,  1.77s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:23<00:14,  1.77s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:24<00:12,  1.74s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:26<00:10,  1.68s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:27<00:08,  1.67s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:29<00:06,  1.72s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:31<00:05,  1.83s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:33<00:03,  1.84s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:35<00:01,  1.78s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:36<00:00,  1.72s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:36<00:00,  1.57s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.16017
wandb: 
wandb: üöÄ View run fanciful-sweep-50 at: https://wandb.ai/xzy11632/dance-dev/runs/j9xqyheg
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_080305-j9xqyheg/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: fvhl7kfr with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_080750-fvhl7kfr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run colorful-sweep-51
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/fvhl7kfr
[INFO][2024-03-16 08:07:55,449][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 08:07:55,521][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 08:07:55,522][dance][wrapped_func] Took 0:00:00.065679 to load and process data.
[INFO][2024-03-16 08:07:55,522][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 08:07:55,524][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 08:07:55,537][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 08:07:55,590][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 08:07:55,726][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.018 MB of 0.024 MB uploadedwandb: / 0.018 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run colorful-sweep-51 at: https://wandb.ai/xzy11632/dance-dev/runs/fvhl7kfr
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_080750-fvhl7kfr/logs
wandb: ERROR Run fvhl7kfr errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1020) out of bounds (980)
wandb: ERROR 
wandb: Agent Starting Run: jxeyyqc4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_080807-jxeyyqc4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run eager-sweep-52
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/jxeyyqc4
[INFO][2024-03-16 08:08:12,372][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 08:08:12,456][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 08:08:12,456][dance][wrapped_func] Took 0:00:00.083619 to load and process data.
[INFO][2024-03-16 08:08:12,456][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 08:08:12,458][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 08:08:12,470][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 08:08:12,517][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 08:08:12,650][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.015 MB of 0.024 MB uploadedwandb: / 0.015 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run eager-sweep-52 at: https://wandb.ai/xzy11632/dance-dev/runs/jxeyyqc4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_080807-jxeyyqc4/logs
wandb: ERROR Run jxeyyqc4 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1020) out of bounds (980)
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: akz8iv2i with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_080832-akz8iv2i
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glamorous-sweep-53
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/akz8iv2i
[INFO][2024-03-16 08:08:37,569][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 08:08:37,667][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 08:08:37,667][dance][wrapped_func] Took 0:00:00.097935 to load and process data.
[INFO][2024-03-16 08:08:37,668][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 08:08:37,669][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 08:08:37,681][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 08:08:37,721][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 08:08:38,470][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=90)
[INFO][2024-03-16 08:08:38,471][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.08%
[INFO][2024-03-16 08:08:40,290][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 08:08:40,290][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 08:08:40,290][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 08:08:40,291][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:55,  1.16s/it]  2%|‚ñè         | 2/100 [00:02<01:59,  1.22s/it]  3%|‚ñé         | 3/100 [00:03<01:51,  1.15s/it]  4%|‚ñç         | 4/100 [00:04<01:46,  1.10s/it]  5%|‚ñå         | 5/100 [00:05<01:56,  1.23s/it]  6%|‚ñå         | 6/100 [00:07<01:53,  1.21s/it]  7%|‚ñã         | 7/100 [00:08<01:53,  1.22s/it]  8%|‚ñä         | 8/100 [00:09<01:55,  1.26s/it]  9%|‚ñâ         | 9/100 [00:11<01:58,  1.30s/it] 10%|‚ñà         | 10/100 [00:12<01:58,  1.31s/it] 11%|‚ñà         | 11/100 [00:13<01:55,  1.30s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:57,  1.33s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:53,  1.31s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:50,  1.28s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:43,  1.22s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:42,  1.23s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:43,  1.25s/it] 18%|‚ñà‚ñä        | 18/100 [00:22<01:40,  1.23s/it] 19%|‚ñà‚ñâ        | 19/100 [00:23<01:40,  1.24s/it] 20%|‚ñà‚ñà        | 20/100 [00:24<01:36,  1.21s/it] 21%|‚ñà‚ñà        | 21/100 [00:25<01:33,  1.18s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:26<01:28,  1.14s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:28<01:26,  1.13s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:29<01:23,  1.10s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:30<01:22,  1.10s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:31<01:22,  1.12s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:32<01:24,  1.16s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:33<01:22,  1.14s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:34<01:17,  1.09s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:35<01:15,  1.08s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:36<01:17,  1.13s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:38<01:18,  1.15s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:39<01:17,  1.16s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:40<01:12,  1.10s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:41<01:09,  1.07s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:42<01:07,  1.05s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:43<01:11,  1.13s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:44<01:11,  1.15s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:46<01:10,  1.15s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:47<01:09,  1.16s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:48<01:06,  1.13s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:49<01:11,  1.23s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:51<01:10,  1.24s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:52<01:09,  1.25s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:53<01:06,  1.20s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:54<01:04,  1.20s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:55<01:02,  1.18s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:56<00:59,  1.15s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:58<01:01,  1.21s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:59<01:02,  1.24s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:00<01:03,  1.30s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:02<01:00,  1.26s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:03<00:59,  1.26s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:04<00:58,  1.27s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:05<00:57,  1.29s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:07<00:56,  1.27s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:08<00:52,  1.23s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:09<00:50,  1.20s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:10<00:48,  1.19s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:11<00:47,  1.19s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:12<00:46,  1.19s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:14<00:45,  1.19s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:15<00:43,  1.19s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:16<00:42,  1.18s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:17<00:41,  1.19s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:19<00:45,  1.34s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:20<00:45,  1.37s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:21<00:40,  1.26s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:22<00:36,  1.19s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:23<00:34,  1.14s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:25<00:33,  1.15s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:26<00:30,  1.11s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:27<00:29,  1.10s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:28<00:28,  1.11s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:29<00:27,  1.10s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:30<00:27,  1.16s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:31<00:26,  1.17s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:33<00:25,  1.17s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:34<00:26,  1.25s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:35<00:26,  1.31s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:37<00:24,  1.29s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:38<00:23,  1.29s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:39<00:20,  1.22s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:40<00:19,  1.19s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:41<00:17,  1.18s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:42<00:16,  1.17s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:44<00:15,  1.18s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:45<00:13,  1.13s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:46<00:12,  1.17s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:47<00:11,  1.20s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:48<00:10,  1.19s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:49<00:09,  1.18s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:51<00:08,  1.18s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:52<00:07,  1.24s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:53<00:06,  1.23s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:55<00:05,  1.27s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:56<00:03,  1.27s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:57<00:02,  1.24s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:58<00:01,  1.25s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:00<00:00,  1.24s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:00<00:00,  1.20s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.17305
wandb: 
wandb: üöÄ View run glamorous-sweep-53 at: https://wandb.ai/xzy11632/dance-dev/runs/akz8iv2i
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_080832-akz8iv2i/logs
wandb: Agent Starting Run: docp67uj with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_081211-docp67uj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run smooth-sweep-54
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/docp67uj
[INFO][2024-03-16 08:12:16,384][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 08:12:16,463][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 08:12:16,463][dance][wrapped_func] Took 0:00:00.070933 to load and process data.
[INFO][2024-03-16 08:12:16,463][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 08:12:16,466][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 08:12:16,482][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 08:12:16,527][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 08:12:18,090][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=84)
[INFO][2024-03-16 08:12:18,096][dance.WeightedFeatureSVD][__call__] Total explained variance: 88.87%
[INFO][2024-03-16 08:12:20,555][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 08:12:20,556][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 08:12:20,556][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 08:12:20,556][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:50,  1.12s/it]  2%|‚ñè         | 2/100 [00:02<01:54,  1.16s/it]  3%|‚ñé         | 3/100 [00:03<01:55,  1.19s/it]  4%|‚ñç         | 4/100 [00:04<01:51,  1.16s/it]  5%|‚ñå         | 5/100 [00:06<01:57,  1.24s/it]  6%|‚ñå         | 6/100 [00:07<02:03,  1.32s/it]  7%|‚ñã         | 7/100 [00:08<01:56,  1.25s/it]  8%|‚ñä         | 8/100 [00:09<01:54,  1.25s/it]  9%|‚ñâ         | 9/100 [00:11<01:54,  1.26s/it] 10%|‚ñà         | 10/100 [00:12<01:54,  1.28s/it] 11%|‚ñà         | 11/100 [00:13<01:48,  1.21s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:43,  1.18s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:43,  1.19s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:47,  1.25s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:47,  1.26s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:41,  1.21s/it] 17%|‚ñà‚ñã        | 17/100 [00:20<01:39,  1.20s/it] 18%|‚ñà‚ñä        | 18/100 [00:21<01:32,  1.12s/it] 19%|‚ñà‚ñâ        | 19/100 [00:22<01:32,  1.15s/it] 20%|‚ñà‚ñà        | 20/100 [00:24<01:35,  1.20s/it] 21%|‚ñà‚ñà        | 21/100 [00:25<01:35,  1.20s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:26<01:34,  1.21s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:27<01:32,  1.20s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:29<01:30,  1.19s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:30<01:29,  1.19s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:31<01:27,  1.18s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:32<01:26,  1.18s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:33<01:22,  1.14s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:34<01:19,  1.12s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:35<01:16,  1.10s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:36<01:16,  1.11s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:38<01:16,  1.13s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:39<01:16,  1.15s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:40<01:18,  1.19s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:41<01:16,  1.17s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:42<01:14,  1.16s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:44<01:16,  1.21s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:45<01:14,  1.20s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:46<01:13,  1.21s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:47<01:11,  1.19s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:48<01:10,  1.19s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:50<01:11,  1.23s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:51<01:09,  1.21s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:52<01:11,  1.27s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:54<01:09,  1.27s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:55<01:13,  1.36s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:57<01:13,  1.39s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:58<01:09,  1.34s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:59<01:05,  1.29s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:00<01:03,  1.27s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:01<01:01,  1.26s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:03<01:00,  1.25s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:04<00:57,  1.23s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:05<00:58,  1.26s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:06<00:56,  1.26s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:08<00:55,  1.25s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:09<00:53,  1.24s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:10<00:51,  1.23s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:11<00:51,  1.24s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:13<00:49,  1.24s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:14<00:48,  1.25s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:15<00:48,  1.27s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:17<00:48,  1.30s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:18<00:46,  1.29s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:19<00:43,  1.25s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:20<00:43,  1.27s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:22<00:41,  1.27s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:23<00:45,  1.44s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:25<00:44,  1.43s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:26<00:39,  1.33s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:27<00:36,  1.24s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:28<00:33,  1.18s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:29<00:31,  1.17s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:30<00:29,  1.14s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:31<00:27,  1.12s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:32<00:26,  1.09s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:33<00:24,  1.07s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:34<00:24,  1.10s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:36<00:23,  1.13s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:37<00:23,  1.18s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:38<00:22,  1.17s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:39<00:20,  1.15s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:40<00:19,  1.12s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:42<00:20,  1.28s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:44<00:21,  1.43s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:45<00:20,  1.49s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:46<00:17,  1.35s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:47<00:15,  1.27s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:49<00:13,  1.26s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:50<00:12,  1.22s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:51<00:10,  1.21s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:52<00:09,  1.19s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:53<00:08,  1.16s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:54<00:07,  1.19s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:56<00:06,  1.22s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:57<00:04,  1.21s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:58<00:03,  1.20s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:00<00:02,  1.37s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:02<00:01,  1.45s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:03<00:00,  1.42s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:03<00:00,  1.23s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.017 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.14488
wandb: 
wandb: üöÄ View run smooth-sweep-54 at: https://wandb.ai/xzy11632/dance-dev/runs/docp67uj
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_081211-docp67uj/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: cv0pexm1 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_081551-cv0pexm1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run atomic-sweep-55
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/cv0pexm1
[INFO][2024-03-16 08:15:59,441][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 08:15:59,524][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 08:15:59,524][dance][wrapped_func] Took 0:00:00.082370 to load and process data.
[INFO][2024-03-16 08:15:59,524][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 08:15:59,527][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 08:15:59,542][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 08:15:59,587][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run atomic-sweep-55 at: https://wandb.ai/xzy11632/dance-dev/runs/cv0pexm1
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_081551-cv0pexm1/logs
wandb: ERROR Run cv0pexm1 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/cell_feature.py", line 50, in __call__
wandb: ERROR     gene_feat = gene_pca.fit_transform(feat.T)  # decompose into gene features
wandb: ERROR                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
wandb: ERROR     data_to_wrap = f(self, X, *args, **kwargs)
wandb: ERROR                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 1152, in wrapper
wandb: ERROR     return fit_method(estimator, *args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 460, in fit_transform
wandb: ERROR     U, S, Vt = self._fit(X)
wandb: ERROR                ^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 483, in _fit
wandb: ERROR     X = self._validate_data(
wandb: ERROR         ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 605, in _validate_data
wandb: ERROR     out = check_array(X, input_name="X", **check_params)
wandb: ERROR           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/validation.py", line 967, in check_array
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: Found array with 0 sample(s) (shape=(0, 8218)) while a minimum of 1 is required by PCA.
wandb: ERROR 
wandb: Agent Starting Run: 40jkw7ee with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_081613-40jkw7ee
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run avid-sweep-56
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/40jkw7ee
[INFO][2024-03-16 08:16:18,687][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 08:16:18,794][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 08:16:18,795][dance][wrapped_func] Took 0:00:00.107125 to load and process data.
[INFO][2024-03-16 08:16:18,795][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 08:16:18,796][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 08:16:18,810][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 08:16:18,860][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.016 MB of 0.024 MB uploadedwandb: / 0.016 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run avid-sweep-56 at: https://wandb.ai/xzy11632/dance-dev/runs/40jkw7ee
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_081613-40jkw7ee/logs
wandb: ERROR Run 40jkw7ee errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/cell_feature.py", line 98, in __call__
wandb: ERROR     svd.fit_transform(feat)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
wandb: ERROR     data_to_wrap = f(self, X, *args, **kwargs)
wandb: ERROR                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 1145, in wrapper
wandb: ERROR     estimator._validate_params()
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 638, in _validate_params
wandb: ERROR     validate_parameter_constraints(
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_param_validation.py", line 96, in validate_parameter_constraints
wandb: ERROR     raise InvalidParameterError(
wandb: ERROR sklearn.utils._param_validation.InvalidParameterError: The 'n_components' parameter of TruncatedSVD must be an int in the range [1, inf). Got -1 instead.
wandb: ERROR 
wandb: Agent Starting Run: dl0god8l with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_081630-dl0god8l
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run pretty-sweep-57
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/dl0god8l
[INFO][2024-03-16 08:16:35,495][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 08:16:35,587][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 08:16:35,587][dance][wrapped_func] Took 0:00:00.091193 to load and process data.
[INFO][2024-03-16 08:16:35,587][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 08:16:35,590][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 08:16:35,606][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 08:16:35,653][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 08:16:36,290][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=92)
[INFO][2024-03-16 08:16:36,290][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.02%
[INFO][2024-03-16 08:16:38,160][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 08:16:38,160][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 08:16:38,160][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 08:16:38,160][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:53,  1.14s/it]  2%|‚ñè         | 2/100 [00:02<01:52,  1.15s/it]  3%|‚ñé         | 3/100 [00:03<01:58,  1.22s/it]  4%|‚ñç         | 4/100 [00:04<01:53,  1.18s/it]  5%|‚ñå         | 5/100 [00:05<01:50,  1.17s/it]  6%|‚ñå         | 6/100 [00:07<01:49,  1.17s/it]  7%|‚ñã         | 7/100 [00:08<02:04,  1.34s/it]  8%|‚ñä         | 8/100 [00:11<02:31,  1.64s/it]  9%|‚ñâ         | 9/100 [00:12<02:21,  1.55s/it] 10%|‚ñà         | 10/100 [00:13<02:03,  1.37s/it] 11%|‚ñà         | 11/100 [00:14<01:54,  1.29s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:48,  1.23s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<01:53,  1.30s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<01:52,  1.31s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<01:49,  1.28s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<01:49,  1.31s/it] 17%|‚ñà‚ñã        | 17/100 [00:22<01:46,  1.28s/it] 18%|‚ñà‚ñä        | 18/100 [00:23<01:39,  1.21s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<01:37,  1.20s/it] 20%|‚ñà‚ñà        | 20/100 [00:25<01:34,  1.18s/it] 21%|‚ñà‚ñà        | 21/100 [00:26<01:32,  1.17s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:27<01:27,  1.12s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:29<01:35,  1.25s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:31<01:54,  1.50s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:32<01:49,  1.46s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:34<01:56,  1.57s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:36<01:56,  1.59s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:37<01:55,  1.60s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:39<01:58,  1.67s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:41<01:52,  1.61s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:42<01:51,  1.61s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:44<01:48,  1.60s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:45<01:49,  1.63s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:47<01:45,  1.60s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:48<01:41,  1.56s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:50<01:37,  1.52s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:51<01:36,  1.54s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:53<01:36,  1.55s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:55<01:38,  1.62s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:56<01:38,  1.64s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:58<01:34,  1.60s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:00<01:33,  1.61s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:01<01:30,  1.59s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:03<01:31,  1.64s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:04<01:27,  1.59s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:06<01:23,  1.54s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:07<01:18,  1.48s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:09<01:21,  1.57s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:11<01:20,  1.58s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:12<01:24,  1.69s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:14<01:19,  1.62s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:15<01:14,  1.55s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:17<01:11,  1.52s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:18<01:05,  1.42s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:19<00:59,  1.33s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:20<00:57,  1.30s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:21<00:54,  1.26s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:23<00:52,  1.26s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:24<00:50,  1.23s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:25<00:47,  1.20s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:26<00:45,  1.17s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:27<00:42,  1.13s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:29<00:48,  1.32s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:31<00:56,  1.57s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:32<00:51,  1.46s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:33<00:45,  1.35s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:34<00:42,  1.28s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:36<00:39,  1.23s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:37<00:36,  1.19s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:38<00:34,  1.16s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:39<00:33,  1.17s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:40<00:32,  1.16s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:41<00:32,  1.19s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:42<00:29,  1.14s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:44<00:28,  1.13s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:45<00:27,  1.16s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:47<00:32,  1.43s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:49<00:35,  1.60s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:50<00:30,  1.45s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:51<00:26,  1.33s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:52<00:24,  1.29s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:53<00:22,  1.25s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:54<00:20,  1.20s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:55<00:18,  1.14s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:56<00:16,  1.12s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:58<00:16,  1.16s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:59<00:15,  1.19s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:00<00:14,  1.19s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:01<00:13,  1.19s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:02<00:11,  1.16s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:04<00:12,  1.37s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:06<00:12,  1.52s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:08<00:10,  1.54s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:09<00:08,  1.39s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:10<00:06,  1.31s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:11<00:04,  1.23s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:12<00:03,  1.18s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:13<00:02,  1.16s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:14<00:01,  1.15s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:16<00:00,  1.19s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:16<00:00,  1.36s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.17305
wandb: 
wandb: üöÄ View run pretty-sweep-57 at: https://wandb.ai/xzy11632/dance-dev/runs/dl0god8l
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_081630-dl0god8l/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: xb9424pj with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_082044-xb9424pj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run summer-sweep-58
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/xb9424pj
[INFO][2024-03-16 08:20:50,567][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 08:20:50,660][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 08:20:50,661][dance][wrapped_func] Took 0:00:00.092628 to load and process data.
[INFO][2024-03-16 08:20:50,661][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 08:20:50,664][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 08:20:50,682][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 08:20:50,741][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 08:20:54,359][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=87)
[INFO][2024-03-16 08:20:54,366][dance.WeightedFeatureSVD][__call__] Total explained variance: 88.96%
[INFO][2024-03-16 08:20:57,798][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 08:20:57,798][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 08:20:57,798][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 08:20:57,798][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:48,  1.10s/it]  2%|‚ñè         | 2/100 [00:02<01:51,  1.14s/it]  3%|‚ñé         | 3/100 [00:03<01:51,  1.15s/it]  4%|‚ñç         | 4/100 [00:04<01:51,  1.16s/it]  5%|‚ñå         | 5/100 [00:05<01:49,  1.15s/it]  6%|‚ñå         | 6/100 [00:06<01:49,  1.17s/it]  7%|‚ñã         | 7/100 [00:08<01:51,  1.20s/it]  8%|‚ñä         | 8/100 [00:09<01:49,  1.19s/it]  9%|‚ñâ         | 9/100 [00:10<01:47,  1.18s/it] 10%|‚ñà         | 10/100 [00:11<01:44,  1.16s/it] 11%|‚ñà         | 11/100 [00:13<01:54,  1.29s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<02:19,  1.58s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<02:15,  1.56s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<02:07,  1.49s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<01:56,  1.37s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<01:51,  1.33s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:48,  1.30s/it] 18%|‚ñà‚ñä        | 18/100 [00:23<01:45,  1.28s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<01:43,  1.28s/it] 20%|‚ñà‚ñà        | 20/100 [00:25<01:38,  1.23s/it] 21%|‚ñà‚ñà        | 21/100 [00:26<01:39,  1.25s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:28<01:36,  1.24s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:29<01:30,  1.18s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:30<01:27,  1.15s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:31<01:39,  1.33s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:34<02:03,  1.67s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:35<01:49,  1.50s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:36<01:41,  1.41s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:37<01:35,  1.35s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:38<01:29,  1.28s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:40<01:24,  1.23s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:41<01:21,  1.20s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:42<01:22,  1.22s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:43<01:20,  1.22s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:45<01:26,  1.33s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:46<01:23,  1.30s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:47<01:16,  1.22s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:48<01:11,  1.16s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:50<01:21,  1.33s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:52<01:30,  1.50s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:53<01:21,  1.39s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:54<01:15,  1.30s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:55<01:10,  1.24s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:57<01:16,  1.37s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:59<01:23,  1.51s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:00<01:24,  1.56s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:02<01:23,  1.58s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:03<01:20,  1.56s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:05<01:17,  1.52s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:06<01:14,  1.48s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:07<01:08,  1.40s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:08<01:02,  1.30s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:09<00:57,  1.22s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:11<00:56,  1.22s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:13<01:05,  1.46s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:16<01:22,  1.88s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:18<01:21,  1.90s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:19<01:13,  1.74s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:20<01:04,  1.58s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:21<00:58,  1.45s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:22<00:52,  1.36s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:26<01:15,  1.99s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:29<01:23,  2.26s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:34<01:51,  3.10s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:39<02:10,  3.74s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:44<02:17,  4.05s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:46<01:56,  3.52s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:52<02:20,  4.38s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:59<02:38,  5.11s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:07<02:54,  5.81s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:14<03:01,  6.27s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:16<02:21,  5.07s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:18<01:46,  3.93s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:19<01:24,  3.24s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:21<01:10,  2.83s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:24<01:04,  2.70s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:25<00:51,  2.22s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:26<00:41,  1.89s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:27<00:35,  1.68s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:28<00:31,  1.56s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:29<00:27,  1.45s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:31<00:24,  1.36s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:32<00:22,  1.30s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:33<00:20,  1.27s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:34<00:18,  1.26s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:35<00:17,  1.28s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:37<00:16,  1.27s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:38<00:16,  1.34s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:39<00:14,  1.30s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:41<00:13,  1.30s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:43<00:13,  1.46s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:45<00:13,  1.73s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:46<00:11,  1.65s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:47<00:08,  1.47s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:49<00:06,  1.38s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:50<00:05,  1.27s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:51<00:03,  1.23s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:52<00:02,  1.19s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:53<00:01,  1.22s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:54<00:00,  1.22s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:54<00:00,  1.75s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.15329
wandb: 
wandb: üöÄ View run summer-sweep-58 at: https://wandb.ai/xzy11632/dance-dev/runs/xb9424pj
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_082044-xb9424pj/logs
wandb: Agent Starting Run: g8xabgg5 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_082515-g8xabgg5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run soft-sweep-59
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/g8xabgg5
[INFO][2024-03-16 08:25:21,131][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 08:25:21,222][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 08:25:21,222][dance][wrapped_func] Took 0:00:00.090145 to load and process data.
[INFO][2024-03-16 08:25:21,222][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 08:25:21,224][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 08:25:21,237][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 08:25:21,278][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 08:25:21,832][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=87)
[INFO][2024-03-16 08:25:21,833][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.10%
[INFO][2024-03-16 08:25:23,550][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 08:25:23,551][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 08:25:23,551][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 08:25:23,551][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:50,  1.12s/it]  2%|‚ñè         | 2/100 [00:02<01:56,  1.19s/it]  3%|‚ñé         | 3/100 [00:03<02:07,  1.31s/it]  4%|‚ñç         | 4/100 [00:05<02:10,  1.36s/it]  5%|‚ñå         | 5/100 [00:06<02:05,  1.32s/it]  6%|‚ñå         | 6/100 [00:07<02:06,  1.34s/it]  7%|‚ñã         | 7/100 [00:08<01:55,  1.24s/it]  8%|‚ñä         | 8/100 [00:10<01:49,  1.19s/it]  9%|‚ñâ         | 9/100 [00:11<02:00,  1.32s/it] 10%|‚ñà         | 10/100 [00:13<02:14,  1.50s/it] 11%|‚ñà         | 11/100 [00:14<02:08,  1.44s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<02:06,  1.44s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<02:03,  1.43s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<01:56,  1.35s/it] 15%|‚ñà‚ñå        | 15/100 [00:20<01:53,  1.33s/it] 16%|‚ñà‚ñå        | 16/100 [00:21<01:43,  1.23s/it] 17%|‚ñà‚ñã        | 17/100 [00:22<01:39,  1.20s/it] 18%|‚ñà‚ñä        | 18/100 [00:23<01:36,  1.17s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<01:33,  1.15s/it] 20%|‚ñà‚ñà        | 20/100 [00:25<01:34,  1.18s/it] 21%|‚ñà‚ñà        | 21/100 [00:26<01:34,  1.20s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:27<01:28,  1.13s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:29<01:26,  1.12s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:30<01:35,  1.26s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:32<01:40,  1.34s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:34<01:54,  1.55s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:35<01:42,  1.40s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:36<01:33,  1.31s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:37<01:28,  1.24s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:38<01:26,  1.23s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:39<01:23,  1.21s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:42<01:47,  1.58s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:45<02:18,  2.07s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:48<02:35,  2.35s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:51<02:40,  2.47s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:56<03:26,  3.22s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:01<04:00,  3.81s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:02<03:11,  3.09s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:05<03:04,  3.03s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:07<02:45,  2.76s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:10<02:33,  2.60s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:12<02:31,  2.61s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:15<02:34,  2.71s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:17<02:21,  2.53s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:19<02:09,  2.36s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:23<02:34,  2.86s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:27<02:49,  3.20s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:28<02:16,  2.63s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:31<02:10,  2.55s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:33<02:01,  2.43s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:35<01:56,  2.38s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:37<01:45,  2.19s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:39<01:33,  2.00s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:40<01:20,  1.76s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:41<01:11,  1.58s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:42<01:03,  1.44s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:43<00:57,  1.33s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:45<00:59,  1.42s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:46<01:02,  1.52s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:48<01:02,  1.57s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:50<01:01,  1.58s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:51<01:00,  1.60s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:53<00:58,  1.57s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:54<00:52,  1.47s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:55<00:47,  1.36s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:56<00:44,  1.31s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:58<00:41,  1.25s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:59<00:41,  1.29s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:01<00:45,  1.46s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:03<00:51,  1.70s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:04<00:45,  1.56s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:06<00:41,  1.48s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:07<00:36,  1.34s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:08<00:32,  1.26s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:09<00:31,  1.24s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:10<00:28,  1.18s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:11<00:26,  1.16s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:12<00:27,  1.24s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:14<00:27,  1.30s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:15<00:26,  1.34s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:17<00:26,  1.37s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:18<00:24,  1.35s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:19<00:22,  1.34s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:21<00:22,  1.42s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:23<00:26,  1.75s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:25<00:22,  1.60s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:26<00:19,  1.46s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:27<00:16,  1.41s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:28<00:14,  1.30s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:29<00:12,  1.26s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:31<00:11,  1.25s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:32<00:09,  1.20s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:33<00:08,  1.22s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:34<00:07,  1.23s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:35<00:06,  1.23s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:37<00:04,  1.22s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:38<00:03,  1.24s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:39<00:02,  1.26s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:41<00:01,  1.42s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:43<00:00,  1.61s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:43<00:00,  1.64s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.020 MB of 0.025 MB uploadedwandb: \ 0.020 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.1715
wandb: 
wandb: üöÄ View run soft-sweep-59 at: https://wandb.ai/xzy11632/dance-dev/runs/g8xabgg5
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_082515-g8xabgg5/logs
wandb: Agent Starting Run: 6lhmusi1 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_082949-6lhmusi1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run splendid-sweep-60
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/6lhmusi1
[INFO][2024-03-16 08:30:06,552][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 08:30:06,909][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 08:30:06,919][dance][wrapped_func] Took 0:00:00.365700 to load and process data.
[INFO][2024-03-16 08:30:06,920][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 08:30:06,923][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 08:30:06,997][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 08:30:07,123][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 08:30:15,139][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=82)
[INFO][2024-03-16 08:30:15,141][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.06%
[INFO][2024-03-16 08:30:36,857][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 08:30:36,857][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 08:30:36,857][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 08:30:36,857][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:56,  1.17s/it]  2%|‚ñè         | 2/100 [00:02<01:54,  1.17s/it]  3%|‚ñé         | 3/100 [00:03<01:50,  1.14s/it]  4%|‚ñç         | 4/100 [00:05<02:12,  1.38s/it]  5%|‚ñå         | 5/100 [00:06<02:08,  1.36s/it]  6%|‚ñå         | 6/100 [00:08<02:32,  1.62s/it]  7%|‚ñã         | 7/100 [00:09<02:13,  1.44s/it]  8%|‚ñä         | 8/100 [00:11<02:30,  1.64s/it]  9%|‚ñâ         | 9/100 [00:12<02:09,  1.42s/it] 10%|‚ñà         | 10/100 [00:13<01:55,  1.29s/it] 11%|‚ñà         | 11/100 [00:14<01:47,  1.21s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:42,  1.16s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<01:43,  1.19s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<01:46,  1.23s/it] 15%|‚ñà‚ñå        | 15/100 [00:20<02:01,  1.42s/it] 16%|‚ñà‚ñå        | 16/100 [00:23<02:36,  1.86s/it] 17%|‚ñà‚ñã        | 17/100 [00:26<03:16,  2.36s/it] 18%|‚ñà‚ñä        | 18/100 [00:28<03:03,  2.24s/it] 19%|‚ñà‚ñâ        | 19/100 [00:31<03:18,  2.46s/it] 20%|‚ñà‚ñà        | 20/100 [00:35<04:02,  3.03s/it] 21%|‚ñà‚ñà        | 21/100 [00:39<04:05,  3.11s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:44<04:43,  3.63s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:48<04:53,  3.81s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:50<04:05,  3.23s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:53<04:12,  3.36s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [01:00<05:31,  4.47s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [01:08<06:43,  5.52s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [01:14<06:38,  5.53s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [01:17<05:40,  4.80s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [01:18<04:17,  3.68s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [01:19<03:19,  2.89s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:20<02:39,  2.34s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:21<02:14,  2.01s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:23<01:55,  1.76s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:24<01:40,  1.54s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:25<01:33,  1.46s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:26<01:28,  1.40s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:27<01:22,  1.33s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:29<01:18,  1.29s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:30<01:11,  1.20s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:31<01:08,  1.16s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:32<01:16,  1.33s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:34<01:30,  1.58s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:36<01:21,  1.46s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:37<01:16,  1.39s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:38<01:12,  1.33s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:41<01:30,  1.70s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:45<02:05,  2.41s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:50<02:46,  3.26s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:54<02:59,  3.58s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:57<02:44,  3.36s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:59<02:13,  2.79s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [02:01<02:09,  2.76s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [02:04<02:01,  2.65s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [02:07<02:08,  2.85s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [02:09<02:00,  2.73s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [02:12<01:54,  2.65s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [02:14<01:47,  2.56s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [02:17<01:49,  2.67s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [02:20<01:53,  2.85s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [02:24<01:58,  3.04s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [02:25<01:33,  2.47s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [02:26<01:17,  2.09s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [02:28<01:05,  1.83s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [02:29<01:02,  1.79s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [02:31<01:04,  1.89s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [02:33<00:56,  1.71s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [02:34<00:48,  1.50s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:35<00:42,  1.36s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:36<00:39,  1.31s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:37<00:35,  1.23s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:38<00:32,  1.17s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:39<00:32,  1.22s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:41<00:35,  1.36s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:42<00:32,  1.32s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:43<00:31,  1.30s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:45<00:30,  1.32s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:46<00:27,  1.27s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:47<00:25,  1.24s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:48<00:23,  1.20s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:49<00:22,  1.19s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:51<00:22,  1.24s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:52<00:23,  1.37s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:54<00:25,  1.57s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:55<00:20,  1.40s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:57<00:18,  1.30s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:58<00:15,  1.23s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:59<00:14,  1.23s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [03:00<00:13,  1.20s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [03:01<00:11,  1.18s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [03:02<00:10,  1.17s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [03:04<00:09,  1.20s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [03:05<00:08,  1.25s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [03:06<00:07,  1.25s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [03:07<00:05,  1.19s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [03:09<00:05,  1.45s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [03:11<00:04,  1.47s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [03:13<00:03,  1.59s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [03:14<00:01,  1.53s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:15<00:00,  1.37s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:15<00:00,  1.96s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.17196
wandb: 
wandb: üöÄ View run splendid-sweep-60 at: https://wandb.ai/xzy11632/dance-dev/runs/6lhmusi1
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_082949-6lhmusi1/logs
wandb: Agent Starting Run: in6y9sh0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_083530-in6y9sh0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run firm-sweep-61
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/in6y9sh0
[INFO][2024-03-16 08:35:38,880][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 08:35:39,167][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 08:35:39,175][dance][wrapped_func] Took 0:00:00.294925 to load and process data.
[INFO][2024-03-16 08:35:39,177][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 08:35:39,181][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'Log1P',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 08:35:39,272][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 08:35:39,946][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 08:36:11,019][dance.WeightedFeaturePCA][__call__] Decomposing train features (7963, 980) (k=309)
[INFO][2024-03-16 08:36:11,020][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.02%
[INFO][2024-03-16 08:41:24,356][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 08:41:24,357][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 08:41:24,357][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 08:41:24,357][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:03<05:26,  3.29s/it]  2%|‚ñè         | 2/100 [00:07<05:46,  3.54s/it]  3%|‚ñé         | 3/100 [00:08<04:05,  2.53s/it]  4%|‚ñç         | 4/100 [00:09<03:22,  2.11s/it]  5%|‚ñå         | 5/100 [00:11<02:58,  1.88s/it]  6%|‚ñå         | 6/100 [00:12<02:40,  1.71s/it]  7%|‚ñã         | 7/100 [00:13<02:27,  1.59s/it]  8%|‚ñä         | 8/100 [00:15<02:17,  1.49s/it]  9%|‚ñâ         | 9/100 [00:16<02:13,  1.47s/it] 10%|‚ñà         | 10/100 [00:18<02:10,  1.45s/it] 11%|‚ñà         | 11/100 [00:19<02:11,  1.48s/it] 12%|‚ñà‚ñè        | 12/100 [00:21<02:13,  1.52s/it] 13%|‚ñà‚ñé        | 13/100 [00:22<02:04,  1.43s/it] 14%|‚ñà‚ñç        | 14/100 [00:24<02:23,  1.67s/it] 15%|‚ñà‚ñå        | 15/100 [00:26<02:23,  1.69s/it] 16%|‚ñà‚ñå        | 16/100 [00:28<02:43,  1.95s/it] 17%|‚ñà‚ñã        | 17/100 [00:30<02:26,  1.76s/it] 18%|‚ñà‚ñä        | 18/100 [00:31<02:12,  1.61s/it] 19%|‚ñà‚ñâ        | 19/100 [00:32<02:05,  1.55s/it] 20%|‚ñà‚ñà        | 20/100 [00:34<01:58,  1.48s/it] 21%|‚ñà‚ñà        | 21/100 [00:35<01:58,  1.50s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:37<02:10,  1.67s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:39<02:06,  1.65s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:41<02:10,  1.71s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:42<02:00,  1.61s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:44<01:51,  1.51s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:47<02:32,  2.09s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:49<02:19,  1.93s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:50<02:04,  1.76s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:53<02:21,  2.03s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:56<02:57,  2.57s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:00<03:13,  2.84s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:01<02:44,  2.45s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:03<02:25,  2.21s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:05<02:11,  2.02s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:06<01:54,  1.78s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:07<01:45,  1.68s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:09<01:53,  1.84s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:12<02:12,  2.17s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:14<01:53,  1.89s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:15<01:45,  1.78s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:16<01:34,  1.62s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:18<01:28,  1.56s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:19<01:22,  1.48s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:21<01:20,  1.47s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:25<02:00,  2.23s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:28<02:16,  2.57s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:31<02:15,  2.61s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:33<02:15,  2.66s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:36<02:13,  2.67s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:38<01:54,  2.34s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:40<01:52,  2.34s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:43<01:57,  2.49s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:44<01:41,  2.20s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:46<01:28,  1.97s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:47<01:17,  1.76s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:49<01:13,  1.70s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:50<01:06,  1.59s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:51<01:03,  1.54s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:53<01:02,  1.56s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:54<00:59,  1.51s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:56<00:56,  1.48s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:57<00:50,  1.37s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:59<00:52,  1.45s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [02:02<01:09,  1.98s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [02:03<01:01,  1.80s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [02:05<00:57,  1.75s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [02:06<00:51,  1.61s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:08<00:47,  1.54s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:09<00:44,  1.48s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:10<00:41,  1.42s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:13<00:53,  1.91s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:16<00:55,  2.04s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:18<00:58,  2.24s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:21<00:59,  2.39s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:24<00:59,  2.46s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:26<00:54,  2.35s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:29<00:56,  2.59s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:30<00:47,  2.24s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:32<00:39,  1.99s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:33<00:33,  1.79s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:34<00:28,  1.61s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:35<00:25,  1.48s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:37<00:23,  1.44s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:48<01:07,  4.50s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [03:01<01:38,  7.06s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [03:09<01:34,  7.27s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [03:23<01:52,  9.33s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [03:38<02:00, 10.94s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [03:45<01:38,  9.89s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [03:51<01:16,  8.46s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [03:54<00:54,  6.85s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [03:57<00:40,  5.78s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [04:00<00:30,  5.05s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [04:03<00:22,  4.47s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [04:07<00:16,  4.12s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [04:10<00:11,  3.84s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [04:13<00:07,  3.65s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [04:16<00:03,  3.49s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [04:19<00:00,  3.41s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [04:19<00:00,  2.60s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.24976
wandb: 
wandb: üöÄ View run firm-sweep-61 at: https://wandb.ai/xzy11632/dance-dev/runs/in6y9sh0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_083530-in6y9sh0/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 82pnf0bx with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_084654-82pnf0bx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run autumn-sweep-62
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/82pnf0bx
[INFO][2024-03-16 08:47:01,137][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 08:47:01,232][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 08:47:01,234][dance][wrapped_func] Took 0:00:00.096058 to load and process data.
[INFO][2024-03-16 08:47:01,234][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 08:47:01,237][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'Log1P',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 08:47:01,286][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 08:47:01,422][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 08:52:01,542][dance.WeightedFeatureSVD][__call__] Decomposing train features (7963, 980) (k=628)
[INFO][2024-03-16 08:52:01,543][dance.WeightedFeatureSVD][__call__] Total explained variance: 96.35%
[INFO][2024-03-16 08:59:29,331][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 08:59:29,332][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 08:59:29,332][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 08:59:29,333][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:03<05:47,  3.51s/it]  2%|‚ñè         | 2/100 [00:07<06:04,  3.72s/it]  3%|‚ñé         | 3/100 [00:12<06:44,  4.17s/it]  4%|‚ñç         | 4/100 [00:15<06:12,  3.88s/it]  5%|‚ñå         | 5/100 [00:18<05:47,  3.66s/it]  6%|‚ñå         | 6/100 [00:22<05:35,  3.57s/it]  7%|‚ñã         | 7/100 [00:25<05:18,  3.42s/it]  8%|‚ñä         | 8/100 [00:28<05:16,  3.44s/it]  9%|‚ñâ         | 9/100 [00:31<05:04,  3.35s/it] 10%|‚ñà         | 10/100 [00:35<05:01,  3.35s/it] 11%|‚ñà         | 11/100 [00:38<04:59,  3.36s/it] 12%|‚ñà‚ñè        | 12/100 [00:42<04:56,  3.37s/it] 13%|‚ñà‚ñé        | 13/100 [00:47<05:49,  4.02s/it] 14%|‚ñà‚ñç        | 14/100 [00:50<05:23,  3.76s/it] 15%|‚ñà‚ñå        | 15/100 [00:53<05:06,  3.60s/it] 16%|‚ñà‚ñå        | 16/100 [00:57<04:59,  3.56s/it] 17%|‚ñà‚ñã        | 17/100 [01:00<04:49,  3.49s/it] 18%|‚ñà‚ñä        | 18/100 [01:04<04:44,  3.47s/it] 19%|‚ñà‚ñâ        | 19/100 [01:07<04:36,  3.41s/it] 20%|‚ñà‚ñà        | 20/100 [01:10<04:31,  3.39s/it] 21%|‚ñà‚ñà        | 21/100 [01:13<04:22,  3.32s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [01:17<04:21,  3.35s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [01:21<04:42,  3.67s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [01:25<04:50,  3.82s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [01:29<04:33,  3.65s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [01:32<04:23,  3.56s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [01:35<04:14,  3.48s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [01:39<04:07,  3.44s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [01:42<04:02,  3.42s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [01:45<03:57,  3.39s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [01:49<03:52,  3.37s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:52<03:49,  3.38s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:56<03:55,  3.52s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [02:01<04:14,  3.85s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [02:04<04:03,  3.75s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [02:08<03:53,  3.64s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [02:11<03:40,  3.50s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [02:14<03:27,  3.35s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [02:17<03:19,  3.27s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [02:20<03:11,  3.20s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [02:22<02:52,  2.92s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [02:24<02:28,  2.56s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [02:25<02:09,  2.27s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [02:27<01:50,  1.97s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [02:29<01:53,  2.07s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [02:32<02:02,  2.27s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [02:33<01:45,  1.98s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [02:35<01:36,  1.85s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [02:36<01:26,  1.69s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [02:37<01:22,  1.64s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [02:39<01:15,  1.54s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [02:40<01:11,  1.50s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [02:42<01:11,  1.52s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [02:43<01:13,  1.60s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [02:45<01:10,  1.57s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [02:47<01:10,  1.61s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [02:48<01:08,  1.59s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [02:50<01:13,  1.74s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [02:53<01:27,  2.15s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [02:55<01:15,  1.90s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [02:56<01:07,  1.73s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [02:57<01:01,  1.62s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [02:59<00:56,  1.52s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [03:00<00:54,  1.51s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [03:02<00:51,  1.47s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [03:03<00:50,  1.48s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [03:04<00:48,  1.46s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [03:06<00:48,  1.53s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [03:08<00:48,  1.58s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [03:09<00:45,  1.51s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [03:13<01:05,  2.24s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [03:15<00:55,  1.99s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [03:16<00:48,  1.81s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [03:17<00:43,  1.67s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [03:19<00:39,  1.59s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [03:20<00:36,  1.54s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [03:36<02:16,  5.92s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [03:47<02:44,  7.49s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [03:58<02:56,  8.42s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [04:13<03:27, 10.37s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [04:14<02:25,  7.65s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [04:17<01:49,  6.06s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [04:19<01:25,  5.05s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [04:22<01:11,  4.46s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [04:24<00:53,  3.55s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [04:25<00:40,  2.90s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [04:27<00:31,  2.45s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [04:28<00:25,  2.16s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [04:29<00:20,  1.90s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [04:31<00:17,  1.74s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [04:32<00:14,  1.65s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [04:34<00:13,  1.64s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [04:35<00:11,  1.65s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [04:37<00:09,  1.60s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [04:39<00:08,  1.61s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [04:40<00:05,  1.46s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [04:42<00:05,  1.71s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [04:44<00:03,  1.97s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [04:46<00:01,  1.74s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [04:47<00:00,  1.61s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [04:47<00:00,  2.87s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.24763
wandb: 
wandb: üöÄ View run autumn-sweep-62 at: https://wandb.ai/xzy11632/dance-dev/runs/82pnf0bx
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_084654-82pnf0bx/logs
wandb: Agent Starting Run: ez2dyxl1 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_090526-ez2dyxl1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run kind-sweep-63
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ez2dyxl1
[INFO][2024-03-16 09:05:31,492][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 09:05:31,852][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 09:05:31,853][dance][wrapped_func] Took 0:00:00.360175 to load and process data.
[INFO][2024-03-16 09:05:31,853][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 09:05:31,856][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'Log1P',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 09:05:32,338][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.018 MB of 0.024 MB uploadedwandb: - 0.018 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run kind-sweep-63 at: https://wandb.ai/xzy11632/dance-dev/runs/ez2dyxl1
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_090526-ez2dyxl1/logs
wandb: ERROR Run ez2dyxl1 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1020) out of bounds (980)
wandb: ERROR 
wandb: Agent Starting Run: edbbuxub with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_090546-edbbuxub
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run young-sweep-64
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/edbbuxub
[INFO][2024-03-16 09:05:53,461][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 09:05:53,591][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 09:05:53,591][dance][wrapped_func] Took 0:00:00.129938 to load and process data.
[INFO][2024-03-16 09:05:53,591][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 09:05:53,593][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'Log1P',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 09:05:53,892][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run young-sweep-64 at: https://wandb.ai/xzy11632/dance-dev/runs/edbbuxub
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_090546-edbbuxub/logs
wandb: ERROR Run edbbuxub errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1020) out of bounds (980)
wandb: ERROR 
wandb: Agent Starting Run: yi7ehu4k with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_090608-yi7ehu4k
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run snowy-sweep-65
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/yi7ehu4k
[INFO][2024-03-16 09:06:14,343][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 09:06:14,461][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 09:06:14,462][dance][wrapped_func] Took 0:00:00.117354 to load and process data.
[INFO][2024-03-16 09:06:14,462][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 09:06:14,464][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'Log1P',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[INFO][2024-03-16 09:06:15,061][dance.WeightedFeaturePCA][__call__] Decomposing train features (7963, 200) (k=124)
[INFO][2024-03-16 09:06:15,062][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.15%
[INFO][2024-03-16 09:06:20,187][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 09:06:20,187][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 09:06:20,187][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 09:06:20,188][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:40,  1.02s/it]  2%|‚ñè         | 2/100 [00:02<01:38,  1.00s/it]  3%|‚ñé         | 3/100 [00:03<01:37,  1.00s/it]  4%|‚ñç         | 4/100 [00:11<06:17,  3.93s/it]  5%|‚ñå         | 5/100 [00:20<09:00,  5.69s/it]  6%|‚ñå         | 6/100 [00:24<08:09,  5.20s/it]  7%|‚ñã         | 7/100 [00:34<10:40,  6.89s/it]  8%|‚ñä         | 8/100 [00:46<12:41,  8.28s/it]  9%|‚ñâ         | 9/100 [00:51<11:21,  7.49s/it] 10%|‚ñà         | 10/100 [00:55<09:14,  6.16s/it] 11%|‚ñà         | 11/100 [00:58<08:04,  5.44s/it] 12%|‚ñà‚ñè        | 12/100 [01:02<07:07,  4.86s/it] 13%|‚ñà‚ñé        | 13/100 [01:05<06:23,  4.41s/it] 14%|‚ñà‚ñç        | 14/100 [01:09<05:54,  4.12s/it] 15%|‚ñà‚ñå        | 15/100 [01:12<05:27,  3.86s/it] 16%|‚ñà‚ñå        | 16/100 [01:15<04:59,  3.57s/it] 17%|‚ñà‚ñã        | 17/100 [01:18<04:45,  3.44s/it] 18%|‚ñà‚ñä        | 18/100 [01:23<05:09,  3.77s/it] 19%|‚ñà‚ñâ        | 19/100 [01:27<05:29,  4.07s/it] 20%|‚ñà‚ñà        | 20/100 [01:30<04:51,  3.64s/it] 21%|‚ñà‚ñà        | 21/100 [01:33<04:28,  3.40s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [01:36<04:09,  3.20s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [01:38<03:58,  3.10s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [01:41<03:48,  3.00s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [01:44<03:38,  2.91s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [01:47<03:32,  2.87s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [01:49<03:23,  2.79s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [01:52<03:14,  2.70s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [01:54<03:12,  2.71s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [01:57<03:09,  2.71s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [02:00<03:10,  2.76s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [02:03<03:05,  2.73s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [02:06<03:05,  2.77s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [02:09<03:17,  3.00s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [02:14<03:47,  3.50s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [02:17<03:31,  3.31s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [02:20<03:25,  3.26s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [02:23<03:20,  3.24s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [02:26<03:17,  3.24s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [02:29<03:07,  3.13s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [02:32<02:57,  3.01s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [02:35<02:54,  3.02s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [02:38<02:46,  2.92s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [02:40<02:38,  2.83s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [02:43<02:33,  2.79s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [02:46<02:28,  2.74s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [02:48<02:16,  2.57s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [02:50<02:08,  2.48s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [02:52<02:05,  2.46s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [02:55<02:02,  2.45s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [02:57<01:56,  2.38s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [03:00<02:07,  2.66s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [03:04<02:17,  2.93s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [03:06<02:07,  2.76s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [03:09<01:59,  2.65s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [03:11<01:56,  2.66s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [03:14<01:51,  2.60s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [03:16<01:47,  2.56s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [03:19<01:43,  2.53s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [03:21<01:39,  2.48s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [03:23<01:35,  2.45s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [03:26<01:32,  2.44s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [03:28<01:26,  2.35s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [03:30<01:23,  2.32s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [03:33<01:24,  2.40s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [03:35<01:23,  2.45s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [03:38<01:19,  2.40s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [03:40<01:13,  2.31s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [03:43<01:18,  2.52s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [03:46<01:17,  2.60s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [03:48<01:10,  2.44s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [03:50<01:06,  2.36s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [03:52<00:58,  2.16s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [03:53<00:52,  2.01s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [03:55<00:47,  1.89s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [03:56<00:42,  1.77s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [03:58<00:37,  1.64s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [03:59<00:33,  1.51s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [04:00<00:31,  1.48s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [04:01<00:26,  1.34s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [04:03<00:25,  1.32s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [04:04<00:27,  1.51s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [04:07<00:29,  1.74s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [04:08<00:25,  1.57s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [04:09<00:21,  1.43s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [04:10<00:19,  1.37s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [04:11<00:17,  1.33s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [04:13<00:15,  1.30s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [04:14<00:14,  1.29s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [04:15<00:12,  1.25s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [04:16<00:11,  1.26s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [04:18<00:10,  1.33s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [04:19<00:09,  1.30s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [04:21<00:08,  1.34s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [04:22<00:06,  1.28s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [04:24<00:05,  1.44s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [04:26<00:05,  1.83s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [04:27<00:03,  1.65s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [04:29<00:01,  1.48s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [04:30<00:00,  1.37s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [04:30<00:00,  2.70s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.30939
wandb: 
wandb: üöÄ View run snowy-sweep-65 at: https://wandb.ai/xzy11632/dance-dev/runs/yi7ehu4k
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_090608-yi7ehu4k/logs
wandb: Agent Starting Run: mrl8o7ms with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_091356-mrl8o7ms
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run true-sweep-66
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/mrl8o7ms
[INFO][2024-03-16 09:14:02,115][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 09:14:02,177][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 09:14:02,177][dance][wrapped_func] Took 0:00:00.060906 to load and process data.
[INFO][2024-03-16 09:14:02,177][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 09:14:02,179][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'Log1P',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[INFO][2024-03-16 09:14:04,512][dance.WeightedFeatureSVD][__call__] Decomposing train features (7963, 200) (k=120)
[INFO][2024-03-16 09:14:04,519][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.08%
[INFO][2024-03-16 09:14:06,532][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 09:14:06,533][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 09:14:06,533][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 09:14:06,533][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:51,  1.12s/it]  2%|‚ñè         | 2/100 [00:02<01:47,  1.10s/it]  3%|‚ñé         | 3/100 [00:03<01:53,  1.17s/it]  4%|‚ñç         | 4/100 [00:04<01:51,  1.16s/it]  5%|‚ñå         | 5/100 [00:06<02:11,  1.38s/it]  6%|‚ñå         | 6/100 [00:08<02:33,  1.63s/it]  7%|‚ñã         | 7/100 [00:10<02:27,  1.59s/it]  8%|‚ñä         | 8/100 [00:11<02:12,  1.44s/it]  9%|‚ñâ         | 9/100 [00:12<02:03,  1.36s/it] 10%|‚ñà         | 10/100 [00:13<01:56,  1.30s/it] 11%|‚ñà         | 11/100 [00:14<01:55,  1.30s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:47,  1.23s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:44,  1.21s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<01:42,  1.19s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<01:42,  1.21s/it] 16%|‚ñà‚ñå        | 16/100 [00:21<02:14,  1.60s/it] 17%|‚ñà‚ñã        | 17/100 [00:24<02:36,  1.88s/it] 18%|‚ñà‚ñä        | 18/100 [00:27<02:53,  2.12s/it] 19%|‚ñà‚ñâ        | 19/100 [00:28<02:42,  2.01s/it] 20%|‚ñà‚ñà        | 20/100 [00:30<02:20,  1.75s/it] 21%|‚ñà‚ñà        | 21/100 [00:31<02:01,  1.54s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:33<02:12,  1.69s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:35<02:22,  1.85s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:36<02:02,  1.61s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:37<01:50,  1.47s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:38<01:43,  1.40s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:39<01:33,  1.29s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:40<01:29,  1.25s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:42<01:25,  1.20s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:43<01:21,  1.16s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:44<01:19,  1.15s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:45<01:23,  1.22s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:46<01:23,  1.25s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:48<01:22,  1.25s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:49<01:20,  1.24s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:50<01:15,  1.18s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:52<01:29,  1.42s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:54<01:45,  1.71s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:55<01:33,  1.54s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:56<01:22,  1.38s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:58<01:25,  1.45s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:00<01:24,  1.46s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:01<01:17,  1.36s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:02<01:13,  1.31s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:03<01:08,  1.25s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:04<01:10,  1.30s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:06<01:20,  1.52s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:08<01:23,  1.60s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:10<01:24,  1.66s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:11<01:16,  1.53s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:13<01:11,  1.46s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:14<01:06,  1.39s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:15<01:02,  1.34s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:16<01:00,  1.32s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:18<01:09,  1.54s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:21<01:19,  1.80s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:22<01:08,  1.60s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:23<01:00,  1.44s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:24<00:57,  1.40s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:25<00:52,  1.31s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:26<00:49,  1.26s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:27<00:45,  1.20s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:29<00:45,  1.23s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:30<00:42,  1.18s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:31<00:44,  1.26s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:33<00:42,  1.24s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:34<00:41,  1.25s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:35<00:40,  1.26s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:36<00:37,  1.22s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:38<00:38,  1.29s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:39<00:40,  1.40s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:41<00:44,  1.59s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:42<00:38,  1.42s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:43<00:33,  1.29s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:45<00:33,  1.33s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:50<01:01,  2.57s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:00<01:48,  4.72s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:09<02:10,  5.92s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:10<01:37,  4.67s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:22<02:13,  6.67s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:29<02:11,  6.93s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:31<01:34,  5.25s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:33<01:15,  4.46s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:35<00:58,  3.66s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:36<00:43,  2.90s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:37<00:33,  2.38s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:38<00:25,  1.94s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:40<00:22,  1.83s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:42<00:21,  1.98s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:43<00:16,  1.67s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:44<00:13,  1.51s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:45<00:10,  1.37s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:46<00:08,  1.26s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:47<00:07,  1.17s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:48<00:05,  1.12s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:49<00:04,  1.14s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:52<00:04,  1.62s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:54<00:03,  1.73s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:56<00:01,  1.80s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:58<00:00,  1.79s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:58<00:00,  1.78s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.31822
wandb: 
wandb: üöÄ View run true-sweep-66 at: https://wandb.ai/xzy11632/dance-dev/runs/mrl8o7ms
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_091356-mrl8o7ms/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: htgwhuhi with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_091842-htgwhuhi
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run polished-sweep-67
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/htgwhuhi
[INFO][2024-03-16 09:18:48,006][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 09:18:48,096][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 09:18:48,096][dance][wrapped_func] Took 0:00:00.089709 to load and process data.
[INFO][2024-03-16 09:18:48,097][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 09:18:48,098][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
[INFO][2024-03-16 09:18:48,648][dance.WeightedFeaturePCA][__call__] Decomposing train features (7963, 156) (k=60)
[INFO][2024-03-16 09:18:48,648][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.05%
[INFO][2024-03-16 09:18:50,589][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 09:18:50,589][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 09:18:50,589][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 09:18:50,590][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:04,  1.26s/it]  2%|‚ñè         | 2/100 [00:02<01:59,  1.22s/it]  3%|‚ñé         | 3/100 [00:03<01:55,  1.19s/it]  4%|‚ñç         | 4/100 [00:04<01:52,  1.17s/it]  5%|‚ñå         | 5/100 [00:05<01:49,  1.16s/it]  6%|‚ñå         | 6/100 [00:06<01:46,  1.14s/it]  7%|‚ñã         | 7/100 [00:08<01:53,  1.22s/it]  8%|‚ñä         | 8/100 [00:10<02:05,  1.36s/it]  9%|‚ñâ         | 9/100 [00:12<02:21,  1.55s/it] 10%|‚ñà         | 10/100 [00:12<02:04,  1.38s/it] 11%|‚ñà         | 11/100 [00:14<02:07,  1.43s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:58,  1.35s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:50,  1.27s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:46,  1.23s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<01:41,  1.19s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<01:39,  1.18s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:36,  1.17s/it] 18%|‚ñà‚ñä        | 18/100 [00:22<01:36,  1.18s/it] 19%|‚ñà‚ñâ        | 19/100 [00:23<01:33,  1.16s/it] 20%|‚ñà‚ñà        | 20/100 [00:24<01:33,  1.17s/it] 21%|‚ñà‚ñà        | 21/100 [00:25<01:31,  1.16s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:27<01:29,  1.14s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:28<01:25,  1.11s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:29<01:23,  1.10s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:30<01:20,  1.07s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:31<01:16,  1.03s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:32<01:16,  1.05s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:33<01:29,  1.25s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:36<01:48,  1.53s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:37<01:39,  1.42s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:38<01:30,  1.32s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:39<01:36,  1.42s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:41<01:40,  1.50s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:43<01:40,  1.52s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:44<01:32,  1.43s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:45<01:29,  1.40s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:46<01:22,  1.31s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:47<01:17,  1.25s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:49<01:13,  1.20s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:50<01:12,  1.21s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:52<01:20,  1.36s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:53<01:16,  1.32s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:54<01:14,  1.31s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:55<01:10,  1.26s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:57<01:12,  1.32s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:58<01:13,  1.37s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:00<01:22,  1.55s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:01<01:14,  1.44s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:02<01:07,  1.33s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:03<01:01,  1.23s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:04<00:57,  1.17s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:05<00:55,  1.15s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:07<00:53,  1.15s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:08<00:51,  1.12s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:09<00:51,  1.15s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:10<00:50,  1.15s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:11<00:50,  1.17s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:12<00:48,  1.16s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:13<00:46,  1.14s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:15<00:49,  1.23s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:16<00:48,  1.23s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:18<00:53,  1.40s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:20<00:55,  1.50s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:21<00:51,  1.44s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:22<00:46,  1.34s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:23<00:44,  1.30s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:24<00:41,  1.25s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:26<00:40,  1.27s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:27<00:37,  1.21s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:28<00:36,  1.21s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:29<00:33,  1.14s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:30<00:33,  1.20s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:32<00:31,  1.18s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:33<00:30,  1.18s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:34<00:29,  1.19s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:35<00:27,  1.16s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:36<00:25,  1.13s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:37<00:26,  1.20s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:39<00:25,  1.20s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:40<00:27,  1.39s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:43<00:31,  1.66s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:44<00:27,  1.53s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:45<00:23,  1.41s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:46<00:20,  1.30s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:47<00:18,  1.20s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:48<00:16,  1.16s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:49<00:14,  1.10s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:50<00:12,  1.06s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:51<00:11,  1.06s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:52<00:10,  1.05s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:53<00:09,  1.06s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:54<00:08,  1.09s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:56<00:07,  1.11s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:57<00:06,  1.09s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:58<00:05,  1.08s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:59<00:04,  1.06s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:00<00:03,  1.07s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:02<00:02,  1.29s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:04<00:01,  1.55s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:05<00:00,  1.40s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:05<00:00,  1.25s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.3551
wandb: 
wandb: üöÄ View run polished-sweep-67 at: https://wandb.ai/xzy11632/dance-dev/runs/htgwhuhi
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_091842-htgwhuhi/logs
wandb: Agent Starting Run: 7mccm5g4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_092213-7mccm5g4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sandy-sweep-68
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/7mccm5g4
[INFO][2024-03-16 09:22:19,470][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 09:22:19,578][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 09:22:19,579][dance][wrapped_func] Took 0:00:00.108183 to load and process data.
[INFO][2024-03-16 09:22:19,579][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 09:22:19,581][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
[INFO][2024-03-16 09:22:26,337][dance.WeightedFeatureSVD][__call__] Decomposing train features (7963, 156) (k=74)
[INFO][2024-03-16 09:22:26,337][dance.WeightedFeatureSVD][__call__] Total explained variance: 92.24%
[INFO][2024-03-16 09:24:43,662][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 09:24:43,662][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 09:24:43,662][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 09:24:43,662][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:38,  1.60s/it]  2%|‚ñè         | 2/100 [00:03<03:04,  1.89s/it]  3%|‚ñé         | 3/100 [00:05<02:38,  1.64s/it]  4%|‚ñç         | 4/100 [00:06<02:18,  1.45s/it]  5%|‚ñå         | 5/100 [00:07<02:04,  1.32s/it]  6%|‚ñå         | 6/100 [00:08<02:02,  1.30s/it]  7%|‚ñã         | 7/100 [00:09<02:03,  1.32s/it]  8%|‚ñä         | 8/100 [00:10<01:54,  1.25s/it]  9%|‚ñâ         | 9/100 [00:12<01:51,  1.22s/it] 10%|‚ñà         | 10/100 [00:13<01:48,  1.21s/it] 11%|‚ñà         | 11/100 [00:14<01:50,  1.24s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:45,  1.19s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:42,  1.18s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<01:44,  1.22s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<01:40,  1.19s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<01:34,  1.13s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:31,  1.10s/it] 18%|‚ñà‚ñä        | 18/100 [00:22<01:41,  1.23s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<01:47,  1.33s/it] 20%|‚ñà‚ñà        | 20/100 [00:26<01:57,  1.46s/it] 21%|‚ñà‚ñà        | 21/100 [00:27<01:46,  1.35s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:28<01:40,  1.29s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:29<01:33,  1.21s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:30<01:32,  1.21s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:31<01:26,  1.15s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:32<01:20,  1.09s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:33<01:19,  1.08s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:34<01:17,  1.08s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:36<01:21,  1.15s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:37<01:21,  1.16s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:38<01:20,  1.16s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:39<01:19,  1.18s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:40<01:20,  1.20s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:42<01:18,  1.18s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:43<01:18,  1.21s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:45<01:33,  1.46s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:47<01:45,  1.68s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:48<01:31,  1.47s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:49<01:25,  1.40s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:50<01:18,  1.31s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:52<01:15,  1.27s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:53<01:10,  1.22s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:54<01:06,  1.17s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:55<01:04,  1.15s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:56<00:59,  1.09s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:57<00:57,  1.07s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:58<00:58,  1.10s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:59<00:55,  1.08s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:00<00:54,  1.06s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:01<00:52,  1.05s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:02<00:52,  1.07s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:03<00:53,  1.12s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:04<00:51,  1.09s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:06<00:58,  1.27s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:08<01:08,  1.53s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:09<01:01,  1.40s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:10<00:56,  1.31s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:12<00:52,  1.26s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:13<00:50,  1.24s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:14<00:48,  1.21s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:15<00:46,  1.20s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:16<00:42,  1.12s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:17<00:41,  1.12s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:18<00:39,  1.11s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:19<00:38,  1.11s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:20<00:37,  1.10s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:21<00:36,  1.09s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:22<00:33,  1.05s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:24<00:34,  1.11s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:25<00:37,  1.25s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:27<00:41,  1.43s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:29<00:41,  1.48s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:30<00:37,  1.37s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:31<00:33,  1.30s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:32<00:31,  1.26s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:33<00:29,  1.23s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:35<00:28,  1.25s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:36<00:26,  1.21s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:37<00:25,  1.20s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:38<00:23,  1.20s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:39<00:23,  1.26s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:41<00:23,  1.29s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:42<00:23,  1.40s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:44<00:23,  1.45s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:46<00:24,  1.64s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:48<00:25,  1.84s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:50<00:22,  1.75s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:52<00:20,  1.70s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:53<00:16,  1.53s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:54<00:13,  1.36s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:55<00:11,  1.24s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:56<00:09,  1.17s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:57<00:07,  1.11s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:58<00:06,  1.10s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:59<00:05,  1.12s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:00<00:04,  1.10s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:01<00:03,  1.08s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:02<00:02,  1.12s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:03<00:01,  1.15s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:04<00:00,  1.13s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:04<00:00,  1.25s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.29705
wandb: 
wandb: üöÄ View run sandy-sweep-68 at: https://wandb.ai/xzy11632/dance-dev/runs/7mccm5g4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_092213-7mccm5g4/logs
wandb: Agent Starting Run: au6i3l2a with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_092758-au6i3l2a
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glowing-sweep-69
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/au6i3l2a
[INFO][2024-03-16 09:28:03,548][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 09:28:03,633][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 09:28:03,642][dance][wrapped_func] Took 0:00:00.093250 to load and process data.
[INFO][2024-03-16 09:28:03,642][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 09:28:03,644][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[INFO][2024-03-16 09:28:04,254][dance.WeightedFeaturePCA][__call__] Decomposing train features (7963, 200) (k=55)
[INFO][2024-03-16 09:28:04,255][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.09%
[INFO][2024-03-16 09:28:06,674][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 09:28:06,675][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 09:28:06,675][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 09:28:06,675][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:18,  1.40s/it]  2%|‚ñè         | 2/100 [00:02<02:11,  1.34s/it]  3%|‚ñé         | 3/100 [00:03<01:56,  1.20s/it]  4%|‚ñç         | 4/100 [00:04<01:53,  1.18s/it]  5%|‚ñå         | 5/100 [00:06<01:49,  1.16s/it]  6%|‚ñå         | 6/100 [00:07<01:47,  1.14s/it]  7%|‚ñã         | 7/100 [00:08<02:07,  1.37s/it]  8%|‚ñä         | 8/100 [00:11<02:30,  1.64s/it]  9%|‚ñâ         | 9/100 [00:12<02:14,  1.48s/it] 10%|‚ñà         | 10/100 [00:13<02:03,  1.37s/it] 11%|‚ñà         | 11/100 [00:14<01:57,  1.32s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:49,  1.25s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:43,  1.19s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:41,  1.18s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:35,  1.12s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:32,  1.11s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:34,  1.14s/it] 18%|‚ñà‚ñä        | 18/100 [00:22<01:35,  1.16s/it] 19%|‚ñà‚ñâ        | 19/100 [00:23<01:36,  1.19s/it] 20%|‚ñà‚ñà        | 20/100 [00:24<01:35,  1.19s/it] 21%|‚ñà‚ñà        | 21/100 [00:26<01:35,  1.21s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:27<01:32,  1.19s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:29<01:53,  1.47s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:31<02:13,  1.76s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:32<01:58,  1.58s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:34<01:46,  1.44s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:35<01:41,  1.39s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:36<01:34,  1.32s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:37<01:30,  1.27s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:38<01:26,  1.23s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:40<01:32,  1.34s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:41<01:31,  1.34s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:43<01:28,  1.33s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:44<01:27,  1.32s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:45<01:22,  1.26s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:46<01:21,  1.28s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:48<01:21,  1.29s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:49<01:19,  1.28s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:51<01:26,  1.42s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:53<01:37,  1.62s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:54<01:26,  1.47s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:55<01:18,  1.36s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:56<01:12,  1.28s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:57<01:11,  1.28s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:59<01:09,  1.26s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:00<01:07,  1.25s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:01<01:03,  1.20s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:02<01:00,  1.17s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:03<00:59,  1.17s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:04<00:58,  1.18s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:05<00:57,  1.18s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:07<00:56,  1.17s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:08<00:54,  1.17s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:09<00:51,  1.12s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:10<00:55,  1.24s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:12<01:06,  1.51s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:14<01:01,  1.43s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:15<00:55,  1.32s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:16<00:50,  1.22s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:17<00:48,  1.22s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:18<00:46,  1.20s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:19<00:44,  1.16s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:20<00:41,  1.11s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:21<00:39,  1.10s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:22<00:38,  1.11s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:24<00:38,  1.13s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:25<00:37,  1.13s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:26<00:38,  1.21s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:27<00:37,  1.22s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:29<00:37,  1.24s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:30<00:41,  1.42s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:33<00:45,  1.63s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:34<00:38,  1.44s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:35<00:34,  1.35s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:36<00:31,  1.27s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:37<00:28,  1.18s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:38<00:26,  1.14s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:39<00:24,  1.13s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:40<00:23,  1.11s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:41<00:21,  1.10s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:42<00:21,  1.14s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:43<00:19,  1.10s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:45<00:19,  1.13s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:46<00:18,  1.14s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:47<00:17,  1.20s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:48<00:16,  1.18s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:50<00:16,  1.29s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:51<00:16,  1.35s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:53<00:17,  1.59s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:54<00:14,  1.43s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:56<00:12,  1.34s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:57<00:11,  1.42s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:58<00:09,  1.37s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:59<00:07,  1.30s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:01<00:06,  1.24s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:02<00:04,  1.16s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:03<00:03,  1.14s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:04<00:02,  1.12s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:05<00:01,  1.12s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:06<00:00,  1.18s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:06<00:00,  1.27s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.21891
wandb: 
wandb: üöÄ View run glowing-sweep-69 at: https://wandb.ai/xzy11632/dance-dev/runs/au6i3l2a
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_092758-au6i3l2a/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: m7yy4xwn with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_093126-m7yy4xwn
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run cool-sweep-70
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/m7yy4xwn
[INFO][2024-03-16 09:31:32,066][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 09:31:32,156][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 09:31:32,156][dance][wrapped_func] Took 0:00:00.089277 to load and process data.
[INFO][2024-03-16 09:31:32,156][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 09:31:32,158][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[INFO][2024-03-16 09:31:34,236][dance.WeightedFeatureSVD][__call__] Decomposing train features (7963, 200) (k=100)
[INFO][2024-03-16 09:31:34,242][dance.WeightedFeatureSVD][__call__] Total explained variance: 94.65%
[INFO][2024-03-16 09:31:36,144][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 09:31:36,144][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 09:31:36,145][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 09:31:36,145][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:47,  1.08s/it]  2%|‚ñè         | 2/100 [00:02<01:47,  1.10s/it]  3%|‚ñé         | 3/100 [00:03<01:57,  1.21s/it]  4%|‚ñç         | 4/100 [00:04<01:57,  1.23s/it]  5%|‚ñå         | 5/100 [00:05<01:53,  1.19s/it]  6%|‚ñå         | 6/100 [00:07<01:51,  1.18s/it]  7%|‚ñã         | 7/100 [00:08<01:47,  1.16s/it]  8%|‚ñä         | 8/100 [00:09<01:41,  1.10s/it]  9%|‚ñâ         | 9/100 [00:10<01:50,  1.21s/it] 10%|‚ñà         | 10/100 [00:11<01:47,  1.20s/it] 11%|‚ñà         | 11/100 [00:14<02:15,  1.52s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<02:02,  1.39s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<02:10,  1.50s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<02:15,  1.57s/it] 15%|‚ñà‚ñå        | 15/100 [00:20<02:12,  1.55s/it] 16%|‚ñà‚ñå        | 16/100 [00:22<02:30,  1.79s/it] 17%|‚ñà‚ñã        | 17/100 [00:25<02:47,  2.02s/it] 18%|‚ñà‚ñä        | 18/100 [00:27<02:58,  2.17s/it] 19%|‚ñà‚ñâ        | 19/100 [00:30<03:03,  2.26s/it] 20%|‚ñà‚ñà        | 20/100 [00:32<03:07,  2.34s/it] 21%|‚ñà‚ñà        | 21/100 [00:35<03:11,  2.42s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:36<02:52,  2.21s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:38<02:47,  2.17s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:40<02:38,  2.09s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:42<02:27,  1.96s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:45<02:44,  2.23s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:48<02:52,  2.36s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:49<02:22,  1.98s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:50<02:04,  1.75s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:51<01:51,  1.60s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:52<01:44,  1.51s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:54<01:36,  1.42s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:55<01:33,  1.40s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:56<01:27,  1.32s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:57<01:25,  1.32s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:59<01:25,  1.33s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:00<01:28,  1.41s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:02<01:28,  1.43s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:03<01:25,  1.40s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:05<01:23,  1.39s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:06<01:18,  1.34s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:08<01:32,  1.59s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:10<01:47,  1.88s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:12<01:34,  1.68s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:13<01:23,  1.52s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:14<01:16,  1.42s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:15<01:11,  1.35s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:16<01:08,  1.32s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:18<01:06,  1.29s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:19<01:02,  1.25s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:20<01:00,  1.23s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:21<00:58,  1.21s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:22<00:57,  1.23s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:24<00:56,  1.24s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:25<00:55,  1.22s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:27<01:05,  1.48s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:30<01:18,  1.82s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:31<01:09,  1.66s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:32<01:01,  1.51s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:33<00:55,  1.40s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:34<00:52,  1.34s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:36<00:48,  1.27s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:38<00:59,  1.60s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:40<01:00,  1.69s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:42<01:02,  1.78s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:44<01:00,  1.78s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:45<00:58,  1.76s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:47<00:52,  1.64s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:49<00:55,  1.80s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:51<00:53,  1.78s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:52<00:45,  1.58s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:54<00:50,  1.82s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:56<00:52,  1.96s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:57<00:44,  1.73s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:59<00:40,  1.62s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:00<00:35,  1.49s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:01<00:32,  1.42s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:03<00:30,  1.40s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:04<00:28,  1.34s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:05<00:25,  1.28s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:06<00:25,  1.32s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:08<00:24,  1.35s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:09<00:23,  1.36s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:11<00:21,  1.37s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:12<00:20,  1.38s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:13<00:19,  1.38s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:16<00:22,  1.70s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:18<00:22,  1.91s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:19<00:18,  1.71s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:21<00:16,  1.61s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:22<00:13,  1.50s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:23<00:11,  1.45s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:25<00:09,  1.35s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:26<00:07,  1.32s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:27<00:06,  1.29s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:28<00:05,  1.31s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:30<00:04,  1.35s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:31<00:02,  1.34s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:32<00:01,  1.31s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:34<00:00,  1.32s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:34<00:00,  1.54s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.21848
wandb: 
wandb: üöÄ View run cool-sweep-70 at: https://wandb.ai/xzy11632/dance-dev/runs/m7yy4xwn
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_093126-m7yy4xwn/logs
wandb: Agent Starting Run: hi5v0rqw with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_093512-hi5v0rqw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run polished-sweep-71
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/hi5v0rqw
[INFO][2024-03-16 09:35:18,872][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 09:35:19,296][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 09:35:19,297][dance][wrapped_func] Took 0:00:00.423697 to load and process data.
[INFO][2024-03-16 09:35:19,297][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 09:35:19,299][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 09:35:20,131][dance.WeightedFeaturePCA][__call__] Decomposing train features (7963, 200) (k=32)
[INFO][2024-03-16 09:35:20,131][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.05%
[INFO][2024-03-16 09:35:21,979][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 09:35:21,980][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 09:35:21,980][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 09:35:21,980][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:55,  1.17s/it]  2%|‚ñè         | 2/100 [00:02<01:49,  1.12s/it]  3%|‚ñé         | 3/100 [00:03<02:01,  1.26s/it]  4%|‚ñç         | 4/100 [00:05<02:22,  1.49s/it]  5%|‚ñå         | 5/100 [00:06<02:02,  1.29s/it]  6%|‚ñå         | 6/100 [00:07<01:53,  1.21s/it]  7%|‚ñã         | 7/100 [00:08<01:46,  1.14s/it]  8%|‚ñä         | 8/100 [00:09<01:43,  1.12s/it]  9%|‚ñâ         | 9/100 [00:10<01:37,  1.08s/it] 10%|‚ñà         | 10/100 [00:11<01:35,  1.06s/it] 11%|‚ñà         | 11/100 [00:12<01:33,  1.05s/it] 12%|‚ñà‚ñè        | 12/100 [00:13<01:30,  1.03s/it] 13%|‚ñà‚ñé        | 13/100 [00:14<01:29,  1.03s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:47,  1.25s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<02:01,  1.43s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:51,  1.32s/it] 17%|‚ñà‚ñã        | 17/100 [00:20<01:43,  1.25s/it] 18%|‚ñà‚ñä        | 18/100 [00:21<01:39,  1.22s/it] 19%|‚ñà‚ñâ        | 19/100 [00:22<01:37,  1.20s/it] 20%|‚ñà‚ñà        | 20/100 [00:23<01:35,  1.20s/it] 21%|‚ñà‚ñà        | 21/100 [00:25<01:34,  1.20s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:26<01:29,  1.15s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:27<01:26,  1.12s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:28<01:31,  1.20s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:30<01:48,  1.45s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:32<01:52,  1.52s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:33<01:54,  1.56s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:35<01:54,  1.60s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:37<01:51,  1.57s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:38<01:42,  1.47s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:39<01:38,  1.43s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:41<01:35,  1.40s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:42<01:32,  1.38s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:43<01:30,  1.37s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:44<01:24,  1.31s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:45<01:19,  1.25s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:47<01:15,  1.20s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:48<01:10,  1.13s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:49<01:14,  1.21s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:50<01:11,  1.20s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:52<01:21,  1.38s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:53<01:16,  1.32s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:54<01:09,  1.22s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:55<01:04,  1.16s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:56<01:01,  1.11s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:57<00:59,  1.11s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:58<00:57,  1.08s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:59<00:55,  1.07s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:00<00:53,  1.05s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:01<00:52,  1.06s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:02<00:51,  1.05s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:03<00:51,  1.06s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:05<00:57,  1.21s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:07<01:01,  1.34s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:08<01:04,  1.43s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:10<01:03,  1.44s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:11<00:58,  1.36s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:12<00:54,  1.30s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:13<00:49,  1.21s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:14<00:47,  1.19s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:15<00:44,  1.14s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:16<00:41,  1.08s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:18<00:46,  1.26s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:19<00:45,  1.25s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:21<00:49,  1.41s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:22<00:43,  1.27s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:23<00:39,  1.21s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:24<00:38,  1.20s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:25<00:36,  1.17s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:26<00:34,  1.16s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:27<00:32,  1.12s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:28<00:31,  1.12s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:30<00:29,  1.11s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:31<00:28,  1.09s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:32<00:27,  1.08s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:33<00:26,  1.10s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:34<00:24,  1.06s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:35<00:23,  1.06s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:36<00:22,  1.06s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:37<00:21,  1.06s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:39<00:24,  1.27s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:41<00:27,  1.51s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:42<00:23,  1.35s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:43<00:20,  1.25s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:44<00:18,  1.22s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:45<00:16,  1.17s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:46<00:14,  1.11s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:47<00:13,  1.10s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:48<00:11,  1.06s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:49<00:10,  1.08s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:50<00:09,  1.10s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:51<00:09,  1.13s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:52<00:07,  1.09s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:54<00:06,  1.10s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:55<00:05,  1.10s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:56<00:04,  1.11s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:57<00:03,  1.11s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:58<00:02,  1.10s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:59<00:01,  1.10s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:00<00:00,  1.09s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:00<00:00,  1.21s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.018 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.22495
wandb: 
wandb: üöÄ View run polished-sweep-71 at: https://wandb.ai/xzy11632/dance-dev/runs/hi5v0rqw
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_093512-hi5v0rqw/logs
wandb: Agent Starting Run: e27k95uz with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_093828-e27k95uz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run young-sweep-72
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/e27k95uz
[INFO][2024-03-16 09:38:33,996][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 09:38:34,122][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 09:38:34,123][dance][wrapped_func] Took 0:00:00.126084 to load and process data.
[INFO][2024-03-16 09:38:34,123][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 09:38:34,127][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 09:38:41,283][dance.WeightedFeatureSVD][__call__] Decomposing train features (7963, 200) (k=99)
[INFO][2024-03-16 09:38:41,284][dance.WeightedFeatureSVD][__call__] Total explained variance: 95.77%
[INFO][2024-03-16 09:42:44,238][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 09:42:44,239][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 09:42:44,239][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 09:42:44,240][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:33,  1.06it/s]  2%|‚ñè         | 2/100 [00:02<01:45,  1.08s/it]  3%|‚ñé         | 3/100 [00:03<01:51,  1.15s/it]  4%|‚ñç         | 4/100 [00:04<01:45,  1.10s/it]  5%|‚ñå         | 5/100 [00:05<01:41,  1.07s/it]  6%|‚ñå         | 6/100 [00:06<01:38,  1.05s/it]  7%|‚ñã         | 7/100 [00:07<01:37,  1.04s/it]  8%|‚ñä         | 8/100 [00:08<01:36,  1.05s/it]  9%|‚ñâ         | 9/100 [00:09<01:36,  1.06s/it] 10%|‚ñà         | 10/100 [00:10<01:37,  1.08s/it] 11%|‚ñà         | 11/100 [00:11<01:34,  1.06s/it] 12%|‚ñà‚ñè        | 12/100 [00:12<01:31,  1.04s/it] 13%|‚ñà‚ñé        | 13/100 [00:13<01:28,  1.02s/it] 14%|‚ñà‚ñç        | 14/100 [00:15<01:44,  1.22s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<02:03,  1.45s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<01:53,  1.35s/it] 17%|‚ñà‚ñã        | 17/100 [00:19<01:47,  1.29s/it] 18%|‚ñà‚ñä        | 18/100 [00:20<01:41,  1.24s/it] 19%|‚ñà‚ñâ        | 19/100 [00:21<01:34,  1.17s/it] 20%|‚ñà‚ñà        | 20/100 [00:22<01:31,  1.15s/it] 21%|‚ñà‚ñà        | 21/100 [00:23<01:29,  1.14s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:25<01:26,  1.11s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:26<01:24,  1.10s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:27<01:25,  1.12s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:28<01:21,  1.08s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:29<01:19,  1.08s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:30<01:18,  1.07s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:31<01:15,  1.05s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:32<01:17,  1.08s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:34<01:27,  1.24s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:36<01:41,  1.48s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:37<01:31,  1.34s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:38<01:25,  1.27s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:39<01:19,  1.20s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:40<01:16,  1.18s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:41<01:13,  1.15s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:42<01:12,  1.15s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:43<01:07,  1.09s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:44<01:06,  1.09s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:45<01:05,  1.09s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:46<01:02,  1.06s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:47<01:00,  1.05s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:48<01:00,  1.05s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:50<01:00,  1.07s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:51<00:59,  1.07s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:52<00:56,  1.05s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:53<01:04,  1.22s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:55<01:14,  1.43s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:56<01:08,  1.34s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:57<01:03,  1.28s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:59<01:00,  1.23s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:00<00:56,  1.19s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:01<00:54,  1.16s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:02<00:51,  1.13s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:03<00:50,  1.12s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:04<00:50,  1.15s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:05<00:49,  1.16s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:07<00:49,  1.19s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:08<00:48,  1.18s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:09<00:47,  1.19s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:10<00:47,  1.21s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:11<00:45,  1.20s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:13<00:50,  1.36s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:15<00:58,  1.61s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:17<00:53,  1.52s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:18<00:47,  1.40s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:19<00:42,  1.30s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:20<00:39,  1.25s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:21<00:37,  1.21s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:22<00:36,  1.21s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:23<00:33,  1.16s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:24<00:31,  1.12s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:25<00:30,  1.13s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:27<00:29,  1.12s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:28<00:27,  1.12s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:29<00:27,  1.13s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:30<00:25,  1.11s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:31<00:24,  1.10s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:32<00:23,  1.11s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:33<00:22,  1.10s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:35<00:24,  1.31s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:37<00:28,  1.56s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:38<00:23,  1.41s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:39<00:20,  1.29s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:40<00:18,  1.24s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:42<00:17,  1.24s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:43<00:15,  1.21s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:44<00:13,  1.16s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:45<00:12,  1.12s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:46<00:10,  1.09s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:47<00:10,  1.12s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:48<00:08,  1.11s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:49<00:07,  1.09s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:50<00:06,  1.07s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:51<00:05,  1.11s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:52<00:04,  1.12s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:53<00:03,  1.06s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:55<00:02,  1.25s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:57<00:01,  1.54s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:58<00:00,  1.38s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:58<00:00,  1.19s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.018 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.22188
wandb: 
wandb: üöÄ View run young-sweep-72 at: https://wandb.ai/xzy11632/dance-dev/runs/e27k95uz
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_093828-e27k95uz/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: g5ddio4o with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_094557-g5ddio4o
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run electric-sweep-73
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/g5ddio4o
[INFO][2024-03-16 09:46:02,315][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 09:46:02,414][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 09:46:02,414][dance][wrapped_func] Took 0:00:00.098865 to load and process data.
[INFO][2024-03-16 09:46:02,414][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 09:46:02,416][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 09:46:02,432][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 09:46:02,432][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 09:46:02,534][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 09:46:02,534][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 09:46:08,596][dance.WeightedFeaturePCA][__call__] Decomposing train features (7963, 980) (k=4)
[INFO][2024-03-16 09:46:08,597][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.22%
[INFO][2024-03-16 09:46:11,701][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 09:46:11,702][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 09:46:11,702][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 09:46:11,703][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:00,  1.22s/it]  2%|‚ñè         | 2/100 [00:02<02:02,  1.25s/it]  3%|‚ñé         | 3/100 [00:03<02:04,  1.29s/it]  4%|‚ñç         | 4/100 [00:04<01:58,  1.23s/it]  5%|‚ñå         | 5/100 [00:06<01:55,  1.21s/it]  6%|‚ñå         | 6/100 [00:07<01:50,  1.18s/it]  7%|‚ñã         | 7/100 [00:08<01:53,  1.22s/it]  8%|‚ñä         | 8/100 [00:09<01:53,  1.23s/it]  9%|‚ñâ         | 9/100 [00:11<02:01,  1.34s/it] 10%|‚ñà         | 10/100 [00:12<01:54,  1.27s/it] 11%|‚ñà         | 11/100 [00:13<01:47,  1.21s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<02:04,  1.41s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<02:28,  1.71s/it] 14%|‚ñà‚ñç        | 14/100 [00:19<02:15,  1.58s/it] 15%|‚ñà‚ñå        | 15/100 [00:20<02:01,  1.43s/it] 16%|‚ñà‚ñå        | 16/100 [00:21<01:53,  1.35s/it] 17%|‚ñà‚ñã        | 17/100 [00:23<02:03,  1.48s/it] 18%|‚ñà‚ñä        | 18/100 [00:24<02:05,  1.53s/it] 19%|‚ñà‚ñâ        | 19/100 [00:26<01:59,  1.48s/it] 20%|‚ñà‚ñà        | 20/100 [00:27<02:00,  1.51s/it] 21%|‚ñà‚ñà        | 21/100 [00:29<02:13,  1.69s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:31<02:07,  1.63s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:32<02:02,  1.58s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:34<02:02,  1.61s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:35<01:52,  1.50s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:37<02:00,  1.63s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:40<02:24,  1.98s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:41<02:12,  1.84s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:43<02:02,  1.72s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:44<01:51,  1.59s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:46<01:46,  1.54s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:47<01:40,  1.47s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:48<01:38,  1.46s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:50<01:36,  1.47s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:51<01:36,  1.49s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:53<01:34,  1.48s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:54<01:33,  1.48s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:56<01:36,  1.56s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:58<01:33,  1.53s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:00<01:43,  1.72s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:02<01:56,  1.98s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:04<01:42,  1.77s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:05<01:31,  1.61s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:06<01:28,  1.57s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:08<01:22,  1.50s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:09<01:20,  1.50s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:11<01:18,  1.47s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:12<01:18,  1.50s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:14<01:17,  1.52s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:15<01:15,  1.52s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:18<01:34,  1.93s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:20<01:39,  2.07s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:22<01:35,  2.03s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:24<01:30,  1.97s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:27<01:34,  2.09s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:30<01:46,  2.43s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:31<01:32,  2.16s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:33<01:20,  1.91s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:34<01:11,  1.74s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:36<01:08,  1.71s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:37<01:02,  1.61s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:38<00:57,  1.51s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:40<00:55,  1.50s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:42<01:01,  1.71s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:45<01:15,  2.15s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:48<01:19,  2.33s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:50<01:17,  2.35s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:53<01:14,  2.32s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:55<01:11,  2.32s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:58<01:12,  2.43s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:03<01:40,  3.47s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:08<01:42,  3.66s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:12<01:45,  3.91s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:16<01:43,  3.99s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:20<01:41,  4.05s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:25<01:37,  4.07s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:29<01:34,  4.09s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:33<01:33,  4.25s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:38<01:29,  4.28s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:42<01:23,  4.19s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:46<01:19,  4.16s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:52<01:23,  4.67s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:56<01:15,  4.44s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [03:00<01:09,  4.37s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [03:04<01:03,  4.23s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [03:08<00:58,  4.18s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [03:11<00:52,  4.06s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [03:15<00:45,  3.78s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [03:18<00:38,  3.54s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [03:21<00:34,  3.42s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [03:24<00:29,  3.26s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [03:27<00:25,  3.21s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [03:31<00:24,  3.50s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [03:34<00:20,  3.36s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [03:37<00:16,  3.22s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [03:40<00:12,  3.13s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [03:42<00:08,  2.93s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [03:44<00:05,  2.65s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [03:46<00:02,  2.46s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:48<00:00,  2.30s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:48<00:00,  2.29s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.021 MB of 0.025 MB uploadedwandb: | 0.021 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.16038
wandb: 
wandb: üöÄ View run electric-sweep-73 at: https://wandb.ai/xzy11632/dance-dev/runs/g5ddio4o
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_094557-g5ddio4o/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: v1iemu02 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_095127-v1iemu02
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run balmy-sweep-74
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/v1iemu02
[INFO][2024-03-16 09:51:33,192][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 09:51:33,281][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 09:51:33,281][dance][wrapped_func] Took 0:00:00.088750 to load and process data.
[INFO][2024-03-16 09:51:33,281][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 09:51:33,284][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 09:51:33,302][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 09:51:33,302][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 09:51:33,430][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 09:51:33,431][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 09:54:29,073][dance.WeightedFeatureSVD][__call__] Decomposing train features (7963, 980) (k=38)
[INFO][2024-03-16 09:54:29,075][dance.WeightedFeatureSVD][__call__] Total explained variance: 95.90%
[INFO][2024-03-16 09:56:42,449][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 09:56:42,450][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 09:56:42,450][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 09:56:42,450][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:02<03:57,  2.39s/it]  2%|‚ñè         | 2/100 [00:04<03:39,  2.24s/it]  3%|‚ñé         | 3/100 [00:06<03:31,  2.18s/it]  4%|‚ñç         | 4/100 [00:08<03:21,  2.10s/it]  5%|‚ñå         | 5/100 [00:11<03:30,  2.22s/it]  6%|‚ñå         | 6/100 [00:13<03:29,  2.23s/it]  7%|‚ñã         | 7/100 [00:15<03:28,  2.24s/it]  8%|‚ñä         | 8/100 [00:17<03:20,  2.17s/it]  9%|‚ñâ         | 9/100 [00:22<04:22,  2.88s/it] 10%|‚ñà         | 10/100 [00:23<03:51,  2.57s/it] 11%|‚ñà         | 11/100 [00:25<03:30,  2.37s/it] 12%|‚ñà‚ñè        | 12/100 [00:28<03:28,  2.37s/it] 13%|‚ñà‚ñé        | 13/100 [00:30<03:13,  2.22s/it] 14%|‚ñà‚ñç        | 14/100 [00:32<03:11,  2.23s/it] 15%|‚ñà‚ñå        | 15/100 [00:34<03:09,  2.23s/it] 16%|‚ñà‚ñå        | 16/100 [00:36<03:05,  2.21s/it] 17%|‚ñà‚ñã        | 17/100 [00:39<03:05,  2.24s/it] 18%|‚ñà‚ñä        | 18/100 [00:41<03:02,  2.22s/it] 19%|‚ñà‚ñâ        | 19/100 [00:42<02:48,  2.08s/it] 20%|‚ñà‚ñà        | 20/100 [00:47<03:46,  2.83s/it] 21%|‚ñà‚ñà        | 21/100 [00:49<03:20,  2.54s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:51<03:02,  2.33s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:53<02:52,  2.24s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:55<02:47,  2.20s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:57<02:42,  2.17s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:59<02:32,  2.06s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [01:01<02:30,  2.06s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [01:03<02:23,  1.99s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [01:05<02:23,  2.02s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [01:07<02:25,  2.08s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [01:09<02:14,  1.96s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:11<02:31,  2.22s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:15<02:56,  2.63s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:18<03:03,  2.78s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:22<03:18,  3.05s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:25<03:17,  3.09s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:28<03:17,  3.14s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:31<03:12,  3.11s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:34<03:10,  3.12s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:37<03:04,  3.07s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:40<02:59,  3.04s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:44<02:58,  3.07s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:45<02:35,  2.72s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:47<02:15,  2.42s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:51<02:43,  2.97s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:53<02:18,  2.57s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:55<02:06,  2.39s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:57<01:52,  2.17s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:58<01:44,  2.04s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [02:02<02:03,  2.47s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [02:06<02:28,  3.03s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [02:10<02:40,  3.34s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [02:15<02:51,  3.64s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [02:19<02:59,  3.89s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [02:23<02:58,  3.97s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [02:26<02:41,  3.67s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [02:29<02:29,  3.48s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [02:32<02:21,  3.37s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [02:36<02:21,  3.45s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [02:40<02:29,  3.73s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [02:43<02:15,  3.47s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [02:46<02:05,  3.31s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [02:48<01:48,  2.92s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [02:51<01:38,  2.73s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [02:53<01:30,  2.58s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [02:55<01:27,  2.58s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [02:58<01:22,  2.50s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [02:59<01:12,  2.28s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [03:01<01:04,  2.09s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [03:05<01:20,  2.69s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [03:07<01:06,  2.31s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [03:08<00:55,  1.98s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [03:09<00:48,  1.78s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [03:10<00:42,  1.65s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [03:12<00:39,  1.56s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [03:13<00:34,  1.45s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [03:14<00:32,  1.40s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [03:16<00:30,  1.40s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [03:17<00:28,  1.37s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [03:18<00:28,  1.42s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [03:21<00:32,  1.73s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [03:22<00:29,  1.63s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [03:24<00:25,  1.50s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [03:27<00:31,  1.97s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [03:29<00:30,  2.04s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [03:30<00:26,  1.87s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [03:32<00:22,  1.74s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [03:33<00:19,  1.60s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [03:34<00:17,  1.56s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [03:36<00:15,  1.51s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [03:37<00:12,  1.43s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [03:39<00:11,  1.44s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [03:40<00:10,  1.52s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [03:42<00:09,  1.55s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [03:43<00:07,  1.51s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [03:45<00:05,  1.44s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [03:47<00:05,  1.84s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [03:50<00:04,  2.00s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [03:51<00:01,  1.84s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:53<00:00,  1.72s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:53<00:00,  2.33s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.31022
wandb: 
wandb: üöÄ View run balmy-sweep-74 at: https://wandb.ai/xzy11632/dance-dev/runs/v1iemu02
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_095127-v1iemu02/logs
wandb: Agent Starting Run: 7pxjjusm with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_100150-7pxjjusm
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run smooth-sweep-75
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/7pxjjusm
[INFO][2024-03-16 10:01:56,403][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 10:01:56,541][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 10:01:56,541][dance][wrapped_func] Took 0:00:00.137776 to load and process data.
[INFO][2024-03-16 10:01:56,541][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 10:01:56,545][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 10:01:56,572][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 10:01:56,784][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 10:01:57,158][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run smooth-sweep-75 at: https://wandb.ai/xzy11632/dance-dev/runs/7pxjjusm
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_100150-7pxjjusm/logs
wandb: ERROR Run 7pxjjusm errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1020) out of bounds (980)
wandb: ERROR 
wandb: Agent Starting Run: emsw54mv with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_100211-emsw54mv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run hardy-sweep-76
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/emsw54mv
[INFO][2024-03-16 10:02:18,233][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 10:02:18,336][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 10:02:18,336][dance][wrapped_func] Took 0:00:00.097308 to load and process data.
[INFO][2024-03-16 10:02:18,336][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 10:02:18,338][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 10:02:18,358][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 10:02:18,475][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 10:02:18,664][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run hardy-sweep-76 at: https://wandb.ai/xzy11632/dance-dev/runs/emsw54mv
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_100211-emsw54mv/logs
wandb: ERROR Run emsw54mv errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1020) out of bounds (980)
wandb: ERROR 
wandb: Agent Starting Run: 8nuhxhuq with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_100232-8nuhxhuq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run hearty-sweep-77
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/8nuhxhuq
[INFO][2024-03-16 10:02:39,018][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 10:02:39,107][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 10:02:39,107][dance][wrapped_func] Took 0:00:00.088107 to load and process data.
[INFO][2024-03-16 10:02:39,107][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 10:02:39,109][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 10:02:39,133][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 10:02:39,245][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 10:02:39,667][dance.WeightedFeaturePCA][__call__] Decomposing train features (7963, 200) (k=5)
[INFO][2024-03-16 10:02:39,668][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.16%
[INFO][2024-03-16 10:02:42,081][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 10:02:42,081][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 10:02:42,081][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 10:02:42,082][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:49,  1.10s/it]  2%|‚ñè         | 2/100 [00:02<01:52,  1.14s/it]  3%|‚ñé         | 3/100 [00:03<01:52,  1.15s/it]  4%|‚ñç         | 4/100 [00:04<01:51,  1.16s/it]  5%|‚ñå         | 5/100 [00:05<01:51,  1.18s/it]  6%|‚ñå         | 6/100 [00:07<01:51,  1.19s/it]  7%|‚ñã         | 7/100 [00:08<01:55,  1.24s/it]  8%|‚ñä         | 8/100 [00:09<01:49,  1.20s/it]  9%|‚ñâ         | 9/100 [00:11<02:12,  1.45s/it] 10%|‚ñà         | 10/100 [00:13<02:33,  1.71s/it] 11%|‚ñà         | 11/100 [00:15<02:19,  1.57s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<02:06,  1.43s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<02:04,  1.43s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<01:53,  1.32s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<01:50,  1.30s/it] 16%|‚ñà‚ñå        | 16/100 [00:21<01:49,  1.31s/it] 17%|‚ñà‚ñã        | 17/100 [00:22<01:45,  1.27s/it] 18%|‚ñà‚ñä        | 18/100 [00:23<01:43,  1.27s/it] 19%|‚ñà‚ñâ        | 19/100 [00:25<01:45,  1.30s/it] 20%|‚ñà‚ñà        | 20/100 [00:26<01:42,  1.28s/it] 21%|‚ñà‚ñà        | 21/100 [00:27<01:40,  1.27s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:28<01:37,  1.25s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:30<01:37,  1.27s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:31<01:35,  1.25s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:33<01:48,  1.44s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:34<01:43,  1.40s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:36<01:56,  1.59s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:37<01:45,  1.47s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:38<01:38,  1.38s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:40<01:35,  1.36s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:41<01:28,  1.28s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:42<01:25,  1.25s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:43<01:22,  1.23s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:44<01:20,  1.22s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:46<01:18,  1.21s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:47<01:18,  1.23s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:48<01:16,  1.22s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:49<01:19,  1.28s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:51<01:18,  1.29s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:52<01:16,  1.28s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:53<01:14,  1.27s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:55<01:21,  1.40s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:57<01:27,  1.53s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:58<01:27,  1.57s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:00<01:20,  1.47s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:01<01:13,  1.37s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:02<01:13,  1.38s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:03<01:09,  1.33s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:05<01:05,  1.29s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:06<01:01,  1.24s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:07<01:01,  1.25s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:08<00:57,  1.20s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:09<00:56,  1.19s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:10<00:54,  1.18s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:12<00:52,  1.17s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:13<00:57,  1.30s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:14<00:53,  1.24s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:16<00:53,  1.27s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:17<00:58,  1.42s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:19<01:01,  1.53s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:21<00:58,  1.51s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:22<00:54,  1.43s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:24<00:56,  1.53s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:25<00:57,  1.59s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:27<00:55,  1.59s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:28<00:49,  1.46s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:30<00:49,  1.51s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:31<00:50,  1.59s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:33<00:48,  1.57s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:34<00:45,  1.51s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:36<00:42,  1.48s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:37<00:40,  1.45s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:39<00:38,  1.42s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:40<00:36,  1.42s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:41<00:36,  1.44s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:43<00:32,  1.36s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:44<00:29,  1.29s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:45<00:27,  1.26s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:46<00:25,  1.20s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:47<00:25,  1.29s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:49<00:25,  1.34s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:51<00:26,  1.50s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:52<00:23,  1.38s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:53<00:20,  1.28s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:54<00:18,  1.22s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:55<00:16,  1.18s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:56<00:14,  1.13s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:57<00:13,  1.10s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:58<00:12,  1.15s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:00<00:11,  1.17s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:01<00:10,  1.15s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:02<00:09,  1.16s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:03<00:08,  1.17s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:04<00:06,  1.16s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:05<00:05,  1.12s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:07<00:05,  1.35s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:09<00:04,  1.58s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:10<00:02,  1.46s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:12<00:01,  1.35s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:13<00:00,  1.25s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:13<00:00,  1.33s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.16515
wandb: 
wandb: üöÄ View run hearty-sweep-77 at: https://wandb.ai/xzy11632/dance-dev/runs/8nuhxhuq
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_100232-8nuhxhuq/logs
wandb: Agent Starting Run: vnx0rdtp with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_100629-vnx0rdtp
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run smart-sweep-78
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/vnx0rdtp
[INFO][2024-03-16 10:06:34,963][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 10:06:35,048][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 10:06:35,049][dance][wrapped_func] Took 0:00:00.084250 to load and process data.
[INFO][2024-03-16 10:06:35,049][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 10:06:35,051][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 10:06:35,066][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 10:06:35,174][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 10:06:37,901][dance.WeightedFeatureSVD][__call__] Decomposing train features (7963, 200) (k=6)
[INFO][2024-03-16 10:06:37,901][dance.WeightedFeatureSVD][__call__] Total explained variance: 91.00%
[INFO][2024-03-16 10:06:41,486][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 10:06:41,486][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 10:06:41,486][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 10:06:41,486][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:40,  1.01s/it]  2%|‚ñè         | 2/100 [00:01<01:35,  1.02it/s]  3%|‚ñé         | 3/100 [00:03<01:39,  1.02s/it]  4%|‚ñç         | 4/100 [00:04<01:58,  1.23s/it]  5%|‚ñå         | 5/100 [00:06<02:10,  1.37s/it]  6%|‚ñå         | 6/100 [00:07<02:07,  1.36s/it]  7%|‚ñã         | 7/100 [00:08<01:57,  1.27s/it]  8%|‚ñä         | 8/100 [00:09<01:53,  1.23s/it]  9%|‚ñâ         | 9/100 [00:10<01:48,  1.19s/it] 10%|‚ñà         | 10/100 [00:11<01:43,  1.15s/it] 11%|‚ñà         | 11/100 [00:13<01:41,  1.14s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:38,  1.12s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:33,  1.08s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:30,  1.05s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:30,  1.06s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<01:46,  1.27s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<02:08,  1.55s/it] 18%|‚ñà‚ñä        | 18/100 [00:22<01:54,  1.40s/it] 19%|‚ñà‚ñâ        | 19/100 [00:23<01:48,  1.33s/it] 20%|‚ñà‚ñà        | 20/100 [00:24<01:39,  1.24s/it] 21%|‚ñà‚ñà        | 21/100 [00:25<01:36,  1.23s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:26<01:34,  1.22s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:28<01:34,  1.23s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:29<01:32,  1.22s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:30<01:28,  1.18s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:31<01:26,  1.17s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:32<01:25,  1.18s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:33<01:26,  1.20s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:35<01:23,  1.17s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:36<01:18,  1.12s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:37<01:27,  1.27s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:39<01:28,  1.30s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:40<01:35,  1.42s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:41<01:29,  1.36s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:43<01:26,  1.33s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:44<01:21,  1.27s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:45<01:16,  1.21s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:46<01:12,  1.17s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:47<01:10,  1.15s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:48<01:07,  1.13s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:49<01:05,  1.11s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:50<01:03,  1.09s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:51<01:04,  1.13s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:53<01:04,  1.15s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:54<01:03,  1.16s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:55<01:03,  1.17s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:56<01:02,  1.17s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:58<01:11,  1.38s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:00<01:19,  1.57s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:01<01:11,  1.43s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:02<01:04,  1.32s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:04<01:02,  1.30s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:05<00:57,  1.23s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:06<00:55,  1.20s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:07<00:52,  1.17s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:08<00:50,  1.14s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:09<00:50,  1.17s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:10<00:51,  1.22s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:12<00:53,  1.30s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:13<00:50,  1.26s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:14<00:49,  1.26s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:16<00:46,  1.22s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:17<00:50,  1.36s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:19<00:56,  1.56s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:20<00:50,  1.44s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:22<00:45,  1.35s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:23<00:46,  1.42s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:25<00:46,  1.45s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:26<00:42,  1.39s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:27<00:39,  1.31s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:28<00:36,  1.26s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:30<00:36,  1.29s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:31<00:38,  1.44s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:33<00:37,  1.45s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:34<00:34,  1.40s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:35<00:32,  1.33s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:36<00:29,  1.28s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:37<00:26,  1.22s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:39<00:25,  1.19s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:40<00:22,  1.13s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:41<00:21,  1.15s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:42<00:22,  1.25s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:45<00:27,  1.60s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:46<00:23,  1.47s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:47<00:20,  1.38s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:48<00:18,  1.29s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:49<00:16,  1.25s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:50<00:14,  1.24s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:51<00:12,  1.17s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:52<00:11,  1.12s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:54<00:10,  1.17s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:55<00:09,  1.16s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:56<00:08,  1.21s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:57<00:06,  1.15s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:58<00:05,  1.15s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:59<00:04,  1.12s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:01<00:03,  1.12s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:02<00:02,  1.25s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:04<00:01,  1.34s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:05<00:00,  1.44s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:05<00:00,  1.26s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.018 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.19972
wandb: 
wandb: üöÄ View run smart-sweep-78 at: https://wandb.ai/xzy11632/dance-dev/runs/vnx0rdtp
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_100629-vnx0rdtp/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: vtrlg0z3 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_101045-vtrlg0z3
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run hardy-sweep-79
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/vtrlg0z3
[INFO][2024-03-16 10:10:52,451][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 10:10:52,540][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 10:10:52,541][dance][wrapped_func] Took 0:00:00.089021 to load and process data.
[INFO][2024-03-16 10:10:52,541][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 10:10:52,543][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 10:10:52,567][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 10:10:52,675][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run hardy-sweep-79 at: https://wandb.ai/xzy11632/dance-dev/runs/vtrlg0z3
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_101045-vtrlg0z3/logs
wandb: ERROR Run vtrlg0z3 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: 5idojpu3 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_101107-5idojpu3
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run stellar-sweep-80
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/5idojpu3
[INFO][2024-03-16 10:11:15,317][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 10:11:15,431][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 10:11:15,431][dance][wrapped_func] Took 0:00:00.113860 to load and process data.
[INFO][2024-03-16 10:11:15,432][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 10:11:15,434][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 10:11:15,473][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 10:11:15,603][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run stellar-sweep-80 at: https://wandb.ai/xzy11632/dance-dev/runs/5idojpu3
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_101107-5idojpu3/logs
wandb: ERROR Run 5idojpu3 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: dmeqmeew with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_101129-dmeqmeew
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run radiant-sweep-81
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/dmeqmeew
[INFO][2024-03-16 10:11:35,826][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 10:11:35,911][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 10:11:35,911][dance][wrapped_func] Took 0:00:00.084680 to load and process data.
[INFO][2024-03-16 10:11:35,911][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 10:11:35,913][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 10:11:35,929][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 10:11:36,034][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run radiant-sweep-81 at: https://wandb.ai/xzy11632/dance-dev/runs/dmeqmeew
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_101129-dmeqmeew/logs
wandb: ERROR Run dmeqmeew errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: jty9yl8v with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_101150-jty9yl8v
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run icy-sweep-82
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/jty9yl8v
[INFO][2024-03-16 10:11:56,553][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 10:11:56,645][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 10:11:56,645][dance][wrapped_func] Took 0:00:00.091199 to load and process data.
[INFO][2024-03-16 10:11:56,645][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 10:11:56,647][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 10:11:56,664][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 10:11:56,768][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run icy-sweep-82 at: https://wandb.ai/xzy11632/dance-dev/runs/jty9yl8v
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_101150-jty9yl8v/logs
wandb: ERROR Run jty9yl8v errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: ni765g3r with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_101216-ni765g3r
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run eager-sweep-83
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ni765g3r
[INFO][2024-03-16 10:12:22,342][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 10:12:22,442][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 10:12:22,442][dance][wrapped_func] Took 0:00:00.099383 to load and process data.
[INFO][2024-03-16 10:12:22,442][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 10:12:22,445][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 10:12:22,468][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 10:12:22,574][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 10:12:23,199][dance.WeightedFeaturePCA][__call__] Decomposing train features (7963, 200) (k=5)
[INFO][2024-03-16 10:12:23,200][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.03%
[INFO][2024-03-16 10:12:25,625][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 10:12:25,625][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 10:12:25,625][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 10:12:25,625][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:53,  1.15s/it]  2%|‚ñè         | 2/100 [00:02<01:56,  1.19s/it]  3%|‚ñé         | 3/100 [00:03<01:54,  1.18s/it]  4%|‚ñç         | 4/100 [00:04<01:50,  1.15s/it]  5%|‚ñå         | 5/100 [00:05<01:50,  1.16s/it]  6%|‚ñå         | 6/100 [00:07<02:07,  1.35s/it]  7%|‚ñã         | 7/100 [00:09<02:35,  1.67s/it]  8%|‚ñä         | 8/100 [00:10<02:16,  1.49s/it]  9%|‚ñâ         | 9/100 [00:12<02:04,  1.37s/it] 10%|‚ñà         | 10/100 [00:13<01:55,  1.28s/it] 11%|‚ñà         | 11/100 [00:14<01:53,  1.27s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<02:05,  1.43s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<02:09,  1.49s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<01:58,  1.38s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<01:47,  1.26s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<01:38,  1.18s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:32,  1.12s/it] 18%|‚ñà‚ñä        | 18/100 [00:23<01:36,  1.17s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<01:40,  1.24s/it] 20%|‚ñà‚ñà        | 20/100 [00:25<01:43,  1.29s/it] 21%|‚ñà‚ñà        | 21/100 [00:27<01:41,  1.29s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:28<01:37,  1.25s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:29<01:31,  1.19s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:30<01:26,  1.13s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:32<01:38,  1.31s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:34<01:52,  1.52s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:35<01:37,  1.33s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:36<01:32,  1.28s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:37<01:26,  1.22s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:38<01:21,  1.17s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:39<01:18,  1.14s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:40<01:20,  1.18s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:41<01:15,  1.12s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:42<01:11,  1.09s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:43<01:11,  1.10s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:45<01:12,  1.13s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:46<01:11,  1.14s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:47<01:09,  1.13s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:48<01:08,  1.12s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:50<01:17,  1.29s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:52<01:29,  1.52s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:53<01:22,  1.42s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:54<01:13,  1.30s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:55<01:08,  1.23s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:56<01:07,  1.23s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:57<01:03,  1.18s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:58<01:00,  1.14s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:00<01:03,  1.22s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:01<00:58,  1.15s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:02<00:57,  1.15s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:03<00:54,  1.12s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:04<00:54,  1.13s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:05<00:51,  1.09s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:06<00:51,  1.11s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:07<00:50,  1.13s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:09<00:58,  1.33s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:11<01:05,  1.53s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:12<00:56,  1.35s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:13<00:55,  1.34s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:15<00:52,  1.31s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:16<00:50,  1.30s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:17<00:45,  1.21s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:18<00:43,  1.17s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:19<00:40,  1.12s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:20<00:38,  1.11s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:21<00:36,  1.09s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:22<00:37,  1.12s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:23<00:35,  1.11s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:25<00:35,  1.13s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:26<00:33,  1.12s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:27<00:32,  1.14s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:28<00:32,  1.15s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:30<00:33,  1.25s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:31<00:33,  1.27s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:33<00:38,  1.54s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:34<00:34,  1.43s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:35<00:31,  1.35s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:37<00:30,  1.39s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:38<00:28,  1.35s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:39<00:26,  1.31s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:41<00:24,  1.30s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:42<00:22,  1.26s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:43<00:21,  1.27s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:45<00:21,  1.33s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:46<00:20,  1.34s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:47<00:18,  1.35s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:48<00:16,  1.27s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:49<00:14,  1.19s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:50<00:12,  1.12s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:52<00:12,  1.29s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:54<00:13,  1.54s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:55<00:11,  1.38s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:57<00:10,  1.43s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:58<00:08,  1.48s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:59<00:06,  1.40s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:01<00:05,  1.38s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:02<00:04,  1.44s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:04<00:02,  1.34s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:05<00:01,  1.26s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:06<00:00,  1.28s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:06<00:00,  1.26s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.018 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.16396
wandb: 
wandb: üöÄ View run eager-sweep-83 at: https://wandb.ai/xzy11632/dance-dev/runs/ni765g3r
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_101216-ni765g3r/logs
wandb: Agent Starting Run: qkmzw6mg with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_101616-qkmzw6mg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run earthy-sweep-84
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/qkmzw6mg
[INFO][2024-03-16 10:16:22,119][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 10:16:22,217][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 10:16:22,217][dance][wrapped_func] Took 0:00:00.096954 to load and process data.
[INFO][2024-03-16 10:16:22,217][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 10:16:22,219][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 10:16:22,240][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 10:16:22,365][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 10:16:24,191][dance.WeightedFeatureSVD][__call__] Decomposing train features (7963, 200) (k=8)
[INFO][2024-03-16 10:16:24,196][dance.WeightedFeatureSVD][__call__] Total explained variance: 93.31%
[INFO][2024-03-16 10:16:27,213][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 10:16:27,214][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 10:16:27,214][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 10:16:27,214][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:50,  1.73s/it]  2%|‚ñè         | 2/100 [00:03<02:50,  1.74s/it]  3%|‚ñé         | 3/100 [00:04<02:33,  1.58s/it]  4%|‚ñç         | 4/100 [00:06<02:28,  1.55s/it]  5%|‚ñå         | 5/100 [00:07<02:13,  1.41s/it]  6%|‚ñå         | 6/100 [00:08<01:59,  1.27s/it]  7%|‚ñã         | 7/100 [00:09<01:52,  1.21s/it]  8%|‚ñä         | 8/100 [00:10<01:48,  1.18s/it]  9%|‚ñâ         | 9/100 [00:11<01:44,  1.15s/it] 10%|‚ñà         | 10/100 [00:12<01:39,  1.11s/it] 11%|‚ñà         | 11/100 [00:13<01:35,  1.08s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:37,  1.11s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:38,  1.13s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:34,  1.10s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:34,  1.12s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:30,  1.08s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:44,  1.26s/it] 18%|‚ñà‚ñä        | 18/100 [00:23<02:02,  1.49s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<01:58,  1.46s/it] 20%|‚ñà‚ñà        | 20/100 [00:25<01:57,  1.47s/it] 21%|‚ñà‚ñà        | 21/100 [00:27<01:51,  1.41s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:28<01:49,  1.40s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:29<01:41,  1.32s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:30<01:36,  1.27s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:32<01:31,  1.22s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:33<01:29,  1.22s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:34<01:24,  1.16s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:35<01:21,  1.13s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:36<01:28,  1.24s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:38<01:34,  1.35s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:39<01:29,  1.30s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:40<01:26,  1.27s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:41<01:20,  1.20s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:42<01:14,  1.13s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:43<01:12,  1.12s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:44<01:09,  1.08s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:46<01:19,  1.27s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:48<01:36,  1.56s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:49<01:27,  1.43s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:51<01:19,  1.32s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:52<01:14,  1.27s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:53<01:08,  1.19s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:54<01:07,  1.18s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:55<01:04,  1.14s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:56<01:02,  1.14s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:57<01:01,  1.14s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:58<01:00,  1.14s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:00<01:00,  1.17s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:01<01:01,  1.20s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:02<00:58,  1.17s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:03<00:55,  1.14s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:04<00:52,  1.09s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:05<00:49,  1.05s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:07<00:59,  1.30s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:09<01:05,  1.45s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:10<01:01,  1.39s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:11<00:56,  1.32s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:12<00:53,  1.28s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:13<00:51,  1.27s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:15<00:48,  1.22s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:16<00:44,  1.15s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:17<00:43,  1.14s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:18<00:41,  1.12s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:19<00:39,  1.09s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:20<00:36,  1.05s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:21<00:36,  1.07s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:22<00:34,  1.04s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:23<00:32,  1.02s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:24<00:31,  1.00s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:25<00:35,  1.18s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:27<00:37,  1.30s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:29<00:39,  1.41s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:30<00:35,  1.32s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:31<00:32,  1.24s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:32<00:30,  1.24s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:33<00:28,  1.19s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:34<00:26,  1.14s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:35<00:23,  1.07s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:36<00:22,  1.07s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:37<00:21,  1.10s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:38<00:21,  1.13s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:40<00:21,  1.19s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:41<00:21,  1.25s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:42<00:19,  1.24s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:43<00:17,  1.19s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:45<00:18,  1.35s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:47<00:21,  1.65s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:49<00:17,  1.48s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:50<00:14,  1.34s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:51<00:12,  1.27s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:52<00:10,  1.21s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:53<00:09,  1.15s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:54<00:07,  1.14s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:55<00:06,  1.12s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:56<00:05,  1.13s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:57<00:04,  1.13s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:58<00:03,  1.11s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:59<00:02,  1.12s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:00<00:01,  1.10s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:02<00:00,  1.09s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:02<00:00,  1.22s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.25725
wandb: 
wandb: üöÄ View run earthy-sweep-84 at: https://wandb.ai/xzy11632/dance-dev/runs/qkmzw6mg
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_101616-qkmzw6mg/logs
wandb: Agent Starting Run: mn9wmesz with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_101941-mn9wmesz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run electric-sweep-85
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/mn9wmesz
[INFO][2024-03-16 10:19:45,887][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 10:19:45,966][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 10:19:45,966][dance][wrapped_func] Took 0:00:00.078923 to load and process data.
[INFO][2024-03-16 10:19:45,967][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 10:19:45,968][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 10:19:45,983][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 10:19:46,095][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 10:19:48,149][dance.WeightedFeaturePCA][__call__] Decomposing train features (7963, 980) (k=8)
[INFO][2024-03-16 10:19:48,149][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.13%
[INFO][2024-03-16 10:19:51,601][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 10:19:51,602][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 10:19:51,602][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 10:19:51,602][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:22,  1.44s/it]  2%|‚ñè         | 2/100 [00:03<02:29,  1.52s/it]  3%|‚ñé         | 3/100 [00:04<02:21,  1.46s/it]  4%|‚ñç         | 4/100 [00:05<02:12,  1.38s/it]  5%|‚ñå         | 5/100 [00:07<02:37,  1.65s/it]  6%|‚ñå         | 6/100 [00:10<03:05,  1.98s/it]  7%|‚ñã         | 7/100 [00:11<02:40,  1.73s/it]  8%|‚ñä         | 8/100 [00:12<02:24,  1.57s/it]  9%|‚ñâ         | 9/100 [00:13<02:08,  1.41s/it] 10%|‚ñà         | 10/100 [00:15<02:00,  1.34s/it] 11%|‚ñà         | 11/100 [00:16<01:54,  1.28s/it] 12%|‚ñà‚ñè        | 12/100 [00:17<01:55,  1.32s/it] 13%|‚ñà‚ñé        | 13/100 [00:18<01:53,  1.31s/it] 14%|‚ñà‚ñç        | 14/100 [00:20<01:53,  1.32s/it] 15%|‚ñà‚ñå        | 15/100 [00:21<01:48,  1.27s/it] 16%|‚ñà‚ñå        | 16/100 [00:22<01:54,  1.36s/it] 17%|‚ñà‚ñã        | 17/100 [00:24<01:50,  1.34s/it] 18%|‚ñà‚ñä        | 18/100 [00:25<01:56,  1.42s/it] 19%|‚ñà‚ñâ        | 19/100 [00:27<01:52,  1.39s/it] 20%|‚ñà‚ñà        | 20/100 [00:28<01:44,  1.31s/it] 21%|‚ñà‚ñà        | 21/100 [00:29<01:38,  1.24s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:31<01:50,  1.41s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:33<02:20,  1.82s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:35<02:13,  1.75s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:36<02:01,  1.61s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:38<01:48,  1.47s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:39<01:38,  1.35s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:40<01:36,  1.34s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:41<01:31,  1.29s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:42<01:30,  1.30s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:43<01:25,  1.24s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:45<01:26,  1.27s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:46<01:25,  1.27s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:48<01:30,  1.38s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:49<01:26,  1.33s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:51<01:41,  1.58s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:54<01:56,  1.86s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:55<01:42,  1.65s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:56<01:31,  1.50s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:57<01:29,  1.49s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:59<01:22,  1.40s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:00<01:23,  1.44s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:01<01:20,  1.41s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:03<01:22,  1.47s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:04<01:18,  1.43s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:06<01:16,  1.42s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:07<01:12,  1.36s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:08<01:09,  1.34s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:09<01:03,  1.25s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:12<01:24,  1.69s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:15<01:41,  2.08s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:16<01:26,  1.79s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:17<01:14,  1.59s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:19<01:08,  1.49s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:20<01:03,  1.41s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:21<01:01,  1.40s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:22<00:55,  1.29s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:23<00:51,  1.22s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:24<00:49,  1.21s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:26<00:48,  1.22s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:27<00:48,  1.23s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:28<00:48,  1.28s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:30<00:46,  1.26s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:31<00:44,  1.25s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:33<00:52,  1.51s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:36<01:02,  1.85s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:37<00:53,  1.62s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:38<00:48,  1.52s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:40<00:49,  1.58s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:42<00:52,  1.75s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:44<00:56,  1.93s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:47<01:06,  2.36s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:51<01:10,  2.59s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:54<01:12,  2.78s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:57<01:13,  2.94s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:00<01:12,  3.02s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:04<01:10,  3.08s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:07<01:09,  3.15s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:10<01:06,  3.17s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:13<01:03,  3.15s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:16<01:00,  3.17s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:20<00:56,  3.15s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:21<00:47,  2.78s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:23<00:40,  2.55s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:27<00:41,  2.80s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:29<00:37,  2.70s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:31<00:32,  2.53s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:34<00:29,  2.47s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:35<00:24,  2.23s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:37<00:21,  2.13s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:39<00:17,  1.98s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:41<00:15,  1.88s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:42<00:12,  1.73s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:44<00:09,  1.67s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:46<00:10,  2.05s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:49<00:09,  2.28s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:51<00:06,  2.21s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:53<00:04,  2.09s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:55<00:01,  1.92s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:57<00:00,  2.11s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:57<00:00,  1.78s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.018 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.25058
wandb: 
wandb: üöÄ View run electric-sweep-85 at: https://wandb.ai/xzy11632/dance-dev/runs/mn9wmesz
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_101941-mn9wmesz/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: cc36xlle with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_102412-cc36xlle
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run youthful-sweep-86
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/cc36xlle
[INFO][2024-03-16 10:24:19,145][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 10:24:19,272][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 10:24:19,273][dance][wrapped_func] Took 0:00:00.127016 to load and process data.
[INFO][2024-03-16 10:24:19,274][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 10:24:19,278][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 10:24:19,312][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 10:24:19,654][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 10:24:31,317][dance.WeightedFeatureSVD][__call__] Decomposing train features (7963, 980) (k=97)
[INFO][2024-03-16 10:24:31,318][dance.WeightedFeatureSVD][__call__] Total explained variance: 96.90%
[INFO][2024-03-16 10:24:57,062][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 10:24:57,063][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 10:24:57,063][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 10:24:57,063][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:23,  1.45s/it]  2%|‚ñè         | 2/100 [00:02<02:03,  1.26s/it]  3%|‚ñé         | 3/100 [00:03<02:00,  1.25s/it]  4%|‚ñç         | 4/100 [00:05<02:27,  1.54s/it]  5%|‚ñå         | 5/100 [00:08<03:04,  1.94s/it]  6%|‚ñå         | 6/100 [00:09<02:41,  1.72s/it]  7%|‚ñã         | 7/100 [00:10<02:22,  1.53s/it]  8%|‚ñä         | 8/100 [00:12<02:09,  1.41s/it]  9%|‚ñâ         | 9/100 [00:15<03:12,  2.11s/it] 10%|‚ñà         | 10/100 [00:19<03:45,  2.50s/it] 11%|‚ñà         | 11/100 [00:21<03:47,  2.56s/it] 12%|‚ñà‚ñè        | 12/100 [00:23<03:28,  2.37s/it] 13%|‚ñà‚ñé        | 13/100 [00:25<03:04,  2.12s/it] 14%|‚ñà‚ñç        | 14/100 [00:26<02:48,  1.96s/it] 15%|‚ñà‚ñå        | 15/100 [00:30<03:27,  2.45s/it] 16%|‚ñà‚ñå        | 16/100 [00:32<03:07,  2.23s/it] 17%|‚ñà‚ñã        | 17/100 [00:33<02:42,  1.96s/it] 18%|‚ñà‚ñä        | 18/100 [00:38<03:48,  2.79s/it] 19%|‚ñà‚ñâ        | 19/100 [00:41<04:09,  3.08s/it] 20%|‚ñà‚ñà        | 20/100 [00:45<04:06,  3.08s/it] 21%|‚ñà‚ñà        | 21/100 [00:47<03:50,  2.92s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:50<03:40,  2.83s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:52<03:34,  2.79s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:55<03:29,  2.76s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:57<03:06,  2.49s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:59<02:53,  2.35s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [01:01<02:49,  2.33s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [01:04<03:03,  2.54s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [01:06<02:37,  2.22s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [01:07<02:18,  1.98s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [01:08<02:03,  1.79s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:10<01:50,  1.62s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:11<01:48,  1.62s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:13<01:43,  1.57s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:14<01:44,  1.61s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:16<01:46,  1.67s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:18<01:43,  1.65s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:20<01:42,  1.65s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:21<01:41,  1.67s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:23<01:39,  1.66s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:24<01:33,  1.58s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:27<01:56,  2.01s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:30<02:00,  2.11s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:32<01:54,  2.04s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:33<01:44,  1.90s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:35<01:35,  1.77s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:36<01:29,  1.68s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:37<01:22,  1.58s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:39<01:22,  1.63s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:41<01:19,  1.58s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:42<01:21,  1.66s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:44<01:23,  1.75s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:47<01:38,  2.11s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:51<01:58,  2.57s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:54<02:03,  2.74s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [02:03<03:15,  4.45s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [02:08<03:21,  4.68s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [02:13<03:28,  4.96s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [02:19<03:33,  5.20s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [02:25<03:35,  5.39s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [02:31<03:32,  5.46s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [02:36<03:31,  5.58s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [02:43<03:38,  5.92s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [02:49<03:36,  6.02s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [02:56<03:33,  6.09s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [03:02<03:29,  6.15s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [03:08<03:22,  6.15s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [03:17<03:40,  6.88s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [03:24<03:40,  7.11s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [03:31<03:25,  6.84s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [03:37<03:11,  6.59s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [03:43<03:06,  6.67s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [03:50<02:56,  6.55s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [03:56<02:48,  6.47s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [04:02<02:39,  6.39s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [04:09<02:35,  6.47s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [04:15<02:26,  6.35s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [04:21<02:17,  6.23s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [04:27<02:09,  6.16s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [04:35<02:14,  6.72s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [04:42<02:11,  6.94s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [04:48<01:59,  6.62s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [04:54<01:49,  6.42s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [05:00<01:40,  6.27s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [05:06<01:32,  6.15s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [05:13<01:27,  6.28s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [05:18<01:20,  6.18s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [05:25<01:14,  6.25s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [05:31<01:06,  6.07s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [05:37<01:00,  6.03s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [05:43<00:55,  6.15s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [05:50<00:50,  6.32s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [05:57<00:45,  6.51s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [06:01<00:35,  5.90s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [06:04<00:25,  5.11s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [06:07<00:17,  4.30s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [06:09<00:10,  3.56s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [06:10<00:05,  2.83s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [06:11<00:02,  2.39s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [06:12<00:00,  2.08s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [06:12<00:00,  3.73s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.29621
wandb: 
wandb: üöÄ View run youthful-sweep-86 at: https://wandb.ai/xzy11632/dance-dev/runs/cc36xlle
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_102412-cc36xlle/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: k3bv4zne with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_103230-k3bv4zne
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run divine-sweep-87
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/k3bv4zne
[INFO][2024-03-16 10:32:35,179][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 10:32:35,264][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 10:32:35,264][dance][wrapped_func] Took 0:00:00.084699 to load and process data.
[INFO][2024-03-16 10:32:35,264][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 10:32:35,266][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 10:32:35,607][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run divine-sweep-87 at: https://wandb.ai/xzy11632/dance-dev/runs/k3bv4zne
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_103230-k3bv4zne/logs
wandb: ERROR Run k3bv4zne errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1020) out of bounds (980)
wandb: ERROR 
wandb: Agent Starting Run: vi1fsr0u with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_103251-vi1fsr0u
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run gallant-sweep-88
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/vi1fsr0u
[INFO][2024-03-16 10:32:58,592][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 10:32:58,738][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 10:32:58,738][dance][wrapped_func] Took 0:00:00.145398 to load and process data.
[INFO][2024-03-16 10:32:58,738][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 10:32:58,741][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 10:32:59,199][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run gallant-sweep-88 at: https://wandb.ai/xzy11632/dance-dev/runs/vi1fsr0u
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_103251-vi1fsr0u/logs
wandb: ERROR Run vi1fsr0u errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1020) out of bounds (980)
wandb: ERROR 
wandb: Agent Starting Run: uj5xrt8w with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_103313-uj5xrt8w
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run clear-sweep-89
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/uj5xrt8w
[INFO][2024-03-16 10:33:19,019][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 10:33:19,125][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 10:33:19,125][dance][wrapped_func] Took 0:00:00.105142 to load and process data.
[INFO][2024-03-16 10:33:19,125][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 10:33:19,127][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[INFO][2024-03-16 10:33:19,597][dance.WeightedFeaturePCA][__call__] Decomposing train features (7963, 200) (k=6)
[INFO][2024-03-16 10:33:19,598][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.41%
[INFO][2024-03-16 10:33:22,583][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 10:33:22,583][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 10:33:22,583][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 10:33:22,583][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:02<03:18,  2.01s/it]  2%|‚ñè         | 2/100 [00:03<02:35,  1.58s/it]  3%|‚ñé         | 3/100 [00:04<02:05,  1.29s/it]  4%|‚ñç         | 4/100 [00:05<01:51,  1.16s/it]  5%|‚ñå         | 5/100 [00:06<01:42,  1.07s/it]  6%|‚ñå         | 6/100 [00:07<01:37,  1.04s/it]  7%|‚ñã         | 7/100 [00:08<01:34,  1.02s/it]  8%|‚ñä         | 8/100 [00:09<01:33,  1.02s/it]  9%|‚ñâ         | 9/100 [00:10<01:30,  1.01it/s] 10%|‚ñà         | 10/100 [00:10<01:25,  1.05it/s] 11%|‚ñà         | 11/100 [00:12<01:29,  1.01s/it] 12%|‚ñà‚ñè        | 12/100 [00:13<01:32,  1.05s/it] 13%|‚ñà‚ñé        | 13/100 [00:14<01:35,  1.10s/it] 14%|‚ñà‚ñç        | 14/100 [00:15<01:36,  1.12s/it] 15%|‚ñà‚ñå        | 15/100 [00:16<01:37,  1.14s/it] 16%|‚ñà‚ñå        | 16/100 [00:17<01:34,  1.12s/it] 17%|‚ñà‚ñã        | 17/100 [00:19<01:44,  1.26s/it] 18%|‚ñà‚ñä        | 18/100 [00:21<01:58,  1.44s/it] 19%|‚ñà‚ñâ        | 19/100 [00:23<02:05,  1.55s/it] 20%|‚ñà‚ñà        | 20/100 [00:24<02:03,  1.55s/it] 21%|‚ñà‚ñà        | 21/100 [00:26<02:02,  1.56s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:27<01:54,  1.47s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:28<01:45,  1.37s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:29<01:36,  1.27s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:30<01:29,  1.19s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:31<01:29,  1.22s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:32<01:24,  1.15s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:33<01:20,  1.11s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:35<01:19,  1.11s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:36<01:19,  1.13s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:37<01:17,  1.13s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:38<01:13,  1.08s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:39<01:14,  1.11s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:40<01:20,  1.22s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:42<01:21,  1.25s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:44<01:30,  1.42s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:45<01:24,  1.34s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:46<01:18,  1.27s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:47<01:22,  1.35s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:49<01:22,  1.37s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:50<01:15,  1.28s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:51<01:09,  1.19s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:52<01:04,  1.13s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:53<01:04,  1.15s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:54<01:03,  1.16s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:56<01:04,  1.19s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:57<01:03,  1.20s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:58<00:59,  1.15s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:59<00:58,  1.14s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:01<01:06,  1.32s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:03<01:18,  1.59s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:04<01:13,  1.53s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:05<01:04,  1.37s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:06<00:57,  1.25s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:07<00:53,  1.18s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:08<00:52,  1.19s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:10<00:51,  1.20s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:11<00:48,  1.16s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:12<00:48,  1.17s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:13<00:45,  1.14s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:14<00:45,  1.17s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:15<00:43,  1.14s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:17<00:42,  1.16s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:18<00:42,  1.18s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:19<00:41,  1.18s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:20<00:43,  1.28s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:22<00:42,  1.28s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:24<00:47,  1.48s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:25<00:41,  1.35s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:26<00:37,  1.25s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:27<00:34,  1.21s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:28<00:33,  1.18s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:29<00:30,  1.14s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:30<00:28,  1.11s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:31<00:27,  1.10s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:32<00:26,  1.10s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:34<00:27,  1.21s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:35<00:29,  1.36s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:37<00:27,  1.29s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:38<00:25,  1.26s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:39<00:23,  1.24s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:40<00:21,  1.22s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:42<00:22,  1.34s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:44<00:24,  1.55s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:45<00:20,  1.39s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:46<00:18,  1.29s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:47<00:15,  1.20s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:48<00:16,  1.34s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:50<00:16,  1.49s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:51<00:13,  1.39s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:52<00:11,  1.25s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:53<00:09,  1.17s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:54<00:07,  1.11s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:55<00:06,  1.07s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:56<00:05,  1.02s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:57<00:04,  1.08s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:59<00:03,  1.08s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:00<00:02,  1.05s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:00<00:01,  1.01s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:01<00:00,  1.01s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:01<00:00,  1.22s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.024 MB uploadedwandb: \ 0.018 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.16303
wandb: 
wandb: üöÄ View run clear-sweep-89 at: https://wandb.ai/xzy11632/dance-dev/runs/uj5xrt8w
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_103313-uj5xrt8w/logs
wandb: Agent Starting Run: f6nz1ah6 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_103703-f6nz1ah6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run cerulean-sweep-90
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/f6nz1ah6
[INFO][2024-03-16 10:37:10,159][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 10:37:10,260][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 10:37:10,261][dance][wrapped_func] Took 0:00:00.100409 to load and process data.
[INFO][2024-03-16 10:37:10,261][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 10:37:10,263][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[INFO][2024-03-16 10:37:11,866][dance.WeightedFeatureSVD][__call__] Decomposing train features (7963, 200) (k=7)
[INFO][2024-03-16 10:37:11,866][dance.WeightedFeatureSVD][__call__] Total explained variance: 91.48%
[INFO][2024-03-16 10:37:13,979][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 10:37:13,979][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 10:37:13,980][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 10:37:13,980][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:47,  1.09s/it]  2%|‚ñè         | 2/100 [00:02<01:51,  1.14s/it]  3%|‚ñé         | 3/100 [00:03<01:48,  1.12s/it]  4%|‚ñç         | 4/100 [00:04<01:45,  1.09s/it]  5%|‚ñå         | 5/100 [00:05<01:43,  1.08s/it]  6%|‚ñå         | 6/100 [00:06<01:39,  1.06s/it]  7%|‚ñã         | 7/100 [00:07<01:39,  1.07s/it]  8%|‚ñä         | 8/100 [00:08<01:40,  1.09s/it]  9%|‚ñâ         | 9/100 [00:10<01:53,  1.25s/it] 10%|‚ñà         | 10/100 [00:11<02:03,  1.38s/it] 11%|‚ñà         | 11/100 [00:13<02:04,  1.40s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:52,  1.28s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:42,  1.18s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:39,  1.16s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:42,  1.20s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<01:37,  1.16s/it] 17%|‚ñà‚ñã        | 17/100 [00:19<01:30,  1.10s/it] 18%|‚ñà‚ñä        | 18/100 [00:20<01:29,  1.10s/it] 19%|‚ñà‚ñâ        | 19/100 [00:22<01:30,  1.11s/it] 20%|‚ñà‚ñà        | 20/100 [00:23<01:30,  1.14s/it] 21%|‚ñà‚ñà        | 21/100 [00:24<01:28,  1.13s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:25<01:29,  1.14s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:26<01:24,  1.09s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:27<01:30,  1.19s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:29<01:31,  1.22s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:31<01:44,  1.41s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:32<01:38,  1.35s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:33<01:34,  1.31s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:34<01:29,  1.26s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:35<01:25,  1.22s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:36<01:21,  1.18s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:37<01:19,  1.17s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:39<01:21,  1.22s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:40<01:17,  1.18s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:41<01:15,  1.16s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:42<01:14,  1.16s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:43<01:11,  1.14s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:45<01:22,  1.33s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:47<01:25,  1.41s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:48<01:20,  1.34s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:50<01:30,  1.54s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:52<01:39,  1.72s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:53<01:27,  1.54s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:54<01:16,  1.37s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:55<01:13,  1.33s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:56<01:07,  1.26s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:58<01:05,  1.24s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:59<01:02,  1.21s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:00<01:00,  1.18s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:01<01:01,  1.23s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:03<01:03,  1.29s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:04<01:01,  1.29s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:05<00:58,  1.24s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:06<00:55,  1.20s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:07<00:54,  1.22s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:09<01:02,  1.41s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:11<01:11,  1.66s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:13<01:03,  1.50s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:14<00:54,  1.34s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:15<00:50,  1.25s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:16<00:47,  1.22s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:17<00:44,  1.16s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:18<00:44,  1.20s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:19<00:42,  1.19s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:20<00:39,  1.12s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:21<00:38,  1.14s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:23<00:38,  1.18s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:24<00:38,  1.20s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:25<00:37,  1.21s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:26<00:36,  1.21s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:27<00:32,  1.12s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:29<00:35,  1.27s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:31<00:39,  1.46s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:32<00:36,  1.39s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:33<00:32,  1.29s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:34<00:30,  1.27s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:35<00:27,  1.22s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:36<00:25,  1.17s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:37<00:23,  1.10s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:38<00:21,  1.07s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:40<00:21,  1.15s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:41<00:19,  1.10s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:42<00:19,  1.12s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:43<00:18,  1.14s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:44<00:17,  1.14s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:45<00:16,  1.17s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:47<00:14,  1.15s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:48<00:14,  1.18s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:49<00:14,  1.28s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:51<00:15,  1.50s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:52<00:12,  1.34s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:53<00:09,  1.24s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:54<00:08,  1.21s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:56<00:07,  1.20s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:57<00:06,  1.35s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:59<00:05,  1.49s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:01<00:04,  1.52s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:02<00:03,  1.54s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:04<00:01,  1.58s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:06<00:00,  1.59s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:06<00:00,  1.26s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.17098
wandb: 
wandb: üöÄ View run cerulean-sweep-90 at: https://wandb.ai/xzy11632/dance-dev/runs/f6nz1ah6
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_103703-f6nz1ah6/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: o9f65ijj with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_104114-o9f65ijj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lilac-sweep-91
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/o9f65ijj
[INFO][2024-03-16 10:41:21,975][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 10:41:22,068][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 10:41:22,068][dance][wrapped_func] Took 0:00:00.092252 to load and process data.
[INFO][2024-03-16 10:41:22,068][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 10:41:22,071][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.018 MB of 0.024 MB uploadedwandb: / 0.018 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run lilac-sweep-91 at: https://wandb.ai/xzy11632/dance-dev/runs/o9f65ijj
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_104114-o9f65ijj/logs
wandb: ERROR Run o9f65ijj errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: v7c6nuzp with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_104136-v7c6nuzp
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run daily-sweep-92
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/v7c6nuzp
[INFO][2024-03-16 10:41:42,328][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 10:41:42,654][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 10:41:42,655][dance][wrapped_func] Took 0:00:00.326257 to load and process data.
[INFO][2024-03-16 10:41:42,655][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 10:41:42,657][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run daily-sweep-92 at: https://wandb.ai/xzy11632/dance-dev/runs/v7c6nuzp
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_104136-v7c6nuzp/logs
wandb: ERROR Run v7c6nuzp errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: d62i2mt6 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_104203-d62i2mt6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wandering-sweep-93
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/d62i2mt6
[INFO][2024-03-16 10:42:08,216][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 10:42:08,303][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 10:42:08,303][dance][wrapped_func] Took 0:00:00.086341 to load and process data.
[INFO][2024-03-16 10:42:08,303][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 10:42:08,305][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.017 MB of 0.024 MB uploadedwandb: - 0.017 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run wandering-sweep-93 at: https://wandb.ai/xzy11632/dance-dev/runs/d62i2mt6
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_104203-d62i2mt6/logs
wandb: ERROR Run d62i2mt6 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: ki00fp3y with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_104219-ki00fp3y
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run clean-sweep-94
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ki00fp3y
[INFO][2024-03-16 10:42:26,318][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 10:42:26,399][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 10:42:26,399][dance][wrapped_func] Took 0:00:00.080916 to load and process data.
[INFO][2024-03-16 10:42:26,399][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 10:42:26,401][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run clean-sweep-94 at: https://wandb.ai/xzy11632/dance-dev/runs/ki00fp3y
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_104219-ki00fp3y/logs
wandb: ERROR Run ki00fp3y errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: cc9rm6na with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_104240-cc9rm6na
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run youthful-sweep-95
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/cc9rm6na
[INFO][2024-03-16 10:42:48,698][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 10:42:48,819][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 10:42:48,820][dance][wrapped_func] Took 0:00:00.121811 to load and process data.
[INFO][2024-03-16 10:42:48,821][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 10:42:48,823][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 10:42:51,534][dance.WeightedFeaturePCA][__call__] Decomposing train features (7963, 200) (k=8)
[INFO][2024-03-16 10:42:51,535][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.20%
[INFO][2024-03-16 10:43:06,812][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 10:43:06,813][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 10:43:06,813][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 10:43:06,813][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:41,  1.02s/it]  2%|‚ñè         | 2/100 [00:02<01:52,  1.15s/it]  3%|‚ñé         | 3/100 [00:03<01:50,  1.14s/it]  4%|‚ñç         | 4/100 [00:04<01:43,  1.07s/it]  5%|‚ñå         | 5/100 [00:05<01:52,  1.18s/it]  6%|‚ñå         | 6/100 [00:07<01:56,  1.24s/it]  7%|‚ñã         | 7/100 [00:09<02:19,  1.50s/it]  8%|‚ñä         | 8/100 [00:10<02:11,  1.42s/it]  9%|‚ñâ         | 9/100 [00:11<01:58,  1.30s/it] 10%|‚ñà         | 10/100 [00:12<01:50,  1.23s/it] 11%|‚ñà         | 11/100 [00:13<01:45,  1.19s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:38,  1.12s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:36,  1.11s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:42,  1.19s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:40,  1.18s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:36,  1.15s/it] 17%|‚ñà‚ñã        | 17/100 [00:20<01:36,  1.17s/it] 18%|‚ñà‚ñä        | 18/100 [00:21<01:36,  1.18s/it] 19%|‚ñà‚ñâ        | 19/100 [00:23<01:41,  1.26s/it] 20%|‚ñà‚ñà        | 20/100 [00:24<01:42,  1.28s/it] 21%|‚ñà‚ñà        | 21/100 [00:25<01:42,  1.30s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:26<01:35,  1.23s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:28<01:40,  1.30s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:29<01:39,  1.31s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:31<01:52,  1.50s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:32<01:44,  1.41s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:33<01:33,  1.28s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:34<01:24,  1.17s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:35<01:22,  1.16s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:36<01:17,  1.10s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:37<01:14,  1.08s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:39<01:16,  1.13s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:40<01:15,  1.13s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:41<01:14,  1.13s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:42<01:13,  1.14s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:43<01:14,  1.16s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:44<01:09,  1.11s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:45<01:11,  1.15s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:46<01:09,  1.14s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:48<01:06,  1.10s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:49<01:14,  1.26s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:51<01:26,  1.50s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:52<01:17,  1.35s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:53<01:12,  1.30s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:54<01:07,  1.22s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:55<01:02,  1.16s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:57<01:00,  1.15s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:58<00:58,  1.13s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:59<00:56,  1.10s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:00<00:54,  1.09s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:01<00:52,  1.08s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:02<00:52,  1.09s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:03<00:49,  1.05s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:04<00:47,  1.04s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:05<00:47,  1.05s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:06<00:45,  1.02s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:07<00:45,  1.05s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:09<00:54,  1.30s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:11<01:02,  1.52s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:12<00:55,  1.39s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:13<00:54,  1.40s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:15<00:53,  1.41s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:16<00:49,  1.34s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:17<00:47,  1.31s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:18<00:42,  1.21s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:19<00:38,  1.13s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:20<00:35,  1.08s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:21<00:35,  1.11s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:23<00:34,  1.12s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:24<00:35,  1.20s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:25<00:37,  1.29s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:27<00:39,  1.40s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:29<00:39,  1.45s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:30<00:37,  1.44s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:32<00:37,  1.48s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:33<00:35,  1.49s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:35<00:34,  1.49s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:36<00:32,  1.47s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:37<00:28,  1.36s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:38<00:26,  1.32s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:40<00:29,  1.53s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:43<00:32,  1.80s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:44<00:28,  1.66s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:45<00:24,  1.51s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:47<00:21,  1.45s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:48<00:18,  1.34s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:49<00:16,  1.29s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:50<00:15,  1.28s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:51<00:13,  1.21s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:52<00:11,  1.14s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:53<00:10,  1.11s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:54<00:08,  1.10s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:55<00:07,  1.10s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:57<00:06,  1.12s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:58<00:05,  1.17s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:59<00:04,  1.14s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:00<00:03,  1.12s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:01<00:02,  1.07s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:03<00:01,  1.26s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:04<00:00,  1.33s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:04<00:00,  1.25s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.018 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.25356
wandb: 
wandb: üöÄ View run youthful-sweep-95 at: https://wandb.ai/xzy11632/dance-dev/runs/cc9rm6na
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_104240-cc9rm6na/logs
wandb: Agent Starting Run: d7lmp6q9 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_104639-d7lmp6q9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rare-sweep-96
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/d7lmp6q9
[INFO][2024-03-16 10:46:45,257][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 10:46:45,376][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 10:46:45,376][dance][wrapped_func] Took 0:00:00.118582 to load and process data.
[INFO][2024-03-16 10:46:45,376][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 10:46:45,378][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 10:46:47,662][dance.WeightedFeatureSVD][__call__] Decomposing train features (7963, 200) (k=16)
[INFO][2024-03-16 10:46:47,662][dance.WeightedFeatureSVD][__call__] Total explained variance: 94.08%
[INFO][2024-03-16 10:46:49,826][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 10:46:49,827][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 10:46:49,827][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 10:46:49,827][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:46,  1.07s/it]  2%|‚ñè         | 2/100 [00:02<01:48,  1.11s/it]  3%|‚ñé         | 3/100 [00:03<01:50,  1.14s/it]  4%|‚ñç         | 4/100 [00:04<01:48,  1.13s/it]  5%|‚ñå         | 5/100 [00:05<01:46,  1.12s/it]  6%|‚ñå         | 6/100 [00:06<01:51,  1.18s/it]  7%|‚ñã         | 7/100 [00:08<01:49,  1.17s/it]  8%|‚ñä         | 8/100 [00:09<01:42,  1.11s/it]  9%|‚ñâ         | 9/100 [00:10<01:55,  1.27s/it] 10%|‚ñà         | 10/100 [00:12<02:21,  1.57s/it] 11%|‚ñà         | 11/100 [00:14<02:07,  1.43s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:56,  1.33s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:54,  1.32s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:52,  1.31s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<01:52,  1.32s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<01:42,  1.22s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:43,  1.25s/it] 18%|‚ñà‚ñä        | 18/100 [00:22<01:38,  1.20s/it] 19%|‚ñà‚ñâ        | 19/100 [00:23<01:35,  1.18s/it] 20%|‚ñà‚ñà        | 20/100 [00:24<01:29,  1.12s/it] 21%|‚ñà‚ñà        | 21/100 [00:25<01:28,  1.12s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:26<01:25,  1.09s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:27<01:21,  1.06s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:28<01:21,  1.08s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:29<01:21,  1.08s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:30<01:18,  1.06s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:32<01:28,  1.21s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:34<01:51,  1.55s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:36<01:44,  1.48s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:37<01:37,  1.40s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:38<01:29,  1.30s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:39<01:20,  1.18s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:40<01:13,  1.10s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:41<01:10,  1.07s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:42<01:11,  1.10s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:43<01:10,  1.11s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:44<01:07,  1.07s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:45<01:11,  1.15s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:46<01:10,  1.15s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:48<01:09,  1.15s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:49<01:09,  1.19s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:50<01:04,  1.11s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:52<01:16,  1.35s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:53<01:16,  1.37s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:55<01:24,  1.53s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:56<01:15,  1.40s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:57<01:08,  1.28s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:58<01:04,  1.25s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:59<01:01,  1.21s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:01<01:00,  1.21s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:02<01:00,  1.23s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:03<01:00,  1.25s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:04<00:55,  1.18s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:05<00:53,  1.17s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:07<00:53,  1.18s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:08<00:53,  1.21s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:09<00:50,  1.17s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:10<00:48,  1.15s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:11<00:45,  1.10s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:12<00:43,  1.08s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:14<00:48,  1.26s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:16<00:56,  1.50s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:17<00:51,  1.39s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:18<00:46,  1.29s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:19<00:42,  1.21s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:20<00:40,  1.18s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:21<00:38,  1.15s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:22<00:36,  1.14s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:23<00:35,  1.13s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:25<00:34,  1.16s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:26<00:32,  1.14s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:27<00:31,  1.13s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:28<00:30,  1.11s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:29<00:29,  1.12s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:30<00:28,  1.15s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:31<00:27,  1.16s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:32<00:25,  1.09s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:34<00:26,  1.21s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:35<00:27,  1.31s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:37<00:28,  1.42s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:38<00:24,  1.31s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:39<00:22,  1.26s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:40<00:20,  1.19s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:41<00:18,  1.14s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:42<00:16,  1.10s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:43<00:15,  1.10s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:45<00:14,  1.10s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:46<00:13,  1.14s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:47<00:12,  1.14s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:48<00:11,  1.13s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:49<00:10,  1.13s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:51<00:10,  1.27s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:53<00:10,  1.51s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:55<00:09,  1.62s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:56<00:07,  1.60s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:57<00:05,  1.40s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:58<00:03,  1.31s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:59<00:02,  1.23s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:00<00:01,  1.20s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:02<00:00,  1.20s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:02<00:00,  1.22s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.018 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.28021
wandb: 
wandb: üöÄ View run rare-sweep-96 at: https://wandb.ai/xzy11632/dance-dev/runs/d7lmp6q9
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_104639-d7lmp6q9/logs
wandb: Agent Starting Run: 6hovstce with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_105015-6hovstce
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run daily-sweep-97
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/6hovstce
[INFO][2024-03-16 10:50:20,137][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 10:50:20,229][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 10:50:20,229][dance][wrapped_func] Took 0:00:00.084050 to load and process data.
[INFO][2024-03-16 10:50:20,229][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 10:50:20,232][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 10:50:20,248][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[WARNING][2024-03-16 10:51:22,038][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 10:51:30,565][dance.WeightedFeaturePCA][__call__] Decomposing train features (7963, 980) (k=544)
[INFO][2024-03-16 10:51:30,574][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.02%
[INFO][2024-03-16 10:51:40,089][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 10:51:40,090][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 10:51:40,090][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 10:51:40,090][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:03<05:30,  3.34s/it]  2%|‚ñè         | 2/100 [00:05<04:37,  2.83s/it]  3%|‚ñé         | 3/100 [00:07<03:39,  2.27s/it]  4%|‚ñç         | 4/100 [00:09<03:46,  2.36s/it]  5%|‚ñå         | 5/100 [00:13<04:14,  2.68s/it]  6%|‚ñå         | 6/100 [00:14<03:30,  2.24s/it]  7%|‚ñã         | 7/100 [00:16<03:06,  2.01s/it]  8%|‚ñä         | 8/100 [00:17<02:52,  1.88s/it]  9%|‚ñâ         | 9/100 [00:19<02:43,  1.80s/it] 10%|‚ñà         | 10/100 [00:20<02:35,  1.73s/it] 11%|‚ñà         | 11/100 [00:22<02:36,  1.76s/it] 12%|‚ñà‚ñè        | 12/100 [00:24<02:29,  1.70s/it] 13%|‚ñà‚ñé        | 13/100 [00:26<02:34,  1.78s/it] 14%|‚ñà‚ñç        | 14/100 [00:28<02:35,  1.81s/it] 15%|‚ñà‚ñå        | 15/100 [00:29<02:26,  1.72s/it] 16%|‚ñà‚ñå        | 16/100 [00:32<02:50,  2.03s/it] 17%|‚ñà‚ñã        | 17/100 [00:34<03:00,  2.17s/it] 18%|‚ñà‚ñä        | 18/100 [00:36<02:43,  2.00s/it] 19%|‚ñà‚ñâ        | 19/100 [00:38<02:33,  1.89s/it] 20%|‚ñà‚ñà        | 20/100 [00:39<02:27,  1.84s/it] 21%|‚ñà‚ñà        | 21/100 [00:41<02:17,  1.74s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:43<02:17,  1.77s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:44<02:15,  1.76s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:46<02:06,  1.67s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:47<02:00,  1.60s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:49<01:58,  1.60s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:50<01:47,  1.48s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:52<02:02,  1.70s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:55<02:31,  2.14s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:57<02:17,  1.97s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:58<02:03,  1.79s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:00<01:53,  1.67s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:01<01:44,  1.56s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:02<01:36,  1.47s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:04<01:35,  1.47s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:06<01:40,  1.58s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:08<01:52,  1.79s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:10<01:53,  1.83s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:12<01:54,  1.88s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:13<01:44,  1.74s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:16<01:54,  1.93s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:18<02:06,  2.19s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:20<01:46,  1.87s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:21<01:34,  1.68s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:22<01:26,  1.58s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:23<01:19,  1.47s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:25<01:15,  1.43s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:26<01:11,  1.37s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:27<01:08,  1.35s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:29<01:07,  1.36s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:30<01:08,  1.40s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:31<01:06,  1.39s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:33<01:05,  1.40s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:34<01:00,  1.31s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:35<00:57,  1.28s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:38<01:09,  1.59s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:40<01:20,  1.88s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:42<01:13,  1.75s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:43<01:04,  1.57s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:46<01:24,  2.12s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:48<01:24,  2.15s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:50<01:18,  2.07s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:52<01:11,  1.94s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:53<01:02,  1.73s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:54<00:55,  1.57s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:56<00:50,  1.49s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:57<00:46,  1.41s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:58<00:42,  1.32s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:00<00:50,  1.64s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:02<00:53,  1.78s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:06<01:06,  2.29s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:09<01:11,  2.55s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:13<01:17,  2.88s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:19<01:42,  3.93s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:24<01:49,  4.38s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:30<01:55,  4.82s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:36<01:56,  5.07s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:41<01:52,  5.13s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:45<01:41,  4.81s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:49<01:31,  4.58s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:53<01:22,  4.35s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:57<01:15,  4.18s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [03:00<01:04,  3.78s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [03:03<00:59,  3.71s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [03:07<00:53,  3.58s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [03:08<00:41,  2.99s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [03:10<00:33,  2.55s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [03:11<00:27,  2.30s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [03:13<00:22,  2.02s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [03:15<00:19,  1.94s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [03:16<00:16,  1.85s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [03:18<00:14,  1.79s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [03:20<00:12,  1.79s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [03:21<00:10,  1.78s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [03:23<00:08,  1.71s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [03:26<00:08,  2.11s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [03:28<00:06,  2.17s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [03:30<00:04,  2.02s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [03:32<00:01,  1.90s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:33<00:00,  1.79s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:33<00:00,  2.14s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.27322
wandb: 
wandb: üöÄ View run daily-sweep-97 at: https://wandb.ai/xzy11632/dance-dev/runs/6hovstce
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_105015-6hovstce/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 4uu1hk7y with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_105653-4uu1hk7y
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run frosty-sweep-98
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/4uu1hk7y
[INFO][2024-03-16 10:56:58,150][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 10:56:58,229][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 10:56:58,230][dance][wrapped_func] Took 0:00:00.079408 to load and process data.
[INFO][2024-03-16 10:56:58,230][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 10:56:58,232][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 10:56:58,249][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[WARNING][2024-03-16 10:58:03,521][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 10:58:38,487][dance.WeightedFeatureSVD][__call__] Decomposing train features (7963, 980) (k=550)
[INFO][2024-03-16 10:58:38,490][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.99%
[INFO][2024-03-16 10:58:44,142][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 10:58:44,143][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 10:58:44,143][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 10:58:44,143][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:09,  1.31s/it]  2%|‚ñè         | 2/100 [00:04<03:28,  2.13s/it]  3%|‚ñé         | 3/100 [00:06<03:41,  2.28s/it]  4%|‚ñç         | 4/100 [00:07<03:03,  1.91s/it]  5%|‚ñå         | 5/100 [00:09<02:47,  1.76s/it]  6%|‚ñå         | 6/100 [00:10<02:25,  1.55s/it]  7%|‚ñã         | 7/100 [00:11<02:12,  1.43s/it]  8%|‚ñä         | 8/100 [00:14<02:43,  1.78s/it]  9%|‚ñâ         | 9/100 [00:16<02:51,  1.89s/it] 10%|‚ñà         | 10/100 [00:17<02:36,  1.74s/it] 11%|‚ñà         | 11/100 [00:20<02:56,  1.99s/it] 12%|‚ñà‚ñè        | 12/100 [00:24<03:51,  2.63s/it] 13%|‚ñà‚ñé        | 13/100 [00:28<04:27,  3.07s/it] 14%|‚ñà‚ñç        | 14/100 [00:31<04:31,  3.15s/it] 15%|‚ñà‚ñå        | 15/100 [00:33<03:51,  2.72s/it] 16%|‚ñà‚ñå        | 16/100 [00:35<03:30,  2.51s/it] 17%|‚ñà‚ñã        | 17/100 [00:38<03:52,  2.80s/it] 18%|‚ñà‚ñä        | 18/100 [00:40<03:22,  2.47s/it] 19%|‚ñà‚ñâ        | 19/100 [00:42<03:00,  2.23s/it] 20%|‚ñà‚ñà        | 20/100 [00:44<02:48,  2.11s/it] 21%|‚ñà‚ñà        | 21/100 [00:45<02:31,  1.92s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:47<02:29,  1.92s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:49<02:21,  1.84s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:51<02:18,  1.83s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:52<02:10,  1.74s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:54<02:08,  1.74s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:55<02:00,  1.65s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:58<02:21,  1.97s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [01:01<02:38,  2.24s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [01:02<02:23,  2.05s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [01:04<02:09,  1.88s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:06<02:03,  1.81s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:07<01:52,  1.67s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:08<01:44,  1.58s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:10<01:43,  1.59s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:12<01:43,  1.62s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:13<01:46,  1.69s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:15<01:51,  1.79s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:17<01:45,  1.73s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:18<01:37,  1.62s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:21<01:46,  1.80s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:23<02:02,  2.11s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:25<01:47,  1.89s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:26<01:36,  1.73s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:28<01:30,  1.64s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:29<01:23,  1.55s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:32<01:50,  2.09s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:36<02:17,  2.65s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:39<02:16,  2.68s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:42<02:15,  2.72s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:43<01:52,  2.31s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:45<01:37,  2.03s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:46<01:25,  1.82s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:48<01:29,  1.94s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:52<01:47,  2.39s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:53<01:30,  2.06s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:54<01:18,  1.83s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:55<01:09,  1.66s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:57<01:03,  1.54s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:58<00:59,  1.48s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [02:00<00:58,  1.51s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [02:01<00:58,  1.54s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [02:03<00:59,  1.61s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [02:04<00:56,  1.58s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [02:06<00:56,  1.61s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [02:08<00:54,  1.61s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [02:09<00:49,  1.51s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [02:11<00:53,  1.67s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:14<01:00,  1.96s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:15<00:53,  1.77s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:16<00:48,  1.66s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:18<00:48,  1.74s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:20<00:46,  1.71s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:21<00:42,  1.63s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:23<00:39,  1.58s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:24<00:37,  1.58s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:26<00:39,  1.70s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:31<00:53,  2.44s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:34<00:54,  2.61s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:35<00:44,  2.23s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:38<00:44,  2.36s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:40<00:44,  2.47s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:42<00:36,  2.12s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:43<00:30,  1.91s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:45<00:26,  1.77s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:46<00:23,  1.68s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:47<00:20,  1.61s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:49<00:18,  1.51s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:50<00:16,  1.54s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:52<00:15,  1.58s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:54<00:14,  1.57s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:55<00:12,  1.61s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:57<00:10,  1.51s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:58<00:08,  1.47s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [03:00<00:08,  1.75s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [03:04<00:08,  2.23s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [03:06<00:07,  2.37s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [03:09<00:04,  2.49s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [03:11<00:02,  2.26s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:13<00:00,  2.13s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:13<00:00,  1.93s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.2844
wandb: 
wandb: üöÄ View run frosty-sweep-98 at: https://wandb.ai/xzy11632/dance-dev/runs/4uu1hk7y
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_105653-4uu1hk7y/logs
wandb: Agent Starting Run: cug9n05r with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_110337-cug9n05r
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run breezy-sweep-99
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/cug9n05r
[INFO][2024-03-16 11:03:42,604][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 11:03:42,697][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 11:03:42,697][dance][wrapped_func] Took 0:00:00.092232 to load and process data.
[INFO][2024-03-16 11:03:42,697][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 11:03:42,699][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 11:05:02,768][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run breezy-sweep-99 at: https://wandb.ai/xzy11632/dance-dev/runs/cug9n05r
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_110337-cug9n05r/logs
wandb: ERROR Run cug9n05r errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1020) out of bounds (980)
wandb: ERROR 
wandb: Agent Starting Run: tkm7exhi with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_110523-tkm7exhi
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run winter-sweep-100
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/tkm7exhi
[INFO][2024-03-16 11:05:30,690][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 11:05:30,792][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 11:05:30,792][dance][wrapped_func] Took 0:00:00.102271 to load and process data.
[INFO][2024-03-16 11:05:30,793][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 11:05:30,796][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 11:06:54,913][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run winter-sweep-100 at: https://wandb.ai/xzy11632/dance-dev/runs/tkm7exhi
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_110523-tkm7exhi/logs
wandb: ERROR Run tkm7exhi errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1020) out of bounds (980)
wandb: ERROR 
wandb: Agent Starting Run: 1ovzahmh with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_110710-1ovzahmh
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run atomic-sweep-101
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/1ovzahmh
[INFO][2024-03-16 11:07:17,135][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 11:07:17,250][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 11:07:17,250][dance][wrapped_func] Took 0:00:00.115074 to load and process data.
[INFO][2024-03-16 11:07:17,251][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 11:07:17,253][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-16 11:09:03,479][dance.WeightedFeaturePCA][__call__] Decomposing train features (7963, 200) (k=78)
[INFO][2024-03-16 11:09:03,480][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.13%
[INFO][2024-03-16 11:14:27,250][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 11:14:27,251][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 11:14:27,251][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 11:14:27,252][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:19,  1.41s/it]  2%|‚ñè         | 2/100 [00:02<02:02,  1.25s/it]  3%|‚ñé         | 3/100 [00:03<01:53,  1.17s/it]  4%|‚ñç         | 4/100 [00:04<01:51,  1.16s/it]  5%|‚ñå         | 5/100 [00:05<01:51,  1.17s/it]  6%|‚ñå         | 6/100 [00:07<01:52,  1.20s/it]  7%|‚ñã         | 7/100 [00:08<01:51,  1.20s/it]  8%|‚ñä         | 8/100 [00:09<01:47,  1.16s/it]  9%|‚ñâ         | 9/100 [00:11<02:00,  1.32s/it] 10%|‚ñà         | 10/100 [00:12<01:58,  1.31s/it] 11%|‚ñà         | 11/100 [00:14<02:17,  1.54s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<02:07,  1.45s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:57,  1.36s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:49,  1.28s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<01:42,  1.21s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<01:38,  1.17s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:35,  1.15s/it] 18%|‚ñà‚ñä        | 18/100 [00:22<01:32,  1.13s/it] 19%|‚ñà‚ñâ        | 19/100 [00:23<01:34,  1.17s/it] 20%|‚ñà‚ñà        | 20/100 [00:24<01:35,  1.20s/it] 21%|‚ñà‚ñà        | 21/100 [00:25<01:31,  1.15s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:26<01:27,  1.12s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:28<01:27,  1.14s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:29<01:27,  1.15s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:30<01:27,  1.16s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:31<01:23,  1.12s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:33<01:35,  1.30s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:35<01:53,  1.57s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:36<01:43,  1.45s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:37<01:33,  1.34s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:38<01:30,  1.31s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:40<01:24,  1.25s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:41<01:19,  1.19s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:42<01:15,  1.15s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:43<01:12,  1.11s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:44<01:09,  1.08s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:45<01:06,  1.06s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:46<01:05,  1.06s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:47<01:06,  1.09s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:48<01:07,  1.13s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:49<01:06,  1.12s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:50<01:06,  1.14s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:52<01:04,  1.13s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:53<01:01,  1.10s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:54<01:12,  1.32s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:56<01:18,  1.46s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:58<01:16,  1.44s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:59<01:09,  1.34s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:00<01:04,  1.25s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:01<00:59,  1.19s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:02<00:56,  1.15s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:03<00:55,  1.16s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:04<00:53,  1.14s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:05<00:51,  1.12s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:06<00:49,  1.10s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:07<00:48,  1.11s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:09<00:49,  1.15s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:10<00:48,  1.15s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:11<00:47,  1.16s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:12<00:45,  1.13s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:13<00:45,  1.15s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:14<00:42,  1.11s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:15<00:39,  1.08s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:16<00:38,  1.08s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:18<00:47,  1.36s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:20<00:53,  1.56s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:21<00:46,  1.41s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:22<00:41,  1.29s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:23<00:37,  1.22s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:25<00:35,  1.20s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:26<00:33,  1.16s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:27<00:31,  1.12s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:28<00:29,  1.10s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:29<00:28,  1.08s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:30<00:27,  1.08s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:31<00:26,  1.11s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:32<00:26,  1.13s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:33<00:25,  1.14s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:35<00:24,  1.16s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:36<00:22,  1.13s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:37<00:21,  1.11s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:38<00:21,  1.22s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:39<00:20,  1.22s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:41<00:22,  1.41s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:42<00:19,  1.30s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:43<00:17,  1.22s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:44<00:14,  1.15s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:46<00:13,  1.16s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:47<00:12,  1.15s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:48<00:11,  1.16s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:49<00:10,  1.11s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:50<00:08,  1.12s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:51<00:08,  1.15s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:52<00:07,  1.17s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:54<00:06,  1.21s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:55<00:04,  1.18s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:56<00:03,  1.18s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:58<00:02,  1.34s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:00<00:01,  1.61s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:01<00:00,  1.45s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:01<00:00,  1.22s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.30646
wandb: 
wandb: üöÄ View run atomic-sweep-101 at: https://wandb.ai/xzy11632/dance-dev/runs/1ovzahmh
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_110710-1ovzahmh/logs
wandb: Agent Starting Run: cumycnl9 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_111904-cumycnl9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run twilight-sweep-102
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/cumycnl9
[INFO][2024-03-16 11:19:10,046][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 11:19:10,149][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 11:19:10,150][dance][wrapped_func] Took 0:00:00.103121 to load and process data.
[INFO][2024-03-16 11:19:10,150][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 11:19:10,152][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-16 11:20:31,110][dance.WeightedFeatureSVD][__call__] Decomposing train features (7963, 200) (k=75)
[INFO][2024-03-16 11:20:31,125][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.55%
[INFO][2024-03-16 11:20:35,200][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 11:20:35,200][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 11:20:35,200][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 11:20:35,201][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:02,  1.24s/it]  2%|‚ñè         | 2/100 [00:02<01:58,  1.21s/it]  3%|‚ñé         | 3/100 [00:03<01:56,  1.20s/it]  4%|‚ñç         | 4/100 [00:04<01:51,  1.16s/it]  5%|‚ñå         | 5/100 [00:05<01:49,  1.15s/it]  6%|‚ñå         | 6/100 [00:07<01:51,  1.18s/it]  7%|‚ñã         | 7/100 [00:08<01:47,  1.15s/it]  8%|‚ñä         | 8/100 [00:09<02:05,  1.36s/it]  9%|‚ñâ         | 9/100 [00:12<02:32,  1.68s/it] 10%|‚ñà         | 10/100 [00:13<02:16,  1.51s/it] 11%|‚ñà         | 11/100 [00:14<02:00,  1.35s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:50,  1.25s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:40,  1.16s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:36,  1.12s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:34,  1.11s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:30,  1.07s/it] 17%|‚ñà‚ñã        | 17/100 [00:20<01:28,  1.07s/it] 18%|‚ñà‚ñä        | 18/100 [00:21<01:27,  1.07s/it] 19%|‚ñà‚ñâ        | 19/100 [00:22<01:28,  1.10s/it] 20%|‚ñà‚ñà        | 20/100 [00:23<01:26,  1.09s/it] 21%|‚ñà‚ñà        | 21/100 [00:25<01:26,  1.10s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:26<01:27,  1.12s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:27<01:26,  1.12s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:28<01:26,  1.13s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:29<01:21,  1.08s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:30<01:27,  1.18s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:32<01:29,  1.22s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:34<01:44,  1.45s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:35<01:34,  1.33s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:36<01:27,  1.25s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:37<01:26,  1.25s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:38<01:18,  1.16s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:39<01:14,  1.11s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:40<01:09,  1.06s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:41<01:06,  1.02s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:42<01:07,  1.05s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:43<01:06,  1.05s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:44<01:05,  1.06s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:45<01:06,  1.09s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:46<01:03,  1.06s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:47<01:03,  1.08s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:49<01:12,  1.24s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:50<01:12,  1.27s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:52<01:23,  1.49s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:53<01:14,  1.36s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:54<01:08,  1.28s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:55<01:02,  1.19s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:57<01:00,  1.16s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:58<00:58,  1.15s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:59<00:57,  1.14s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:00<00:53,  1.10s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:01<00:54,  1.13s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:02<00:54,  1.17s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:03<00:54,  1.18s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:05<00:54,  1.20s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:06<00:54,  1.24s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:07<00:51,  1.20s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:08<00:47,  1.14s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:09<00:45,  1.12s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:10<00:42,  1.07s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:11<00:39,  1.02s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:13<00:47,  1.25s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:15<00:56,  1.53s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:16<00:49,  1.39s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:17<00:44,  1.28s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:18<00:40,  1.18s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:19<00:37,  1.14s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:20<00:35,  1.11s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:21<00:34,  1.11s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:22<00:33,  1.13s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:24<00:32,  1.14s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:26<00:40,  1.45s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:28<00:43,  1.62s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:30<00:45,  1.73s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:33<00:55,  2.23s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:37<01:02,  2.59s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:40<01:08,  2.96s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:43<01:03,  2.90s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:48<01:09,  3.31s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:51<01:06,  3.33s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:53<00:53,  2.83s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:57<01:00,  3.38s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:00<00:53,  3.16s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:05<00:59,  3.75s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:10<01:00,  4.06s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:14<00:56,  4.04s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:15<00:40,  3.13s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:16<00:29,  2.49s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:17<00:22,  2.04s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:18<00:17,  1.76s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:20<00:17,  1.92s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:22<00:15,  1.88s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:24<00:13,  1.88s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:25<00:10,  1.71s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:26<00:07,  1.54s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:27<00:05,  1.38s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:28<00:03,  1.26s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:29<00:02,  1.17s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:30<00:01,  1.18s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:31<00:00,  1.13s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:31<00:00,  1.52s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.021 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.31095
wandb: 
wandb: üöÄ View run twilight-sweep-102 at: https://wandb.ai/xzy11632/dance-dev/runs/cumycnl9
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_111904-cumycnl9/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: f7vdiga0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_112632-f7vdiga0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wild-sweep-103
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/f7vdiga0
[INFO][2024-03-16 11:26:38,984][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 11:26:39,084][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 11:26:39,084][dance][wrapped_func] Took 0:00:00.099302 to load and process data.
[INFO][2024-03-16 11:26:39,085][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 11:26:39,088][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-16 11:27:52,766][dance.WeightedFeaturePCA][__call__] Decomposing train features (7963, 258) (k=211)
[INFO][2024-03-16 11:27:52,768][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.14%
[INFO][2024-03-16 11:28:05,713][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 11:28:05,714][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 11:28:05,715][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 11:28:05,715][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:23,  1.45s/it]  2%|‚ñè         | 2/100 [00:02<02:09,  1.32s/it]  3%|‚ñé         | 3/100 [00:03<02:05,  1.30s/it]  4%|‚ñç         | 4/100 [00:05<02:04,  1.30s/it]  5%|‚ñå         | 5/100 [00:06<01:59,  1.25s/it]  6%|‚ñå         | 6/100 [00:07<01:56,  1.24s/it]  7%|‚ñã         | 7/100 [00:08<01:58,  1.27s/it]  8%|‚ñä         | 8/100 [00:10<02:01,  1.32s/it]  9%|‚ñâ         | 9/100 [00:11<01:59,  1.31s/it] 10%|‚ñà         | 10/100 [00:12<01:56,  1.29s/it] 11%|‚ñà         | 11/100 [00:14<01:54,  1.29s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:50,  1.26s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<02:15,  1.56s/it] 14%|‚ñà‚ñç        | 14/100 [00:20<02:35,  1.80s/it] 15%|‚ñà‚ñå        | 15/100 [00:21<02:18,  1.63s/it] 16%|‚ñà‚ñå        | 16/100 [00:22<02:06,  1.51s/it] 17%|‚ñà‚ñã        | 17/100 [00:23<01:54,  1.38s/it] 18%|‚ñà‚ñä        | 18/100 [00:24<01:48,  1.32s/it] 19%|‚ñà‚ñâ        | 19/100 [00:26<01:46,  1.31s/it] 20%|‚ñà‚ñà        | 20/100 [00:27<01:41,  1.27s/it] 21%|‚ñà‚ñà        | 21/100 [00:28<01:39,  1.26s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:29<01:36,  1.23s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:30<01:35,  1.24s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:32<01:35,  1.25s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:33<01:34,  1.27s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:34<01:35,  1.29s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:35<01:30,  1.25s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:36<01:25,  1.19s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:38<01:22,  1.17s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:40<01:42,  1.47s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:42<01:59,  1.74s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:43<01:45,  1.55s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:44<01:35,  1.42s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:46<01:29,  1.35s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:47<01:23,  1.29s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:48<01:19,  1.24s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:49<01:18,  1.24s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:51<01:20,  1.30s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:52<01:20,  1.33s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:02<03:56,  3.95s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:10<05:04,  5.16s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:19<06:04,  6.29s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:23<05:20,  5.62s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:33<06:34,  7.04s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:44<07:29,  8.16s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:48<06:03,  6.74s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:52<05:14,  5.94s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:55<04:26,  5.12s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:57<03:35,  4.23s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:59<02:52,  3.46s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [02:00<02:15,  2.78s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [02:01<01:49,  2.29s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [02:02<01:37,  2.07s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [02:04<01:22,  1.79s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [02:05<01:12,  1.61s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [02:06<01:02,  1.43s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [02:07<00:55,  1.29s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [02:08<00:59,  1.41s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [02:11<01:14,  1.83s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [02:12<01:03,  1.59s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [02:13<00:54,  1.41s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [02:14<00:48,  1.28s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [02:15<00:44,  1.20s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [02:16<00:40,  1.13s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [02:17<00:39,  1.12s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [02:18<00:36,  1.09s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [02:19<00:34,  1.05s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [02:20<00:33,  1.05s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:22<00:33,  1.09s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:23<00:33,  1.13s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:24<00:33,  1.14s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:25<00:33,  1.18s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:28<00:42,  1.59s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:30<00:48,  1.87s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:31<00:40,  1.64s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:33<00:35,  1.49s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:34<00:31,  1.36s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:35<00:28,  1.29s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:36<00:26,  1.26s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:37<00:23,  1.18s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:38<00:22,  1.16s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:39<00:20,  1.12s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:40<00:19,  1.16s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:42<00:18,  1.18s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:43<00:18,  1.22s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:44<00:16,  1.21s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:45<00:15,  1.20s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:47<00:14,  1.24s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:48<00:13,  1.19s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:49<00:13,  1.40s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:52<00:14,  1.65s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:53<00:11,  1.47s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:54<00:09,  1.35s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:55<00:07,  1.25s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:56<00:05,  1.19s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:57<00:04,  1.18s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:58<00:03,  1.16s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:59<00:02,  1.12s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [03:00<00:01,  1.08s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:01<00:00,  1.08s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:01<00:00,  1.82s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.21237
wandb: 
wandb: üöÄ View run wild-sweep-103 at: https://wandb.ai/xzy11632/dance-dev/runs/f7vdiga0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_112632-f7vdiga0/logs
wandb: Agent Starting Run: 78fzma68 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_113400-78fzma68
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dashing-sweep-104
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/78fzma68
[INFO][2024-03-16 11:34:05,772][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 11:34:05,872][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 11:34:05,872][dance][wrapped_func] Took 0:00:00.100083 to load and process data.
[INFO][2024-03-16 11:34:05,873][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 11:34:05,875][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-16 11:35:21,668][dance.WeightedFeatureSVD][__call__] Decomposing train features (7963, 258) (k=211)
[INFO][2024-03-16 11:35:21,674][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.60%
[INFO][2024-03-16 11:35:24,465][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 11:35:24,465][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 11:35:24,466][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 11:35:24,466][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:28,  1.50s/it]  2%|‚ñè         | 2/100 [00:03<02:32,  1.55s/it]  3%|‚ñé         | 3/100 [00:04<02:19,  1.44s/it]  4%|‚ñç         | 4/100 [00:06<02:31,  1.57s/it]  5%|‚ñå         | 5/100 [00:08<02:49,  1.78s/it]  6%|‚ñå         | 6/100 [00:10<02:49,  1.81s/it]  7%|‚ñã         | 7/100 [00:11<02:33,  1.65s/it]  8%|‚ñä         | 8/100 [00:12<02:23,  1.56s/it]  9%|‚ñâ         | 9/100 [00:14<02:17,  1.51s/it] 10%|‚ñà         | 10/100 [00:15<02:08,  1.43s/it] 11%|‚ñà         | 11/100 [00:17<02:20,  1.57s/it] 12%|‚ñà‚ñè        | 12/100 [00:19<02:32,  1.73s/it] 13%|‚ñà‚ñé        | 13/100 [00:21<02:24,  1.66s/it] 14%|‚ñà‚ñç        | 14/100 [00:22<02:21,  1.65s/it] 15%|‚ñà‚ñå        | 15/100 [00:24<02:13,  1.57s/it] 16%|‚ñà‚ñå        | 16/100 [00:25<02:12,  1.58s/it] 17%|‚ñà‚ñã        | 17/100 [00:27<02:11,  1.58s/it] 18%|‚ñà‚ñä        | 18/100 [00:28<02:06,  1.54s/it] 19%|‚ñà‚ñâ        | 19/100 [00:30<02:16,  1.68s/it] 20%|‚ñà‚ñà        | 20/100 [00:32<02:26,  1.83s/it] 21%|‚ñà‚ñà        | 21/100 [00:34<02:25,  1.84s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:36<02:10,  1.68s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:37<02:02,  1.59s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:38<01:55,  1.52s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:40<01:52,  1.49s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:41<01:50,  1.50s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:42<01:44,  1.44s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:44<01:42,  1.42s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:45<01:44,  1.48s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:48<01:57,  1.67s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:51<02:39,  2.30s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:53<02:15,  2.00s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:54<02:02,  1.83s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:55<01:50,  1.68s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:57<01:56,  1.79s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:00<02:14,  2.10s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:02<01:55,  1.84s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:03<01:42,  1.65s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:04<01:32,  1.52s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:05<01:24,  1.41s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:06<01:18,  1.33s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:07<01:15,  1.30s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:09<01:12,  1.28s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:10<01:09,  1.25s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:11<01:08,  1.25s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:12<01:08,  1.27s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:14<01:06,  1.25s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:15<01:07,  1.30s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:17<01:10,  1.38s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:18<01:06,  1.33s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:20<01:11,  1.46s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:22<01:22,  1.72s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:23<01:11,  1.52s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:24<01:03,  1.39s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:25<00:58,  1.31s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:26<00:54,  1.23s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:27<00:52,  1.22s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:29<00:50,  1.20s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:30<00:47,  1.15s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:31<00:45,  1.14s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:32<00:45,  1.17s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:33<00:44,  1.17s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:34<00:44,  1.21s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:37<00:56,  1.57s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:41<01:21,  2.34s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:45<01:36,  2.83s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:47<01:26,  2.63s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:48<01:11,  2.24s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:50<01:00,  1.95s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:51<00:51,  1.72s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:52<00:44,  1.54s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:53<00:40,  1.43s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:54<00:37,  1.37s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:56<00:36,  1.40s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:57<00:35,  1.41s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:00<00:40,  1.69s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:11<01:45,  4.58s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:22<02:25,  6.62s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:25<01:54,  5.44s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:34<02:12,  6.61s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:43<02:18,  7.30s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:51<02:15,  7.55s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:56<01:52,  6.64s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:57<01:20,  5.06s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [03:00<01:05,  4.35s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [03:02<00:50,  3.62s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [03:03<00:38,  2.99s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [03:06<00:33,  2.77s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [03:08<00:28,  2.55s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [03:10<00:24,  2.49s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [03:12<00:21,  2.39s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [03:14<00:18,  2.28s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [03:17<00:16,  2.30s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [03:18<00:12,  2.07s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [03:20<00:10,  2.05s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [03:23<00:09,  2.33s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [03:25<00:06,  2.06s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [03:26<00:03,  1.82s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [03:27<00:01,  1.67s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:28<00:00,  1.51s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:28<00:00,  2.09s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.2399
wandb: 
wandb: üöÄ View run dashing-sweep-104 at: https://wandb.ai/xzy11632/dance-dev/runs/78fzma68
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_113400-78fzma68/logs
wandb: Agent Starting Run: kna2z9v1 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_114232-kna2z9v1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run electric-sweep-105
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/kna2z9v1
[INFO][2024-03-16 11:42:39,438][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 11:42:39,532][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 11:42:39,532][dance][wrapped_func] Took 0:00:00.094160 to load and process data.
[INFO][2024-03-16 11:42:39,532][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 11:42:39,534][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-16 11:43:46,066][dance.WeightedFeaturePCA][__call__] Decomposing train features (7963, 200) (k=142)
[INFO][2024-03-16 11:43:46,067][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.07%
[INFO][2024-03-16 11:43:48,818][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 11:43:48,819][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 11:43:48,819][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 11:43:48,819][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:52,  1.13s/it]  2%|‚ñè         | 2/100 [00:03<02:38,  1.61s/it]  3%|‚ñé         | 3/100 [00:06<03:39,  2.26s/it]  4%|‚ñç         | 4/100 [00:07<03:00,  1.88s/it]  5%|‚ñå         | 5/100 [00:08<02:42,  1.71s/it]  6%|‚ñå         | 6/100 [00:10<02:24,  1.53s/it]  7%|‚ñã         | 7/100 [00:11<02:17,  1.48s/it]  8%|‚ñä         | 8/100 [00:12<02:11,  1.43s/it]  9%|‚ñâ         | 9/100 [00:13<02:05,  1.38s/it] 10%|‚ñà         | 10/100 [00:15<02:00,  1.34s/it] 11%|‚ñà         | 11/100 [00:16<02:00,  1.35s/it] 12%|‚ñà‚ñè        | 12/100 [00:17<01:57,  1.33s/it] 13%|‚ñà‚ñé        | 13/100 [00:19<01:58,  1.36s/it] 14%|‚ñà‚ñç        | 14/100 [00:20<01:50,  1.28s/it] 15%|‚ñà‚ñå        | 15/100 [00:21<01:42,  1.21s/it] 16%|‚ñà‚ñå        | 16/100 [00:23<02:04,  1.49s/it] 17%|‚ñà‚ñã        | 17/100 [00:25<02:17,  1.66s/it] 18%|‚ñà‚ñä        | 18/100 [00:26<02:03,  1.50s/it] 19%|‚ñà‚ñâ        | 19/100 [00:28<01:55,  1.43s/it] 20%|‚ñà‚ñà        | 20/100 [00:29<01:46,  1.33s/it] 21%|‚ñà‚ñà        | 21/100 [00:30<01:40,  1.28s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:31<01:37,  1.25s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:32<01:35,  1.24s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:34<01:42,  1.35s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:35<01:46,  1.42s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:37<01:42,  1.38s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:38<01:44,  1.43s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:39<01:38,  1.37s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:41<01:33,  1.32s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:42<01:30,  1.29s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:44<01:50,  1.60s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:47<02:12,  1.94s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:50<02:33,  2.29s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:52<02:23,  2.18s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:54<02:12,  2.04s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:55<02:00,  1.88s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:56<01:46,  1.69s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:58<01:41,  1.63s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:59<01:35,  1.56s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:01<01:35,  1.59s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:02<01:29,  1.51s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:04<01:24,  1.46s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:06<01:36,  1.69s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:09<01:50,  1.97s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:10<01:37,  1.77s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:11<01:25,  1.59s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:12<01:20,  1.51s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:14<01:15,  1.45s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:15<01:13,  1.45s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:16<01:10,  1.41s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:17<01:04,  1.32s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:19<01:05,  1.36s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:20<01:03,  1.35s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:21<01:00,  1.31s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:23<01:01,  1.36s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:24<00:56,  1.29s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:26<01:00,  1.40s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:29<01:15,  1.81s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:30<01:06,  1.62s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:31<00:59,  1.48s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:32<00:53,  1.38s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:33<00:49,  1.30s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:34<00:45,  1.24s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:35<00:42,  1.19s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:36<00:40,  1.15s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:38<00:39,  1.17s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:39<00:39,  1.21s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:40<00:38,  1.21s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:41<00:37,  1.21s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:42<00:35,  1.19s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:44<00:36,  1.24s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:45<00:34,  1.23s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:57<02:02,  4.53s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:07<02:35,  5.96s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:13<02:32,  6.11s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:19<02:23,  5.97s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:28<02:38,  6.90s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:36<02:42,  7.39s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:45<02:44,  7.83s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:48<02:04,  6.23s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:50<01:37,  5.11s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:54<01:23,  4.65s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:57<01:13,  4.30s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [03:01<01:04,  4.06s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [03:04<00:57,  3.81s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [03:07<00:51,  3.65s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [03:10<00:43,  3.38s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [03:13<00:39,  3.29s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [03:16<00:36,  3.29s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [03:20<00:34,  3.46s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [03:25<00:34,  3.86s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [03:28<00:28,  3.61s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [03:31<00:23,  3.41s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [03:34<00:19,  3.25s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [03:37<00:15,  3.17s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [03:40<00:12,  3.09s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [03:43<00:09,  3.10s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [03:46<00:06,  3.04s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [03:49<00:03,  3.05s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:51<00:00,  2.81s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:51<00:00,  2.31s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.29568
wandb: 
wandb: üöÄ View run electric-sweep-105 at: https://wandb.ai/xzy11632/dance-dev/runs/kna2z9v1
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_114232-kna2z9v1/logs
wandb: Agent Starting Run: k8c49q22 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_115001-k8c49q22
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run feasible-sweep-106
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/k8c49q22
[INFO][2024-03-16 11:50:06,949][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 11:50:07,048][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 11:50:07,049][dance][wrapped_func] Took 0:00:00.098441 to load and process data.
[INFO][2024-03-16 11:50:07,049][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 11:50:07,051][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-16 11:51:03,617][dance.WeightedFeatureSVD][__call__] Decomposing train features (7963, 200) (k=143)
[INFO][2024-03-16 11:51:03,627][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.82%
[INFO][2024-03-16 11:51:05,809][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 11:51:05,810][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 11:51:05,810][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 11:51:05,810][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:06,  1.28s/it]  2%|‚ñè         | 2/100 [00:02<02:00,  1.23s/it]  3%|‚ñé         | 3/100 [00:03<01:48,  1.12s/it]  4%|‚ñç         | 4/100 [00:04<01:40,  1.05s/it]  5%|‚ñå         | 5/100 [00:06<02:07,  1.34s/it]  6%|‚ñå         | 6/100 [00:09<03:15,  2.08s/it]  7%|‚ñã         | 7/100 [00:11<03:03,  1.97s/it]  8%|‚ñä         | 8/100 [00:13<03:05,  2.02s/it]  9%|‚ñâ         | 9/100 [00:15<03:03,  2.02s/it] 10%|‚ñà         | 10/100 [00:17<03:10,  2.11s/it] 11%|‚ñà         | 11/100 [00:19<03:01,  2.04s/it] 12%|‚ñà‚ñè        | 12/100 [00:21<02:57,  2.02s/it] 13%|‚ñà‚ñé        | 13/100 [00:23<02:53,  1.99s/it] 14%|‚ñà‚ñç        | 14/100 [00:25<02:52,  2.01s/it] 15%|‚ñà‚ñå        | 15/100 [00:27<02:49,  1.99s/it] 16%|‚ñà‚ñå        | 16/100 [00:29<02:40,  1.91s/it] 17%|‚ñà‚ñã        | 17/100 [00:31<02:36,  1.89s/it] 18%|‚ñà‚ñä        | 18/100 [00:32<02:24,  1.76s/it] 19%|‚ñà‚ñâ        | 19/100 [00:34<02:15,  1.68s/it] 20%|‚ñà‚ñà        | 20/100 [00:35<02:05,  1.56s/it] 21%|‚ñà‚ñà        | 21/100 [00:39<02:49,  2.15s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:50<06:19,  4.86s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:59<07:54,  6.16s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [01:06<08:06,  6.40s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [01:08<06:19,  5.06s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [01:17<07:36,  6.17s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [01:25<08:28,  6.96s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [01:33<08:39,  7.21s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [01:34<06:25,  5.42s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [01:37<05:11,  4.45s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [01:39<04:14,  3.69s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:40<03:29,  3.08s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:42<02:51,  2.57s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:43<02:24,  2.18s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:44<02:00,  1.85s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:45<01:46,  1.67s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:46<01:35,  1.52s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:48<01:27,  1.41s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:50<01:40,  1.65s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:52<01:49,  1.82s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:53<01:37,  1.66s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:55<01:30,  1.56s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:56<01:24,  1.48s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:57<01:17,  1.38s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:58<01:13,  1.33s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:59<01:09,  1.28s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [02:01<01:06,  1.26s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [02:02<01:03,  1.22s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [02:03<01:01,  1.22s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [02:04<00:59,  1.19s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [02:06<01:02,  1.28s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [02:07<00:59,  1.25s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [02:08<01:03,  1.36s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [02:11<01:22,  1.79s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [02:12<01:13,  1.64s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [02:13<01:04,  1.47s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [02:15<00:58,  1.36s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [02:16<00:56,  1.33s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [02:17<00:53,  1.29s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [02:18<00:49,  1.24s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [02:19<00:46,  1.19s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [02:20<00:45,  1.20s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [02:22<00:43,  1.18s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [02:23<00:43,  1.22s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [02:24<00:43,  1.25s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [02:26<00:44,  1.31s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [02:27<00:44,  1.35s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [02:28<00:42,  1.34s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:30<00:41,  1.33s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:32<00:50,  1.68s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:34<00:53,  1.85s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:35<00:44,  1.59s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:37<00:38,  1.44s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:38<00:34,  1.34s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:39<00:31,  1.26s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:42<00:46,  1.94s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:44<00:43,  1.89s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:45<00:36,  1.68s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:46<00:32,  1.53s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:48<00:29,  1.45s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:49<00:28,  1.49s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:51<00:25,  1.43s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:52<00:23,  1.39s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:53<00:21,  1.32s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:54<00:19,  1.29s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:56<00:21,  1.57s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:59<00:23,  1.78s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [03:00<00:19,  1.64s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [03:01<00:16,  1.48s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [03:02<00:13,  1.36s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [03:03<00:11,  1.27s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [03:05<00:10,  1.27s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [03:06<00:08,  1.28s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [03:07<00:07,  1.30s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [03:08<00:06,  1.27s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [03:10<00:05,  1.33s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [03:11<00:04,  1.41s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [03:13<00:02,  1.37s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [03:15<00:01,  1.66s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:17<00:00,  1.75s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:17<00:00,  1.98s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.021 MB uploadedwandb: | 0.012 MB of 0.021 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.27896
wandb: 
wandb: üöÄ View run feasible-sweep-106 at: https://wandb.ai/xzy11632/dance-dev/runs/k8c49q22
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_115001-k8c49q22/logs
wandb: Agent Starting Run: an17i1rj with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_115809-an17i1rj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run vivid-sweep-107
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/an17i1rj
[INFO][2024-03-16 11:58:16,770][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 11:58:16,895][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 11:58:16,895][dance][wrapped_func] Took 0:00:00.124971 to load and process data.
[INFO][2024-03-16 11:58:16,895][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 11:58:16,898][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 11:59:22,812][dance.WeightedFeaturePCA][__call__] Decomposing train features (7963, 200) (k=100)
[INFO][2024-03-16 11:59:22,812][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.10%
[INFO][2024-03-16 11:59:24,564][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 11:59:24,565][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 11:59:24,565][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 11:59:24,565][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:02<03:35,  2.17s/it]  2%|‚ñè         | 2/100 [00:04<03:48,  2.33s/it]  3%|‚ñé         | 3/100 [00:05<03:02,  1.88s/it]  4%|‚ñç         | 4/100 [00:07<02:38,  1.65s/it]  5%|‚ñå         | 5/100 [00:08<02:21,  1.49s/it]  6%|‚ñå         | 6/100 [00:09<02:11,  1.40s/it]  7%|‚ñã         | 7/100 [00:10<02:04,  1.34s/it]  8%|‚ñä         | 8/100 [00:12<01:59,  1.30s/it]  9%|‚ñâ         | 9/100 [00:14<02:20,  1.54s/it] 10%|‚ñà         | 10/100 [00:16<02:45,  1.84s/it] 11%|‚ñà         | 11/100 [00:18<02:44,  1.85s/it] 12%|‚ñà‚ñè        | 12/100 [00:20<02:35,  1.77s/it] 13%|‚ñà‚ñé        | 13/100 [00:21<02:29,  1.72s/it] 14%|‚ñà‚ñç        | 14/100 [00:23<02:23,  1.67s/it] 15%|‚ñà‚ñå        | 15/100 [00:25<02:24,  1.70s/it] 16%|‚ñà‚ñå        | 16/100 [00:26<02:21,  1.68s/it] 17%|‚ñà‚ñã        | 17/100 [00:29<02:42,  1.96s/it] 18%|‚ñà‚ñä        | 18/100 [00:32<02:59,  2.19s/it] 19%|‚ñà‚ñâ        | 19/100 [00:33<02:39,  1.97s/it] 20%|‚ñà‚ñà        | 20/100 [00:34<02:25,  1.82s/it] 21%|‚ñà‚ñà        | 21/100 [00:36<02:18,  1.76s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:37<02:07,  1.63s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:39<02:03,  1.60s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:40<01:58,  1.56s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:42<02:01,  1.62s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:44<02:07,  1.72s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:46<02:03,  1.69s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:47<01:56,  1.62s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:49<01:56,  1.64s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:50<01:49,  1.57s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:53<02:05,  1.81s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:55<02:15,  1.99s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:56<01:59,  1.78s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:58<01:50,  1.68s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:59<01:43,  1.59s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:01<01:40,  1.57s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:02<01:31,  1.45s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:03<01:25,  1.37s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:04<01:21,  1.34s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:06<01:21,  1.37s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:07<01:23,  1.42s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:10<01:44,  1.80s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:13<01:56,  2.05s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:15<02:04,  2.22s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:18<02:09,  2.36s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:22<02:27,  2.73s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:26<02:59,  3.39s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:29<02:39,  3.07s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:30<02:11,  2.58s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:32<01:52,  2.25s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:33<01:40,  2.05s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:35<01:30,  1.88s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:37<01:35,  2.02s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:40<01:43,  2.25s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:43<01:50,  2.46s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:45<01:42,  2.32s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:47<01:34,  2.20s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:49<01:28,  2.10s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:50<01:19,  1.94s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:52<01:14,  1.86s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:53<01:08,  1.75s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:56<01:18,  2.07s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:59<01:19,  2.15s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [02:00<01:11,  1.98s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [02:02<01:04,  1.84s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [02:03<00:58,  1.72s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [02:05<00:56,  1.71s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [02:06<00:52,  1.64s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:08<00:51,  1.66s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:10<00:51,  1.72s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:12<00:50,  1.73s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:13<00:48,  1.72s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:15<00:46,  1.72s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:16<00:43,  1.66s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:19<00:46,  1.87s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:22<00:55,  2.30s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:24<00:47,  2.06s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:25<00:42,  1.94s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:27<00:36,  1.74s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:28<00:33,  1.69s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:30<00:31,  1.63s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:31<00:28,  1.59s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:33<00:28,  1.67s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:35<00:26,  1.69s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:37<00:25,  1.71s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:38<00:24,  1.76s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:40<00:21,  1.68s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:42<00:23,  1.95s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:45<00:23,  2.16s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:46<00:18,  1.86s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:47<00:14,  1.64s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:49<00:12,  1.50s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:50<00:09,  1.40s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:51<00:07,  1.31s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:52<00:06,  1.25s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:53<00:04,  1.18s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:54<00:03,  1.15s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:55<00:02,  1.14s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:56<00:01,  1.11s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:57<00:00,  1.10s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:57<00:00,  1.78s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.23502
wandb: 
wandb: üöÄ View run vivid-sweep-107 at: https://wandb.ai/xzy11632/dance-dev/runs/an17i1rj
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_115809-an17i1rj/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 6dn02l0u with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_120425-6dn02l0u
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run zany-sweep-108
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/6dn02l0u
[INFO][2024-03-16 12:04:31,965][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 12:04:32,398][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 12:04:32,402][dance][wrapped_func] Took 0:00:00.435935 to load and process data.
[INFO][2024-03-16 12:04:32,403][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 12:04:32,416][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 12:05:55,734][dance.WeightedFeatureSVD][__call__] Decomposing train features (7963, 200) (k=97)
[INFO][2024-03-16 12:05:55,747][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.44%
[INFO][2024-03-16 12:06:01,470][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 12:06:01,471][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 12:06:01,472][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 12:06:01,472][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:54,  1.15s/it]  2%|‚ñè         | 2/100 [00:02<01:45,  1.07s/it]  3%|‚ñé         | 3/100 [00:03<01:42,  1.06s/it]  4%|‚ñç         | 4/100 [00:04<01:42,  1.07s/it]  5%|‚ñå         | 5/100 [00:05<01:43,  1.09s/it]  6%|‚ñå         | 6/100 [00:06<01:44,  1.11s/it]  7%|‚ñã         | 7/100 [00:07<01:46,  1.15s/it]  8%|‚ñä         | 8/100 [00:08<01:45,  1.14s/it]  9%|‚ñâ         | 9/100 [00:10<01:41,  1.12s/it] 10%|‚ñà         | 10/100 [00:11<01:39,  1.10s/it] 11%|‚ñà         | 11/100 [00:12<01:40,  1.13s/it] 12%|‚ñà‚ñè        | 12/100 [00:13<01:43,  1.17s/it] 13%|‚ñà‚ñé        | 13/100 [00:14<01:40,  1.16s/it] 14%|‚ñà‚ñç        | 14/100 [00:15<01:35,  1.11s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<02:08,  1.52s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<02:20,  1.67s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<02:15,  1.63s/it] 18%|‚ñà‚ñä        | 18/100 [00:23<02:07,  1.56s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<02:00,  1.48s/it] 20%|‚ñà‚ñà        | 20/100 [00:25<01:53,  1.42s/it] 21%|‚ñà‚ñà        | 21/100 [00:26<01:47,  1.36s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:27<01:38,  1.26s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:28<01:30,  1.17s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:29<01:26,  1.14s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:31<01:25,  1.14s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:32<01:21,  1.10s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:33<01:18,  1.08s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:34<01:17,  1.07s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:35<01:17,  1.09s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:36<01:13,  1.06s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:38<01:28,  1.28s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:40<01:46,  1.57s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:41<01:38,  1.47s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:42<01:27,  1.32s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:43<01:21,  1.26s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:44<01:17,  1.21s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:45<01:13,  1.17s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:47<01:12,  1.18s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:48<01:16,  1.25s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:49<01:15,  1.26s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:50<01:13,  1.24s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:52<01:12,  1.25s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:53<01:13,  1.30s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:54<01:11,  1.27s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:56<01:08,  1.25s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:57<01:05,  1.20s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:58<01:09,  1.32s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:01<01:26,  1.67s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:02<01:16,  1.50s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:03<01:11,  1.42s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:04<01:06,  1.36s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:05<01:00,  1.27s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:06<00:57,  1.23s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:08<00:56,  1.23s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:09<00:56,  1.25s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:10<00:52,  1.18s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:11<00:52,  1.21s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:12<00:49,  1.18s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:14<00:48,  1.18s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:15<00:47,  1.18s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:16<00:46,  1.19s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:17<00:44,  1.18s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:19<00:50,  1.36s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:21<00:58,  1.63s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:22<00:51,  1.47s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:23<00:46,  1.38s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:25<00:43,  1.31s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:26<00:40,  1.27s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:27<00:36,  1.19s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:28<00:36,  1.22s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:29<00:34,  1.19s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:30<00:32,  1.17s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:32<00:32,  1.19s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:33<00:30,  1.19s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:34<00:29,  1.20s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:35<00:29,  1.23s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:36<00:27,  1.20s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:37<00:25,  1.17s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:39<00:28,  1.37s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:41<00:31,  1.56s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:42<00:26,  1.40s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:43<00:23,  1.33s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:44<00:21,  1.24s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:46<00:21,  1.35s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:48<00:21,  1.46s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:49<00:19,  1.38s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:50<00:17,  1.32s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:51<00:15,  1.29s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:53<00:13,  1.25s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:54<00:12,  1.21s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:55<00:10,  1.21s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:56<00:09,  1.17s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:57<00:07,  1.13s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:59<00:07,  1.28s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:01<00:07,  1.58s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:02<00:05,  1.45s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:03<00:03,  1.32s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:04<00:02,  1.25s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:05<00:01,  1.23s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:06<00:00,  1.18s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:06<00:00,  1.27s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.32102
wandb: 
wandb: üöÄ View run zany-sweep-108 at: https://wandb.ai/xzy11632/dance-dev/runs/6dn02l0u
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_120425-6dn02l0u/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: n0n92fp3 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_121038-n0n92fp3
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lilac-sweep-109
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/n0n92fp3
[INFO][2024-03-16 12:10:44,161][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 12:10:44,272][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 12:10:44,272][dance][wrapped_func] Took 0:00:00.110403 to load and process data.
[INFO][2024-03-16 12:10:44,272][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 12:10:44,277][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 12:10:44,300][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 12:10:44,502][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 12:10:48,416][dance.WeightedFeaturePCA][__call__] Decomposing train features (7963, 980) (k=479)
[INFO][2024-03-16 12:10:48,417][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.04%
[INFO][2024-03-16 12:10:52,712][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 12:10:52,713][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 12:10:52,714][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 12:10:52,714][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:15,  1.37s/it]  2%|‚ñè         | 2/100 [00:02<02:05,  1.28s/it]  3%|‚ñé         | 3/100 [00:03<02:07,  1.31s/it]  4%|‚ñç         | 4/100 [00:05<02:00,  1.26s/it]  5%|‚ñå         | 5/100 [00:06<01:58,  1.25s/it]  6%|‚ñå         | 6/100 [00:07<02:03,  1.31s/it]  7%|‚ñã         | 7/100 [00:09<02:07,  1.37s/it]  8%|‚ñä         | 8/100 [00:10<02:08,  1.40s/it]  9%|‚ñâ         | 9/100 [00:12<02:11,  1.44s/it] 10%|‚ñà         | 10/100 [00:13<02:10,  1.45s/it] 11%|‚ñà         | 11/100 [00:15<02:04,  1.40s/it] 12%|‚ñà‚ñè        | 12/100 [00:21<04:16,  2.91s/it] 13%|‚ñà‚ñé        | 13/100 [00:23<03:47,  2.62s/it] 14%|‚ñà‚ñç        | 14/100 [00:25<03:23,  2.36s/it] 15%|‚ñà‚ñå        | 15/100 [00:29<04:12,  2.97s/it] 16%|‚ñà‚ñå        | 16/100 [00:33<04:47,  3.43s/it] 17%|‚ñà‚ñã        | 17/100 [00:35<04:08,  2.99s/it] 18%|‚ñà‚ñä        | 18/100 [00:37<03:36,  2.64s/it] 19%|‚ñà‚ñâ        | 19/100 [00:39<03:12,  2.38s/it] 20%|‚ñà‚ñà        | 20/100 [00:41<02:59,  2.24s/it] 21%|‚ñà‚ñà        | 21/100 [00:43<02:42,  2.06s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:44<02:26,  1.88s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:45<02:13,  1.73s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:48<02:26,  1.93s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:50<02:34,  2.07s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:52<02:17,  1.85s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:53<02:03,  1.69s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:54<01:59,  1.66s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:56<01:53,  1.60s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:57<01:47,  1.53s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:59<01:47,  1.55s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:00<01:45,  1.55s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:02<01:47,  1.60s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:04<01:47,  1.62s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:05<01:45,  1.62s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:08<01:54,  1.78s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:11<02:13,  2.13s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:12<02:01,  1.95s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:14<01:49,  1.80s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:15<01:40,  1.68s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:16<01:36,  1.63s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:18<01:32,  1.59s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:19<01:28,  1.55s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:21<01:29,  1.60s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:23<01:30,  1.65s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:25<01:28,  1.64s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:26<01:25,  1.61s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:28<01:24,  1.62s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:29<01:19,  1.55s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:32<01:37,  1.95s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:34<01:38,  2.02s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:35<01:26,  1.81s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:37<01:22,  1.75s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:39<01:16,  1.67s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:40<01:11,  1.59s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:41<01:04,  1.47s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:43<01:02,  1.45s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:44<01:00,  1.44s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:45<00:59,  1.45s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:47<00:58,  1.46s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:49<01:00,  1.55s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:51<01:03,  1.66s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:54<01:15,  2.04s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:55<01:05,  1.82s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:56<00:58,  1.67s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:58<00:57,  1.68s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:59<00:52,  1.60s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [02:01<00:48,  1.52s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:02<00:46,  1.49s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:04<00:52,  1.74s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:07<00:54,  1.88s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:09<01:00,  2.17s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:12<01:04,  2.38s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:15<01:01,  2.38s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:16<00:52,  2.11s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:19<00:55,  2.33s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:21<00:54,  2.36s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:23<00:46,  2.10s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:24<00:40,  1.93s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:26<00:36,  1.82s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:28<00:33,  1.74s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:29<00:29,  1.62s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:30<00:26,  1.58s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:32<00:25,  1.62s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:34<00:24,  1.63s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:36<00:23,  1.70s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:37<00:21,  1.62s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:38<00:18,  1.52s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:41<00:19,  1.77s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:44<00:21,  2.15s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:45<00:16,  1.87s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:46<00:13,  1.66s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:47<00:10,  1.57s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:49<00:09,  1.51s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:50<00:07,  1.43s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:51<00:05,  1.41s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:53<00:04,  1.44s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:54<00:02,  1.42s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:56<00:01,  1.52s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:58<00:00,  1.74s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:58<00:00,  1.79s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.14124
wandb: 
wandb: üöÄ View run lilac-sweep-109 at: https://wandb.ai/xzy11632/dance-dev/runs/n0n92fp3
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_121038-n0n92fp3/logs
wandb: Agent Starting Run: 0djvxdv8 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_121536-0djvxdv8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run graceful-sweep-110
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/0djvxdv8
[INFO][2024-03-16 12:15:42,158][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 12:15:42,257][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 12:15:42,257][dance][wrapped_func] Took 0:00:00.097946 to load and process data.
[INFO][2024-03-16 12:15:42,257][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 12:15:42,259][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 12:15:42,275][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 12:15:42,421][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 12:15:50,717][dance.WeightedFeatureSVD][__call__] Decomposing train features (7963, 980) (k=464)
[INFO][2024-03-16 12:15:50,718][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.14%
[INFO][2024-03-16 12:15:53,639][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 12:15:53,643][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 12:15:53,643][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 12:15:53,643][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:56,  1.79s/it]  2%|‚ñè         | 2/100 [00:04<03:22,  2.06s/it]  3%|‚ñé         | 3/100 [00:07<04:16,  2.64s/it]  4%|‚ñç         | 4/100 [00:08<03:25,  2.14s/it]  5%|‚ñå         | 5/100 [00:10<02:54,  1.84s/it]  6%|‚ñå         | 6/100 [00:11<02:35,  1.65s/it]  7%|‚ñã         | 7/100 [00:12<02:25,  1.57s/it]  8%|‚ñä         | 8/100 [00:14<02:15,  1.48s/it]  9%|‚ñâ         | 9/100 [00:15<02:11,  1.45s/it] 10%|‚ñà         | 10/100 [00:17<02:19,  1.55s/it] 11%|‚ñà         | 11/100 [00:18<02:13,  1.50s/it] 12%|‚ñà‚ñè        | 12/100 [00:20<02:13,  1.51s/it] 13%|‚ñà‚ñé        | 13/100 [00:21<02:10,  1.50s/it] 14%|‚ñà‚ñç        | 14/100 [00:23<02:10,  1.51s/it] 15%|‚ñà‚ñå        | 15/100 [00:24<02:08,  1.51s/it] 16%|‚ñà‚ñå        | 16/100 [00:27<02:40,  1.91s/it] 17%|‚ñà‚ñã        | 17/100 [00:32<03:55,  2.84s/it] 18%|‚ñà‚ñä        | 18/100 [00:33<03:17,  2.41s/it] 19%|‚ñà‚ñâ        | 19/100 [00:35<02:55,  2.17s/it] 20%|‚ñà‚ñà        | 20/100 [00:36<02:32,  1.90s/it] 21%|‚ñà‚ñà        | 21/100 [00:38<02:23,  1.81s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:39<02:16,  1.75s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:41<02:12,  1.73s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:43<02:07,  1.68s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:44<02:07,  1.70s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:46<02:04,  1.68s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:48<01:58,  1.62s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:51<02:34,  2.15s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:53<02:27,  2.08s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:54<02:11,  1.89s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:56<02:00,  1.75s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:57<01:57,  1.72s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:59<01:51,  1.67s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:00<01:47,  1.62s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:02<01:46,  1.64s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:04<01:44,  1.63s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:05<01:44,  1.66s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:07<01:46,  1.72s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:09<01:38,  1.61s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:11<01:43,  1.73s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:14<02:06,  2.14s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:18<02:32,  2.62s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:19<02:15,  2.37s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:21<01:59,  2.14s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:23<01:48,  1.98s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:24<01:40,  1.87s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:26<01:35,  1.80s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:27<01:30,  1.74s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:29<01:26,  1.70s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:31<01:24,  1.70s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:32<01:16,  1.57s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:34<01:20,  1.68s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:37<01:35,  2.04s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:38<01:22,  1.79s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:39<01:13,  1.63s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:40<01:05,  1.48s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:41<00:59,  1.37s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:43<00:55,  1.32s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:44<00:52,  1.27s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:46<00:59,  1.48s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:48<01:11,  1.83s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:51<01:19,  2.09s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:53<01:13,  1.99s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:54<01:07,  1.87s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:59<01:30,  2.58s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [02:03<01:42,  3.00s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [02:05<01:33,  2.84s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [02:08<01:28,  2.75s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:09<01:12,  2.35s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:11<01:03,  2.12s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:13<00:59,  2.04s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:14<00:55,  1.97s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:16<00:49,  1.84s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:18<00:47,  1.82s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:20<00:45,  1.82s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:21<00:44,  1.84s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:24<00:47,  2.05s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:26<00:43,  1.97s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:27<00:38,  1.82s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:29<00:34,  1.71s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:30<00:31,  1.64s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:32<00:28,  1.61s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:33<00:27,  1.60s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:35<00:26,  1.65s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:37<00:24,  1.66s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:38<00:23,  1.65s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:40<00:21,  1.66s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:41<00:18,  1.58s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:44<00:20,  1.88s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:47<00:22,  2.28s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:49<00:18,  2.02s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:50<00:14,  1.87s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:51<00:11,  1.71s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:53<00:09,  1.62s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:54<00:07,  1.55s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:56<00:06,  1.51s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:57<00:04,  1.48s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:59<00:03,  1.53s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [03:00<00:01,  1.57s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:02<00:00,  1.52s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:02<00:00,  1.82s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.15729
wandb: 
wandb: üöÄ View run graceful-sweep-110 at: https://wandb.ai/xzy11632/dance-dev/runs/0djvxdv8
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_121536-0djvxdv8/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: v10v5yy7 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_122033-v10v5yy7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sweepy-sweep-111
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/v10v5yy7
[INFO][2024-03-16 12:20:38,217][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 12:20:38,313][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 12:20:38,313][dance][wrapped_func] Took 0:00:00.094534 to load and process data.
[INFO][2024-03-16 12:20:38,313][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 12:20:38,315][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 12:20:38,636][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run sweepy-sweep-111 at: https://wandb.ai/xzy11632/dance-dev/runs/v10v5yy7
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_122033-v10v5yy7/logs
wandb: ERROR Run v10v5yy7 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1020) out of bounds (980)
wandb: ERROR 
wandb: Agent Starting Run: wf6uvd9f with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_122052-wf6uvd9f
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run restful-sweep-112
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/wf6uvd9f
[INFO][2024-03-16 12:20:57,336][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 12:20:57,445][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 12:20:57,446][dance][wrapped_func] Took 0:00:00.109022 to load and process data.
[INFO][2024-03-16 12:20:57,446][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 12:20:57,448][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 12:20:57,742][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.020 MB of 0.024 MB uploadedwandb: | 0.020 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run restful-sweep-112 at: https://wandb.ai/xzy11632/dance-dev/runs/wf6uvd9f
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_122052-wf6uvd9f/logs
wandb: ERROR Run wf6uvd9f errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1020) out of bounds (980)
wandb: ERROR 
wandb: Agent Starting Run: rvrzgrvc with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_122113-rvrzgrvc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sandy-sweep-113
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/rvrzgrvc
[INFO][2024-03-16 12:21:19,600][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 12:21:19,691][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 12:21:19,691][dance][wrapped_func] Took 0:00:00.091152 to load and process data.
[INFO][2024-03-16 12:21:19,692][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 12:21:19,693][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[INFO][2024-03-16 12:21:20,280][dance.WeightedFeaturePCA][__call__] Decomposing train features (7963, 200) (k=102)
[INFO][2024-03-16 12:21:20,280][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.15%
[INFO][2024-03-16 12:21:22,557][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 12:21:22,557][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 12:21:22,557][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 12:21:22,557][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:46,  1.68s/it]  2%|‚ñè         | 2/100 [00:03<02:36,  1.59s/it]  3%|‚ñé         | 3/100 [00:05<02:47,  1.73s/it]  4%|‚ñç         | 4/100 [00:06<02:38,  1.65s/it]  5%|‚ñå         | 5/100 [00:08<02:28,  1.57s/it]  6%|‚ñå         | 6/100 [00:10<02:42,  1.73s/it]  7%|‚ñã         | 7/100 [00:12<03:11,  2.06s/it]  8%|‚ñä         | 8/100 [00:14<02:45,  1.80s/it]  9%|‚ñâ         | 9/100 [00:15<02:25,  1.60s/it] 10%|‚ñà         | 10/100 [00:16<02:11,  1.46s/it] 11%|‚ñà         | 11/100 [00:17<02:05,  1.41s/it] 12%|‚ñà‚ñè        | 12/100 [00:18<01:58,  1.35s/it] 13%|‚ñà‚ñé        | 13/100 [00:20<01:54,  1.32s/it] 14%|‚ñà‚ñç        | 14/100 [00:21<01:47,  1.25s/it] 15%|‚ñà‚ñå        | 15/100 [00:22<01:42,  1.20s/it] 16%|‚ñà‚ñå        | 16/100 [00:23<01:41,  1.21s/it] 17%|‚ñà‚ñã        | 17/100 [00:24<01:41,  1.22s/it] 18%|‚ñà‚ñä        | 18/100 [00:25<01:37,  1.19s/it] 19%|‚ñà‚ñâ        | 19/100 [00:27<01:37,  1.21s/it] 20%|‚ñà‚ñà        | 20/100 [00:28<01:42,  1.28s/it] 21%|‚ñà‚ñà        | 21/100 [00:29<01:41,  1.28s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:31<01:37,  1.25s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:32<01:45,  1.37s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:34<01:46,  1.40s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:36<02:04,  1.65s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:37<01:55,  1.56s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:38<01:43,  1.42s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:40<01:37,  1.35s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:41<01:32,  1.31s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:42<01:27,  1.25s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:43<01:22,  1.20s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:44<01:22,  1.22s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:45<01:22,  1.23s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:47<01:26,  1.30s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:50<01:58,  1.82s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:52<01:59,  1.87s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:54<02:03,  1.97s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:57<02:10,  2.11s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:00<02:27,  2.42s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:01<02:03,  2.06s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:02<01:45,  1.79s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:03<01:33,  1.61s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:05<01:28,  1.56s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:06<01:21,  1.46s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:07<01:16,  1.40s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:08<01:12,  1.35s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:10<01:11,  1.35s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:11<01:09,  1.35s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:12<01:07,  1.32s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:14<01:06,  1.32s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:15<01:04,  1.31s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:16<00:59,  1.24s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:17<00:55,  1.18s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:21<01:31,  1.99s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:24<01:40,  2.24s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:25<01:23,  1.89s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:26<01:13,  1.71s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:27<01:04,  1.54s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:29<00:58,  1.43s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:30<00:53,  1.34s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:31<00:50,  1.30s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:32<00:52,  1.37s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:34<00:56,  1.51s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:36<00:54,  1.53s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:37<00:52,  1.50s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:39<00:52,  1.54s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:40<00:47,  1.45s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:41<00:43,  1.36s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:43<00:48,  1.56s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:46<00:54,  1.80s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:47<00:47,  1.65s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:48<00:41,  1.48s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:49<00:37,  1.39s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:50<00:34,  1.31s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:52<00:31,  1.27s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:53<00:30,  1.28s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:54<00:30,  1.32s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:56<00:28,  1.30s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:57<00:28,  1.34s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:58<00:25,  1.28s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:59<00:24,  1.29s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:01<00:23,  1.28s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:02<00:20,  1.23s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:03<00:22,  1.38s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:05<00:20,  1.38s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:07<00:23,  1.69s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:08<00:19,  1.49s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:09<00:16,  1.39s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:11<00:14,  1.30s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:12<00:12,  1.30s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:13<00:11,  1.25s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:14<00:09,  1.21s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:15<00:08,  1.18s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:17<00:07,  1.24s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:18<00:06,  1.23s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:19<00:05,  1.26s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:20<00:03,  1.26s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:22<00:02,  1.23s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:23<00:01,  1.42s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:26<00:00,  1.80s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:26<00:00,  1.47s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.17373
wandb: 
wandb: üöÄ View run sandy-sweep-113 at: https://wandb.ai/xzy11632/dance-dev/runs/rvrzgrvc
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_122113-rvrzgrvc/logs
wandb: Agent Starting Run: xyp9o3k0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_122503-xyp9o3k0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rich-sweep-114
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/xyp9o3k0
[INFO][2024-03-16 12:25:09,039][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 12:25:09,151][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 12:25:09,151][dance][wrapped_func] Took 0:00:00.110339 to load and process data.
[INFO][2024-03-16 12:25:09,151][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 12:25:09,153][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[INFO][2024-03-16 12:25:18,213][dance.WeightedFeatureSVD][__call__] Decomposing train features (7963, 200) (k=96)
[INFO][2024-03-16 12:25:18,216][dance.WeightedFeatureSVD][__call__] Total explained variance: 88.84%
[INFO][2024-03-16 12:25:30,834][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 12:25:30,835][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 12:25:30,835][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 12:25:30,835][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:56,  1.18s/it]  2%|‚ñè         | 2/100 [00:02<02:06,  1.29s/it]  3%|‚ñé         | 3/100 [00:03<02:00,  1.24s/it]  4%|‚ñç         | 4/100 [00:04<01:58,  1.24s/it]  5%|‚ñå         | 5/100 [00:06<01:56,  1.23s/it]  6%|‚ñå         | 6/100 [00:07<02:12,  1.41s/it]  7%|‚ñã         | 7/100 [00:09<02:15,  1.46s/it]  8%|‚ñä         | 8/100 [00:11<02:22,  1.55s/it]  9%|‚ñâ         | 9/100 [00:12<02:08,  1.41s/it] 10%|‚ñà         | 10/100 [00:13<01:57,  1.30s/it] 11%|‚ñà         | 11/100 [00:14<01:52,  1.26s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:51,  1.27s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:46,  1.23s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<01:42,  1.20s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<01:42,  1.20s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<01:39,  1.19s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:40,  1.21s/it] 18%|‚ñà‚ñä        | 18/100 [00:23<01:43,  1.26s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<01:39,  1.23s/it] 20%|‚ñà‚ñà        | 20/100 [00:25<01:39,  1.24s/it] 21%|‚ñà‚ñà        | 21/100 [00:26<01:32,  1.17s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:28<01:41,  1.30s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:29<01:37,  1.27s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:31<01:49,  1.45s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:32<01:41,  1.35s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:33<01:34,  1.27s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:34<01:29,  1.23s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:35<01:23,  1.16s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:36<01:21,  1.14s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:37<01:18,  1.13s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:38<01:16,  1.11s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:39<01:14,  1.10s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:41<01:14,  1.11s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:42<01:13,  1.12s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:43<01:12,  1.12s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:44<01:15,  1.19s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:46<01:31,  1.45s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:49<01:47,  1.74s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:50<01:34,  1.55s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:51<01:25,  1.43s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:52<01:19,  1.34s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:53<01:15,  1.30s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:54<01:13,  1.28s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:56<01:08,  1.22s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:57<01:04,  1.17s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:58<01:03,  1.17s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:59<01:02,  1.18s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:00<01:04,  1.24s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:02<01:05,  1.28s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:03<01:02,  1.25s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:04<00:57,  1.18s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:06<01:03,  1.33s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:08<01:14,  1.58s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:09<01:06,  1.45s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:10<01:00,  1.33s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:11<00:55,  1.25s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:12<00:53,  1.25s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:13<00:52,  1.24s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:15<00:50,  1.22s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:16<00:48,  1.22s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:17<00:47,  1.22s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:18<00:44,  1.17s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:19<00:43,  1.18s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:21<00:42,  1.18s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:22<00:44,  1.28s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:23<00:45,  1.33s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:25<00:41,  1.27s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:26<00:45,  1.41s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:29<00:52,  1.68s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:30<00:44,  1.50s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:31<00:40,  1.39s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:32<00:36,  1.30s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:33<00:32,  1.22s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:34<00:30,  1.16s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:35<00:28,  1.16s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:36<00:27,  1.15s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:37<00:25,  1.12s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:38<00:24,  1.12s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:40<00:23,  1.13s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:41<00:22,  1.13s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:42<00:21,  1.12s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:43<00:20,  1.12s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:44<00:19,  1.16s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:45<00:18,  1.15s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:47<00:17,  1.15s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:48<00:18,  1.33s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:51<00:21,  1.62s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:52<00:20,  1.69s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:53<00:16,  1.50s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:55<00:13,  1.37s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:56<00:11,  1.27s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:57<00:09,  1.21s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:58<00:08,  1.18s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:59<00:07,  1.20s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:00<00:06,  1.20s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:01<00:04,  1.22s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:03<00:03,  1.21s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:04<00:02,  1.19s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:05<00:01,  1.23s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:06<00:00,  1.22s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:06<00:00,  1.27s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.15199
wandb: 
wandb: üöÄ View run rich-sweep-114 at: https://wandb.ai/xzy11632/dance-dev/runs/xyp9o3k0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_122503-xyp9o3k0/logs
wandb: Agent Starting Run: kbz4f1pj with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_122854-kbz4f1pj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wandering-sweep-115
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/kbz4f1pj
[INFO][2024-03-16 12:28:59,423][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 12:28:59,516][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 12:28:59,517][dance][wrapped_func] Took 0:00:00.093009 to load and process data.
[INFO][2024-03-16 12:28:59,517][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 12:28:59,519][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.023 MB of 0.023 MB uploadedwandb:                                                                                
wandb: üöÄ View run wandering-sweep-115 at: https://wandb.ai/xzy11632/dance-dev/runs/kbz4f1pj
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_122854-kbz4f1pj/logs
wandb: ERROR Run kbz4f1pj errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/cell_feature.py", line 50, in __call__
wandb: ERROR     gene_feat = gene_pca.fit_transform(feat.T)  # decompose into gene features
wandb: ERROR                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
wandb: ERROR     data_to_wrap = f(self, X, *args, **kwargs)
wandb: ERROR                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 1152, in wrapper
wandb: ERROR     return fit_method(estimator, *args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 460, in fit_transform
wandb: ERROR     U, S, Vt = self._fit(X)
wandb: ERROR                ^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 483, in _fit
wandb: ERROR     X = self._validate_data(
wandb: ERROR         ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 605, in _validate_data
wandb: ERROR     out = check_array(X, input_name="X", **check_params)
wandb: ERROR           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/validation.py", line 967, in check_array
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: Found array with 0 sample(s) (shape=(0, 7963)) while a minimum of 1 is required by PCA.
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 5akdmp1b with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_122919-5akdmp1b
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run super-sweep-116
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/5akdmp1b
[INFO][2024-03-16 12:29:24,328][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 12:29:24,418][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 12:29:24,418][dance][wrapped_func] Took 0:00:00.089665 to load and process data.
[INFO][2024-03-16 12:29:24,418][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 12:29:24,419][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.023 MB of 0.023 MB uploadedwandb:                                                                                
wandb: üöÄ View run super-sweep-116 at: https://wandb.ai/xzy11632/dance-dev/runs/5akdmp1b
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_122919-5akdmp1b/logs
wandb: ERROR Run 5akdmp1b errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/cell_feature.py", line 98, in __call__
wandb: ERROR     svd.fit_transform(feat)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
wandb: ERROR     data_to_wrap = f(self, X, *args, **kwargs)
wandb: ERROR                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 1145, in wrapper
wandb: ERROR     estimator._validate_params()
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 638, in _validate_params
wandb: ERROR     validate_parameter_constraints(
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_param_validation.py", line 96, in validate_parameter_constraints
wandb: ERROR     raise InvalidParameterError(
wandb: ERROR sklearn.utils._param_validation.InvalidParameterError: The 'n_components' parameter of TruncatedSVD must be an int in the range [1, inf). Got -1 instead.
wandb: ERROR 
wandb: Agent Starting Run: durkorn0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_122935-durkorn0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run good-sweep-117
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/durkorn0
[INFO][2024-03-16 12:29:42,009][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 12:29:42,109][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 12:29:42,109][dance][wrapped_func] Took 0:00:00.099261 to load and process data.
[INFO][2024-03-16 12:29:42,109][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 12:29:42,111][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[INFO][2024-03-16 12:29:42,781][dance.WeightedFeaturePCA][__call__] Decomposing train features (7963, 200) (k=103)
[INFO][2024-03-16 12:29:42,781][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.12%
[INFO][2024-03-16 12:29:48,191][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 12:29:48,192][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 12:29:48,192][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 12:29:48,192][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:39,  1.61s/it]  2%|‚ñè         | 2/100 [00:03<02:51,  1.75s/it]  3%|‚ñé         | 3/100 [00:05<02:40,  1.66s/it]  4%|‚ñç         | 4/100 [00:06<02:32,  1.58s/it]  5%|‚ñå         | 5/100 [00:09<03:06,  1.97s/it]  6%|‚ñå         | 6/100 [00:11<03:21,  2.14s/it]  7%|‚ñã         | 7/100 [00:13<03:00,  1.94s/it]  8%|‚ñä         | 8/100 [00:14<02:48,  1.83s/it]  9%|‚ñâ         | 9/100 [00:16<02:43,  1.80s/it] 10%|‚ñà         | 10/100 [00:18<02:39,  1.77s/it] 11%|‚ñà         | 11/100 [00:19<02:30,  1.70s/it] 12%|‚ñà‚ñè        | 12/100 [00:21<02:29,  1.70s/it] 13%|‚ñà‚ñé        | 13/100 [00:23<02:30,  1.72s/it] 14%|‚ñà‚ñç        | 14/100 [00:25<02:31,  1.76s/it] 15%|‚ñà‚ñå        | 15/100 [00:26<02:25,  1.71s/it] 16%|‚ñà‚ñå        | 16/100 [00:28<02:21,  1.68s/it] 17%|‚ñà‚ñã        | 17/100 [00:29<02:14,  1.62s/it] 18%|‚ñà‚ñä        | 18/100 [00:31<02:07,  1.56s/it] 19%|‚ñà‚ñâ        | 19/100 [00:33<02:36,  1.93s/it] 20%|‚ñà‚ñà        | 20/100 [00:36<02:51,  2.14s/it] 21%|‚ñà‚ñà        | 21/100 [00:37<02:30,  1.91s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:39<02:16,  1.75s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:40<02:04,  1.61s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:41<01:55,  1.52s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:43<01:48,  1.45s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:44<01:40,  1.35s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:45<01:39,  1.36s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:46<01:35,  1.33s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:48<01:37,  1.38s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:49<01:34,  1.35s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:50<01:29,  1.29s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:52<01:26,  1.27s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:54<01:37,  1.46s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:56<01:56,  1.76s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:57<01:42,  1.57s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:58<01:32,  1.44s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:59<01:25,  1.36s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:01<01:19,  1.28s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:02<01:16,  1.26s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:03<01:13,  1.23s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:04<01:19,  1.34s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:06<01:17,  1.34s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:07<01:14,  1.31s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:08<01:14,  1.33s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:10<01:12,  1.33s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:11<01:07,  1.26s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:13<01:15,  1.43s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:15<01:22,  1.58s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:17<01:30,  1.77s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:18<01:19,  1.58s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:19<01:10,  1.44s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:20<01:04,  1.35s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:21<01:00,  1.30s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:23<00:58,  1.28s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:24<00:55,  1.23s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:25<00:52,  1.19s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:26<00:53,  1.25s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:28<01:02,  1.49s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:30<01:04,  1.58s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:32<01:07,  1.70s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:34<01:09,  1.79s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:36<01:09,  1.84s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:38<01:05,  1.78s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:40<01:10,  1.95s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:42<01:10,  2.02s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:43<01:00,  1.79s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:45<00:52,  1.60s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:46<00:48,  1.52s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:47<00:44,  1.44s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:49<00:42,  1.41s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:50<00:39,  1.36s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:51<00:38,  1.38s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:53<00:37,  1.37s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:54<00:35,  1.35s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:55<00:32,  1.32s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:57<00:33,  1.38s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:58<00:29,  1.29s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:59<00:28,  1.28s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:01<00:28,  1.37s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:03<00:33,  1.69s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:06<00:37,  1.96s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:07<00:32,  1.79s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:08<00:27,  1.60s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:12<00:35,  2.21s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:13<00:29,  1.99s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:15<00:25,  1.80s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:16<00:22,  1.73s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:18<00:19,  1.63s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:19<00:17,  1.62s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:21<00:15,  1.58s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:22<00:13,  1.49s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:23<00:11,  1.44s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:26<00:12,  1.72s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:28<00:11,  1.94s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:30<00:09,  1.80s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:31<00:06,  1.67s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:32<00:04,  1.57s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:34<00:02,  1.49s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:35<00:01,  1.45s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:36<00:00,  1.49s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:36<00:00,  1.57s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.15816
wandb: 
wandb: üöÄ View run good-sweep-117 at: https://wandb.ai/xzy11632/dance-dev/runs/durkorn0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_122935-durkorn0/logs
wandb: Agent Starting Run: igcein93 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_123331-igcein93
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run celestial-sweep-118
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/igcein93
[INFO][2024-03-16 12:33:38,759][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 12:33:38,858][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 12:33:38,858][dance][wrapped_func] Took 0:00:00.098597 to load and process data.
[INFO][2024-03-16 12:33:38,859][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 12:33:38,862][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[INFO][2024-03-16 12:33:44,029][dance.WeightedFeatureSVD][__call__] Decomposing train features (7963, 200) (k=97)
[INFO][2024-03-16 12:33:44,031][dance.WeightedFeatureSVD][__call__] Total explained variance: 88.79%
[INFO][2024-03-16 12:33:55,688][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 12:33:55,690][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 12:33:55,690][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 12:33:55,690][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:58,  1.19s/it]  2%|‚ñè         | 2/100 [00:02<01:53,  1.16s/it]  3%|‚ñé         | 3/100 [00:03<01:51,  1.15s/it]  4%|‚ñç         | 4/100 [00:04<01:47,  1.12s/it]  5%|‚ñå         | 5/100 [00:05<01:50,  1.17s/it]  6%|‚ñå         | 6/100 [00:07<01:54,  1.22s/it]  7%|‚ñã         | 7/100 [00:08<01:54,  1.23s/it]  8%|‚ñä         | 8/100 [00:09<01:50,  1.21s/it]  9%|‚ñâ         | 9/100 [00:10<01:47,  1.18s/it] 10%|‚ñà         | 10/100 [00:12<01:59,  1.33s/it] 11%|‚ñà         | 11/100 [00:14<02:23,  1.61s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<02:06,  1.44s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:59,  1.37s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<01:54,  1.34s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<01:44,  1.23s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<01:47,  1.28s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:52,  1.36s/it] 18%|‚ñà‚ñä        | 18/100 [00:23<01:47,  1.31s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<01:41,  1.26s/it] 20%|‚ñà‚ñà        | 20/100 [00:25<01:38,  1.23s/it] 21%|‚ñà‚ñà        | 21/100 [00:26<01:36,  1.22s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:27<01:37,  1.24s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:29<01:37,  1.26s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:30<01:34,  1.24s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:32<01:46,  1.42s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:34<02:06,  1.71s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:35<01:51,  1.53s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:37<01:44,  1.44s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:38<01:40,  1.41s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:39<01:39,  1.42s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:41<01:36,  1.39s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:42<01:29,  1.32s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:43<01:26,  1.29s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:45<01:29,  1.35s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:47<01:40,  1.54s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:48<01:36,  1.50s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:49<01:30,  1.43s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:51<01:28,  1.43s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:52<01:23,  1.36s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:53<01:16,  1.28s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:54<01:12,  1.22s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:56<01:22,  1.43s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:58<01:29,  1.56s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:59<01:21,  1.46s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:00<01:14,  1.35s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:01<01:11,  1.32s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:02<01:07,  1.26s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:04<01:02,  1.20s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:05<00:59,  1.17s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:06<00:56,  1.14s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:07<00:56,  1.15s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:08<00:55,  1.16s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:09<00:55,  1.18s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:10<00:53,  1.16s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:11<00:50,  1.13s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:13<00:50,  1.15s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:14<00:49,  1.14s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:15<00:47,  1.13s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:17<00:53,  1.31s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:19<01:02,  1.55s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:20<00:54,  1.39s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:21<00:49,  1.30s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:22<00:46,  1.27s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:23<00:45,  1.28s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:25<00:44,  1.26s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:26<00:41,  1.22s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:27<00:39,  1.20s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:28<00:39,  1.24s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:29<00:36,  1.18s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:30<00:36,  1.21s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:32<00:35,  1.21s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:33<00:32,  1.16s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:34<00:34,  1.28s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:36<00:39,  1.53s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:38<00:35,  1.41s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:39<00:31,  1.30s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:40<00:29,  1.27s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:41<00:26,  1.20s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:42<00:24,  1.15s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:43<00:22,  1.14s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:44<00:21,  1.12s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:45<00:20,  1.16s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:46<00:19,  1.14s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:48<00:18,  1.15s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:49<00:17,  1.16s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:50<00:16,  1.16s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:51<00:14,  1.15s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:52<00:13,  1.16s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:54<00:14,  1.33s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:55<00:13,  1.34s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:57<00:13,  1.54s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:58<00:11,  1.42s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:00<00:09,  1.35s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:01<00:07,  1.33s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:02<00:06,  1.31s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:03<00:05,  1.29s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:04<00:03,  1.21s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:06<00:02,  1.19s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:07<00:01,  1.15s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:08<00:00,  1.13s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:08<00:00,  1.28s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.021 MB uploadedwandb: / 0.012 MB of 0.021 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.13535
wandb: 
wandb: üöÄ View run celestial-sweep-118 at: https://wandb.ai/xzy11632/dance-dev/runs/igcein93
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_123331-igcein93/logs
wandb: Agent Starting Run: mvk2dm8d with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_123710-mvk2dm8d
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run stilted-sweep-119
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/mvk2dm8d
[INFO][2024-03-16 12:37:16,752][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 12:37:16,857][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 12:37:16,858][dance][wrapped_func] Took 0:00:00.104342 to load and process data.
[INFO][2024-03-16 12:37:16,858][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 12:37:16,860][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 12:37:17,781][dance.WeightedFeaturePCA][__call__] Decomposing train features (7963, 200) (k=99)
[INFO][2024-03-16 12:37:17,782][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.10%
[INFO][2024-03-16 12:37:22,776][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 12:37:22,777][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 12:37:22,777][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 12:37:22,777][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:13,  1.35s/it]  2%|‚ñè         | 2/100 [00:03<02:58,  1.82s/it]  3%|‚ñé         | 3/100 [00:04<02:25,  1.50s/it]  4%|‚ñç         | 4/100 [00:05<02:10,  1.36s/it]  5%|‚ñå         | 5/100 [00:06<02:02,  1.29s/it]  6%|‚ñå         | 6/100 [00:08<01:58,  1.26s/it]  7%|‚ñã         | 7/100 [00:09<01:49,  1.17s/it]  8%|‚ñä         | 8/100 [00:10<01:47,  1.16s/it]  9%|‚ñâ         | 9/100 [00:11<01:42,  1.12s/it] 10%|‚ñà         | 10/100 [00:12<01:44,  1.16s/it] 11%|‚ñà         | 11/100 [00:13<01:40,  1.13s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:43,  1.18s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:40,  1.16s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:39,  1.16s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:34,  1.11s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:49,  1.30s/it] 17%|‚ñà‚ñã        | 17/100 [00:22<02:14,  1.62s/it] 18%|‚ñà‚ñä        | 18/100 [00:23<01:59,  1.46s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<01:50,  1.36s/it] 20%|‚ñà‚ñà        | 20/100 [00:25<01:42,  1.28s/it] 21%|‚ñà‚ñà        | 21/100 [00:26<01:34,  1.20s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:27<01:30,  1.17s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:28<01:26,  1.13s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:29<01:27,  1.15s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:31<01:25,  1.14s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:32<01:26,  1.16s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:33<01:23,  1.14s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:34<01:20,  1.12s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:35<01:19,  1.13s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:36<01:22,  1.17s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:37<01:18,  1.13s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:38<01:15,  1.11s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:40<01:30,  1.35s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:43<01:47,  1.63s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:44<01:35,  1.47s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:45<01:31,  1.43s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:46<01:25,  1.36s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:47<01:21,  1.32s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:49<01:16,  1.25s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:50<01:13,  1.22s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:51<01:09,  1.17s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:52<01:10,  1.22s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:53<01:07,  1.18s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:54<01:06,  1.19s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:56<01:05,  1.20s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:57<01:04,  1.19s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:58<01:00,  1.14s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:59<01:07,  1.29s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:02<01:20,  1.57s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:03<01:12,  1.45s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:04<01:05,  1.33s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:05<01:01,  1.28s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:06<00:56,  1.21s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:07<00:54,  1.19s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:08<00:51,  1.14s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:10<00:53,  1.21s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:11<00:56,  1.32s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:13<01:01,  1.45s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:14<00:59,  1.45s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:16<00:55,  1.38s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:17<00:50,  1.29s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:18<00:47,  1.25s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:19<00:45,  1.23s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:20<00:43,  1.22s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:21<00:40,  1.17s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:22<00:39,  1.15s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:23<00:36,  1.10s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:24<00:34,  1.07s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:26<00:33,  1.08s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:27<00:33,  1.11s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:28<00:33,  1.14s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:30<00:40,  1.43s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:32<00:44,  1.65s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:33<00:38,  1.49s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:34<00:34,  1.38s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:36<00:31,  1.32s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:37<00:29,  1.27s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:38<00:27,  1.26s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:39<00:25,  1.22s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:40<00:24,  1.21s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:42<00:23,  1.23s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:43<00:22,  1.28s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:44<00:21,  1.28s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:46<00:20,  1.30s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:47<00:18,  1.26s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:48<00:19,  1.40s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:50<00:19,  1.47s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:52<00:19,  1.62s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:54<00:18,  1.67s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:55<00:15,  1.53s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:56<00:12,  1.37s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:57<00:10,  1.32s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:58<00:08,  1.25s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:00<00:07,  1.22s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:00<00:05,  1.15s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:02<00:04,  1.16s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:03<00:03,  1.12s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:04<00:02,  1.13s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:05<00:01,  1.12s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:06<00:00,  1.14s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:06<00:00,  1.27s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.021 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.16908
wandb: 
wandb: üöÄ View run stilted-sweep-119 at: https://wandb.ai/xzy11632/dance-dev/runs/mvk2dm8d
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_123710-mvk2dm8d/logs
wandb: Agent Starting Run: u03tuyjg with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPercentile
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_124055-u03tuyjg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run valiant-sweep-120
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/u03tuyjg
[INFO][2024-03-16 12:41:01,116][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 12:41:01,205][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 12:41:01,206][dance][wrapped_func] Took 0:00:00.088401 to load and process data.
[INFO][2024-03-16 12:41:01,206][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 12:41:01,207][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPercentile',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 12:41:03,278][dance.WeightedFeatureSVD][__call__] Decomposing train features (7963, 200) (k=93)
[INFO][2024-03-16 12:41:03,279][dance.WeightedFeatureSVD][__call__] Total explained variance: 88.79%
[INFO][2024-03-16 12:41:04,976][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 12:41:04,976][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 12:41:04,976][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 12:41:04,976][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:44,  1.05s/it]  2%|‚ñè         | 2/100 [00:02<01:38,  1.01s/it]  3%|‚ñé         | 3/100 [00:03<01:49,  1.13s/it]  4%|‚ñç         | 4/100 [00:04<01:47,  1.12s/it]  5%|‚ñå         | 5/100 [00:05<01:43,  1.09s/it]  6%|‚ñå         | 6/100 [00:06<01:40,  1.07s/it]  7%|‚ñã         | 7/100 [00:07<01:40,  1.08s/it]  8%|‚ñä         | 8/100 [00:08<01:40,  1.10s/it]  9%|‚ñâ         | 9/100 [00:09<01:42,  1.12s/it] 10%|‚ñà         | 10/100 [00:11<01:54,  1.28s/it] 11%|‚ñà         | 11/100 [00:13<02:08,  1.44s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:56,  1.32s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:49,  1.25s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:41,  1.18s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:36,  1.14s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<01:32,  1.10s/it] 17%|‚ñà‚ñã        | 17/100 [00:19<01:30,  1.09s/it] 18%|‚ñà‚ñä        | 18/100 [00:20<01:26,  1.06s/it] 19%|‚ñà‚ñâ        | 19/100 [00:21<01:24,  1.04s/it] 20%|‚ñà‚ñà        | 20/100 [00:22<01:25,  1.07s/it] 21%|‚ñà‚ñà        | 21/100 [00:24<01:30,  1.14s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:25<01:31,  1.17s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:26<01:32,  1.20s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:28<01:38,  1.30s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:30<01:54,  1.53s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:31<01:50,  1.49s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:33<02:00,  1.65s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:34<01:48,  1.50s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:35<01:37,  1.37s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:36<01:29,  1.28s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:37<01:23,  1.22s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:38<01:17,  1.14s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:40<01:18,  1.17s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:41<01:14,  1.13s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:42<01:12,  1.12s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:43<01:10,  1.11s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:44<01:13,  1.17s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:45<01:12,  1.17s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:46<01:10,  1.15s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:48<01:08,  1.14s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:49<01:07,  1.14s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:50<01:05,  1.14s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:51<01:09,  1.22s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:52<01:07,  1.21s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:54<01:18,  1.43s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:55<01:09,  1.29s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:56<01:02,  1.19s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:57<00:57,  1.11s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:58<00:55,  1.09s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:59<00:53,  1.07s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:00<00:50,  1.03s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:01<00:49,  1.04s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:02<00:49,  1.05s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:03<00:48,  1.06s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:04<00:46,  1.03s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:05<00:44,  1.01s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:06<00:44,  1.03s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:07<00:43,  1.03s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:09<00:45,  1.11s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:10<00:44,  1.11s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:11<00:47,  1.23s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:13<00:48,  1.28s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:14<00:51,  1.39s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:15<00:46,  1.28s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:16<00:42,  1.22s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:18<00:40,  1.19s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:19<00:38,  1.17s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:20<00:36,  1.14s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:21<00:36,  1.17s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:22<00:34,  1.16s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:23<00:32,  1.14s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:25<00:32,  1.17s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:26<00:32,  1.19s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:27<00:32,  1.27s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:30<00:42,  1.71s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:33<00:52,  2.20s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:35<00:44,  1.95s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:37<00:43,  1.96s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:38<00:37,  1.77s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:39<00:31,  1.55s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:40<00:27,  1.44s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:41<00:23,  1.30s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:42<00:20,  1.20s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:43<00:18,  1.16s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:44<00:17,  1.14s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:46<00:16,  1.16s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:47<00:14,  1.15s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:48<00:14,  1.20s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:49<00:13,  1.20s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:50<00:11,  1.18s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:52<00:11,  1.32s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:54<00:12,  1.55s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:55<00:10,  1.46s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:56<00:08,  1.39s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:58<00:06,  1.30s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:59<00:04,  1.23s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:00<00:03,  1.19s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:01<00:02,  1.19s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:02<00:01,  1.19s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:03<00:00,  1.18s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:03<00:00,  1.24s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.14861
wandb: 
wandb: üöÄ View run valiant-sweep-120 at: https://wandb.ai/xzy11632/dance-dev/runs/u03tuyjg
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_124055-u03tuyjg/logs
wandb: Agent Starting Run: h8uacxy0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_124429-h8uacxy0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run balmy-sweep-121
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/h8uacxy0
[INFO][2024-03-16 12:44:34,736][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 12:44:34,840][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 12:44:34,840][dance][wrapped_func] Took 0:00:00.103005 to load and process data.
[INFO][2024-03-16 12:44:34,840][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 12:44:34,842][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'Log1P',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 12:44:34,855][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 12:44:34,855][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 12:44:34,855][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 12:44:34,855][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 12:44:34,856][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 12:44:34,862][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 12:44:36,694][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 1000) (k=263)
[INFO][2024-03-16 12:44:36,694][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.01%
[INFO][2024-03-16 12:44:39,492][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 12:44:39,492][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 12:44:39,492][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 12:44:39,492][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:25,  1.47s/it]  2%|‚ñè         | 2/100 [00:03<02:31,  1.55s/it]  3%|‚ñé         | 3/100 [00:04<02:28,  1.53s/it]  4%|‚ñç         | 4/100 [00:05<02:20,  1.46s/it]  5%|‚ñå         | 5/100 [00:07<02:36,  1.65s/it]  6%|‚ñå         | 6/100 [00:10<03:19,  2.13s/it]  7%|‚ñã         | 7/100 [00:12<02:54,  1.87s/it]  8%|‚ñä         | 8/100 [00:13<02:40,  1.75s/it]  9%|‚ñâ         | 9/100 [00:15<02:29,  1.65s/it] 10%|‚ñà         | 10/100 [00:16<02:20,  1.56s/it] 11%|‚ñà         | 11/100 [00:17<02:12,  1.49s/it] 12%|‚ñà‚ñè        | 12/100 [00:19<02:09,  1.47s/it] 13%|‚ñà‚ñé        | 13/100 [00:20<02:08,  1.48s/it] 14%|‚ñà‚ñç        | 14/100 [00:22<02:08,  1.50s/it] 15%|‚ñà‚ñå        | 15/100 [00:23<02:07,  1.50s/it] 16%|‚ñà‚ñå        | 16/100 [00:25<02:07,  1.52s/it] 17%|‚ñà‚ñã        | 17/100 [00:26<02:02,  1.48s/it] 18%|‚ñà‚ñä        | 18/100 [00:28<01:57,  1.43s/it] 19%|‚ñà‚ñâ        | 19/100 [00:31<02:32,  1.88s/it] 20%|‚ñà‚ñà        | 20/100 [00:33<02:35,  1.95s/it] 21%|‚ñà‚ñà        | 21/100 [00:34<02:15,  1.72s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:35<02:01,  1.56s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:36<01:54,  1.49s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:38<01:46,  1.40s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:39<01:45,  1.41s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:40<01:40,  1.36s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:42<01:38,  1.35s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:43<01:39,  1.38s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:44<01:39,  1.40s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:46<01:39,  1.43s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:47<01:39,  1.45s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:49<01:34,  1.39s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:51<01:54,  1.71s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:55<02:35,  2.36s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:58<02:36,  2.41s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:59<02:14,  2.10s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:00<02:00,  1.92s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:02<01:48,  1.75s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:03<01:39,  1.63s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:05<01:38,  1.65s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:08<02:04,  2.11s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:10<01:57,  2.02s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:12<01:48,  1.91s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:13<01:39,  1.77s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:14<01:32,  1.67s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:16<01:25,  1.59s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:18<01:38,  1.85s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:21<01:45,  2.04s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:22<01:34,  1.85s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:24<01:27,  1.75s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:25<01:21,  1.67s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:27<01:16,  1.59s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:28<01:13,  1.57s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:30<01:15,  1.63s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:32<01:14,  1.65s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:33<01:11,  1.62s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:35<01:07,  1.58s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:36<01:04,  1.55s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:38<01:09,  1.70s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:41<01:21,  2.04s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:42<01:11,  1.83s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:44<01:04,  1.71s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:45<01:00,  1.65s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:47<00:58,  1.63s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:48<00:54,  1.57s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:50<00:51,  1.51s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:51<00:52,  1.59s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:53<00:53,  1.66s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:55<00:48,  1.55s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:56<00:47,  1.57s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:58<00:45,  1.55s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:59<00:41,  1.49s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:03<00:57,  2.11s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:06<01:07,  2.59s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:08<00:56,  2.26s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:09<00:47,  2.00s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:11<00:41,  1.81s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:13<00:44,  2.01s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:16<00:51,  2.44s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:19<00:52,  2.61s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:22<00:50,  2.64s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:24<00:42,  2.34s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:26<00:37,  2.18s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:27<00:30,  1.93s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:29<00:30,  2.05s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:32<00:32,  2.34s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:34<00:26,  2.07s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:35<00:23,  1.92s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:37<00:19,  1.77s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:38<00:16,  1.68s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:40<00:14,  1.57s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:41<00:12,  1.51s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:42<00:10,  1.53s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:44<00:09,  1.51s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:45<00:07,  1.48s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:47<00:06,  1.54s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:49<00:04,  1.56s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:51<00:03,  1.70s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:53<00:01,  1.84s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:54<00:00,  1.79s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:54<00:00,  1.75s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.016 MB of 0.026 MB uploadedwandb: \ 0.016 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.28703
wandb: 
wandb: üöÄ View run balmy-sweep-121 at: https://wandb.ai/xzy11632/dance-dev/runs/h8uacxy0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_124429-h8uacxy0/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: te2lcxzi with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_124917-te2lcxzi
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run misty-sweep-122
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/te2lcxzi
[INFO][2024-03-16 12:49:22,904][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 12:49:22,991][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 12:49:22,991][dance][wrapped_func] Took 0:00:00.085810 to load and process data.
[INFO][2024-03-16 12:49:22,991][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 12:49:22,993][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'Log1P',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 12:49:23,005][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 12:49:23,006][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 12:49:23,006][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 12:49:23,006][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 12:49:23,006][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 12:49:23,012][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 12:49:30,705][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 1000) (k=624)
[INFO][2024-03-16 12:49:30,705][dance.WeightedFeatureSVD][__call__] Total explained variance: 96.60%
[INFO][2024-03-16 12:49:33,618][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 12:49:33,618][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 12:49:33,618][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 12:49:33,619][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:20,  1.42s/it]  2%|‚ñè         | 2/100 [00:02<02:21,  1.44s/it]  3%|‚ñé         | 3/100 [00:04<02:23,  1.48s/it]  4%|‚ñç         | 4/100 [00:05<02:17,  1.43s/it]  5%|‚ñå         | 5/100 [00:11<04:55,  3.11s/it]  6%|‚ñå         | 6/100 [00:17<05:59,  3.83s/it]  7%|‚ñã         | 7/100 [00:21<06:21,  4.10s/it]  8%|‚ñä         | 8/100 [00:26<06:26,  4.20s/it]  9%|‚ñâ         | 9/100 [00:30<06:36,  4.36s/it] 10%|‚ñà         | 10/100 [00:35<06:30,  4.34s/it] 11%|‚ñà         | 11/100 [00:38<05:59,  4.03s/it] 12%|‚ñà‚ñè        | 12/100 [00:41<05:37,  3.83s/it] 13%|‚ñà‚ñé        | 13/100 [00:45<05:18,  3.66s/it] 14%|‚ñà‚ñç        | 14/100 [00:48<05:03,  3.53s/it] 15%|‚ñà‚ñå        | 15/100 [00:51<04:54,  3.46s/it] 16%|‚ñà‚ñå        | 16/100 [00:57<05:41,  4.07s/it] 17%|‚ñà‚ñã        | 17/100 [01:00<05:19,  3.86s/it] 18%|‚ñà‚ñä        | 18/100 [01:03<05:02,  3.69s/it] 19%|‚ñà‚ñâ        | 19/100 [01:07<04:47,  3.55s/it] 20%|‚ñà‚ñà        | 20/100 [01:10<04:37,  3.47s/it] 21%|‚ñà‚ñà        | 21/100 [01:13<04:29,  3.41s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [01:16<04:23,  3.38s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [01:20<04:19,  3.38s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [01:23<04:20,  3.43s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [01:27<04:18,  3.44s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [01:30<04:09,  3.37s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [01:35<04:46,  3.93s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [01:38<04:25,  3.69s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [01:42<04:12,  3.56s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [01:45<04:01,  3.45s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [01:48<03:56,  3.43s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:51<03:47,  3.34s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:54<03:32,  3.17s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:56<03:06,  2.83s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:58<02:43,  2.51s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:59<02:22,  2.23s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [02:02<02:28,  2.36s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [02:05<02:39,  2.57s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [02:07<02:14,  2.21s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [02:08<01:58,  1.98s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [02:10<01:51,  1.88s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [02:11<01:45,  1.82s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [02:13<01:35,  1.68s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [02:14<01:30,  1.61s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [02:16<01:29,  1.62s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [02:17<01:26,  1.61s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [02:19<01:30,  1.70s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [02:21<01:28,  1.69s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [02:22<01:24,  1.65s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [02:24<01:17,  1.55s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [02:27<01:36,  1.97s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [02:29<01:37,  2.03s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [02:31<01:29,  1.90s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [02:34<01:53,  2.47s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [02:37<01:57,  2.62s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [02:39<01:49,  2.50s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [02:41<01:40,  2.33s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [02:43<01:32,  2.20s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [02:45<01:28,  2.17s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [02:48<01:27,  2.18s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [02:50<01:22,  2.11s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [02:54<01:43,  2.72s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [02:56<01:31,  2.48s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [02:58<01:22,  2.30s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [02:59<01:16,  2.19s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [03:01<01:12,  2.13s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [03:03<01:07,  2.04s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [03:05<01:05,  2.06s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [03:08<01:05,  2.10s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [03:10<01:03,  2.13s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [03:12<01:01,  2.13s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [03:14<00:57,  2.04s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [03:18<01:12,  2.70s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [03:20<01:02,  2.41s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [03:21<00:54,  2.18s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [03:23<00:47,  1.98s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [03:25<00:44,  1.94s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [03:26<00:41,  1.89s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [03:29<00:40,  1.94s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [03:31<00:39,  1.99s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [03:33<00:37,  1.97s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [03:35<00:35,  1.97s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [03:36<00:31,  1.87s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [03:41<00:46,  2.88s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [03:43<00:38,  2.57s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [03:45<00:32,  2.34s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [03:47<00:29,  2.26s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [03:49<00:26,  2.21s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [03:51<00:22,  2.07s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [03:53<00:21,  2.11s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [03:55<00:18,  2.06s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [03:57<00:16,  2.11s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [03:59<00:14,  2.08s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [04:01<00:11,  1.94s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [04:05<00:12,  2.46s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [04:06<00:08,  2.24s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [04:08<00:06,  2.08s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [04:09<00:03,  1.88s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [04:11<00:01,  1.77s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [04:13<00:00,  1.73s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [04:13<00:00,  2.53s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.018 MB of 0.026 MB uploadedwandb: | 0.018 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.24673
wandb: 
wandb: üöÄ View run misty-sweep-122 at: https://wandb.ai/xzy11632/dance-dev/runs/te2lcxzi
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_124917-te2lcxzi/logs
wandb: Agent Starting Run: 28bwcbcy with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_125508-28bwcbcy
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run deep-sweep-123
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/28bwcbcy
[INFO][2024-03-16 12:55:14,625][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 12:55:14,766][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 12:55:14,767][dance][wrapped_func] Took 0:00:00.140996 to load and process data.
[INFO][2024-03-16 12:55:14,767][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 12:55:14,770][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'Log1P',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 12:55:14,802][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 12:55:14,803][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 12:55:14,804][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 12:55:14,804][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 12:55:15,017][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run deep-sweep-123 at: https://wandb.ai/xzy11632/dance-dev/runs/28bwcbcy
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_125508-28bwcbcy/logs
wandb: ERROR Run 28bwcbcy errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1000) out of bounds (1000)
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 0b44wf60 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_125539-0b44wf60
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fragrant-sweep-124
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/0b44wf60
[INFO][2024-03-16 12:55:44,967][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 12:55:45,077][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 12:55:45,077][dance][wrapped_func] Took 0:00:00.109210 to load and process data.
[INFO][2024-03-16 12:55:45,077][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 12:55:45,079][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'Log1P',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 12:55:45,096][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 12:55:45,096][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 12:55:45,097][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 12:55:45,097][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 12:55:45,272][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.017 MB of 0.024 MB uploadedwandb: / 0.017 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run fragrant-sweep-124 at: https://wandb.ai/xzy11632/dance-dev/runs/0b44wf60
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_125539-0b44wf60/logs
wandb: ERROR Run 0b44wf60 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1000) out of bounds (1000)
wandb: ERROR 
wandb: Agent Starting Run: 1r3nxj2i with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_125556-1r3nxj2i
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run youthful-sweep-125
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/1r3nxj2i
[INFO][2024-03-16 12:56:01,213][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 12:56:01,315][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 12:56:01,315][dance][wrapped_func] Took 0:00:00.096239 to load and process data.
[INFO][2024-03-16 12:56:01,315][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 12:56:01,317][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'Log1P',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 12:56:01,332][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 12:56:01,332][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 12:56:01,333][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 12:56:01,333][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 12:56:01,658][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=120)
[INFO][2024-03-16 12:56:01,659][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.14%
[INFO][2024-03-16 12:56:05,551][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 12:56:05,551][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 12:56:05,551][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 12:56:05,551][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:44,  1.66s/it]  2%|‚ñè         | 2/100 [00:03<02:42,  1.66s/it]  3%|‚ñé         | 3/100 [00:04<02:36,  1.62s/it]  4%|‚ñç         | 4/100 [00:06<02:53,  1.81s/it]  5%|‚ñå         | 5/100 [00:08<02:52,  1.81s/it]  6%|‚ñå         | 6/100 [00:11<03:11,  2.04s/it]  7%|‚ñã         | 7/100 [00:12<02:49,  1.82s/it]  8%|‚ñä         | 8/100 [00:14<02:34,  1.68s/it]  9%|‚ñâ         | 9/100 [00:15<02:24,  1.59s/it] 10%|‚ñà         | 10/100 [00:16<02:15,  1.51s/it] 11%|‚ñà         | 11/100 [00:18<02:07,  1.44s/it] 12%|‚ñà‚ñè        | 12/100 [00:19<02:04,  1.42s/it] 13%|‚ñà‚ñé        | 13/100 [00:21<02:09,  1.49s/it] 14%|‚ñà‚ñç        | 14/100 [00:22<02:03,  1.44s/it] 15%|‚ñà‚ñå        | 15/100 [00:23<02:01,  1.43s/it] 16%|‚ñà‚ñå        | 16/100 [00:25<01:56,  1.38s/it] 17%|‚ñà‚ñã        | 17/100 [00:26<01:49,  1.32s/it] 18%|‚ñà‚ñä        | 18/100 [00:27<01:42,  1.24s/it] 19%|‚ñà‚ñâ        | 19/100 [00:29<01:57,  1.44s/it] 20%|‚ñà‚ñà        | 20/100 [00:31<02:23,  1.80s/it] 21%|‚ñà‚ñà        | 21/100 [00:32<02:06,  1.61s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:34<01:55,  1.48s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:35<01:46,  1.39s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:36<01:39,  1.31s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:37<01:32,  1.23s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:38<01:33,  1.27s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:40<01:32,  1.27s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:41<01:29,  1.25s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:42<01:29,  1.26s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:44<01:31,  1.31s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:45<01:35,  1.39s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:46<01:34,  1.38s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:48<01:43,  1.55s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:50<01:37,  1.48s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:52<01:56,  1.79s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:55<02:06,  1.98s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:56<01:52,  1.78s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:58<01:46,  1.72s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:59<01:36,  1.58s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:00<01:26,  1.44s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:01<01:21,  1.38s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:02<01:18,  1.36s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:04<01:16,  1.34s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:05<01:15,  1.35s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:06<01:13,  1.34s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:09<01:32,  1.71s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:11<01:39,  1.89s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:14<01:47,  2.08s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:16<01:53,  2.22s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:19<01:57,  2.35s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:23<02:18,  2.82s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:26<02:19,  2.90s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:28<02:00,  2.56s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:30<01:48,  2.35s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:31<01:35,  2.12s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:32<01:20,  1.83s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:33<01:08,  1.59s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:35<01:03,  1.51s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:36<01:00,  1.49s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:38<00:59,  1.49s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:39<00:56,  1.44s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:40<00:53,  1.40s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:42<00:49,  1.35s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:44<00:58,  1.63s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:47<01:09,  1.98s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:48<00:59,  1.75s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:49<00:52,  1.59s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:50<00:47,  1.49s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:52<00:44,  1.44s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:53<00:41,  1.38s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:54<00:39,  1.36s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:56<00:37,  1.35s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:57<00:35,  1.31s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:58<00:36,  1.42s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:00<00:35,  1.41s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:01<00:33,  1.38s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:02<00:31,  1.36s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:05<00:34,  1.57s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:07<00:37,  1.81s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:08<00:32,  1.64s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:09<00:28,  1.49s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:10<00:25,  1.40s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:12<00:23,  1.36s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:13<00:22,  1.39s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:15<00:20,  1.39s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:16<00:19,  1.37s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:17<00:18,  1.39s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:19<00:16,  1.36s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:20<00:14,  1.30s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:21<00:13,  1.31s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:23<00:12,  1.34s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:24<00:10,  1.27s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:25<00:08,  1.19s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:26<00:08,  1.39s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:29<00:08,  1.76s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:30<00:06,  1.56s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:32<00:04,  1.53s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:33<00:02,  1.40s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:34<00:01,  1.29s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:35<00:00,  1.29s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:35<00:00,  1.56s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.30837
wandb: 
wandb: üöÄ View run youthful-sweep-125 at: https://wandb.ai/xzy11632/dance-dev/runs/1r3nxj2i
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_125556-1r3nxj2i/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: mszyj5kx with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_130112-mszyj5kx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run feasible-sweep-126
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/mszyj5kx
[INFO][2024-03-16 13:01:17,545][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 13:01:17,635][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 13:01:17,635][dance][wrapped_func] Took 0:00:00.090105 to load and process data.
[INFO][2024-03-16 13:01:17,635][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 13:01:17,638][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'Log1P',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 13:01:17,651][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:01:17,652][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:01:17,652][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:01:17,652][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 13:01:21,354][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=116)
[INFO][2024-03-16 13:01:21,360][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.09%
[INFO][2024-03-16 13:01:25,393][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 13:01:25,394][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 13:01:25,394][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 13:01:25,394][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:05,  1.27s/it]  2%|‚ñè         | 2/100 [00:02<02:20,  1.43s/it]  3%|‚ñé         | 3/100 [00:04<02:11,  1.35s/it]  4%|‚ñç         | 4/100 [00:05<02:13,  1.39s/it]  5%|‚ñå         | 5/100 [00:06<02:07,  1.35s/it]  6%|‚ñå         | 6/100 [00:07<01:59,  1.28s/it]  7%|‚ñã         | 7/100 [00:09<02:00,  1.30s/it]  8%|‚ñä         | 8/100 [00:10<02:07,  1.38s/it]  9%|‚ñâ         | 9/100 [00:12<02:07,  1.40s/it] 10%|‚ñà         | 10/100 [00:13<02:09,  1.44s/it] 11%|‚ñà         | 11/100 [00:14<02:00,  1.36s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<02:13,  1.52s/it] 13%|‚ñà‚ñé        | 13/100 [00:19<02:43,  1.88s/it] 14%|‚ñà‚ñç        | 14/100 [00:20<02:27,  1.72s/it] 15%|‚ñà‚ñå        | 15/100 [00:23<02:52,  2.03s/it] 16%|‚ñà‚ñå        | 16/100 [00:25<02:44,  1.95s/it] 17%|‚ñà‚ñã        | 17/100 [00:26<02:20,  1.69s/it] 18%|‚ñà‚ñä        | 18/100 [00:27<02:10,  1.59s/it] 19%|‚ñà‚ñâ        | 19/100 [00:29<02:09,  1.60s/it] 20%|‚ñà‚ñà        | 20/100 [00:31<02:08,  1.61s/it] 21%|‚ñà‚ñà        | 21/100 [00:32<02:06,  1.60s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:34<02:02,  1.58s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:35<01:53,  1.48s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:36<01:50,  1.45s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:38<01:43,  1.38s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:40<02:00,  1.63s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:43<02:39,  2.18s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:46<02:42,  2.26s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:48<02:37,  2.21s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:50<02:26,  2.10s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:51<02:11,  1.91s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:52<01:57,  1.73s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:54<01:51,  1.66s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:55<01:45,  1.60s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:57<01:38,  1.51s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:58<01:29,  1.39s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:59<01:26,  1.37s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:01<01:29,  1.44s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:03<01:48,  1.77s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:05<01:40,  1.67s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:06<01:30,  1.53s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:07<01:21,  1.40s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:08<01:15,  1.32s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:09<01:13,  1.31s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:11<01:09,  1.26s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:12<01:07,  1.25s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:13<01:05,  1.23s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:14<01:05,  1.27s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:16<01:06,  1.30s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:17<01:05,  1.31s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:18<01:03,  1.30s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:20<01:11,  1.48s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:23<01:30,  1.93s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:25<01:21,  1.77s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:26<01:19,  1.76s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:28<01:13,  1.68s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:29<01:07,  1.58s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:31<01:03,  1.52s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:32<00:58,  1.43s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:33<00:57,  1.44s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:35<00:55,  1.42s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:36<00:56,  1.48s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:38<00:52,  1.42s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:39<00:54,  1.50s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:41<00:50,  1.44s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:43<01:04,  1.89s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:45<00:55,  1.67s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:46<00:48,  1.51s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:47<00:45,  1.46s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:48<00:41,  1.40s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:50<00:39,  1.35s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:51<00:36,  1.30s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:52<00:35,  1.32s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:53<00:34,  1.34s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:55<00:33,  1.34s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:56<00:31,  1.32s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:57<00:30,  1.34s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:59<00:29,  1.33s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:01<00:32,  1.53s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:03<00:35,  1.77s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:05<00:31,  1.67s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:06<00:30,  1.68s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:08<00:28,  1.67s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:09<00:25,  1.59s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:10<00:21,  1.45s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:12<00:19,  1.37s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:13<00:17,  1.38s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:14<00:16,  1.35s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:16<00:14,  1.35s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:18<00:15,  1.53s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:19<00:14,  1.63s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:21<00:13,  1.68s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:23<00:11,  1.69s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:24<00:09,  1.52s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:26<00:07,  1.57s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:28<00:06,  1.65s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:30<00:05,  1.75s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:31<00:03,  1.64s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:32<00:01,  1.50s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:33<00:00,  1.44s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:33<00:00,  1.54s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.018 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.29821
wandb: 
wandb: üöÄ View run feasible-sweep-126 at: https://wandb.ai/xzy11632/dance-dev/runs/mszyj5kx
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_130112-mszyj5kx/logs
wandb: Agent Starting Run: vv48wj2l with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_130554-vv48wj2l
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run hearty-sweep-127
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/vv48wj2l
[INFO][2024-03-16 13:06:00,226][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 13:06:00,316][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 13:06:00,316][dance][wrapped_func] Took 0:00:00.089254 to load and process data.
[INFO][2024-03-16 13:06:00,316][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 13:06:00,319][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 13:06:00,338][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:06:00,339][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:06:00,340][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:06:00,340][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 13:06:00,758][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 158) (k=63)
[INFO][2024-03-16 13:06:00,759][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.00%
[INFO][2024-03-16 13:06:02,811][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 13:06:02,812][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 13:06:02,812][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 13:06:02,812][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:12,  1.34s/it]  2%|‚ñè         | 2/100 [00:02<02:22,  1.45s/it]  3%|‚ñé         | 3/100 [00:04<02:09,  1.33s/it]  4%|‚ñç         | 4/100 [00:05<02:06,  1.32s/it]  5%|‚ñå         | 5/100 [00:06<02:04,  1.31s/it]  6%|‚ñå         | 6/100 [00:08<02:08,  1.37s/it]  7%|‚ñã         | 7/100 [00:09<02:07,  1.37s/it]  8%|‚ñä         | 8/100 [00:10<01:56,  1.27s/it]  9%|‚ñâ         | 9/100 [00:12<02:15,  1.48s/it] 10%|‚ñà         | 10/100 [00:14<02:28,  1.65s/it] 11%|‚ñà         | 11/100 [00:15<02:12,  1.49s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<02:03,  1.41s/it] 13%|‚ñà‚ñé        | 13/100 [00:18<01:55,  1.33s/it] 14%|‚ñà‚ñç        | 14/100 [00:19<01:51,  1.29s/it] 15%|‚ñà‚ñå        | 15/100 [00:20<01:45,  1.25s/it] 16%|‚ñà‚ñå        | 16/100 [00:21<01:39,  1.18s/it] 17%|‚ñà‚ñã        | 17/100 [00:22<01:37,  1.17s/it] 18%|‚ñà‚ñä        | 18/100 [00:23<01:37,  1.18s/it] 19%|‚ñà‚ñâ        | 19/100 [00:25<01:37,  1.21s/it] 20%|‚ñà‚ñà        | 20/100 [00:26<01:38,  1.23s/it] 21%|‚ñà‚ñà        | 21/100 [00:27<01:39,  1.26s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:28<01:36,  1.24s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:30<01:35,  1.24s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:31<01:49,  1.44s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:34<02:03,  1.64s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:35<01:58,  1.61s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:36<01:50,  1.52s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:38<01:42,  1.43s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:39<01:37,  1.38s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:40<01:35,  1.37s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:42<01:33,  1.35s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:43<01:32,  1.36s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:44<01:34,  1.41s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:46<01:29,  1.35s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:47<01:26,  1.34s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:48<01:22,  1.29s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:49<01:18,  1.24s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:51<01:31,  1.48s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:54<01:51,  1.84s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:55<01:40,  1.68s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:57<01:30,  1.53s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:58<01:21,  1.41s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:59<01:19,  1.39s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:00<01:16,  1.36s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:02<01:15,  1.37s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:03<01:11,  1.32s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:04<01:09,  1.30s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:05<01:06,  1.28s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:07<01:05,  1.29s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:08<01:02,  1.25s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:09<01:00,  1.24s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:10<00:58,  1.23s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:12<01:06,  1.41s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:14<01:13,  1.59s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:16<01:11,  1.59s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:17<01:07,  1.54s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:18<01:02,  1.45s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:20<00:57,  1.37s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:21<00:54,  1.32s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:22<00:51,  1.29s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:23<00:49,  1.28s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:25<00:49,  1.29s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:26<00:46,  1.26s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:27<00:45,  1.26s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:28<00:42,  1.22s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:30<00:47,  1.41s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:32<00:49,  1.49s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:34<00:52,  1.63s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:35<00:46,  1.51s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:36<00:42,  1.41s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:37<00:38,  1.33s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:38<00:36,  1.30s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:40<00:34,  1.27s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:41<00:31,  1.22s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:42<00:30,  1.22s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:43<00:28,  1.20s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:44<00:28,  1.23s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:46<00:27,  1.23s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:47<00:26,  1.26s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:48<00:24,  1.20s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:50<00:26,  1.42s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:52<00:29,  1.63s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:53<00:26,  1.54s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:54<00:22,  1.41s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:56<00:19,  1.32s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:57<00:18,  1.29s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:58<00:16,  1.30s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:00<00:16,  1.37s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:01<00:14,  1.36s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:02<00:13,  1.34s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:03<00:11,  1.29s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:05<00:10,  1.27s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:06<00:08,  1.28s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:08<00:09,  1.62s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:10<00:08,  1.68s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:12<00:07,  1.80s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:14<00:04,  1.65s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:15<00:03,  1.58s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:16<00:01,  1.49s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:18<00:00,  1.43s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:18<00:00,  1.38s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.27234
wandb: 
wandb: üöÄ View run hearty-sweep-127 at: https://wandb.ai/xzy11632/dance-dev/runs/vv48wj2l
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_130554-vv48wj2l/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: dur0mhyl with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_131033-dur0mhyl
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run flowing-sweep-128
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/dur0mhyl
[INFO][2024-03-16 13:10:38,983][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 13:10:39,077][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 13:10:39,077][dance][wrapped_func] Took 0:00:00.093792 to load and process data.
[INFO][2024-03-16 13:10:39,078][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 13:10:39,080][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 13:10:39,097][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:10:39,098][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:10:39,098][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:10:39,098][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 13:10:44,734][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 158) (k=75)
[INFO][2024-03-16 13:10:44,735][dance.WeightedFeatureSVD][__call__] Total explained variance: 91.90%
[INFO][2024-03-16 13:10:54,630][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 13:10:54,631][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 13:10:54,631][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 13:10:54,631][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:01,  1.23s/it]  2%|‚ñè         | 2/100 [00:02<02:11,  1.34s/it]  3%|‚ñé         | 3/100 [00:04<02:24,  1.49s/it]  4%|‚ñç         | 4/100 [00:05<02:17,  1.43s/it]  5%|‚ñå         | 5/100 [00:06<02:10,  1.37s/it]  6%|‚ñå         | 6/100 [00:08<02:11,  1.40s/it]  7%|‚ñã         | 7/100 [00:09<02:15,  1.46s/it]  8%|‚ñä         | 8/100 [00:11<02:14,  1.46s/it]  9%|‚ñâ         | 9/100 [00:12<02:07,  1.40s/it] 10%|‚ñà         | 10/100 [00:14<02:10,  1.45s/it] 11%|‚ñà         | 11/100 [00:15<02:11,  1.47s/it] 12%|‚ñà‚ñè        | 12/100 [00:17<02:29,  1.70s/it] 13%|‚ñà‚ñé        | 13/100 [00:19<02:16,  1.57s/it] 14%|‚ñà‚ñç        | 14/100 [00:20<02:02,  1.43s/it] 15%|‚ñà‚ñå        | 15/100 [00:21<01:57,  1.38s/it] 16%|‚ñà‚ñå        | 16/100 [00:22<01:52,  1.34s/it] 17%|‚ñà‚ñã        | 17/100 [00:24<01:52,  1.35s/it] 18%|‚ñà‚ñä        | 18/100 [00:25<01:49,  1.33s/it] 19%|‚ñà‚ñâ        | 19/100 [00:26<01:48,  1.34s/it] 20%|‚ñà‚ñà        | 20/100 [00:28<01:44,  1.31s/it] 21%|‚ñà‚ñà        | 21/100 [00:29<01:44,  1.32s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:30<01:41,  1.30s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:31<01:38,  1.28s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:33<01:39,  1.31s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:35<01:54,  1.53s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:37<02:06,  1.70s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:38<01:53,  1.55s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:39<01:43,  1.44s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:41<01:36,  1.36s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:42<01:33,  1.34s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:43<01:31,  1.33s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:44<01:28,  1.30s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:46<01:28,  1.32s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:47<01:27,  1.33s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:49<01:28,  1.37s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:50<01:28,  1.38s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:51<01:24,  1.33s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:52<01:21,  1.31s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:54<01:30,  1.48s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:57<01:41,  1.70s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:58<01:32,  1.57s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:59<01:23,  1.44s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:00<01:16,  1.35s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:01<01:15,  1.35s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:03<01:12,  1.31s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:04<01:08,  1.27s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:05<01:08,  1.29s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:06<01:04,  1.25s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:07<01:01,  1.21s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:09<01:02,  1.25s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:10<00:59,  1.21s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:11<00:57,  1.19s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:13<01:02,  1.32s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:14<01:02,  1.36s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:16<01:07,  1.51s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:17<01:00,  1.38s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:18<00:56,  1.30s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:19<00:52,  1.25s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:20<00:48,  1.19s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:21<00:45,  1.14s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:23<00:44,  1.14s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:24<00:47,  1.24s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:25<00:47,  1.27s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:27<00:46,  1.30s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:28<00:46,  1.32s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:30<00:46,  1.36s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:31<00:41,  1.27s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:32<00:38,  1.22s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:33<00:41,  1.34s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:35<00:46,  1.55s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:36<00:40,  1.39s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:38<00:37,  1.34s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:39<00:34,  1.27s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:40<00:31,  1.22s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:41<00:31,  1.26s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:42<00:29,  1.23s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:44<00:28,  1.25s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:45<00:28,  1.31s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:47<00:28,  1.36s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:48<00:25,  1.29s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:49<00:24,  1.29s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:50<00:22,  1.26s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:51<00:20,  1.23s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:52<00:18,  1.18s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:54<00:17,  1.17s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:55<00:18,  1.30s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:56<00:17,  1.32s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:59<00:19,  1.63s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:01<00:18,  1.67s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:02<00:17,  1.72s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:04<00:15,  1.74s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:05<00:12,  1.58s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:07<00:10,  1.43s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:08<00:07,  1.31s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:09<00:06,  1.24s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:10<00:04,  1.25s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:11<00:03,  1.21s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:12<00:02,  1.23s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:14<00:01,  1.24s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:15<00:00,  1.19s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:15<00:00,  1.35s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.26395
wandb: 
wandb: üöÄ View run flowing-sweep-128 at: https://wandb.ai/xzy11632/dance-dev/runs/dur0mhyl
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_131033-dur0mhyl/logs
wandb: Agent Starting Run: vgb66u49 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_131442-vgb66u49
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run worldly-sweep-129
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/vgb66u49
[INFO][2024-03-16 13:14:47,848][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 13:14:47,951][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 13:14:47,951][dance][wrapped_func] Took 0:00:00.101780 to load and process data.
[INFO][2024-03-16 13:14:47,951][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 13:14:47,954][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 13:14:47,970][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:14:47,970][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:14:47,971][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:14:47,971][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 13:14:48,622][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=21)
[INFO][2024-03-16 13:14:48,623][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.11%
[INFO][2024-03-16 13:14:51,473][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 13:14:51,474][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 13:14:51,474][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 13:14:51,474][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:12,  1.34s/it]  2%|‚ñè         | 2/100 [00:02<02:02,  1.25s/it]  3%|‚ñé         | 3/100 [00:03<02:05,  1.29s/it]  4%|‚ñç         | 4/100 [00:05<02:05,  1.30s/it]  5%|‚ñå         | 5/100 [00:06<01:59,  1.26s/it]  6%|‚ñå         | 6/100 [00:07<01:57,  1.25s/it]  7%|‚ñã         | 7/100 [00:08<01:57,  1.26s/it]  8%|‚ñä         | 8/100 [00:10<02:07,  1.38s/it]  9%|‚ñâ         | 9/100 [00:12<02:22,  1.57s/it] 10%|‚ñà         | 10/100 [00:13<02:14,  1.49s/it] 11%|‚ñà         | 11/100 [00:15<02:07,  1.44s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<02:02,  1.39s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<02:01,  1.40s/it] 14%|‚ñà‚ñç        | 14/100 [00:19<01:56,  1.36s/it] 15%|‚ñà‚ñå        | 15/100 [00:20<01:51,  1.31s/it] 16%|‚ñà‚ñå        | 16/100 [00:21<01:52,  1.34s/it] 17%|‚ñà‚ñã        | 17/100 [00:22<01:46,  1.28s/it] 18%|‚ñà‚ñä        | 18/100 [00:24<01:42,  1.25s/it] 19%|‚ñà‚ñâ        | 19/100 [00:25<01:42,  1.27s/it] 20%|‚ñà‚ñà        | 20/100 [00:26<01:42,  1.28s/it] 21%|‚ñà‚ñà        | 21/100 [00:27<01:39,  1.25s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:29<01:43,  1.33s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:30<01:38,  1.27s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:31<01:36,  1.27s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:33<01:47,  1.43s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:35<02:01,  1.64s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:37<01:56,  1.59s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:38<01:45,  1.46s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:39<01:35,  1.35s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:40<01:30,  1.29s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:41<01:29,  1.30s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:43<01:25,  1.25s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:44<01:22,  1.23s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:45<01:19,  1.21s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:46<01:19,  1.23s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:47<01:18,  1.22s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:49<01:15,  1.20s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:50<01:14,  1.20s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:51<01:12,  1.19s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:53<01:20,  1.34s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:55<01:32,  1.57s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:56<01:23,  1.44s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:57<01:20,  1.41s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:59<01:18,  1.40s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:00<01:13,  1.34s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:01<01:10,  1.31s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:02<01:07,  1.27s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:04<01:08,  1.31s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:05<01:10,  1.39s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:07<01:09,  1.39s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:08<01:08,  1.40s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:09<01:03,  1.32s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:10<00:59,  1.27s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:11<00:57,  1.25s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:13<00:55,  1.24s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:14<00:59,  1.36s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:16<01:08,  1.58s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:18<01:02,  1.48s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:19<00:56,  1.38s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:21<01:01,  1.54s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:22<01:01,  1.57s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:24<01:02,  1.64s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:25<00:54,  1.47s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:26<00:48,  1.36s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:27<00:45,  1.29s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:29<00:43,  1.28s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:30<00:41,  1.26s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:31<00:39,  1.23s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:32<00:37,  1.22s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:33<00:35,  1.18s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:34<00:32,  1.13s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:36<00:37,  1.35s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:39<00:44,  1.64s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:40<00:39,  1.53s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:41<00:35,  1.41s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:42<00:32,  1.35s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:44<00:33,  1.44s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:45<00:31,  1.42s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:46<00:29,  1.39s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:48<00:26,  1.31s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:49<00:24,  1.28s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:50<00:23,  1.29s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:51<00:21,  1.28s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:53<00:20,  1.28s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:54<00:19,  1.32s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:56<00:20,  1.47s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:58<00:20,  1.59s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:00<00:21,  1.77s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:01<00:17,  1.62s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:02<00:14,  1.47s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:04<00:12,  1.41s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:05<00:10,  1.37s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:06<00:08,  1.28s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:07<00:07,  1.24s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:08<00:06,  1.28s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:10<00:05,  1.27s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:11<00:03,  1.26s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:12<00:02,  1.25s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:13<00:01,  1.19s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:15<00:00,  1.23s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:15<00:00,  1.35s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.017 MB of 0.025 MB uploadedwandb: | 0.017 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.28662
wandb: 
wandb: üöÄ View run worldly-sweep-129 at: https://wandb.ai/xzy11632/dance-dev/runs/vgb66u49
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_131442-vgb66u49/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: i3h5pcmb with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_131840-i3h5pcmb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run bright-sweep-130
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/i3h5pcmb
[INFO][2024-03-16 13:18:46,116][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 13:18:46,204][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 13:18:46,204][dance][wrapped_func] Took 0:00:00.087297 to load and process data.
[INFO][2024-03-16 13:18:46,204][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 13:18:46,206][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 13:18:46,221][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:18:46,221][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:18:46,222][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:18:46,222][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 13:18:48,882][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=93)
[INFO][2024-03-16 13:18:48,887][dance.WeightedFeatureSVD][__call__] Total explained variance: 96.23%
[INFO][2024-03-16 13:18:51,769][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 13:18:51,769][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 13:18:51,769][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 13:18:51,769][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:18,  1.40s/it]  2%|‚ñè         | 2/100 [00:02<02:05,  1.28s/it]  3%|‚ñé         | 3/100 [00:04<02:26,  1.51s/it]  4%|‚ñç         | 4/100 [00:06<02:50,  1.78s/it]  5%|‚ñå         | 5/100 [00:07<02:29,  1.57s/it]  6%|‚ñå         | 6/100 [00:09<02:20,  1.49s/it]  7%|‚ñã         | 7/100 [00:10<02:10,  1.40s/it]  8%|‚ñä         | 8/100 [00:11<02:06,  1.38s/it]  9%|‚ñâ         | 9/100 [00:12<01:58,  1.30s/it] 10%|‚ñà         | 10/100 [00:13<01:51,  1.24s/it] 11%|‚ñà         | 11/100 [00:15<01:50,  1.24s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<01:52,  1.28s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<01:56,  1.34s/it] 14%|‚ñà‚ñç        | 14/100 [00:19<01:52,  1.30s/it] 15%|‚ñà‚ñå        | 15/100 [00:20<01:55,  1.36s/it] 16%|‚ñà‚ñå        | 16/100 [00:22<02:00,  1.43s/it] 17%|‚ñà‚ñã        | 17/100 [00:24<02:08,  1.55s/it] 18%|‚ñà‚ñä        | 18/100 [00:26<02:33,  1.88s/it] 19%|‚ñà‚ñâ        | 19/100 [00:28<02:26,  1.80s/it] 20%|‚ñà‚ñà        | 20/100 [00:29<02:12,  1.65s/it] 21%|‚ñà‚ñà        | 21/100 [00:31<02:05,  1.58s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:32<01:56,  1.49s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:33<01:52,  1.46s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:34<01:45,  1.39s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:36<01:38,  1.31s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:37<01:33,  1.27s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:38<01:33,  1.27s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:39<01:34,  1.31s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:41<01:30,  1.28s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:42<01:28,  1.27s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:44<01:45,  1.53s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:46<02:00,  1.78s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:48<01:45,  1.58s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:49<01:37,  1.48s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:50<01:31,  1.41s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:51<01:23,  1.31s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:52<01:20,  1.28s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:54<01:19,  1.29s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:55<01:20,  1.31s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:56<01:18,  1.31s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:58<01:15,  1.29s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:59<01:13,  1.27s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:00<01:11,  1.26s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:01<01:11,  1.27s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:03<01:18,  1.43s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:05<01:20,  1.49s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:07<01:36,  1.82s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:09<01:31,  1.75s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:11<01:27,  1.72s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:12<01:26,  1.73s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:14<01:25,  1.74s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:16<01:19,  1.65s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:17<01:09,  1.48s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:18<01:03,  1.39s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:19<01:02,  1.39s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:21<01:01,  1.40s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:22<00:57,  1.34s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:23<00:56,  1.34s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:24<00:54,  1.32s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:26<00:50,  1.26s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:27<00:57,  1.48s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:30<01:03,  1.68s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:31<00:57,  1.56s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:32<00:55,  1.55s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:34<00:52,  1.49s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:35<00:46,  1.37s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:36<00:43,  1.31s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:37<00:42,  1.34s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:39<00:40,  1.29s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:40<00:37,  1.26s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:41<00:36,  1.25s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:42<00:35,  1.28s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:44<00:36,  1.34s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:45<00:33,  1.27s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:47<00:35,  1.42s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:49<00:36,  1.52s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:51<00:41,  1.79s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:52<00:35,  1.62s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:54<00:32,  1.54s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:55<00:29,  1.47s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:56<00:26,  1.40s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:57<00:24,  1.34s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:58<00:21,  1.28s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:00<00:20,  1.30s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:01<00:19,  1.28s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:02<00:17,  1.27s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:03<00:16,  1.25s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:05<00:15,  1.26s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:06<00:13,  1.20s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:07<00:12,  1.21s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:09<00:12,  1.38s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:11<00:13,  1.63s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:12<00:10,  1.52s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:14<00:08,  1.45s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:15<00:06,  1.37s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:16<00:05,  1.30s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:17<00:03,  1.27s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:18<00:02,  1.26s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:20<00:01,  1.28s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:21<00:00,  1.27s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:21<00:00,  1.41s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.28174
wandb: 
wandb: üöÄ View run bright-sweep-130 at: https://wandb.ai/xzy11632/dance-dev/runs/i3h5pcmb
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_131840-i3h5pcmb/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: fpcjpnc2 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_132251-fpcjpnc2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run honest-sweep-131
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/fpcjpnc2
[INFO][2024-03-16 13:22:56,032][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 13:22:56,149][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 13:22:56,150][dance][wrapped_func] Took 0:00:00.112687 to load and process data.
[INFO][2024-03-16 13:22:56,150][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 13:22:56,151][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 13:22:56,164][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:22:56,165][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:22:56,165][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:22:56,165][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 13:22:56,694][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=23)
[INFO][2024-03-16 13:22:56,695][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.07%
[INFO][2024-03-16 13:22:59,600][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 13:22:59,601][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 13:22:59,601][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 13:22:59,601][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:11,  1.33s/it]  2%|‚ñè         | 2/100 [00:02<02:07,  1.30s/it]  3%|‚ñé         | 3/100 [00:03<02:06,  1.31s/it]  4%|‚ñç         | 4/100 [00:05<02:03,  1.29s/it]  5%|‚ñå         | 5/100 [00:07<02:23,  1.51s/it]  6%|‚ñå         | 6/100 [00:09<02:37,  1.67s/it]  7%|‚ñã         | 7/100 [00:10<02:34,  1.66s/it]  8%|‚ñä         | 8/100 [00:12<02:25,  1.58s/it]  9%|‚ñâ         | 9/100 [00:13<02:14,  1.48s/it] 10%|‚ñà         | 10/100 [00:14<02:08,  1.42s/it] 11%|‚ñà         | 11/100 [00:15<01:57,  1.32s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<01:51,  1.27s/it] 13%|‚ñà‚ñé        | 13/100 [00:18<01:53,  1.30s/it] 14%|‚ñà‚ñç        | 14/100 [00:19<01:55,  1.35s/it] 15%|‚ñà‚ñå        | 15/100 [00:21<01:55,  1.36s/it] 16%|‚ñà‚ñå        | 16/100 [00:22<01:52,  1.34s/it] 17%|‚ñà‚ñã        | 17/100 [00:23<01:53,  1.36s/it] 18%|‚ñà‚ñä        | 18/100 [00:25<01:55,  1.41s/it] 19%|‚ñà‚ñâ        | 19/100 [00:27<02:05,  1.55s/it] 20%|‚ñà‚ñà        | 20/100 [00:29<02:19,  1.74s/it] 21%|‚ñà‚ñà        | 21/100 [00:30<02:09,  1.64s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:32<01:59,  1.54s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:33<01:53,  1.47s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:34<01:53,  1.50s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:36<01:50,  1.47s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:37<01:46,  1.43s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:39<01:42,  1.41s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:40<01:40,  1.40s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:41<01:40,  1.41s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:43<01:40,  1.44s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:44<01:36,  1.39s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:46<01:36,  1.41s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:47<01:42,  1.54s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:50<01:53,  1.71s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:51<01:47,  1.65s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:52<01:37,  1.52s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:54<01:29,  1.42s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:55<01:25,  1.37s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:56<01:24,  1.38s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:57<01:20,  1.34s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:59<01:22,  1.41s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:00<01:22,  1.42s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:02<01:21,  1.42s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:03<01:19,  1.42s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:05<01:16,  1.39s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:06<01:12,  1.33s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:07<01:12,  1.36s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:09<01:19,  1.54s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:11<01:28,  1.74s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:13<01:22,  1.65s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:14<01:14,  1.52s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:15<01:08,  1.43s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:17<01:06,  1.41s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:18<01:05,  1.41s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:19<01:02,  1.40s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:21<01:04,  1.46s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:22<01:01,  1.43s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:24<01:00,  1.44s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:25<00:57,  1.40s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:27<00:55,  1.39s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:29<01:01,  1.58s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:31<01:07,  1.76s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:32<00:58,  1.58s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:33<00:53,  1.48s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:34<00:49,  1.42s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:36<00:47,  1.39s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:37<00:46,  1.41s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:38<00:43,  1.36s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:40<00:41,  1.35s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:41<00:42,  1.41s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:43<00:41,  1.42s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:44<00:39,  1.40s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:46<00:38,  1.42s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:48<00:41,  1.59s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:50<00:47,  1.90s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:52<00:45,  1.90s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:53<00:39,  1.74s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:55<00:35,  1.59s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:56<00:31,  1.49s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:57<00:27,  1.39s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:58<00:25,  1.32s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:59<00:23,  1.29s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:01<00:21,  1.26s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:02<00:19,  1.24s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:03<00:19,  1.27s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:05<00:18,  1.30s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:06<00:17,  1.35s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:08<00:17,  1.43s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:10<00:17,  1.57s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:11<00:14,  1.47s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:12<00:12,  1.39s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:13<00:11,  1.39s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:15<00:10,  1.48s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:17<00:09,  1.62s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:19<00:08,  1.63s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:20<00:06,  1.63s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:22<00:04,  1.66s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:24<00:03,  1.70s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:25<00:01,  1.66s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:27<00:00,  1.59s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:27<00:00,  1.47s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.2183
wandb: 
wandb: üöÄ View run honest-sweep-131 at: https://wandb.ai/xzy11632/dance-dev/runs/fpcjpnc2
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_132251-fpcjpnc2/logs
wandb: Agent Starting Run: c9jribzi with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_132638-c9jribzi
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fresh-sweep-132
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/c9jribzi
[INFO][2024-03-16 13:26:43,547][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 13:26:43,653][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 13:26:43,654][dance][wrapped_func] Took 0:00:00.105352 to load and process data.
[INFO][2024-03-16 13:26:43,654][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 13:26:43,656][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 13:26:43,674][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:26:43,674][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:26:43,675][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:26:43,675][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 13:26:46,518][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=94)
[INFO][2024-03-16 13:26:46,518][dance.WeightedFeatureSVD][__call__] Total explained variance: 96.02%
[INFO][2024-03-16 13:26:48,625][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 13:26:48,626][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 13:26:48,626][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 13:26:48,626][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:10,  1.32s/it]  2%|‚ñè         | 2/100 [00:02<02:17,  1.40s/it]  3%|‚ñé         | 3/100 [00:04<02:13,  1.37s/it]  4%|‚ñç         | 4/100 [00:05<02:15,  1.41s/it]  5%|‚ñå         | 5/100 [00:07<02:14,  1.42s/it]  6%|‚ñå         | 6/100 [00:09<02:42,  1.73s/it]  7%|‚ñã         | 7/100 [00:11<03:00,  1.94s/it]  8%|‚ñä         | 8/100 [00:13<02:45,  1.80s/it]  9%|‚ñâ         | 9/100 [00:14<02:31,  1.66s/it] 10%|‚ñà         | 10/100 [00:15<02:22,  1.58s/it] 11%|‚ñà         | 11/100 [00:17<02:15,  1.52s/it] 12%|‚ñà‚ñè        | 12/100 [00:18<02:09,  1.47s/it] 13%|‚ñà‚ñé        | 13/100 [00:20<02:09,  1.49s/it] 14%|‚ñà‚ñç        | 14/100 [00:21<02:08,  1.49s/it] 15%|‚ñà‚ñå        | 15/100 [00:23<02:05,  1.48s/it] 16%|‚ñà‚ñå        | 16/100 [00:24<02:06,  1.50s/it] 17%|‚ñà‚ñã        | 17/100 [00:26<02:01,  1.46s/it] 18%|‚ñà‚ñä        | 18/100 [00:28<02:23,  1.75s/it] 19%|‚ñà‚ñâ        | 19/100 [00:30<02:26,  1.80s/it] 20%|‚ñà‚ñà        | 20/100 [00:31<02:09,  1.62s/it] 21%|‚ñà‚ñà        | 21/100 [00:32<01:58,  1.49s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:34<01:52,  1.44s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:35<01:48,  1.41s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:36<01:47,  1.41s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:38<01:45,  1.40s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:39<01:43,  1.39s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:40<01:39,  1.36s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:42<01:37,  1.35s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:43<01:37,  1.37s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:45<01:37,  1.40s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:46<01:31,  1.33s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:47<01:30,  1.33s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:49<01:36,  1.44s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:51<01:50,  1.68s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:53<01:47,  1.65s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:54<01:38,  1.53s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:55<01:29,  1.43s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:56<01:22,  1.33s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:58<01:19,  1.31s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:59<01:23,  1.39s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:00<01:20,  1.37s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:02<01:18,  1.35s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:03<01:15,  1.33s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:04<01:12,  1.29s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:06<01:12,  1.32s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:07<01:10,  1.30s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:09<01:17,  1.47s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:11<01:29,  1.71s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:12<01:18,  1.54s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:13<01:10,  1.41s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:15<01:08,  1.39s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:16<01:04,  1.34s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:17<01:02,  1.32s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:18<00:59,  1.30s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:20<00:57,  1.27s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:21<00:55,  1.27s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:22<00:59,  1.39s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:24<01:02,  1.50s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:26<01:00,  1.47s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:27<00:58,  1.46s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:28<00:55,  1.42s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:31<01:02,  1.65s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:33<01:06,  1.79s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:34<00:58,  1.62s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:35<00:51,  1.47s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:36<00:46,  1.36s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:37<00:42,  1.29s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:38<00:40,  1.26s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:40<00:39,  1.29s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:41<00:39,  1.31s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:42<00:37,  1.28s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:44<00:35,  1.26s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:45<00:33,  1.24s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:46<00:32,  1.27s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:47<00:32,  1.28s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:49<00:30,  1.25s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:51<00:33,  1.46s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:53<00:36,  1.65s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:54<00:31,  1.50s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:55<00:28,  1.43s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:56<00:26,  1.39s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:57<00:23,  1.28s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:59<00:21,  1.25s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:00<00:19,  1.23s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:01<00:18,  1.23s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:02<00:17,  1.26s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:04<00:16,  1.28s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:05<00:15,  1.29s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:06<00:13,  1.26s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:07<00:12,  1.22s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:09<00:12,  1.37s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:11<00:12,  1.62s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:12<00:10,  1.47s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:14<00:08,  1.39s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:15<00:06,  1.34s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:16<00:05,  1.30s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:17<00:03,  1.29s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:18<00:02,  1.26s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:20<00:01,  1.24s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:21<00:00,  1.21s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:21<00:00,  1.41s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.22115
wandb: 
wandb: üöÄ View run fresh-sweep-132 at: https://wandb.ai/xzy11632/dance-dev/runs/c9jribzi
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_132638-c9jribzi/logs
wandb: Agent Starting Run: abypm5cu with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_133023-abypm5cu
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run super-sweep-133
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/abypm5cu
[INFO][2024-03-16 13:30:42,280][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 13:30:42,711][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 13:30:42,743][dance][wrapped_func] Took 0:00:00.462066 to load and process data.
[INFO][2024-03-16 13:30:42,743][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 13:30:42,746][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 13:30:42,831][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:30:42,832][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:30:42,834][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:30:42,835][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:30:42,837][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:30:42,839][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:30:42,840][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:30:42,840][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 13:31:23,698][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 1000) (k=3)
[INFO][2024-03-16 13:31:23,699][dance.WeightedFeaturePCA][__call__] Total explained variance: 93.35%
[INFO][2024-03-16 13:32:16,495][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 13:32:16,495][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 13:32:16,496][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 13:32:16,496][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:53,  1.75s/it]  2%|‚ñè         | 2/100 [00:03<03:07,  1.91s/it]  3%|‚ñé         | 3/100 [00:07<04:10,  2.58s/it]  4%|‚ñç         | 4/100 [00:08<03:36,  2.25s/it]  5%|‚ñå         | 5/100 [00:10<03:25,  2.16s/it]  6%|‚ñå         | 6/100 [00:12<03:08,  2.00s/it]  7%|‚ñã         | 7/100 [00:14<03:00,  1.94s/it]  8%|‚ñä         | 8/100 [00:16<02:55,  1.91s/it]  9%|‚ñâ         | 9/100 [00:18<02:51,  1.89s/it] 10%|‚ñà         | 10/100 [00:19<02:50,  1.89s/it] 11%|‚ñà         | 11/100 [00:22<02:54,  1.96s/it] 12%|‚ñà‚ñè        | 12/100 [00:23<02:45,  1.88s/it] 13%|‚ñà‚ñé        | 13/100 [00:26<03:05,  2.14s/it] 14%|‚ñà‚ñç        | 14/100 [00:29<03:19,  2.32s/it] 15%|‚ñà‚ñå        | 15/100 [00:31<03:04,  2.18s/it] 16%|‚ñà‚ñå        | 16/100 [00:32<02:53,  2.07s/it] 17%|‚ñà‚ñã        | 17/100 [00:34<02:37,  1.89s/it] 18%|‚ñà‚ñä        | 18/100 [00:35<02:25,  1.77s/it] 19%|‚ñà‚ñâ        | 19/100 [00:37<02:19,  1.72s/it] 20%|‚ñà‚ñà        | 20/100 [00:39<02:19,  1.74s/it] 21%|‚ñà‚ñà        | 21/100 [00:41<02:22,  1.80s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:42<02:17,  1.76s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:44<02:17,  1.79s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:46<02:15,  1.79s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:50<03:03,  2.45s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:53<03:22,  2.74s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:55<02:56,  2.42s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:57<02:39,  2.21s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:59<02:29,  2.10s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [01:00<02:17,  1.97s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [01:02<02:11,  1.91s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:04<02:12,  1.95s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:06<02:15,  2.02s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:08<02:09,  1.96s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:10<02:00,  1.86s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:13<02:15,  2.12s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:15<02:28,  2.35s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:17<02:14,  2.18s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:19<02:04,  2.05s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:21<01:57,  1.95s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:23<01:55,  1.96s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:24<01:50,  1.91s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:26<01:50,  1.94s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:28<01:49,  1.95s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:30<01:44,  1.89s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:32<01:41,  1.87s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:34<01:40,  1.89s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:37<01:52,  2.17s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:40<02:03,  2.42s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:42<01:52,  2.24s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:43<01:40,  2.05s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:45<01:33,  1.94s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:46<01:26,  1.84s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:48<01:20,  1.75s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:50<01:16,  1.71s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:52<01:17,  1.76s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:53<01:17,  1.80s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:55<01:15,  1.79s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:57<01:13,  1.79s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:58<01:06,  1.67s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [02:01<01:11,  1.82s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [02:04<01:24,  2.22s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [02:05<01:13,  1.99s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [02:07<01:08,  1.90s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [02:08<01:02,  1.78s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [02:10<00:56,  1.66s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [02:11<00:50,  1.52s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [02:12<00:45,  1.41s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:13<00:43,  1.40s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:15<00:40,  1.36s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:16<00:39,  1.35s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:17<00:37,  1.34s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:19<00:35,  1.33s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:20<00:34,  1.34s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:22<00:38,  1.54s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:25<00:46,  1.93s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:26<00:39,  1.70s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:27<00:33,  1.53s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:28<00:30,  1.43s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:32<00:40,  2.00s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:35<00:44,  2.34s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:36<00:38,  2.12s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:38<00:33,  1.94s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:40<00:29,  1.82s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:41<00:25,  1.72s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:42<00:22,  1.61s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:44<00:19,  1.49s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:47<00:24,  2.06s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:48<00:20,  1.83s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:50<00:16,  1.68s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:51<00:14,  1.60s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:52<00:12,  1.54s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:54<00:10,  1.45s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:55<00:08,  1.46s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:57<00:07,  1.45s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:58<00:05,  1.41s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:59<00:04,  1.40s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [03:12<00:09,  4.81s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [03:23<00:06,  6.65s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:26<00:00,  5.70s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:26<00:00,  2.07s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.018 MB of 0.026 MB uploadedwandb: / 0.018 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.09344
wandb: 
wandb: üöÄ View run super-sweep-133 at: https://wandb.ai/xzy11632/dance-dev/runs/abypm5cu
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_133023-abypm5cu/logs
wandb: Agent Starting Run: j4jyn6yg with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_133748-j4jyn6yg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run restful-sweep-134
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/j4jyn6yg
[INFO][2024-03-16 13:37:54,127][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 13:37:54,257][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 13:37:54,258][dance][wrapped_func] Took 0:00:00.129936 to load and process data.
[INFO][2024-03-16 13:37:54,258][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 13:37:54,260][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 13:37:54,281][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:37:54,282][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:37:54,282][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:37:54,283][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:37:54,283][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:37:54,284][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:37:54,284][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:37:54,284][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 13:38:02,497][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 1000) (k=9)
[INFO][2024-03-16 13:38:02,515][dance.WeightedFeatureSVD][__call__] Total explained variance: 96.73%
[INFO][2024-03-16 13:38:05,823][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 13:38:05,824][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 13:38:05,824][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 13:38:05,824][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:26,  1.48s/it]  2%|‚ñè         | 2/100 [00:03<02:33,  1.57s/it]  3%|‚ñé         | 3/100 [00:04<02:35,  1.60s/it]  4%|‚ñç         | 4/100 [00:07<03:24,  2.14s/it]  5%|‚ñå         | 5/100 [00:10<03:52,  2.45s/it]  6%|‚ñå         | 6/100 [00:13<04:06,  2.62s/it]  7%|‚ñã         | 7/100 [00:15<03:36,  2.32s/it]  8%|‚ñä         | 8/100 [00:16<03:02,  1.99s/it]  9%|‚ñâ         | 9/100 [00:18<02:53,  1.91s/it] 10%|‚ñà         | 10/100 [00:20<03:02,  2.03s/it] 11%|‚ñà         | 11/100 [00:22<02:49,  1.90s/it] 12%|‚ñà‚ñè        | 12/100 [00:23<02:29,  1.70s/it] 13%|‚ñà‚ñé        | 13/100 [00:24<02:17,  1.58s/it] 14%|‚ñà‚ñç        | 14/100 [00:26<02:08,  1.50s/it] 15%|‚ñà‚ñå        | 15/100 [00:27<02:03,  1.45s/it] 16%|‚ñà‚ñå        | 16/100 [00:28<02:01,  1.44s/it] 17%|‚ñà‚ñã        | 17/100 [00:30<01:56,  1.40s/it] 18%|‚ñà‚ñä        | 18/100 [00:31<01:57,  1.44s/it] 19%|‚ñà‚ñâ        | 19/100 [00:33<02:02,  1.51s/it] 20%|‚ñà‚ñà        | 20/100 [00:34<01:58,  1.48s/it] 21%|‚ñà‚ñà        | 21/100 [00:36<01:49,  1.39s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:38<02:03,  1.58s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:40<02:22,  1.85s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:41<02:07,  1.68s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:42<01:54,  1.52s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:44<01:47,  1.45s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:45<01:44,  1.43s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:47<01:43,  1.44s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:48<01:37,  1.37s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:49<01:30,  1.29s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:50<01:30,  1.32s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:52<01:32,  1.36s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:53<01:35,  1.42s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:55<01:32,  1.40s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:56<01:39,  1.53s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:59<02:01,  1.90s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:00<01:47,  1.71s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:02<01:36,  1.56s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:03<01:30,  1.48s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:04<01:26,  1.44s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:13<03:32,  3.60s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:23<05:11,  5.38s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:29<05:32,  5.83s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:35<05:29,  5.88s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:45<06:17,  6.86s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:54<06:44,  7.49s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:56<05:11,  5.88s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:57<03:54,  4.51s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:58<02:59,  3.52s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:59<02:19,  2.79s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [02:01<02:02,  2.51s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [02:04<01:58,  2.47s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [02:05<01:36,  2.05s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [02:06<01:21,  1.76s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [02:07<01:12,  1.61s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [02:08<01:05,  1.48s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [02:09<00:59,  1.38s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [02:10<00:53,  1.28s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [02:11<00:50,  1.23s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [02:13<00:48,  1.21s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [02:14<00:47,  1.22s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [02:15<00:47,  1.24s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [02:17<00:55,  1.50s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [02:19<01:02,  1.74s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [02:23<01:16,  2.19s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [02:24<01:09,  2.06s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [02:27<01:09,  2.12s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [02:39<02:42,  5.08s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:49<03:21,  6.51s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:54<03:03,  6.11s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [03:03<03:28,  7.20s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [03:13<03:37,  7.76s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [03:14<02:39,  5.90s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [03:16<01:58,  4.56s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [03:17<01:30,  3.64s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [03:18<01:10,  2.93s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [03:19<00:55,  2.40s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [03:21<00:45,  2.05s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [03:23<00:44,  2.14s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [03:25<00:42,  2.14s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [03:26<00:35,  1.88s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [03:28<00:30,  1.71s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [03:29<00:26,  1.54s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [03:30<00:23,  1.47s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [03:32<00:21,  1.42s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [03:33<00:19,  1.38s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [03:34<00:17,  1.36s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [03:35<00:16,  1.34s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [03:37<00:14,  1.35s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [03:38<00:13,  1.37s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [03:40<00:12,  1.43s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [03:41<00:10,  1.35s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [03:43<00:11,  1.66s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [03:53<00:23,  3.92s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [04:05<00:32,  6.48s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [04:12<00:26,  6.74s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [04:21<00:22,  7.38s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [04:31<00:16,  8.10s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [04:36<00:07,  7.22s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [04:38<00:00,  5.52s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [04:38<00:00,  2.78s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.17079
wandb: 
wandb: üöÄ View run restful-sweep-134 at: https://wandb.ai/xzy11632/dance-dev/runs/j4jyn6yg
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_133748-j4jyn6yg/logs
wandb: Agent Starting Run: c344htt6 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_134422-c344htt6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run stellar-sweep-135
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/c344htt6
[INFO][2024-03-16 13:44:27,960][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 13:44:28,056][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 13:44:28,057][dance][wrapped_func] Took 0:00:00.095995 to load and process data.
[INFO][2024-03-16 13:44:28,057][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 13:44:28,059][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 13:44:28,077][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:44:28,077][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:44:28,077][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:44:28,077][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:44:28,077][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:44:28,078][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 13:44:28,291][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run stellar-sweep-135 at: https://wandb.ai/xzy11632/dance-dev/runs/c344htt6
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_134422-c344htt6/logs
wandb: ERROR Run c344htt6 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1000) out of bounds (1000)
wandb: ERROR 
wandb: Agent Starting Run: r1s5uue5 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_134443-r1s5uue5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run curious-sweep-136
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/r1s5uue5
[INFO][2024-03-16 13:44:48,492][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 13:44:48,585][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 13:44:48,585][dance][wrapped_func] Took 0:00:00.092173 to load and process data.
[INFO][2024-03-16 13:44:48,585][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 13:44:48,587][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 13:44:48,603][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:44:48,604][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:44:48,604][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:44:48,604][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:44:48,604][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:44:48,605][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 13:44:48,819][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run curious-sweep-136 at: https://wandb.ai/xzy11632/dance-dev/runs/r1s5uue5
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_134443-r1s5uue5/logs
wandb: ERROR Run r1s5uue5 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1000) out of bounds (1000)
wandb: ERROR 
wandb: Agent Starting Run: k9siudvp with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_134504-k9siudvp
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glorious-sweep-137
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/k9siudvp
[INFO][2024-03-16 13:45:10,522][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 13:45:10,610][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 13:45:10,611][dance][wrapped_func] Took 0:00:00.088287 to load and process data.
[INFO][2024-03-16 13:45:10,611][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 13:45:10,612][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 13:45:10,628][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:45:10,628][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:45:10,628][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:45:10,629][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:45:10,629][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:45:10,629][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 13:45:10,908][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=6)
[INFO][2024-03-16 13:45:10,909][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.96%
[INFO][2024-03-16 13:45:13,073][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 13:45:13,073][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 13:45:13,073][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 13:45:13,074][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:51,  1.13s/it]  2%|‚ñè         | 2/100 [00:02<01:55,  1.18s/it]  3%|‚ñé         | 3/100 [00:03<01:50,  1.14s/it]  4%|‚ñç         | 4/100 [00:05<02:08,  1.34s/it]  5%|‚ñå         | 5/100 [00:09<04:06,  2.59s/it]  6%|‚ñå         | 6/100 [00:12<04:06,  2.62s/it]  7%|‚ñã         | 7/100 [00:15<03:59,  2.58s/it]  8%|‚ñä         | 8/100 [00:17<03:38,  2.37s/it]  9%|‚ñâ         | 9/100 [00:20<03:54,  2.57s/it] 10%|‚ñà         | 10/100 [00:23<04:27,  2.97s/it] 11%|‚ñà         | 11/100 [00:27<04:34,  3.09s/it] 12%|‚ñà‚ñè        | 12/100 [00:30<04:31,  3.09s/it] 13%|‚ñà‚ñé        | 13/100 [00:31<03:38,  2.51s/it] 14%|‚ñà‚ñç        | 14/100 [00:36<04:28,  3.13s/it] 15%|‚ñà‚ñå        | 15/100 [00:40<04:56,  3.48s/it] 16%|‚ñà‚ñå        | 16/100 [00:42<04:29,  3.21s/it] 17%|‚ñà‚ñã        | 17/100 [00:46<04:47,  3.46s/it] 18%|‚ñà‚ñä        | 18/100 [00:51<05:01,  3.68s/it] 19%|‚ñà‚ñâ        | 19/100 [00:54<04:58,  3.68s/it] 20%|‚ñà‚ñà        | 20/100 [00:55<03:52,  2.91s/it] 21%|‚ñà‚ñà        | 21/100 [00:57<03:14,  2.46s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:58<02:44,  2.11s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:59<02:23,  1.86s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [01:01<02:06,  1.66s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [01:02<01:53,  1.51s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [01:03<01:42,  1.39s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [01:04<01:36,  1.33s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [01:05<01:32,  1.29s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [01:07<01:30,  1.27s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [01:08<01:25,  1.22s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [01:09<01:24,  1.22s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:10<01:21,  1.19s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:12<01:29,  1.34s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:14<01:42,  1.55s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:15<01:35,  1.47s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:16<01:27,  1.37s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:17<01:22,  1.31s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:19<01:20,  1.30s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:20<01:17,  1.28s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:21<01:17,  1.28s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:22<01:13,  1.24s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:24<01:12,  1.26s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:25<01:10,  1.24s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:26<01:11,  1.28s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:28<01:12,  1.32s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:29<01:11,  1.33s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:30<01:08,  1.29s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:32<01:10,  1.35s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:33<01:08,  1.33s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:35<01:15,  1.52s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:37<01:21,  1.67s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:38<01:13,  1.52s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:39<01:05,  1.40s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:40<00:59,  1.30s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:41<00:55,  1.23s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:42<00:52,  1.19s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:43<00:50,  1.17s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:45<00:52,  1.25s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:46<00:51,  1.24s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:47<00:49,  1.25s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:49<00:49,  1.27s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:50<00:50,  1.34s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:52<00:51,  1.40s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:54<00:56,  1.58s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:55<00:56,  1.60s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:57<00:57,  1.69s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:59<00:50,  1.54s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [02:00<00:49,  1.55s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:01<00:46,  1.50s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:03<00:42,  1.43s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:04<00:38,  1.33s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:05<00:36,  1.30s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:06<00:34,  1.30s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:07<00:32,  1.24s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:09<00:30,  1.22s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:10<00:29,  1.23s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:11<00:27,  1.20s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:12<00:26,  1.21s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:14<00:27,  1.30s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:15<00:26,  1.33s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:17<00:28,  1.49s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:18<00:25,  1.40s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:19<00:23,  1.37s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:21<00:20,  1.27s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:22<00:19,  1.28s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:23<00:17,  1.24s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:24<00:16,  1.25s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:25<00:14,  1.21s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:27<00:14,  1.28s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:28<00:12,  1.27s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:29<00:11,  1.30s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:31<00:10,  1.30s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:32<00:09,  1.29s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:33<00:07,  1.27s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:34<00:06,  1.26s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:36<00:05,  1.33s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:38<00:04,  1.48s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:40<00:03,  1.66s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:41<00:01,  1.55s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:42<00:00,  1.42s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:42<00:00,  1.63s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.18022
wandb: 
wandb: üöÄ View run glorious-sweep-137 at: https://wandb.ai/xzy11632/dance-dev/runs/k9siudvp
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_134504-k9siudvp/logs
wandb: Agent Starting Run: 2l10qqc5 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_135006-2l10qqc5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run efficient-sweep-138
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/2l10qqc5
[INFO][2024-03-16 13:50:13,741][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 13:50:13,842][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 13:50:13,843][dance][wrapped_func] Took 0:00:00.100751 to load and process data.
[INFO][2024-03-16 13:50:13,843][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 13:50:13,846][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 13:50:13,868][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:50:13,868][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:50:13,869][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:50:13,869][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:50:13,870][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:50:13,870][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 13:50:29,722][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=6)
[INFO][2024-03-16 13:50:29,724][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.92%
[INFO][2024-03-16 13:51:11,901][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 13:51:11,902][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 13:51:11,902][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 13:51:11,902][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:55,  1.16s/it]  2%|‚ñè         | 2/100 [00:02<01:58,  1.21s/it]  3%|‚ñé         | 3/100 [00:03<01:54,  1.18s/it]  4%|‚ñç         | 4/100 [00:04<01:48,  1.13s/it]  5%|‚ñå         | 5/100 [00:05<01:49,  1.15s/it]  6%|‚ñå         | 6/100 [00:06<01:49,  1.16s/it]  7%|‚ñã         | 7/100 [00:08<01:45,  1.14s/it]  8%|‚ñä         | 8/100 [00:09<02:04,  1.36s/it]  9%|‚ñâ         | 9/100 [00:12<02:26,  1.61s/it] 10%|‚ñà         | 10/100 [00:13<02:11,  1.46s/it] 11%|‚ñà         | 11/100 [00:14<01:58,  1.33s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:52,  1.27s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:45,  1.21s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:43,  1.21s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:41,  1.19s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:40,  1.20s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:39,  1.19s/it] 18%|‚ñà‚ñä        | 18/100 [00:22<01:37,  1.19s/it] 19%|‚ñà‚ñâ        | 19/100 [00:23<01:37,  1.20s/it] 20%|‚ñà‚ñà        | 20/100 [00:24<01:33,  1.16s/it] 21%|‚ñà‚ñà        | 21/100 [00:25<01:30,  1.14s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:27<01:32,  1.19s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:28<01:29,  1.16s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:29<01:28,  1.16s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:30<01:38,  1.31s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:33<01:54,  1.55s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:34<01:41,  1.39s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:35<01:37,  1.35s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:36<01:32,  1.30s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:37<01:29,  1.28s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:38<01:24,  1.23s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:40<01:23,  1.22s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:41<01:25,  1.28s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:42<01:23,  1.27s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:43<01:18,  1.21s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:45<01:16,  1.20s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:46<01:14,  1.18s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:47<01:17,  1.25s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:49<01:20,  1.33s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:50<01:21,  1.36s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:51<01:18,  1.33s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:52<01:14,  1.29s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:54<01:12,  1.27s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:56<01:21,  1.45s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:58<01:31,  1.67s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:59<01:20,  1.50s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:00<01:13,  1.38s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:01<01:08,  1.32s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:02<01:06,  1.30s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:04<01:02,  1.25s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:05<01:03,  1.29s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:06<01:01,  1.29s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:07<00:58,  1.25s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:09<00:56,  1.23s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:10<00:54,  1.22s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:11<00:54,  1.24s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:12<00:56,  1.32s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:14<00:55,  1.33s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:15<00:56,  1.38s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:18<01:05,  1.64s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:20<01:12,  1.86s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:21<01:02,  1.65s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:22<00:56,  1.52s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:23<00:49,  1.39s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:25<00:46,  1.32s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:26<00:43,  1.28s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:27<00:40,  1.24s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:28<00:40,  1.27s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:30<00:39,  1.27s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:31<00:36,  1.22s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:32<00:35,  1.24s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:33<00:34,  1.25s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:35<00:35,  1.32s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:36<00:34,  1.31s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:37<00:32,  1.31s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:39<00:34,  1.42s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:41<00:36,  1.59s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:42<00:33,  1.51s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:43<00:29,  1.42s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:45<00:27,  1.37s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:46<00:25,  1.33s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:47<00:22,  1.26s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:51<00:33,  1.99s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:55<00:42,  2.67s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:00<00:49,  3.31s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:04<00:50,  3.62s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:06<00:40,  3.09s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:09<00:38,  3.19s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:11<00:30,  2.82s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:14<00:27,  2.73s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:16<00:23,  2.63s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:20<00:23,  2.88s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:22<00:19,  2.72s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:25<00:15,  2.66s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:27<00:12,  2.53s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:29<00:09,  2.35s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:31<00:06,  2.25s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:32<00:04,  2.05s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:33<00:01,  1.76s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:35<00:00,  1.72s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:35<00:00,  1.56s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.17962
wandb: 
wandb: üöÄ View run efficient-sweep-138 at: https://wandb.ai/xzy11632/dance-dev/runs/2l10qqc5
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_135006-2l10qqc5/logs
wandb: Agent Starting Run: yyzfkc45 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_135551-yyzfkc45
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run vocal-sweep-139
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/yyzfkc45
[INFO][2024-03-16 13:55:56,304][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 13:55:56,388][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 13:55:56,388][dance][wrapped_func] Took 0:00:00.083080 to load and process data.
[INFO][2024-03-16 13:55:56,388][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 13:55:56,391][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 13:55:56,404][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:55:56,405][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:55:56,405][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:55:56,405][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:55:56,405][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:55:56,405][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run vocal-sweep-139 at: https://wandb.ai/xzy11632/dance-dev/runs/yyzfkc45
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_135551-yyzfkc45/logs
wandb: ERROR Run yyzfkc45 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: 70djpr01 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_135612-70djpr01
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run snowy-sweep-140
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/70djpr01
[INFO][2024-03-16 13:56:18,838][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 13:56:18,958][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 13:56:18,958][dance][wrapped_func] Took 0:00:00.119207 to load and process data.
[INFO][2024-03-16 13:56:18,958][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 13:56:18,960][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 13:56:18,975][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:56:18,975][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:56:18,976][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:56:18,976][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:56:18,976][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:56:18,977][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run snowy-sweep-140 at: https://wandb.ai/xzy11632/dance-dev/runs/70djpr01
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_135612-70djpr01/logs
wandb: ERROR Run 70djpr01 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: 77li6pjl with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_135635-77li6pjl
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run light-sweep-141
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/77li6pjl
[INFO][2024-03-16 13:56:46,404][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 13:56:46,774][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 13:56:46,798][dance][wrapped_func] Took 0:00:00.393839 to load and process data.
[INFO][2024-03-16 13:56:46,799][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 13:56:46,802][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 13:56:46,863][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:56:46,864][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:56:46,865][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:56:46,865][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:56:46,866][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:56:46,867][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run light-sweep-141 at: https://wandb.ai/xzy11632/dance-dev/runs/77li6pjl
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_135635-77li6pjl/logs
wandb: ERROR Run 77li6pjl errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: 0g4mgqr6 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_135707-0g4mgqr6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run morning-sweep-142
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/0g4mgqr6
[INFO][2024-03-16 13:57:20,380][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 13:57:20,453][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 13:57:20,453][dance][wrapped_func] Took 0:00:00.073059 to load and process data.
[INFO][2024-03-16 13:57:20,453][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 13:57:20,454][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 13:57:20,467][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:57:20,467][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:57:20,467][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:57:20,468][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:57:20,468][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:57:20,468][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run morning-sweep-142 at: https://wandb.ai/xzy11632/dance-dev/runs/0g4mgqr6
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_135707-0g4mgqr6/logs
wandb: ERROR Run 0g4mgqr6 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: 1yiacuba with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_135737-1yiacuba
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run volcanic-sweep-143
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/1yiacuba
[INFO][2024-03-16 13:57:43,978][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 13:57:44,061][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 13:57:44,061][dance][wrapped_func] Took 0:00:00.082306 to load and process data.
[INFO][2024-03-16 13:57:44,061][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 13:57:44,063][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 13:57:44,078][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:57:44,079][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:57:44,079][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:57:44,079][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:57:44,079][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 13:57:44,080][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 13:57:44,828][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=5)
[INFO][2024-03-16 13:57:44,829][dance.WeightedFeaturePCA][__call__] Total explained variance: 91.01%
[INFO][2024-03-16 13:57:48,624][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 13:57:48,625][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 13:57:48,625][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 13:57:48,625][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:47,  1.09s/it]  2%|‚ñè         | 2/100 [00:02<01:45,  1.08s/it]  3%|‚ñé         | 3/100 [00:03<01:46,  1.09s/it]  4%|‚ñç         | 4/100 [00:04<01:50,  1.15s/it]  5%|‚ñå         | 5/100 [00:05<01:46,  1.12s/it]  6%|‚ñå         | 6/100 [00:06<01:44,  1.11s/it]  7%|‚ñã         | 7/100 [00:07<01:41,  1.09s/it]  8%|‚ñä         | 8/100 [00:08<01:42,  1.11s/it]  9%|‚ñâ         | 9/100 [00:10<01:45,  1.16s/it] 10%|‚ñà         | 10/100 [00:11<01:49,  1.22s/it] 11%|‚ñà         | 11/100 [00:12<01:54,  1.28s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:52,  1.28s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:48,  1.24s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:48,  1.27s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:58,  1.39s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:58,  1.41s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<02:07,  1.53s/it] 18%|‚ñà‚ñä        | 18/100 [00:22<01:57,  1.43s/it] 19%|‚ñà‚ñâ        | 19/100 [00:23<01:46,  1.31s/it] 20%|‚ñà‚ñà        | 20/100 [00:24<01:38,  1.24s/it] 21%|‚ñà‚ñà        | 21/100 [00:25<01:33,  1.19s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:27<01:30,  1.16s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:28<01:27,  1.13s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:29<01:24,  1.12s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:30<01:22,  1.10s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:31<01:19,  1.07s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:32<01:19,  1.08s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:33<01:18,  1.09s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:34<01:15,  1.07s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:35<01:14,  1.07s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:36<01:17,  1.12s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:37<01:17,  1.14s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:39<01:15,  1.12s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:40<01:15,  1.14s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:42<01:27,  1.35s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:44<01:40,  1.57s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:45<01:29,  1.43s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:46<01:23,  1.35s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:47<01:22,  1.36s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:48<01:17,  1.29s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:50<01:14,  1.26s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:51<01:10,  1.21s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:52<01:09,  1.21s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:53<01:08,  1.22s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:54<01:07,  1.24s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:56<01:08,  1.27s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:57<01:06,  1.26s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:58<01:05,  1.26s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:00<01:04,  1.27s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:01<01:06,  1.34s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:02<01:04,  1.31s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:04<01:02,  1.31s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:06<01:09,  1.48s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:08<01:17,  1.69s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:09<01:08,  1.51s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:10<01:03,  1.45s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:11<00:58,  1.36s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:12<00:54,  1.30s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:14<00:50,  1.24s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:15<00:47,  1.20s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:16<00:45,  1.17s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:17<00:45,  1.20s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:18<00:44,  1.21s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:19<00:43,  1.21s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:21<00:42,  1.21s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:22<00:41,  1.24s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:23<00:40,  1.22s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:25<00:41,  1.30s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:26<00:41,  1.34s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:28<00:43,  1.46s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:29<00:39,  1.35s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:30<00:35,  1.26s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:31<00:33,  1.26s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:32<00:31,  1.19s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:33<00:29,  1.19s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:35<00:28,  1.19s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:36<00:27,  1.22s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:37<00:26,  1.21s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:39<00:27,  1.31s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:41<00:30,  1.53s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:42<00:30,  1.61s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:44<00:28,  1.56s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:45<00:24,  1.44s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:46<00:21,  1.34s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:47<00:19,  1.28s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:48<00:17,  1.24s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:50<00:15,  1.22s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:51<00:13,  1.16s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:52<00:13,  1.23s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:53<00:12,  1.29s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:55<00:13,  1.48s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:56<00:10,  1.35s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:58<00:08,  1.28s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:59<00:07,  1.23s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:00<00:06,  1.26s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:01<00:04,  1.19s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:02<00:03,  1.20s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:03<00:02,  1.20s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:05<00:01,  1.25s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:06<00:00,  1.26s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:06<00:00,  1.27s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.20002
wandb: 
wandb: üöÄ View run volcanic-sweep-143 at: https://wandb.ai/xzy11632/dance-dev/runs/1yiacuba
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_135737-1yiacuba/logs
wandb: Agent Starting Run: gcjg8oms with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_140212-gcjg8oms
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dandy-sweep-144
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/gcjg8oms
[INFO][2024-03-16 14:02:17,723][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 14:02:17,791][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 14:02:17,791][dance][wrapped_func] Took 0:00:00.066560 to load and process data.
[INFO][2024-03-16 14:02:17,791][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 14:02:17,793][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 14:02:17,809][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:02:17,809][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:02:17,809][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:02:17,810][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:02:17,810][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:02:17,810][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 14:02:20,270][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=8)
[INFO][2024-03-16 14:02:20,271][dance.WeightedFeatureSVD][__call__] Total explained variance: 94.38%
[INFO][2024-03-16 14:02:23,169][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 14:02:23,170][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 14:02:23,170][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 14:02:23,170][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:58,  1.19s/it]  2%|‚ñè         | 2/100 [00:02<01:55,  1.18s/it]  3%|‚ñé         | 3/100 [00:03<01:55,  1.19s/it]  4%|‚ñç         | 4/100 [00:04<01:54,  1.19s/it]  5%|‚ñå         | 5/100 [00:05<01:48,  1.14s/it]  6%|‚ñå         | 6/100 [00:07<02:13,  1.42s/it]  7%|‚ñã         | 7/100 [00:09<02:36,  1.68s/it]  8%|‚ñä         | 8/100 [00:11<02:17,  1.50s/it]  9%|‚ñâ         | 9/100 [00:12<02:05,  1.38s/it] 10%|‚ñà         | 10/100 [00:13<01:57,  1.31s/it] 11%|‚ñà         | 11/100 [00:14<01:49,  1.23s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:45,  1.20s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:41,  1.16s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:37,  1.13s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:34,  1.11s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:36,  1.15s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:37,  1.18s/it] 18%|‚ñà‚ñä        | 18/100 [00:22<01:37,  1.18s/it] 19%|‚ñà‚ñâ        | 19/100 [00:23<01:36,  1.19s/it] 20%|‚ñà‚ñà        | 20/100 [00:24<01:35,  1.20s/it] 21%|‚ñà‚ñà        | 21/100 [00:26<01:43,  1.31s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:28<01:57,  1.51s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:29<01:56,  1.51s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:31<01:47,  1.41s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:32<01:39,  1.33s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:33<01:32,  1.25s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:34<01:31,  1.26s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:35<01:29,  1.24s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:36<01:27,  1.23s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:38<01:25,  1.22s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:39<01:24,  1.22s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:41<01:36,  1.42s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:43<01:43,  1.55s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:45<01:51,  1.69s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:46<01:40,  1.55s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:47<01:31,  1.43s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:48<01:23,  1.33s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:49<01:18,  1.27s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:51<01:20,  1.32s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:52<01:20,  1.35s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:54<01:28,  1.51s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:55<01:20,  1.40s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:56<01:16,  1.34s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:57<01:12,  1.29s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:58<01:06,  1.20s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:00<01:06,  1.22s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:01<01:02,  1.18s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:02<00:58,  1.13s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:06<01:40,  1.98s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:11<02:20,  2.80s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:13<02:13,  2.73s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:15<02:04,  2.59s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:18<01:59,  2.55s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:21<01:59,  2.59s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:23<01:59,  2.66s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:26<01:56,  2.64s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:31<02:23,  3.33s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:37<02:51,  4.08s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:41<02:46,  4.06s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:46<02:52,  4.31s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:47<02:19,  3.57s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:49<01:49,  2.89s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:50<01:27,  2.37s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:51<01:12,  2.00s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:53<01:08,  1.95s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:55<01:08,  2.01s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:56<00:58,  1.77s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:57<00:50,  1.59s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:59<00:45,  1.48s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:00<00:40,  1.36s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:01<00:38,  1.33s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:02<00:34,  1.23s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:03<00:32,  1.20s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:04<00:30,  1.17s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:06<00:30,  1.23s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:07<00:28,  1.21s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:08<00:28,  1.23s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:09<00:26,  1.19s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:10<00:25,  1.22s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:12<00:26,  1.31s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:14<00:29,  1.57s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:15<00:25,  1.43s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:16<00:22,  1.31s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:17<00:20,  1.27s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:18<00:18,  1.21s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:20<00:16,  1.20s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:21<00:15,  1.17s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:22<00:13,  1.15s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:23<00:12,  1.14s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:24<00:11,  1.15s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:25<00:10,  1.22s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:27<00:09,  1.24s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:28<00:08,  1.23s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:29<00:07,  1.24s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:30<00:06,  1.24s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:32<00:05,  1.41s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:35<00:05,  1.71s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:37<00:03,  1.74s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:38<00:01,  1.60s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:39<00:00,  1.49s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:39<00:00,  1.60s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.23851
wandb: 
wandb: üöÄ View run dandy-sweep-144 at: https://wandb.ai/xzy11632/dance-dev/runs/gcjg8oms
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_140212-gcjg8oms/logs
wandb: Agent Starting Run: 1wh0v4hq with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_140659-1wh0v4hq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wandering-sweep-145
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/1wh0v4hq
[INFO][2024-03-16 14:07:24,876][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 14:07:25,002][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 14:07:25,007][dance][wrapped_func] Took 0:00:00.130130 to load and process data.
[INFO][2024-03-16 14:07:25,007][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 14:07:25,010][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 14:07:25,064][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:07:25,075][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:07:25,077][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:07:25,078][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:07:25,080][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:07:25,193][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 14:07:35,124][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 1000) (k=3)
[INFO][2024-03-16 14:07:35,124][dance.WeightedFeaturePCA][__call__] Total explained variance: 92.55%
[INFO][2024-03-16 14:07:50,345][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 14:07:50,346][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 14:07:50,346][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 14:07:50,346][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:10,  1.32s/it]  2%|‚ñè         | 2/100 [00:02<02:06,  1.29s/it]  3%|‚ñé         | 3/100 [00:03<02:08,  1.32s/it]  4%|‚ñç         | 4/100 [00:05<02:10,  1.36s/it]  5%|‚ñå         | 5/100 [00:06<02:05,  1.32s/it]  6%|‚ñå         | 6/100 [00:08<02:09,  1.38s/it]  7%|‚ñã         | 7/100 [00:09<02:11,  1.41s/it]  8%|‚ñä         | 8/100 [00:10<02:08,  1.40s/it]  9%|‚ñâ         | 9/100 [00:12<02:07,  1.40s/it] 10%|‚ñà         | 10/100 [00:13<02:10,  1.44s/it] 11%|‚ñà         | 11/100 [00:16<02:27,  1.65s/it] 12%|‚ñà‚ñè        | 12/100 [00:18<02:54,  1.98s/it] 13%|‚ñà‚ñé        | 13/100 [00:19<02:31,  1.74s/it] 14%|‚ñà‚ñç        | 14/100 [00:21<02:14,  1.57s/it] 15%|‚ñà‚ñå        | 15/100 [00:22<02:04,  1.47s/it] 16%|‚ñà‚ñå        | 16/100 [00:23<01:58,  1.41s/it] 17%|‚ñà‚ñã        | 17/100 [00:24<01:50,  1.33s/it] 18%|‚ñà‚ñä        | 18/100 [00:26<01:48,  1.32s/it] 19%|‚ñà‚ñâ        | 19/100 [00:27<01:45,  1.31s/it] 20%|‚ñà‚ñà        | 20/100 [00:28<01:41,  1.27s/it] 21%|‚ñà‚ñà        | 21/100 [00:29<01:41,  1.29s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:31<01:40,  1.29s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:32<01:39,  1.29s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:33<01:34,  1.24s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:34<01:29,  1.20s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:37<01:54,  1.54s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:39<02:07,  1.74s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:40<02:04,  1.72s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:42<02:08,  1.81s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:44<02:07,  1.82s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:46<01:57,  1.70s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:47<01:48,  1.60s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:49<01:45,  1.57s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:50<01:40,  1.52s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:52<01:39,  1.53s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:53<01:35,  1.49s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:54<01:28,  1.41s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:56<01:43,  1.67s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:59<01:55,  1.90s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:00<01:42,  1.71s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:01<01:33,  1.59s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:03<01:28,  1.53s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:04<01:24,  1.48s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:06<01:22,  1.48s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:07<01:17,  1.41s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:08<01:14,  1.38s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:10<01:12,  1.37s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:11<01:09,  1.34s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:12<01:12,  1.42s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:14<01:08,  1.37s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:15<01:13,  1.49s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:18<01:22,  1.72s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:19<01:21,  1.73s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:21<01:13,  1.61s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:22<01:09,  1.55s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:23<01:03,  1.45s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:25<01:01,  1.44s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:26<00:59,  1.41s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:28<00:58,  1.43s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:29<00:55,  1.39s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:30<00:53,  1.38s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:32<00:52,  1.39s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:33<00:50,  1.36s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:34<00:48,  1.36s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:36<00:47,  1.35s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:37<00:45,  1.33s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:38<00:44,  1.34s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:40<00:41,  1.30s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:42<00:46,  1.51s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:44<00:55,  1.84s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:46<00:49,  1.70s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:47<00:44,  1.59s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:48<00:40,  1.49s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:49<00:37,  1.45s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:51<00:35,  1.41s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:52<00:33,  1.39s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:53<00:30,  1.34s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:55<00:29,  1.35s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:56<00:29,  1.38s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:57<00:26,  1.35s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:59<00:25,  1.35s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:00<00:23,  1.33s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:02<00:23,  1.41s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:03<00:22,  1.38s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:05<00:24,  1.62s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:07<00:24,  1.77s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:09<00:20,  1.61s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:10<00:17,  1.49s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:11<00:15,  1.45s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:12<00:13,  1.38s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:14<00:12,  1.36s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:15<00:10,  1.32s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:16<00:09,  1.29s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:18<00:08,  1.40s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:19<00:07,  1.42s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:21<00:05,  1.38s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:22<00:04,  1.37s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:23<00:02,  1.33s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:25<00:01,  1.47s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:28<00:00,  1.89s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:28<00:00,  1.48s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.09238
wandb: 
wandb: üöÄ View run wandering-sweep-145 at: https://wandb.ai/xzy11632/dance-dev/runs/1wh0v4hq
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_140659-1wh0v4hq/logs
wandb: Agent Starting Run: kgpfqxq6 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_141216-kgpfqxq6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run faithful-sweep-146
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/kgpfqxq6
[INFO][2024-03-16 14:12:21,781][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 14:12:21,864][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 14:12:21,864][dance][wrapped_func] Took 0:00:00.082425 to load and process data.
[INFO][2024-03-16 14:12:21,865][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 14:12:21,866][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 14:12:21,878][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:12:21,879][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:12:21,879][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:12:21,879][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:12:21,879][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:12:21,953][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 14:12:30,834][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 1000) (k=11)
[INFO][2024-03-16 14:12:30,835][dance.WeightedFeatureSVD][__call__] Total explained variance: 96.56%
[INFO][2024-03-16 14:12:33,260][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 14:12:33,260][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 14:12:33,260][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 14:12:33,261][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:07,  1.29s/it]  2%|‚ñè         | 2/100 [00:02<02:08,  1.32s/it]  3%|‚ñé         | 3/100 [00:03<02:04,  1.29s/it]  4%|‚ñç         | 4/100 [00:05<02:07,  1.33s/it]  5%|‚ñå         | 5/100 [00:06<02:01,  1.27s/it]  6%|‚ñå         | 6/100 [00:07<02:00,  1.29s/it]  7%|‚ñã         | 7/100 [00:09<01:59,  1.28s/it]  8%|‚ñä         | 8/100 [00:10<01:56,  1.27s/it]  9%|‚ñâ         | 9/100 [00:11<01:57,  1.29s/it] 10%|‚ñà         | 10/100 [00:12<01:50,  1.23s/it] 11%|‚ñà         | 11/100 [00:13<01:46,  1.19s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<02:05,  1.43s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<02:24,  1.66s/it] 14%|‚ñà‚ñç        | 14/100 [00:19<02:12,  1.53s/it] 15%|‚ñà‚ñå        | 15/100 [00:20<02:00,  1.42s/it] 16%|‚ñà‚ñå        | 16/100 [00:21<01:53,  1.35s/it] 17%|‚ñà‚ñã        | 17/100 [00:22<01:47,  1.30s/it] 18%|‚ñà‚ñä        | 18/100 [00:23<01:44,  1.27s/it] 19%|‚ñà‚ñâ        | 19/100 [00:25<01:46,  1.31s/it] 20%|‚ñà‚ñà        | 20/100 [00:27<01:54,  1.44s/it] 21%|‚ñà‚ñà        | 21/100 [00:29<02:08,  1.63s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:30<02:07,  1.64s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:32<01:59,  1.55s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:33<01:52,  1.48s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:34<01:49,  1.46s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:36<01:49,  1.48s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:37<01:42,  1.40s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:39<01:41,  1.40s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:41<01:54,  1.61s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:43<02:16,  1.94s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:45<02:00,  1.74s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:48<02:24,  2.12s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:51<02:42,  2.42s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:53<02:32,  2.32s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:55<02:21,  2.18s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:57<02:15,  2.11s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:58<02:05,  2.00s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:00<01:58,  1.90s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:02<01:55,  1.89s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:04<01:49,  1.83s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:05<01:42,  1.74s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:08<01:55,  2.00s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:11<02:16,  2.39s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:13<02:02,  2.19s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:14<01:51,  2.04s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:16<01:45,  1.95s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:18<01:40,  1.90s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:19<01:30,  1.74s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:21<01:28,  1.74s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:23<01:28,  1.76s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:25<01:26,  1.76s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:27<01:27,  1.83s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:28<01:23,  1.78s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:31<01:28,  1.91s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:34<01:43,  2.29s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:35<01:31,  2.09s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:37<01:22,  1.93s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:38<01:17,  1.84s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:40<01:13,  1.80s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:42<01:10,  1.76s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:43<01:07,  1.73s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:45<01:04,  1.69s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:47<01:01,  1.68s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:49<01:02,  1.74s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:50<01:01,  1.77s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:52<00:59,  1.75s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:54<00:56,  1.71s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:56<01:00,  1.90s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:59<01:11,  2.31s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:01<01:04,  2.13s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:03<00:58,  2.03s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:05<00:55,  1.97s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:06<00:50,  1.87s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:08<00:46,  1.80s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:10<00:44,  1.77s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:11<00:42,  1.76s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:13<00:41,  1.80s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:15<00:40,  1.84s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:17<00:38,  1.83s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:20<00:41,  2.09s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:23<00:45,  2.40s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:24<00:38,  2.13s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:26<00:33,  1.98s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:28<00:30,  1.88s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:29<00:26,  1.78s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:31<00:24,  1.72s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:32<00:21,  1.68s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:34<00:19,  1.61s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:35<00:17,  1.61s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:37<00:16,  1.60s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:39<00:14,  1.61s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:40<00:12,  1.55s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:42<00:11,  1.61s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:45<00:11,  1.96s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:46<00:09,  1.90s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:48<00:07,  1.78s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:49<00:04,  1.65s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:52<00:04,  2.08s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:55<00:02,  2.40s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:59<00:00,  2.64s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:59<00:00,  1.79s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.14918
wandb: 
wandb: üöÄ View run faithful-sweep-146 at: https://wandb.ai/xzy11632/dance-dev/runs/kgpfqxq6
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_141216-kgpfqxq6/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: l446qwj6 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_141732-l446qwj6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run misty-sweep-147
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/l446qwj6
[INFO][2024-03-16 14:17:38,441][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 14:17:38,534][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 14:17:38,534][dance][wrapped_func] Took 0:00:00.091551 to load and process data.
[INFO][2024-03-16 14:17:38,534][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 14:17:38,536][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 14:17:38,552][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:17:38,552][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:17:38,553][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:17:38,553][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 14:17:38,821][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run misty-sweep-147 at: https://wandb.ai/xzy11632/dance-dev/runs/l446qwj6
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_141732-l446qwj6/logs
wandb: ERROR Run l446qwj6 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1000) out of bounds (1000)
wandb: ERROR 
wandb: Agent Starting Run: tfyqjq6l with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_141754-tfyqjq6l
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run icy-sweep-148
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/tfyqjq6l
[INFO][2024-03-16 14:17:59,848][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 14:17:59,937][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 14:17:59,937][dance][wrapped_func] Took 0:00:00.088609 to load and process data.
[INFO][2024-03-16 14:17:59,937][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 14:17:59,939][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 14:17:59,954][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:17:59,954][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:17:59,955][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:17:59,955][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 14:18:00,199][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run icy-sweep-148 at: https://wandb.ai/xzy11632/dance-dev/runs/tfyqjq6l
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_141754-tfyqjq6l/logs
wandb: ERROR Run tfyqjq6l errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1000) out of bounds (1000)
wandb: ERROR 
wandb: Agent Starting Run: o8quhfrq with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_141815-o8quhfrq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run legendary-sweep-149
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/o8quhfrq
[INFO][2024-03-16 14:18:21,229][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 14:18:21,331][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 14:18:21,331][dance][wrapped_func] Took 0:00:00.101374 to load and process data.
[INFO][2024-03-16 14:18:21,331][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 14:18:21,333][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 14:18:21,349][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:18:21,350][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:18:21,350][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:18:21,350][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 14:18:21,750][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=7)
[INFO][2024-03-16 14:18:21,750][dance.WeightedFeaturePCA][__call__] Total explained variance: 91.08%
[INFO][2024-03-16 14:18:25,016][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 14:18:25,016][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 14:18:25,016][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 14:18:25,016][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:45,  1.07s/it]  2%|‚ñè         | 2/100 [00:02<01:40,  1.03s/it]  3%|‚ñé         | 3/100 [00:03<01:39,  1.03s/it]  4%|‚ñç         | 4/100 [00:04<01:37,  1.02s/it]  5%|‚ñå         | 5/100 [00:05<01:37,  1.02s/it]  6%|‚ñå         | 6/100 [00:06<01:38,  1.04s/it]  7%|‚ñã         | 7/100 [00:07<01:38,  1.06s/it]  8%|‚ñä         | 8/100 [00:08<01:37,  1.05s/it]  9%|‚ñâ         | 9/100 [00:09<01:39,  1.09s/it] 10%|‚ñà         | 10/100 [00:10<01:39,  1.11s/it] 11%|‚ñà         | 11/100 [00:11<01:40,  1.13s/it] 12%|‚ñà‚ñè        | 12/100 [00:13<01:50,  1.26s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:59,  1.38s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:54,  1.33s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:46,  1.25s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<01:40,  1.19s/it] 17%|‚ñà‚ñã        | 17/100 [00:19<01:34,  1.14s/it] 18%|‚ñà‚ñä        | 18/100 [00:20<01:31,  1.11s/it] 19%|‚ñà‚ñâ        | 19/100 [00:21<01:28,  1.09s/it] 20%|‚ñà‚ñà        | 20/100 [00:22<01:27,  1.09s/it] 21%|‚ñà‚ñà        | 21/100 [00:23<01:23,  1.05s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:24<01:23,  1.07s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:25<01:23,  1.09s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:26<01:24,  1.11s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:28<01:23,  1.11s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:29<01:24,  1.14s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:30<01:23,  1.14s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:32<01:33,  1.30s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:34<01:50,  1.55s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:35<01:39,  1.42s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:36<01:31,  1.33s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:37<01:24,  1.24s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:38<01:19,  1.19s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:39<01:17,  1.17s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:40<01:16,  1.18s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:41<01:13,  1.15s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:43<01:13,  1.16s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:44<01:12,  1.18s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:45<01:11,  1.18s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:46<01:11,  1.19s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:48<01:11,  1.20s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:49<01:10,  1.21s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:50<01:12,  1.28s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:52<01:22,  1.48s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:55<01:50,  2.01s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:57<01:43,  1.91s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:58<01:27,  1.66s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:59<01:15,  1.46s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:00<01:08,  1.34s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:01<01:01,  1.23s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:02<00:57,  1.18s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:03<00:54,  1.13s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:04<00:53,  1.13s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:05<00:51,  1.11s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:06<00:49,  1.10s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:08<00:49,  1.12s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:09<00:46,  1.08s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:10<00:45,  1.08s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:11<00:52,  1.27s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:13<00:58,  1.47s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:14<00:52,  1.36s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:16<00:48,  1.27s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:17<00:46,  1.25s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:18<00:45,  1.25s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:19<00:43,  1.25s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:20<00:41,  1.21s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:22<00:39,  1.20s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:23<00:38,  1.19s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:24<00:37,  1.20s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:25<00:37,  1.25s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:27<00:36,  1.27s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:28<00:34,  1.24s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:29<00:36,  1.36s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:31<00:39,  1.51s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:32<00:35,  1.42s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:34<00:36,  1.51s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:35<00:32,  1.42s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:37<00:29,  1.32s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:38<00:26,  1.24s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:39<00:23,  1.17s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:40<00:22,  1.18s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:41<00:20,  1.13s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:42<00:18,  1.11s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:43<00:17,  1.10s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:44<00:16,  1.13s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:45<00:15,  1.11s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:46<00:14,  1.11s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:47<00:13,  1.08s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:49<00:14,  1.31s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:51<00:15,  1.55s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:52<00:12,  1.39s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:53<00:10,  1.32s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:55<00:08,  1.25s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:56<00:07,  1.19s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:57<00:05,  1.18s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:58<00:04,  1.15s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:59<00:03,  1.11s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:00<00:02,  1.12s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:01<00:01,  1.15s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:02<00:00,  1.17s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:02<00:00,  1.23s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.15228
wandb: 
wandb: üöÄ View run legendary-sweep-149 at: https://wandb.ai/xzy11632/dance-dev/runs/o8quhfrq
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_141815-o8quhfrq/logs
wandb: Agent Starting Run: mc951d77 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_142222-mc951d77
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run quiet-sweep-150
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/mc951d77
[INFO][2024-03-16 14:22:27,497][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 14:22:27,616][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 14:22:27,616][dance][wrapped_func] Took 0:00:00.117178 to load and process data.
[INFO][2024-03-16 14:22:27,616][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 14:22:27,618][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 14:22:27,634][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:22:27,635][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:22:27,635][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:22:27,635][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 14:22:30,715][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=7)
[INFO][2024-03-16 14:22:30,715][dance.WeightedFeatureSVD][__call__] Total explained variance: 91.05%
[INFO][2024-03-16 14:22:34,524][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 14:22:34,524][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 14:22:34,524][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 14:22:34,525][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:48,  1.10s/it]  2%|‚ñè         | 2/100 [00:02<01:42,  1.05s/it]  3%|‚ñé         | 3/100 [00:03<01:41,  1.05s/it]  4%|‚ñç         | 4/100 [00:04<01:42,  1.07s/it]  5%|‚ñå         | 5/100 [00:05<01:46,  1.12s/it]  6%|‚ñå         | 6/100 [00:06<01:44,  1.11s/it]  7%|‚ñã         | 7/100 [00:07<01:41,  1.09s/it]  8%|‚ñä         | 8/100 [00:08<01:38,  1.08s/it]  9%|‚ñâ         | 9/100 [00:09<01:41,  1.12s/it] 10%|‚ñà         | 10/100 [00:11<01:41,  1.13s/it] 11%|‚ñà         | 11/100 [00:12<01:39,  1.12s/it] 12%|‚ñà‚ñè        | 12/100 [00:13<01:38,  1.12s/it] 13%|‚ñà‚ñé        | 13/100 [00:14<01:38,  1.13s/it] 14%|‚ñà‚ñç        | 14/100 [00:15<01:35,  1.11s/it] 15%|‚ñà‚ñå        | 15/100 [00:16<01:32,  1.09s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<01:47,  1.28s/it] 17%|‚ñà‚ñã        | 17/100 [00:20<02:05,  1.52s/it] 18%|‚ñà‚ñä        | 18/100 [00:21<01:52,  1.38s/it] 19%|‚ñà‚ñâ        | 19/100 [00:22<01:45,  1.30s/it] 20%|‚ñà‚ñà        | 20/100 [00:23<01:38,  1.23s/it] 21%|‚ñà‚ñà        | 21/100 [00:24<01:33,  1.19s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:25<01:30,  1.16s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:26<01:31,  1.19s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:28<01:27,  1.15s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:29<01:26,  1.15s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:30<01:25,  1.15s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:31<01:24,  1.16s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:32<01:24,  1.18s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:33<01:23,  1.17s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:35<01:21,  1.17s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:36<01:19,  1.16s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:37<01:27,  1.29s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:39<01:42,  1.53s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:41<01:37,  1.48s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:42<01:27,  1.34s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:43<01:20,  1.26s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:44<01:15,  1.19s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:45<01:11,  1.16s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:46<01:09,  1.13s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:47<01:08,  1.14s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:49<01:12,  1.23s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:50<01:10,  1.22s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:51<01:09,  1.21s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:52<01:06,  1.19s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:53<01:05,  1.20s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:55<01:04,  1.20s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:56<01:10,  1.33s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:58<01:08,  1.33s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:59<01:17,  1.52s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:01<01:10,  1.41s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:02<01:04,  1.32s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:03<01:03,  1.32s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:05<01:07,  1.43s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:06<01:04,  1.39s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:07<00:58,  1.29s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:08<00:54,  1.23s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:09<00:49,  1.15s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:10<00:47,  1.14s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:11<00:46,  1.14s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:13<00:44,  1.12s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:14<00:43,  1.11s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:15<00:42,  1.11s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:16<00:40,  1.09s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:17<00:44,  1.22s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:19<00:43,  1.25s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:20<00:49,  1.44s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:21<00:43,  1.31s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:23<00:39,  1.23s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:24<00:37,  1.21s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:25<00:36,  1.21s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:26<00:34,  1.18s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:27<00:32,  1.17s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:28<00:30,  1.12s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:29<00:28,  1.10s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:30<00:27,  1.11s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:32<00:27,  1.13s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:33<00:25,  1.12s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:34<00:24,  1.12s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:35<00:23,  1.12s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:36<00:22,  1.11s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:38<00:25,  1.34s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:40<00:28,  1.56s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:41<00:23,  1.39s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:42<00:20,  1.29s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:43<00:18,  1.20s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:44<00:16,  1.19s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:45<00:15,  1.17s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:46<00:13,  1.14s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:47<00:12,  1.10s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:48<00:10,  1.07s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:49<00:09,  1.08s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:50<00:08,  1.08s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:52<00:07,  1.08s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:53<00:06,  1.10s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:54<00:05,  1.12s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:55<00:04,  1.11s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:57<00:03,  1.25s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:58<00:02,  1.29s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:00<00:01,  1.44s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:01<00:00,  1.32s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:01<00:00,  1.21s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.14722
wandb: 
wandb: üöÄ View run quiet-sweep-150 at: https://wandb.ai/xzy11632/dance-dev/runs/mc951d77
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_142222-mc951d77/logs
wandb: Agent Starting Run: 5py35xui with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_142623-5py35xui
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run helpful-sweep-151
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/5py35xui
[INFO][2024-03-16 14:26:28,697][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 14:26:28,804][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 14:26:28,804][dance][wrapped_func] Took 0:00:00.106609 to load and process data.
[INFO][2024-03-16 14:26:28,804][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 14:26:28,807][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 14:26:28,825][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:26:28,833][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:26:28,834][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:26:28,834][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.017 MB of 0.025 MB uploadedwandb: \ 0.017 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run helpful-sweep-151 at: https://wandb.ai/xzy11632/dance-dev/runs/5py35xui
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_142623-5py35xui/logs
wandb: ERROR Run 5py35xui errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: dht0syr7 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_142646-dht0syr7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fanciful-sweep-152
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/dht0syr7
[INFO][2024-03-16 14:26:51,651][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 14:26:51,749][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 14:26:51,749][dance][wrapped_func] Took 0:00:00.097075 to load and process data.
[INFO][2024-03-16 14:26:51,749][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 14:26:51,751][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 14:26:51,766][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:26:51,766][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:26:51,767][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:26:51,767][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run fanciful-sweep-152 at: https://wandb.ai/xzy11632/dance-dev/runs/dht0syr7
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_142646-dht0syr7/logs
wandb: ERROR Run dht0syr7 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: 8gwaj4j0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_142710-8gwaj4j0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run crisp-sweep-153
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/8gwaj4j0
[INFO][2024-03-16 14:27:15,549][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 14:27:15,669][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 14:27:15,670][dance][wrapped_func] Took 0:00:00.105727 to load and process data.
[INFO][2024-03-16 14:27:15,670][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 14:27:15,671][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 14:27:15,687][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:27:15,687][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:27:15,688][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:27:15,688][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run crisp-sweep-153 at: https://wandb.ai/xzy11632/dance-dev/runs/8gwaj4j0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_142710-8gwaj4j0/logs
wandb: ERROR Run 8gwaj4j0 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: b12r0y72 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_142733-b12r0y72
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run drawn-sweep-154
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/b12r0y72
[INFO][2024-03-16 14:27:37,719][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 14:27:37,815][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 14:27:37,815][dance][wrapped_func] Took 0:00:00.095437 to load and process data.
[INFO][2024-03-16 14:27:37,815][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 14:27:37,817][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 14:27:37,833][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:27:37,833][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:27:37,834][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:27:37,834][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run drawn-sweep-154 at: https://wandb.ai/xzy11632/dance-dev/runs/b12r0y72
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_142733-b12r0y72/logs
wandb: ERROR Run b12r0y72 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 14yb5dyb with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_142758-14yb5dyb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run hearty-sweep-155
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/14yb5dyb
[INFO][2024-03-16 14:28:04,669][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 14:28:04,952][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 14:28:04,952][dance][wrapped_func] Took 0:00:00.282763 to load and process data.
[INFO][2024-03-16 14:28:04,953][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 14:28:04,956][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 14:28:04,973][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:28:04,973][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:28:04,974][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:28:04,974][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 14:28:05,724][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=2)
[INFO][2024-03-16 14:28:05,725][dance.WeightedFeaturePCA][__call__] Total explained variance: 92.04%
[INFO][2024-03-16 14:28:08,319][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 14:28:08,319][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 14:28:08,319][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 14:28:08,320][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:59,  1.21s/it]  2%|‚ñè         | 2/100 [00:02<02:27,  1.51s/it]  3%|‚ñé         | 3/100 [00:04<02:19,  1.44s/it]  4%|‚ñç         | 4/100 [00:06<02:42,  1.69s/it]  5%|‚ñå         | 5/100 [00:07<02:21,  1.49s/it]  6%|‚ñå         | 6/100 [00:08<02:12,  1.41s/it]  7%|‚ñã         | 7/100 [00:09<02:06,  1.36s/it]  8%|‚ñä         | 8/100 [00:11<02:15,  1.47s/it]  9%|‚ñâ         | 9/100 [00:12<02:06,  1.39s/it] 10%|‚ñà         | 10/100 [00:13<01:55,  1.29s/it] 11%|‚ñà         | 11/100 [00:15<01:52,  1.26s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<01:51,  1.27s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<01:45,  1.21s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<01:47,  1.25s/it] 15%|‚ñà‚ñå        | 15/100 [00:20<01:48,  1.28s/it] 16%|‚ñà‚ñå        | 16/100 [00:21<01:47,  1.28s/it] 17%|‚ñà‚ñã        | 17/100 [00:22<01:43,  1.25s/it] 18%|‚ñà‚ñä        | 18/100 [00:24<01:58,  1.45s/it] 19%|‚ñà‚ñâ        | 19/100 [00:26<02:17,  1.70s/it] 20%|‚ñà‚ñà        | 20/100 [00:28<02:08,  1.60s/it] 21%|‚ñà‚ñà        | 21/100 [00:29<02:00,  1.53s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:30<01:50,  1.41s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:31<01:40,  1.30s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:33<01:41,  1.33s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:34<01:33,  1.24s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:35<01:30,  1.23s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:36<01:30,  1.24s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:37<01:28,  1.23s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:39<01:30,  1.28s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:40<01:30,  1.30s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:41<01:28,  1.28s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:43<01:32,  1.36s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:44<01:34,  1.41s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:46<01:45,  1.60s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:48<01:35,  1.46s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:49<01:29,  1.40s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:50<01:25,  1.36s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:51<01:20,  1.29s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:53<01:19,  1.30s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:54<01:15,  1.26s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:55<01:11,  1.21s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:56<01:10,  1.22s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:57<01:11,  1.26s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:59<01:11,  1.27s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:00<01:11,  1.30s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:01<01:06,  1.24s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:02<01:03,  1.19s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:04<01:11,  1.37s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:06<01:19,  1.56s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:07<01:14,  1.49s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:09<01:08,  1.40s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:10<01:04,  1.35s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:11<01:01,  1.30s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:12<00:58,  1.27s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:13<00:54,  1.21s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:14<00:52,  1.19s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:16<00:50,  1.16s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:17<00:51,  1.22s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:18<00:48,  1.19s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:20<00:51,  1.28s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:21<00:49,  1.28s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:22<00:52,  1.39s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:24<00:55,  1.49s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:25<00:51,  1.42s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:27<00:56,  1.60s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:29<00:51,  1.50s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:30<00:47,  1.44s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:31<00:46,  1.45s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:33<00:41,  1.35s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:34<00:38,  1.29s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:35<00:36,  1.25s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:36<00:33,  1.21s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:37<00:32,  1.21s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:38<00:30,  1.18s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:39<00:28,  1.14s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:40<00:26,  1.12s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:42<00:25,  1.10s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:43<00:27,  1.25s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:45<00:28,  1.34s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:47<00:31,  1.56s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:48<00:26,  1.42s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:49<00:23,  1.31s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:50<00:21,  1.24s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:51<00:18,  1.16s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:52<00:17,  1.13s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:53<00:15,  1.14s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:54<00:15,  1.17s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:55<00:13,  1.14s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:57<00:12,  1.16s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:58<00:11,  1.19s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:59<00:10,  1.19s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:00<00:09,  1.16s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:01<00:08,  1.17s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:03<00:07,  1.19s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:04<00:06,  1.35s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:06<00:05,  1.40s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:08<00:04,  1.56s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:09<00:03,  1.51s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:10<00:01,  1.43s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:11<00:00,  1.30s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:11<00:00,  1.32s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.022 MB of 0.025 MB uploadedwandb: / 0.022 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.04964
wandb: 
wandb: üöÄ View run hearty-sweep-155 at: https://wandb.ai/xzy11632/dance-dev/runs/14yb5dyb
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_142758-14yb5dyb/logs
wandb: Agent Starting Run: maai0uf7 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_143202-maai0uf7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rosy-sweep-156
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/maai0uf7
[INFO][2024-03-16 14:32:08,468][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 14:32:08,546][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 14:32:08,547][dance][wrapped_func] Took 0:00:00.077985 to load and process data.
[INFO][2024-03-16 14:32:08,547][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 14:32:08,549][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 14:32:08,562][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:32:08,562][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:32:08,563][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:32:08,563][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 14:32:10,204][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=4)
[INFO][2024-03-16 14:32:10,210][dance.WeightedFeatureSVD][__call__] Total explained variance: 95.87%
[INFO][2024-03-16 14:32:12,178][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 14:32:12,178][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 14:32:12,178][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 14:32:12,179][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:49,  1.10s/it]  2%|‚ñè         | 2/100 [00:02<01:43,  1.06s/it]  3%|‚ñé         | 3/100 [00:03<01:45,  1.09s/it]  4%|‚ñç         | 4/100 [00:04<01:43,  1.08s/it]  5%|‚ñå         | 5/100 [00:05<01:43,  1.09s/it]  6%|‚ñå         | 6/100 [00:06<01:47,  1.14s/it]  7%|‚ñã         | 7/100 [00:07<01:45,  1.13s/it]  8%|‚ñä         | 8/100 [00:08<01:44,  1.14s/it]  9%|‚ñâ         | 9/100 [00:10<01:48,  1.19s/it] 10%|‚ñà         | 10/100 [00:11<01:57,  1.30s/it] 11%|‚ñà         | 11/100 [00:13<02:17,  1.55s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<02:14,  1.53s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<02:03,  1.42s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:54,  1.33s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:51,  1.31s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<01:51,  1.32s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:45,  1.27s/it] 18%|‚ñà‚ñä        | 18/100 [00:22<01:40,  1.22s/it] 19%|‚ñà‚ñâ        | 19/100 [00:23<01:36,  1.19s/it] 20%|‚ñà‚ñà        | 20/100 [00:25<01:39,  1.24s/it] 21%|‚ñà‚ñà        | 21/100 [00:26<01:42,  1.30s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:27<01:39,  1.28s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:28<01:37,  1.26s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:30<01:37,  1.29s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:31<01:45,  1.40s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:33<01:44,  1.41s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:35<01:54,  1.57s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:36<01:44,  1.46s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:37<01:40,  1.41s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:38<01:33,  1.33s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:40<01:27,  1.27s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:41<01:24,  1.24s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:42<01:21,  1.22s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:43<01:22,  1.25s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:44<01:21,  1.25s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:46<01:20,  1.25s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:47<01:20,  1.28s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:48<01:19,  1.28s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:50<01:18,  1.28s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:51<01:19,  1.32s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:53<01:24,  1.44s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:55<01:42,  1.76s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:58<01:51,  1.95s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:59<01:40,  1.79s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:00<01:29,  1.62s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:02<01:20,  1.49s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:03<01:14,  1.41s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:04<01:11,  1.37s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:05<01:07,  1.32s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:07<01:06,  1.34s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:08<01:04,  1.31s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:09<01:06,  1.38s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:11<01:05,  1.40s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:12<01:04,  1.41s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:14<01:02,  1.39s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:15<00:59,  1.36s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:16<00:54,  1.27s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:18<01:01,  1.46s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:20<01:03,  1.55s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:21<00:59,  1.48s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:22<00:54,  1.39s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:23<00:51,  1.35s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:25<00:49,  1.33s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:26<00:45,  1.27s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:27<00:41,  1.19s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:28<00:40,  1.20s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:29<00:38,  1.16s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:30<00:36,  1.13s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:31<00:34,  1.12s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:32<00:33,  1.13s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:34<00:32,  1.13s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:35<00:31,  1.13s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:36<00:30,  1.12s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:37<00:29,  1.14s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:38<00:28,  1.13s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:39<00:26,  1.10s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:41<00:29,  1.27s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:43<00:34,  1.58s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:44<00:30,  1.45s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:45<00:26,  1.35s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:46<00:24,  1.27s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:48<00:22,  1.22s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:48<00:19,  1.15s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:50<00:17,  1.12s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:51<00:16,  1.12s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:52<00:15,  1.14s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:53<00:15,  1.16s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:54<00:13,  1.15s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:55<00:12,  1.13s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:56<00:11,  1.12s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:57<00:10,  1.13s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:59<00:09,  1.18s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:00<00:09,  1.32s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:03<00:09,  1.58s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:04<00:07,  1.41s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:05<00:05,  1.37s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:06<00:03,  1.33s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:07<00:02,  1.26s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:09<00:01,  1.29s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:10<00:00,  1.23s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:10<00:00,  1.30s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.026 MB uploadedwandb: | 0.012 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.11319
wandb: 
wandb: üöÄ View run rosy-sweep-156 at: https://wandb.ai/xzy11632/dance-dev/runs/maai0uf7
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_143202-maai0uf7/logs
wandb: Agent Starting Run: 3k7bcsgo with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_143610-3k7bcsgo
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run efficient-sweep-157
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/3k7bcsgo
[INFO][2024-03-16 14:36:16,706][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 14:36:16,774][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 14:36:16,774][dance][wrapped_func] Took 0:00:00.065797 to load and process data.
[INFO][2024-03-16 14:36:16,774][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 14:36:16,776][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 14:36:16,789][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:36:16,790][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:36:16,790][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:36:16,790][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:36:16,790][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[WARNING][2024-03-16 14:37:29,855][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 14:37:34,033][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 1000) (k=543)
[INFO][2024-03-16 14:37:34,034][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.03%
[INFO][2024-03-16 14:37:40,243][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 14:37:40,244][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 14:37:40,244][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 14:37:40,245][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<03:12,  1.94s/it]  2%|‚ñè         | 2/100 [00:03<02:52,  1.76s/it]  3%|‚ñé         | 3/100 [00:05<02:46,  1.72s/it]  4%|‚ñç         | 4/100 [00:06<02:43,  1.70s/it]  5%|‚ñå         | 5/100 [00:08<02:38,  1.67s/it]  6%|‚ñå         | 6/100 [00:10<02:41,  1.71s/it]  7%|‚ñã         | 7/100 [00:12<02:49,  1.82s/it]  8%|‚ñä         | 8/100 [00:14<02:45,  1.80s/it]  9%|‚ñâ         | 9/100 [00:15<02:43,  1.80s/it] 10%|‚ñà         | 10/100 [00:17<02:36,  1.74s/it] 11%|‚ñà         | 11/100 [00:19<02:35,  1.74s/it] 12%|‚ñà‚ñè        | 12/100 [00:21<02:32,  1.74s/it] 13%|‚ñà‚ñé        | 13/100 [00:24<03:19,  2.30s/it] 14%|‚ñà‚ñç        | 14/100 [00:26<03:13,  2.25s/it] 15%|‚ñà‚ñå        | 15/100 [00:28<02:54,  2.06s/it] 16%|‚ñà‚ñå        | 16/100 [00:30<02:46,  1.98s/it] 17%|‚ñà‚ñã        | 17/100 [00:31<02:35,  1.88s/it] 18%|‚ñà‚ñä        | 18/100 [00:33<02:28,  1.81s/it] 19%|‚ñà‚ñâ        | 19/100 [00:35<02:25,  1.79s/it] 20%|‚ñà‚ñà        | 20/100 [00:36<02:19,  1.75s/it] 21%|‚ñà‚ñà        | 21/100 [00:38<02:17,  1.75s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:40<02:19,  1.79s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:42<02:25,  1.89s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:44<02:26,  1.93s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:46<02:20,  1.87s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:50<03:04,  2.49s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:52<02:44,  2.26s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:53<02:31,  2.11s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:55<02:21,  1.99s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:57<02:10,  1.87s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:58<02:06,  1.84s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:00<02:01,  1.79s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:02<02:03,  1.85s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:04<02:03,  1.87s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:06<02:03,  1.90s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:08<01:58,  1.86s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:09<01:53,  1.80s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:13<02:29,  2.41s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:15<02:15,  2.22s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:17<02:06,  2.11s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:19<01:58,  2.01s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:20<01:54,  1.97s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:22<01:42,  1.80s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:24<01:41,  1.81s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:26<01:44,  1.90s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:28<01:42,  1.90s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:30<01:41,  1.91s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:31<01:38,  1.89s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:34<01:41,  2.00s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:37<02:02,  2.45s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:38<01:42,  2.09s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:40<01:26,  1.80s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:41<01:15,  1.62s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:42<01:07,  1.47s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:43<01:01,  1.36s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:44<00:57,  1.30s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:45<00:54,  1.26s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:47<00:53,  1.27s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:48<00:52,  1.29s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:49<00:52,  1.32s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:51<00:52,  1.35s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:52<00:52,  1.39s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:54<00:49,  1.35s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:56<01:01,  1.70s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:59<01:12,  2.07s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [02:00<01:01,  1.82s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [02:02<00:57,  1.73s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [02:03<00:51,  1.62s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:04<00:47,  1.55s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:06<00:45,  1.53s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:07<00:42,  1.46s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:09<00:41,  1.48s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:10<00:38,  1.44s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:12<00:40,  1.54s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:14<00:39,  1.58s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:15<00:35,  1.49s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:17<00:42,  1.84s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:20<00:42,  1.92s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:21<00:36,  1.76s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:23<00:33,  1.69s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:24<00:30,  1.59s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:26<00:29,  1.65s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:27<00:26,  1.55s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:29<00:25,  1.59s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:30<00:23,  1.54s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:31<00:20,  1.47s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:33<00:19,  1.48s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:34<00:18,  1.50s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:37<00:19,  1.81s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:40<00:20,  2.07s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:41<00:17,  1.95s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:43<00:14,  1.80s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:44<00:11,  1.69s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:45<00:09,  1.57s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:47<00:07,  1.50s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:48<00:05,  1.44s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:49<00:04,  1.41s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:51<00:02,  1.47s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:53<00:01,  1.50s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:54<00:00,  1.51s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:54<00:00,  1.75s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.2694
wandb: 
wandb: üöÄ View run efficient-sweep-157 at: https://wandb.ai/xzy11632/dance-dev/runs/3k7bcsgo
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_143610-3k7bcsgo/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 1oe11v0w with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_144228-1oe11v0w
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run desert-sweep-158
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/1oe11v0w
[INFO][2024-03-16 14:42:33,118][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 14:42:33,208][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 14:42:33,208][dance][wrapped_func] Took 0:00:00.085004 to load and process data.
[INFO][2024-03-16 14:42:33,209][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 14:42:33,211][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 14:42:33,227][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:42:33,227][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:42:33,227][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:42:33,228][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:42:33,228][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[WARNING][2024-03-16 14:43:36,647][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 14:46:20,205][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 1000) (k=549)
[INFO][2024-03-16 14:46:20,206][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.98%
[INFO][2024-03-16 14:47:56,276][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 14:47:56,276][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 14:47:56,276][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 14:47:56,277][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:24,  1.46s/it]  2%|‚ñè         | 2/100 [00:02<02:27,  1.50s/it]  3%|‚ñé         | 3/100 [00:04<02:30,  1.55s/it]  4%|‚ñç         | 4/100 [00:05<02:15,  1.41s/it]  5%|‚ñå         | 5/100 [00:07<02:09,  1.36s/it]  6%|‚ñå         | 6/100 [00:08<02:15,  1.44s/it]  7%|‚ñã         | 7/100 [00:10<02:11,  1.42s/it]  8%|‚ñä         | 8/100 [00:11<02:14,  1.47s/it]  9%|‚ñâ         | 9/100 [00:13<02:13,  1.46s/it] 10%|‚ñà         | 10/100 [00:14<02:22,  1.58s/it] 11%|‚ñà         | 11/100 [00:16<02:20,  1.58s/it] 12%|‚ñà‚ñè        | 12/100 [00:18<02:31,  1.72s/it] 13%|‚ñà‚ñé        | 13/100 [00:21<03:05,  2.14s/it] 14%|‚ñà‚ñç        | 14/100 [00:23<02:46,  1.94s/it] 15%|‚ñà‚ñå        | 15/100 [00:24<02:31,  1.79s/it] 16%|‚ñà‚ñå        | 16/100 [00:25<02:21,  1.69s/it] 17%|‚ñà‚ñã        | 17/100 [00:27<02:11,  1.59s/it] 18%|‚ñà‚ñä        | 18/100 [00:28<02:04,  1.52s/it] 19%|‚ñà‚ñâ        | 19/100 [00:30<02:02,  1.51s/it] 20%|‚ñà‚ñà        | 20/100 [00:31<01:59,  1.50s/it] 21%|‚ñà‚ñà        | 21/100 [00:33<01:59,  1.51s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:34<01:59,  1.54s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:36<01:57,  1.52s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:37<01:50,  1.46s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:39<01:49,  1.46s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:40<01:44,  1.41s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:44<02:35,  2.13s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:45<02:22,  1.98s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:47<02:08,  1.81s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:48<01:56,  1.66s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:50<01:53,  1.64s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:51<01:46,  1.57s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:52<01:41,  1.52s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:54<01:38,  1.49s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:55<01:36,  1.48s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:57<01:36,  1.50s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:58<01:32,  1.47s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:00<01:36,  1.55s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:01<01:33,  1.53s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:04<01:41,  1.70s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:07<02:04,  2.11s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:08<01:49,  1.89s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:09<01:39,  1.75s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:11<01:30,  1.62s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:12<01:25,  1.55s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:13<01:19,  1.47s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:15<01:15,  1.42s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:16<01:16,  1.47s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:18<01:14,  1.47s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:20<01:23,  1.67s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:22<01:22,  1.67s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:23<01:15,  1.57s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:26<01:30,  1.93s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:28<01:33,  2.02s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:29<01:24,  1.89s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:31<01:17,  1.76s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:32<01:12,  1.68s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:34<01:06,  1.59s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:35<01:06,  1.61s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:37<01:01,  1.53s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:38<00:59,  1.51s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:40<00:56,  1.49s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:41<00:54,  1.46s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:43<00:53,  1.48s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:44<00:48,  1.38s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:46<00:54,  1.61s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:48<01:01,  1.85s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:50<00:52,  1.65s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:51<00:46,  1.51s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:52<00:42,  1.40s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:53<00:39,  1.35s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:54<00:36,  1.30s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:55<00:33,  1.26s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:57<00:32,  1.26s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:58<00:31,  1.26s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:59<00:30,  1.28s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:01<00:30,  1.32s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:02<00:27,  1.27s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:04<00:31,  1.48s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:07<00:37,  1.88s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:08<00:32,  1.70s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:09<00:27,  1.54s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:10<00:24,  1.44s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:12<00:21,  1.37s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:13<00:21,  1.42s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:14<00:18,  1.34s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:15<00:16,  1.30s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:17<00:17,  1.44s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:19<00:16,  1.47s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:20<00:15,  1.54s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:22<00:13,  1.49s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:23<00:11,  1.41s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:24<00:09,  1.33s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:26<00:08,  1.45s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:28<00:08,  1.77s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:32<00:09,  2.45s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:37<00:09,  3.07s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:42<00:07,  3.66s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:47<00:03,  3.93s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:51<00:00,  4.22s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:51<00:00,  1.72s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.29903
wandb: 
wandb: üöÄ View run desert-sweep-158 at: https://wandb.ai/xzy11632/dance-dev/runs/1oe11v0w
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_144228-1oe11v0w/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 6trqa5v1 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_145249-6trqa5v1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run graceful-sweep-159
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/6trqa5v1
[INFO][2024-03-16 14:52:55,608][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 14:52:55,693][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 14:52:55,694][dance][wrapped_func] Took 0:00:00.079095 to load and process data.
[INFO][2024-03-16 14:52:55,694][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 14:52:55,697][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 14:52:55,716][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:52:55,717][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:52:55,717][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:52:55,717][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 14:54:03,999][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.016 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run graceful-sweep-159 at: https://wandb.ai/xzy11632/dance-dev/runs/6trqa5v1
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_145249-6trqa5v1/logs
wandb: ERROR Run 6trqa5v1 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1000) out of bounds (1000)
wandb: ERROR 
wandb: Agent Starting Run: xmlzq2wf with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_145419-xmlzq2wf
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run whole-sweep-160
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/xmlzq2wf
[INFO][2024-03-16 14:54:24,919][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 14:54:25,036][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 14:54:25,037][dance][wrapped_func] Took 0:00:00.113201 to load and process data.
[INFO][2024-03-16 14:54:25,037][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 14:54:25,038][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 14:54:25,054][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:54:25,055][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:54:25,055][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:54:25,055][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 14:55:40,257][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.018 MB of 0.024 MB uploadedwandb: | 0.021 MB of 0.024 MB uploadedwandb: / 0.021 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run whole-sweep-160 at: https://wandb.ai/xzy11632/dance-dev/runs/xmlzq2wf
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_145419-xmlzq2wf/logs
wandb: ERROR Run xmlzq2wf errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1000) out of bounds (1000)
wandb: ERROR 
wandb: Agent Starting Run: p4davh5j with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_145554-p4davh5j
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run good-sweep-161
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/p4davh5j
[INFO][2024-03-16 14:55:59,889][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 14:55:59,975][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 14:55:59,975][dance][wrapped_func] Took 0:00:00.085771 to load and process data.
[INFO][2024-03-16 14:55:59,975][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 14:55:59,977][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 14:55:59,997][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:55:59,997][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:55:59,998][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 14:55:59,998][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-16 14:57:08,321][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=72)
[INFO][2024-03-16 14:57:08,322][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.04%
[INFO][2024-03-16 14:57:10,635][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 14:57:10,636][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 14:57:10,636][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 14:57:10,637][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:53,  1.15s/it]  2%|‚ñè         | 2/100 [00:02<01:55,  1.18s/it]  3%|‚ñé         | 3/100 [00:03<01:57,  1.21s/it]  4%|‚ñç         | 4/100 [00:04<01:58,  1.23s/it]  5%|‚ñå         | 5/100 [00:06<02:09,  1.36s/it]  6%|‚ñå         | 6/100 [00:08<02:14,  1.43s/it]  7%|‚ñã         | 7/100 [00:10<02:30,  1.62s/it]  8%|‚ñä         | 8/100 [00:11<02:22,  1.55s/it]  9%|‚ñâ         | 9/100 [00:12<02:15,  1.49s/it] 10%|‚ñà         | 10/100 [00:13<02:02,  1.36s/it] 11%|‚ñà         | 11/100 [00:15<01:58,  1.33s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<01:54,  1.31s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<01:51,  1.28s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<01:51,  1.30s/it] 15%|‚ñà‚ñå        | 15/100 [00:20<01:47,  1.26s/it] 16%|‚ñà‚ñå        | 16/100 [00:21<01:47,  1.28s/it] 17%|‚ñà‚ñã        | 17/100 [00:22<01:46,  1.28s/it] 18%|‚ñà‚ñä        | 18/100 [00:24<01:48,  1.32s/it] 19%|‚ñà‚ñâ        | 19/100 [00:25<01:49,  1.35s/it] 20%|‚ñà‚ñà        | 20/100 [00:27<02:01,  1.52s/it] 21%|‚ñà‚ñà        | 21/100 [00:29<02:14,  1.70s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:31<02:09,  1.66s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:32<01:58,  1.54s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:33<01:56,  1.53s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:35<01:49,  1.46s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:36<01:43,  1.40s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:37<01:36,  1.33s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:38<01:33,  1.30s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:40<01:34,  1.32s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:41<01:33,  1.33s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:42<01:27,  1.27s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:44<01:30,  1.33s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:45<01:32,  1.38s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:47<01:44,  1.59s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:49<01:55,  1.78s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:51<01:40,  1.58s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:52<01:29,  1.42s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:53<01:23,  1.35s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:54<01:16,  1.26s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:55<01:13,  1.22s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:56<01:13,  1.25s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:58<01:21,  1.41s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:00<01:24,  1.48s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:01<01:23,  1.50s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:03<01:25,  1.55s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:05<01:27,  1.61s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:06<01:19,  1.51s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:07<01:13,  1.42s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:08<01:08,  1.35s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:10<01:04,  1.30s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:11<01:02,  1.28s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:12<01:07,  1.41s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:15<01:18,  1.66s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:16<01:09,  1.52s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:17<01:02,  1.40s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:18<00:59,  1.34s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:19<00:55,  1.30s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:21<00:52,  1.25s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:22<00:49,  1.21s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:23<00:47,  1.19s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:24<00:46,  1.19s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:25<00:46,  1.22s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:27<00:46,  1.25s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:28<00:45,  1.27s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:29<00:44,  1.26s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:30<00:43,  1.27s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:32<00:42,  1.30s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:33<00:42,  1.34s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:35<00:41,  1.34s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:36<00:39,  1.31s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:38<00:44,  1.55s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:40<00:50,  1.79s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:42<00:45,  1.67s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:43<00:41,  1.60s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:44<00:36,  1.48s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:46<00:34,  1.43s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:47<00:31,  1.36s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:48<00:31,  1.42s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:50<00:29,  1.40s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:51<00:27,  1.38s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:52<00:25,  1.34s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:54<00:24,  1.39s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:55<00:22,  1.32s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:56<00:20,  1.30s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:58<00:19,  1.31s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:00<00:20,  1.50s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:02<00:21,  1.69s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:03<00:18,  1.58s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:04<00:16,  1.53s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:06<00:15,  1.51s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:07<00:13,  1.45s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:08<00:10,  1.37s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:10<00:09,  1.33s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:11<00:07,  1.32s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:12<00:06,  1.30s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:14<00:05,  1.32s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:15<00:03,  1.32s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:16<00:02,  1.30s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:17<00:01,  1.25s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:18<00:00,  1.25s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:18<00:00,  1.39s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.28788
wandb: 
wandb: üöÄ View run good-sweep-161 at: https://wandb.ai/xzy11632/dance-dev/runs/p4davh5j
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_145554-p4davh5j/logs
wandb: Agent Starting Run: ig8qibxe with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_150210-ig8qibxe
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run splendid-sweep-162
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ig8qibxe
[INFO][2024-03-16 15:02:16,877][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 15:02:16,978][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 15:02:16,978][dance][wrapped_func] Took 0:00:00.100414 to load and process data.
[INFO][2024-03-16 15:02:16,978][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 15:02:16,981][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 15:02:16,998][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:02:16,998][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:02:16,999][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:02:16,999][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-16 15:03:32,848][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=70)
[INFO][2024-03-16 15:03:32,854][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.61%
[INFO][2024-03-16 15:03:36,917][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 15:03:36,917][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 15:03:36,918][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 15:03:36,918][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:10,  1.32s/it]  2%|‚ñè         | 2/100 [00:02<02:05,  1.28s/it]  3%|‚ñé         | 3/100 [00:03<02:00,  1.24s/it]  4%|‚ñç         | 4/100 [00:04<01:55,  1.21s/it]  5%|‚ñå         | 5/100 [00:05<01:48,  1.14s/it]  6%|‚ñå         | 6/100 [00:07<01:48,  1.15s/it]  7%|‚ñã         | 7/100 [00:08<01:49,  1.17s/it]  8%|‚ñä         | 8/100 [00:09<01:47,  1.16s/it]  9%|‚ñâ         | 9/100 [00:10<01:46,  1.17s/it] 10%|‚ñà         | 10/100 [00:11<01:46,  1.19s/it] 11%|‚ñà         | 11/100 [00:13<01:44,  1.17s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<02:03,  1.41s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<02:24,  1.66s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<02:12,  1.54s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<02:02,  1.44s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<01:53,  1.35s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:46,  1.28s/it] 18%|‚ñà‚ñä        | 18/100 [00:23<01:46,  1.30s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<01:46,  1.31s/it] 20%|‚ñà‚ñà        | 20/100 [00:25<01:39,  1.24s/it] 21%|‚ñà‚ñà        | 21/100 [00:26<01:37,  1.24s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:28<01:39,  1.27s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:29<01:37,  1.26s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:30<01:38,  1.30s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:32<01:35,  1.27s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:33<01:46,  1.44s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:35<01:57,  1.62s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:37<01:47,  1.50s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:38<01:39,  1.40s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:39<01:35,  1.36s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:40<01:30,  1.32s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:41<01:25,  1.25s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:43<01:22,  1.23s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:44<01:21,  1.24s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:45<01:23,  1.29s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:47<01:24,  1.32s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:48<01:25,  1.36s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:49<01:22,  1.34s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:51<01:23,  1.36s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:53<01:30,  1.51s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:55<01:43,  1.76s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:56<01:34,  1.64s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:58<01:26,  1.52s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:59<01:25,  1.53s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:01<01:20,  1.47s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:02<01:15,  1.40s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:03<01:10,  1.33s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:04<01:08,  1.31s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:06<01:09,  1.37s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:07<01:07,  1.34s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:08<01:04,  1.32s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:10<01:04,  1.34s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:11<01:03,  1.35s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:13<01:10,  1.54s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:15<01:21,  1.81s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:17<01:10,  1.60s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:18<01:05,  1.52s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:19<00:59,  1.41s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:20<00:56,  1.37s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:22<00:54,  1.36s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:23<00:53,  1.38s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:25<00:53,  1.40s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:26<00:49,  1.34s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:27<00:48,  1.34s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:29<00:48,  1.39s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:30<00:44,  1.32s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:31<00:41,  1.25s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:32<00:38,  1.21s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:34<00:43,  1.39s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:36<00:48,  1.60s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:37<00:43,  1.51s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:39<00:41,  1.49s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:40<00:38,  1.44s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:41<00:35,  1.38s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:42<00:32,  1.30s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:43<00:30,  1.26s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:45<00:27,  1.22s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:46<00:27,  1.25s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:47<00:26,  1.25s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:48<00:24,  1.24s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:50<00:23,  1.24s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:51<00:22,  1.24s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:52<00:20,  1.20s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:54<00:22,  1.44s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:56<00:25,  1.67s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:57<00:21,  1.54s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:58<00:18,  1.41s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:00<00:16,  1.36s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:01<00:14,  1.29s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:02<00:12,  1.28s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:03<00:11,  1.24s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:05<00:10,  1.26s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:06<00:08,  1.24s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:07<00:07,  1.22s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:08<00:06,  1.23s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:09<00:04,  1.24s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:11<00:03,  1.26s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:12<00:02,  1.23s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:13<00:01,  1.22s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:15<00:00,  1.39s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:15<00:00,  1.35s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.018 MB of 0.025 MB uploadedwandb: / 0.018 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.32392
wandb: 
wandb: üöÄ View run splendid-sweep-162 at: https://wandb.ai/xzy11632/dance-dev/runs/ig8qibxe
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_150210-ig8qibxe/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 0kn2gofg with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_150804-0kn2gofg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run colorful-sweep-163
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/0kn2gofg
[INFO][2024-03-16 15:08:09,121][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 15:08:09,209][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 15:08:09,209][dance][wrapped_func] Took 0:00:00.087881 to load and process data.
[INFO][2024-03-16 15:08:09,210][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 15:08:09,211][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 15:08:09,224][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:08:09,224][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:08:09,225][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:08:09,225][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-16 15:09:07,007][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 245) (k=201)
[INFO][2024-03-16 15:09:07,008][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.20%
[INFO][2024-03-16 15:09:09,062][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 15:09:09,062][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 15:09:09,062][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 15:09:09,062][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:26,  1.48s/it]  2%|‚ñè         | 2/100 [00:03<03:20,  2.04s/it]  3%|‚ñé         | 3/100 [00:06<03:47,  2.35s/it]  4%|‚ñç         | 4/100 [00:08<03:10,  1.99s/it]  5%|‚ñå         | 5/100 [00:09<02:37,  1.66s/it]  6%|‚ñå         | 6/100 [00:10<02:17,  1.46s/it]  7%|‚ñã         | 7/100 [00:11<02:09,  1.39s/it]  8%|‚ñä         | 8/100 [00:12<02:01,  1.33s/it]  9%|‚ñâ         | 9/100 [00:13<01:55,  1.27s/it] 10%|‚ñà         | 10/100 [00:15<01:53,  1.26s/it] 11%|‚ñà         | 11/100 [00:17<02:16,  1.53s/it] 12%|‚ñà‚ñè        | 12/100 [00:18<02:16,  1.55s/it] 13%|‚ñà‚ñé        | 13/100 [00:20<02:10,  1.50s/it] 14%|‚ñà‚ñç        | 14/100 [00:21<02:07,  1.48s/it] 15%|‚ñà‚ñå        | 15/100 [00:23<02:08,  1.51s/it] 16%|‚ñà‚ñå        | 16/100 [00:24<02:05,  1.50s/it] 17%|‚ñà‚ñã        | 17/100 [00:26<02:20,  1.69s/it] 18%|‚ñà‚ñä        | 18/100 [00:29<02:43,  1.99s/it] 19%|‚ñà‚ñâ        | 19/100 [00:30<02:20,  1.73s/it] 20%|‚ñà‚ñà        | 20/100 [00:31<02:08,  1.60s/it] 21%|‚ñà‚ñà        | 21/100 [00:33<02:00,  1.53s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:34<01:59,  1.53s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:36<02:01,  1.58s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:37<01:57,  1.54s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:39<01:51,  1.49s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:40<01:51,  1.51s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:42<01:52,  1.54s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:43<01:46,  1.48s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:45<01:44,  1.47s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:47<01:59,  1.71s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:49<02:05,  1.81s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:51<01:55,  1.70s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:52<01:49,  1.63s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:53<01:43,  1.57s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:55<01:33,  1.44s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:56<01:30,  1.42s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:57<01:26,  1.37s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:59<01:26,  1.39s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:00<01:23,  1.37s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:01<01:22,  1.37s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:03<01:20,  1.36s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:04<01:20,  1.39s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:05<01:16,  1.35s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:07<01:19,  1.41s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:09<01:34,  1.72s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:11<01:27,  1.62s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:12<01:23,  1.57s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:14<01:18,  1.51s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:15<01:11,  1.40s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:16<01:09,  1.40s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:17<01:08,  1.40s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:19<01:04,  1.35s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:20<01:00,  1.28s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:21<00:57,  1.25s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:22<00:54,  1.21s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:23<00:53,  1.21s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:24<00:50,  1.17s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:25<00:47,  1.12s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:27<00:55,  1.36s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:30<01:05,  1.63s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:31<00:57,  1.47s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:32<00:51,  1.35s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:33<00:47,  1.28s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:34<00:44,  1.23s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:35<00:40,  1.17s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:37<00:48,  1.44s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:39<00:50,  1.54s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:40<00:47,  1.49s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:42<00:45,  1.46s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:43<00:42,  1.40s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:44<00:40,  1.40s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:46<00:39,  1.43s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:47<00:36,  1.36s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:49<00:42,  1.65s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:52<00:48,  1.95s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:54<00:45,  1.88s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:55<00:41,  1.83s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:57<00:40,  1.83s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:59<00:36,  1.76s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:00<00:32,  1.61s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:01<00:29,  1.53s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:03<00:27,  1.54s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:05<00:26,  1.54s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:06<00:24,  1.54s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:08<00:23,  1.57s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:12<00:32,  2.33s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:16<00:37,  2.86s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:19<00:35,  3.00s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:21<00:29,  2.71s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:23<00:23,  2.38s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:25<00:19,  2.18s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:26<00:15,  1.94s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:28<00:12,  1.85s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:29<00:10,  1.80s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:31<00:08,  1.75s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:33<00:07,  1.78s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:34<00:05,  1.73s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:36<00:03,  1.84s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:40<00:02,  2.21s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:41<00:00,  2.05s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:41<00:00,  1.62s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.23249
wandb: 
wandb: üöÄ View run colorful-sweep-163 at: https://wandb.ai/xzy11632/dance-dev/runs/0kn2gofg
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_150804-0kn2gofg/logs
wandb: Agent Starting Run: 9g8oentk with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_151601-9g8oentk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run trim-sweep-164
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/9g8oentk
[INFO][2024-03-16 15:16:07,258][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 15:16:07,364][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 15:16:07,364][dance][wrapped_func] Took 0:00:00.105018 to load and process data.
[INFO][2024-03-16 15:16:07,364][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 15:16:07,366][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 15:16:07,379][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:16:07,379][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:16:07,380][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:16:07,380][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-16 15:17:11,372][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 245) (k=201)
[INFO][2024-03-16 15:17:11,373][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.63%
[INFO][2024-03-16 15:17:13,147][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 15:17:13,147][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 15:17:13,147][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 15:17:13,147][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:06,  1.28s/it]  2%|‚ñè         | 2/100 [00:02<02:05,  1.28s/it]  3%|‚ñé         | 3/100 [00:03<02:05,  1.30s/it]  4%|‚ñç         | 4/100 [00:05<01:59,  1.24s/it]  5%|‚ñå         | 5/100 [00:06<02:01,  1.27s/it]  6%|‚ñå         | 6/100 [00:07<01:55,  1.23s/it]  7%|‚ñã         | 7/100 [00:08<01:52,  1.20s/it]  8%|‚ñä         | 8/100 [00:09<01:53,  1.24s/it]  9%|‚ñâ         | 9/100 [00:11<01:54,  1.26s/it] 10%|‚ñà         | 10/100 [00:13<02:18,  1.53s/it] 11%|‚ñà         | 11/100 [00:14<02:08,  1.44s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<02:00,  1.37s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<02:00,  1.38s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<01:58,  1.38s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<01:55,  1.35s/it] 16%|‚ñà‚ñå        | 16/100 [00:21<01:51,  1.33s/it] 17%|‚ñà‚ñã        | 17/100 [00:22<01:49,  1.31s/it] 18%|‚ñà‚ñä        | 18/100 [00:23<01:45,  1.29s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<01:42,  1.26s/it] 20%|‚ñà‚ñà        | 20/100 [00:26<01:43,  1.30s/it] 21%|‚ñà‚ñà        | 21/100 [00:27<01:42,  1.30s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:28<01:39,  1.27s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:30<01:37,  1.26s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:31<01:37,  1.28s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:32<01:38,  1.31s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:33<01:34,  1.28s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:35<01:34,  1.29s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:36<01:30,  1.26s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:37<01:29,  1.26s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:39<01:33,  1.34s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:40<01:31,  1.32s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:41<01:31,  1.35s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:43<01:26,  1.29s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:44<01:24,  1.28s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:45<01:25,  1.31s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:47<01:23,  1.31s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:48<01:20,  1.28s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:49<01:18,  1.26s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:50<01:14,  1.23s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:52<01:18,  1.31s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:53<01:16,  1.30s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:54<01:12,  1.25s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:55<01:13,  1.29s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:57<01:12,  1.29s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:58<01:12,  1.32s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:59<01:11,  1.32s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:01<01:06,  1.26s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:02<01:06,  1.28s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:03<01:04,  1.26s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:04<01:02,  1.26s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:06<01:06,  1.36s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:07<01:04,  1.34s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:09<01:02,  1.33s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:10<01:00,  1.31s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:11<00:56,  1.26s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:12<00:58,  1.34s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:14<00:57,  1.33s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:15<00:54,  1.30s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:16<00:50,  1.23s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:17<00:47,  1.18s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:18<00:44,  1.15s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:19<00:42,  1.13s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:21<00:43,  1.17s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:22<00:41,  1.15s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:23<00:40,  1.16s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:24<00:38,  1.14s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:25<00:36,  1.11s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:26<00:35,  1.11s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:27<00:34,  1.11s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:28<00:32,  1.10s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:29<00:33,  1.14s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:31<00:31,  1.14s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:32<00:30,  1.12s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:33<00:30,  1.17s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:34<00:29,  1.18s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:35<00:27,  1.17s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:36<00:26,  1.15s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:38<00:24,  1.13s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:39<00:23,  1.10s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:40<00:21,  1.09s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:41<00:20,  1.09s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:42<00:19,  1.08s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:43<00:21,  1.26s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:46<00:25,  1.62s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:48<00:27,  1.82s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:51<00:29,  2.12s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:53<00:29,  2.23s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:55<00:24,  2.04s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:57<00:21,  1.99s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:58<00:18,  1.82s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:00<00:14,  1.64s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:01<00:11,  1.47s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:02<00:09,  1.39s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:03<00:08,  1.38s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:04<00:06,  1.31s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:06<00:05,  1.31s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:07<00:03,  1.31s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:08<00:02,  1.26s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:09<00:01,  1.24s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:11<00:00,  1.24s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:11<00:00,  1.31s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.021 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.29342
wandb: 
wandb: üöÄ View run trim-sweep-164 at: https://wandb.ai/xzy11632/dance-dev/runs/9g8oentk
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_151601-9g8oentk/logs
wandb: Agent Starting Run: hknkiruy with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_152132-hknkiruy
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run genial-sweep-165
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/hknkiruy
[INFO][2024-03-16 15:21:37,857][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 15:21:37,937][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 15:21:37,937][dance][wrapped_func] Took 0:00:00.078706 to load and process data.
[INFO][2024-03-16 15:21:37,937][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 15:21:37,942][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 15:21:37,960][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:21:37,960][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:21:37,961][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:21:37,961][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-16 15:22:34,564][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=140)
[INFO][2024-03-16 15:22:34,564][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.04%
[INFO][2024-03-16 15:22:36,238][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 15:22:36,238][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 15:22:36,238][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 15:22:36,238][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:01,  1.23s/it]  2%|‚ñè         | 2/100 [00:02<01:56,  1.19s/it]  3%|‚ñé         | 3/100 [00:03<01:50,  1.14s/it]  4%|‚ñç         | 4/100 [00:04<01:54,  1.19s/it]  5%|‚ñå         | 5/100 [00:05<01:52,  1.18s/it]  6%|‚ñå         | 6/100 [00:07<01:53,  1.21s/it]  7%|‚ñã         | 7/100 [00:08<01:53,  1.22s/it]  8%|‚ñä         | 8/100 [00:09<01:54,  1.25s/it]  9%|‚ñâ         | 9/100 [00:10<01:50,  1.22s/it] 10%|‚ñà         | 10/100 [00:12<01:52,  1.25s/it] 11%|‚ñà         | 11/100 [00:13<01:53,  1.28s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:49,  1.25s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:47,  1.23s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:46,  1.23s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:48,  1.28s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:45,  1.26s/it] 17%|‚ñà‚ñã        | 17/100 [00:20<01:41,  1.22s/it] 18%|‚ñà‚ñä        | 18/100 [00:22<01:41,  1.24s/it] 19%|‚ñà‚ñâ        | 19/100 [00:23<01:43,  1.27s/it] 20%|‚ñà‚ñà        | 20/100 [00:24<01:39,  1.25s/it] 21%|‚ñà‚ñà        | 21/100 [00:25<01:36,  1.22s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:27<01:36,  1.24s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:28<01:40,  1.30s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:29<01:36,  1.27s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:31<01:35,  1.27s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:32<01:32,  1.25s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:33<01:33,  1.28s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:34<01:30,  1.26s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:36<01:29,  1.26s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:37<01:30,  1.29s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:38<01:26,  1.26s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:39<01:25,  1.26s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:41<01:21,  1.22s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:42<01:19,  1.20s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:43<01:24,  1.29s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:44<01:20,  1.26s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:46<01:19,  1.26s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:47<01:15,  1.22s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:48<01:12,  1.19s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:49<01:11,  1.19s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:50<01:11,  1.21s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:52<01:09,  1.20s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:53<01:11,  1.25s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:54<01:09,  1.25s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:55<01:09,  1.26s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:57<01:09,  1.28s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:58<01:06,  1.25s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:59<01:04,  1.25s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:00<01:01,  1.21s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:01<00:59,  1.20s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:03<00:59,  1.22s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:04<01:02,  1.30s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:06<01:01,  1.30s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:07<00:57,  1.24s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:08<00:54,  1.21s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:09<00:53,  1.21s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:10<00:52,  1.21s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:11<00:49,  1.17s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:12<00:47,  1.17s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:13<00:45,  1.13s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:15<00:43,  1.11s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:16<00:42,  1.12s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:17<00:42,  1.14s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:18<00:40,  1.11s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:19<00:39,  1.13s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:20<00:37,  1.11s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:21<00:36,  1.09s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:22<00:35,  1.11s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:23<00:34,  1.10s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:25<00:34,  1.14s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:26<00:31,  1.10s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:27<00:31,  1.12s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:28<00:30,  1.13s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:31<00:42,  1.64s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:33<00:47,  1.91s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:36<00:50,  2.09s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:38<00:50,  2.21s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:40<00:45,  2.05s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:42<00:41,  1.99s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:43<00:35,  1.79s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:45<00:31,  1.66s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:46<00:27,  1.55s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:47<00:24,  1.44s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:48<00:22,  1.38s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:49<00:19,  1.31s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:51<00:17,  1.27s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:52<00:17,  1.32s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:54<00:18,  1.53s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:55<00:15,  1.43s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:57<00:13,  1.39s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:58<00:12,  1.34s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:59<00:10,  1.31s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:00<00:08,  1.27s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:02<00:07,  1.30s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:03<00:06,  1.29s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:04<00:05,  1.25s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:05<00:03,  1.28s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:07<00:02,  1.27s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:08<00:01,  1.29s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:09<00:00,  1.26s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:09<00:00,  1.30s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.27982
wandb: 
wandb: üöÄ View run genial-sweep-165 at: https://wandb.ai/xzy11632/dance-dev/runs/hknkiruy
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_152132-hknkiruy/logs
wandb: Agent Starting Run: pgz1hxr7 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_152718-pgz1hxr7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rich-sweep-166
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/pgz1hxr7
[INFO][2024-03-16 15:27:24,373][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 15:27:24,524][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 15:27:24,524][dance][wrapped_func] Took 0:00:00.149067 to load and process data.
[INFO][2024-03-16 15:27:24,525][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 15:27:24,529][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 15:27:24,548][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:27:24,548][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:27:24,549][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:27:24,549][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-16 15:28:23,355][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=141)
[INFO][2024-03-16 15:28:23,366][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.79%
[INFO][2024-03-16 15:28:24,969][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 15:28:24,969][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 15:28:24,969][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 15:28:24,970][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:55,  1.17s/it]  2%|‚ñè         | 2/100 [00:02<01:50,  1.13s/it]  3%|‚ñé         | 3/100 [00:03<01:46,  1.10s/it]  4%|‚ñç         | 4/100 [00:04<01:47,  1.12s/it]  5%|‚ñå         | 5/100 [00:05<01:45,  1.11s/it]  6%|‚ñå         | 6/100 [00:06<01:43,  1.11s/it]  7%|‚ñã         | 7/100 [00:07<01:40,  1.08s/it]  8%|‚ñä         | 8/100 [00:08<01:39,  1.08s/it]  9%|‚ñâ         | 9/100 [00:09<01:37,  1.07s/it] 10%|‚ñà         | 10/100 [00:10<01:37,  1.09s/it] 11%|‚ñà         | 11/100 [00:12<01:40,  1.13s/it] 12%|‚ñà‚ñè        | 12/100 [00:13<01:37,  1.11s/it] 13%|‚ñà‚ñé        | 13/100 [00:14<01:35,  1.10s/it] 14%|‚ñà‚ñç        | 14/100 [00:15<01:34,  1.10s/it] 15%|‚ñà‚ñå        | 15/100 [00:16<01:37,  1.14s/it] 16%|‚ñà‚ñå        | 16/100 [00:17<01:36,  1.15s/it] 17%|‚ñà‚ñã        | 17/100 [00:19<01:41,  1.23s/it] 18%|‚ñà‚ñä        | 18/100 [00:21<02:15,  1.65s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<02:44,  2.03s/it] 20%|‚ñà‚ñà        | 20/100 [00:26<02:31,  1.89s/it] 21%|‚ñà‚ñà        | 21/100 [00:27<02:12,  1.67s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:28<02:00,  1.54s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:29<01:47,  1.40s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:31<01:42,  1.35s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:32<01:36,  1.28s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:33<01:31,  1.24s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:34<01:26,  1.19s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:35<01:25,  1.19s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:36<01:22,  1.17s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:37<01:23,  1.19s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:39<01:20,  1.16s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:40<01:26,  1.27s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:41<01:21,  1.22s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:42<01:20,  1.22s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:44<01:17,  1.19s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:45<01:16,  1.20s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:46<01:14,  1.18s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:47<01:14,  1.19s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:48<01:10,  1.15s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:49<01:09,  1.16s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:50<01:08,  1.16s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:52<01:07,  1.16s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:53<01:07,  1.19s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:54<01:07,  1.21s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:55<01:06,  1.20s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:57<01:04,  1.20s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:58<01:01,  1.17s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:59<01:01,  1.17s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:00<01:00,  1.18s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:01<00:58,  1.16s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:02<00:57,  1.17s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:04<00:56,  1.18s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:05<00:55,  1.18s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:06<00:54,  1.18s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:07<00:53,  1.19s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:08<00:52,  1.19s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:09<00:49,  1.16s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:11<00:49,  1.17s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:12<00:47,  1.15s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:13<00:47,  1.19s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:14<00:45,  1.17s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:15<00:43,  1.16s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:16<00:43,  1.17s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:18<00:42,  1.18s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:19<00:41,  1.17s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:20<00:41,  1.21s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:21<00:38,  1.18s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:22<00:37,  1.17s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:23<00:35,  1.14s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:25<00:34,  1.13s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:26<00:32,  1.13s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:27<00:31,  1.12s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:28<00:29,  1.11s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:29<00:29,  1.12s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:30<00:27,  1.11s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:31<00:26,  1.11s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:32<00:25,  1.09s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:33<00:24,  1.10s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:34<00:22,  1.10s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:36<00:22,  1.11s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:37<00:20,  1.09s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:39<00:25,  1.43s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:41<00:27,  1.62s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:42<00:24,  1.55s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:44<00:21,  1.46s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:45<00:20,  1.45s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:46<00:18,  1.39s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:48<00:16,  1.40s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:49<00:15,  1.37s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:50<00:13,  1.32s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:51<00:11,  1.28s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:53<00:10,  1.27s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:54<00:08,  1.27s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:55<00:08,  1.34s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:57<00:06,  1.29s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:58<00:05,  1.29s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:59<00:03,  1.25s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:00<00:02,  1.29s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:02<00:01,  1.27s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:03<00:00,  1.28s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:03<00:00,  1.23s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.018 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.38032
wandb: 
wandb: üöÄ View run rich-sweep-166 at: https://wandb.ai/xzy11632/dance-dev/runs/pgz1hxr7
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_152718-pgz1hxr7/logs
wandb: Agent Starting Run: aonsg36o with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_153328-aonsg36o
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fallen-sweep-167
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/aonsg36o
[INFO][2024-03-16 15:33:33,340][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 15:33:33,436][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 15:33:33,437][dance][wrapped_func] Took 0:00:00.095522 to load and process data.
[INFO][2024-03-16 15:33:33,437][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 15:33:33,439][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 15:33:33,454][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:33:33,455][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:33:33,455][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:33:33,456][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 15:34:45,804][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=95)
[INFO][2024-03-16 15:34:45,805][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.12%
[INFO][2024-03-16 15:34:48,599][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 15:34:48,600][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 15:34:48,600][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 15:34:48,600][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:24,  1.46s/it]  2%|‚ñè         | 2/100 [00:02<02:00,  1.23s/it]  3%|‚ñé         | 3/100 [00:03<01:54,  1.18s/it]  4%|‚ñç         | 4/100 [00:04<01:52,  1.17s/it]  5%|‚ñå         | 5/100 [00:05<01:50,  1.16s/it]  6%|‚ñå         | 6/100 [00:07<01:45,  1.12s/it]  7%|‚ñã         | 7/100 [00:08<01:43,  1.11s/it]  8%|‚ñä         | 8/100 [00:09<01:41,  1.11s/it]  9%|‚ñâ         | 9/100 [00:10<01:45,  1.16s/it] 10%|‚ñà         | 10/100 [00:11<01:44,  1.16s/it] 11%|‚ñà         | 11/100 [00:12<01:41,  1.14s/it] 12%|‚ñà‚ñè        | 12/100 [00:13<01:39,  1.13s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:42,  1.17s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:39,  1.15s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:36,  1.14s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<01:33,  1.11s/it] 17%|‚ñà‚ñã        | 17/100 [00:19<01:31,  1.10s/it] 18%|‚ñà‚ñä        | 18/100 [00:20<01:28,  1.08s/it] 19%|‚ñà‚ñâ        | 19/100 [00:21<01:27,  1.08s/it] 20%|‚ñà‚ñà        | 20/100 [00:22<01:28,  1.11s/it] 21%|‚ñà‚ñà        | 21/100 [00:23<01:29,  1.13s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:24<01:26,  1.11s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:26<01:26,  1.13s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:27<01:26,  1.14s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:28<01:29,  1.19s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:29<01:25,  1.16s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:30<01:24,  1.15s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:31<01:20,  1.12s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:32<01:18,  1.11s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:33<01:15,  1.08s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:35<01:16,  1.10s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:36<01:16,  1.12s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:37<01:15,  1.13s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:38<01:17,  1.18s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:39<01:17,  1.19s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:41<01:14,  1.16s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:42<01:13,  1.17s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:43<01:13,  1.18s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:44<01:12,  1.19s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:45<01:12,  1.20s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:47<01:10,  1.20s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:48<01:09,  1.20s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:49<01:08,  1.20s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:50<01:07,  1.21s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:51<01:05,  1.20s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:53<01:04,  1.19s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:54<01:03,  1.19s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:55<01:03,  1.22s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:56<01:02,  1.22s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:58<01:05,  1.30s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:59<01:04,  1.32s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:01<01:08,  1.42s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:02<01:06,  1.43s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:04<01:09,  1.50s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:06<01:11,  1.59s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:07<01:09,  1.57s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:09<01:06,  1.54s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:10<00:59,  1.42s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:11<00:53,  1.31s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:12<00:50,  1.26s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:13<00:46,  1.20s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:14<00:44,  1.17s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:15<00:42,  1.14s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:16<00:40,  1.12s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:17<00:39,  1.14s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:19<00:39,  1.17s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:20<00:38,  1.16s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:21<00:36,  1.14s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:22<00:35,  1.13s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:24<00:44,  1.49s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:28<00:59,  2.04s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:29<00:54,  1.96s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:31<00:52,  1.93s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:33<00:50,  1.94s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:35<00:47,  1.90s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:37<00:45,  1.89s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:39<00:42,  1.84s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:41<00:40,  1.86s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:42<00:38,  1.85s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:44<00:35,  1.77s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:46<00:34,  1.83s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:48<00:33,  1.84s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:50<00:30,  1.80s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:51<00:29,  1.81s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:53<00:25,  1.68s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:55<00:23,  1.69s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:56<00:21,  1.64s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:58<00:20,  1.70s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:00<00:19,  1.74s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:01<00:16,  1.63s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:03<00:14,  1.63s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:04<00:12,  1.56s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:06<00:10,  1.51s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:07<00:08,  1.45s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:08<00:07,  1.46s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:10<00:05,  1.40s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:11<00:04,  1.38s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:12<00:02,  1.35s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:14<00:01,  1.47s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:15<00:00,  1.49s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:15<00:00,  1.36s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.28156
wandb: 
wandb: üöÄ View run fallen-sweep-167 at: https://wandb.ai/xzy11632/dance-dev/runs/aonsg36o
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_153328-aonsg36o/logs
wandb: Agent Starting Run: r2zha6o3 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_154021-r2zha6o3
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run genial-sweep-168
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/r2zha6o3
[INFO][2024-03-16 15:40:26,782][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 15:40:26,930][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 15:40:26,930][dance][wrapped_func] Took 0:00:00.147407 to load and process data.
[INFO][2024-03-16 15:40:26,930][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 15:40:26,933][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 15:40:26,950][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:40:26,950][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:40:26,951][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:40:26,951][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 15:41:30,679][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=92)
[INFO][2024-03-16 15:41:30,679][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.49%
[INFO][2024-03-16 15:41:32,393][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 15:41:32,393][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 15:41:32,393][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 15:41:32,393][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:48,  1.09s/it]  2%|‚ñè         | 2/100 [00:02<01:50,  1.13s/it]  3%|‚ñé         | 3/100 [00:03<01:51,  1.15s/it]  4%|‚ñç         | 4/100 [00:04<01:50,  1.15s/it]  5%|‚ñå         | 5/100 [00:05<01:48,  1.14s/it]  6%|‚ñå         | 6/100 [00:07<01:52,  1.20s/it]  7%|‚ñã         | 7/100 [00:08<01:52,  1.21s/it]  8%|‚ñä         | 8/100 [00:09<01:50,  1.20s/it]  9%|‚ñâ         | 9/100 [00:10<01:52,  1.24s/it] 10%|‚ñà         | 10/100 [00:12<01:53,  1.26s/it] 11%|‚ñà         | 11/100 [00:13<01:52,  1.27s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:51,  1.27s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:51,  1.28s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:53,  1.32s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:50,  1.30s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:51,  1.32s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:50,  1.33s/it] 18%|‚ñà‚ñä        | 18/100 [00:22<01:48,  1.33s/it] 19%|‚ñà‚ñâ        | 19/100 [00:23<01:48,  1.34s/it] 20%|‚ñà‚ñà        | 20/100 [00:25<01:52,  1.41s/it] 21%|‚ñà‚ñà        | 21/100 [00:27<01:56,  1.48s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:28<01:56,  1.49s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:30<02:03,  1.61s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:32<02:09,  1.71s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:34<02:09,  1.73s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:36<02:08,  1.74s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:37<02:08,  1.76s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:39<02:12,  1.84s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:41<02:11,  1.85s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:43<02:10,  1.87s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:45<02:06,  1.83s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:46<01:56,  1.72s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:48<01:48,  1.62s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:49<01:41,  1.54s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:50<01:35,  1.47s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:52<01:29,  1.40s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:53<01:27,  1.40s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:54<01:25,  1.37s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:56<01:27,  1.44s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:58<01:28,  1.48s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:59<01:26,  1.47s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:01<01:30,  1.56s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:03<01:32,  1.62s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:04<01:33,  1.67s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:06<01:26,  1.58s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:07<01:26,  1.60s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:09<01:20,  1.51s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:10<01:14,  1.44s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:11<01:11,  1.40s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:13<01:09,  1.38s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:14<01:07,  1.38s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:16<01:09,  1.45s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:17<01:10,  1.50s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:19<01:12,  1.58s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:21<01:13,  1.64s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:22<01:13,  1.66s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:24<01:09,  1.63s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:25<01:03,  1.52s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:27<01:04,  1.57s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:28<00:59,  1.50s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:30<00:57,  1.46s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:31<00:53,  1.42s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:32<00:52,  1.43s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:34<00:49,  1.39s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:35<00:48,  1.37s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:36<00:47,  1.39s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:38<00:44,  1.35s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:39<00:44,  1.39s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:41<00:42,  1.38s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:42<00:40,  1.36s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:43<00:39,  1.37s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:45<00:38,  1.36s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:46<00:35,  1.32s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:47<00:34,  1.32s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:48<00:32,  1.31s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:50<00:31,  1.31s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:51<00:30,  1.33s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:52<00:29,  1.33s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:54<00:27,  1.33s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:55<00:25,  1.27s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:56<00:23,  1.24s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:57<00:22,  1.26s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:59<00:22,  1.32s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:00<00:22,  1.38s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:02<00:20,  1.39s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:03<00:19,  1.41s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:04<00:17,  1.37s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:06<00:16,  1.37s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:07<00:15,  1.41s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:09<00:13,  1.38s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:10<00:12,  1.38s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:11<00:10,  1.37s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:13<00:09,  1.37s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:14<00:08,  1.45s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:16<00:07,  1.56s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:18<00:06,  1.55s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:19<00:04,  1.55s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:21<00:03,  1.58s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:23<00:01,  1.63s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:25<00:00,  1.69s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:25<00:00,  1.45s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.30732
wandb: 
wandb: üöÄ View run genial-sweep-168 at: https://wandb.ai/xzy11632/dance-dev/runs/r2zha6o3
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_154021-r2zha6o3/logs
wandb: Agent Starting Run: zinbv96g with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_154608-zinbv96g
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run polar-sweep-169
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/zinbv96g
[INFO][2024-03-16 15:46:13,713][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 15:46:13,815][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 15:46:13,815][dance][wrapped_func] Took 0:00:00.101407 to load and process data.
[INFO][2024-03-16 15:46:13,815][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 15:46:13,819][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 15:46:13,835][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:46:13,835][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:46:13,835][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:46:13,836][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:46:13,836][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:46:13,884][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 15:46:15,195][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 1000) (k=346)
[INFO][2024-03-16 15:46:15,195][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.03%
[INFO][2024-03-16 15:46:17,687][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 15:46:17,687][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 15:46:17,687][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 15:46:17,687][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:20,  1.41s/it]  2%|‚ñè         | 2/100 [00:02<02:16,  1.39s/it]  3%|‚ñé         | 3/100 [00:04<02:16,  1.41s/it]  4%|‚ñç         | 4/100 [00:05<02:18,  1.44s/it]  5%|‚ñå         | 5/100 [00:07<02:16,  1.44s/it]  6%|‚ñå         | 6/100 [00:08<02:11,  1.40s/it]  7%|‚ñã         | 7/100 [00:09<02:08,  1.38s/it]  8%|‚ñä         | 8/100 [00:11<02:07,  1.39s/it]  9%|‚ñâ         | 9/100 [00:12<02:04,  1.37s/it] 10%|‚ñà         | 10/100 [00:13<02:05,  1.39s/it] 11%|‚ñà         | 11/100 [00:15<02:07,  1.43s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<02:06,  1.44s/it] 13%|‚ñà‚ñé        | 13/100 [00:18<02:02,  1.41s/it] 14%|‚ñà‚ñç        | 14/100 [00:19<02:00,  1.41s/it] 15%|‚ñà‚ñå        | 15/100 [00:21<02:00,  1.42s/it] 16%|‚ñà‚ñå        | 16/100 [00:22<02:02,  1.46s/it] 17%|‚ñà‚ñã        | 17/100 [00:24<02:01,  1.47s/it] 18%|‚ñà‚ñä        | 18/100 [00:25<01:57,  1.44s/it] 19%|‚ñà‚ñâ        | 19/100 [00:27<01:56,  1.44s/it] 20%|‚ñà‚ñà        | 20/100 [00:28<01:54,  1.43s/it] 21%|‚ñà‚ñà        | 21/100 [00:29<01:55,  1.46s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:31<01:53,  1.46s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:32<01:50,  1.43s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:34<01:49,  1.45s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:35<01:48,  1.45s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:37<01:45,  1.43s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:38<01:44,  1.43s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:39<01:42,  1.42s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:41<01:39,  1.40s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:42<01:38,  1.40s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:43<01:35,  1.38s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:45<01:33,  1.38s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:46<01:31,  1.36s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:48<01:32,  1.40s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:49<01:30,  1.40s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:50<01:29,  1.40s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:52<01:30,  1.43s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:53<01:29,  1.45s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:55<01:27,  1.43s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:56<01:24,  1.41s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:58<01:23,  1.41s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:59<01:19,  1.37s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:00<01:19,  1.39s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:02<01:19,  1.42s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:03<01:18,  1.43s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:05<01:16,  1.42s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:06<01:20,  1.52s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:08<01:17,  1.48s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:09<01:14,  1.46s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:11<01:10,  1.41s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:12<01:08,  1.40s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:13<01:06,  1.38s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:15<01:04,  1.37s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:16<01:02,  1.36s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:17<01:00,  1.35s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:19<00:59,  1.35s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:20<00:59,  1.38s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:21<00:57,  1.38s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:23<00:56,  1.38s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:24<00:56,  1.40s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:26<00:55,  1.43s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:27<00:53,  1.40s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:29<00:51,  1.40s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:30<00:49,  1.38s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:31<00:48,  1.38s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:33<00:48,  1.41s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:34<00:47,  1.44s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:36<00:45,  1.42s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:37<00:42,  1.38s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:38<00:41,  1.38s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:40<00:40,  1.38s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:41<00:38,  1.37s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:42<00:37,  1.38s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:44<00:36,  1.40s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:45<00:34,  1.38s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:47<00:33,  1.39s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:48<00:31,  1.36s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:49<00:30,  1.39s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:51<00:29,  1.41s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:52<00:27,  1.39s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:54<00:26,  1.39s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:55<00:24,  1.37s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:57<00:26,  1.58s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:15<01:44,  6.55s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:17<01:17,  5.19s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:33<01:59,  8.52s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:35<01:24,  6.52s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:38<01:03,  5.26s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:39<00:45,  4.15s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:41<00:34,  3.42s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:42<00:25,  2.84s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:44<00:19,  2.43s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:45<00:15,  2.20s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:47<00:12,  2.03s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:49<00:09,  1.87s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:50<00:07,  1.83s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:52<00:05,  1.78s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:54<00:03,  1.71s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:55<00:01,  1.67s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:57<00:00,  1.66s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:57<00:00,  1.77s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.021 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.11328
wandb: 
wandb: üöÄ View run polar-sweep-169 at: https://wandb.ai/xzy11632/dance-dev/runs/zinbv96g
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_154608-zinbv96g/logs
wandb: Agent Starting Run: de2ml2hk with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_155107-de2ml2hk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run major-sweep-170
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/de2ml2hk
[INFO][2024-03-16 15:51:12,796][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 15:51:12,933][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 15:51:12,933][dance][wrapped_func] Took 0:00:00.135738 to load and process data.
[INFO][2024-03-16 15:51:12,933][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 15:51:12,936][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 15:51:12,952][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:51:12,952][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:51:12,952][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:51:12,953][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:51:12,953][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:51:13,013][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 15:51:57,674][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 1000) (k=332)
[INFO][2024-03-16 15:51:57,686][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.34%
[INFO][2024-03-16 15:52:18,465][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 15:52:18,465][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 15:52:18,465][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 15:52:18,466][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<03:13,  1.95s/it]  2%|‚ñè         | 2/100 [00:03<02:53,  1.78s/it]  3%|‚ñé         | 3/100 [00:05<02:52,  1.78s/it]  4%|‚ñç         | 4/100 [00:06<02:41,  1.68s/it]  5%|‚ñå         | 5/100 [00:08<02:34,  1.62s/it]  6%|‚ñå         | 6/100 [00:10<02:31,  1.61s/it]  7%|‚ñã         | 7/100 [00:11<02:37,  1.69s/it]  8%|‚ñä         | 8/100 [00:13<02:40,  1.74s/it]  9%|‚ñâ         | 9/100 [00:15<02:40,  1.76s/it] 10%|‚ñà         | 10/100 [00:17<02:33,  1.71s/it] 11%|‚ñà         | 11/100 [00:18<02:28,  1.67s/it] 12%|‚ñà‚ñè        | 12/100 [00:20<02:30,  1.71s/it] 13%|‚ñà‚ñé        | 13/100 [00:22<02:25,  1.67s/it] 14%|‚ñà‚ñç        | 14/100 [00:23<02:23,  1.67s/it] 15%|‚ñà‚ñå        | 15/100 [00:25<02:17,  1.61s/it] 16%|‚ñà‚ñå        | 16/100 [00:26<02:15,  1.61s/it] 17%|‚ñà‚ñã        | 17/100 [00:28<02:21,  1.71s/it] 18%|‚ñà‚ñä        | 18/100 [00:30<02:15,  1.66s/it] 19%|‚ñà‚ñâ        | 19/100 [00:31<02:12,  1.63s/it] 20%|‚ñà‚ñà        | 20/100 [00:33<02:09,  1.62s/it] 21%|‚ñà‚ñà        | 21/100 [00:35<02:10,  1.65s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:36<02:08,  1.65s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:38<02:04,  1.62s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:40<02:03,  1.62s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:41<01:59,  1.59s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:43<01:57,  1.59s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:44<01:52,  1.54s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:46<01:51,  1.55s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:47<01:50,  1.55s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:49<01:52,  1.60s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:51<01:51,  1.61s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:52<01:49,  1.60s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:54<01:46,  1.59s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:55<01:43,  1.57s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:57<01:45,  1.62s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:58<01:36,  1.51s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:00<01:34,  1.51s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:01<01:32,  1.49s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:03<01:32,  1.51s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:04<01:32,  1.54s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:06<01:31,  1.55s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:07<01:30,  1.56s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:09<01:27,  1.54s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:10<01:24,  1.50s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:12<01:23,  1.53s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:14<01:23,  1.54s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:15<01:20,  1.52s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:17<01:18,  1.52s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:18<01:21,  1.59s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:20<01:18,  1.58s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:21<01:17,  1.59s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:23<01:16,  1.59s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:25<01:17,  1.65s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:26<01:15,  1.65s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:28<01:11,  1.59s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:29<01:08,  1.55s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:31<01:05,  1.53s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:32<01:02,  1.48s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:34<01:01,  1.51s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:35<01:00,  1.50s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:37<00:58,  1.49s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:38<00:56,  1.48s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:40<00:52,  1.43s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:41<00:51,  1.43s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:42<00:50,  1.44s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:44<00:51,  1.51s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:45<00:45,  1.39s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:46<00:43,  1.35s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:48<00:39,  1.28s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:49<00:38,  1.27s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:50<00:36,  1.25s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:51<00:34,  1.22s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:52<00:32,  1.20s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:53<00:30,  1.17s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:55<00:29,  1.19s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:56<00:29,  1.24s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:57<00:28,  1.23s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:58<00:27,  1.23s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:00<00:25,  1.24s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:01<00:24,  1.24s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:02<00:23,  1.25s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:03<00:22,  1.24s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:05<00:20,  1.22s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:06<00:19,  1.20s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:07<00:18,  1.26s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:08<00:17,  1.28s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:10<00:16,  1.30s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:11<00:15,  1.29s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:12<00:13,  1.27s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:14<00:12,  1.27s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:15<00:11,  1.28s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:16<00:10,  1.34s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:18<00:09,  1.33s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:19<00:07,  1.31s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:20<00:06,  1.38s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:22<00:05,  1.39s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:23<00:04,  1.38s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:25<00:02,  1.37s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:26<00:01,  1.34s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:27<00:00,  1.33s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:27<00:00,  1.48s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.14045
wandb: 
wandb: üöÄ View run major-sweep-170 at: https://wandb.ai/xzy11632/dance-dev/runs/de2ml2hk
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_155107-de2ml2hk/logs
wandb: Agent Starting Run: 9ovbzfvq with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_155750-9ovbzfvq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run proud-sweep-171
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/9ovbzfvq
[INFO][2024-03-16 15:57:55,900][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 15:57:56,044][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 15:57:56,044][dance][wrapped_func] Took 0:00:00.142821 to load and process data.
[INFO][2024-03-16 15:57:56,044][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 15:57:56,047][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 15:57:56,065][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:57:56,066][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:57:56,067][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:57:56,067][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 15:57:56,248][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.000 MB of 0.012 MB uploadedwandb: \ 0.000 MB of 0.012 MB uploadedwandb: | 0.000 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run proud-sweep-171 at: https://wandb.ai/xzy11632/dance-dev/runs/9ovbzfvq
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_155750-9ovbzfvq/logs
wandb: ERROR Run 9ovbzfvq errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1000) out of bounds (1000)
wandb: ERROR 
wandb: Agent Starting Run: if95rwpf with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_155811-if95rwpf
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run copper-sweep-172
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/if95rwpf
[INFO][2024-03-16 15:58:17,665][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 15:58:17,787][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 15:58:17,788][dance][wrapped_func] Took 0:00:00.121759 to load and process data.
[INFO][2024-03-16 15:58:17,788][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 15:58:17,790][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 15:58:17,806][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:58:17,806][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:58:17,807][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:58:17,807][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 15:58:18,005][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run copper-sweep-172 at: https://wandb.ai/xzy11632/dance-dev/runs/if95rwpf
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_155811-if95rwpf/logs
wandb: ERROR Run if95rwpf errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1000) out of bounds (1000)
wandb: ERROR 
wandb: Agent Starting Run: 99iufgrv with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_155833-99iufgrv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run quiet-sweep-173
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/99iufgrv
[INFO][2024-03-16 15:58:38,918][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 15:58:39,016][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 15:58:39,017][dance][wrapped_func] Took 0:00:00.097737 to load and process data.
[INFO][2024-03-16 15:58:39,017][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 15:58:39,020][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 15:58:39,038][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:58:39,039][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:58:39,039][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 15:58:39,039][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 15:58:39,342][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=50)
[INFO][2024-03-16 15:58:39,343][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.04%
[INFO][2024-03-16 15:58:41,341][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 15:58:41,341][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 15:58:41,341][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 15:58:41,341][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:07,  1.29s/it]  2%|‚ñè         | 2/100 [00:02<02:02,  1.25s/it]  3%|‚ñé         | 3/100 [00:03<01:57,  1.21s/it]  4%|‚ñç         | 4/100 [00:04<01:54,  1.20s/it]  5%|‚ñå         | 5/100 [00:06<01:56,  1.23s/it]  6%|‚ñå         | 6/100 [00:07<01:54,  1.22s/it]  7%|‚ñã         | 7/100 [00:08<01:56,  1.25s/it]  8%|‚ñä         | 8/100 [00:09<01:55,  1.26s/it]  9%|‚ñâ         | 9/100 [00:11<01:57,  1.29s/it] 10%|‚ñà         | 10/100 [00:12<01:59,  1.33s/it] 11%|‚ñà         | 11/100 [00:14<02:00,  1.35s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<02:03,  1.41s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<02:04,  1.43s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<02:00,  1.40s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<01:56,  1.37s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<01:51,  1.33s/it] 17%|‚ñà‚ñã        | 17/100 [00:22<01:47,  1.30s/it] 18%|‚ñà‚ñä        | 18/100 [00:23<01:45,  1.28s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<01:43,  1.27s/it] 20%|‚ñà‚ñà        | 20/100 [00:25<01:40,  1.26s/it] 21%|‚ñà‚ñà        | 21/100 [00:27<01:38,  1.25s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:28<01:38,  1.27s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:29<01:40,  1.31s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:31<01:38,  1.30s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:32<01:37,  1.30s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:33<01:34,  1.28s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:34<01:33,  1.28s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:36<01:30,  1.26s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:37<01:30,  1.27s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:38<01:29,  1.28s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:39<01:27,  1.26s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:41<01:24,  1.25s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:42<01:23,  1.25s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:43<01:21,  1.24s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:44<01:21,  1.25s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:46<01:17,  1.21s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:47<01:17,  1.23s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:48<01:13,  1.19s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:49<01:12,  1.18s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:50<01:12,  1.20s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:52<01:12,  1.23s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:53<01:11,  1.24s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:54<01:11,  1.25s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:55<01:10,  1.26s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:57<01:08,  1.25s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:58<01:10,  1.31s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:00<01:13,  1.39s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:01<01:12,  1.39s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:03<01:12,  1.43s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:04<01:11,  1.42s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:06<01:13,  1.50s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:07<01:13,  1.53s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:09<01:14,  1.58s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:11<01:14,  1.61s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:12<01:13,  1.63s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:14<01:13,  1.68s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:16<01:12,  1.69s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:18<01:11,  1.69s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:19<01:05,  1.61s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:20<01:02,  1.56s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:22<00:57,  1.48s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:28<01:45,  2.78s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:35<02:31,  4.10s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:37<02:12,  3.67s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:40<01:53,  3.26s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:48<02:41,  4.76s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:53<02:44,  4.99s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:55<02:02,  3.82s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:56<01:39,  3.22s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:58<01:17,  2.60s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:59<01:01,  2.13s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:00<00:50,  1.81s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:01<00:42,  1.58s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:02<00:37,  1.43s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:03<00:33,  1.35s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:04<00:30,  1.28s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:05<00:28,  1.22s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:06<00:27,  1.23s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:08<00:25,  1.21s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:09<00:25,  1.29s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:10<00:23,  1.26s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:12<00:23,  1.31s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:13<00:21,  1.29s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:14<00:21,  1.33s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:16<00:19,  1.30s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:17<00:19,  1.40s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:19<00:18,  1.40s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:20<00:16,  1.41s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:21<00:15,  1.44s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:23<00:14,  1.41s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:24<00:13,  1.48s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:26<00:11,  1.48s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:27<00:09,  1.40s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:28<00:08,  1.37s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:30<00:06,  1.34s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:31<00:05,  1.34s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:32<00:03,  1.32s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:34<00:02,  1.42s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:36<00:01,  1.45s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:37<00:00,  1.45s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:37<00:00,  1.57s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.169
wandb: 
wandb: üöÄ View run quiet-sweep-173 at: https://wandb.ai/xzy11632/dance-dev/runs/99iufgrv
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_155833-99iufgrv/logs
wandb: Agent Starting Run: rik2gnjv with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_160238-rik2gnjv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dauntless-sweep-174
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/rik2gnjv
[INFO][2024-03-16 16:02:43,748][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 16:02:43,846][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 16:02:43,847][dance][wrapped_func] Took 0:00:00.098389 to load and process data.
[INFO][2024-03-16 16:02:43,847][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 16:02:43,849][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 16:02:43,865][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:02:43,866][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:02:43,866][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:02:43,867][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 16:02:45,278][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=46)
[INFO][2024-03-16 16:02:45,284][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.30%
[INFO][2024-03-16 16:02:46,921][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 16:02:46,921][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 16:02:46,921][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 16:02:46,921][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:59,  1.21s/it]  2%|‚ñè         | 2/100 [00:02<02:02,  1.25s/it]  3%|‚ñé         | 3/100 [00:03<02:05,  1.29s/it]  4%|‚ñç         | 4/100 [00:05<02:02,  1.28s/it]  5%|‚ñå         | 5/100 [00:06<02:00,  1.27s/it]  6%|‚ñå         | 6/100 [00:07<01:57,  1.25s/it]  7%|‚ñã         | 7/100 [00:08<01:55,  1.24s/it]  8%|‚ñä         | 8/100 [00:10<01:54,  1.25s/it]  9%|‚ñâ         | 9/100 [00:11<01:53,  1.25s/it] 10%|‚ñà         | 10/100 [00:12<01:52,  1.25s/it] 11%|‚ñà         | 11/100 [00:13<01:54,  1.29s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:52,  1.28s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:55,  1.32s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:54,  1.33s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<01:52,  1.32s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<01:51,  1.33s/it] 17%|‚ñà‚ñã        | 17/100 [00:22<01:55,  1.39s/it] 18%|‚ñà‚ñä        | 18/100 [00:23<01:54,  1.40s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<01:53,  1.41s/it] 20%|‚ñà‚ñà        | 20/100 [00:26<01:56,  1.46s/it] 21%|‚ñà‚ñà        | 21/100 [00:27<01:51,  1.42s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:29<01:46,  1.36s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:30<01:41,  1.32s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:31<01:38,  1.29s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:33<01:43,  1.38s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:35<02:03,  1.67s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:39<03:01,  2.49s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:43<03:30,  2.93s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:47<03:36,  3.04s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:49<03:16,  2.81s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:52<03:12,  2.78s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:54<03:00,  2.66s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:57<03:01,  2.71s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:59<02:40,  2.43s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:01<02:42,  2.50s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:04<02:41,  2.52s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:08<03:13,  3.07s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:11<03:05,  2.99s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:14<03:08,  3.09s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:16<02:31,  2.52s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:17<02:09,  2.19s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:18<01:51,  1.93s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:20<01:39,  1.75s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:21<01:28,  1.58s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:22<01:20,  1.47s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:23<01:16,  1.41s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:25<01:12,  1.37s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:26<01:11,  1.37s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:27<01:06,  1.31s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:28<01:04,  1.29s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:29<01:01,  1.26s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:31<01:00,  1.27s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:32<00:58,  1.25s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:33<00:58,  1.26s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:35<00:56,  1.26s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:36<00:54,  1.23s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:37<00:51,  1.19s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:38<00:51,  1.23s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:39<00:50,  1.24s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:40<00:47,  1.19s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:42<00:46,  1.18s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:43<00:43,  1.16s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:44<00:42,  1.14s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:45<00:41,  1.16s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:46<00:42,  1.21s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:48<00:41,  1.21s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:49<00:40,  1.23s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:50<00:40,  1.25s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:51<00:38,  1.24s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:53<00:36,  1.23s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:54<00:35,  1.23s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:55<00:34,  1.23s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:56<00:33,  1.24s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:57<00:32,  1.23s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:59<00:32,  1.29s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:00<00:31,  1.31s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:02<00:29,  1.30s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:03<00:28,  1.27s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:04<00:26,  1.27s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:05<00:25,  1.28s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:07<00:23,  1.25s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:08<00:22,  1.28s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:09<00:21,  1.26s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:10<00:20,  1.28s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:12<00:19,  1.29s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:13<00:18,  1.30s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:14<00:16,  1.30s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:16<00:16,  1.35s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:17<00:14,  1.33s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:18<00:13,  1.33s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:20<00:12,  1.41s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:21<00:10,  1.37s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:23<00:09,  1.35s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:24<00:08,  1.35s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:25<00:06,  1.34s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:27<00:05,  1.37s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:28<00:04,  1.36s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:29<00:02,  1.32s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:30<00:01,  1.29s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:32<00:00,  1.34s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:32<00:00,  1.52s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.12223
wandb: 
wandb: üöÄ View run dauntless-sweep-174 at: https://wandb.ai/xzy11632/dance-dev/runs/rik2gnjv
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_160238-rik2gnjv/logs
wandb: Agent Starting Run: 0x5bz7us with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_160650-0x5bz7us
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ancient-sweep-175
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/0x5bz7us
[INFO][2024-03-16 16:06:55,941][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 16:06:56,095][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 16:06:56,095][dance][wrapped_func] Took 0:00:00.145628 to load and process data.
[INFO][2024-03-16 16:06:56,095][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 16:06:56,098][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 16:06:56,114][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:06:56,115][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:06:56,115][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:06:56,116][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.017 MB of 0.024 MB uploadedwandb: \ 0.017 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run ancient-sweep-175 at: https://wandb.ai/xzy11632/dance-dev/runs/0x5bz7us
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_160650-0x5bz7us/logs
wandb: ERROR Run 0x5bz7us errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/cell_feature.py", line 50, in __call__
wandb: ERROR     gene_feat = gene_pca.fit_transform(feat.T)  # decompose into gene features
wandb: ERROR                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
wandb: ERROR     data_to_wrap = f(self, X, *args, **kwargs)
wandb: ERROR                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 1152, in wrapper
wandb: ERROR     return fit_method(estimator, *args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 460, in fit_transform
wandb: ERROR     U, S, Vt = self._fit(X)
wandb: ERROR                ^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 483, in _fit
wandb: ERROR     X = self._validate_data(
wandb: ERROR         ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 605, in _validate_data
wandb: ERROR     out = check_array(X, input_name="X", **check_params)
wandb: ERROR           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/validation.py", line 967, in check_array
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: Found array with 0 sample(s) (shape=(0, 8218)) while a minimum of 1 is required by PCA.
wandb: ERROR 
wandb: Agent Starting Run: c7dfr26p with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_160713-c7dfr26p
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run deft-sweep-176
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/c7dfr26p
[INFO][2024-03-16 16:07:20,864][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 16:07:21,162][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 16:07:21,172][dance][wrapped_func] Took 0:00:00.307719 to load and process data.
[INFO][2024-03-16 16:07:21,173][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 16:07:21,175][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 16:07:21,219][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:07:21,219][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:07:21,220][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:07:21,221][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.017 MB of 0.024 MB uploadedwandb: \ 0.017 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run deft-sweep-176 at: https://wandb.ai/xzy11632/dance-dev/runs/c7dfr26p
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_160713-c7dfr26p/logs
wandb: ERROR Run c7dfr26p errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/cell_feature.py", line 98, in __call__
wandb: ERROR     svd.fit_transform(feat)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
wandb: ERROR     data_to_wrap = f(self, X, *args, **kwargs)
wandb: ERROR                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 1145, in wrapper
wandb: ERROR     estimator._validate_params()
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 638, in _validate_params
wandb: ERROR     validate_parameter_constraints(
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_param_validation.py", line 96, in validate_parameter_constraints
wandb: ERROR     raise InvalidParameterError(
wandb: ERROR sklearn.utils._param_validation.InvalidParameterError: The 'n_components' parameter of TruncatedSVD must be an int in the range [1, inf). Got -1 instead.
wandb: ERROR 
wandb: Agent Starting Run: uqinfrcv with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_160740-uqinfrcv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run misty-sweep-177
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/uqinfrcv
[INFO][2024-03-16 16:07:45,246][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 16:07:45,338][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 16:07:45,339][dance][wrapped_func] Took 0:00:00.091665 to load and process data.
[INFO][2024-03-16 16:07:45,339][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 16:07:45,340][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 16:07:45,353][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:07:45,353][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:07:45,353][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:07:45,353][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 16:07:45,761][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=57)
[INFO][2024-03-16 16:07:45,761][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.01%
[INFO][2024-03-16 16:07:47,788][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 16:07:47,789][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 16:07:47,789][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 16:07:47,789][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:11,  1.33s/it]  2%|‚ñè         | 2/100 [00:02<02:05,  1.28s/it]  3%|‚ñé         | 3/100 [00:03<02:03,  1.28s/it]  4%|‚ñç         | 4/100 [00:04<01:56,  1.21s/it]  5%|‚ñå         | 5/100 [00:06<01:52,  1.19s/it]  6%|‚ñå         | 6/100 [00:07<01:52,  1.20s/it]  7%|‚ñã         | 7/100 [00:08<01:57,  1.26s/it]  8%|‚ñä         | 8/100 [00:10<02:02,  1.34s/it]  9%|‚ñâ         | 9/100 [00:11<02:01,  1.33s/it] 10%|‚ñà         | 10/100 [00:12<01:54,  1.27s/it] 11%|‚ñà         | 11/100 [00:13<01:51,  1.26s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:51,  1.26s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:49,  1.26s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:46,  1.24s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:43,  1.22s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<01:43,  1.23s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:44,  1.26s/it] 18%|‚ñà‚ñä        | 18/100 [00:22<01:45,  1.29s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<01:46,  1.31s/it] 20%|‚ñà‚ñà        | 20/100 [00:25<01:45,  1.32s/it] 21%|‚ñà‚ñà        | 21/100 [00:26<01:43,  1.32s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:28<01:41,  1.30s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:29<01:44,  1.36s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:30<01:43,  1.36s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:32<01:38,  1.31s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:33<01:36,  1.30s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:34<01:32,  1.27s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:35<01:32,  1.29s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:37<01:30,  1.28s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:38<01:30,  1.29s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:39<01:27,  1.26s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:40<01:25,  1.25s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:42<01:25,  1.27s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:43<01:23,  1.26s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:44<01:21,  1.26s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:45<01:19,  1.25s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:47<01:19,  1.26s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:48<01:23,  1.34s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:50<01:24,  1.39s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:51<01:22,  1.37s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:52<01:19,  1.34s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:54<01:16,  1.32s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:55<01:13,  1.30s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:56<01:13,  1.30s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:58<01:12,  1.32s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:59<01:13,  1.36s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:00<01:13,  1.38s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:02<01:11,  1.37s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:03<01:08,  1.33s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:04<01:09,  1.38s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:06<01:06,  1.36s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:07<01:05,  1.37s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:08<01:02,  1.32s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:10<01:00,  1.32s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:11<00:58,  1.30s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:12<00:56,  1.29s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:14<00:56,  1.31s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:15<00:53,  1.27s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:16<00:52,  1.27s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:17<00:50,  1.25s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:19<00:48,  1.25s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:20<00:47,  1.24s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:21<00:45,  1.24s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:22<00:44,  1.22s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:23<00:42,  1.23s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:25<00:41,  1.23s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:26<00:40,  1.22s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:27<00:39,  1.24s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:28<00:38,  1.24s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:30<00:36,  1.22s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:31<00:34,  1.21s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:32<00:33,  1.20s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:33<00:32,  1.21s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:34<00:31,  1.23s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:36<00:31,  1.25s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:37<00:29,  1.23s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:38<00:29,  1.30s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:40<00:30,  1.36s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:41<00:28,  1.34s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:43<00:27,  1.39s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:44<00:26,  1.39s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:45<00:23,  1.33s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:46<00:22,  1.30s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:48<00:20,  1.27s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:49<00:19,  1.27s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:50<00:17,  1.27s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:51<00:16,  1.27s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:53<00:15,  1.28s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:54<00:13,  1.26s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:55<00:12,  1.28s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:57<00:11,  1.33s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:58<00:10,  1.36s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:00<00:09,  1.38s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:01<00:08,  1.40s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:02<00:06,  1.34s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:04<00:05,  1.35s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:05<00:04,  1.37s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:07<00:02,  1.44s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:08<00:01,  1.49s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:10<00:00,  1.57s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:10<00:00,  1.30s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.16919
wandb: 
wandb: üöÄ View run misty-sweep-177 at: https://wandb.ai/xzy11632/dance-dev/runs/uqinfrcv
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_160740-uqinfrcv/logs
wandb: Agent Starting Run: cm57unk7 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_161201-cm57unk7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run neat-sweep-178
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/cm57unk7
[INFO][2024-03-16 16:12:07,695][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 16:12:07,803][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 16:12:07,804][dance][wrapped_func] Took 0:00:00.106800 to load and process data.
[INFO][2024-03-16 16:12:07,804][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 16:12:07,807][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 16:12:07,825][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:12:07,826][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:12:07,826][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:12:07,827][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 16:12:09,491][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=53)
[INFO][2024-03-16 16:12:09,493][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.30%
[INFO][2024-03-16 16:12:11,663][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 16:12:11,664][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 16:12:11,664][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 16:12:11,664][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:12,  1.34s/it]  2%|‚ñè         | 2/100 [00:02<02:06,  1.29s/it]  3%|‚ñé         | 3/100 [00:03<02:08,  1.33s/it]  4%|‚ñç         | 4/100 [00:05<02:12,  1.38s/it]  5%|‚ñå         | 5/100 [00:06<02:03,  1.31s/it]  6%|‚ñå         | 6/100 [00:07<01:59,  1.27s/it]  7%|‚ñã         | 7/100 [00:09<02:05,  1.35s/it]  8%|‚ñä         | 8/100 [00:10<02:03,  1.34s/it]  9%|‚ñâ         | 9/100 [00:11<01:59,  1.32s/it] 10%|‚ñà         | 10/100 [00:13<02:00,  1.34s/it] 11%|‚ñà         | 11/100 [00:14<02:06,  1.42s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<02:05,  1.43s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<02:00,  1.38s/it] 14%|‚ñà‚ñç        | 14/100 [00:19<01:59,  1.39s/it] 15%|‚ñà‚ñå        | 15/100 [00:20<01:57,  1.39s/it] 16%|‚ñà‚ñå        | 16/100 [00:21<01:54,  1.36s/it] 17%|‚ñà‚ñã        | 17/100 [00:22<01:49,  1.33s/it] 18%|‚ñà‚ñä        | 18/100 [00:24<01:48,  1.33s/it] 19%|‚ñà‚ñâ        | 19/100 [00:25<01:45,  1.30s/it] 20%|‚ñà‚ñà        | 20/100 [00:26<01:42,  1.28s/it] 21%|‚ñà‚ñà        | 21/100 [00:28<01:42,  1.29s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:29<01:40,  1.29s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:30<01:40,  1.30s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:32<01:39,  1.32s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:33<01:38,  1.31s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:34<01:35,  1.29s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:35<01:34,  1.30s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:37<01:33,  1.30s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:38<01:38,  1.38s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:40<01:38,  1.41s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:41<01:35,  1.39s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:42<01:34,  1.39s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:44<01:31,  1.36s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:45<01:30,  1.36s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:46<01:25,  1.31s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:48<01:22,  1.29s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:49<01:21,  1.29s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:50<01:20,  1.30s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:51<01:19,  1.30s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:53<01:20,  1.35s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:55<01:28,  1.50s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:57<01:32,  1.60s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:59<01:50,  1.93s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:02<02:06,  2.26s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:05<02:09,  2.36s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:08<02:11,  2.44s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:10<02:10,  2.47s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:12<02:05,  2.42s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:15<02:07,  2.50s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:19<02:27,  2.95s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:21<02:08,  2.61s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:23<02:03,  2.58s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:26<02:07,  2.71s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:29<01:58,  2.58s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:31<01:48,  2.41s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:33<01:42,  2.34s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:36<01:48,  2.53s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:40<02:00,  2.86s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:41<01:43,  2.53s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:43<01:25,  2.14s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:44<01:15,  1.93s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:45<01:04,  1.70s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:46<00:56,  1.53s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:48<00:52,  1.47s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:49<00:47,  1.36s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:50<00:43,  1.29s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:51<00:41,  1.27s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:52<00:42,  1.33s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:54<00:41,  1.35s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:55<00:40,  1.34s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:57<00:38,  1.34s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:58<00:39,  1.40s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:59<00:37,  1.40s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:01<00:36,  1.42s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:02<00:34,  1.40s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:04<00:32,  1.36s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:05<00:30,  1.32s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:06<00:28,  1.31s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:07<00:28,  1.34s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:09<00:28,  1.41s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:10<00:26,  1.42s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:12<00:26,  1.49s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:14<00:24,  1.47s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:15<00:23,  1.49s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:17<00:23,  1.56s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:18<00:21,  1.50s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:20<00:19,  1.46s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:21<00:17,  1.44s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:22<00:16,  1.46s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:24<00:14,  1.46s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:25<00:12,  1.42s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:27<00:11,  1.49s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:29<00:11,  1.60s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:30<00:09,  1.61s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:32<00:08,  1.73s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:34<00:06,  1.74s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:36<00:05,  1.75s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:38<00:03,  1.84s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:40<00:01,  1.81s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:42<00:00,  1.81s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:42<00:00,  1.62s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.14767
wandb: 
wandb: üöÄ View run neat-sweep-178 at: https://wandb.ai/xzy11632/dance-dev/runs/cm57unk7
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_161201-cm57unk7/logs
wandb: Agent Starting Run: 9tmiptc4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_161647-9tmiptc4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run upbeat-sweep-179
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/9tmiptc4
[INFO][2024-03-16 16:16:56,140][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 16:16:56,542][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 16:16:56,548][dance][wrapped_func] Took 0:00:00.407747 to load and process data.
[INFO][2024-03-16 16:16:56,549][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 16:16:56,557][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 16:16:56,624][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:16:56,625][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:16:56,627][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:16:56,629][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 16:17:01,199][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=48)
[INFO][2024-03-16 16:17:01,203][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.05%
[INFO][2024-03-16 16:17:12,663][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 16:17:12,663][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 16:17:12,664][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 16:17:12,664][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:06,  1.27s/it]  2%|‚ñè         | 2/100 [00:02<01:58,  1.20s/it]  3%|‚ñé         | 3/100 [00:03<01:58,  1.22s/it]  4%|‚ñç         | 4/100 [00:04<01:51,  1.16s/it]  5%|‚ñå         | 5/100 [00:05<01:50,  1.16s/it]  6%|‚ñå         | 6/100 [00:07<01:51,  1.18s/it]  7%|‚ñã         | 7/100 [00:08<01:48,  1.16s/it]  8%|‚ñä         | 8/100 [00:09<01:47,  1.17s/it]  9%|‚ñâ         | 9/100 [00:10<01:48,  1.19s/it] 10%|‚ñà         | 10/100 [00:11<01:49,  1.21s/it] 11%|‚ñà         | 11/100 [00:13<01:48,  1.21s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:51,  1.27s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:48,  1.25s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:45,  1.23s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:45,  1.24s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:44,  1.24s/it] 17%|‚ñà‚ñã        | 17/100 [00:20<01:44,  1.26s/it] 18%|‚ñà‚ñä        | 18/100 [00:22<01:48,  1.33s/it] 19%|‚ñà‚ñâ        | 19/100 [00:23<01:48,  1.34s/it] 20%|‚ñà‚ñà        | 20/100 [00:25<01:50,  1.38s/it] 21%|‚ñà‚ñà        | 21/100 [00:26<01:48,  1.38s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:28<01:56,  1.50s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:29<02:00,  1.57s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:31<02:09,  1.70s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:33<02:09,  1.73s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:35<02:06,  1.71s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:37<02:06,  1.73s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:39<02:12,  1.84s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:41<02:09,  1.82s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:42<02:06,  1.81s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:44<02:04,  1.80s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:46<02:02,  1.80s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:48<01:59,  1.78s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:49<01:57,  1.78s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:51<01:58,  1.82s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:53<01:56,  1.82s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:55<01:57,  1.86s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:57<01:56,  1.88s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:59<01:57,  1.92s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:01<01:51,  1.85s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:02<01:42,  1.74s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:04<01:34,  1.64s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:05<01:34,  1.66s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:07<01:32,  1.66s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:09<01:30,  1.65s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:10<01:26,  1.60s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:12<01:22,  1.55s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:13<01:19,  1.53s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:15<01:17,  1.53s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:16<01:15,  1.51s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:17<01:11,  1.45s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:19<01:06,  1.40s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:20<01:04,  1.37s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:21<01:03,  1.38s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:23<01:03,  1.41s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:24<01:02,  1.42s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:26<01:00,  1.40s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:27<01:00,  1.43s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:29<01:02,  1.52s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:31<01:05,  1.63s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:32<01:04,  1.66s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:34<01:04,  1.70s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:36<01:04,  1.75s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:38<01:02,  1.73s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:39<01:00,  1.73s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:41<00:55,  1.64s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:42<00:51,  1.56s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:44<00:49,  1.54s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:46<00:49,  1.61s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:47<00:48,  1.63s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:49<00:44,  1.55s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:50<00:41,  1.47s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:51<00:38,  1.43s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:52<00:35,  1.37s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:54<00:33,  1.35s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:55<00:32,  1.35s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:56<00:30,  1.35s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:58<00:29,  1.34s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:59<00:27,  1.32s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:00<00:27,  1.35s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:02<00:25,  1.35s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:03<00:25,  1.39s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:05<00:23,  1.39s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:06<00:22,  1.42s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:08<00:22,  1.53s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:09<00:20,  1.48s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:11<00:18,  1.40s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:12<00:16,  1.36s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:13<00:14,  1.34s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:14<00:13,  1.32s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:16<00:11,  1.29s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:17<00:10,  1.30s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:18<00:09,  1.29s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:19<00:07,  1.26s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:21<00:06,  1.28s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:22<00:05,  1.40s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:24<00:04,  1.44s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:25<00:02,  1.47s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:27<00:01,  1.51s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:29<00:00,  1.57s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:29<00:00,  1.49s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.17865
wandb: 
wandb: üöÄ View run upbeat-sweep-179 at: https://wandb.ai/xzy11632/dance-dev/runs/9tmiptc4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_161647-9tmiptc4/logs
wandb: Agent Starting Run: ub4qtbq9 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_162132-ub4qtbq9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fancy-sweep-180
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ub4qtbq9
[INFO][2024-03-16 16:21:38,341][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 16:21:38,411][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 16:21:38,411][dance][wrapped_func] Took 0:00:00.069786 to load and process data.
[INFO][2024-03-16 16:21:38,411][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 16:21:38,414][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 16:21:38,429][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:21:38,430][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:21:38,430][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:21:38,431][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 16:21:39,899][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=45)
[INFO][2024-03-16 16:21:39,906][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.43%
[INFO][2024-03-16 16:21:41,920][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 16:21:41,921][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 16:21:41,921][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 16:21:41,921][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:11,  1.33s/it]  2%|‚ñè         | 2/100 [00:02<02:05,  1.28s/it]  3%|‚ñé         | 3/100 [00:03<02:05,  1.29s/it]  4%|‚ñç         | 4/100 [00:05<02:03,  1.29s/it]  5%|‚ñå         | 5/100 [00:06<02:07,  1.35s/it]  6%|‚ñå         | 6/100 [00:07<02:03,  1.31s/it]  7%|‚ñã         | 7/100 [00:09<02:04,  1.34s/it]  8%|‚ñä         | 8/100 [00:10<02:01,  1.32s/it]  9%|‚ñâ         | 9/100 [00:11<01:55,  1.27s/it] 10%|‚ñà         | 10/100 [00:12<01:51,  1.24s/it] 11%|‚ñà         | 11/100 [00:14<02:00,  1.35s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:58,  1.35s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<02:02,  1.41s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<02:05,  1.46s/it] 15%|‚ñà‚ñå        | 15/100 [00:20<02:05,  1.47s/it] 16%|‚ñà‚ñå        | 16/100 [00:21<02:05,  1.49s/it] 17%|‚ñà‚ñã        | 17/100 [00:23<02:10,  1.57s/it] 18%|‚ñà‚ñä        | 18/100 [00:25<02:04,  1.52s/it] 19%|‚ñà‚ñâ        | 19/100 [00:26<02:04,  1.53s/it] 20%|‚ñà‚ñà        | 20/100 [00:28<02:00,  1.51s/it] 21%|‚ñà‚ñà        | 21/100 [00:29<02:02,  1.55s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:31<02:00,  1.54s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:32<01:58,  1.53s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:34<01:59,  1.57s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:36<02:03,  1.64s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:38<02:05,  1.69s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:39<02:05,  1.71s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:41<02:02,  1.70s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:43<02:02,  1.73s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:45<02:06,  1.80s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:47<02:07,  1.85s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:48<01:57,  1.72s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:49<01:46,  1.59s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:51<01:42,  1.55s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:52<01:37,  1.51s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:54<01:35,  1.50s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:55<01:32,  1.47s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:57<01:29,  1.44s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:58<01:25,  1.40s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:59<01:22,  1.37s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:01<01:20,  1.37s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:02<01:19,  1.37s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:03<01:17,  1.35s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:05<01:14,  1.34s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:06<01:12,  1.33s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:07<01:11,  1.33s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:09<01:11,  1.34s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:10<01:10,  1.35s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:11<01:08,  1.34s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:13<01:08,  1.36s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:14<01:13,  1.50s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:16<01:14,  1.55s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:18<01:14,  1.58s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:19<01:10,  1.52s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:21<01:09,  1.54s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:23<01:11,  1.63s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:24<01:11,  1.66s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:26<01:11,  1.70s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:28<01:11,  1.74s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:30<01:09,  1.73s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:31<01:05,  1.69s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:33<01:04,  1.69s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:34<01:00,  1.63s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:36<00:56,  1.58s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:37<00:53,  1.52s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:39<00:50,  1.49s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:40<00:48,  1.48s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:42<00:47,  1.49s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:43<00:46,  1.49s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:44<00:43,  1.43s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:46<00:40,  1.40s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:47<00:38,  1.36s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:48<00:35,  1.33s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:50<00:33,  1.30s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:51<00:32,  1.32s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:52<00:31,  1.32s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:54<00:30,  1.35s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:55<00:29,  1.33s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:56<00:28,  1.35s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:58<00:26,  1.35s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:59<00:26,  1.37s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:00<00:23,  1.33s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:02<00:22,  1.34s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:03<00:21,  1.34s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:04<00:19,  1.29s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:06<00:18,  1.30s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:07<00:17,  1.33s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:08<00:15,  1.30s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:09<00:13,  1.27s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:11<00:12,  1.28s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:12<00:11,  1.31s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:13<00:10,  1.36s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:15<00:09,  1.34s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:16<00:07,  1.30s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:17<00:06,  1.29s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:19<00:05,  1.29s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:20<00:03,  1.33s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:21<00:02,  1.32s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:23<00:01,  1.36s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:24<00:00,  1.32s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:24<00:00,  1.44s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.021 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.14227
wandb: 
wandb: üöÄ View run fancy-sweep-180 at: https://wandb.ai/xzy11632/dance-dev/runs/ub4qtbq9
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_162132-ub4qtbq9/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 2guccxdl with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_162535-2guccxdl
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run curious-sweep-181
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/2guccxdl
[INFO][2024-03-16 16:25:40,101][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 16:25:40,193][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 16:25:40,193][dance][wrapped_func] Took 0:00:00.091952 to load and process data.
[INFO][2024-03-16 16:25:40,194][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 16:25:40,196][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'Log1P',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 16:25:40,214][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:25:40,214][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:25:40,215][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:25:40,298][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 16:25:41,632][dance.WeightedFeaturePCA][__call__] Decomposing train features (8057, 1000) (k=262)
[INFO][2024-03-16 16:25:41,633][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.01%
[INFO][2024-03-16 16:25:43,827][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 16:25:43,827][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 16:25:43,827][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 16:25:43,827][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:32,  1.54s/it]  2%|‚ñè         | 2/100 [00:02<02:19,  1.42s/it]  3%|‚ñé         | 3/100 [00:04<02:06,  1.31s/it]  4%|‚ñç         | 4/100 [00:05<02:06,  1.31s/it]  5%|‚ñå         | 5/100 [00:06<02:04,  1.31s/it]  6%|‚ñå         | 6/100 [00:07<01:59,  1.28s/it]  7%|‚ñã         | 7/100 [00:09<02:03,  1.32s/it]  8%|‚ñä         | 8/100 [00:13<03:17,  2.15s/it]  9%|‚ñâ         | 9/100 [00:16<03:58,  2.63s/it] 10%|‚ñà         | 10/100 [00:18<03:38,  2.42s/it] 11%|‚ñà         | 11/100 [00:20<03:07,  2.11s/it] 12%|‚ñà‚ñè        | 12/100 [00:21<02:54,  1.99s/it] 13%|‚ñà‚ñé        | 13/100 [00:23<02:37,  1.82s/it] 14%|‚ñà‚ñç        | 14/100 [00:24<02:30,  1.75s/it] 15%|‚ñà‚ñå        | 15/100 [00:26<02:29,  1.76s/it] 16%|‚ñà‚ñå        | 16/100 [00:28<02:21,  1.69s/it] 17%|‚ñà‚ñã        | 17/100 [00:29<02:16,  1.64s/it] 18%|‚ñà‚ñä        | 18/100 [00:31<02:11,  1.61s/it] 19%|‚ñà‚ñâ        | 19/100 [00:33<02:11,  1.63s/it] 20%|‚ñà‚ñà        | 20/100 [00:34<02:12,  1.65s/it] 21%|‚ñà‚ñà        | 21/100 [00:36<02:09,  1.64s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:38<02:08,  1.65s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:39<02:07,  1.66s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:41<02:07,  1.68s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:43<02:06,  1.68s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:44<02:02,  1.66s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:46<02:01,  1.66s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:48<01:58,  1.65s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:49<01:56,  1.64s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:51<01:53,  1.62s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:52<01:53,  1.64s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:54<01:50,  1.62s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:56<01:51,  1.67s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:57<01:47,  1.62s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:59<01:45,  1.63s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:01<01:43,  1.62s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:02<01:41,  1.62s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:04<01:41,  1.64s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:05<01:37,  1.59s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:07<01:35,  1.59s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:09<01:34,  1.61s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:10<01:35,  1.64s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:12<01:32,  1.62s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:13<01:31,  1.63s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:15<01:28,  1.62s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:17<01:29,  1.66s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:18<01:26,  1.64s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:20<01:22,  1.60s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:21<01:20,  1.58s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:23<01:20,  1.60s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:25<01:18,  1.61s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:27<01:19,  1.66s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:28<01:15,  1.61s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:30<01:12,  1.58s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:31<01:12,  1.60s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:33<01:09,  1.59s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:34<01:08,  1.60s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:36<01:09,  1.66s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:38<01:08,  1.68s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:39<01:06,  1.65s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:41<01:04,  1.65s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:43<01:02,  1.65s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:44<00:59,  1.61s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:46<01:00,  1.67s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:48<00:56,  1.62s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:49<00:56,  1.66s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:51<00:54,  1.64s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:53<00:53,  1.67s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:54<00:50,  1.63s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:56<00:51,  1.72s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:58<00:47,  1.64s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:59<00:45,  1.61s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:01<00:43,  1.62s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:02<00:42,  1.63s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:04<00:40,  1.61s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:05<00:37,  1.56s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:07<00:35,  1.56s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:09<00:34,  1.58s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:10<00:34,  1.65s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:12<00:31,  1.55s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:13<00:27,  1.45s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:14<00:24,  1.38s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:15<00:22,  1.32s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:17<00:20,  1.28s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:18<00:18,  1.26s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:19<00:17,  1.27s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:20<00:16,  1.24s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:21<00:14,  1.23s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:23<00:13,  1.23s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:24<00:12,  1.22s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:25<00:10,  1.21s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:26<00:09,  1.21s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:27<00:08,  1.21s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:29<00:07,  1.21s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:30<00:06,  1.21s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:31<00:04,  1.23s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:32<00:03,  1.23s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:34<00:02,  1.23s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:35<00:01,  1.23s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:36<00:00,  1.21s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:36<00:00,  1.57s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.021 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.018 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.27363
wandb: 
wandb: üöÄ View run curious-sweep-181 at: https://wandb.ai/xzy11632/dance-dev/runs/2guccxdl
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_162535-2guccxdl/logs
wandb: Agent Starting Run: 2s7mvpj2 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_162912-2s7mvpj2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fast-sweep-182
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/2s7mvpj2
[INFO][2024-03-16 16:29:18,002][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 16:29:18,119][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 16:29:18,120][dance][wrapped_func] Took 0:00:00.117076 to load and process data.
[INFO][2024-03-16 16:29:18,120][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 16:29:18,122][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'Log1P',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 16:29:18,140][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:29:18,141][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:29:18,141][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:29:18,247][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 16:29:37,904][dance.WeightedFeatureSVD][__call__] Decomposing train features (8057, 1000) (k=629)
[INFO][2024-03-16 16:29:37,905][dance.WeightedFeatureSVD][__call__] Total explained variance: 96.70%
[INFO][2024-03-16 16:29:40,931][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 16:29:40,931][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 16:29:40,931][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 16:29:40,932][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:23,  1.45s/it]  2%|‚ñè         | 2/100 [00:02<02:22,  1.45s/it]  3%|‚ñé         | 3/100 [00:04<02:11,  1.36s/it]  4%|‚ñç         | 4/100 [00:06<02:40,  1.67s/it]  5%|‚ñå         | 5/100 [00:08<03:05,  1.95s/it]  6%|‚ñå         | 6/100 [00:10<02:43,  1.74s/it]  7%|‚ñã         | 7/100 [00:11<02:28,  1.60s/it]  8%|‚ñä         | 8/100 [00:12<02:19,  1.51s/it]  9%|‚ñâ         | 9/100 [00:14<02:15,  1.49s/it] 10%|‚ñà         | 10/100 [00:15<02:10,  1.45s/it] 11%|‚ñà         | 11/100 [00:16<02:01,  1.37s/it] 12%|‚ñà‚ñè        | 12/100 [00:18<02:03,  1.40s/it] 13%|‚ñà‚ñé        | 13/100 [00:19<01:59,  1.37s/it] 14%|‚ñà‚ñç        | 14/100 [00:20<01:53,  1.33s/it] 15%|‚ñà‚ñå        | 15/100 [00:22<01:52,  1.32s/it] 16%|‚ñà‚ñå        | 16/100 [00:23<01:50,  1.32s/it] 17%|‚ñà‚ñã        | 17/100 [00:24<01:47,  1.30s/it] 18%|‚ñà‚ñä        | 18/100 [00:25<01:45,  1.28s/it] 19%|‚ñà‚ñâ        | 19/100 [00:27<01:47,  1.32s/it] 20%|‚ñà‚ñà        | 20/100 [00:28<01:49,  1.37s/it] 21%|‚ñà‚ñà        | 21/100 [00:30<01:47,  1.36s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:31<01:44,  1.34s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:32<01:43,  1.34s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:34<01:41,  1.34s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:35<01:40,  1.34s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:36<01:39,  1.34s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:37<01:36,  1.32s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:39<01:34,  1.31s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:40<01:36,  1.35s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:42<01:36,  1.37s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:43<01:34,  1.37s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:44<01:32,  1.36s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:46<01:27,  1.31s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:47<01:23,  1.26s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:48<01:21,  1.26s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:49<01:22,  1.28s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:50<01:19,  1.26s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:52<01:17,  1.25s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:53<01:17,  1.26s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:54<01:16,  1.28s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:56<01:14,  1.26s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:57<01:13,  1.26s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:58<01:12,  1.27s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:00<01:13,  1.32s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:01<01:16,  1.38s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:03<01:16,  1.41s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:04<01:15,  1.42s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:05<01:13,  1.41s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:07<01:10,  1.38s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:08<01:07,  1.35s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:09<01:04,  1.31s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:10<01:02,  1.29s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:12<01:02,  1.33s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:13<01:02,  1.36s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:15<01:00,  1.34s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:16<00:57,  1.31s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:17<00:55,  1.28s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:18<00:52,  1.26s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:19<00:51,  1.25s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:21<00:49,  1.24s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:22<00:47,  1.23s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:23<00:46,  1.23s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:24<00:44,  1.21s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:25<00:43,  1.22s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:27<00:42,  1.22s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:28<00:41,  1.22s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:29<00:39,  1.21s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:30<00:38,  1.21s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:32<00:37,  1.21s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:33<00:36,  1.21s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:34<00:35,  1.23s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:35<00:34,  1.23s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:36<00:33,  1.22s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:38<00:31,  1.21s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:39<00:30,  1.22s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:40<00:29,  1.23s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:41<00:28,  1.24s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:43<00:27,  1.26s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:44<00:25,  1.23s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:45<00:24,  1.23s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:46<00:23,  1.23s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:48<00:22,  1.23s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:49<00:21,  1.26s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:50<00:19,  1.23s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:51<00:18,  1.23s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:53<00:17,  1.27s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:54<00:16,  1.27s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:55<00:14,  1.25s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:56<00:13,  1.22s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:57<00:12,  1.21s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:01<00:16,  1.79s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:02<00:13,  1.65s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:03<00:10,  1.53s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:05<00:08,  1.48s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:06<00:07,  1.41s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:07<00:05,  1.35s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:08<00:03,  1.31s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:10<00:02,  1.32s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:11<00:01,  1.29s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:12<00:00,  1.27s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:12<00:00,  1.33s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.25048
wandb: 
wandb: üöÄ View run fast-sweep-182 at: https://wandb.ai/xzy11632/dance-dev/runs/2s7mvpj2
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_162912-2s7mvpj2/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: ym0pm74r with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_163259-ym0pm74r
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run spring-sweep-183
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ym0pm74r
[INFO][2024-03-16 16:33:05,485][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 16:33:05,661][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 16:33:05,662][dance][wrapped_func] Took 0:00:00.175007 to load and process data.
[INFO][2024-03-16 16:33:05,662][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 16:33:05,664][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'Log1P',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 16:33:05,685][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:33:05,686][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 16:33:05,930][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run spring-sweep-183 at: https://wandb.ai/xzy11632/dance-dev/runs/ym0pm74r
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_163259-ym0pm74r/logs
wandb: ERROR Run ym0pm74r errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1000) out of bounds (1000)
wandb: ERROR 
wandb: Agent Starting Run: usfhb116 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_163320-usfhb116
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run comic-sweep-184
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/usfhb116
[INFO][2024-03-16 16:33:26,624][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 16:33:26,727][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 16:33:26,727][dance][wrapped_func] Took 0:00:00.101521 to load and process data.
[INFO][2024-03-16 16:33:26,727][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 16:33:26,729][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'Log1P',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 16:33:26,748][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:33:26,749][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 16:33:27,005][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run comic-sweep-184 at: https://wandb.ai/xzy11632/dance-dev/runs/usfhb116
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_163320-usfhb116/logs
wandb: ERROR Run usfhb116 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1000) out of bounds (1000)
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: a5qz9ght with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_163347-a5qz9ght
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run flowing-sweep-185
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/a5qz9ght
[INFO][2024-03-16 16:33:53,205][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 16:33:53,347][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 16:33:53,347][dance][wrapped_func] Took 0:00:00.141503 to load and process data.
[INFO][2024-03-16 16:33:53,347][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 16:33:53,352][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'Log1P',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 16:33:53,374][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:33:53,375][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 16:33:53,835][dance.WeightedFeaturePCA][__call__] Decomposing train features (8057, 200) (k=120)
[INFO][2024-03-16 16:33:53,836][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.15%
[INFO][2024-03-16 16:33:55,877][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 16:33:55,877][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 16:33:55,877][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 16:33:55,877][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:08,  1.30s/it]  2%|‚ñè         | 2/100 [00:02<02:02,  1.25s/it]  3%|‚ñé         | 3/100 [00:03<01:59,  1.23s/it]  4%|‚ñç         | 4/100 [00:04<01:59,  1.25s/it]  5%|‚ñå         | 5/100 [00:06<01:58,  1.24s/it]  6%|‚ñå         | 6/100 [00:07<01:59,  1.27s/it]  7%|‚ñã         | 7/100 [00:09<02:07,  1.38s/it]  8%|‚ñä         | 8/100 [00:10<02:16,  1.48s/it]  9%|‚ñâ         | 9/100 [00:12<02:21,  1.55s/it] 10%|‚ñà         | 10/100 [00:14<02:22,  1.58s/it] 11%|‚ñà         | 11/100 [00:15<02:23,  1.61s/it] 12%|‚ñà‚ñè        | 12/100 [00:17<02:23,  1.63s/it] 13%|‚ñà‚ñé        | 13/100 [00:19<02:23,  1.65s/it] 14%|‚ñà‚ñç        | 14/100 [00:21<02:42,  1.88s/it] 15%|‚ñà‚ñå        | 15/100 [00:23<02:34,  1.82s/it] 16%|‚ñà‚ñå        | 16/100 [00:25<02:31,  1.81s/it] 17%|‚ñà‚ñã        | 17/100 [00:26<02:26,  1.76s/it] 18%|‚ñà‚ñä        | 18/100 [00:28<02:22,  1.74s/it] 19%|‚ñà‚ñâ        | 19/100 [00:30<02:18,  1.71s/it] 20%|‚ñà‚ñà        | 20/100 [00:31<02:16,  1.71s/it] 21%|‚ñà‚ñà        | 21/100 [00:33<02:12,  1.67s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:35<02:09,  1.66s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:36<02:09,  1.68s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:38<02:05,  1.66s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:39<01:58,  1.58s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:41<01:56,  1.57s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:42<01:48,  1.48s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:44<01:57,  1.63s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:45<01:49,  1.54s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:47<01:40,  1.44s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:48<01:34,  1.37s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:49<01:31,  1.34s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:50<01:28,  1.32s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:52<01:28,  1.34s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:53<01:26,  1.34s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:54<01:24,  1.31s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:56<01:24,  1.35s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:57<01:24,  1.37s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:59<01:24,  1.39s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:00<01:26,  1.43s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:01<01:21,  1.39s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:03<01:19,  1.37s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:04<01:15,  1.33s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:06<01:17,  1.39s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:07<01:21,  1.49s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:09<01:22,  1.53s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:10<01:22,  1.55s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:12<01:25,  1.64s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:14<01:23,  1.64s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:16<01:21,  1.63s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:17<01:19,  1.63s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:19<01:19,  1.65s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:21<01:17,  1.64s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:22<01:13,  1.61s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:24<01:11,  1.60s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:25<01:11,  1.63s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:27<01:09,  1.63s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:29<01:10,  1.68s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:30<01:09,  1.69s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:32<01:06,  1.67s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:34<01:04,  1.66s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:35<01:03,  1.66s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:37<01:00,  1.64s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:38<00:54,  1.53s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:40<00:51,  1.47s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:41<00:48,  1.41s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:42<00:45,  1.37s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:43<00:42,  1.33s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:45<00:42,  1.36s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:46<00:40,  1.36s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:48<00:41,  1.44s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:50<00:43,  1.55s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:51<00:43,  1.63s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:53<00:43,  1.66s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:55<00:40,  1.64s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:57<00:41,  1.71s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:58<00:39,  1.73s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:00<00:38,  1.77s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:02<00:37,  1.78s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:04<00:34,  1.75s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:05<00:33,  1.76s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:07<00:31,  1.73s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:09<00:29,  1.71s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:10<00:26,  1.68s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:12<00:25,  1.67s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:14<00:23,  1.65s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:15<00:22,  1.69s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:17<00:20,  1.71s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:19<00:18,  1.68s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:20<00:16,  1.64s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:22<00:14,  1.58s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:23<00:11,  1.50s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:24<00:10,  1.46s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:26<00:08,  1.39s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:27<00:06,  1.38s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:28<00:05,  1.33s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:30<00:03,  1.33s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:31<00:02,  1.43s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:33<00:01,  1.48s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:34<00:00,  1.53s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:34<00:00,  1.55s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.3302
wandb: 
wandb: üöÄ View run flowing-sweep-185 at: https://wandb.ai/xzy11632/dance-dev/runs/a5qz9ght
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_163347-a5qz9ght/logs
wandb: Agent Starting Run: tii94m6y with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_163753-tii94m6y
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run eternal-sweep-186
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/tii94m6y
[INFO][2024-03-16 16:37:58,597][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 16:37:58,707][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 16:37:58,707][dance][wrapped_func] Took 0:00:00.109476 to load and process data.
[INFO][2024-03-16 16:37:58,708][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 16:37:58,710][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'Log1P',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 16:37:58,729][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:37:58,730][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 16:38:00,838][dance.WeightedFeatureSVD][__call__] Decomposing train features (8057, 200) (k=116)
[INFO][2024-03-16 16:38:00,840][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.10%
[INFO][2024-03-16 16:38:02,586][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 16:38:02,586][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 16:38:02,587][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 16:38:02,587][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:43,  1.05s/it]  2%|‚ñè         | 2/100 [00:02<01:53,  1.16s/it]  3%|‚ñé         | 3/100 [00:03<01:48,  1.12s/it]  4%|‚ñç         | 4/100 [00:04<01:44,  1.09s/it]  5%|‚ñå         | 5/100 [00:05<01:47,  1.14s/it]  6%|‚ñå         | 6/100 [00:06<01:51,  1.18s/it]  7%|‚ñã         | 7/100 [00:08<01:50,  1.18s/it]  8%|‚ñä         | 8/100 [00:09<01:51,  1.21s/it]  9%|‚ñâ         | 9/100 [00:10<01:50,  1.22s/it] 10%|‚ñà         | 10/100 [00:11<01:45,  1.17s/it] 11%|‚ñà         | 11/100 [00:12<01:47,  1.21s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:45,  1.20s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:45,  1.22s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:42,  1.19s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:39,  1.17s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<01:36,  1.15s/it] 17%|‚ñà‚ñã        | 17/100 [00:19<01:34,  1.14s/it] 18%|‚ñà‚ñä        | 18/100 [00:20<01:32,  1.13s/it] 19%|‚ñà‚ñâ        | 19/100 [00:22<01:33,  1.15s/it] 20%|‚ñà‚ñà        | 20/100 [00:23<01:35,  1.19s/it] 21%|‚ñà‚ñà        | 21/100 [00:24<01:32,  1.17s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:25<01:30,  1.16s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:26<01:30,  1.17s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:27<01:27,  1.15s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:29<01:25,  1.15s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:30<01:23,  1.12s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:31<01:22,  1.13s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:32<01:24,  1.18s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:33<01:21,  1.15s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:34<01:21,  1.17s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:36<01:22,  1.20s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:37<01:21,  1.20s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:38<01:21,  1.21s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:39<01:17,  1.18s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:40<01:16,  1.17s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:42<01:14,  1.16s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:43<01:14,  1.19s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:44<01:10,  1.14s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:45<01:11,  1.17s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:46<01:10,  1.17s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:48<01:13,  1.25s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:49<01:11,  1.23s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:50<01:08,  1.20s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:51<01:05,  1.17s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:52<01:02,  1.13s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:53<00:59,  1.11s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:54<00:58,  1.11s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:55<00:58,  1.12s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:57<00:57,  1.13s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:58<00:56,  1.12s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:59<00:53,  1.10s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:00<00:52,  1.09s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:01<00:51,  1.09s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:02<00:50,  1.10s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:03<00:49,  1.11s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:04<00:48,  1.11s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:05<00:48,  1.12s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:07<00:46,  1.11s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:07<00:44,  1.08s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:09<00:43,  1.08s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:10<00:42,  1.09s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:11<00:41,  1.09s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:12<00:39,  1.08s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:13<00:38,  1.07s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:14<00:36,  1.05s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:15<00:35,  1.04s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:16<00:34,  1.03s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:17<00:32,  1.03s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:18<00:31,  1.02s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:19<00:31,  1.06s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:20<00:31,  1.08s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:21<00:29,  1.07s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:22<00:29,  1.09s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:23<00:28,  1.09s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:25<00:26,  1.07s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:26<00:26,  1.10s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:27<00:25,  1.11s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:28<00:24,  1.12s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:29<00:23,  1.12s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:30<00:22,  1.11s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:31<00:20,  1.09s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:32<00:19,  1.08s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:33<00:18,  1.11s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:35<00:17,  1.09s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:36<00:16,  1.09s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:37<00:15,  1.11s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:38<00:14,  1.12s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:40<00:16,  1.34s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:41<00:14,  1.28s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:42<00:12,  1.21s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:43<00:10,  1.16s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:44<00:09,  1.14s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:45<00:07,  1.13s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:46<00:06,  1.13s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:47<00:05,  1.10s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:49<00:04,  1.13s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:50<00:03,  1.11s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:51<00:02,  1.08s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:52<00:01,  1.12s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:53<00:00,  1.14s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:53<00:00,  1.14s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.47009
wandb: 
wandb: üöÄ View run eternal-sweep-186 at: https://wandb.ai/xzy11632/dance-dev/runs/tii94m6y
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_163753-tii94m6y/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 1onnafzr with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_164131-1onnafzr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run radiant-sweep-187
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/1onnafzr
[INFO][2024-03-16 16:41:37,009][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 16:41:37,129][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 16:41:37,130][dance][wrapped_func] Took 0:00:00.119601 to load and process data.
[INFO][2024-03-16 16:41:37,130][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 16:41:37,133][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 16:41:37,163][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:41:37,165][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 16:41:37,536][dance.WeightedFeaturePCA][__call__] Decomposing train features (8057, 163) (k=64)
[INFO][2024-03-16 16:41:37,536][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.03%
[INFO][2024-03-16 16:41:39,383][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 16:41:39,383][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 16:41:39,384][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 16:41:39,384][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:03,  1.24s/it]  2%|‚ñè         | 2/100 [00:02<02:03,  1.27s/it]  3%|‚ñé         | 3/100 [00:04<02:13,  1.38s/it]  4%|‚ñç         | 4/100 [00:05<02:08,  1.34s/it]  5%|‚ñå         | 5/100 [00:06<02:08,  1.36s/it]  6%|‚ñå         | 6/100 [00:08<02:12,  1.41s/it]  7%|‚ñã         | 7/100 [00:09<02:19,  1.50s/it]  8%|‚ñä         | 8/100 [00:11<02:17,  1.50s/it]  9%|‚ñâ         | 9/100 [00:12<02:12,  1.45s/it] 10%|‚ñà         | 10/100 [00:14<02:10,  1.45s/it] 11%|‚ñà         | 11/100 [00:15<02:12,  1.49s/it] 12%|‚ñà‚ñè        | 12/100 [00:17<02:09,  1.47s/it] 13%|‚ñà‚ñé        | 13/100 [00:18<02:08,  1.48s/it] 14%|‚ñà‚ñç        | 14/100 [00:20<02:07,  1.48s/it] 15%|‚ñà‚ñå        | 15/100 [00:21<02:12,  1.56s/it] 16%|‚ñà‚ñå        | 16/100 [00:23<02:18,  1.65s/it] 17%|‚ñà‚ñã        | 17/100 [00:25<02:18,  1.67s/it] 18%|‚ñà‚ñä        | 18/100 [00:27<02:16,  1.66s/it] 19%|‚ñà‚ñâ        | 19/100 [00:28<02:16,  1.69s/it] 20%|‚ñà‚ñà        | 20/100 [00:30<02:13,  1.66s/it] 21%|‚ñà‚ñà        | 21/100 [00:31<02:01,  1.54s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:33<02:03,  1.58s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:34<01:58,  1.54s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:36<01:49,  1.44s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:37<01:47,  1.44s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:38<01:47,  1.45s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:40<01:41,  1.38s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:41<01:39,  1.38s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:42<01:36,  1.36s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:44<01:33,  1.33s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:45<01:27,  1.27s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:46<01:24,  1.24s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:47<01:24,  1.26s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:48<01:21,  1.23s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:50<01:17,  1.19s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:51<01:15,  1.18s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:52<01:14,  1.18s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:53<01:13,  1.18s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:54<01:16,  1.25s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:56<01:13,  1.22s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:57<01:15,  1.28s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:58<01:13,  1.26s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:59<01:10,  1.24s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:01<01:06,  1.19s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:02<01:04,  1.18s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:03<01:06,  1.23s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:04<01:05,  1.23s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:05<01:04,  1.24s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:07<01:04,  1.27s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:08<01:07,  1.34s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:10<01:04,  1.32s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:11<01:01,  1.28s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:12<00:58,  1.24s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:13<00:58,  1.28s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:15<00:57,  1.27s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:16<00:59,  1.34s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:17<00:57,  1.35s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:19<00:56,  1.35s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:20<00:53,  1.31s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:21<00:52,  1.31s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:23<00:53,  1.36s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:24<00:53,  1.40s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:26<00:51,  1.38s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:27<00:51,  1.44s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:29<00:51,  1.47s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:30<00:51,  1.51s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:32<00:51,  1.56s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:34<00:51,  1.60s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:35<00:50,  1.62s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:37<00:49,  1.63s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:39<00:46,  1.59s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:40<00:45,  1.62s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:42<00:42,  1.58s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:43<00:39,  1.53s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:44<00:35,  1.42s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:46<00:33,  1.39s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:47<00:31,  1.39s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:49<00:32,  1.46s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:50<00:29,  1.40s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:51<00:28,  1.43s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:53<00:28,  1.49s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:54<00:26,  1.45s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:56<00:23,  1.39s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:57<00:21,  1.32s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:58<00:19,  1.32s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:59<00:18,  1.34s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:01<00:17,  1.31s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:02<00:15,  1.28s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:03<00:14,  1.31s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:05<00:13,  1.30s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:06<00:12,  1.35s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:07<00:10,  1.37s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:09<00:09,  1.31s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:10<00:07,  1.26s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:11<00:06,  1.23s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:12<00:04,  1.23s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:13<00:03,  1.21s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:14<00:02,  1.17s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:16<00:01,  1.19s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:17<00:00,  1.20s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:17<00:00,  1.37s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.23541
wandb: 
wandb: üöÄ View run radiant-sweep-187 at: https://wandb.ai/xzy11632/dance-dev/runs/1onnafzr
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_164131-1onnafzr/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 6pqxz4rv with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_164533-6pqxz4rv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run happy-sweep-188
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/6pqxz4rv
[INFO][2024-03-16 16:45:39,136][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 16:45:39,232][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 16:45:39,232][dance][wrapped_func] Took 0:00:00.095145 to load and process data.
[INFO][2024-03-16 16:45:39,233][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 16:45:39,235][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 16:45:39,253][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:45:39,254][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 16:45:41,656][dance.WeightedFeatureSVD][__call__] Decomposing train features (8057, 163) (k=78)
[INFO][2024-03-16 16:45:41,658][dance.WeightedFeatureSVD][__call__] Total explained variance: 92.21%
[INFO][2024-03-16 16:45:43,525][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 16:45:43,525][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 16:45:43,525][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 16:45:43,525][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:48,  1.10s/it]  2%|‚ñè         | 2/100 [00:02<01:47,  1.09s/it]  3%|‚ñé         | 3/100 [00:03<01:48,  1.11s/it]  4%|‚ñç         | 4/100 [00:04<01:49,  1.14s/it]  5%|‚ñå         | 5/100 [00:05<01:46,  1.12s/it]  6%|‚ñå         | 6/100 [00:06<01:46,  1.14s/it]  7%|‚ñã         | 7/100 [00:07<01:42,  1.10s/it]  8%|‚ñä         | 8/100 [00:08<01:42,  1.12s/it]  9%|‚ñâ         | 9/100 [00:10<01:43,  1.13s/it] 10%|‚ñà         | 10/100 [00:11<01:42,  1.14s/it] 11%|‚ñà         | 11/100 [00:12<01:39,  1.12s/it] 12%|‚ñà‚ñè        | 12/100 [00:13<01:36,  1.10s/it] 13%|‚ñà‚ñé        | 13/100 [00:14<01:35,  1.10s/it] 14%|‚ñà‚ñç        | 14/100 [00:15<01:40,  1.17s/it] 15%|‚ñà‚ñå        | 15/100 [00:16<01:39,  1.17s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<01:37,  1.17s/it] 17%|‚ñà‚ñã        | 17/100 [00:19<01:33,  1.13s/it] 18%|‚ñà‚ñä        | 18/100 [00:20<01:32,  1.12s/it] 19%|‚ñà‚ñâ        | 19/100 [00:21<01:29,  1.10s/it] 20%|‚ñà‚ñà        | 20/100 [00:22<01:29,  1.11s/it] 21%|‚ñà‚ñà        | 21/100 [00:23<01:26,  1.09s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:24<01:25,  1.09s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:25<01:23,  1.09s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:26<01:22,  1.09s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:27<01:23,  1.11s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:29<01:24,  1.14s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:30<01:24,  1.15s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:31<01:22,  1.15s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:32<01:22,  1.17s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:33<01:23,  1.20s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:35<01:26,  1.25s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:36<01:26,  1.28s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:37<01:26,  1.28s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:39<01:24,  1.28s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:40<01:23,  1.29s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:41<01:23,  1.30s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:43<01:27,  1.39s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:45<01:31,  1.48s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:46<01:34,  1.55s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:48<01:34,  1.58s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:50<01:32,  1.57s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:51<01:33,  1.60s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:53<01:32,  1.63s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:55<01:32,  1.66s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:56<01:32,  1.67s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:58<01:31,  1.69s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:00<01:31,  1.72s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:02<01:29,  1.72s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:03<01:26,  1.70s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:05<01:23,  1.68s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:07<01:21,  1.65s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:08<01:19,  1.66s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:10<01:17,  1.65s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:11<01:12,  1.58s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:13<01:15,  1.68s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:15<01:17,  1.76s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:17<01:13,  1.70s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:18<01:04,  1.53s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:19<00:57,  1.40s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:20<00:51,  1.30s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:21<00:47,  1.23s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:22<00:44,  1.18s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:23<00:44,  1.19s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:24<00:42,  1.17s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:26<00:40,  1.16s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:27<00:39,  1.17s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:28<00:36,  1.12s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:29<00:36,  1.13s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:30<00:36,  1.18s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:31<00:35,  1.18s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:32<00:33,  1.15s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:34<00:31,  1.13s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:35<00:30,  1.13s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:36<00:29,  1.14s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:37<00:29,  1.19s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:38<00:29,  1.23s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:40<00:27,  1.18s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:41<00:25,  1.17s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:42<00:24,  1.18s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:43<00:23,  1.16s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:44<00:23,  1.21s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:45<00:21,  1.18s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:47<00:19,  1.17s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:48<00:18,  1.15s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:49<00:16,  1.11s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:50<00:15,  1.12s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:51<00:15,  1.16s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:52<00:13,  1.16s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:53<00:12,  1.10s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:54<00:10,  1.09s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:55<00:09,  1.10s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:57<00:09,  1.14s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:58<00:07,  1.12s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:59<00:06,  1.13s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:00<00:05,  1.10s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:01<00:04,  1.12s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:02<00:03,  1.11s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:03<00:02,  1.15s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:05<00:01,  1.14s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:06<00:00,  1.16s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:06<00:00,  1.26s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.021 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.30501
wandb: 
wandb: üöÄ View run happy-sweep-188 at: https://wandb.ai/xzy11632/dance-dev/runs/6pqxz4rv
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_164533-6pqxz4rv/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: mbiqx5rx with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_164900-mbiqx5rx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run cosmic-sweep-189
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/mbiqx5rx
[INFO][2024-03-16 16:49:06,365][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 16:49:06,489][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 16:49:06,489][dance][wrapped_func] Took 0:00:00.122800 to load and process data.
[INFO][2024-03-16 16:49:06,489][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 16:49:06,492][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 16:49:06,513][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:49:06,514][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 16:49:06,951][dance.WeightedFeaturePCA][__call__] Decomposing train features (8057, 200) (k=20)
[INFO][2024-03-16 16:49:06,952][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.09%
[INFO][2024-03-16 16:49:08,825][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 16:49:08,825][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 16:49:08,826][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 16:49:08,826][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:10,  1.32s/it]  2%|‚ñè         | 2/100 [00:02<02:03,  1.26s/it]  3%|‚ñé         | 3/100 [00:03<02:03,  1.27s/it]  4%|‚ñç         | 4/100 [00:05<02:03,  1.28s/it]  5%|‚ñå         | 5/100 [00:06<02:04,  1.31s/it]  6%|‚ñå         | 6/100 [00:08<02:10,  1.38s/it]  7%|‚ñã         | 7/100 [00:09<02:09,  1.39s/it]  8%|‚ñä         | 8/100 [00:10<02:05,  1.36s/it]  9%|‚ñâ         | 9/100 [00:12<02:03,  1.35s/it] 10%|‚ñà         | 10/100 [00:13<02:07,  1.41s/it] 11%|‚ñà         | 11/100 [00:15<02:12,  1.49s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<02:15,  1.54s/it] 13%|‚ñà‚ñé        | 13/100 [00:18<02:13,  1.53s/it] 14%|‚ñà‚ñç        | 14/100 [00:19<02:03,  1.43s/it] 15%|‚ñà‚ñå        | 15/100 [00:21<02:06,  1.49s/it] 16%|‚ñà‚ñå        | 16/100 [00:22<02:02,  1.46s/it] 17%|‚ñà‚ñã        | 17/100 [00:24<02:02,  1.48s/it] 18%|‚ñà‚ñä        | 18/100 [00:25<02:01,  1.48s/it] 19%|‚ñà‚ñâ        | 19/100 [00:26<01:54,  1.42s/it] 20%|‚ñà‚ñà        | 20/100 [00:28<01:56,  1.45s/it] 21%|‚ñà‚ñà        | 21/100 [00:29<01:55,  1.47s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:31<01:51,  1.43s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:32<01:54,  1.49s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:34<01:50,  1.46s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:35<01:52,  1.51s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:37<01:50,  1.49s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:38<01:50,  1.51s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:40<01:48,  1.51s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:41<01:47,  1.51s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:43<01:42,  1.46s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:44<01:39,  1.44s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:46<01:39,  1.46s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:47<01:35,  1.43s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:48<01:33,  1.41s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:50<01:30,  1.39s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:51<01:27,  1.37s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:52<01:22,  1.31s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:54<01:20,  1.29s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:55<01:17,  1.27s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:56<01:15,  1.26s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:57<01:14,  1.26s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:59<01:16,  1.31s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:00<01:15,  1.32s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:01<01:14,  1.33s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:03<01:12,  1.31s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:04<01:10,  1.30s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:05<01:12,  1.37s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:07<01:12,  1.39s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:08<01:13,  1.44s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:10<01:11,  1.42s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:12<01:13,  1.50s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:13<01:08,  1.43s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:14<01:06,  1.41s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:15<01:02,  1.36s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:17<00:58,  1.31s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:18<00:56,  1.29s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:19<00:55,  1.30s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:21<00:56,  1.35s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:22<00:55,  1.36s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:23<00:55,  1.39s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:25<00:54,  1.40s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:26<00:53,  1.41s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:28<00:50,  1.36s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:29<00:52,  1.45s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:30<00:48,  1.37s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:32<00:47,  1.41s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:33<00:48,  1.46s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:35<00:47,  1.48s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:36<00:44,  1.44s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:38<00:43,  1.45s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:39<00:41,  1.44s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:41<00:41,  1.48s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:42<00:38,  1.42s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:43<00:36,  1.39s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:45<00:33,  1.36s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:46<00:32,  1.35s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:47<00:30,  1.33s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:48<00:28,  1.28s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:50<00:27,  1.29s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:51<00:25,  1.28s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:53<00:26,  1.40s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:54<00:25,  1.41s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:56<00:25,  1.49s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:57<00:23,  1.49s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:59<00:23,  1.56s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:01<00:21,  1.53s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:02<00:19,  1.52s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:04<00:18,  1.52s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:05<00:17,  1.60s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:07<00:16,  1.62s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:09<00:15,  1.68s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:11<00:13,  1.69s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:12<00:12,  1.72s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:14<00:10,  1.68s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:16<00:08,  1.75s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:17<00:06,  1.68s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:19<00:04,  1.62s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:20<00:02,  1.49s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:21<00:01,  1.41s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:22<00:00,  1.34s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:22<00:00,  1.43s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.020 MB of 0.025 MB uploadedwandb: \ 0.024 MB of 0.025 MB uploadedwandb: | 0.024 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.27976
wandb: 
wandb: üöÄ View run cosmic-sweep-189 at: https://wandb.ai/xzy11632/dance-dev/runs/mbiqx5rx
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_164900-mbiqx5rx/logs
wandb: Agent Starting Run: m87iqawa with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_165243-m87iqawa
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run vital-sweep-190
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/m87iqawa
[INFO][2024-03-16 16:52:49,468][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 16:52:49,608][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 16:52:49,609][dance][wrapped_func] Took 0:00:00.139757 to load and process data.
[INFO][2024-03-16 16:52:49,609][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 16:52:49,611][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 16:52:49,632][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:52:49,633][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 16:52:51,400][dance.WeightedFeatureSVD][__call__] Decomposing train features (8057, 200) (k=94)
[INFO][2024-03-16 16:52:51,400][dance.WeightedFeatureSVD][__call__] Total explained variance: 96.34%
[INFO][2024-03-16 16:52:53,290][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 16:52:53,290][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 16:52:53,290][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 16:52:53,290][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:54,  1.16s/it]  2%|‚ñè         | 2/100 [00:02<01:51,  1.13s/it]  3%|‚ñé         | 3/100 [00:03<01:49,  1.13s/it]  4%|‚ñç         | 4/100 [00:04<01:51,  1.16s/it]  5%|‚ñå         | 5/100 [00:05<01:47,  1.13s/it]  6%|‚ñå         | 6/100 [00:06<01:46,  1.14s/it]  7%|‚ñã         | 7/100 [00:07<01:42,  1.11s/it]  8%|‚ñä         | 8/100 [00:09<01:42,  1.12s/it]  9%|‚ñâ         | 9/100 [00:10<01:40,  1.10s/it] 10%|‚ñà         | 10/100 [00:11<01:39,  1.11s/it] 11%|‚ñà         | 11/100 [00:12<01:48,  1.21s/it] 12%|‚ñà‚ñè        | 12/100 [00:13<01:47,  1.22s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:45,  1.21s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:42,  1.20s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:41,  1.19s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<01:40,  1.19s/it] 17%|‚ñà‚ñã        | 17/100 [00:19<01:42,  1.24s/it] 18%|‚ñà‚ñä        | 18/100 [00:21<01:40,  1.22s/it] 19%|‚ñà‚ñâ        | 19/100 [00:22<01:41,  1.26s/it] 20%|‚ñà‚ñà        | 20/100 [00:23<01:40,  1.25s/it] 21%|‚ñà‚ñà        | 21/100 [00:25<01:41,  1.29s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:26<01:37,  1.25s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:27<01:37,  1.27s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:28<01:36,  1.27s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:30<01:38,  1.31s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:31<01:32,  1.24s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:32<01:35,  1.30s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:34<01:33,  1.30s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:35<01:32,  1.31s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:36<01:30,  1.29s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:37<01:27,  1.26s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:39<01:28,  1.30s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:40<01:25,  1.28s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:41<01:26,  1.31s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:43<01:22,  1.27s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:44<01:25,  1.34s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:45<01:25,  1.35s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:47<01:25,  1.39s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:48<01:24,  1.39s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:50<01:21,  1.37s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:51<01:16,  1.29s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:52<01:12,  1.26s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:53<01:09,  1.23s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:54<01:07,  1.20s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:55<01:05,  1.19s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:57<01:05,  1.22s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:58<01:04,  1.21s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:59<01:02,  1.19s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:00<01:03,  1.25s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:02<01:05,  1.31s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:03<01:02,  1.28s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:04<01:00,  1.26s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:05<00:57,  1.23s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:07<00:56,  1.22s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:08<00:55,  1.23s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:09<00:54,  1.25s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:10<00:53,  1.23s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:12<00:51,  1.22s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:13<00:49,  1.20s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:14<00:49,  1.23s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:15<00:47,  1.21s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:16<00:46,  1.21s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:18<00:46,  1.25s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:19<00:46,  1.29s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:20<00:44,  1.28s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:22<00:43,  1.29s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:23<00:41,  1.26s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:24<00:41,  1.30s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:26<00:40,  1.30s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:27<00:38,  1.29s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:28<00:36,  1.27s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:29<00:35,  1.26s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:30<00:33,  1.25s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:32<00:31,  1.22s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:33<00:31,  1.25s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:34<00:30,  1.27s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:36<00:29,  1.28s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:37<00:27,  1.26s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:38<00:28,  1.35s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:40<00:28,  1.44s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:42<00:28,  1.49s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:43<00:28,  1.56s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:45<00:26,  1.57s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:47<00:25,  1.59s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:48<00:23,  1.60s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:50<00:23,  1.65s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:52<00:22,  1.70s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:54<00:20,  1.74s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:55<00:18,  1.72s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:57<00:17,  1.71s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:59<00:15,  1.67s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:00<00:13,  1.66s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:02<00:11,  1.66s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:04<00:10,  1.67s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:06<00:08,  1.77s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:07<00:06,  1.71s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:09<00:05,  1.70s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:10<00:03,  1.66s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:12<00:01,  1.62s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:13<00:00,  1.57s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:13<00:00,  1.34s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.021 MB uploadedwandb: \ 0.019 MB of 0.025 MB uploadedwandb: | 0.019 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.27005
wandb: 
wandb: üöÄ View run vital-sweep-190 at: https://wandb.ai/xzy11632/dance-dev/runs/m87iqawa
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_165243-m87iqawa/logs
wandb: Agent Starting Run: evy7v960 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_165602-evy7v960
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run prime-sweep-191
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/evy7v960
[INFO][2024-03-16 16:56:07,361][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 16:56:07,457][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 16:56:07,457][dance][wrapped_func] Took 0:00:00.095538 to load and process data.
[INFO][2024-03-16 16:56:07,457][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 16:56:07,459][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 16:56:07,476][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:56:07,477][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 16:56:08,139][dance.WeightedFeaturePCA][__call__] Decomposing train features (8057, 200) (k=21)
[INFO][2024-03-16 16:56:08,140][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.11%
[INFO][2024-03-16 16:56:10,040][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 16:56:10,041][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 16:56:10,041][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 16:56:10,041][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:53,  1.15s/it]  2%|‚ñè         | 2/100 [00:02<01:50,  1.13s/it]  3%|‚ñé         | 3/100 [00:03<01:53,  1.17s/it]  4%|‚ñç         | 4/100 [00:04<01:53,  1.19s/it]  5%|‚ñå         | 5/100 [00:05<01:52,  1.18s/it]  6%|‚ñå         | 6/100 [00:07<01:53,  1.20s/it]  7%|‚ñã         | 7/100 [00:08<01:53,  1.22s/it]  8%|‚ñä         | 8/100 [00:09<02:01,  1.33s/it]  9%|‚ñâ         | 9/100 [00:11<02:01,  1.33s/it] 10%|‚ñà         | 10/100 [00:12<01:56,  1.30s/it] 11%|‚ñà         | 11/100 [00:13<01:53,  1.28s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:48,  1.23s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:43,  1.19s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:42,  1.20s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:43,  1.22s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:45,  1.25s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:50,  1.33s/it] 18%|‚ñà‚ñä        | 18/100 [00:22<01:52,  1.37s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<01:52,  1.39s/it] 20%|‚ñà‚ñà        | 20/100 [00:25<01:47,  1.34s/it] 21%|‚ñà‚ñà        | 21/100 [00:26<01:43,  1.30s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:27<01:40,  1.29s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:29<01:49,  1.42s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:30<01:46,  1.40s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:32<01:41,  1.35s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:33<01:37,  1.31s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:34<01:33,  1.28s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:35<01:30,  1.26s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:37<01:29,  1.27s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:38<01:28,  1.26s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:39<01:31,  1.32s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:41<01:29,  1.32s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:42<01:31,  1.37s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:43<01:26,  1.31s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:45<01:28,  1.37s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:46<01:23,  1.31s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:47<01:25,  1.35s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:49<01:21,  1.31s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:50<01:18,  1.28s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:51<01:19,  1.32s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:53<01:18,  1.33s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:54<01:14,  1.28s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:55<01:13,  1.29s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:56<01:12,  1.29s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:58<01:10,  1.28s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:59<01:09,  1.29s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:00<01:08,  1.28s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:01<01:05,  1.26s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:03<01:03,  1.25s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:04<01:01,  1.23s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:05<01:01,  1.25s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:06<00:59,  1.25s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:08<01:02,  1.33s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:10<01:05,  1.43s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:11<01:04,  1.44s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:12<01:00,  1.36s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:14<01:01,  1.43s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:15<00:58,  1.38s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:16<00:55,  1.36s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:18<00:57,  1.44s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:20<00:58,  1.50s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:21<00:59,  1.57s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:23<00:58,  1.58s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:25<00:57,  1.60s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:26<00:56,  1.62s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:28<00:56,  1.68s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:30<00:57,  1.76s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:32<00:54,  1.72s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:33<00:53,  1.74s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:35<00:50,  1.69s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:37<00:48,  1.66s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:38<00:48,  1.72s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:40<00:45,  1.68s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:42<00:44,  1.70s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:44<00:43,  1.72s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:45<00:40,  1.67s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:46<00:36,  1.57s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:48<00:33,  1.52s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:49<00:32,  1.54s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:51<00:29,  1.49s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:53<00:30,  1.59s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:54<00:27,  1.52s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:56<00:26,  1.56s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:57<00:22,  1.42s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:58<00:20,  1.39s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:59<00:18,  1.33s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:00<00:16,  1.28s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:02<00:15,  1.28s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:03<00:14,  1.30s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:04<00:13,  1.33s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:06<00:12,  1.35s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:07<00:11,  1.43s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:09<00:10,  1.50s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:11<00:08,  1.50s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:12<00:07,  1.45s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:13<00:05,  1.40s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:15<00:04,  1.38s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:16<00:02,  1.38s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:17<00:01,  1.33s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:18<00:00,  1.32s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:18<00:00,  1.39s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.019 MB of 0.025 MB uploadedwandb: \ 0.019 MB of 0.025 MB uploadedwandb: | 0.019 MB of 0.025 MB uploadedwandb: / 0.019 MB of 0.025 MB uploadedwandb: - 0.019 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.21677
wandb: 
wandb: üöÄ View run prime-sweep-191 at: https://wandb.ai/xzy11632/dance-dev/runs/evy7v960
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_165602-evy7v960/logs
wandb: Agent Starting Run: typ1q6x5 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_165934-typ1q6x5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run drawn-sweep-192
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/typ1q6x5
[INFO][2024-03-16 16:59:39,765][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 16:59:39,891][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 16:59:39,892][dance][wrapped_func] Took 0:00:00.125858 to load and process data.
[INFO][2024-03-16 16:59:39,892][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 16:59:39,894][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 16:59:39,915][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 16:59:39,916][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 16:59:42,141][dance.WeightedFeatureSVD][__call__] Decomposing train features (8057, 200) (k=95)
[INFO][2024-03-16 16:59:42,146][dance.WeightedFeatureSVD][__call__] Total explained variance: 96.23%
[INFO][2024-03-16 16:59:44,072][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 16:59:44,073][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 16:59:44,073][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 16:59:44,073][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:06,  1.28s/it]  2%|‚ñè         | 2/100 [00:02<01:55,  1.18s/it]  3%|‚ñé         | 3/100 [00:03<02:02,  1.26s/it]  4%|‚ñç         | 4/100 [00:05<02:06,  1.32s/it]  5%|‚ñå         | 5/100 [00:06<02:03,  1.30s/it]  6%|‚ñå         | 6/100 [00:07<02:02,  1.30s/it]  7%|‚ñã         | 7/100 [00:09<02:02,  1.31s/it]  8%|‚ñä         | 8/100 [00:10<01:57,  1.28s/it]  9%|‚ñâ         | 9/100 [00:11<01:58,  1.30s/it] 10%|‚ñà         | 10/100 [00:12<01:57,  1.31s/it] 11%|‚ñà         | 11/100 [00:14<01:56,  1.31s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:55,  1.31s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:55,  1.32s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<01:54,  1.33s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<01:53,  1.34s/it] 16%|‚ñà‚ñå        | 16/100 [00:21<01:55,  1.38s/it] 17%|‚ñà‚ñã        | 17/100 [00:22<01:54,  1.38s/it] 18%|‚ñà‚ñä        | 18/100 [00:23<01:50,  1.35s/it] 19%|‚ñà‚ñâ        | 19/100 [00:25<01:48,  1.34s/it] 20%|‚ñà‚ñà        | 20/100 [00:26<01:48,  1.36s/it] 21%|‚ñà‚ñà        | 21/100 [00:27<01:48,  1.37s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:29<01:44,  1.34s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:30<01:48,  1.42s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:31<01:43,  1.37s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:33<01:49,  1.46s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:35<01:53,  1.54s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:36<01:52,  1.54s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:38<01:45,  1.46s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:39<01:40,  1.41s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:40<01:38,  1.41s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:42<01:40,  1.46s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:44<01:44,  1.53s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:45<01:41,  1.51s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:47<01:42,  1.55s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:48<01:39,  1.53s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:50<01:38,  1.54s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:51<01:32,  1.46s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:52<01:26,  1.40s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:54<01:22,  1.35s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:55<01:19,  1.33s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:56<01:17,  1.32s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:57<01:15,  1.31s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:59<01:14,  1.31s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:00<01:12,  1.29s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:01<01:10,  1.28s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:03<01:08,  1.27s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:04<01:10,  1.33s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:05<01:09,  1.33s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:07<01:08,  1.33s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:08<01:06,  1.33s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:10<01:10,  1.43s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:11<01:08,  1.42s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:12<01:06,  1.41s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:14<01:04,  1.40s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:15<01:05,  1.45s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:17<01:04,  1.47s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:18<01:00,  1.42s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:20<00:58,  1.39s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:21<00:56,  1.38s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:22<00:55,  1.38s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:24<00:55,  1.43s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:26<00:57,  1.52s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:27<00:58,  1.58s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:29<00:58,  1.64s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:31<00:58,  1.68s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:33<00:58,  1.73s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:35<01:07,  2.05s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:37<01:00,  1.89s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:38<00:53,  1.72s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:40<00:47,  1.57s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:41<00:43,  1.51s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:42<00:41,  1.47s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:44<00:39,  1.46s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:45<00:36,  1.40s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:46<00:34,  1.40s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:48<00:32,  1.37s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:49<00:31,  1.36s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:50<00:29,  1.36s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:52<00:28,  1.35s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:53<00:26,  1.34s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:54<00:25,  1.35s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:56<00:23,  1.33s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:57<00:23,  1.37s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:58<00:21,  1.36s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:00<00:20,  1.34s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:01<00:18,  1.32s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:02<00:17,  1.33s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:04<00:16,  1.40s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:05<00:15,  1.37s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:07<00:13,  1.36s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:08<00:12,  1.44s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:09<00:11,  1.39s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:11<00:09,  1.38s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:13<00:08,  1.50s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:14<00:07,  1.59s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:16<00:06,  1.60s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:18<00:05,  1.67s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:19<00:03,  1.60s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:21<00:01,  1.66s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:23<00:00,  1.67s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:23<00:00,  1.43s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.22026
wandb: 
wandb: üöÄ View run drawn-sweep-192 at: https://wandb.ai/xzy11632/dance-dev/runs/typ1q6x5
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_165934-typ1q6x5/logs
wandb: Agent Starting Run: hmddksif with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_170259-hmddksif
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fanciful-sweep-193
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/hmddksif
[INFO][2024-03-16 17:03:05,044][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 17:03:05,175][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 17:03:05,176][dance][wrapped_func] Took 0:00:00.131163 to load and process data.
[INFO][2024-03-16 17:03:05,176][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 17:03:05,179][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 17:03:05,199][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:03:05,200][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:03:05,200][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:03:05,200][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:03:05,313][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:03:05,314][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 17:03:06,806][dance.WeightedFeaturePCA][__call__] Decomposing train features (8057, 1000) (k=2)
[INFO][2024-03-16 17:03:06,807][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.12%
[INFO][2024-03-16 17:03:09,123][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 17:03:09,123][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 17:03:09,124][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 17:03:09,124][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:02,  1.23s/it]  2%|‚ñè         | 2/100 [00:02<01:56,  1.19s/it]  3%|‚ñé         | 3/100 [00:03<01:55,  1.19s/it]  4%|‚ñç         | 4/100 [00:04<01:54,  1.19s/it]  5%|‚ñå         | 5/100 [00:06<01:55,  1.21s/it]  6%|‚ñå         | 6/100 [00:07<01:57,  1.25s/it]  7%|‚ñã         | 7/100 [00:08<01:58,  1.27s/it]  8%|‚ñä         | 8/100 [00:10<02:00,  1.31s/it]  9%|‚ñâ         | 9/100 [00:11<01:57,  1.29s/it] 10%|‚ñà         | 10/100 [00:12<01:57,  1.31s/it] 11%|‚ñà         | 11/100 [00:14<01:58,  1.33s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<02:13,  1.51s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<02:06,  1.45s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<02:00,  1.41s/it] 15%|‚ñà‚ñå        | 15/100 [00:20<02:00,  1.41s/it] 16%|‚ñà‚ñå        | 16/100 [00:21<01:56,  1.38s/it] 17%|‚ñà‚ñã        | 17/100 [00:22<01:55,  1.39s/it] 18%|‚ñà‚ñä        | 18/100 [00:24<01:52,  1.38s/it] 19%|‚ñà‚ñâ        | 19/100 [00:25<01:50,  1.37s/it] 20%|‚ñà‚ñà        | 20/100 [00:26<01:48,  1.36s/it] 21%|‚ñà‚ñà        | 21/100 [00:28<01:45,  1.33s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:29<01:42,  1.32s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:30<01:42,  1.33s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:31<01:38,  1.30s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:33<01:36,  1.29s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:34<01:41,  1.37s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:36<01:44,  1.43s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:37<01:40,  1.39s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:39<01:39,  1.41s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:40<01:39,  1.42s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:41<01:35,  1.38s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:43<01:35,  1.41s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:44<01:35,  1.43s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:46<01:31,  1.39s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:47<01:28,  1.37s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:48<01:29,  1.39s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:50<01:28,  1.40s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:51<01:26,  1.40s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:53<01:31,  1.50s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:55<01:37,  1.62s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:57<01:40,  1.70s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:58<01:41,  1.75s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:00<01:40,  1.77s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:02<01:41,  1.82s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:04<01:35,  1.74s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:05<01:30,  1.67s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:07<01:24,  1.60s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:08<01:21,  1.57s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:10<01:26,  1.69s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:12<01:25,  1.71s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:14<01:25,  1.73s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:16<01:25,  1.78s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:17<01:23,  1.78s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:19<01:23,  1.81s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:21<01:17,  1.73s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:22<01:12,  1.65s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:24<01:09,  1.61s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:25<01:04,  1.53s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:27<01:00,  1.48s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:28<00:59,  1.48s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:30<00:59,  1.52s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:32<01:02,  1.65s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:33<00:58,  1.59s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:34<00:55,  1.53s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:36<00:53,  1.52s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:37<00:49,  1.46s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:39<00:47,  1.45s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:40<00:47,  1.50s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:42<00:45,  1.48s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:43<00:43,  1.44s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:45<00:42,  1.45s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:46<00:41,  1.48s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:48<00:39,  1.47s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:49<00:37,  1.44s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:50<00:35,  1.42s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:52<00:33,  1.39s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:53<00:31,  1.37s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:54<00:30,  1.40s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:56<00:29,  1.39s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:57<00:27,  1.37s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:58<00:25,  1.36s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:00<00:24,  1.37s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:01<00:23,  1.36s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:03<00:21,  1.37s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:04<00:20,  1.39s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:05<00:19,  1.38s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:07<00:17,  1.38s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:08<00:16,  1.38s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:09<00:15,  1.38s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:11<00:13,  1.37s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:13<00:13,  1.52s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:14<00:12,  1.59s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:16<00:11,  1.64s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:18<00:09,  1.62s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:19<00:07,  1.57s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:21<00:06,  1.50s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:22<00:04,  1.46s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:23<00:02,  1.43s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:25<00:01,  1.43s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:26<00:00,  1.43s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:26<00:00,  1.47s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.03156
wandb: 
wandb: üöÄ View run fanciful-sweep-193 at: https://wandb.ai/xzy11632/dance-dev/runs/hmddksif
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_170259-hmddksif/logs
wandb: Agent Starting Run: wl5yajuq with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_170630-wl5yajuq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run comfy-sweep-194
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/wl5yajuq
[INFO][2024-03-16 17:06:35,597][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 17:06:35,697][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 17:06:35,697][dance][wrapped_func] Took 0:00:00.098394 to load and process data.
[INFO][2024-03-16 17:06:35,697][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 17:06:35,700][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 17:06:35,718][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:06:35,719][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:06:35,719][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:06:35,720][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:06:35,809][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:06:35,810][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 17:06:39,781][dance.WeightedFeatureSVD][__call__] Decomposing train features (8057, 1000) (k=9)
[INFO][2024-03-16 17:06:39,781][dance.WeightedFeatureSVD][__call__] Total explained variance: 96.78%
[INFO][2024-03-16 17:06:42,063][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 17:06:42,063][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 17:06:42,063][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 17:06:42,063][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:06,  1.28s/it]  2%|‚ñè         | 2/100 [00:02<02:07,  1.30s/it]  3%|‚ñé         | 3/100 [00:03<02:05,  1.29s/it]  4%|‚ñç         | 4/100 [00:05<01:59,  1.24s/it]  5%|‚ñå         | 5/100 [00:06<01:54,  1.21s/it]  6%|‚ñå         | 6/100 [00:07<01:54,  1.22s/it]  7%|‚ñã         | 7/100 [00:08<01:58,  1.28s/it]  8%|‚ñä         | 8/100 [00:10<01:54,  1.25s/it]  9%|‚ñâ         | 9/100 [00:11<01:50,  1.22s/it] 10%|‚ñà         | 10/100 [00:12<01:56,  1.29s/it] 11%|‚ñà         | 11/100 [00:13<01:51,  1.25s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:49,  1.25s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:49,  1.26s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:46,  1.24s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:43,  1.22s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:42,  1.22s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:43,  1.24s/it] 18%|‚ñà‚ñä        | 18/100 [00:22<01:40,  1.23s/it] 19%|‚ñà‚ñâ        | 19/100 [00:23<01:38,  1.21s/it] 20%|‚ñà‚ñà        | 20/100 [00:24<01:35,  1.20s/it] 21%|‚ñà‚ñà        | 21/100 [00:25<01:35,  1.21s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:27<01:34,  1.21s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:28<01:34,  1.22s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:29<01:33,  1.23s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:30<01:31,  1.22s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:32<01:31,  1.24s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:33<01:31,  1.26s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:34<01:30,  1.26s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:35<01:29,  1.26s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:37<01:29,  1.28s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:38<01:29,  1.30s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:40<01:33,  1.37s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:41<01:30,  1.35s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:42<01:29,  1.36s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:44<01:27,  1.35s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:45<01:25,  1.34s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:46<01:24,  1.34s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:48<01:24,  1.36s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:49<01:26,  1.42s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:51<01:25,  1.42s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:52<01:24,  1.43s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:54<01:24,  1.45s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:55<01:21,  1.43s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:57<01:25,  1.52s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:58<01:23,  1.51s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:00<01:31,  1.70s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:02<01:35,  1.80s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:04<01:32,  1.78s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:06<01:29,  1.76s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:07<01:24,  1.70s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:09<01:19,  1.62s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:10<01:15,  1.57s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:12<01:12,  1.55s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:14<01:13,  1.60s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:15<01:12,  1.61s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:17<01:10,  1.59s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:18<01:09,  1.61s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:20<01:07,  1.61s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:22<01:05,  1.60s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:23<01:03,  1.59s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:25<01:00,  1.55s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:26<00:57,  1.52s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:28<00:56,  1.53s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:29<00:55,  1.53s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:31<00:54,  1.54s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:32<00:51,  1.50s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:34<00:50,  1.52s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:35<00:48,  1.50s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:37<00:46,  1.51s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:38<00:44,  1.49s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:40<00:43,  1.50s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:41<00:41,  1.48s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:43<00:40,  1.50s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:44<00:38,  1.48s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:46<00:37,  1.50s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:47<00:35,  1.48s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:49<00:34,  1.50s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:50<00:31,  1.45s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:51<00:29,  1.42s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:53<00:28,  1.45s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:54<00:27,  1.44s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:56<00:26,  1.47s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:57<00:24,  1.47s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:59<00:22,  1.44s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:00<00:21,  1.44s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:02<00:20,  1.48s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:03<00:19,  1.47s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:05<00:17,  1.48s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:06<00:16,  1.49s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:08<00:14,  1.49s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:09<00:13,  1.49s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:11<00:12,  1.55s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:12<00:10,  1.51s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:14<00:08,  1.49s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:15<00:07,  1.48s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:17<00:05,  1.50s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:18<00:04,  1.49s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:19<00:02,  1.47s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:21<00:01,  1.47s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:23<00:00,  1.49s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:23<00:00,  1.43s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.16757
wandb: 
wandb: üöÄ View run comfy-sweep-194 at: https://wandb.ai/xzy11632/dance-dev/runs/wl5yajuq
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_170630-wl5yajuq/logs
wandb: Agent Starting Run: s58b8vs8 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_171009-s58b8vs8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run major-sweep-195
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/s58b8vs8
[INFO][2024-03-16 17:10:14,683][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 17:10:14,809][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 17:10:14,809][dance][wrapped_func] Took 0:00:00.125039 to load and process data.
[INFO][2024-03-16 17:10:14,809][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 17:10:14,811][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 17:10:14,827][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:10:14,828][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:10:14,828][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:10:14,903][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 17:10:15,052][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.016 MB of 0.024 MB uploadedwandb: - 0.016 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run major-sweep-195 at: https://wandb.ai/xzy11632/dance-dev/runs/s58b8vs8
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_171009-s58b8vs8/logs
wandb: ERROR Run s58b8vs8 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1000) out of bounds (1000)
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: e1plox69 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_171035-e1plox69
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run balmy-sweep-196
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/e1plox69
[INFO][2024-03-16 17:10:40,884][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 17:10:41,023][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 17:10:41,023][dance][wrapped_func] Took 0:00:00.138750 to load and process data.
[INFO][2024-03-16 17:10:41,024][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 17:10:41,025][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 17:10:41,045][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:10:41,046][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:10:41,046][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:10:41,128][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 17:10:41,324][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.024 MB uploadedwandb: \ 0.018 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run balmy-sweep-196 at: https://wandb.ai/xzy11632/dance-dev/runs/e1plox69
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_171035-e1plox69/logs
wandb: ERROR Run e1plox69 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1000) out of bounds (1000)
wandb: ERROR 
wandb: Agent Starting Run: 9ftv57h5 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_171056-9ftv57h5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fiery-sweep-197
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/9ftv57h5
[INFO][2024-03-16 17:11:02,215][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 17:11:02,316][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 17:11:02,316][dance][wrapped_func] Took 0:00:00.100196 to load and process data.
[INFO][2024-03-16 17:11:02,316][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 17:11:02,318][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 17:11:02,337][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:11:02,338][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:11:02,338][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:11:02,416][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 17:11:02,660][dance.WeightedFeaturePCA][__call__] Decomposing train features (8057, 200) (k=5)
[INFO][2024-03-16 17:11:02,661][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.21%
[INFO][2024-03-16 17:11:04,664][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 17:11:04,664][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 17:11:04,664][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 17:11:04,664][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:34,  1.56s/it]  2%|‚ñè         | 2/100 [00:02<02:17,  1.40s/it]  3%|‚ñé         | 3/100 [00:04<02:09,  1.33s/it]  4%|‚ñç         | 4/100 [00:05<02:02,  1.28s/it]  5%|‚ñå         | 5/100 [00:06<01:59,  1.25s/it]  6%|‚ñå         | 6/100 [00:07<01:55,  1.23s/it]  7%|‚ñã         | 7/100 [00:09<01:59,  1.28s/it]  8%|‚ñä         | 8/100 [00:10<01:56,  1.27s/it]  9%|‚ñâ         | 9/100 [00:11<01:53,  1.25s/it] 10%|‚ñà         | 10/100 [00:12<01:52,  1.25s/it] 11%|‚ñà         | 11/100 [00:14<01:52,  1.26s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:51,  1.27s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:51,  1.28s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<01:52,  1.31s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<01:59,  1.41s/it] 16%|‚ñà‚ñå        | 16/100 [00:21<02:04,  1.49s/it] 17%|‚ñà‚ñã        | 17/100 [00:23<02:09,  1.56s/it] 18%|‚ñà‚ñä        | 18/100 [00:24<02:12,  1.61s/it] 19%|‚ñà‚ñâ        | 19/100 [00:26<02:17,  1.69s/it] 20%|‚ñà‚ñà        | 20/100 [00:28<02:17,  1.72s/it] 21%|‚ñà‚ñà        | 21/100 [00:30<02:14,  1.71s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:31<02:12,  1.69s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:33<02:16,  1.78s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:35<02:15,  1.79s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:37<02:08,  1.71s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:38<01:55,  1.56s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:39<01:47,  1.47s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:40<01:41,  1.41s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:42<01:37,  1.37s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:43<01:36,  1.38s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:44<01:33,  1.36s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:46<01:28,  1.31s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:47<01:27,  1.30s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:48<01:24,  1.29s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:49<01:22,  1.28s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:51<01:20,  1.25s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:52<01:16,  1.22s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:53<01:15,  1.22s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:54<01:14,  1.23s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:55<01:14,  1.25s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:57<01:12,  1.24s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:58<01:11,  1.23s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:59<01:10,  1.23s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:00<01:08,  1.22s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:02<01:07,  1.23s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:03<01:06,  1.22s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:04<01:05,  1.23s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:05<01:02,  1.20s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:06<01:01,  1.20s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:07<00:58,  1.17s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:09<00:57,  1.18s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:10<00:56,  1.19s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:11<00:55,  1.17s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:12<00:54,  1.18s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:13<00:52,  1.18s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:15<00:52,  1.19s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:16<00:51,  1.20s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:17<00:50,  1.21s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:18<00:50,  1.23s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:20<00:49,  1.24s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:21<00:47,  1.23s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:22<00:45,  1.20s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:23<00:45,  1.24s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:25<00:49,  1.36s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:26<00:48,  1.39s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:28<00:45,  1.33s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:29<00:42,  1.29s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:30<00:41,  1.28s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:31<00:39,  1.28s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:33<00:38,  1.27s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:34<00:36,  1.26s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:35<00:34,  1.24s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:36<00:33,  1.23s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:37<00:31,  1.19s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:38<00:29,  1.19s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:40<00:28,  1.19s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:41<00:27,  1.18s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:42<00:26,  1.18s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:43<00:25,  1.20s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:44<00:24,  1.23s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:46<00:23,  1.22s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:47<00:21,  1.21s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:48<00:20,  1.19s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:49<00:19,  1.20s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:51<00:18,  1.22s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:52<00:16,  1.21s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:53<00:15,  1.21s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:54<00:14,  1.24s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:55<00:13,  1.21s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:57<00:12,  1.21s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:58<00:10,  1.19s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:59<00:09,  1.19s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:00<00:08,  1.21s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:01<00:07,  1.19s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:03<00:05,  1.20s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:04<00:04,  1.18s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:05<00:03,  1.16s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:06<00:02,  1.17s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:07<00:01,  1.20s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:09<00:00,  1.25s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:09<00:00,  1.29s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.16711
wandb: 
wandb: üöÄ View run fiery-sweep-197 at: https://wandb.ai/xzy11632/dance-dev/runs/9ftv57h5
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_171056-9ftv57h5/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: ankpo1ua with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_171901-ankpo1ua
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run playful-sweep-198
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ankpo1ua
[INFO][2024-03-16 17:19:16,681][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 17:19:17,418][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 17:19:17,422][dance][wrapped_func] Took 0:00:00.739910 to load and process data.
[INFO][2024-03-16 17:19:17,425][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 17:19:17,436][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 17:19:17,493][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:19:17,505][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:19:17,512][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:19:18,148][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 17:19:39,166][dance.WeightedFeatureSVD][__call__] Decomposing train features (8057, 200) (k=6)
[INFO][2024-03-16 17:19:39,180][dance.WeightedFeatureSVD][__call__] Total explained variance: 91.11%
[INFO][2024-03-16 17:23:59,366][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 17:23:59,367][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 17:23:59,367][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 17:23:59,367][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:41,  1.03s/it]  2%|‚ñè         | 2/100 [00:04<03:56,  2.41s/it]  3%|‚ñé         | 3/100 [00:10<06:25,  3.97s/it]  4%|‚ñç         | 4/100 [00:16<07:37,  4.76s/it]  5%|‚ñå         | 5/100 [00:22<08:16,  5.23s/it]  6%|‚ñå         | 6/100 [00:27<08:25,  5.37s/it]  7%|‚ñã         | 7/100 [00:35<09:15,  5.97s/it]  8%|‚ñä         | 8/100 [00:42<09:50,  6.42s/it]  9%|‚ñâ         | 9/100 [00:50<10:34,  6.97s/it] 10%|‚ñà         | 10/100 [00:56<09:52,  6.58s/it] 11%|‚ñà         | 11/100 [01:02<09:40,  6.52s/it] 12%|‚ñà‚ñè        | 12/100 [01:09<09:46,  6.66s/it] 13%|‚ñà‚ñé        | 13/100 [01:15<09:16,  6.40s/it] 14%|‚ñà‚ñç        | 14/100 [01:21<09:07,  6.36s/it] 15%|‚ñà‚ñå        | 15/100 [01:29<09:23,  6.63s/it] 16%|‚ñà‚ñå        | 16/100 [01:34<08:43,  6.24s/it] 17%|‚ñà‚ñã        | 17/100 [01:39<08:13,  5.95s/it] 18%|‚ñà‚ñä        | 18/100 [01:46<08:25,  6.16s/it] 19%|‚ñà‚ñâ        | 19/100 [01:52<08:09,  6.04s/it] 20%|‚ñà‚ñà        | 20/100 [01:54<06:28,  4.86s/it] 21%|‚ñà‚ñà        | 21/100 [01:55<04:54,  3.73s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [01:58<04:38,  3.57s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [02:04<05:25,  4.23s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [02:10<06:14,  4.93s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [02:17<06:48,  5.45s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [02:25<07:30,  6.09s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [02:31<07:41,  6.32s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [02:38<07:48,  6.51s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [02:46<07:58,  6.74s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [02:53<08:01,  6.88s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [03:00<08:06,  7.05s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [03:09<08:27,  7.46s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [03:16<08:25,  7.54s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [03:24<08:19,  7.56s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [03:32<08:10,  7.54s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [03:39<07:58,  7.47s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [03:40<05:50,  5.57s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [03:41<04:26,  4.30s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [03:42<03:22,  3.32s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [03:44<02:41,  2.69s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [03:45<02:10,  2.22s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [03:46<01:50,  1.91s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [03:47<01:37,  1.70s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [03:48<01:28,  1.58s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [03:50<01:22,  1.50s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [03:51<01:17,  1.43s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [03:52<01:12,  1.37s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [03:53<01:08,  1.31s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [03:55<01:05,  1.28s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [03:56<01:03,  1.27s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [03:57<01:01,  1.26s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [03:58<00:59,  1.24s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [03:59<00:56,  1.21s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [04:01<00:53,  1.17s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [04:02<00:53,  1.19s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [04:03<00:52,  1.20s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [04:04<00:53,  1.24s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [04:07<01:03,  1.52s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [04:09<01:20,  1.95s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [04:11<01:18,  1.96s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [04:13<01:06,  1.71s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [04:14<00:58,  1.54s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [04:15<00:50,  1.38s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [04:16<00:45,  1.27s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [04:18<00:51,  1.47s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [04:20<00:55,  1.64s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [04:22<00:59,  1.81s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [04:24<01:00,  1.89s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [04:26<01:00,  1.95s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [04:28<00:59,  1.99s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [04:30<01:00,  2.07s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [04:33<00:59,  2.12s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [04:34<00:53,  1.97s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [04:35<00:43,  1.69s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [04:36<00:37,  1.50s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [04:37<00:32,  1.36s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [04:38<00:29,  1.27s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [04:40<00:26,  1.22s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [04:41<00:24,  1.16s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [04:42<00:22,  1.12s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [04:43<00:21,  1.13s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [04:44<00:21,  1.20s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [04:45<00:20,  1.21s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [04:47<00:19,  1.21s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [04:48<00:18,  1.21s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [04:49<00:16,  1.21s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [04:50<00:16,  1.30s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [04:52<00:18,  1.51s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [04:54<00:16,  1.54s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [04:56<00:15,  1.59s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [04:58<00:15,  1.67s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [04:59<00:12,  1.62s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [05:01<00:11,  1.65s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [05:03<00:10,  1.71s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [05:05<00:08,  1.77s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [05:06<00:07,  1.78s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [05:08<00:05,  1.82s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [05:10<00:03,  1.77s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [05:12<00:01,  1.81s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [05:14<00:00,  1.90s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [05:14<00:00,  3.15s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.16239
wandb: 
wandb: üöÄ View run playful-sweep-198 at: https://wandb.ai/xzy11632/dance-dev/runs/ankpo1ua
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_171901-ankpo1ua/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: h8wmdna0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_173121-h8wmdna0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run elated-sweep-199
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/h8wmdna0
[INFO][2024-03-16 17:31:29,208][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 17:31:29,326][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 17:31:29,326][dance][wrapped_func] Took 0:00:00.117570 to load and process data.
[INFO][2024-03-16 17:31:29,327][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 17:31:29,330][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 17:31:29,354][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:31:29,355][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:31:29,356][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:31:29,430][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.021 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run elated-sweep-199 at: https://wandb.ai/xzy11632/dance-dev/runs/h8wmdna0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_173121-h8wmdna0/logs
wandb: ERROR Run h8wmdna0 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: 275g279m with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_173143-275g279m
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glamorous-sweep-200
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/275g279m
[INFO][2024-03-16 17:31:50,095][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 17:31:50,142][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 17:31:50,142][dance][wrapped_func] Took 0:00:00.046753 to load and process data.
[INFO][2024-03-16 17:31:50,143][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 17:31:50,145][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 17:31:50,163][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:31:50,164][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:31:50,165][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:31:50,211][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run glamorous-sweep-200 at: https://wandb.ai/xzy11632/dance-dev/runs/275g279m
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_173143-275g279m/logs
wandb: ERROR Run 275g279m errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: ywujc6aa with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_173204-ywujc6aa
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run misty-sweep-201
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ywujc6aa
[INFO][2024-03-16 17:32:12,613][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 17:32:12,719][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 17:32:12,720][dance][wrapped_func] Took 0:00:00.106707 to load and process data.
[INFO][2024-03-16 17:32:12,720][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 17:32:12,723][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 17:32:12,747][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:32:12,749][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:32:12,750][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:32:12,822][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run misty-sweep-201 at: https://wandb.ai/xzy11632/dance-dev/runs/ywujc6aa
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_173204-ywujc6aa/logs
wandb: ERROR Run ywujc6aa errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: lnxpwnqp with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_173226-lnxpwnqp
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run bright-sweep-202
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/lnxpwnqp
[INFO][2024-03-16 17:32:34,216][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 17:32:34,400][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 17:32:34,406][dance][wrapped_func] Took 0:00:00.188313 to load and process data.
[INFO][2024-03-16 17:32:34,406][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 17:32:34,409][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 17:32:34,487][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:32:34,489][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:32:34,490][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:32:34,585][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run bright-sweep-202 at: https://wandb.ai/xzy11632/dance-dev/runs/lnxpwnqp
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_173226-lnxpwnqp/logs
wandb: ERROR Run lnxpwnqp errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: rppxztb6 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_173257-rppxztb6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run spring-sweep-203
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/rppxztb6
[INFO][2024-03-16 17:33:04,989][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 17:33:05,110][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 17:33:05,110][dance][wrapped_func] Took 0:00:00.120820 to load and process data.
[INFO][2024-03-16 17:33:05,111][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 17:33:05,114][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 17:33:05,140][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:33:05,141][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:33:05,143][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:33:05,235][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 17:33:06,865][dance.WeightedFeaturePCA][__call__] Decomposing train features (8057, 200) (k=4)
[INFO][2024-03-16 17:33:06,867][dance.WeightedFeaturePCA][__call__] Total explained variance: 91.67%
[INFO][2024-03-16 17:42:25,684][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 17:42:25,686][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 17:42:25,686][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 17:42:25,686][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:07,  1.28s/it]  2%|‚ñè         | 2/100 [00:03<02:43,  1.67s/it]  3%|‚ñé         | 3/100 [00:04<02:43,  1.68s/it]  4%|‚ñç         | 4/100 [00:06<02:41,  1.68s/it]  5%|‚ñå         | 5/100 [00:08<02:43,  1.72s/it]  6%|‚ñå         | 6/100 [00:10<02:47,  1.78s/it]  7%|‚ñã         | 7/100 [00:11<02:41,  1.74s/it]  8%|‚ñä         | 8/100 [00:13<02:41,  1.75s/it]  9%|‚ñâ         | 9/100 [00:15<02:34,  1.69s/it] 10%|‚ñà         | 10/100 [00:16<02:30,  1.68s/it] 11%|‚ñà         | 11/100 [00:18<02:24,  1.62s/it] 12%|‚ñà‚ñè        | 12/100 [00:20<02:27,  1.68s/it] 13%|‚ñà‚ñé        | 13/100 [00:22<02:32,  1.76s/it] 14%|‚ñà‚ñç        | 14/100 [00:23<02:26,  1.70s/it] 15%|‚ñà‚ñå        | 15/100 [00:25<02:24,  1.70s/it] 16%|‚ñà‚ñå        | 16/100 [00:27<02:24,  1.72s/it] 17%|‚ñà‚ñã        | 17/100 [00:29<02:29,  1.80s/it] 18%|‚ñà‚ñä        | 18/100 [00:31<02:28,  1.81s/it] 19%|‚ñà‚ñâ        | 19/100 [00:32<02:23,  1.77s/it] 20%|‚ñà‚ñà        | 20/100 [00:34<02:19,  1.74s/it] 21%|‚ñà‚ñà        | 21/100 [00:36<02:20,  1.77s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:37<02:16,  1.75s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:39<02:12,  1.72s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:41<02:14,  1.77s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:42<02:06,  1.69s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:44<02:07,  1.73s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:46<02:05,  1.72s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:48<02:09,  1.80s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:50<02:07,  1.80s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:51<02:02,  1.75s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:53<01:58,  1.72s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:55<01:58,  1.74s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:57<01:56,  1.73s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:58<01:53,  1.72s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:00<01:52,  1.74s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:02<01:49,  1.72s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:03<01:45,  1.68s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:05<01:41,  1.63s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:06<01:40,  1.64s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:08<01:44,  1.74s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:10<01:42,  1.74s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:12<01:40,  1.72s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:14<01:38,  1.74s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:15<01:33,  1.67s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:17<01:30,  1.64s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:18<01:29,  1.66s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:20<01:30,  1.70s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:22<01:25,  1.65s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:23<01:22,  1.61s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:25<01:20,  1.61s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:26<01:17,  1.57s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:28<01:16,  1.60s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:30<01:15,  1.60s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:31<01:11,  1.56s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:33<01:13,  1.63s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:35<01:11,  1.63s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:36<01:10,  1.63s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:38<01:12,  1.72s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:40<01:10,  1.71s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:42<01:09,  1.73s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:43<01:05,  1.69s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:45<01:02,  1.65s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:46<00:59,  1.61s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:48<01:02,  1.73s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:50<01:00,  1.73s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:52<00:57,  1.70s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:53<00:55,  1.68s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:55<00:54,  1.70s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:57<00:51,  1.65s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:58<00:50,  1.68s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:00<00:50,  1.73s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:02<00:47,  1.71s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:03<00:45,  1.68s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:05<00:44,  1.73s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:07<00:44,  1.77s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:09<00:41,  1.75s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:10<00:39,  1.72s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:12<00:38,  1.76s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:14<00:36,  1.74s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:16<00:35,  1.77s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:18<00:33,  1.76s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:19<00:32,  1.80s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:21<00:28,  1.68s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:23<00:27,  1.70s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:24<00:25,  1.72s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:26<00:24,  1.76s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:28<00:21,  1.69s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:29<00:20,  1.68s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:31<00:18,  1.66s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:33<00:16,  1.65s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:34<00:14,  1.65s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:36<00:13,  1.73s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:37<00:11,  1.59s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:39<00:08,  1.46s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:41<00:07,  1.59s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:42<00:06,  1.67s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:44<00:04,  1.64s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:45<00:03,  1.60s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:47<00:01,  1.60s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:49<00:00,  1.64s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:49<00:00,  1.69s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.11445
wandb: 
wandb: üöÄ View run spring-sweep-203 at: https://wandb.ai/xzy11632/dance-dev/runs/rppxztb6
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_173257-rppxztb6/logs
wandb: Agent Starting Run: 8iuhyldo with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_174706-8iuhyldo
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run floral-sweep-204
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/8iuhyldo
[INFO][2024-03-16 17:47:14,700][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 17:47:14,792][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 17:47:14,793][dance][wrapped_func] Took 0:00:00.091901 to load and process data.
[INFO][2024-03-16 17:47:14,793][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 17:47:14,796][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 17:47:14,816][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:47:14,817][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:47:14,818][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:47:14,875][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 17:47:35,671][dance.WeightedFeatureSVD][__call__] Decomposing train features (8057, 200) (k=8)
[INFO][2024-03-16 17:47:35,672][dance.WeightedFeatureSVD][__call__] Total explained variance: 95.34%
[INFO][2024-03-16 17:53:35,245][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 17:53:35,246][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 17:53:35,247][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 17:53:35,247][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:05,  1.27s/it]  2%|‚ñè         | 2/100 [00:02<02:17,  1.40s/it]  3%|‚ñé         | 3/100 [00:04<02:16,  1.41s/it]  4%|‚ñç         | 4/100 [00:05<02:12,  1.38s/it]  5%|‚ñå         | 5/100 [00:06<02:10,  1.38s/it]  6%|‚ñå         | 6/100 [00:08<02:17,  1.46s/it]  7%|‚ñã         | 7/100 [00:10<02:26,  1.57s/it]  8%|‚ñä         | 8/100 [00:12<02:40,  1.75s/it]  9%|‚ñâ         | 9/100 [00:14<02:42,  1.78s/it] 10%|‚ñà         | 10/100 [00:16<02:44,  1.83s/it] 11%|‚ñà         | 11/100 [00:18<02:45,  1.87s/it] 12%|‚ñà‚ñè        | 12/100 [00:20<02:47,  1.90s/it] 13%|‚ñà‚ñé        | 13/100 [00:22<02:49,  1.95s/it] 14%|‚ñà‚ñç        | 14/100 [00:24<02:47,  1.94s/it] 15%|‚ñà‚ñå        | 15/100 [00:25<02:40,  1.88s/it] 16%|‚ñà‚ñå        | 16/100 [00:27<02:36,  1.86s/it] 17%|‚ñà‚ñã        | 17/100 [00:29<02:33,  1.85s/it] 18%|‚ñà‚ñä        | 18/100 [00:31<02:37,  1.92s/it] 19%|‚ñà‚ñâ        | 19/100 [00:33<02:40,  1.98s/it] 20%|‚ñà‚ñà        | 20/100 [00:35<02:35,  1.94s/it] 21%|‚ñà‚ñà        | 21/100 [00:37<02:29,  1.89s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:39<02:26,  1.88s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:41<02:28,  1.93s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:43<02:26,  1.93s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:45<02:25,  1.94s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:47<02:21,  1.92s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:49<02:22,  1.95s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:51<02:21,  1.96s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:52<02:05,  1.77s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:53<01:55,  1.64s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:55<01:49,  1.59s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:56<01:46,  1.56s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:58<01:48,  1.62s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:00<01:47,  1.63s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:01<01:42,  1.57s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:02<01:37,  1.53s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:04<01:38,  1.56s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:06<01:39,  1.60s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:07<01:38,  1.62s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:09<01:39,  1.66s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:11<01:37,  1.65s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:13<01:38,  1.69s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:14<01:37,  1.71s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:16<01:35,  1.70s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:18<01:32,  1.69s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:19<01:32,  1.71s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:21<01:27,  1.65s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:23<01:27,  1.68s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:24<01:25,  1.68s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:26<01:24,  1.69s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:28<01:22,  1.68s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:29<01:20,  1.68s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:31<01:15,  1.62s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:32<01:12,  1.58s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:34<01:10,  1.58s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:36<01:11,  1.63s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:37<01:08,  1.59s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:39<01:07,  1.60s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:40<01:05,  1.59s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:42<01:06,  1.67s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:44<01:06,  1.70s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:46<01:05,  1.73s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:48<01:09,  1.89s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:50<01:10,  1.97s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:53<01:11,  2.05s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:54<01:08,  2.00s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:56<01:05,  1.99s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:59<01:06,  2.09s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:01<01:04,  2.07s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:03<01:02,  2.08s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:05<00:58,  2.02s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:07<00:56,  2.00s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:09<00:54,  2.00s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:11<00:50,  1.96s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:12<00:47,  1.90s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:15<00:50,  2.10s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:17<00:47,  2.06s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:19<00:44,  2.01s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:20<00:40,  1.94s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:23<00:40,  2.02s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:24<00:36,  1.94s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:26<00:34,  1.93s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:28<00:31,  1.88s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:30<00:30,  1.89s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:32<00:28,  1.91s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:34<00:28,  2.04s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:37<00:27,  2.12s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:39<00:24,  2.06s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:41<00:22,  2.07s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:43<00:20,  2.01s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:45<00:18,  2.01s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:46<00:15,  1.96s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:48<00:13,  1.96s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:50<00:11,  1.98s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:52<00:10,  2.02s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:54<00:07,  1.95s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:56<00:05,  1.93s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:58<00:04,  2.01s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [03:01<00:02,  2.13s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:03<00:00,  2.08s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:03<00:00,  1.83s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.013 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.2374
wandb: 
wandb: üöÄ View run floral-sweep-204 at: https://wandb.ai/xzy11632/dance-dev/runs/8iuhyldo
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_174706-8iuhyldo/logs
wandb: Agent Starting Run: nbu7yo1s with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_175834-nbu7yo1s
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dashing-sweep-205
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/nbu7yo1s
[INFO][2024-03-16 17:58:42,226][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 17:58:42,324][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 17:58:42,325][dance][wrapped_func] Took 0:00:00.097632 to load and process data.
[INFO][2024-03-16 17:58:42,325][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 17:58:42,328][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 17:58:42,381][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:58:42,382][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:58:42,383][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 17:58:42,598][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 17:58:52,947][dance.WeightedFeaturePCA][__call__] Decomposing train features (8057, 1000) (k=3)
[INFO][2024-03-16 17:58:52,954][dance.WeightedFeaturePCA][__call__] Total explained variance: 92.64%
[INFO][2024-03-16 18:01:42,070][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 18:01:42,072][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 18:01:42,072][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 18:01:42,072][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:02<03:25,  2.08s/it]  2%|‚ñè         | 2/100 [00:04<03:47,  2.32s/it]  3%|‚ñé         | 3/100 [00:07<04:02,  2.50s/it]  4%|‚ñç         | 4/100 [00:10<04:20,  2.72s/it]  5%|‚ñå         | 5/100 [00:13<04:21,  2.76s/it]  6%|‚ñå         | 6/100 [00:16<04:28,  2.86s/it]  7%|‚ñã         | 7/100 [00:19<04:32,  2.93s/it]  8%|‚ñä         | 8/100 [00:22<04:35,  2.99s/it]  9%|‚ñâ         | 9/100 [00:25<04:32,  2.99s/it] 10%|‚ñà         | 10/100 [00:28<04:40,  3.11s/it] 11%|‚ñà         | 11/100 [00:31<04:33,  3.08s/it] 12%|‚ñà‚ñè        | 12/100 [00:34<04:27,  3.04s/it] 13%|‚ñà‚ñé        | 13/100 [00:38<04:36,  3.18s/it] 14%|‚ñà‚ñç        | 14/100 [00:41<04:24,  3.07s/it] 15%|‚ñà‚ñå        | 15/100 [00:44<04:18,  3.05s/it] 16%|‚ñà‚ñå        | 16/100 [00:47<04:22,  3.12s/it] 17%|‚ñà‚ñã        | 17/100 [00:50<04:18,  3.12s/it] 18%|‚ñà‚ñä        | 18/100 [00:53<04:11,  3.07s/it] 19%|‚ñà‚ñâ        | 19/100 [00:56<04:06,  3.04s/it] 20%|‚ñà‚ñà        | 20/100 [00:59<04:01,  3.02s/it] 21%|‚ñà‚ñà        | 21/100 [01:02<03:56,  3.00s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [01:05<03:54,  3.00s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [01:08<04:02,  3.15s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [01:11<03:56,  3.11s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [01:14<03:51,  3.08s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [01:17<03:46,  3.06s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [01:20<03:40,  3.02s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [01:23<03:34,  2.98s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [01:26<03:31,  2.97s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [01:29<03:29,  2.99s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [01:32<03:22,  2.93s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:35<03:22,  2.98s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:39<03:34,  3.21s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:42<03:38,  3.31s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:46<03:35,  3.32s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:49<03:35,  3.36s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:52<03:28,  3.30s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:55<03:20,  3.23s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:59<03:16,  3.22s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [02:02<03:12,  3.22s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [02:05<03:11,  3.24s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [02:08<03:06,  3.22s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [02:12<03:04,  3.23s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [02:15<03:01,  3.24s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [02:18<02:58,  3.25s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [02:22<02:59,  3.33s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [02:25<02:59,  3.39s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [02:28<02:54,  3.36s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [02:32<02:50,  3.35s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [02:35<02:44,  3.28s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [02:38<02:41,  3.29s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [02:41<02:37,  3.27s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [02:44<02:31,  3.21s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [02:48<02:27,  3.22s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [02:51<02:25,  3.23s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [02:54<02:17,  3.13s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [02:56<02:04,  2.90s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [02:59<02:01,  2.89s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [03:02<01:58,  2.89s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [03:05<01:56,  2.91s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [03:08<01:57,  3.02s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [03:11<01:51,  2.95s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [03:14<01:52,  3.04s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [03:18<01:53,  3.16s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [03:21<01:52,  3.22s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [03:24<01:43,  3.04s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [03:27<01:40,  3.05s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [03:30<01:41,  3.17s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [03:33<01:37,  3.15s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [03:37<01:38,  3.28s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [03:40<01:35,  3.30s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [03:43<01:31,  3.27s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [03:47<01:28,  3.26s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [03:50<01:23,  3.23s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [03:53<01:18,  3.13s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [03:56<01:14,  3.10s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [03:59<01:11,  3.13s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [04:02<01:06,  3.01s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [04:05<01:03,  3.03s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [04:08<01:02,  3.12s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [04:11<00:59,  3.13s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [04:14<00:55,  3.10s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [04:18<00:54,  3.21s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [04:21<00:51,  3.21s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [04:25<00:50,  3.35s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [04:28<00:47,  3.36s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [04:31<00:44,  3.40s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [04:35<00:40,  3.35s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [04:38<00:36,  3.32s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [04:41<00:32,  3.29s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [04:44<00:29,  3.23s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [04:48<00:25,  3.25s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [04:51<00:23,  3.32s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [04:54<00:19,  3.25s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [04:58<00:16,  3.30s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [05:01<00:12,  3.23s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [05:03<00:09,  3.13s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [05:07<00:06,  3.13s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [05:10<00:03,  3.14s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [05:13<00:00,  3.22s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [05:13<00:00,  3.14s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.07571
wandb: 
wandb: üöÄ View run dashing-sweep-205 at: https://wandb.ai/xzy11632/dance-dev/runs/nbu7yo1s
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_175834-nbu7yo1s/logs
wandb: Agent Starting Run: n4s54j7k with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_180845-n4s54j7k
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run apricot-sweep-206
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/n4s54j7k
[INFO][2024-03-16 18:08:50,137][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 18:08:50,232][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 18:08:50,232][dance][wrapped_func] Took 0:00:00.093100 to load and process data.
[INFO][2024-03-16 18:08:50,232][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 18:08:50,235][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 18:08:50,250][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 18:08:50,251][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 18:08:50,251][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 18:08:50,355][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 18:08:55,551][dance.WeightedFeatureSVD][__call__] Decomposing train features (8057, 1000) (k=12)
[INFO][2024-03-16 18:08:55,557][dance.WeightedFeatureSVD][__call__] Total explained variance: 96.70%
[INFO][2024-03-16 18:08:58,750][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 18:08:58,750][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 18:08:58,751][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 18:08:58,751][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:50,  1.73s/it]  2%|‚ñè         | 2/100 [00:03<02:41,  1.64s/it]  3%|‚ñé         | 3/100 [00:05<02:46,  1.71s/it]  4%|‚ñç         | 4/100 [00:06<02:44,  1.71s/it]  5%|‚ñå         | 5/100 [00:08<02:49,  1.78s/it]  6%|‚ñå         | 6/100 [00:10<02:45,  1.76s/it]  7%|‚ñã         | 7/100 [00:12<02:40,  1.72s/it]  8%|‚ñä         | 8/100 [00:13<02:31,  1.65s/it]  9%|‚ñâ         | 9/100 [00:14<02:21,  1.56s/it] 10%|‚ñà         | 10/100 [00:16<02:20,  1.56s/it] 11%|‚ñà         | 11/100 [00:18<02:23,  1.61s/it] 12%|‚ñà‚ñè        | 12/100 [00:19<02:19,  1.59s/it] 13%|‚ñà‚ñé        | 13/100 [00:21<02:17,  1.58s/it] 14%|‚ñà‚ñç        | 14/100 [00:23<02:23,  1.67s/it] 15%|‚ñà‚ñå        | 15/100 [00:24<02:21,  1.66s/it] 16%|‚ñà‚ñå        | 16/100 [00:26<02:12,  1.58s/it] 17%|‚ñà‚ñã        | 17/100 [00:27<02:11,  1.59s/it] 18%|‚ñà‚ñä        | 18/100 [00:29<02:05,  1.52s/it] 19%|‚ñà‚ñâ        | 19/100 [00:30<02:09,  1.60s/it] 20%|‚ñà‚ñà        | 20/100 [00:32<02:09,  1.62s/it] 21%|‚ñà‚ñà        | 21/100 [00:34<02:04,  1.58s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:35<02:03,  1.59s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:37<01:57,  1.53s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:38<01:54,  1.50s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:40<01:50,  1.48s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:41<01:48,  1.47s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:43<01:51,  1.53s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:44<01:52,  1.56s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:46<01:53,  1.59s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:47<01:47,  1.54s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:49<01:42,  1.49s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:50<01:37,  1.44s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:52<01:43,  1.54s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:54<01:46,  1.61s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:55<01:42,  1.58s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:57<01:40,  1.57s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:58<01:35,  1.52s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:59<01:32,  1.49s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:01<01:34,  1.56s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:03<01:32,  1.53s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:05<01:37,  1.64s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:06<01:38,  1.71s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:08<01:34,  1.66s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:09<01:28,  1.58s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:11<01:22,  1.50s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:12<01:20,  1.50s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:14<01:18,  1.48s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:15<01:20,  1.55s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:17<01:22,  1.61s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:19<01:21,  1.63s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:20<01:19,  1.62s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:22<01:13,  1.54s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:23<01:12,  1.54s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:25<01:10,  1.53s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:26<01:09,  1.55s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:28<01:08,  1.55s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:30<01:07,  1.58s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:31<01:06,  1.58s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:32<01:01,  1.49s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:34<00:58,  1.47s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:35<00:57,  1.47s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:37<00:56,  1.48s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:38<00:54,  1.49s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:40<00:54,  1.52s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:41<00:53,  1.52s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:43<00:50,  1.50s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:44<00:47,  1.45s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:46<00:46,  1.44s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:47<00:44,  1.45s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:49<00:44,  1.47s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:50<00:43,  1.50s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:52<00:42,  1.52s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:53<00:41,  1.54s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:55<00:37,  1.46s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:56<00:37,  1.49s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:58<00:35,  1.47s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:59<00:32,  1.43s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:01<00:32,  1.48s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:02<00:31,  1.50s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:04<00:31,  1.56s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:05<00:28,  1.50s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:06<00:25,  1.42s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:08<00:24,  1.42s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:09<00:22,  1.42s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:11<00:22,  1.49s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:13<00:21,  1.54s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:14<00:20,  1.56s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:16<00:18,  1.54s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:17<00:16,  1.46s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:18<00:14,  1.48s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:20<00:13,  1.47s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:21<00:11,  1.46s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:23<00:10,  1.52s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:24<00:09,  1.52s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:26<00:07,  1.50s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:27<00:05,  1.47s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:29<00:04,  1.42s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:30<00:02,  1.43s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:32<00:01,  1.47s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:33<00:00,  1.49s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:33<00:00,  1.54s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.17386
wandb: 
wandb: üöÄ View run apricot-sweep-206 at: https://wandb.ai/xzy11632/dance-dev/runs/n4s54j7k
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_180845-n4s54j7k/logs
wandb: Agent Starting Run: 0mdggio2 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_181246-0mdggio2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run restful-sweep-207
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/0mdggio2
[INFO][2024-03-16 18:12:52,100][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 18:12:52,217][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 18:12:52,217][dance][wrapped_func] Took 0:00:00.115593 to load and process data.
[INFO][2024-03-16 18:12:52,217][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 18:12:52,219][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 18:12:52,235][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 18:12:52,235][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 18:12:52,516][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run restful-sweep-207 at: https://wandb.ai/xzy11632/dance-dev/runs/0mdggio2
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_181246-0mdggio2/logs
wandb: ERROR Run 0mdggio2 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1000) out of bounds (1000)
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: avbge1px with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_181312-avbge1px
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run clean-sweep-208
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/avbge1px
[INFO][2024-03-16 18:13:18,392][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 18:13:18,481][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 18:13:18,481][dance][wrapped_func] Took 0:00:00.088886 to load and process data.
[INFO][2024-03-16 18:13:18,481][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 18:13:18,483][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 18:13:18,498][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 18:13:18,499][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 18:13:18,803][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.021 MB of 0.024 MB uploadedwandb: / 0.021 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run clean-sweep-208 at: https://wandb.ai/xzy11632/dance-dev/runs/avbge1px
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_181312-avbge1px/logs
wandb: ERROR Run avbge1px errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1000) out of bounds (1000)
wandb: ERROR 
wandb: Agent Starting Run: dlogko4k with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_181334-dlogko4k
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run confused-sweep-209
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/dlogko4k
[INFO][2024-03-16 18:13:39,763][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 18:13:39,895][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 18:13:39,896][dance][wrapped_func] Took 0:00:00.131872 to load and process data.
[INFO][2024-03-16 18:13:39,896][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 18:13:39,899][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 18:13:39,914][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 18:13:39,915][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 18:13:40,238][dance.WeightedFeaturePCA][__call__] Decomposing train features (8057, 200) (k=6)
[INFO][2024-03-16 18:13:40,239][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.20%
[INFO][2024-03-16 18:13:42,597][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 18:13:42,598][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 18:13:42,598][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 18:13:42,598][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:07,  1.29s/it]  2%|‚ñè         | 2/100 [00:02<02:19,  1.42s/it]  3%|‚ñé         | 3/100 [00:03<02:04,  1.28s/it]  4%|‚ñç         | 4/100 [00:05<02:12,  1.38s/it]  5%|‚ñå         | 5/100 [00:06<02:02,  1.29s/it]  6%|‚ñå         | 6/100 [00:07<02:00,  1.29s/it]  7%|‚ñã         | 7/100 [00:09<02:06,  1.36s/it]  8%|‚ñä         | 8/100 [00:10<02:01,  1.32s/it]  9%|‚ñâ         | 9/100 [00:12<02:07,  1.40s/it] 10%|‚ñà         | 10/100 [00:13<02:05,  1.40s/it] 11%|‚ñà         | 11/100 [00:14<01:58,  1.33s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<01:59,  1.36s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<01:59,  1.37s/it] 14%|‚ñà‚ñç        | 14/100 [00:19<02:00,  1.40s/it] 15%|‚ñà‚ñå        | 15/100 [00:20<01:53,  1.34s/it] 16%|‚ñà‚ñå        | 16/100 [00:21<01:53,  1.36s/it] 17%|‚ñà‚ñã        | 17/100 [00:23<01:55,  1.39s/it] 18%|‚ñà‚ñä        | 18/100 [00:24<01:54,  1.40s/it] 19%|‚ñà‚ñâ        | 19/100 [00:26<01:57,  1.45s/it] 20%|‚ñà‚ñà        | 20/100 [00:27<01:54,  1.43s/it] 21%|‚ñà‚ñà        | 21/100 [00:28<01:48,  1.38s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:30<01:48,  1.39s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:31<01:43,  1.35s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:32<01:45,  1.39s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:33<01:37,  1.30s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:35<01:36,  1.30s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:36<01:37,  1.34s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:37<01:32,  1.29s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:39<01:37,  1.37s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:40<01:31,  1.31s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:41<01:25,  1.23s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:43<01:27,  1.29s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:44<01:24,  1.26s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:45<01:21,  1.24s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:46<01:24,  1.29s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:48<01:21,  1.27s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:49<01:23,  1.33s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:50<01:20,  1.30s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:51<01:16,  1.25s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:53<01:19,  1.33s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:54<01:16,  1.30s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:56<01:19,  1.37s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:57<01:13,  1.29s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:58<01:09,  1.24s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:59<01:12,  1.31s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:01<01:08,  1.28s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:02<01:12,  1.36s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:03<01:07,  1.30s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:05<01:04,  1.27s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:06<01:06,  1.32s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:07<01:03,  1.30s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:08<01:01,  1.28s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:10<01:03,  1.35s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:11<01:00,  1.32s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:13<01:00,  1.35s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:14<00:55,  1.27s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:15<00:53,  1.24s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:16<00:55,  1.33s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:18<00:52,  1.29s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:19<00:56,  1.40s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:21<00:52,  1.35s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:22<00:53,  1.40s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:23<00:50,  1.36s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:25<00:48,  1.36s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:26<00:50,  1.44s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:28<00:47,  1.40s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:29<00:49,  1.51s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:31<00:45,  1.43s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:32<00:42,  1.36s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:33<00:43,  1.44s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:35<00:39,  1.37s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:36<00:39,  1.40s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:37<00:37,  1.39s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:39<00:34,  1.34s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:40<00:34,  1.39s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:41<00:31,  1.31s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:43<00:30,  1.35s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:44<00:27,  1.27s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:45<00:26,  1.27s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:46<00:25,  1.30s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:48<00:26,  1.38s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:49<00:24,  1.38s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:50<00:22,  1.30s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:52<00:21,  1.32s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:53<00:20,  1.40s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:55<00:18,  1.35s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:56<00:17,  1.35s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:57<00:15,  1.26s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:59<00:14,  1.31s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:00<00:13,  1.39s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:01<00:12,  1.35s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:03<00:11,  1.45s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:04<00:09,  1.37s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:06<00:08,  1.42s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:07<00:06,  1.38s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:08<00:05,  1.33s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:10<00:04,  1.35s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:11<00:02,  1.29s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:12<00:01,  1.35s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:13<00:00,  1.28s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:13<00:00,  1.34s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.021 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.15842
wandb: 
wandb: üöÄ View run confused-sweep-209 at: https://wandb.ai/xzy11632/dance-dev/runs/dlogko4k
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_181334-dlogko4k/logs
wandb: Agent Starting Run: p5plep5b with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_181737-p5plep5b
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run zany-sweep-210
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/p5plep5b
[INFO][2024-03-16 18:17:43,230][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 18:17:43,329][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 18:17:43,329][dance][wrapped_func] Took 0:00:00.092292 to load and process data.
[INFO][2024-03-16 18:17:43,329][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 18:17:43,333][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 18:17:43,358][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 18:17:43,360][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 18:17:45,897][dance.WeightedFeatureSVD][__call__] Decomposing train features (8057, 200) (k=7)
[INFO][2024-03-16 18:17:45,898][dance.WeightedFeatureSVD][__call__] Total explained variance: 91.30%
[INFO][2024-03-16 18:17:48,405][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 18:17:48,405][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 18:17:48,406][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 18:17:48,406][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:13,  1.35s/it]  2%|‚ñè         | 2/100 [00:02<02:14,  1.37s/it]  3%|‚ñé         | 3/100 [00:04<02:13,  1.38s/it]  4%|‚ñç         | 4/100 [00:05<02:18,  1.44s/it]  5%|‚ñå         | 5/100 [00:07<02:14,  1.41s/it]  6%|‚ñå         | 6/100 [00:08<02:10,  1.39s/it]  7%|‚ñã         | 7/100 [00:09<02:13,  1.43s/it]  8%|‚ñä         | 8/100 [00:11<02:12,  1.44s/it]  9%|‚ñâ         | 9/100 [00:12<02:04,  1.36s/it] 10%|‚ñà         | 10/100 [00:13<02:01,  1.35s/it] 11%|‚ñà         | 11/100 [00:15<02:08,  1.45s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<02:06,  1.44s/it] 13%|‚ñà‚ñé        | 13/100 [00:18<02:00,  1.39s/it] 14%|‚ñà‚ñç        | 14/100 [00:19<02:01,  1.41s/it] 15%|‚ñà‚ñå        | 15/100 [00:21<02:02,  1.44s/it] 16%|‚ñà‚ñå        | 16/100 [00:22<01:57,  1.40s/it] 17%|‚ñà‚ñã        | 17/100 [00:24<01:58,  1.43s/it] 18%|‚ñà‚ñä        | 18/100 [00:25<01:57,  1.43s/it] 19%|‚ñà‚ñâ        | 19/100 [00:26<01:54,  1.41s/it] 20%|‚ñà‚ñà        | 20/100 [00:28<01:53,  1.41s/it] 21%|‚ñà‚ñà        | 21/100 [00:29<01:50,  1.40s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:30<01:49,  1.40s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:32<01:44,  1.36s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:33<01:44,  1.38s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:34<01:39,  1.32s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:36<01:40,  1.36s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:37<01:45,  1.44s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:39<01:41,  1.41s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:40<01:38,  1.39s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:41<01:36,  1.38s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:43<01:35,  1.38s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:44<01:34,  1.39s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:45<01:29,  1.33s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:47<01:26,  1.30s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:48<01:26,  1.33s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:49<01:25,  1.33s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:51<01:24,  1.35s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:52<01:22,  1.32s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:54<01:24,  1.38s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:55<01:21,  1.36s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:56<01:18,  1.33s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:57<01:15,  1.29s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:59<01:14,  1.31s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:00<01:15,  1.34s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:02<01:16,  1.39s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:03<01:15,  1.39s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:04<01:12,  1.37s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:06<01:12,  1.39s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:07<01:12,  1.42s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:09<01:08,  1.36s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:10<01:05,  1.35s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:11<01:04,  1.35s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:13<01:03,  1.36s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:14<01:02,  1.36s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:15<01:01,  1.36s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:16<00:57,  1.32s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:18<00:55,  1.29s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:19<00:56,  1.35s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:20<00:53,  1.31s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:22<00:52,  1.31s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:23<00:51,  1.33s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:25<00:52,  1.37s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:26<00:48,  1.32s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:27<00:47,  1.33s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:29<00:48,  1.37s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:30<00:46,  1.36s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:31<00:44,  1.34s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:33<00:43,  1.36s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:34<00:42,  1.37s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:35<00:41,  1.38s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:37<00:41,  1.43s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:38<00:38,  1.39s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:40<00:36,  1.35s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:41<00:34,  1.32s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:42<00:32,  1.30s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:43<00:31,  1.31s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:45<00:30,  1.34s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:46<00:29,  1.35s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:47<00:27,  1.30s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:49<00:25,  1.27s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:50<00:23,  1.26s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:51<00:22,  1.25s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:52<00:21,  1.25s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:54<00:20,  1.26s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:55<00:18,  1.25s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:56<00:17,  1.24s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:57<00:16,  1.29s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:59<00:15,  1.30s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:00<00:13,  1.26s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:01<00:12,  1.26s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:02<00:11,  1.26s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:04<00:10,  1.28s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:05<00:08,  1.28s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:06<00:07,  1.30s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:08<00:06,  1.32s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:09<00:05,  1.33s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:10<00:03,  1.32s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:12<00:02,  1.27s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:13<00:01,  1.23s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:14<00:00,  1.20s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:14<00:00,  1.34s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.018 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.17165
wandb: 
wandb: üöÄ View run zany-sweep-210 at: https://wandb.ai/xzy11632/dance-dev/runs/p5plep5b
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_181737-p5plep5b/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 2zt4k3si with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_182200-2zt4k3si
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run balmy-sweep-211
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/2zt4k3si
[INFO][2024-03-16 18:22:06,134][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 18:22:06,220][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 18:22:06,220][dance][wrapped_func] Took 0:00:00.084622 to load and process data.
[INFO][2024-03-16 18:22:06,220][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 18:22:06,222][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 18:22:06,237][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 18:22:06,238][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run balmy-sweep-211 at: https://wandb.ai/xzy11632/dance-dev/runs/2zt4k3si
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_182200-2zt4k3si/logs
wandb: ERROR Run 2zt4k3si errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: 9vgvaipd with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_182221-9vgvaipd
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run super-sweep-212
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/9vgvaipd
[INFO][2024-03-16 18:22:26,725][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 18:22:26,817][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 18:22:26,817][dance][wrapped_func] Took 0:00:00.091129 to load and process data.
[INFO][2024-03-16 18:22:26,817][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 18:22:26,822][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 18:22:26,844][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 18:22:26,845][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run super-sweep-212 at: https://wandb.ai/xzy11632/dance-dev/runs/9vgvaipd
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_182221-9vgvaipd/logs
wandb: ERROR Run 9vgvaipd errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: m72wr726 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_182243-m72wr726
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run breezy-sweep-213
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/m72wr726
[INFO][2024-03-16 18:22:48,954][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 18:22:49,047][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 18:22:49,047][dance][wrapped_func] Took 0:00:00.092363 to load and process data.
[INFO][2024-03-16 18:22:49,047][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 18:22:49,049][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 18:22:49,069][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 18:22:49,070][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run breezy-sweep-213 at: https://wandb.ai/xzy11632/dance-dev/runs/m72wr726
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_182243-m72wr726/logs
wandb: ERROR Run m72wr726 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: nz3bzn4o with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_182304-nz3bzn4o
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run stoic-sweep-214
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/nz3bzn4o
[INFO][2024-03-16 18:23:10,038][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 18:23:10,127][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 18:23:10,128][dance][wrapped_func] Took 0:00:00.088350 to load and process data.
[INFO][2024-03-16 18:23:10,128][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 18:23:10,129][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 18:23:10,146][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 18:23:10,147][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run stoic-sweep-214 at: https://wandb.ai/xzy11632/dance-dev/runs/nz3bzn4o
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_182304-nz3bzn4o/logs
wandb: ERROR Run nz3bzn4o errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: x47maas9 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_182330-x47maas9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run frosty-sweep-215
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/x47maas9
[INFO][2024-03-16 18:23:35,945][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 18:23:36,022][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 18:23:36,022][dance][wrapped_func] Took 0:00:00.076480 to load and process data.
[INFO][2024-03-16 18:23:36,022][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 18:23:36,025][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 18:23:36,039][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 18:23:36,040][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 18:23:36,870][dance.WeightedFeaturePCA][__call__] Decomposing train features (8057, 200) (k=2)
[INFO][2024-03-16 18:23:36,876][dance.WeightedFeaturePCA][__call__] Total explained variance: 92.19%
[INFO][2024-03-16 18:23:39,571][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 18:23:39,572][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 18:23:39,572][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 18:23:39,572][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:03,  1.24s/it]  2%|‚ñè         | 2/100 [00:02<02:14,  1.37s/it]  3%|‚ñé         | 3/100 [00:03<02:07,  1.31s/it]  4%|‚ñç         | 4/100 [00:05<02:00,  1.25s/it]  5%|‚ñå         | 5/100 [00:06<02:05,  1.32s/it]  6%|‚ñå         | 6/100 [00:07<01:57,  1.25s/it]  7%|‚ñã         | 7/100 [00:09<02:07,  1.37s/it]  8%|‚ñä         | 8/100 [00:10<01:57,  1.28s/it]  9%|‚ñâ         | 9/100 [00:11<01:53,  1.25s/it] 10%|‚ñà         | 10/100 [00:12<01:55,  1.28s/it] 11%|‚ñà         | 11/100 [00:14<01:49,  1.23s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:48,  1.23s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:55,  1.33s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<01:51,  1.30s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<01:53,  1.34s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<01:48,  1.29s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:45,  1.27s/it] 18%|‚ñà‚ñä        | 18/100 [00:23<01:49,  1.34s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<01:45,  1.31s/it] 20%|‚ñà‚ñà        | 20/100 [00:25<01:47,  1.34s/it] 21%|‚ñà‚ñà        | 21/100 [00:27<01:44,  1.32s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:28<01:40,  1.29s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:30<01:46,  1.38s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:31<01:42,  1.35s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:33<01:48,  1.45s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:34<01:39,  1.34s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:35<01:34,  1.29s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:36<01:37,  1.36s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:37<01:32,  1.30s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:39<01:29,  1.27s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:40<01:32,  1.34s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:41<01:27,  1.29s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:43<01:30,  1.35s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:44<01:26,  1.31s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:45<01:22,  1.27s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:47<01:26,  1.36s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:48<01:23,  1.33s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:49<01:24,  1.36s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:51<01:18,  1.28s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:52<01:14,  1.24s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:53<01:15,  1.28s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:54<01:12,  1.25s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:56<01:16,  1.34s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:57<01:11,  1.28s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:58<01:09,  1.27s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:00<01:10,  1.30s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:01<01:06,  1.25s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:02<01:01,  1.19s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:03<01:02,  1.22s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:04<00:59,  1.19s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:05<00:58,  1.19s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:07<00:59,  1.24s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:08<00:56,  1.21s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:09<00:58,  1.27s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:10<00:54,  1.22s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:11<00:52,  1.18s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:13<00:52,  1.23s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:14<00:50,  1.20s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:15<00:49,  1.20s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:16<00:48,  1.22s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:17<00:45,  1.16s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:18<00:42,  1.13s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:20<00:45,  1.23s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:21<00:42,  1.18s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:22<00:39,  1.14s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:23<00:41,  1.21s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:25<00:39,  1.18s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:26<00:37,  1.17s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:27<00:39,  1.29s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:28<00:38,  1.27s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:30<00:38,  1.31s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:31<00:34,  1.22s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:32<00:31,  1.18s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:33<00:32,  1.25s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:35<00:30,  1.22s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:36<00:28,  1.17s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:37<00:28,  1.23s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:38<00:26,  1.22s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:40<00:26,  1.28s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:41<00:24,  1.25s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:42<00:22,  1.20s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:43<00:22,  1.27s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:44<00:20,  1.22s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:46<00:19,  1.20s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:47<00:19,  1.27s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:48<00:17,  1.24s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:50<00:16,  1.29s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:51<00:14,  1.22s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:52<00:12,  1.18s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:53<00:12,  1.23s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:54<00:10,  1.18s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:55<00:09,  1.14s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:57<00:08,  1.22s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:58<00:07,  1.18s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:59<00:05,  1.14s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:00<00:04,  1.20s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:01<00:03,  1.13s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:02<00:02,  1.11s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:03<00:01,  1.16s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:04<00:00,  1.13s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:04<00:00,  1.25s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.05979
wandb: 
wandb: üöÄ View run frosty-sweep-215 at: https://wandb.ai/xzy11632/dance-dev/runs/x47maas9
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_182330-x47maas9/logs
wandb: Agent Starting Run: l0y2euop with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_182703-l0y2euop
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glad-sweep-216
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/l0y2euop
[INFO][2024-03-16 18:27:08,822][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 18:27:08,920][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 18:27:08,920][dance][wrapped_func] Took 0:00:00.097467 to load and process data.
[INFO][2024-03-16 18:27:08,920][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 18:27:08,922][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 18:27:08,938][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 18:27:08,938][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 18:27:11,173][dance.WeightedFeatureSVD][__call__] Decomposing train features (8057, 200) (k=4)
[INFO][2024-03-16 18:27:11,174][dance.WeightedFeatureSVD][__call__] Total explained variance: 95.98%
[INFO][2024-03-16 18:27:12,841][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 18:27:12,842][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 18:27:12,842][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 18:27:12,842][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:46,  1.68s/it]  2%|‚ñè         | 2/100 [00:02<02:10,  1.33s/it]  3%|‚ñé         | 3/100 [00:03<01:55,  1.19s/it]  4%|‚ñç         | 4/100 [00:04<01:48,  1.13s/it]  5%|‚ñå         | 5/100 [00:05<01:43,  1.09s/it]  6%|‚ñå         | 6/100 [00:07<01:44,  1.11s/it]  7%|‚ñã         | 7/100 [00:08<01:43,  1.11s/it]  8%|‚ñä         | 8/100 [00:09<01:40,  1.10s/it]  9%|‚ñâ         | 9/100 [00:10<01:38,  1.08s/it] 10%|‚ñà         | 10/100 [00:11<01:38,  1.09s/it] 11%|‚ñà         | 11/100 [00:12<01:38,  1.11s/it] 12%|‚ñà‚ñè        | 12/100 [00:13<01:40,  1.14s/it] 13%|‚ñà‚ñé        | 13/100 [00:14<01:39,  1.15s/it] 14%|‚ñà‚ñç        | 14/100 [00:15<01:36,  1.12s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:36,  1.13s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<01:35,  1.13s/it] 17%|‚ñà‚ñã        | 17/100 [00:19<01:35,  1.15s/it] 18%|‚ñà‚ñä        | 18/100 [00:20<01:37,  1.19s/it] 19%|‚ñà‚ñâ        | 19/100 [00:21<01:36,  1.19s/it] 20%|‚ñà‚ñà        | 20/100 [00:23<01:35,  1.19s/it] 21%|‚ñà‚ñà        | 21/100 [00:24<01:34,  1.20s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:25<01:33,  1.19s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:26<01:36,  1.25s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:28<01:36,  1.27s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:29<01:37,  1.30s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:31<01:41,  1.37s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:32<01:40,  1.38s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:33<01:39,  1.38s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:35<01:39,  1.41s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:36<01:35,  1.36s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:38<01:36,  1.40s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:39<01:33,  1.37s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:40<01:31,  1.36s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:42<01:30,  1.38s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:43<01:28,  1.37s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:44<01:28,  1.38s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:46<01:24,  1.35s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:47<01:23,  1.34s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:49<01:25,  1.41s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:50<01:25,  1.42s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:51<01:24,  1.43s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:53<01:19,  1.37s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:54<01:15,  1.33s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:55<01:12,  1.29s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:56<01:11,  1.29s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:58<01:08,  1.26s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:59<01:06,  1.25s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:00<01:08,  1.31s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:02<01:07,  1.32s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:03<01:08,  1.37s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:05<01:11,  1.46s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:06<01:09,  1.44s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:08<01:08,  1.47s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:09<01:06,  1.46s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:11<01:07,  1.51s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:12<01:08,  1.55s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:14<01:06,  1.54s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:15<01:02,  1.49s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:17<00:58,  1.44s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:18<00:56,  1.41s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:19<00:55,  1.43s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:21<00:55,  1.47s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:23<00:56,  1.52s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:24<00:55,  1.53s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:25<00:50,  1.44s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:27<00:46,  1.36s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:28<00:43,  1.31s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:29<00:44,  1.38s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:31<00:43,  1.41s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:32<00:42,  1.42s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:34<00:42,  1.47s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:35<00:42,  1.52s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:37<00:42,  1.56s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:39<00:40,  1.57s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:40<00:38,  1.55s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:42<00:37,  1.56s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:43<00:36,  1.57s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:45<00:34,  1.57s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:47<00:33,  1.59s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:48<00:31,  1.56s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:50<00:29,  1.56s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:51<00:28,  1.57s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:53<00:26,  1.55s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:54<00:25,  1.57s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:56<00:23,  1.56s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:57<00:21,  1.56s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:59<00:19,  1.52s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:00<00:17,  1.43s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:01<00:14,  1.35s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:02<00:12,  1.29s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:04<00:11,  1.25s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:05<00:09,  1.24s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:06<00:08,  1.23s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:07<00:07,  1.22s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:08<00:06,  1.21s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:10<00:05,  1.26s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:11<00:03,  1.28s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:13<00:02,  1.34s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:14<00:01,  1.30s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:15<00:00,  1.25s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:15<00:00,  1.35s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.11916
wandb: 
wandb: üöÄ View run glad-sweep-216 at: https://wandb.ai/xzy11632/dance-dev/runs/l0y2euop
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_182703-l0y2euop/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: iww9oa6v with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_183114-iww9oa6v
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run restful-sweep-217
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/iww9oa6v
[INFO][2024-03-16 18:31:20,141][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 18:31:20,326][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 18:31:20,326][dance][wrapped_func] Took 0:00:00.184561 to load and process data.
[INFO][2024-03-16 18:31:20,327][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 18:31:20,330][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 18:31:20,354][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 18:31:20,355][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 18:31:20,355][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[WARNING][2024-03-16 18:32:27,576][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 18:32:29,583][dance.WeightedFeaturePCA][__call__] Decomposing train features (8057, 1000) (k=544)
[INFO][2024-03-16 18:32:29,584][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.03%
[INFO][2024-03-16 18:32:31,877][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 18:32:31,877][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 18:32:31,878][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 18:32:31,878][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:09,  1.31s/it]  2%|‚ñè         | 2/100 [00:02<02:12,  1.35s/it]  3%|‚ñé         | 3/100 [00:04<02:22,  1.47s/it]  4%|‚ñç         | 4/100 [00:05<02:15,  1.41s/it]  5%|‚ñå         | 5/100 [00:07<02:17,  1.45s/it]  6%|‚ñå         | 6/100 [00:08<02:15,  1.44s/it]  7%|‚ñã         | 7/100 [00:09<02:10,  1.40s/it]  8%|‚ñä         | 8/100 [00:11<02:02,  1.33s/it]  9%|‚ñâ         | 9/100 [00:12<01:57,  1.30s/it] 10%|‚ñà         | 10/100 [00:13<01:52,  1.25s/it] 11%|‚ñà         | 11/100 [00:14<01:48,  1.22s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:45,  1.20s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:41,  1.17s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:39,  1.16s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<01:38,  1.16s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<01:38,  1.17s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:37,  1.18s/it] 18%|‚ñà‚ñä        | 18/100 [00:22<01:34,  1.16s/it] 19%|‚ñà‚ñâ        | 19/100 [00:23<01:34,  1.17s/it] 20%|‚ñà‚ñà        | 20/100 [00:25<01:34,  1.18s/it] 21%|‚ñà‚ñà        | 21/100 [00:26<01:32,  1.17s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:27<01:30,  1.16s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:28<01:28,  1.15s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:29<01:27,  1.15s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:30<01:26,  1.15s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:31<01:26,  1.17s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:33<01:26,  1.18s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:34<01:25,  1.19s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:35<01:25,  1.20s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:36<01:24,  1.21s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:38<01:24,  1.22s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:39<01:22,  1.21s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:40<01:21,  1.21s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:41<01:19,  1.20s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:42<01:18,  1.20s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:44<01:18,  1.23s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:45<01:16,  1.22s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:46<01:13,  1.19s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:47<01:12,  1.19s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:48<01:12,  1.21s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:50<01:10,  1.19s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:51<01:08,  1.19s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:52<01:07,  1.18s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:53<01:06,  1.19s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:54<01:04,  1.18s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:55<01:03,  1.17s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:57<01:02,  1.17s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:58<01:02,  1.20s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:59<01:00,  1.18s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:00<00:59,  1.18s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:01<00:59,  1.22s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:03<00:58,  1.21s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:04<00:56,  1.20s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:05<00:55,  1.21s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:06<00:54,  1.22s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:07<00:53,  1.21s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:09<00:50,  1.18s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:10<00:50,  1.21s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:11<00:49,  1.20s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:12<00:48,  1.21s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:14<00:50,  1.28s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:15<00:48,  1.28s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:17<00:50,  1.37s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:18<00:46,  1.30s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:19<00:45,  1.31s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:22<01:04,  1.90s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:24<00:57,  1.74s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:25<00:54,  1.70s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:27<00:49,  1.60s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:28<00:47,  1.58s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:30<00:45,  1.56s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:31<00:42,  1.52s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:32<00:39,  1.46s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:34<00:37,  1.45s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:35<00:35,  1.44s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:37<00:34,  1.43s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:38<00:31,  1.37s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:39<00:30,  1.40s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:41<00:29,  1.39s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:42<00:28,  1.43s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:44<00:27,  1.44s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:45<00:25,  1.44s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:47<00:24,  1.42s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:48<00:22,  1.42s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:49<00:21,  1.40s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:51<00:20,  1.44s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:52<00:18,  1.42s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:54<00:17,  1.43s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:55<00:15,  1.38s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:56<00:13,  1.38s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:58<00:12,  1.41s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:59<00:11,  1.39s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:01<00:09,  1.40s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:02<00:08,  1.37s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:04<00:07,  1.44s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:05<00:05,  1.42s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:06<00:04,  1.41s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:08<00:02,  1.39s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:09<00:01,  1.40s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:10<00:00,  1.37s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:10<00:00,  1.31s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.26562
wandb: 
wandb: üöÄ View run restful-sweep-217 at: https://wandb.ai/xzy11632/dance-dev/runs/iww9oa6v
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_183114-iww9oa6v/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 1mwfyyky with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_183629-1mwfyyky
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dry-sweep-218
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/1mwfyyky
[INFO][2024-03-16 18:36:35,087][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 18:36:35,192][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 18:36:35,192][dance][wrapped_func] Took 0:00:00.103546 to load and process data.
[INFO][2024-03-16 18:36:35,192][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 18:36:35,197][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 18:36:35,216][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 18:36:35,217][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 18:36:35,217][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[WARNING][2024-03-16 18:37:36,609][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 18:37:43,464][dance.WeightedFeatureSVD][__call__] Decomposing train features (8057, 1000) (k=550)
[INFO][2024-03-16 18:37:43,466][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.00%
[INFO][2024-03-16 18:37:45,415][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 18:37:45,415][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 18:37:45,415][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 18:37:45,415][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:04,  1.26s/it]  2%|‚ñè         | 2/100 [00:02<02:12,  1.35s/it]  3%|‚ñé         | 3/100 [00:04<02:14,  1.39s/it]  4%|‚ñç         | 4/100 [00:05<02:06,  1.32s/it]  5%|‚ñå         | 5/100 [00:06<02:12,  1.39s/it]  6%|‚ñå         | 6/100 [00:08<02:06,  1.35s/it]  7%|‚ñã         | 7/100 [00:09<02:04,  1.34s/it]  8%|‚ñä         | 8/100 [00:10<02:00,  1.31s/it]  9%|‚ñâ         | 9/100 [00:11<01:57,  1.29s/it] 10%|‚ñà         | 10/100 [00:13<01:52,  1.25s/it] 11%|‚ñà         | 11/100 [00:14<01:49,  1.23s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:46,  1.21s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:48,  1.24s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:46,  1.23s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<01:48,  1.27s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<01:45,  1.26s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:47,  1.29s/it] 18%|‚ñà‚ñä        | 18/100 [00:23<01:43,  1.27s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<01:52,  1.39s/it] 20%|‚ñà‚ñà        | 20/100 [00:25<01:45,  1.32s/it] 21%|‚ñà‚ñà        | 21/100 [00:27<01:43,  1.31s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:28<01:38,  1.26s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:29<01:34,  1.23s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:30<01:37,  1.28s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:32<01:33,  1.25s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:33<01:32,  1.25s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:34<01:31,  1.26s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:35<01:28,  1.23s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:37<01:27,  1.23s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:38<01:26,  1.24s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:39<01:24,  1.22s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:40<01:24,  1.24s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:41<01:21,  1.22s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:43<01:19,  1.20s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:44<01:18,  1.21s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:45<01:16,  1.20s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:46<01:16,  1.21s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:47<01:14,  1.21s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:49<01:13,  1.21s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:50<01:12,  1.20s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:51<01:11,  1.21s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:52<01:12,  1.24s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:54<01:10,  1.23s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:55<01:12,  1.29s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:56<01:10,  1.28s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:58<01:15,  1.40s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:59<01:10,  1.33s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:00<01:07,  1.29s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:02<01:05,  1.29s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:03<01:02,  1.26s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:04<01:00,  1.23s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:05<00:58,  1.22s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:06<00:57,  1.22s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:08<00:55,  1.21s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:09<00:54,  1.20s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:10<00:53,  1.21s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:11<00:51,  1.20s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:12<00:50,  1.20s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:14<00:50,  1.22s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:15<00:48,  1.21s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:16<00:46,  1.20s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:17<00:45,  1.20s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:18<00:44,  1.19s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:20<00:42,  1.19s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:21<00:41,  1.18s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:22<00:40,  1.18s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:23<00:39,  1.20s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:24<00:38,  1.19s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:26<00:37,  1.20s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:27<00:35,  1.19s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:28<00:34,  1.21s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:29<00:34,  1.23s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:30<00:33,  1.23s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:32<00:32,  1.26s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:33<00:31,  1.26s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:34<00:29,  1.24s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:35<00:28,  1.24s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:37<00:27,  1.23s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:38<00:25,  1.24s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:39<00:24,  1.23s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:40<00:23,  1.25s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:42<00:22,  1.23s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:43<00:20,  1.20s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:44<00:19,  1.19s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:45<00:18,  1.20s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:47<00:17,  1.27s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:48<00:16,  1.24s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:49<00:14,  1.22s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:50<00:14,  1.30s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:52<00:12,  1.26s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:53<00:11,  1.24s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:56<00:14,  1.85s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:57<00:11,  1.67s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:59<00:09,  1.59s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:00<00:07,  1.50s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:01<00:05,  1.43s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:02<00:04,  1.36s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:04<00:02,  1.30s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:05<00:01,  1.32s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:06<00:00,  1.28s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:06<00:00,  1.27s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.018 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.27814
wandb: 
wandb: üöÄ View run dry-sweep-218 at: https://wandb.ai/xzy11632/dance-dev/runs/1mwfyyky
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_183629-1mwfyyky/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: np0zwj35 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_184114-np0zwj35
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run deft-sweep-219
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/np0zwj35
[INFO][2024-03-16 18:41:20,229][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 18:41:20,325][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 18:41:20,325][dance][wrapped_func] Took 0:00:00.094945 to load and process data.
[INFO][2024-03-16 18:41:20,325][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 18:41:20,327][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 18:41:20,347][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 18:41:20,348][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 18:42:20,055][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run deft-sweep-219 at: https://wandb.ai/xzy11632/dance-dev/runs/np0zwj35
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_184114-np0zwj35/logs
wandb: ERROR Run np0zwj35 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1000) out of bounds (1000)
wandb: ERROR 
wandb: Agent Starting Run: hqyxuchv with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_184233-hqyxuchv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run feasible-sweep-220
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/hqyxuchv
[INFO][2024-03-16 18:42:38,853][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 18:42:38,953][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 18:42:38,953][dance][wrapped_func] Took 0:00:00.099049 to load and process data.
[INFO][2024-03-16 18:42:38,953][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 18:42:38,955][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 18:42:38,975][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 18:42:38,976][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 18:43:39,104][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run feasible-sweep-220 at: https://wandb.ai/xzy11632/dance-dev/runs/hqyxuchv
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_184233-hqyxuchv/logs
wandb: ERROR Run hqyxuchv errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1000) out of bounds (1000)
wandb: ERROR 
wandb: Agent Starting Run: 90b3g4cy with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_184351-90b3g4cy
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run daily-sweep-221
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/90b3g4cy
[INFO][2024-03-16 18:43:56,708][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 18:43:56,810][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 18:43:56,811][dance][wrapped_func] Took 0:00:00.101669 to load and process data.
[INFO][2024-03-16 18:43:56,811][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 18:43:56,813][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 18:43:56,837][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 18:43:56,838][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-16 18:44:54,804][dance.WeightedFeaturePCA][__call__] Decomposing train features (8057, 200) (k=73)
[INFO][2024-03-16 18:44:54,805][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.02%
[INFO][2024-03-16 18:44:56,433][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 18:44:56,433][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 18:44:56,433][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 18:44:56,433][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:49,  1.11s/it]  2%|‚ñè         | 2/100 [00:02<01:51,  1.14s/it]  3%|‚ñé         | 3/100 [00:03<01:53,  1.17s/it]  4%|‚ñç         | 4/100 [00:04<01:52,  1.17s/it]  5%|‚ñå         | 5/100 [00:05<01:55,  1.22s/it]  6%|‚ñå         | 6/100 [00:07<01:51,  1.19s/it]  7%|‚ñã         | 7/100 [00:08<01:49,  1.18s/it]  8%|‚ñä         | 8/100 [00:09<01:48,  1.18s/it]  9%|‚ñâ         | 9/100 [00:10<01:44,  1.15s/it] 10%|‚ñà         | 10/100 [00:11<01:45,  1.17s/it] 11%|‚ñà         | 11/100 [00:12<01:41,  1.15s/it] 12%|‚ñà‚ñè        | 12/100 [00:13<01:41,  1.15s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:41,  1.17s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:41,  1.18s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:41,  1.19s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<01:40,  1.20s/it] 17%|‚ñà‚ñã        | 17/100 [00:20<01:39,  1.20s/it] 18%|‚ñà‚ñä        | 18/100 [00:21<01:41,  1.24s/it] 19%|‚ñà‚ñâ        | 19/100 [00:22<01:37,  1.20s/it] 20%|‚ñà‚ñà        | 20/100 [00:23<01:35,  1.19s/it] 21%|‚ñà‚ñà        | 21/100 [00:24<01:36,  1.22s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:26<01:33,  1.20s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:27<01:34,  1.23s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:28<01:32,  1.22s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:29<01:31,  1.22s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:31<01:31,  1.23s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:32<01:33,  1.28s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:33<01:29,  1.25s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:34<01:26,  1.22s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:35<01:22,  1.18s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:37<01:20,  1.17s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:38<01:25,  1.26s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:39<01:25,  1.28s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:41<01:23,  1.27s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:42<01:22,  1.28s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:43<01:21,  1.27s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:44<01:17,  1.23s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:45<01:13,  1.18s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:46<01:11,  1.17s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:48<01:11,  1.19s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:49<01:10,  1.20s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:50<01:10,  1.21s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:51<01:09,  1.22s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:53<01:11,  1.27s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:54<01:14,  1.35s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:55<01:10,  1.30s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:57<01:07,  1.28s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:58<01:03,  1.23s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:59<01:01,  1.21s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:00<01:01,  1.23s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:01<00:59,  1.21s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:03<00:57,  1.20s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:04<00:55,  1.19s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:05<00:54,  1.18s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:06<00:53,  1.19s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:07<00:53,  1.21s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:09<00:51,  1.19s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:10<00:52,  1.25s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:11<00:52,  1.29s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:13<00:51,  1.30s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:14<00:50,  1.29s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:15<00:52,  1.38s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:17<00:51,  1.39s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:18<00:48,  1.36s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:20<00:50,  1.43s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:21<00:46,  1.36s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:22<00:44,  1.34s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:24<00:42,  1.33s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:25<00:43,  1.42s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:27<00:45,  1.52s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:28<00:41,  1.42s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:29<00:38,  1.38s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:31<00:37,  1.38s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:32<00:36,  1.40s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:34<00:36,  1.47s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:35<00:34,  1.43s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:37<00:34,  1.51s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:39<00:36,  1.65s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:40<00:33,  1.60s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:42<00:32,  1.61s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:43<00:28,  1.49s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:45<00:27,  1.54s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:46<00:26,  1.56s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:48<00:23,  1.44s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:49<00:20,  1.36s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:50<00:18,  1.31s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:51<00:16,  1.24s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:52<00:14,  1.22s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:53<00:13,  1.20s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:55<00:12,  1.20s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:56<00:10,  1.21s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:57<00:10,  1.30s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:59<00:08,  1.28s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:00<00:08,  1.38s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:02<00:06,  1.36s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:03<00:05,  1.35s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:04<00:04,  1.38s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:06<00:02,  1.40s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:07<00:01,  1.46s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:09<00:00,  1.53s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:09<00:00,  1.30s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.23065
wandb: 
wandb: üöÄ View run daily-sweep-221 at: https://wandb.ai/xzy11632/dance-dev/runs/90b3g4cy
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_184351-90b3g4cy/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: tuvuh1m0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_184912-tuvuh1m0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run hardy-sweep-222
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/tuvuh1m0
[INFO][2024-03-16 18:49:17,577][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 18:49:17,682][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 18:49:17,682][dance][wrapped_func] Took 0:00:00.097965 to load and process data.
[INFO][2024-03-16 18:49:17,682][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 18:49:17,684][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 18:49:17,704][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 18:49:17,705][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-16 18:50:27,951][dance.WeightedFeatureSVD][__call__] Decomposing train features (8057, 200) (k=71)
[INFO][2024-03-16 18:50:27,963][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.57%
[INFO][2024-03-16 18:50:29,854][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 18:50:29,855][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 18:50:29,855][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 18:50:29,855][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:05,  1.26s/it]  2%|‚ñè         | 2/100 [00:02<02:01,  1.24s/it]  3%|‚ñé         | 3/100 [00:03<01:53,  1.17s/it]  4%|‚ñç         | 4/100 [00:04<01:50,  1.15s/it]  5%|‚ñå         | 5/100 [00:06<01:59,  1.25s/it]  6%|‚ñå         | 6/100 [00:07<01:54,  1.22s/it]  7%|‚ñã         | 7/100 [00:08<01:54,  1.23s/it]  8%|‚ñä         | 8/100 [00:09<01:50,  1.20s/it]  9%|‚ñâ         | 9/100 [00:10<01:47,  1.18s/it] 10%|‚ñà         | 10/100 [00:11<01:45,  1.17s/it] 11%|‚ñà         | 11/100 [00:13<01:44,  1.17s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:40,  1.15s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:38,  1.13s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:35,  1.11s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:36,  1.14s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<01:36,  1.15s/it] 17%|‚ñà‚ñã        | 17/100 [00:20<01:38,  1.18s/it] 18%|‚ñà‚ñä        | 18/100 [00:21<01:37,  1.18s/it] 19%|‚ñà‚ñâ        | 19/100 [00:22<01:38,  1.21s/it] 20%|‚ñà‚ñà        | 20/100 [00:23<01:36,  1.20s/it] 21%|‚ñà‚ñà        | 21/100 [00:24<01:36,  1.22s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:26<01:35,  1.23s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:27<01:35,  1.24s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:28<01:32,  1.21s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:29<01:28,  1.18s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:30<01:28,  1.20s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:32<01:29,  1.23s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:33<01:28,  1.23s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:34<01:24,  1.20s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:35<01:25,  1.22s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:37<01:22,  1.20s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:38<01:22,  1.22s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:39<01:20,  1.20s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:40<01:20,  1.22s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:41<01:17,  1.20s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:42<01:14,  1.17s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:44<01:15,  1.20s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:45<01:15,  1.22s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:46<01:14,  1.21s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:47<01:12,  1.21s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:49<01:10,  1.19s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:50<01:10,  1.22s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:51<01:08,  1.20s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:52<01:04,  1.15s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:53<01:03,  1.15s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:54<01:02,  1.16s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:56<01:03,  1.20s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:57<01:01,  1.18s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:58<01:00,  1.18s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:59<01:01,  1.23s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:00<00:59,  1.21s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:02<01:00,  1.26s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:03<00:57,  1.23s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:04<00:55,  1.21s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:05<00:53,  1.18s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:06<00:50,  1.16s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:07<00:49,  1.14s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:09<00:47,  1.13s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:10<00:46,  1.14s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:11<00:46,  1.16s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:12<00:45,  1.16s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:13<00:44,  1.18s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:14<00:42,  1.15s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:16<00:42,  1.18s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:17<00:42,  1.22s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:18<00:40,  1.18s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:19<00:39,  1.20s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:21<00:41,  1.30s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:22<00:40,  1.30s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:23<00:39,  1.30s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:25<00:37,  1.29s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:26<00:35,  1.28s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:27<00:34,  1.27s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:28<00:32,  1.25s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:30<00:31,  1.25s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:31<00:29,  1.24s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:32<00:29,  1.27s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:34<00:28,  1.27s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:35<00:28,  1.33s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:36<00:27,  1.37s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:38<00:26,  1.42s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:39<00:25,  1.44s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:41<00:23,  1.39s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:42<00:22,  1.43s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:44<00:20,  1.40s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:45<00:19,  1.38s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:47<00:18,  1.44s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:48<00:17,  1.45s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:50<00:17,  1.62s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:52<00:16,  1.63s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:53<00:13,  1.53s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:54<00:11,  1.43s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:55<00:09,  1.32s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:56<00:07,  1.27s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:58<00:06,  1.28s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:59<00:05,  1.27s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:00<00:03,  1.23s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:01<00:02,  1.25s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:02<00:01,  1.21s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:04<00:00,  1.23s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:04<00:00,  1.24s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.24965
wandb: 
wandb: üöÄ View run hardy-sweep-222 at: https://wandb.ai/xzy11632/dance-dev/runs/tuvuh1m0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_184912-tuvuh1m0/logs
wandb: Agent Starting Run: tewp67gw with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_185423-tewp67gw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run vocal-sweep-223
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/tewp67gw
[INFO][2024-03-16 18:54:28,894][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 18:54:28,992][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 18:54:28,992][dance][wrapped_func] Took 0:00:00.097243 to load and process data.
[INFO][2024-03-16 18:54:28,992][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 18:54:28,994][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 18:54:29,014][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 18:54:29,015][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-16 18:55:27,046][dance.WeightedFeaturePCA][__call__] Decomposing train features (8057, 243) (k=199)
[INFO][2024-03-16 18:55:27,047][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.26%
[INFO][2024-03-16 18:55:28,610][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 18:55:28,610][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 18:55:28,611][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 18:55:28,611][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:54,  1.16s/it]  2%|‚ñè         | 2/100 [00:02<01:53,  1.16s/it]  3%|‚ñé         | 3/100 [00:03<01:49,  1.13s/it]  4%|‚ñç         | 4/100 [00:04<01:48,  1.13s/it]  5%|‚ñå         | 5/100 [00:05<01:46,  1.12s/it]  6%|‚ñå         | 6/100 [00:06<01:47,  1.15s/it]  7%|‚ñã         | 7/100 [00:07<01:44,  1.13s/it]  8%|‚ñä         | 8/100 [00:09<01:44,  1.14s/it]  9%|‚ñâ         | 9/100 [00:10<01:42,  1.12s/it] 10%|‚ñà         | 10/100 [00:11<01:41,  1.12s/it] 11%|‚ñà         | 11/100 [00:12<01:50,  1.24s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:50,  1.25s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:46,  1.22s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:42,  1.19s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:48,  1.28s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:44,  1.25s/it] 17%|‚ñà‚ñã        | 17/100 [00:20<01:44,  1.26s/it] 18%|‚ñà‚ñä        | 18/100 [00:21<01:40,  1.23s/it] 19%|‚ñà‚ñâ        | 19/100 [00:22<01:37,  1.21s/it] 20%|‚ñà‚ñà        | 20/100 [00:23<01:35,  1.19s/it] 21%|‚ñà‚ñà        | 21/100 [00:24<01:34,  1.19s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:26<01:33,  1.20s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:27<01:31,  1.19s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:28<01:34,  1.25s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:29<01:32,  1.24s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:31<01:37,  1.32s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:32<01:33,  1.28s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:33<01:33,  1.30s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:35<01:30,  1.27s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:36<01:29,  1.28s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:37<01:27,  1.27s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:38<01:25,  1.26s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:40<01:25,  1.27s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:41<01:22,  1.25s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:42<01:20,  1.24s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:44<01:22,  1.29s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:45<01:20,  1.28s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:46<01:21,  1.31s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:48<01:19,  1.30s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:49<01:17,  1.29s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:50<01:14,  1.26s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:51<01:12,  1.26s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:53<01:13,  1.28s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:54<01:12,  1.29s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:55<01:14,  1.35s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:57<01:12,  1.34s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:58<01:10,  1.33s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:59<01:09,  1.34s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:01<01:08,  1.35s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:02<01:08,  1.38s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:03<01:06,  1.35s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:05<01:08,  1.44s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:07<01:13,  1.56s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:09<01:17,  1.69s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:11<01:16,  1.70s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:13<01:17,  1.76s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:14<01:15,  1.75s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:16<01:13,  1.76s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:18<01:12,  1.76s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:20<01:10,  1.77s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:22<01:10,  1.82s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:23<01:07,  1.79s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:25<01:07,  1.82s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:27<01:00,  1.69s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:28<00:54,  1.57s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:30<00:54,  1.60s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:31<00:49,  1.51s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:32<00:49,  1.54s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:34<00:49,  1.60s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:36<00:50,  1.69s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:38<00:50,  1.75s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:40<00:48,  1.74s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:42<00:49,  1.83s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:43<00:46,  1.79s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:45<00:44,  1.77s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:47<00:43,  1.81s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:49<00:39,  1.71s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:50<00:36,  1.64s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:51<00:32,  1.53s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:53<00:30,  1.50s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:54<00:28,  1.49s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:56<00:29,  1.63s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:58<00:28,  1.67s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:00<00:27,  1.69s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:01<00:24,  1.63s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:02<00:21,  1.55s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:04<00:18,  1.46s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:05<00:16,  1.41s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:06<00:15,  1.40s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:08<00:14,  1.41s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:09<00:12,  1.34s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:10<00:10,  1.31s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:11<00:09,  1.29s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:13<00:07,  1.27s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:14<00:06,  1.27s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:15<00:05,  1.28s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:17<00:03,  1.27s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:18<00:02,  1.24s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:19<00:01,  1.24s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:20<00:00,  1.24s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:20<00:00,  1.41s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.22008
wandb: 
wandb: üöÄ View run vocal-sweep-223 at: https://wandb.ai/xzy11632/dance-dev/runs/tewp67gw
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_185423-tewp67gw/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 3qfwu889 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_190100-3qfwu889
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run pleasant-sweep-224
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/3qfwu889
[INFO][2024-03-16 19:01:05,689][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 19:01:05,800][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 19:01:05,800][dance][wrapped_func] Took 0:00:00.110367 to load and process data.
[INFO][2024-03-16 19:01:05,800][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 19:01:05,802][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 19:01:05,818][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 19:01:05,819][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-16 19:02:08,155][dance.WeightedFeatureSVD][__call__] Decomposing train features (8057, 243) (k=199)
[INFO][2024-03-16 19:02:08,156][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.69%
[INFO][2024-03-16 19:02:09,770][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 19:02:09,771][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 19:02:09,771][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 19:02:09,771][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:07,  1.29s/it]  2%|‚ñè         | 2/100 [00:02<01:55,  1.18s/it]  3%|‚ñé         | 3/100 [00:03<01:58,  1.22s/it]  4%|‚ñç         | 4/100 [00:04<01:50,  1.16s/it]  5%|‚ñå         | 5/100 [00:05<01:46,  1.12s/it]  6%|‚ñå         | 6/100 [00:06<01:43,  1.10s/it]  7%|‚ñã         | 7/100 [00:07<01:43,  1.11s/it]  8%|‚ñä         | 8/100 [00:09<01:42,  1.12s/it]  9%|‚ñâ         | 9/100 [00:10<01:43,  1.13s/it] 10%|‚ñà         | 10/100 [00:11<01:42,  1.14s/it] 11%|‚ñà         | 11/100 [00:12<01:44,  1.17s/it] 12%|‚ñà‚ñè        | 12/100 [00:13<01:42,  1.16s/it] 13%|‚ñà‚ñé        | 13/100 [00:14<01:39,  1.15s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:37,  1.13s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:34,  1.12s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<01:32,  1.10s/it] 17%|‚ñà‚ñã        | 17/100 [00:19<01:32,  1.12s/it] 18%|‚ñà‚ñä        | 18/100 [00:20<01:34,  1.15s/it] 19%|‚ñà‚ñâ        | 19/100 [00:21<01:31,  1.13s/it] 20%|‚ñà‚ñà        | 20/100 [00:22<01:31,  1.14s/it] 21%|‚ñà‚ñà        | 21/100 [00:23<01:29,  1.13s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:25<01:28,  1.13s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:26<01:28,  1.14s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:27<01:28,  1.16s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:28<01:29,  1.19s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:29<01:25,  1.16s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:30<01:24,  1.16s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:32<01:23,  1.15s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:33<01:20,  1.13s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:34<01:19,  1.14s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:35<01:19,  1.16s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:36<01:18,  1.15s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:37<01:16,  1.14s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:38<01:17,  1.17s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:40<01:15,  1.17s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:41<01:12,  1.13s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:42<01:10,  1.12s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:43<01:11,  1.15s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:44<01:09,  1.14s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:45<01:08,  1.14s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:46<01:08,  1.16s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:48<01:06,  1.14s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:49<01:04,  1.13s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:50<01:06,  1.18s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:51<01:05,  1.19s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:52<01:02,  1.16s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:53<01:02,  1.17s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:55<00:59,  1.14s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:56<00:57,  1.13s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:57<00:56,  1.14s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:58<00:54,  1.12s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:59<00:54,  1.13s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:00<00:54,  1.17s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:02<00:56,  1.23s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:03<00:57,  1.27s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:04<00:55,  1.27s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:06<00:55,  1.29s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:07<00:54,  1.30s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:08<00:52,  1.29s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:09<00:50,  1.27s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:11<00:49,  1.27s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:12<00:48,  1.27s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:13<00:47,  1.27s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:15<00:45,  1.27s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:16<00:44,  1.28s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:17<00:44,  1.31s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:19<00:43,  1.31s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:20<00:41,  1.31s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:21<00:40,  1.31s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:22<00:38,  1.29s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:24<00:37,  1.29s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:25<00:37,  1.33s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:27<00:39,  1.46s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:29<00:39,  1.53s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:30<00:39,  1.58s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:32<00:38,  1.60s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:34<00:37,  1.63s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:35<00:36,  1.64s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:37<00:35,  1.69s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:39<00:33,  1.69s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:41<00:32,  1.72s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:42<00:31,  1.75s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:44<00:30,  1.77s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:46<00:27,  1.75s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:48<00:26,  1.75s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:49<00:24,  1.75s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:51<00:22,  1.73s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:53<00:20,  1.73s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:56<00:22,  2.06s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:57<00:19,  1.96s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:59<00:16,  1.81s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:00<00:13,  1.68s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:01<00:10,  1.57s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:03<00:08,  1.49s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:04<00:07,  1.43s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:05<00:05,  1.37s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:07<00:03,  1.33s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:08<00:02,  1.33s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:09<00:01,  1.30s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:10<00:00,  1.33s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:10<00:00,  1.31s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.30283
wandb: 
wandb: üöÄ View run pleasant-sweep-224 at: https://wandb.ai/xzy11632/dance-dev/runs/3qfwu889
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_190100-3qfwu889/logs
wandb: Agent Starting Run: sfthmexa with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_190605-sfthmexa
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run northern-sweep-225
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/sfthmexa
[INFO][2024-03-16 19:06:10,833][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 19:06:10,947][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 19:06:10,947][dance][wrapped_func] Took 0:00:00.113276 to load and process data.
[INFO][2024-03-16 19:06:10,948][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 19:06:10,950][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 19:06:10,972][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 19:06:10,973][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-16 19:07:11,549][dance.WeightedFeaturePCA][__call__] Decomposing train features (8057, 200) (k=144)
[INFO][2024-03-16 19:07:11,549][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.22%
[INFO][2024-03-16 19:07:13,504][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 19:07:13,504][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 19:07:13,504][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 19:07:13,504][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:57,  1.19s/it]  2%|‚ñè         | 2/100 [00:02<02:03,  1.26s/it]  3%|‚ñé         | 3/100 [00:03<01:58,  1.22s/it]  4%|‚ñç         | 4/100 [00:04<01:54,  1.20s/it]  5%|‚ñå         | 5/100 [00:06<01:55,  1.22s/it]  6%|‚ñå         | 6/100 [00:07<01:51,  1.19s/it]  7%|‚ñã         | 7/100 [00:08<01:50,  1.19s/it]  8%|‚ñä         | 8/100 [00:09<01:48,  1.18s/it]  9%|‚ñâ         | 9/100 [00:10<01:46,  1.17s/it] 10%|‚ñà         | 10/100 [00:11<01:46,  1.19s/it] 11%|‚ñà         | 11/100 [00:13<01:42,  1.16s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:45,  1.20s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:44,  1.20s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:44,  1.21s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:41,  1.19s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:40,  1.20s/it] 17%|‚ñà‚ñã        | 17/100 [00:20<01:37,  1.17s/it] 18%|‚ñà‚ñä        | 18/100 [00:21<01:35,  1.16s/it] 19%|‚ñà‚ñâ        | 19/100 [00:22<01:36,  1.20s/it] 20%|‚ñà‚ñà        | 20/100 [00:23<01:33,  1.17s/it] 21%|‚ñà‚ñà        | 21/100 [00:24<01:34,  1.19s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:26<01:31,  1.18s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:27<01:28,  1.15s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:28<01:30,  1.19s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:29<01:28,  1.18s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:31<01:30,  1.23s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:32<01:27,  1.20s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:33<01:26,  1.21s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:34<01:23,  1.18s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:35<01:21,  1.17s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:36<01:19,  1.16s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:37<01:17,  1.14s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:38<01:15,  1.13s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:40<01:12,  1.11s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:41<01:14,  1.15s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:42<01:13,  1.14s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:43<01:16,  1.21s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:44<01:14,  1.20s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:46<01:12,  1.19s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:47<01:10,  1.17s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:48<01:11,  1.22s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:49<01:11,  1.24s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:51<01:10,  1.24s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:52<01:09,  1.24s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:53<01:09,  1.26s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:54<01:08,  1.26s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:56<01:05,  1.24s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:57<01:03,  1.23s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:58<01:02,  1.23s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:59<00:59,  1.20s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:00<01:00,  1.23s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:02<00:59,  1.25s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:03<01:01,  1.31s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:04<01:00,  1.31s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:06<00:58,  1.30s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:07<00:57,  1.31s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:09<00:58,  1.37s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:10<00:57,  1.36s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:11<00:55,  1.34s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:12<00:52,  1.31s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:14<00:51,  1.31s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:15<00:48,  1.28s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:16<00:47,  1.28s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:18<00:45,  1.26s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:19<00:45,  1.29s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:20<00:44,  1.30s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:22<00:44,  1.35s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:23<00:43,  1.35s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:24<00:41,  1.34s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:26<00:40,  1.34s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:27<00:38,  1.33s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:28<00:37,  1.33s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:30<00:36,  1.35s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:31<00:35,  1.37s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:32<00:34,  1.36s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:34<00:31,  1.33s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:35<00:31,  1.36s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:36<00:29,  1.34s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:38<00:27,  1.32s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:39<00:25,  1.30s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:40<00:24,  1.31s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:42<00:23,  1.32s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:43<00:23,  1.38s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:45<00:23,  1.47s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:47<00:23,  1.56s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:48<00:22,  1.60s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:50<00:21,  1.64s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:52<00:20,  1.68s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:54<00:18,  1.72s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:57<00:21,  2.13s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:59<00:18,  2.04s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:00<00:15,  2.00s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:02<00:13,  1.97s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:04<00:11,  1.89s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:06<00:08,  1.79s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:07<00:07,  1.79s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:09<00:05,  1.80s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:11<00:03,  1.83s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:13<00:01,  1.78s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:15<00:00,  1.80s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:15<00:00,  1.35s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.25374
wandb: 
wandb: üöÄ View run northern-sweep-225 at: https://wandb.ai/xzy11632/dance-dev/runs/sfthmexa
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_190605-sfthmexa/logs
wandb: Agent Starting Run: mi8luwj0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_191134-mi8luwj0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run celestial-sweep-226
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/mi8luwj0
[INFO][2024-03-16 19:11:40,600][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 19:11:40,745][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 19:11:40,745][dance][wrapped_func] Took 0:00:00.144244 to load and process data.
[INFO][2024-03-16 19:11:40,745][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 19:11:40,749][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 19:11:40,777][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 19:11:40,779][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-16 19:12:40,780][dance.WeightedFeatureSVD][__call__] Decomposing train features (8057, 200) (k=145)
[INFO][2024-03-16 19:12:40,781][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.99%
[INFO][2024-03-16 19:12:42,384][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 19:12:42,384][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 19:12:42,384][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 19:12:42,384][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:01,  1.23s/it]  2%|‚ñè         | 2/100 [00:02<01:59,  1.22s/it]  3%|‚ñé         | 3/100 [00:03<02:01,  1.25s/it]  4%|‚ñç         | 4/100 [00:04<01:53,  1.19s/it]  5%|‚ñå         | 5/100 [00:05<01:52,  1.18s/it]  6%|‚ñå         | 6/100 [00:07<01:49,  1.17s/it]  7%|‚ñã         | 7/100 [00:08<01:49,  1.18s/it]  8%|‚ñä         | 8/100 [00:09<01:49,  1.19s/it]  9%|‚ñâ         | 9/100 [00:10<01:46,  1.17s/it] 10%|‚ñà         | 10/100 [00:11<01:43,  1.15s/it] 11%|‚ñà         | 11/100 [00:12<01:42,  1.16s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:44,  1.19s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:43,  1.19s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:41,  1.18s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:38,  1.16s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<01:39,  1.18s/it] 17%|‚ñà‚ñã        | 17/100 [00:20<01:36,  1.17s/it] 18%|‚ñà‚ñä        | 18/100 [00:21<01:39,  1.21s/it] 19%|‚ñà‚ñâ        | 19/100 [00:22<01:41,  1.25s/it] 20%|‚ñà‚ñà        | 20/100 [00:23<01:40,  1.25s/it] 21%|‚ñà‚ñà        | 21/100 [00:25<01:39,  1.27s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:26<01:40,  1.29s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:28<01:44,  1.35s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:29<01:42,  1.35s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:30<01:40,  1.34s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:32<01:39,  1.34s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:33<01:36,  1.32s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:34<01:34,  1.31s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:36<01:35,  1.34s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:37<01:37,  1.39s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:39<01:37,  1.41s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:40<01:34,  1.39s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:41<01:32,  1.37s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:43<01:29,  1.35s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:44<01:29,  1.38s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:45<01:25,  1.34s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:47<01:26,  1.37s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:48<01:29,  1.44s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:50<01:32,  1.52s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:52<01:34,  1.58s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:53<01:35,  1.62s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:55<01:35,  1.64s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:57<01:36,  1.70s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:59<01:35,  1.71s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:00<01:33,  1.70s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:02<01:33,  1.73s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:04<01:33,  1.76s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:06<01:30,  1.75s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:07<01:28,  1.73s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:09<01:27,  1.75s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:11<01:25,  1.75s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:13<01:23,  1.74s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:14<01:23,  1.77s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:16<01:21,  1.78s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:18<01:21,  1.80s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:20<01:19,  1.80s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:22<01:16,  1.78s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:23<01:14,  1.76s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:25<01:12,  1.77s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:27<01:11,  1.79s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:29<01:10,  1.80s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:31<01:07,  1.79s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:32<01:06,  1.80s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:34<01:03,  1.77s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:36<01:02,  1.78s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:38<01:01,  1.81s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:39<00:58,  1.76s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:41<00:55,  1.74s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:43<00:53,  1.73s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:45<00:52,  1.75s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:46<00:49,  1.72s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:48<00:47,  1.71s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:50<00:46,  1.72s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:51<00:44,  1.72s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:53<00:40,  1.60s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:54<00:37,  1.55s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:56<00:34,  1.48s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:59<00:46,  2.14s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:01<00:44,  2.14s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:03<00:37,  1.89s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:04<00:32,  1.71s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:05<00:28,  1.57s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:07<00:25,  1.51s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:08<00:23,  1.48s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:09<00:20,  1.39s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:10<00:19,  1.38s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:12<00:17,  1.33s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:13<00:16,  1.38s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:15<00:15,  1.39s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:16<00:13,  1.37s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:17<00:12,  1.39s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:19<00:10,  1.36s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:20<00:09,  1.38s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:22<00:08,  1.40s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:23<00:06,  1.35s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:24<00:05,  1.38s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:26<00:04,  1.36s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:27<00:02,  1.31s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:28<00:01,  1.38s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:29<00:00,  1.33s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:29<00:00,  1.50s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.28137
wandb: 
wandb: üöÄ View run celestial-sweep-226 at: https://wandb.ai/xzy11632/dance-dev/runs/mi8luwj0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_191134-mi8luwj0/logs
wandb: Agent Starting Run: aba8r881 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_191712-aba8r881
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run woven-sweep-227
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/aba8r881
[INFO][2024-03-16 19:17:17,522][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 19:17:17,626][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 19:17:17,626][dance][wrapped_func] Took 0:00:00.103235 to load and process data.
[INFO][2024-03-16 19:17:17,626][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 19:17:17,628][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 19:17:17,648][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 19:17:17,649][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 19:18:19,910][dance.WeightedFeaturePCA][__call__] Decomposing train features (8057, 200) (k=94)
[INFO][2024-03-16 19:18:19,910][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.01%
[INFO][2024-03-16 19:18:21,651][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 19:18:21,651][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 19:18:21,651][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 19:18:21,651][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:59,  1.21s/it]  2%|‚ñè         | 2/100 [00:02<01:55,  1.18s/it]  3%|‚ñé         | 3/100 [00:03<01:56,  1.20s/it]  4%|‚ñç         | 4/100 [00:04<01:57,  1.22s/it]  5%|‚ñå         | 5/100 [00:06<01:57,  1.24s/it]  6%|‚ñå         | 6/100 [00:07<01:55,  1.23s/it]  7%|‚ñã         | 7/100 [00:08<01:55,  1.24s/it]  8%|‚ñä         | 8/100 [00:09<01:52,  1.22s/it]  9%|‚ñâ         | 9/100 [00:10<01:51,  1.22s/it] 10%|‚ñà         | 10/100 [00:12<01:49,  1.21s/it] 11%|‚ñà         | 11/100 [00:13<01:50,  1.24s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:49,  1.25s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:52,  1.29s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:50,  1.29s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:56,  1.36s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<01:56,  1.38s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:54,  1.38s/it] 18%|‚ñà‚ñä        | 18/100 [00:23<01:52,  1.37s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<01:52,  1.39s/it] 20%|‚ñà‚ñà        | 20/100 [00:26<01:54,  1.43s/it] 21%|‚ñà‚ñà        | 21/100 [00:27<01:55,  1.46s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:29<02:02,  1.57s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:31<02:06,  1.64s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:33<02:11,  1.73s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:34<02:10,  1.74s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:36<02:13,  1.80s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:38<02:15,  1.85s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:40<02:13,  1.85s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:42<02:10,  1.84s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:44<02:12,  1.90s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:46<02:10,  1.89s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:48<02:04,  1.83s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:49<02:02,  1.82s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:51<02:01,  1.84s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:53<02:00,  1.85s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:55<01:56,  1.82s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:56<01:47,  1.70s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:58<01:38,  1.59s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:59<01:37,  1.59s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:01<01:43,  1.73s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:03<01:45,  1.78s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:05<01:41,  1.74s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:07<01:40,  1.76s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:09<01:43,  1.84s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:11<01:42,  1.87s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:13<01:45,  1.95s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:15<01:42,  1.93s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:17<01:39,  1.91s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:19<01:39,  1.95s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:20<01:35,  1.91s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:22<01:31,  1.87s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:24<01:22,  1.72s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:25<01:15,  1.60s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:26<01:10,  1.52s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:28<01:05,  1.47s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:29<01:02,  1.43s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:30<01:00,  1.40s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:32<00:57,  1.37s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:33<00:55,  1.36s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:34<00:53,  1.35s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:36<00:52,  1.35s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:37<00:50,  1.34s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:38<00:49,  1.34s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:39<00:47,  1.32s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:41<00:47,  1.35s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:42<00:46,  1.36s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:44<00:45,  1.37s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:45<00:43,  1.36s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:46<00:41,  1.35s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:48<00:40,  1.35s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:49<00:38,  1.33s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:50<00:38,  1.38s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:52<00:38,  1.43s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:54<00:37,  1.46s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:55<00:39,  1.56s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:57<00:37,  1.57s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:58<00:34,  1.52s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:00<00:32,  1.48s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:01<00:30,  1.43s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:02<00:28,  1.42s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:04<00:27,  1.43s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:05<00:26,  1.47s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:07<00:25,  1.50s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:08<00:23,  1.46s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:10<00:21,  1.42s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:11<00:21,  1.51s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:13<00:21,  1.64s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:15<00:20,  1.69s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:17<00:17,  1.59s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:18<00:15,  1.52s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:20<00:15,  1.76s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:22<00:14,  1.77s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:23<00:11,  1.63s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:25<00:09,  1.53s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:26<00:07,  1.45s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:27<00:05,  1.39s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:28<00:03,  1.29s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:29<00:02,  1.28s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:31<00:01,  1.25s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:32<00:00,  1.20s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:32<00:00,  1.52s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.23827
wandb: 
wandb: üöÄ View run woven-sweep-227 at: https://wandb.ai/xzy11632/dance-dev/runs/aba8r881
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_191712-aba8r881/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: ppsylki0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_192247-ppsylki0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run legendary-sweep-228
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ppsylki0
[INFO][2024-03-16 19:22:53,062][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 19:22:53,166][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 19:22:53,167][dance][wrapped_func] Took 0:00:00.103526 to load and process data.
[INFO][2024-03-16 19:22:53,167][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 19:22:53,171][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 19:22:53,190][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 19:22:53,191][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 19:24:00,096][dance.WeightedFeatureSVD][__call__] Decomposing train features (8057, 200) (k=92)
[INFO][2024-03-16 19:24:00,115][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.52%
[INFO][2024-03-16 19:24:01,674][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 19:24:01,675][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 19:24:01,675][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 19:24:01,675][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:04,  1.26s/it]  2%|‚ñè         | 2/100 [00:02<01:57,  1.20s/it]  3%|‚ñé         | 3/100 [00:03<01:54,  1.18s/it]  4%|‚ñç         | 4/100 [00:04<01:52,  1.17s/it]  5%|‚ñå         | 5/100 [00:05<01:48,  1.15s/it]  6%|‚ñå         | 6/100 [00:07<01:48,  1.16s/it]  7%|‚ñã         | 7/100 [00:08<01:48,  1.16s/it]  8%|‚ñä         | 8/100 [00:09<01:48,  1.18s/it]  9%|‚ñâ         | 9/100 [00:10<01:49,  1.20s/it] 10%|‚ñà         | 10/100 [00:11<01:45,  1.17s/it] 11%|‚ñà         | 11/100 [00:13<01:47,  1.21s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:44,  1.19s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:43,  1.19s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:40,  1.17s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:39,  1.17s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<01:37,  1.16s/it] 17%|‚ñà‚ñã        | 17/100 [00:20<01:46,  1.29s/it] 18%|‚ñà‚ñä        | 18/100 [00:21<01:46,  1.30s/it] 19%|‚ñà‚ñâ        | 19/100 [00:23<01:46,  1.32s/it] 20%|‚ñà‚ñà        | 20/100 [00:24<01:43,  1.29s/it] 21%|‚ñà‚ñà        | 21/100 [00:25<01:46,  1.35s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:27<01:42,  1.32s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:28<01:41,  1.32s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:29<01:39,  1.31s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:30<01:34,  1.27s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:32<01:32,  1.25s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:33<01:31,  1.26s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:34<01:35,  1.32s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:36<01:39,  1.40s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:37<01:37,  1.39s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:39<01:36,  1.40s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:40<01:37,  1.44s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:42<01:44,  1.56s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:44<01:53,  1.72s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:46<01:55,  1.78s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:48<01:53,  1.77s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:50<01:53,  1.81s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:51<01:49,  1.77s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:53<01:47,  1.76s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:55<01:46,  1.78s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:57<01:46,  1.80s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:58<01:42,  1.77s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:00<01:40,  1.76s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:02<01:37,  1.75s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:04<01:36,  1.76s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:05<01:34,  1.74s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:07<01:32,  1.75s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:09<01:26,  1.66s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:10<01:22,  1.61s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:12<01:19,  1.58s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:13<01:14,  1.53s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:14<01:10,  1.46s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:16<01:08,  1.45s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:17<01:07,  1.46s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:19<01:06,  1.47s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:21<01:08,  1.56s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:22<01:08,  1.59s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:24<01:09,  1.66s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:26<01:09,  1.70s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:28<01:08,  1.72s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:29<01:06,  1.71s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:31<01:06,  1.75s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:33<01:03,  1.72s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:34<01:02,  1.72s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:36<00:56,  1.62s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:37<00:52,  1.53s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:39<00:48,  1.47s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:40<00:45,  1.41s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:41<00:43,  1.39s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:42<00:41,  1.38s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:44<00:40,  1.40s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:45<00:38,  1.37s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:46<00:36,  1.34s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:48<00:34,  1.33s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:49<00:33,  1.33s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:51<00:32,  1.37s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:52<00:31,  1.38s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:53<00:30,  1.37s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:55<00:28,  1.37s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:56<00:27,  1.36s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:57<00:25,  1.36s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:59<00:25,  1.40s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:01<00:25,  1.51s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:02<00:23,  1.45s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:03<00:21,  1.42s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:05<00:19,  1.42s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:06<00:18,  1.40s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:08<00:17,  1.44s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:09<00:16,  1.51s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:11<00:15,  1.52s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:12<00:13,  1.46s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:14<00:12,  1.54s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:15<00:10,  1.52s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:17<00:09,  1.55s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:19<00:07,  1.59s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:20<00:06,  1.64s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:22<00:05,  1.69s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:25<00:03,  1.90s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:26<00:01,  1.86s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:28<00:00,  1.68s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:28<00:00,  1.48s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.28674
wandb: 
wandb: üöÄ View run legendary-sweep-228 at: https://wandb.ai/xzy11632/dance-dev/runs/ppsylki0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_192247-ppsylki0/logs
wandb: Agent Starting Run: usy1kcry with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_192830-usy1kcry
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run unique-sweep-229
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/usy1kcry
[INFO][2024-03-16 19:28:35,764][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 19:28:35,866][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 19:28:35,867][dance][wrapped_func] Took 0:00:00.101582 to load and process data.
[INFO][2024-03-16 19:28:35,867][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 19:28:35,869][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 19:28:35,887][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 19:28:35,887][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 19:28:35,888][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 19:28:36,007][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 19:28:37,399][dance.WeightedFeaturePCA][__call__] Decomposing train features (8057, 1000) (k=375)
[INFO][2024-03-16 19:28:37,399][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.01%
[INFO][2024-03-16 19:28:39,907][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 19:28:39,907][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 19:28:39,907][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 19:28:39,907][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:19,  1.41s/it]  2%|‚ñè         | 2/100 [00:02<02:15,  1.38s/it]  3%|‚ñé         | 3/100 [00:04<02:10,  1.34s/it]  4%|‚ñç         | 4/100 [00:05<02:05,  1.30s/it]  5%|‚ñå         | 5/100 [00:06<02:02,  1.28s/it]  6%|‚ñå         | 6/100 [00:07<02:01,  1.30s/it]  7%|‚ñã         | 7/100 [00:09<02:01,  1.30s/it]  8%|‚ñä         | 8/100 [00:10<01:58,  1.29s/it]  9%|‚ñâ         | 9/100 [00:11<01:58,  1.30s/it] 10%|‚ñà         | 10/100 [00:13<01:56,  1.30s/it] 11%|‚ñà         | 11/100 [00:14<01:53,  1.28s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:51,  1.27s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:49,  1.26s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<01:48,  1.26s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<01:46,  1.26s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<01:47,  1.28s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:45,  1.28s/it] 18%|‚ñà‚ñä        | 18/100 [00:23<01:43,  1.26s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<01:41,  1.25s/it] 20%|‚ñà‚ñà        | 20/100 [00:25<01:39,  1.25s/it] 21%|‚ñà‚ñà        | 21/100 [00:26<01:39,  1.25s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:29<02:06,  1.62s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:33<02:53,  2.26s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:35<02:59,  2.36s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:37<02:38,  2.11s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:38<02:23,  1.94s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:40<02:15,  1.85s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:42<02:09,  1.80s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:43<02:02,  1.72s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:45<01:58,  1.70s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:46<01:56,  1.69s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:48<01:57,  1.73s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:50<01:54,  1.72s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:52<01:50,  1.67s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:53<01:46,  1.64s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:55<01:45,  1.65s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:56<01:44,  1.66s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:58<01:41,  1.63s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:00<01:40,  1.65s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:01<01:40,  1.67s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:03<01:39,  1.69s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:05<01:36,  1.66s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:06<01:33,  1.63s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:08<01:32,  1.65s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:10<01:32,  1.68s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:11<01:31,  1.70s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:13<01:27,  1.66s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:15<01:25,  1.65s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:16<01:23,  1.64s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:18<01:24,  1.69s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:20<01:20,  1.65s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:21<01:18,  1.63s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:23<01:16,  1.62s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:25<01:15,  1.63s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:26<01:13,  1.63s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:28<01:11,  1.62s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:29<01:11,  1.65s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:31<01:10,  1.68s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:33<01:12,  1.76s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:35<01:08,  1.72s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:36<01:06,  1.71s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:38<01:04,  1.69s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:40<01:01,  1.65s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:41<01:00,  1.67s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:43<00:58,  1.67s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:45<00:56,  1.66s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:46<00:54,  1.64s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:48<00:56,  1.76s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:50<00:53,  1.72s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:52<00:51,  1.71s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:53<00:49,  1.72s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:55<00:48,  1.74s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:57<00:45,  1.69s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:58<00:43,  1.68s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:00<00:43,  1.73s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:02<00:40,  1.68s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:04<00:41,  1.78s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:05<00:38,  1.74s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:07<00:36,  1.74s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:09<00:34,  1.73s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:11<00:32,  1.71s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:12<00:29,  1.65s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:14<00:28,  1.69s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:15<00:26,  1.66s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:17<00:25,  1.69s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:19<00:23,  1.66s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:21<00:21,  1.67s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:22<00:19,  1.65s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:24<00:18,  1.64s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:25<00:16,  1.65s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:27<00:14,  1.63s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:29<00:13,  1.69s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:30<00:10,  1.55s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:31<00:08,  1.46s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:33<00:07,  1.42s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:34<00:05,  1.41s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:35<00:04,  1.37s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:37<00:02,  1.33s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:38<00:01,  1.31s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:39<00:00,  1.29s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:39<00:00,  1.60s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.10717
wandb: 
wandb: üöÄ View run unique-sweep-229 at: https://wandb.ai/xzy11632/dance-dev/runs/usy1kcry
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_192830-usy1kcry/logs
wandb: Agent Starting Run: xv7no1yi with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_193227-xv7no1yi
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run snowy-sweep-230
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/xv7no1yi
[INFO][2024-03-16 19:32:33,535][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 19:32:33,687][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 19:32:33,688][dance][wrapped_func] Took 0:00:00.150874 to load and process data.
[INFO][2024-03-16 19:32:33,688][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 19:32:33,690][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 19:32:33,710][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 19:32:33,711][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 19:32:33,712][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 19:32:33,880][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 19:32:41,700][dance.WeightedFeatureSVD][__call__] Decomposing train features (8057, 1000) (k=364)
[INFO][2024-03-16 19:32:41,700][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.40%
[INFO][2024-03-16 19:32:43,959][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 19:32:43,960][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 19:32:43,960][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 19:32:43,960][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:20,  1.42s/it]  2%|‚ñè         | 2/100 [00:03<02:30,  1.54s/it]  3%|‚ñé         | 3/100 [00:04<02:25,  1.50s/it]  4%|‚ñç         | 4/100 [00:05<02:22,  1.49s/it]  5%|‚ñå         | 5/100 [00:07<02:19,  1.47s/it]  6%|‚ñå         | 6/100 [00:08<02:16,  1.45s/it]  7%|‚ñã         | 7/100 [00:10<02:19,  1.50s/it]  8%|‚ñä         | 8/100 [00:12<02:25,  1.59s/it]  9%|‚ñâ         | 9/100 [00:13<02:25,  1.60s/it] 10%|‚ñà         | 10/100 [00:15<02:19,  1.55s/it] 11%|‚ñà         | 11/100 [00:16<02:17,  1.55s/it] 12%|‚ñà‚ñè        | 12/100 [00:18<02:16,  1.55s/it] 13%|‚ñà‚ñé        | 13/100 [00:19<02:14,  1.55s/it] 14%|‚ñà‚ñç        | 14/100 [00:21<02:11,  1.52s/it] 15%|‚ñà‚ñå        | 15/100 [00:22<02:08,  1.52s/it] 16%|‚ñà‚ñå        | 16/100 [00:24<02:11,  1.56s/it] 17%|‚ñà‚ñã        | 17/100 [00:26<02:14,  1.62s/it] 18%|‚ñà‚ñä        | 18/100 [00:27<02:09,  1.59s/it] 19%|‚ñà‚ñâ        | 19/100 [00:29<02:07,  1.57s/it] 20%|‚ñà‚ñà        | 20/100 [00:30<02:03,  1.54s/it] 21%|‚ñà‚ñà        | 21/100 [00:32<02:01,  1.54s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:33<01:58,  1.52s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:35<01:53,  1.48s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:36<01:49,  1.44s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:38<01:50,  1.48s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:39<01:49,  1.49s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:41<01:49,  1.51s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:42<01:47,  1.50s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:44<01:45,  1.48s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:45<01:47,  1.54s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:47<01:42,  1.49s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:48<01:41,  1.50s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:50<01:42,  1.53s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:51<01:42,  1.55s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:53<01:42,  1.57s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:54<01:38,  1.54s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:56<01:35,  1.52s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:57<01:34,  1.52s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:59<01:37,  1.60s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:01<01:32,  1.55s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:02<01:29,  1.52s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:04<01:28,  1.52s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:05<01:27,  1.54s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:07<01:29,  1.60s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:09<01:32,  1.68s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:10<01:24,  1.56s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:11<01:18,  1.48s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:13<01:13,  1.42s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:14<01:09,  1.37s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:15<01:07,  1.36s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:17<01:06,  1.36s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:18<01:03,  1.32s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:19<01:00,  1.29s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:20<00:58,  1.27s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:22<00:56,  1.26s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:23<00:55,  1.25s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:24<00:52,  1.23s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:25<00:51,  1.24s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:26<00:50,  1.24s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:28<00:48,  1.22s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:29<00:47,  1.22s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:30<00:49,  1.30s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:32<00:50,  1.36s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:33<00:49,  1.36s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:35<00:48,  1.38s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:36<00:48,  1.41s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:38<00:46,  1.41s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:39<00:46,  1.45s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:40<00:43,  1.42s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:42<00:41,  1.39s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:43<00:40,  1.41s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:45<00:40,  1.43s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:46<00:39,  1.46s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:48<00:37,  1.45s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:49<00:35,  1.43s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:50<00:33,  1.41s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:52<00:33,  1.44s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:53<00:31,  1.44s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:55<00:30,  1.45s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:56<00:29,  1.48s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:58<00:28,  1.48s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:59<00:26,  1.47s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:01<00:25,  1.49s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:02<00:23,  1.48s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:04<00:22,  1.51s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:05<00:21,  1.51s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:07<00:19,  1.50s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:08<00:17,  1.49s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:10<00:16,  1.50s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:11<00:14,  1.49s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:13<00:13,  1.51s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:14<00:12,  1.51s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:16<00:10,  1.51s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:20<00:14,  2.43s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:23<00:12,  2.58s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:25<00:09,  2.39s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:27<00:06,  2.14s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:28<00:03,  1.98s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:30<00:01,  1.83s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:31<00:00,  1.72s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:31<00:00,  1.52s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.12665
wandb: 
wandb: üöÄ View run snowy-sweep-230 at: https://wandb.ai/xzy11632/dance-dev/runs/xv7no1yi
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_193227-xv7no1yi/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: wxhtva0o with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_193628-wxhtva0o
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run feasible-sweep-231
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/wxhtva0o
[INFO][2024-03-16 19:36:33,752][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 19:36:33,850][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 19:36:33,850][dance][wrapped_func] Took 0:00:00.097363 to load and process data.
[INFO][2024-03-16 19:36:33,850][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 19:36:33,853][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 19:36:33,873][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 19:36:33,874][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 19:36:34,124][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run feasible-sweep-231 at: https://wandb.ai/xzy11632/dance-dev/runs/wxhtva0o
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_193628-wxhtva0o/logs
wandb: ERROR Run wxhtva0o errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1000) out of bounds (1000)
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: azlvlh2l with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_193655-azlvlh2l
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glamorous-sweep-232
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/azlvlh2l
[INFO][2024-03-16 19:37:00,730][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 19:37:00,881][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 19:37:00,881][dance][wrapped_func] Took 0:00:00.150192 to load and process data.
[INFO][2024-03-16 19:37:00,881][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 19:37:00,883][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 19:37:00,904][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 19:37:00,905][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 19:37:01,197][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.018 MB of 0.024 MB uploadedwandb: / 0.018 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run glamorous-sweep-232 at: https://wandb.ai/xzy11632/dance-dev/runs/azlvlh2l
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_193655-azlvlh2l/logs
wandb: ERROR Run azlvlh2l errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1000) out of bounds (1000)
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: ak9b3c4z with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_193721-ak9b3c4z
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run floral-sweep-233
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ak9b3c4z
[INFO][2024-03-16 19:37:27,125][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 19:37:27,219][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 19:37:27,219][dance][wrapped_func] Took 0:00:00.093404 to load and process data.
[INFO][2024-03-16 19:37:27,219][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 19:37:27,221][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 19:37:27,239][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 19:37:27,240][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 19:37:27,610][dance.WeightedFeaturePCA][__call__] Decomposing train features (8057, 200) (k=60)
[INFO][2024-03-16 19:37:27,610][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.12%
[INFO][2024-03-16 19:37:30,118][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 19:37:30,118][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 19:37:30,118][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 19:37:30,118][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:48,  1.09s/it]  2%|‚ñè         | 2/100 [00:02<01:56,  1.19s/it]  3%|‚ñé         | 3/100 [00:03<01:55,  1.19s/it]  4%|‚ñç         | 4/100 [00:04<01:55,  1.21s/it]  5%|‚ñå         | 5/100 [00:06<01:55,  1.21s/it]  6%|‚ñå         | 6/100 [00:07<01:55,  1.22s/it]  7%|‚ñã         | 7/100 [00:08<01:53,  1.22s/it]  8%|‚ñä         | 8/100 [00:09<01:51,  1.21s/it]  9%|‚ñâ         | 9/100 [00:10<01:49,  1.21s/it] 10%|‚ñà         | 10/100 [00:12<01:51,  1.23s/it] 11%|‚ñà         | 11/100 [00:13<02:01,  1.37s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<02:10,  1.49s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<02:12,  1.52s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<02:13,  1.55s/it] 15%|‚ñà‚ñå        | 15/100 [00:20<02:06,  1.49s/it] 16%|‚ñà‚ñå        | 16/100 [00:21<02:03,  1.47s/it] 17%|‚ñà‚ñã        | 17/100 [00:22<01:55,  1.39s/it] 18%|‚ñà‚ñä        | 18/100 [00:24<01:50,  1.35s/it] 19%|‚ñà‚ñâ        | 19/100 [00:25<01:47,  1.33s/it] 20%|‚ñà‚ñà        | 20/100 [00:26<01:45,  1.32s/it] 21%|‚ñà‚ñà        | 21/100 [00:28<01:57,  1.48s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:30<02:02,  1.58s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:31<01:55,  1.49s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:32<01:44,  1.38s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:33<01:38,  1.31s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:35<01:37,  1.32s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:36<01:34,  1.29s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:37<01:30,  1.26s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:38<01:29,  1.26s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:40<01:28,  1.27s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:41<01:28,  1.28s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:42<01:29,  1.31s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:44<01:35,  1.42s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:46<01:42,  1.55s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:48<01:47,  1.65s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:50<01:50,  1.73s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:51<01:48,  1.72s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:53<01:50,  1.78s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:55<01:47,  1.77s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:57<01:46,  1.77s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:59<01:45,  1.79s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:00<01:40,  1.74s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:02<01:40,  1.76s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:04<01:42,  1.83s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:05<01:34,  1.71s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:07<01:30,  1.68s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:09<01:30,  1.71s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:11<01:30,  1.74s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:12<01:27,  1.72s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:14<01:27,  1.75s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:16<01:26,  1.76s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:18<01:23,  1.73s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:20<01:24,  1.80s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:22<01:24,  1.84s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:23<01:22,  1.82s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:25<01:20,  1.82s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:27<01:18,  1.84s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:29<01:19,  1.88s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:31<01:15,  1.84s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:33<01:13,  1.83s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:34<01:11,  1.82s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:36<01:09,  1.83s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:38<01:08,  1.85s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:40<01:05,  1.82s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:41<01:01,  1.77s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:43<00:59,  1.76s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:45<01:00,  1.83s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:47<00:58,  1.83s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:49<00:57,  1.84s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:51<00:53,  1.79s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:52<00:51,  1.78s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:54<00:49,  1.77s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:56<00:47,  1.76s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:58<00:46,  1.79s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:00<00:45,  1.82s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:01<00:44,  1.84s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:03<00:42,  1.86s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:05<00:40,  1.83s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:07<00:37,  1.81s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:09<00:35,  1.79s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:10<00:34,  1.79s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:12<00:32,  1.79s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:14<00:31,  1.86s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:16<00:29,  1.82s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:18<00:26,  1.80s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:20<00:25,  1.81s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:22<00:24,  1.86s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:23<00:21,  1.83s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:25<00:20,  1.83s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:27<00:18,  1.82s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:29<00:16,  1.80s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:31<00:14,  1.82s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:33<00:13,  1.88s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:34<00:11,  1.86s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:36<00:09,  1.83s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:38<00:07,  1.83s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:40<00:05,  1.76s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:41<00:03,  1.61s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:42<00:01,  1.53s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:44<00:00,  1.62s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:44<00:00,  1.64s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.14664
wandb: 
wandb: üöÄ View run floral-sweep-233 at: https://wandb.ai/xzy11632/dance-dev/runs/ak9b3c4z
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_193721-ak9b3c4z/logs
wandb: Agent Starting Run: is510915 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_194110-is510915
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run elated-sweep-234
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/is510915
[INFO][2024-03-16 19:41:16,722][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 19:41:16,875][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 19:41:16,875][dance][wrapped_func] Took 0:00:00.152187 to load and process data.
[INFO][2024-03-16 19:41:16,875][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 19:41:16,878][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 19:41:16,903][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 19:41:16,905][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 19:41:18,846][dance.WeightedFeatureSVD][__call__] Decomposing train features (8057, 200) (k=56)
[INFO][2024-03-16 19:41:18,852][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.40%
[INFO][2024-03-16 19:41:21,169][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 19:41:21,169][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 19:41:21,170][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 19:41:21,170][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:57,  1.18s/it]  2%|‚ñè         | 2/100 [00:02<02:06,  1.29s/it]  3%|‚ñé         | 3/100 [00:03<01:59,  1.23s/it]  4%|‚ñç         | 4/100 [00:04<01:59,  1.25s/it]  5%|‚ñå         | 5/100 [00:06<02:05,  1.32s/it]  6%|‚ñå         | 6/100 [00:07<02:04,  1.32s/it]  7%|‚ñã         | 7/100 [00:09<02:24,  1.56s/it]  8%|‚ñä         | 8/100 [00:11<02:28,  1.62s/it]  9%|‚ñâ         | 9/100 [00:13<02:30,  1.65s/it] 10%|‚ñà         | 10/100 [00:14<02:28,  1.65s/it] 11%|‚ñà         | 11/100 [00:16<02:36,  1.76s/it] 12%|‚ñà‚ñè        | 12/100 [00:18<02:38,  1.80s/it] 13%|‚ñà‚ñé        | 13/100 [00:20<02:34,  1.77s/it] 14%|‚ñà‚ñç        | 14/100 [00:22<02:35,  1.81s/it] 15%|‚ñà‚ñå        | 15/100 [00:24<02:30,  1.77s/it] 16%|‚ñà‚ñå        | 16/100 [00:25<02:31,  1.80s/it] 17%|‚ñà‚ñã        | 17/100 [00:27<02:32,  1.84s/it] 18%|‚ñà‚ñä        | 18/100 [00:29<02:29,  1.82s/it] 19%|‚ñà‚ñâ        | 19/100 [00:31<02:27,  1.82s/it] 20%|‚ñà‚ñà        | 20/100 [00:33<02:22,  1.78s/it] 21%|‚ñà‚ñà        | 21/100 [00:35<02:25,  1.84s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:36<02:21,  1.81s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:38<02:18,  1.80s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:40<02:17,  1.81s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:42<02:13,  1.79s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:43<02:10,  1.76s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:45<02:11,  1.80s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:47<02:06,  1.75s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:49<02:05,  1.76s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:51<02:04,  1.77s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:53<02:06,  1.83s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:54<02:04,  1.83s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:56<01:59,  1.78s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:58<01:56,  1.77s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:00<01:56,  1.80s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:01<01:55,  1.81s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:04<01:59,  1.89s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:05<01:55,  1.86s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:07<01:53,  1.85s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:09<01:47,  1.80s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:11<01:47,  1.83s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:13<01:46,  1.83s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:14<01:42,  1.79s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:16<01:40,  1.79s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:18<01:38,  1.80s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:20<01:37,  1.81s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:22<01:40,  1.90s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:24<01:38,  1.89s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:26<01:35,  1.88s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:27<01:32,  1.85s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:29<01:34,  1.92s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:31<01:31,  1.90s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:33<01:28,  1.88s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:35<01:26,  1.87s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:37<01:22,  1.83s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:38<01:20,  1.82s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:40<01:18,  1.82s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:42<01:16,  1.82s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:44<01:13,  1.79s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:46<01:11,  1.79s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:47<01:05,  1.69s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:48<00:59,  1.57s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:50<00:55,  1.50s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:51<00:53,  1.50s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:53<00:54,  1.54s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:54<00:51,  1.52s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:56<00:48,  1.47s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:57<00:45,  1.41s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:58<00:42,  1.37s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:00<00:40,  1.35s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:01<00:38,  1.33s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:02<00:36,  1.30s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:03<00:34,  1.27s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:05<00:33,  1.29s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:06<00:32,  1.28s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:07<00:30,  1.27s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:08<00:29,  1.27s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:10<00:28,  1.30s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:11<00:29,  1.41s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:13<00:28,  1.43s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:14<00:26,  1.42s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:16<00:26,  1.48s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:18<00:26,  1.54s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:19<00:25,  1.58s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:21<00:24,  1.64s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:23<00:23,  1.67s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:24<00:21,  1.69s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:26<00:19,  1.60s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:27<00:16,  1.49s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:28<00:14,  1.44s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:30<00:12,  1.43s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:32<00:11,  1.50s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:33<00:11,  1.61s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:35<00:09,  1.66s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:37<00:08,  1.68s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:39<00:06,  1.71s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:40<00:05,  1.75s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:42<00:03,  1.77s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:44<00:01,  1.72s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:46<00:00,  1.69s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:46<00:00,  1.66s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.16045
wandb: 
wandb: üöÄ View run elated-sweep-234 at: https://wandb.ai/xzy11632/dance-dev/runs/is510915
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_194110-is510915/logs
wandb: Agent Starting Run: jmqmnl5c with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_194505-jmqmnl5c
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ethereal-sweep-235
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/jmqmnl5c
[INFO][2024-03-16 19:45:10,786][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 19:45:10,889][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 19:45:10,889][dance][wrapped_func] Took 0:00:00.102294 to load and process data.
[INFO][2024-03-16 19:45:10,890][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 19:45:10,892][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 19:45:10,912][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 19:45:10,913][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run ethereal-sweep-235 at: https://wandb.ai/xzy11632/dance-dev/runs/jmqmnl5c
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_194505-jmqmnl5c/logs
wandb: ERROR Run jmqmnl5c errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/cell_feature.py", line 50, in __call__
wandb: ERROR     gene_feat = gene_pca.fit_transform(feat.T)  # decompose into gene features
wandb: ERROR                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
wandb: ERROR     data_to_wrap = f(self, X, *args, **kwargs)
wandb: ERROR                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 1152, in wrapper
wandb: ERROR     return fit_method(estimator, *args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 460, in fit_transform
wandb: ERROR     U, S, Vt = self._fit(X)
wandb: ERROR                ^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 483, in _fit
wandb: ERROR     X = self._validate_data(
wandb: ERROR         ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 605, in _validate_data
wandb: ERROR     out = check_array(X, input_name="X", **check_params)
wandb: ERROR           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/validation.py", line 967, in check_array
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: Found array with 0 sample(s) (shape=(0, 8057)) while a minimum of 1 is required by PCA.
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: cky2sbii with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_194531-cky2sbii
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run comic-sweep-236
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/cky2sbii
[INFO][2024-03-16 19:45:36,908][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 19:45:36,997][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 19:45:36,997][dance][wrapped_func] Took 0:00:00.088376 to load and process data.
[INFO][2024-03-16 19:45:36,997][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 19:45:36,999][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 19:45:37,013][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 19:45:37,014][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run comic-sweep-236 at: https://wandb.ai/xzy11632/dance-dev/runs/cky2sbii
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_194531-cky2sbii/logs
wandb: ERROR Run cky2sbii errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/cell_feature.py", line 98, in __call__
wandb: ERROR     svd.fit_transform(feat)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
wandb: ERROR     data_to_wrap = f(self, X, *args, **kwargs)
wandb: ERROR                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 1145, in wrapper
wandb: ERROR     estimator._validate_params()
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 638, in _validate_params
wandb: ERROR     validate_parameter_constraints(
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_param_validation.py", line 96, in validate_parameter_constraints
wandb: ERROR     raise InvalidParameterError(
wandb: ERROR sklearn.utils._param_validation.InvalidParameterError: The 'n_components' parameter of TruncatedSVD must be an int in the range [1, inf). Got -1 instead.
wandb: ERROR 
wandb: Agent Starting Run: 4od1opts with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_194550-4od1opts
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fallen-sweep-237
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/4od1opts
[INFO][2024-03-16 19:45:55,244][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 19:45:55,336][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 19:45:55,336][dance][wrapped_func] Took 0:00:00.091891 to load and process data.
[INFO][2024-03-16 19:45:55,336][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 19:45:55,338][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 19:45:55,356][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 19:45:55,357][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 19:45:55,793][dance.WeightedFeaturePCA][__call__] Decomposing train features (8057, 200) (k=72)
[INFO][2024-03-16 19:45:55,794][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.03%
[INFO][2024-03-16 19:45:57,874][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 19:45:57,875][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 19:45:57,875][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 19:45:57,876][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:02,  1.24s/it]  2%|‚ñè         | 2/100 [00:02<02:10,  1.33s/it]  3%|‚ñé         | 3/100 [00:04<02:14,  1.38s/it]  4%|‚ñç         | 4/100 [00:05<02:16,  1.42s/it]  5%|‚ñå         | 5/100 [00:07<02:16,  1.44s/it]  6%|‚ñå         | 6/100 [00:08<02:17,  1.46s/it]  7%|‚ñã         | 7/100 [00:10<02:22,  1.53s/it]  8%|‚ñä         | 8/100 [00:12<02:31,  1.64s/it]  9%|‚ñâ         | 9/100 [00:13<02:31,  1.66s/it] 10%|‚ñà         | 10/100 [00:15<02:23,  1.59s/it] 11%|‚ñà         | 11/100 [00:16<02:18,  1.56s/it] 12%|‚ñà‚ñè        | 12/100 [00:18<02:18,  1.58s/it] 13%|‚ñà‚ñé        | 13/100 [00:20<02:25,  1.67s/it] 14%|‚ñà‚ñç        | 14/100 [00:22<02:28,  1.73s/it] 15%|‚ñà‚ñå        | 15/100 [00:23<02:29,  1.76s/it] 16%|‚ñà‚ñå        | 16/100 [00:25<02:27,  1.76s/it] 17%|‚ñà‚ñã        | 17/100 [00:27<02:28,  1.79s/it] 18%|‚ñà‚ñä        | 18/100 [00:29<02:23,  1.75s/it] 19%|‚ñà‚ñâ        | 19/100 [00:30<02:19,  1.72s/it] 20%|‚ñà‚ñà        | 20/100 [00:32<02:16,  1.70s/it] 21%|‚ñà‚ñà        | 21/100 [00:33<02:06,  1.61s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:35<02:04,  1.59s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:37<02:09,  1.69s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:39<02:12,  1.74s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:40<02:09,  1.72s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:42<02:10,  1.76s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:44<02:09,  1.78s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:46<02:09,  1.80s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:48<02:08,  1.81s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:50<02:09,  1.85s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:52<02:07,  1.85s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:53<02:02,  1.80s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:55<02:03,  1.85s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:57<01:53,  1.72s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:58<01:44,  1.61s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:59<01:40,  1.57s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:01<01:38,  1.56s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:02<01:32,  1.49s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:04<01:27,  1.43s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:05<01:25,  1.43s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:07<01:26,  1.47s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:08<01:29,  1.54s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:10<01:24,  1.48s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:11<01:21,  1.46s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:12<01:17,  1.40s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:14<01:13,  1.37s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:15<01:20,  1.51s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:17<01:17,  1.48s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:18<01:17,  1.52s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:20<01:13,  1.48s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:22<01:15,  1.55s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:23<01:16,  1.59s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:25<01:16,  1.63s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:27<01:14,  1.63s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:28<01:13,  1.64s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:30<01:13,  1.68s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:32<01:15,  1.76s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:34<01:15,  1.80s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:36<01:13,  1.79s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:37<01:10,  1.77s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:39<01:10,  1.81s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:41<01:10,  1.85s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:43<01:06,  1.80s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:44<01:00,  1.67s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:45<00:54,  1.55s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:47<00:50,  1.48s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:48<00:48,  1.46s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:50<00:45,  1.43s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:51<00:43,  1.39s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:52<00:40,  1.36s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:53<00:38,  1.33s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:55<00:36,  1.31s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:56<00:35,  1.32s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:57<00:35,  1.35s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:59<00:33,  1.35s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:00<00:32,  1.35s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:02<00:31,  1.35s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:03<00:30,  1.38s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:05<00:30,  1.47s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:06<00:29,  1.46s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:08<00:27,  1.47s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:09<00:27,  1.55s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:11<00:28,  1.65s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:13<00:27,  1.69s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:14<00:24,  1.61s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:16<00:22,  1.59s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:17<00:19,  1.50s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:19<00:17,  1.48s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:20<00:16,  1.51s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:22<00:16,  1.61s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:24<00:14,  1.56s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:25<00:12,  1.55s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:27<00:11,  1.58s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:28<00:09,  1.63s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:30<00:08,  1.68s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:32<00:07,  1.79s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:34<00:05,  1.83s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:36<00:03,  1.81s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:38<00:01,  1.82s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:40<00:00,  1.81s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:40<00:00,  1.60s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.017 MB of 0.025 MB uploadedwandb: | 0.017 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.15927
wandb: 
wandb: üöÄ View run fallen-sweep-237 at: https://wandb.ai/xzy11632/dance-dev/runs/4od1opts
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_194550-4od1opts/logs
wandb: Agent Starting Run: rn5ann1o with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_195000-rn5ann1o
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run super-sweep-238
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/rn5ann1o
[INFO][2024-03-16 19:50:06,071][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 19:50:06,170][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 19:50:06,170][dance][wrapped_func] Took 0:00:00.098275 to load and process data.
[INFO][2024-03-16 19:50:06,170][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 19:50:06,172][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 19:50:06,354][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 19:50:06,356][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 19:50:07,916][dance.WeightedFeatureSVD][__call__] Decomposing train features (8057, 200) (k=67)
[INFO][2024-03-16 19:50:07,919][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.14%
[INFO][2024-03-16 19:50:09,929][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 19:50:09,929][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 19:50:09,929][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 19:50:09,929][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:04,  1.26s/it]  2%|‚ñè         | 2/100 [00:02<01:49,  1.12s/it]  3%|‚ñé         | 3/100 [00:03<01:46,  1.09s/it]  4%|‚ñç         | 4/100 [00:04<01:43,  1.08s/it]  5%|‚ñå         | 5/100 [00:05<01:42,  1.08s/it]  6%|‚ñå         | 6/100 [00:06<01:41,  1.08s/it]  7%|‚ñã         | 7/100 [00:07<01:38,  1.06s/it]  8%|‚ñä         | 8/100 [00:08<01:40,  1.09s/it]  9%|‚ñâ         | 9/100 [00:09<01:43,  1.14s/it] 10%|‚ñà         | 10/100 [00:11<01:46,  1.18s/it] 11%|‚ñà         | 11/100 [00:12<01:56,  1.31s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<02:06,  1.43s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<02:08,  1.48s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<02:10,  1.52s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<02:04,  1.47s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<02:02,  1.45s/it] 17%|‚ñà‚ñã        | 17/100 [00:22<02:06,  1.52s/it] 18%|‚ñà‚ñä        | 18/100 [00:23<02:08,  1.56s/it] 19%|‚ñà‚ñâ        | 19/100 [00:25<02:09,  1.60s/it] 20%|‚ñà‚ñà        | 20/100 [00:27<02:09,  1.61s/it] 21%|‚ñà‚ñà        | 21/100 [00:28<02:07,  1.61s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:30<02:08,  1.65s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:32<02:08,  1.67s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:33<02:06,  1.67s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:35<02:04,  1.66s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:37<02:03,  1.67s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:38<02:01,  1.66s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:40<01:55,  1.61s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:41<01:50,  1.55s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:43<01:44,  1.50s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:44<01:39,  1.45s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:46<01:39,  1.47s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:47<01:36,  1.44s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:48<01:34,  1.43s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:50<01:29,  1.37s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:51<01:25,  1.34s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:52<01:23,  1.33s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:53<01:19,  1.29s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:55<01:24,  1.38s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:56<01:20,  1.34s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:58<01:24,  1.43s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:59<01:26,  1.50s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:01<01:30,  1.58s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:03<01:26,  1.55s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:04<01:26,  1.57s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:06<01:24,  1.57s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:08<01:24,  1.59s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:09<01:23,  1.60s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:11<01:23,  1.63s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:13<01:21,  1.63s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:14<01:20,  1.65s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:16<01:22,  1.73s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:17<01:16,  1.62s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:19<01:08,  1.49s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:20<01:07,  1.49s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:22<01:08,  1.56s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:23<01:01,  1.42s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:24<00:57,  1.38s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:25<00:54,  1.33s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:27<00:53,  1.33s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:28<00:51,  1.31s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:29<00:48,  1.28s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:31<00:50,  1.37s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:32<00:51,  1.42s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:34<00:52,  1.50s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:36<00:51,  1.51s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:37<00:51,  1.57s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:39<00:47,  1.47s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:40<00:44,  1.44s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:41<00:41,  1.37s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:43<00:41,  1.43s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:44<00:41,  1.47s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:46<00:42,  1.57s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:48<00:40,  1.57s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:49<00:40,  1.61s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:51<00:37,  1.58s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:52<00:35,  1.56s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:54<00:32,  1.49s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:55<00:30,  1.43s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:56<00:28,  1.42s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:58<00:26,  1.41s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:59<00:27,  1.51s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:01<00:26,  1.54s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:03<00:25,  1.59s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:04<00:24,  1.61s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:06<00:22,  1.64s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:08<00:21,  1.62s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:09<00:19,  1.60s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:11<00:17,  1.62s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:13<00:15,  1.59s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:14<00:14,  1.56s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:15<00:12,  1.52s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:17<00:10,  1.49s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:18<00:08,  1.48s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:19<00:06,  1.38s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:21<00:06,  1.50s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:22<00:04,  1.42s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:24<00:02,  1.37s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:25<00:01,  1.32s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:26<00:00,  1.33s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:26<00:00,  1.47s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.017 MB of 0.025 MB uploadedwandb: | 0.017 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.13249
wandb: 
wandb: üöÄ View run super-sweep-238 at: https://wandb.ai/xzy11632/dance-dev/runs/rn5ann1o
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_195000-rn5ann1o/logs
wandb: Agent Starting Run: 49sl1u73 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_195343-49sl1u73
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wise-sweep-239
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/49sl1u73
[INFO][2024-03-16 19:53:49,348][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 19:53:49,456][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 19:53:49,457][dance][wrapped_func] Took 0:00:00.107441 to load and process data.
[INFO][2024-03-16 19:53:49,457][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 19:53:49,459][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 19:53:49,480][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 19:53:49,481][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 19:53:50,182][dance.WeightedFeaturePCA][__call__] Decomposing train features (8057, 200) (k=58)
[INFO][2024-03-16 19:53:50,183][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.01%
[INFO][2024-03-16 19:53:52,253][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 19:53:52,253][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 19:53:52,253][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 19:53:52,253][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:08,  1.29s/it]  2%|‚ñè         | 2/100 [00:02<02:07,  1.30s/it]  3%|‚ñé         | 3/100 [00:03<01:58,  1.22s/it]  4%|‚ñç         | 4/100 [00:04<01:53,  1.18s/it]  5%|‚ñå         | 5/100 [00:06<01:57,  1.24s/it]  6%|‚ñå         | 6/100 [00:07<01:55,  1.23s/it]  7%|‚ñã         | 7/100 [00:08<01:56,  1.25s/it]  8%|‚ñä         | 8/100 [00:10<02:02,  1.33s/it]  9%|‚ñâ         | 9/100 [00:11<02:11,  1.45s/it] 10%|‚ñà         | 10/100 [00:13<02:18,  1.54s/it] 11%|‚ñà         | 11/100 [00:15<02:22,  1.61s/it] 12%|‚ñà‚ñè        | 12/100 [00:17<02:27,  1.68s/it] 13%|‚ñà‚ñé        | 13/100 [00:18<02:20,  1.62s/it] 14%|‚ñà‚ñç        | 14/100 [00:20<02:17,  1.60s/it] 15%|‚ñà‚ñå        | 15/100 [00:21<02:13,  1.57s/it] 16%|‚ñà‚ñå        | 16/100 [00:23<02:19,  1.66s/it] 17%|‚ñà‚ñã        | 17/100 [00:25<02:23,  1.72s/it] 18%|‚ñà‚ñä        | 18/100 [00:27<02:23,  1.75s/it] 19%|‚ñà‚ñâ        | 19/100 [00:29<02:24,  1.78s/it] 20%|‚ñà‚ñà        | 20/100 [00:30<02:20,  1.76s/it] 21%|‚ñà‚ñà        | 21/100 [00:32<02:10,  1.66s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:33<01:59,  1.53s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:34<01:55,  1.50s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:36<01:51,  1.47s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:37<01:47,  1.44s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:39<01:45,  1.43s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:40<01:44,  1.44s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:42<01:51,  1.54s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:44<01:56,  1.63s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:45<01:55,  1.64s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:47<01:56,  1.69s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:49<01:58,  1.75s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:51<01:58,  1.77s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:53<01:55,  1.75s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:54<01:53,  1.74s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:56<01:49,  1.70s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:58<01:48,  1.73s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:59<01:46,  1.72s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:01<01:46,  1.75s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:03<01:45,  1.76s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:05<01:42,  1.74s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:07<01:41,  1.76s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:08<01:39,  1.74s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:10<01:35,  1.71s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:12<01:34,  1.71s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:13<01:31,  1.70s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:15<01:32,  1.74s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:17<01:29,  1.72s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:19<01:30,  1.77s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:20<01:24,  1.69s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:21<01:16,  1.57s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:23<01:11,  1.49s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:24<01:10,  1.49s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:26<01:07,  1.46s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:27<01:06,  1.48s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:29<01:06,  1.51s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:30<01:02,  1.46s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:31<00:58,  1.38s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:33<00:54,  1.34s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:34<00:51,  1.30s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:35<00:49,  1.26s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:36<00:47,  1.25s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:37<00:45,  1.23s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:38<00:43,  1.22s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:40<00:42,  1.23s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:41<00:42,  1.24s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:42<00:41,  1.25s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:44<00:40,  1.27s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:45<00:39,  1.27s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:46<00:37,  1.26s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:47<00:36,  1.26s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:49<00:35,  1.28s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:50<00:34,  1.27s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:52<00:35,  1.36s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:53<00:34,  1.38s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:54<00:33,  1.39s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:56<00:32,  1.42s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:57<00:30,  1.38s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:59<00:31,  1.51s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:01<00:32,  1.63s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:03<00:31,  1.65s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:04<00:30,  1.70s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:06<00:29,  1.76s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:08<00:28,  1.76s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:09<00:24,  1.63s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:11<00:22,  1.61s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:13<00:21,  1.62s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:14<00:20,  1.68s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:16<00:18,  1.68s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:18<00:16,  1.70s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:20<00:15,  1.74s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:21<00:13,  1.68s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:23<00:11,  1.61s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:24<00:09,  1.55s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:25<00:07,  1.46s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:27<00:05,  1.48s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:28<00:04,  1.45s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:29<00:02,  1.41s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:31<00:01,  1.51s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:33<00:00,  1.64s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:33<00:00,  1.54s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.16442
wandb: 
wandb: üöÄ View run wise-sweep-239 at: https://wandb.ai/xzy11632/dance-dev/runs/49sl1u73
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_195343-49sl1u73/logs
wandb: Agent Starting Run: 9etxnnvw with config:
wandb: 	pipeline.0.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_195749-9etxnnvw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fresh-sweep-240
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/9etxnnvw
[INFO][2024-03-16 19:57:55,775][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 19:57:55,880][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 19:57:55,880][dance][wrapped_func] Took 0:00:00.103534 to load and process data.
[INFO][2024-03-16 19:57:55,880][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 19:57:55,883][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesPlaceHolder',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 19:57:55,902][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 19:57:55,903][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 19:57:57,493][dance.WeightedFeatureSVD][__call__] Decomposing train features (8057, 200) (k=54)
[INFO][2024-03-16 19:57:57,499][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.28%
[INFO][2024-03-16 19:57:59,327][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 19:57:59,328][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 19:57:59,328][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 19:57:59,328][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:46,  1.08s/it]  2%|‚ñè         | 2/100 [00:02<01:49,  1.11s/it]  3%|‚ñé         | 3/100 [00:03<01:53,  1.17s/it]  4%|‚ñç         | 4/100 [00:04<01:52,  1.17s/it]  5%|‚ñå         | 5/100 [00:05<01:52,  1.18s/it]  6%|‚ñå         | 6/100 [00:07<01:51,  1.19s/it]  7%|‚ñã         | 7/100 [00:08<01:51,  1.20s/it]  8%|‚ñä         | 8/100 [00:09<01:50,  1.21s/it]  9%|‚ñâ         | 9/100 [00:10<01:54,  1.26s/it] 10%|‚ñà         | 10/100 [00:11<01:48,  1.21s/it] 11%|‚ñà         | 11/100 [00:12<01:43,  1.16s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:45,  1.19s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:39,  1.14s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:38,  1.14s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:42,  1.20s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:43,  1.23s/it] 17%|‚ñà‚ñã        | 17/100 [00:20<01:41,  1.23s/it] 18%|‚ñà‚ñä        | 18/100 [00:21<01:40,  1.22s/it] 19%|‚ñà‚ñâ        | 19/100 [00:22<01:39,  1.23s/it] 20%|‚ñà‚ñà        | 20/100 [00:24<01:41,  1.27s/it] 21%|‚ñà‚ñà        | 21/100 [00:25<01:48,  1.37s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:27<01:54,  1.47s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:29<02:00,  1.56s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:30<01:58,  1.55s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:32<01:54,  1.52s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:33<01:50,  1.50s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:35<01:51,  1.53s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:36<01:51,  1.54s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:38<01:46,  1.50s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:39<01:44,  1.50s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:41<01:43,  1.51s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:42<01:42,  1.51s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:44<01:38,  1.48s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:45<01:29,  1.36s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:46<01:22,  1.27s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:47<01:20,  1.26s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:48<01:18,  1.25s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:49<01:16,  1.23s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:51<01:13,  1.21s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:52<01:16,  1.28s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:54<01:20,  1.36s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:55<01:21,  1.41s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:56<01:19,  1.40s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:58<01:20,  1.44s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:59<01:19,  1.45s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:01<01:23,  1.54s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:03<01:24,  1.59s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:04<01:22,  1.58s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:06<01:21,  1.60s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:08<01:23,  1.66s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:10<01:22,  1.68s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:11<01:14,  1.56s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:12<01:10,  1.50s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:13<01:04,  1.41s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:15<01:06,  1.48s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:17<01:05,  1.48s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:18<01:07,  1.56s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:20<01:05,  1.56s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:21<01:03,  1.55s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:23<01:02,  1.56s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:25<01:01,  1.57s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:26<01:00,  1.60s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:28<00:58,  1.57s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:30<00:58,  1.62s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:31<00:55,  1.60s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:33<00:53,  1.58s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:34<00:50,  1.54s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:35<00:47,  1.48s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:37<00:44,  1.44s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:38<00:43,  1.45s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:40<00:44,  1.53s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:42<00:43,  1.54s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:43<00:41,  1.55s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:45<00:39,  1.52s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:46<00:35,  1.42s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:47<00:34,  1.46s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:49<00:33,  1.47s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:50<00:31,  1.42s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:51<00:28,  1.34s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:53<00:26,  1.33s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:54<00:24,  1.31s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:55<00:23,  1.29s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:56<00:21,  1.27s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:57<00:19,  1.25s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:59<00:18,  1.22s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:00<00:16,  1.21s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:01<00:15,  1.19s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:02<00:14,  1.19s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:03<00:13,  1.19s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:05<00:11,  1.19s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:06<00:10,  1.20s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:07<00:10,  1.28s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:09<00:09,  1.35s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:10<00:07,  1.32s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:11<00:06,  1.27s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:12<00:04,  1.25s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:13<00:03,  1.21s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:15<00:02,  1.20s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:16<00:01,  1.21s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:17<00:00,  1.20s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:17<00:00,  1.38s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.018 MB of 0.025 MB uploadedwandb: / 0.018 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.13494
wandb: 
wandb: üöÄ View run fresh-sweep-240 at: https://wandb.ai/xzy11632/dance-dev/runs/9etxnnvw
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_195749-9etxnnvw/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: sp9xgql0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_200146-sp9xgql0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run quiet-sweep-241
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/sp9xgql0
[INFO][2024-03-16 20:01:52,682][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 20:01:52,830][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 20:01:52,830][dance][wrapped_func] Took 0:00:00.146518 to load and process data.
[INFO][2024-03-16 20:01:52,830][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 20:01:52,833][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'Log1P',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 20:01:52,853][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:01:52,853][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:01:53,091][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:01:53,099][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 20:01:55,942][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 919) (k=493)
[INFO][2024-03-16 20:01:55,943][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.01%
[INFO][2024-03-16 20:01:58,635][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 20:01:58,636][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 20:01:58,636][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 20:01:58,636][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:47,  1.69s/it]  2%|‚ñè         | 2/100 [00:03<02:45,  1.69s/it]  3%|‚ñé         | 3/100 [00:05<02:42,  1.67s/it]  4%|‚ñç         | 4/100 [00:06<02:37,  1.64s/it]  5%|‚ñå         | 5/100 [00:08<02:28,  1.57s/it]  6%|‚ñå         | 6/100 [00:09<02:30,  1.60s/it]  7%|‚ñã         | 7/100 [00:11<02:26,  1.57s/it]  8%|‚ñä         | 8/100 [00:12<02:21,  1.54s/it]  9%|‚ñâ         | 9/100 [00:14<02:21,  1.55s/it] 10%|‚ñà         | 10/100 [00:15<02:16,  1.51s/it] 11%|‚ñà         | 11/100 [00:17<02:17,  1.55s/it] 12%|‚ñà‚ñè        | 12/100 [00:18<02:15,  1.54s/it] 13%|‚ñà‚ñé        | 13/100 [00:20<02:11,  1.51s/it] 14%|‚ñà‚ñç        | 14/100 [00:21<02:09,  1.51s/it] 15%|‚ñà‚ñå        | 15/100 [00:23<02:05,  1.48s/it] 16%|‚ñà‚ñå        | 16/100 [00:24<01:57,  1.40s/it] 17%|‚ñà‚ñã        | 17/100 [00:25<01:52,  1.35s/it] 18%|‚ñà‚ñä        | 18/100 [00:26<01:47,  1.31s/it] 19%|‚ñà‚ñâ        | 19/100 [00:28<01:45,  1.30s/it] 20%|‚ñà‚ñà        | 20/100 [00:29<01:42,  1.29s/it] 21%|‚ñà‚ñà        | 21/100 [00:30<01:44,  1.32s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:31<01:39,  1.28s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:33<01:36,  1.25s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:34<01:36,  1.27s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:35<01:33,  1.25s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:36<01:31,  1.23s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:38<01:29,  1.22s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:39<01:27,  1.21s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:40<01:24,  1.19s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:41<01:23,  1.19s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:42<01:21,  1.19s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:43<01:20,  1.18s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:45<01:19,  1.19s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:46<01:19,  1.21s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:47<01:18,  1.21s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:48<01:17,  1.22s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:50<01:16,  1.21s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:51<01:15,  1.22s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:52<01:14,  1.22s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:53<01:13,  1.22s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:54<01:12,  1.23s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:56<01:10,  1.22s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:57<01:10,  1.24s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:58<01:08,  1.22s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:59<01:06,  1.21s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:01<01:08,  1.27s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:02<01:06,  1.25s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:03<01:03,  1.22s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:06<01:22,  1.61s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:07<01:16,  1.53s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:08<01:11,  1.45s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:09<01:06,  1.38s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:11<01:04,  1.38s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:12<01:01,  1.33s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:13<00:59,  1.32s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:15<00:58,  1.33s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:16<00:55,  1.29s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:17<00:54,  1.31s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:18<00:52,  1.28s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:20<00:51,  1.28s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:21<00:49,  1.27s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:22<00:47,  1.24s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:23<00:45,  1.24s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:25<00:46,  1.29s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:26<00:44,  1.27s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:27<00:42,  1.25s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:29<00:42,  1.28s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:30<00:39,  1.25s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:31<00:38,  1.26s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:32<00:38,  1.27s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:34<00:37,  1.29s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:35<00:35,  1.27s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:36<00:34,  1.27s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:38<00:34,  1.32s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:39<00:32,  1.30s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:40<00:30,  1.28s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:41<00:29,  1.28s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:43<00:28,  1.29s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:44<00:26,  1.28s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:45<00:26,  1.31s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:47<00:24,  1.31s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:48<00:24,  1.34s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:49<00:23,  1.37s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:51<00:22,  1.38s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:52<00:20,  1.37s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:53<00:18,  1.34s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:55<00:17,  1.34s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:56<00:15,  1.32s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:57<00:14,  1.31s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:59<00:13,  1.38s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:00<00:12,  1.39s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:02<00:10,  1.37s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:03<00:09,  1.35s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:04<00:07,  1.33s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:06<00:06,  1.33s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:07<00:05,  1.30s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:08<00:03,  1.29s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:09<00:02,  1.27s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:11<00:01,  1.30s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:12<00:00,  1.35s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:12<00:00,  1.33s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.021 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.28926
wandb: 
wandb: üöÄ View run quiet-sweep-241 at: https://wandb.ai/xzy11632/dance-dev/runs/sp9xgql0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_200146-sp9xgql0/logs
wandb: Agent Starting Run: 6ucgmmt2 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_200522-6ucgmmt2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run feasible-sweep-242
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/6ucgmmt2
[INFO][2024-03-16 20:05:28,513][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 20:05:28,788][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 20:05:28,789][dance][wrapped_func] Took 0:00:00.275040 to load and process data.
[INFO][2024-03-16 20:05:28,789][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 20:05:28,791][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'Log1P',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 20:05:28,810][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:05:28,811][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:05:29,135][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:05:29,143][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 20:05:38,032][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 919) (k=612)
[INFO][2024-03-16 20:05:38,033][dance.WeightedFeatureSVD][__call__] Total explained variance: 93.63%
[INFO][2024-03-16 20:05:40,419][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 20:05:40,420][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 20:05:40,420][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 20:05:40,420][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:33,  1.55s/it]  2%|‚ñè         | 2/100 [00:03<02:28,  1.52s/it]  3%|‚ñé         | 3/100 [00:04<02:25,  1.50s/it]  4%|‚ñç         | 4/100 [00:06<02:28,  1.55s/it]  5%|‚ñå         | 5/100 [00:07<02:33,  1.62s/it]  6%|‚ñå         | 6/100 [00:09<02:31,  1.62s/it]  7%|‚ñã         | 7/100 [00:11<02:27,  1.59s/it]  8%|‚ñä         | 8/100 [00:12<02:24,  1.57s/it]  9%|‚ñâ         | 9/100 [00:14<02:25,  1.60s/it] 10%|‚ñà         | 10/100 [00:16<02:29,  1.66s/it] 11%|‚ñà         | 11/100 [00:17<02:26,  1.65s/it] 12%|‚ñà‚ñè        | 12/100 [00:19<02:20,  1.60s/it] 13%|‚ñà‚ñé        | 13/100 [00:20<02:17,  1.58s/it] 14%|‚ñà‚ñç        | 14/100 [00:22<02:15,  1.58s/it] 15%|‚ñà‚ñå        | 15/100 [00:23<02:09,  1.53s/it] 16%|‚ñà‚ñå        | 16/100 [00:25<02:08,  1.53s/it] 17%|‚ñà‚ñã        | 17/100 [00:26<02:06,  1.53s/it] 18%|‚ñà‚ñä        | 18/100 [00:28<02:08,  1.56s/it] 19%|‚ñà‚ñâ        | 19/100 [00:29<02:07,  1.58s/it] 20%|‚ñà‚ñà        | 20/100 [00:31<02:03,  1.55s/it] 21%|‚ñà‚ñà        | 21/100 [00:33<02:02,  1.55s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:34<01:58,  1.53s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:36<01:57,  1.53s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:37<01:59,  1.57s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:39<01:54,  1.53s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:40<01:51,  1.51s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:42<01:54,  1.56s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:43<01:55,  1.61s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:45<01:53,  1.60s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:47<01:54,  1.64s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:48<01:51,  1.62s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:50<01:50,  1.63s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:52<01:49,  1.63s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:53<01:45,  1.59s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:55<01:42,  1.57s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:56<01:43,  1.62s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:58<01:42,  1.63s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:00<01:38,  1.60s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:01<01:36,  1.58s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:03<01:34,  1.57s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:04<01:32,  1.56s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:06<01:30,  1.57s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:07<01:30,  1.59s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:09<01:26,  1.54s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:10<01:21,  1.49s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:12<01:19,  1.47s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:13<01:15,  1.42s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:14<01:12,  1.40s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:16<01:11,  1.40s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:17<01:09,  1.39s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:18<01:06,  1.36s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:20<01:05,  1.37s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:21<01:04,  1.37s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:22<01:02,  1.36s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:24<01:08,  1.53s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:26<01:06,  1.52s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:27<01:02,  1.45s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:29<01:00,  1.45s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:30<00:58,  1.42s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:31<00:55,  1.40s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:33<00:54,  1.40s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:34<00:52,  1.38s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:35<00:50,  1.37s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:37<00:51,  1.44s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:38<00:50,  1.44s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:40<00:48,  1.42s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:41<00:46,  1.40s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:43<00:44,  1.40s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:44<00:43,  1.40s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:45<00:41,  1.38s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:47<00:39,  1.35s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:48<00:37,  1.35s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:49<00:36,  1.34s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:51<00:34,  1.33s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:52<00:33,  1.33s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:53<00:32,  1.36s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:55<00:31,  1.38s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:56<00:30,  1.41s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:58<00:29,  1.41s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:59<00:28,  1.41s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:00<00:26,  1.39s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:02<00:25,  1.42s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:03<00:23,  1.40s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:05<00:22,  1.39s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:06<00:20,  1.37s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:07<00:19,  1.39s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:09<00:18,  1.42s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:10<00:16,  1.41s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:12<00:15,  1.42s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:13<00:14,  1.43s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:15<00:12,  1.43s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:16<00:11,  1.43s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:17<00:09,  1.42s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:19<00:08,  1.45s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:20<00:07,  1.44s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:22<00:05,  1.42s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:23<00:04,  1.43s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:25<00:02,  1.43s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:26<00:01,  1.42s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:27<00:00,  1.41s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:27<00:00,  1.48s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.25545
wandb: 
wandb: üöÄ View run feasible-sweep-242 at: https://wandb.ai/xzy11632/dance-dev/runs/6ucgmmt2
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_200522-6ucgmmt2/logs
wandb: Agent Starting Run: std8j55u with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_200926-std8j55u
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run young-sweep-243
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/std8j55u
[INFO][2024-03-16 20:09:32,109][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 20:09:32,190][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 20:09:32,191][dance][wrapped_func] Took 0:00:00.081381 to load and process data.
[INFO][2024-03-16 20:09:32,191][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 20:09:32,193][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'Log1P',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 20:09:32,212][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:09:32,517][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 20:09:32,663][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run young-sweep-243 at: https://wandb.ai/xzy11632/dance-dev/runs/std8j55u
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_200926-std8j55u/logs
wandb: ERROR Run std8j55u errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1081) out of bounds (919)
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: nkanoatt with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_200952-nkanoatt
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run deep-sweep-244
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/nkanoatt
[INFO][2024-03-16 20:09:58,094][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 20:09:58,199][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 20:09:58,199][dance][wrapped_func] Took 0:00:00.104230 to load and process data.
[INFO][2024-03-16 20:09:58,199][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 20:09:58,201][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'Log1P',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 20:09:58,222][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:09:58,433][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-16 20:09:58,577][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run deep-sweep-244 at: https://wandb.ai/xzy11632/dance-dev/runs/nkanoatt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_200952-nkanoatt/logs
wandb: ERROR Run nkanoatt errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1081) out of bounds (919)
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: nlylrzql with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_201019-nlylrzql
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run young-sweep-245
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/nlylrzql
[INFO][2024-03-16 20:10:24,110][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 20:10:24,209][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 20:10:24,209][dance][wrapped_func] Took 0:00:00.098336 to load and process data.
[INFO][2024-03-16 20:10:24,209][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 20:10:24,211][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'Log1P',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 20:10:24,230][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:10:24,368][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 20:10:24,721][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=124)
[INFO][2024-03-16 20:10:24,722][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.11%
[INFO][2024-03-16 20:10:26,652][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 20:10:26,652][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 20:10:26,652][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 20:10:26,652][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:20,  1.42s/it]  2%|‚ñè         | 2/100 [00:02<02:14,  1.37s/it]  3%|‚ñé         | 3/100 [00:04<02:11,  1.35s/it]  4%|‚ñç         | 4/100 [00:05<02:12,  1.38s/it]  5%|‚ñå         | 5/100 [00:06<02:09,  1.36s/it]  6%|‚ñå         | 6/100 [00:08<02:05,  1.34s/it]  7%|‚ñã         | 7/100 [00:09<02:04,  1.33s/it]  8%|‚ñä         | 8/100 [00:10<02:06,  1.37s/it]  9%|‚ñâ         | 9/100 [00:12<02:03,  1.36s/it] 10%|‚ñà         | 10/100 [00:13<02:01,  1.35s/it] 11%|‚ñà         | 11/100 [00:14<01:59,  1.34s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<01:55,  1.31s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<01:52,  1.29s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<01:50,  1.29s/it] 15%|‚ñà‚ñå        | 15/100 [00:20<01:51,  1.31s/it] 16%|‚ñà‚ñå        | 16/100 [00:21<01:55,  1.37s/it] 17%|‚ñà‚ñã        | 17/100 [00:23<01:57,  1.42s/it] 18%|‚ñà‚ñä        | 18/100 [00:24<02:01,  1.48s/it] 19%|‚ñà‚ñâ        | 19/100 [00:26<02:06,  1.56s/it] 20%|‚ñà‚ñà        | 20/100 [00:28<02:09,  1.61s/it] 21%|‚ñà‚ñà        | 21/100 [00:30<02:12,  1.68s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:31<02:11,  1.69s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:33<02:12,  1.71s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:35<02:10,  1.72s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:36<02:08,  1.72s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:38<02:07,  1.72s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:40<02:05,  1.72s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:42<02:02,  1.70s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:43<02:00,  1.70s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:45<01:59,  1.70s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:47<02:02,  1.77s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:49<01:59,  1.76s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:50<01:55,  1.73s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:52<01:53,  1.72s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:54<01:51,  1.72s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:55<01:49,  1.71s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:57<01:47,  1.71s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:59<01:45,  1.71s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:00<01:43,  1.70s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:02<01:44,  1.74s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:04<01:42,  1.74s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:06<01:40,  1.74s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:08<01:39,  1.75s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:09<01:38,  1.75s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:11<01:35,  1.73s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:13<01:33,  1.73s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:14<01:30,  1.71s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:16<01:29,  1.72s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:18<01:28,  1.73s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:20<01:28,  1.77s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:21<01:25,  1.75s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:23<01:22,  1.73s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:25<01:20,  1.72s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:27<01:19,  1.73s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:28<01:17,  1.72s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:30<01:16,  1.73s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:32<01:14,  1.72s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:33<01:12,  1.72s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:35<01:10,  1.71s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:37<01:10,  1.76s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:39<01:08,  1.75s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:40<01:05,  1.73s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:42<01:04,  1.73s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:44<01:01,  1.72s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:46<00:59,  1.71s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:47<00:58,  1.71s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:49<00:56,  1.70s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:51<00:54,  1.69s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:52<00:52,  1.68s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:54<00:51,  1.73s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:56<00:50,  1.73s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:58<00:48,  1.72s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:59<00:46,  1.71s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:01<00:44,  1.72s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:03<00:42,  1.71s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:04<00:40,  1.71s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:06<00:38,  1.69s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:08<00:37,  1.72s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:10<00:38,  1.81s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:12<00:35,  1.79s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:13<00:33,  1.77s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:15<00:31,  1.76s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:17<00:29,  1.74s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:18<00:27,  1.75s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:20<00:26,  1.74s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:22<00:24,  1.73s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:24<00:22,  1.72s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:25<00:21,  1.75s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:27<00:19,  1.77s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:29<00:17,  1.78s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:31<00:16,  1.78s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:33<00:14,  1.77s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:34<00:12,  1.77s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:36<00:10,  1.75s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:38<00:08,  1.76s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:40<00:06,  1.75s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:41<00:05,  1.74s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:43<00:03,  1.78s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:45<00:01,  1.74s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:47<00:00,  1.73s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:47<00:00,  1.67s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.018 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.30117
wandb: 
wandb: üöÄ View run young-sweep-245 at: https://wandb.ai/xzy11632/dance-dev/runs/nlylrzql
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_201019-nlylrzql/logs
wandb: Agent Starting Run: odk6j9fu with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_201504-odk6j9fu
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run genial-sweep-246
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/odk6j9fu
[INFO][2024-03-16 20:15:09,131][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 20:15:09,228][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 20:15:09,229][dance][wrapped_func] Took 0:00:00.096950 to load and process data.
[INFO][2024-03-16 20:15:09,229][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 20:15:09,231][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'Log1P',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 20:15:09,253][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:15:09,406][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 20:15:11,635][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=120)
[INFO][2024-03-16 20:15:11,638][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.03%
[INFO][2024-03-16 20:15:13,542][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 20:15:13,542][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 20:15:13,542][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 20:15:13,542][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:10,  1.32s/it]  2%|‚ñè         | 2/100 [00:02<02:00,  1.23s/it]  3%|‚ñé         | 3/100 [00:03<01:55,  1.19s/it]  4%|‚ñç         | 4/100 [00:04<01:52,  1.18s/it]  5%|‚ñå         | 5/100 [00:05<01:49,  1.15s/it]  6%|‚ñå         | 6/100 [00:07<01:47,  1.14s/it]  7%|‚ñã         | 7/100 [00:08<01:53,  1.22s/it]  8%|‚ñä         | 8/100 [00:09<01:50,  1.21s/it]  9%|‚ñâ         | 9/100 [00:10<01:49,  1.20s/it] 10%|‚ñà         | 10/100 [00:12<01:52,  1.26s/it] 11%|‚ñà         | 11/100 [00:13<01:55,  1.30s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:55,  1.31s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:56,  1.33s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:59,  1.39s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<02:04,  1.46s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<02:03,  1.47s/it] 17%|‚ñà‚ñã        | 17/100 [00:22<02:13,  1.61s/it] 18%|‚ñà‚ñä        | 18/100 [00:24<02:19,  1.70s/it] 19%|‚ñà‚ñâ        | 19/100 [00:26<02:23,  1.77s/it] 20%|‚ñà‚ñà        | 20/100 [00:28<02:25,  1.82s/it] 21%|‚ñà‚ñà        | 21/100 [00:30<02:23,  1.81s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:32<02:23,  1.85s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:34<02:21,  1.84s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:35<02:18,  1.82s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:37<02:15,  1.80s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:39<02:07,  1.72s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:40<02:02,  1.68s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:42<02:11,  1.83s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:45<02:14,  1.89s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:46<02:10,  1.87s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:48<02:09,  1.87s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:50<02:08,  1.88s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:52<02:10,  1.95s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:54<02:07,  1.93s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:56<02:06,  1.95s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:58<02:02,  1.91s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:00<01:58,  1.89s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:02<01:59,  1.93s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:03<01:48,  1.78s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:05<01:39,  1.66s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:06<01:34,  1.60s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:08<01:37,  1.68s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:10<01:37,  1.71s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:12<01:38,  1.76s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:13<01:38,  1.80s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:15<01:37,  1.81s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:17<01:37,  1.83s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:20<01:46,  2.06s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:22<01:43,  2.03s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:24<01:37,  1.96s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:25<01:36,  1.96s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:27<01:33,  1.94s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:29<01:29,  1.91s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:31<01:28,  1.92s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:33<01:28,  1.97s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:35<01:24,  1.91s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:37<01:20,  1.88s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:39<01:17,  1.84s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:40<01:15,  1.84s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:42<01:09,  1.73s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:44<01:07,  1.72s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:45<01:02,  1.66s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:47<01:01,  1.66s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:48<00:59,  1.64s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:50<00:54,  1.55s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:51<00:51,  1.51s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:53<00:51,  1.56s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:54<00:51,  1.60s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:56<00:51,  1.66s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:58<00:50,  1.68s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:00<00:49,  1.70s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:01<00:47,  1.71s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:03<00:46,  1.73s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:05<00:45,  1.74s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:07<00:43,  1.73s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:08<00:41,  1.74s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:10<00:40,  1.76s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:12<00:38,  1.76s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:14<00:36,  1.75s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:16<00:35,  1.77s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:17<00:33,  1.79s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:19<00:31,  1.77s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:21<00:32,  1.91s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:23<00:30,  1.88s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:25<00:27,  1.83s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:26<00:24,  1.74s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:28<00:22,  1.72s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:30<00:21,  1.77s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:32<00:19,  1.80s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:34<00:17,  1.78s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:35<00:16,  1.80s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:37<00:14,  1.81s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:39<00:12,  1.80s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:41<00:10,  1.76s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:42<00:08,  1.65s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:44<00:06,  1.64s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:45<00:04,  1.66s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:47<00:03,  1.69s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:49<00:01,  1.67s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:51<00:00,  1.67s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:51<00:00,  1.71s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.018 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.28388
wandb: 
wandb: üöÄ View run genial-sweep-246 at: https://wandb.ai/xzy11632/dance-dev/runs/odk6j9fu
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_201504-odk6j9fu/logs
wandb: Agent Starting Run: y7v93mdf with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_202015-y7v93mdf
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run breezy-sweep-247
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/y7v93mdf
[INFO][2024-03-16 20:20:20,887][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 20:20:20,984][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 20:20:20,985][dance][wrapped_func] Took 0:00:00.096113 to load and process data.
[INFO][2024-03-16 20:20:20,985][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 20:20:20,987][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 20:20:21,006][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:20:21,151][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 20:20:21,400][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 151) (k=66)
[INFO][2024-03-16 20:20:21,400][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.05%
[INFO][2024-03-16 20:20:23,274][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 20:20:23,275][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 20:20:23,275][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 20:20:23,275][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:26,  1.48s/it]  2%|‚ñè         | 2/100 [00:02<02:19,  1.43s/it]  3%|‚ñé         | 3/100 [00:04<02:18,  1.43s/it]  4%|‚ñç         | 4/100 [00:05<02:17,  1.43s/it]  5%|‚ñå         | 5/100 [00:07<02:11,  1.39s/it]  6%|‚ñå         | 6/100 [00:08<02:11,  1.40s/it]  7%|‚ñã         | 7/100 [00:09<02:07,  1.37s/it]  8%|‚ñä         | 8/100 [00:11<02:12,  1.44s/it]  9%|‚ñâ         | 9/100 [00:13<02:19,  1.53s/it] 10%|‚ñà         | 10/100 [00:14<02:24,  1.61s/it] 11%|‚ñà         | 11/100 [00:16<02:30,  1.69s/it] 12%|‚ñà‚ñè        | 12/100 [00:18<02:32,  1.73s/it] 13%|‚ñà‚ñé        | 13/100 [00:20<02:28,  1.71s/it] 14%|‚ñà‚ñç        | 14/100 [00:21<02:18,  1.61s/it] 15%|‚ñà‚ñå        | 15/100 [00:23<02:12,  1.55s/it] 16%|‚ñà‚ñå        | 16/100 [00:24<02:06,  1.51s/it] 17%|‚ñà‚ñã        | 17/100 [00:26<02:08,  1.55s/it] 18%|‚ñà‚ñä        | 18/100 [00:28<02:15,  1.66s/it] 19%|‚ñà‚ñâ        | 19/100 [00:29<02:20,  1.73s/it] 20%|‚ñà‚ñà        | 20/100 [00:31<02:25,  1.82s/it] 21%|‚ñà‚ñà        | 21/100 [00:33<02:17,  1.75s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:35<02:15,  1.73s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:37<02:16,  1.78s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:38<02:06,  1.67s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:40<02:04,  1.66s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:41<01:59,  1.61s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:43<01:54,  1.57s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:44<01:53,  1.58s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:46<01:58,  1.66s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:48<02:02,  1.75s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:50<01:58,  1.72s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:51<01:56,  1.71s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:53<01:48,  1.62s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:54<01:44,  1.59s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:56<01:45,  1.62s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:57<01:39,  1.56s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:59<01:39,  1.58s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:01<01:40,  1.62s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:02<01:40,  1.64s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:04<01:39,  1.66s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:06<01:36,  1.64s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:07<01:35,  1.65s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:09<01:35,  1.68s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:11<01:33,  1.67s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:12<01:30,  1.64s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:14<01:26,  1.61s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:15<01:21,  1.53s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:17<01:25,  1.64s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:19<01:26,  1.70s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:21<01:25,  1.71s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:22<01:16,  1.56s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:23<01:11,  1.49s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:25<01:07,  1.44s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:26<01:05,  1.43s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:27<01:02,  1.39s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:29<01:00,  1.39s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:30<00:59,  1.38s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:32<01:00,  1.45s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:33<00:59,  1.45s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:34<00:56,  1.41s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:36<00:54,  1.40s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:37<00:52,  1.37s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:38<00:50,  1.36s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:40<00:48,  1.35s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:41<00:49,  1.42s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:43<00:49,  1.47s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:45<00:50,  1.53s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:46<00:50,  1.59s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:48<00:46,  1.49s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:49<00:44,  1.48s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:51<00:44,  1.53s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:52<00:43,  1.56s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:54<00:40,  1.50s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:55<00:37,  1.45s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:56<00:35,  1.40s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:58<00:32,  1.37s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:59<00:30,  1.33s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:00<00:30,  1.39s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:02<00:30,  1.46s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:04<00:30,  1.54s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:05<00:30,  1.59s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:07<00:29,  1.63s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:09<00:27,  1.64s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:10<00:26,  1.64s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:12<00:24,  1.66s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:14<00:23,  1.70s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:16<00:22,  1.69s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:17<00:20,  1.69s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:19<00:18,  1.70s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:21<00:16,  1.66s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:22<00:14,  1.65s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:24<00:13,  1.65s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:26<00:11,  1.68s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:27<00:10,  1.70s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:29<00:08,  1.72s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:31<00:06,  1.73s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:33<00:05,  1.69s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:34<00:03,  1.70s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:36<00:01,  1.72s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:38<00:00,  1.71s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:38<00:00,  1.58s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.23357
wandb: 
wandb: üöÄ View run breezy-sweep-247 at: https://wandb.ai/xzy11632/dance-dev/runs/y7v93mdf
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_202015-y7v93mdf/logs
wandb: Agent Starting Run: qjvf5ajp with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_202440-qjvf5ajp
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run playful-sweep-248
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/qjvf5ajp
[INFO][2024-03-16 20:24:46,406][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 20:24:46,495][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 20:24:46,496][dance][wrapped_func] Took 0:00:00.088511 to load and process data.
[INFO][2024-03-16 20:24:46,496][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 20:24:46,498][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 20:24:46,518][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:24:46,766][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 20:24:47,960][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 151) (k=74)
[INFO][2024-03-16 20:24:47,961][dance.WeightedFeatureSVD][__call__] Total explained variance: 91.35%
[INFO][2024-03-16 20:24:49,702][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 20:24:49,703][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 20:24:49,703][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 20:24:49,703][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:59,  1.21s/it]  2%|‚ñè         | 2/100 [00:02<01:57,  1.20s/it]  3%|‚ñé         | 3/100 [00:03<01:57,  1.21s/it]  4%|‚ñç         | 4/100 [00:04<01:48,  1.13s/it]  5%|‚ñå         | 5/100 [00:05<01:45,  1.11s/it]  6%|‚ñå         | 6/100 [00:06<01:42,  1.09s/it]  7%|‚ñã         | 7/100 [00:07<01:42,  1.10s/it]  8%|‚ñä         | 8/100 [00:09<01:42,  1.11s/it]  9%|‚ñâ         | 9/100 [00:10<01:40,  1.10s/it] 10%|‚ñà         | 10/100 [00:11<01:38,  1.10s/it] 11%|‚ñà         | 11/100 [00:12<01:41,  1.14s/it] 12%|‚ñà‚ñè        | 12/100 [00:13<01:42,  1.17s/it] 13%|‚ñà‚ñé        | 13/100 [00:14<01:39,  1.14s/it] 14%|‚ñà‚ñç        | 14/100 [00:15<01:39,  1.15s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:44,  1.23s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<01:50,  1.32s/it] 17%|‚ñà‚ñã        | 17/100 [00:20<01:48,  1.31s/it] 18%|‚ñà‚ñä        | 18/100 [00:21<01:46,  1.30s/it] 19%|‚ñà‚ñâ        | 19/100 [00:22<01:43,  1.28s/it] 20%|‚ñà‚ñà        | 20/100 [00:23<01:41,  1.27s/it] 21%|‚ñà‚ñà        | 21/100 [00:25<01:42,  1.29s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:26<01:39,  1.28s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:27<01:36,  1.25s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:28<01:34,  1.25s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:30<01:33,  1.25s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:31<01:32,  1.25s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:32<01:29,  1.23s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:33<01:28,  1.23s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:35<01:29,  1.27s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:36<01:35,  1.37s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:38<01:33,  1.35s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:39<01:32,  1.36s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:40<01:30,  1.35s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:41<01:24,  1.29s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:43<01:20,  1.25s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:44<01:18,  1.22s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:45<01:20,  1.28s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:47<01:27,  1.41s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:49<01:31,  1.50s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:50<01:33,  1.55s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:52<01:33,  1.58s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:54<01:33,  1.61s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:55<01:33,  1.63s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:57<01:31,  1.64s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:58<01:25,  1.55s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:00<01:19,  1.47s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:01<01:15,  1.42s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:02<01:14,  1.43s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:04<01:14,  1.47s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:05<01:10,  1.41s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:07<01:09,  1.43s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:08<01:09,  1.45s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:09<01:05,  1.38s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:11<01:04,  1.39s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:12<01:01,  1.37s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:13<00:59,  1.35s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:15<00:59,  1.38s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:16<00:58,  1.40s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:18<00:58,  1.44s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:19<00:56,  1.42s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:20<00:53,  1.37s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:22<00:51,  1.35s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:23<00:47,  1.29s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:24<00:46,  1.30s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:26<00:46,  1.33s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:27<00:46,  1.37s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:28<00:45,  1.39s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:30<00:45,  1.41s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:32<00:46,  1.50s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:33<00:45,  1.50s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:35<00:43,  1.49s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:36<00:38,  1.37s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:37<00:35,  1.30s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:38<00:32,  1.23s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:39<00:29,  1.20s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:40<00:28,  1.18s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:41<00:27,  1.19s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:43<00:26,  1.21s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:44<00:27,  1.31s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:46<00:28,  1.42s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:48<00:28,  1.50s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:49<00:28,  1.56s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:51<00:26,  1.57s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:53<00:25,  1.61s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:54<00:24,  1.62s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:56<00:23,  1.65s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:57<00:20,  1.61s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:59<00:18,  1.50s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:00<00:16,  1.50s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:02<00:15,  1.55s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:03<00:14,  1.57s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:05<00:12,  1.53s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:06<00:09,  1.41s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:07<00:07,  1.32s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:08<00:06,  1.29s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:10<00:05,  1.27s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:11<00:03,  1.26s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:12<00:02,  1.30s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:14<00:01,  1.34s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:15<00:00,  1.36s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:15<00:00,  1.36s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.018 MB uploadedwandb: \ 0.017 MB of 0.025 MB uploadedwandb: | 0.017 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.25369
wandb: 
wandb: üöÄ View run playful-sweep-248 at: https://wandb.ai/xzy11632/dance-dev/runs/qjvf5ajp
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_202440-qjvf5ajp/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: oeh4d7n9 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_202842-oeh4d7n9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run polished-sweep-249
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/oeh4d7n9
[INFO][2024-03-16 20:28:47,790][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 20:28:47,887][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 20:28:47,887][dance][wrapped_func] Took 0:00:00.096257 to load and process data.
[INFO][2024-03-16 20:28:47,888][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 20:28:47,891][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 20:28:47,911][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:28:48,048][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 20:28:48,355][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=90)
[INFO][2024-03-16 20:28:48,355][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.01%
[INFO][2024-03-16 20:28:50,361][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 20:28:50,362][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 20:28:50,362][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 20:28:50,362][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:46,  1.08s/it]  2%|‚ñè         | 2/100 [00:02<01:49,  1.12s/it]  3%|‚ñé         | 3/100 [00:03<01:48,  1.12s/it]  4%|‚ñç         | 4/100 [00:04<01:52,  1.17s/it]  5%|‚ñå         | 5/100 [00:05<01:54,  1.20s/it]  6%|‚ñå         | 6/100 [00:07<01:54,  1.22s/it]  7%|‚ñã         | 7/100 [00:08<01:52,  1.21s/it]  8%|‚ñä         | 8/100 [00:09<01:56,  1.27s/it]  9%|‚ñâ         | 9/100 [00:10<01:52,  1.24s/it] 10%|‚ñà         | 10/100 [00:12<01:52,  1.25s/it] 11%|‚ñà         | 11/100 [00:13<01:57,  1.32s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<02:03,  1.41s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<02:06,  1.45s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<02:05,  1.46s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<02:01,  1.43s/it] 16%|‚ñà‚ñå        | 16/100 [00:21<02:06,  1.51s/it] 17%|‚ñà‚ñã        | 17/100 [00:22<02:05,  1.51s/it] 18%|‚ñà‚ñä        | 18/100 [00:24<01:58,  1.44s/it] 19%|‚ñà‚ñâ        | 19/100 [00:25<01:57,  1.45s/it] 20%|‚ñà‚ñà        | 20/100 [00:27<02:03,  1.54s/it] 21%|‚ñà‚ñà        | 21/100 [00:29<02:05,  1.59s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:30<02:06,  1.63s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:32<02:08,  1.66s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:34<02:06,  1.67s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:35<02:07,  1.69s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:37<02:03,  1.67s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:39<02:02,  1.68s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:40<02:02,  1.70s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:42<02:00,  1.69s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:44<01:58,  1.70s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:45<01:51,  1.61s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:47<01:46,  1.57s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:48<01:42,  1.52s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:50<01:41,  1.54s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:51<01:42,  1.58s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:53<01:42,  1.60s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:55<01:42,  1.63s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:56<01:41,  1.64s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:58<01:42,  1.67s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:00<01:41,  1.69s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:02<01:40,  1.70s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:03<01:36,  1.66s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:04<01:28,  1.55s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:06<01:24,  1.51s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:07<01:21,  1.49s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:09<01:23,  1.55s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:10<01:18,  1.48s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:12<01:16,  1.46s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:13<01:14,  1.47s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:15<01:17,  1.55s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:17<01:20,  1.65s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:18<01:18,  1.63s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:20<01:12,  1.54s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:21<01:07,  1.48s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:23<01:05,  1.46s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:24<01:08,  1.55s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:26<01:05,  1.53s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:27<01:03,  1.50s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:29<01:02,  1.53s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:30<01:01,  1.53s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:32<00:56,  1.46s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:33<00:54,  1.43s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:34<00:53,  1.44s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:36<00:51,  1.42s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:37<00:48,  1.40s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:38<00:46,  1.36s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:40<00:44,  1.34s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:41<00:43,  1.37s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:43<00:45,  1.48s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:45<00:47,  1.58s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:47<00:48,  1.66s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:48<00:45,  1.61s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:49<00:40,  1.51s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:51<00:37,  1.43s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:52<00:34,  1.38s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:53<00:32,  1.36s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:55<00:31,  1.36s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:56<00:29,  1.35s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:57<00:28,  1.34s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:59<00:28,  1.41s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:01<00:29,  1.53s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:02<00:28,  1.58s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:04<00:28,  1.65s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:06<00:26,  1.66s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:08<00:25,  1.69s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:09<00:23,  1.71s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:11<00:22,  1.70s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:13<00:20,  1.72s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:14<00:18,  1.71s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:16<00:17,  1.72s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:18<00:15,  1.73s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:20<00:13,  1.73s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:21<00:12,  1.72s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:23<00:10,  1.69s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:25<00:08,  1.69s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:26<00:06,  1.64s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:28<00:04,  1.59s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:29<00:03,  1.52s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:30<00:01,  1.43s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:31<00:00,  1.38s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:31<00:00,  1.52s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.018 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.28071
wandb: 
wandb: üöÄ View run polished-sweep-249 at: https://wandb.ai/xzy11632/dance-dev/runs/oeh4d7n9
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_202842-oeh4d7n9/logs
wandb: Agent Starting Run: vbiuch2g with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_203309-vbiuch2g
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run firm-sweep-250
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/vbiuch2g
[INFO][2024-03-16 20:33:15,420][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 20:33:15,525][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 20:33:15,526][dance][wrapped_func] Took 0:00:00.104190 to load and process data.
[INFO][2024-03-16 20:33:15,526][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 20:33:15,529][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 20:33:15,548][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:33:15,719][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 20:33:17,473][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=105)
[INFO][2024-03-16 20:33:17,481][dance.WeightedFeatureSVD][__call__] Total explained variance: 91.92%
[INFO][2024-03-16 20:33:19,329][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 20:33:19,329][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 20:33:19,329][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 20:33:19,329][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:48,  1.09s/it]  2%|‚ñè         | 2/100 [00:02<01:48,  1.10s/it]  3%|‚ñé         | 3/100 [00:03<01:50,  1.14s/it]  4%|‚ñç         | 4/100 [00:04<01:50,  1.15s/it]  5%|‚ñå         | 5/100 [00:05<01:49,  1.16s/it]  6%|‚ñå         | 6/100 [00:06<01:49,  1.16s/it]  7%|‚ñã         | 7/100 [00:08<01:46,  1.15s/it]  8%|‚ñä         | 8/100 [00:09<01:44,  1.13s/it]  9%|‚ñâ         | 9/100 [00:10<01:42,  1.12s/it] 10%|‚ñà         | 10/100 [00:11<01:42,  1.14s/it] 11%|‚ñà         | 11/100 [00:12<01:42,  1.15s/it] 12%|‚ñà‚ñè        | 12/100 [00:13<01:39,  1.14s/it] 13%|‚ñà‚ñé        | 13/100 [00:14<01:40,  1.16s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:41,  1.18s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:41,  1.20s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<01:43,  1.23s/it] 17%|‚ñà‚ñã        | 17/100 [00:19<01:43,  1.25s/it] 18%|‚ñà‚ñä        | 18/100 [00:21<01:43,  1.27s/it] 19%|‚ñà‚ñâ        | 19/100 [00:22<01:40,  1.24s/it] 20%|‚ñà‚ñà        | 20/100 [00:23<01:39,  1.24s/it] 21%|‚ñà‚ñà        | 21/100 [00:24<01:36,  1.23s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:26<01:36,  1.23s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:27<01:35,  1.24s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:28<01:35,  1.26s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:29<01:35,  1.27s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:31<01:35,  1.29s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:32<01:34,  1.29s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:33<01:31,  1.27s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:35<01:30,  1.28s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:36<01:29,  1.28s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:37<01:28,  1.28s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:39<01:27,  1.29s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:40<01:26,  1.29s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:41<01:27,  1.32s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:43<01:25,  1.32s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:44<01:25,  1.34s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:45<01:29,  1.42s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:47<01:32,  1.49s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:49<01:30,  1.48s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:50<01:26,  1.44s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:51<01:24,  1.43s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:53<01:27,  1.50s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:55<01:30,  1.59s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:57<01:31,  1.64s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:58<01:31,  1.66s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:00<01:30,  1.68s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:02<01:29,  1.69s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:03<01:28,  1.69s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:05<01:28,  1.74s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:07<01:26,  1.74s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:09<01:24,  1.73s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:10<01:22,  1.72s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:12<01:20,  1.71s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:14<01:18,  1.71s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:16<01:17,  1.71s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:17<01:13,  1.67s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:19<01:08,  1.59s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:20<01:03,  1.51s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:21<01:02,  1.52s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:23<01:00,  1.52s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:25<01:01,  1.57s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:26<01:01,  1.61s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:28<01:00,  1.65s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:30<01:00,  1.67s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:32<00:59,  1.69s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:33<00:57,  1.69s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:35<00:55,  1.68s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:37<00:53,  1.68s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:38<00:53,  1.71s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:40<00:51,  1.73s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:42<00:50,  1.73s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:44<00:48,  1.75s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:45<00:46,  1.74s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:47<00:44,  1.73s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:49<00:43,  1.74s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:51<00:41,  1.74s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:52<00:40,  1.77s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:54<00:39,  1.78s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:56<00:36,  1.75s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:58<00:34,  1.74s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:59<00:32,  1.73s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:01<00:31,  1.73s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:03<00:29,  1.72s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:04<00:27,  1.73s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:06<00:26,  1.79s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:08<00:24,  1.77s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:10<00:22,  1.75s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:12<00:21,  1.78s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:13<00:19,  1.78s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:15<00:17,  1.77s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:17<00:15,  1.76s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:19<00:13,  1.73s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:20<00:12,  1.73s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:22<00:10,  1.73s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:24<00:08,  1.76s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:26<00:06,  1.75s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:27<00:05,  1.76s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:29<00:03,  1.76s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:31<00:01,  1.74s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:33<00:00,  1.74s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:33<00:00,  1.53s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.33858
wandb: 
wandb: üöÄ View run firm-sweep-250 at: https://wandb.ai/xzy11632/dance-dev/runs/vbiuch2g
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_203309-vbiuch2g/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: i7ffbzwy with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_203727-i7ffbzwy
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run drawn-sweep-251
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/i7ffbzwy
[INFO][2024-03-16 20:37:33,365][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 20:37:33,460][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 20:37:33,461][dance][wrapped_func] Took 0:00:00.094471 to load and process data.
[INFO][2024-03-16 20:37:33,461][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 20:37:33,463][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 20:37:33,483][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:37:33,765][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 20:37:34,595][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=82)
[INFO][2024-03-16 20:37:34,596][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.09%
[INFO][2024-03-16 20:37:36,488][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 20:37:36,488][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 20:37:36,488][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 20:37:36,488][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:55,  1.17s/it]  2%|‚ñè         | 2/100 [00:02<01:53,  1.16s/it]  3%|‚ñé         | 3/100 [00:03<01:51,  1.15s/it]  4%|‚ñç         | 4/100 [00:04<01:55,  1.20s/it]  5%|‚ñå         | 5/100 [00:05<01:55,  1.22s/it]  6%|‚ñå         | 6/100 [00:07<01:52,  1.19s/it]  7%|‚ñã         | 7/100 [00:08<01:53,  1.22s/it]  8%|‚ñä         | 8/100 [00:09<02:01,  1.33s/it]  9%|‚ñâ         | 9/100 [00:11<02:06,  1.39s/it] 10%|‚ñà         | 10/100 [00:13<02:09,  1.44s/it] 11%|‚ñà         | 11/100 [00:14<02:10,  1.47s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<02:17,  1.57s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<02:17,  1.58s/it] 14%|‚ñà‚ñç        | 14/100 [00:19<02:17,  1.60s/it] 15%|‚ñà‚ñå        | 15/100 [00:21<02:17,  1.62s/it] 16%|‚ñà‚ñå        | 16/100 [00:22<02:14,  1.60s/it] 17%|‚ñà‚ñã        | 17/100 [00:24<02:16,  1.65s/it] 18%|‚ñà‚ñä        | 18/100 [00:26<02:12,  1.62s/it] 19%|‚ñà‚ñâ        | 19/100 [00:27<02:05,  1.55s/it] 20%|‚ñà‚ñà        | 20/100 [00:29<02:03,  1.54s/it] 21%|‚ñà‚ñà        | 21/100 [00:30<02:06,  1.60s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:32<02:04,  1.60s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:33<02:00,  1.56s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:35<01:51,  1.47s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:36<01:48,  1.45s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:37<01:45,  1.42s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:39<01:41,  1.39s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:40<01:39,  1.39s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:41<01:35,  1.35s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:43<01:34,  1.35s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:44<01:34,  1.36s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:46<01:35,  1.40s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:47<01:34,  1.41s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:48<01:31,  1.39s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:50<01:28,  1.37s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:51<01:27,  1.36s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:52<01:24,  1.34s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:54<01:23,  1.34s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:55<01:24,  1.38s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:56<01:22,  1.38s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:58<01:19,  1.35s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:59<01:18,  1.36s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:00<01:16,  1.35s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:02<01:16,  1.36s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:03<01:16,  1.39s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:05<01:17,  1.44s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:07<01:22,  1.55s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:08<01:18,  1.51s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:10<01:17,  1.51s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:11<01:14,  1.49s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:13<01:15,  1.54s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:14<01:14,  1.55s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:16<01:11,  1.53s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:17<01:12,  1.57s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:19<01:09,  1.54s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:20<01:06,  1.51s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:22<01:01,  1.43s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:23<01:02,  1.50s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:25<01:04,  1.56s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:27<01:02,  1.56s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:28<00:58,  1.50s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:30<00:58,  1.54s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:31<00:59,  1.60s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:33<00:58,  1.61s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:35<00:57,  1.64s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:36<00:54,  1.60s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:37<00:50,  1.53s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:39<00:47,  1.48s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:40<00:44,  1.44s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:42<00:43,  1.44s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:43<00:43,  1.48s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:45<00:42,  1.52s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:46<00:41,  1.55s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:48<00:39,  1.52s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:49<00:36,  1.46s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:50<00:33,  1.40s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:52<00:30,  1.35s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:53<00:29,  1.34s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:54<00:27,  1.31s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:56<00:27,  1.39s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:57<00:27,  1.42s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:59<00:26,  1.45s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:00<00:24,  1.45s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:02<00:24,  1.55s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:04<00:23,  1.59s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:05<00:22,  1.63s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:07<00:20,  1.55s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:08<00:17,  1.47s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:10<00:16,  1.48s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:11<00:14,  1.47s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:13<00:13,  1.46s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:14<00:11,  1.47s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:16<00:10,  1.50s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:17<00:09,  1.51s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:19<00:07,  1.54s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:20<00:05,  1.46s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:21<00:04,  1.40s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:23<00:02,  1.39s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:24<00:01,  1.47s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:26<00:00,  1.52s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:26<00:00,  1.46s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.21966
wandb: 
wandb: üöÄ View run drawn-sweep-251 at: https://wandb.ai/xzy11632/dance-dev/runs/i7ffbzwy
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_203727-i7ffbzwy/logs
wandb: Agent Starting Run: 3mcq65d0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_204126-3mcq65d0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run cerulean-sweep-252
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/3mcq65d0
[INFO][2024-03-16 20:41:31,059][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 20:41:31,152][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 20:41:31,152][dance][wrapped_func] Took 0:00:00.092344 to load and process data.
[INFO][2024-03-16 20:41:31,153][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 20:41:31,156][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 20:41:31,175][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:41:31,309][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-16 20:41:33,106][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=106)
[INFO][2024-03-16 20:41:33,111][dance.WeightedFeatureSVD][__call__] Total explained variance: 92.88%
[INFO][2024-03-16 20:41:35,133][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 20:41:35,133][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 20:41:35,134][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 20:41:35,134][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:59,  1.21s/it]  2%|‚ñè         | 2/100 [00:02<02:01,  1.24s/it]  3%|‚ñé         | 3/100 [00:03<02:02,  1.26s/it]  4%|‚ñç         | 4/100 [00:04<01:57,  1.23s/it]  5%|‚ñå         | 5/100 [00:06<01:53,  1.19s/it]  6%|‚ñå         | 6/100 [00:07<01:51,  1.19s/it]  7%|‚ñã         | 7/100 [00:08<01:48,  1.17s/it]  8%|‚ñä         | 8/100 [00:09<01:47,  1.17s/it]  9%|‚ñâ         | 9/100 [00:10<01:46,  1.17s/it] 10%|‚ñà         | 10/100 [00:11<01:45,  1.18s/it] 11%|‚ñà         | 11/100 [00:13<01:43,  1.16s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:41,  1.15s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:40,  1.16s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:40,  1.16s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:36,  1.13s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<01:34,  1.12s/it] 17%|‚ñà‚ñã        | 17/100 [00:19<01:32,  1.11s/it] 18%|‚ñà‚ñä        | 18/100 [00:20<01:31,  1.11s/it] 19%|‚ñà‚ñâ        | 19/100 [00:22<01:33,  1.15s/it] 20%|‚ñà‚ñà        | 20/100 [00:23<01:33,  1.17s/it] 21%|‚ñà‚ñà        | 21/100 [00:24<01:33,  1.18s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:25<01:31,  1.17s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:26<01:30,  1.17s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:28<01:29,  1.18s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:29<01:29,  1.19s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:30<01:26,  1.17s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:31<01:23,  1.15s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:32<01:21,  1.13s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:33<01:19,  1.12s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:34<01:17,  1.10s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:35<01:18,  1.14s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:37<01:20,  1.19s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:38<01:20,  1.20s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:39<01:20,  1.22s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:40<01:19,  1.22s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:42<01:18,  1.23s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:43<01:18,  1.25s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:44<01:18,  1.27s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:46<01:16,  1.25s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:47<01:15,  1.25s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:48<01:14,  1.26s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:49<01:13,  1.26s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:51<01:11,  1.26s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:52<01:09,  1.25s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:53<01:08,  1.24s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:54<01:06,  1.24s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:56<01:06,  1.25s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:57<01:05,  1.26s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:58<01:04,  1.26s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:59<01:03,  1.26s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:01<01:01,  1.25s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:02<01:00,  1.25s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:03<00:59,  1.26s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:04<00:57,  1.26s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:06<00:56,  1.26s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:07<00:59,  1.34s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:09<01:02,  1.46s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:11<01:03,  1.51s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:12<01:04,  1.58s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:14<01:04,  1.61s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:16<01:04,  1.65s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:17<01:00,  1.58s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:18<00:55,  1.51s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:20<00:55,  1.55s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:22<00:55,  1.58s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:24<00:55,  1.64s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:25<00:54,  1.64s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:27<00:52,  1.64s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:28<00:50,  1.64s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:30<00:49,  1.64s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:32<00:47,  1.62s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:33<00:45,  1.63s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:35<00:43,  1.63s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:37<00:42,  1.64s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:38<00:40,  1.63s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:40<00:40,  1.70s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:42<00:39,  1.70s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:43<00:37,  1.69s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:45<00:35,  1.70s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:47<00:33,  1.69s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:49<00:32,  1.70s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:50<00:28,  1.60s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:51<00:25,  1.52s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:53<00:24,  1.50s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:54<00:23,  1.55s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:56<00:22,  1.63s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:58<00:21,  1.65s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:00<00:19,  1.65s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:01<00:18,  1.68s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:03<00:16,  1.67s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:05<00:15,  1.68s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:06<00:13,  1.68s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:08<00:11,  1.68s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:10<00:09,  1.67s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:11<00:08,  1.67s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:13<00:06,  1.73s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:15<00:05,  1.70s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:16<00:03,  1.70s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:18<00:01,  1.71s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:20<00:00,  1.71s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:20<00:00,  1.40s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.21972
wandb: 
wandb: üöÄ View run cerulean-sweep-252 at: https://wandb.ai/xzy11632/dance-dev/runs/3mcq65d0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_204126-3mcq65d0/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 2wds4be8 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_204532-2wds4be8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run earthy-sweep-253
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/2wds4be8
[INFO][2024-03-16 20:45:38,637][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 20:45:38,779][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 20:45:38,779][dance][wrapped_func] Took 0:00:00.139562 to load and process data.
[INFO][2024-03-16 20:45:38,779][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 20:45:38,782][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 20:45:38,801][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:45:38,802][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:45:38,802][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:45:38,998][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:45:38,999][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:45:38,999][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 20:45:40,491][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 919) (k=14)
[INFO][2024-03-16 20:45:40,492][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.03%
[INFO][2024-03-16 20:45:42,961][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 20:45:42,962][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 20:45:42,962][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 20:45:42,962][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:13,  1.35s/it]  2%|‚ñè         | 2/100 [00:02<02:08,  1.31s/it]  3%|‚ñé         | 3/100 [00:04<02:13,  1.37s/it]  4%|‚ñç         | 4/100 [00:05<02:17,  1.44s/it]  5%|‚ñå         | 5/100 [00:07<02:17,  1.44s/it]  6%|‚ñå         | 6/100 [00:08<02:19,  1.48s/it]  7%|‚ñã         | 7/100 [00:10<02:27,  1.59s/it]  8%|‚ñä         | 8/100 [00:12<02:34,  1.68s/it]  9%|‚ñâ         | 9/100 [00:14<02:37,  1.73s/it] 10%|‚ñà         | 10/100 [00:15<02:38,  1.76s/it] 11%|‚ñà         | 11/100 [00:17<02:39,  1.80s/it] 12%|‚ñà‚ñè        | 12/100 [00:19<02:42,  1.85s/it] 13%|‚ñà‚ñé        | 13/100 [00:21<02:44,  1.89s/it] 14%|‚ñà‚ñç        | 14/100 [00:23<02:44,  1.92s/it] 15%|‚ñà‚ñå        | 15/100 [00:25<02:40,  1.88s/it] 16%|‚ñà‚ñå        | 16/100 [00:27<02:35,  1.86s/it] 17%|‚ñà‚ñã        | 17/100 [00:29<02:34,  1.86s/it] 18%|‚ñà‚ñä        | 18/100 [00:31<02:30,  1.83s/it] 19%|‚ñà‚ñâ        | 19/100 [00:32<02:26,  1.80s/it] 20%|‚ñà‚ñà        | 20/100 [00:34<02:13,  1.67s/it] 21%|‚ñà‚ñà        | 21/100 [00:35<02:04,  1.58s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:36<01:59,  1.54s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:38<02:00,  1.56s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:40<01:56,  1.54s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:41<01:50,  1.47s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:43<01:53,  1.54s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:44<01:58,  1.62s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:46<02:00,  1.67s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:48<01:53,  1.60s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:49<01:46,  1.52s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:50<01:41,  1.48s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:52<01:45,  1.56s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:54<01:53,  1.69s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:56<01:54,  1.74s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:58<01:54,  1.77s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:00<01:56,  1.82s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:02<01:55,  1.84s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:03<01:54,  1.85s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:05<01:53,  1.87s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:07<01:52,  1.87s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:09<01:49,  1.86s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:11<01:50,  1.90s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:13<01:46,  1.86s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:15<01:43,  1.85s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:17<01:42,  1.87s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:18<01:41,  1.89s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:20<01:39,  1.89s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:22<01:37,  1.88s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:24<01:35,  1.87s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:26<01:31,  1.84s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:28<01:32,  1.89s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:30<01:30,  1.88s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:32<01:30,  1.92s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:34<01:30,  1.96s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:36<01:27,  1.94s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:37<01:22,  1.88s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:39<01:17,  1.81s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:41<01:14,  1.77s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:43<01:12,  1.78s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:45<01:13,  1.84s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:46<01:11,  1.83s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:48<01:09,  1.84s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:50<01:07,  1.83s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:52<01:05,  1.83s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:54<01:05,  1.86s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:56<01:02,  1.85s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:58<01:01,  1.88s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:59<00:59,  1.87s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:01<00:58,  1.89s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:03<00:57,  1.90s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:05<00:57,  1.98s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:07<00:54,  1.95s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:09<00:52,  1.94s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:11<00:49,  1.91s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:13<00:47,  1.91s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:15<00:46,  1.92s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:17<00:43,  1.89s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:19<00:41,  1.91s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:21<00:39,  1.90s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:22<00:37,  1.89s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:24<00:35,  1.87s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:26<00:33,  1.85s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:28<00:31,  1.83s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:30<00:29,  1.81s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:31<00:27,  1.80s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:33<00:25,  1.81s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:35<00:23,  1.83s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:37<00:21,  1.82s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:39<00:20,  1.83s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:41<00:18,  1.83s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:42<00:16,  1.83s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:44<00:14,  1.82s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:46<00:12,  1.81s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:48<00:10,  1.81s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:50<00:09,  1.82s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:51<00:07,  1.82s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:53<00:05,  1.85s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:55<00:03,  1.83s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:57<00:01,  1.83s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:59<00:00,  1.82s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:59<00:00,  1.79s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.32626
wandb: 
wandb: üöÄ View run earthy-sweep-253 at: https://wandb.ai/xzy11632/dance-dev/runs/2wds4be8
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_204532-2wds4be8/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 4smvaenz with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_205013-4smvaenz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run kind-sweep-254
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/4smvaenz
[INFO][2024-03-16 20:50:19,178][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 20:50:19,278][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 20:50:19,279][dance][wrapped_func] Took 0:00:00.098228 to load and process data.
[INFO][2024-03-16 20:50:19,279][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 20:50:19,281][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 20:50:19,296][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:50:19,297][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:50:19,297][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:50:19,470][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:50:19,470][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:50:19,470][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 20:50:23,848][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 919) (k=41)
[INFO][2024-03-16 20:50:23,849][dance.WeightedFeatureSVD][__call__] Total explained variance: 93.33%
[INFO][2024-03-16 20:50:25,908][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 20:50:25,909][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 20:50:25,909][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 20:50:25,909][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:12,  1.34s/it]  2%|‚ñè         | 2/100 [00:02<02:13,  1.36s/it]  3%|‚ñé         | 3/100 [00:04<02:16,  1.41s/it]  4%|‚ñç         | 4/100 [00:05<02:21,  1.47s/it]  5%|‚ñå         | 5/100 [00:07<02:18,  1.46s/it]  6%|‚ñå         | 6/100 [00:08<02:14,  1.43s/it]  7%|‚ñã         | 7/100 [00:09<02:11,  1.41s/it]  8%|‚ñä         | 8/100 [00:11<02:12,  1.44s/it]  9%|‚ñâ         | 9/100 [00:12<02:09,  1.43s/it] 10%|‚ñà         | 10/100 [00:14<02:08,  1.43s/it] 11%|‚ñà         | 11/100 [00:15<02:04,  1.40s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<02:00,  1.37s/it] 13%|‚ñà‚ñé        | 13/100 [00:18<02:00,  1.38s/it] 14%|‚ñà‚ñç        | 14/100 [00:19<02:01,  1.41s/it] 15%|‚ñà‚ñå        | 15/100 [00:21<02:00,  1.42s/it] 16%|‚ñà‚ñå        | 16/100 [00:22<02:00,  1.44s/it] 17%|‚ñà‚ñã        | 17/100 [00:24<02:02,  1.48s/it] 18%|‚ñà‚ñä        | 18/100 [00:26<02:10,  1.59s/it] 19%|‚ñà‚ñâ        | 19/100 [00:28<02:31,  1.87s/it] 20%|‚ñà‚ñà        | 20/100 [00:31<02:47,  2.10s/it] 21%|‚ñà‚ñà        | 21/100 [00:33<02:59,  2.27s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:35<02:35,  1.99s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:36<02:16,  1.78s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:37<02:05,  1.65s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:39<01:57,  1.56s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:40<01:51,  1.51s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:42<01:46,  1.47s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:43<01:42,  1.42s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:44<01:42,  1.45s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:46<01:38,  1.40s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:47<01:34,  1.37s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:48<01:31,  1.35s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:50<01:30,  1.35s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:51<01:29,  1.36s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:52<01:26,  1.34s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:54<01:25,  1.34s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:55<01:24,  1.34s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:56<01:24,  1.36s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:58<01:22,  1.36s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:59<01:21,  1.36s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:00<01:19,  1.34s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:02<01:17,  1.34s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:03<01:15,  1.32s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:04<01:14,  1.34s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:06<01:14,  1.36s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:07<01:14,  1.38s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:09<01:12,  1.36s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:10<01:11,  1.38s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:11<01:11,  1.41s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:13<01:09,  1.38s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:14<01:07,  1.38s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:16<01:07,  1.41s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:17<01:07,  1.43s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:19<01:07,  1.47s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:20<01:05,  1.45s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:22<01:04,  1.46s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:23<01:04,  1.49s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:25<01:02,  1.48s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:26<00:59,  1.46s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:27<00:57,  1.44s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:29<00:56,  1.45s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:30<00:56,  1.50s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:32<00:55,  1.49s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:33<00:52,  1.46s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:35<00:51,  1.48s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:36<00:49,  1.46s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:38<00:48,  1.47s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:39<00:46,  1.46s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:41<00:45,  1.45s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:42<00:43,  1.45s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:44<00:42,  1.47s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:45<00:40,  1.45s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:46<00:38,  1.44s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:48<00:37,  1.44s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:49<00:35,  1.44s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:51<00:35,  1.46s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:52<00:33,  1.46s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:54<00:32,  1.46s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:55<00:30,  1.45s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:57<00:29,  1.46s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:58<00:27,  1.47s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:00<00:26,  1.48s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:01<00:24,  1.46s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:03<00:23,  1.50s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:04<00:21,  1.45s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:05<00:19,  1.38s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:06<00:17,  1.37s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:08<00:16,  1.35s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:09<00:14,  1.32s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:10<00:13,  1.30s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:12<00:11,  1.29s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:13<00:10,  1.28s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:14<00:08,  1.27s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:15<00:07,  1.31s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:17<00:06,  1.32s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:18<00:05,  1.30s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:19<00:03,  1.29s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:21<00:02,  1.32s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:22<00:01,  1.31s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:23<00:00,  1.28s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:23<00:00,  1.44s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.28646
wandb: 
wandb: üöÄ View run kind-sweep-254 at: https://wandb.ai/xzy11632/dance-dev/runs/4smvaenz
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_205013-4smvaenz/logs
wandb: Agent Starting Run: xau66p15 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_205411-xau66p15
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run bumbling-sweep-255
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/xau66p15
[INFO][2024-03-16 20:54:17,114][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 20:54:17,225][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 20:54:17,225][dance][wrapped_func] Took 0:00:00.106893 to load and process data.
[INFO][2024-03-16 20:54:17,225][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 20:54:17,227][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 20:54:17,247][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:54:17,247][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:54:17,460][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:54:17,461][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 20:54:17,615][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run bumbling-sweep-255 at: https://wandb.ai/xzy11632/dance-dev/runs/xau66p15
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_205411-xau66p15/logs
wandb: ERROR Run xau66p15 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1081) out of bounds (919)
wandb: ERROR 
wandb: Agent Starting Run: up34jxci with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_205431-up34jxci
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run swept-sweep-256
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/up34jxci
[INFO][2024-03-16 20:54:37,256][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 20:54:37,348][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 20:54:37,349][dance][wrapped_func] Took 0:00:00.091914 to load and process data.
[INFO][2024-03-16 20:54:37,349][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 20:54:37,350][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-16 20:54:37,370][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:54:37,370][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:54:37,510][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:54:37,510][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 20:54:37,660][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run swept-sweep-256 at: https://wandb.ai/xzy11632/dance-dev/runs/up34jxci
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240316_205431-up34jxci/logs
wandb: ERROR Run up34jxci errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1081) out of bounds (919)
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: b6cid1uq with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240316_205457-b6cid1uq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ruby-sweep-257
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/b6cid1uq
[INFO][2024-03-16 20:55:03,891][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-16 20:55:04,041][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-16 20:55:04,041][dance][wrapped_func] Took 0:00:00.146227 to load and process data.
[INFO][2024-03-16 20:55:04,042][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-16 20:55:04,043][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-16 20:55:04,063][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:55:04,064][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:55:04,265][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-16 20:55:04,266][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-16 20:55:04,548][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=6)
[INFO][2024-03-16 20:55:04,548][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.93%
[INFO][2024-03-16 20:55:06,375][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-16 20:55:06,376][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-16 20:55:06,376][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-16 20:55:06,376][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:05,  1.27s/it]  2%|‚ñè         | 2/100 [00:02<01:54,  1.17s/it]  3%|‚ñé         | 3/100 [00:03<01:51,  1.14s/it]  4%|‚ñç         | 4/100 [00:04<01:48,  1.14s/it]  5%|‚ñå         | 5/100 [00:05<01:51,  1.18s/it]  6%|‚ñå         | 6/100 [00:07<01:52,  1.20s/it]  7%|‚ñã         | 7/100 [00:08<01:52,  1.21s/it]  8%|‚ñä         | 8/100 [00:09<01:54,  1.24s/it]  9%|‚ñâ         | 9/100 [00:10<01:54,  1.26s/it] 10%|‚ñà         | 10/100 [00:12<01:54,  1.27s/it] 11%|‚ñà         | 11/100 [00:13<01:52,  1.26s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:48,  1.23s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:47,  1.24s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:45,  1.23s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:45,  1.24s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:45,  1.26s/it] 17%|‚ñà‚ñã        | 17/100 [00:20<01:45,  1.28s/it] 18%|‚ñà‚ñä        | 18/100 [00:22<01:48,  1.32s/it] 19%|‚ñà‚ñâ        | 19/100 [00:23<01:51,  1.38s/it] 20%|‚ñà‚ñà        | 20/100 [00:25<01:57,  1.47s/it] 21%|‚ñà‚ñà        | 21/100 [00:27<01:58,  1.50s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:28<01:58,  1.52s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:30<01:57,  1.52s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:31<01:51,  1.47s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:33<01:49,  1.46s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:34<01:42,  1.38s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:35<01:35,  1.31s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:36<01:33,  1.29s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:37<01:31,  1.28s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:39<01:34,  1.35s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:40<01:30,  1.30s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:42<01:31,  1.34s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:43<01:31,  1.37s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:44<01:30,  1.37s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:46<01:31,  1.41s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:47<01:29,  1.39s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:49<01:26,  1.38s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:50<01:27,  1.41s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:52<01:28,  1.44s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:53<01:28,  1.47s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:55<01:32,  1.56s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:57<01:33,  1.62s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:58<01:30,  1.58s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:00<01:28,  1.59s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:01<01:25,  1.56s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:03<01:26,  1.60s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:05<01:26,  1.64s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:06<01:25,  1.65s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:08<01:24,  1.66s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:10<01:23,  1.66s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:11<01:21,  1.65s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:13<01:20,  1.68s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:14<01:12,  1.55s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:16<01:06,  1.45s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:17<01:03,  1.42s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:18<01:04,  1.48s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:20<01:04,  1.50s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:21<01:02,  1.49s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:23<01:02,  1.54s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:25<01:02,  1.57s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:26<01:02,  1.60s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:28<00:59,  1.56s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:30<00:58,  1.57s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:31<00:57,  1.61s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:33<00:56,  1.60s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:34<00:51,  1.51s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:35<00:47,  1.45s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:37<00:46,  1.47s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:38<00:44,  1.45s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:40<00:44,  1.48s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:42<00:44,  1.55s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:43<00:42,  1.53s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:45<00:40,  1.51s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:46<00:37,  1.44s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:47<00:35,  1.40s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:48<00:33,  1.38s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:50<00:32,  1.40s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:51<00:30,  1.39s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:53<00:29,  1.42s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:54<00:30,  1.50s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:56<00:28,  1.51s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:58<00:28,  1.57s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:59<00:26,  1.53s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:00<00:23,  1.44s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:02<00:22,  1.48s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:03<00:20,  1.47s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:05<00:19,  1.48s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:06<00:16,  1.41s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:07<00:15,  1.40s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:09<00:14,  1.44s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:10<00:12,  1.42s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:12<00:11,  1.48s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:14<00:10,  1.54s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:15<00:09,  1.59s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:17<00:07,  1.54s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:18<00:06,  1.50s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:20<00:04,  1.44s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:21<00:02,  1.42s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:22<00:01,  1.44s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:24<00:00,  1.48s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:24<00:00,  1.44s/it]
/home/zyxing/dance/dance/utils/matrix.py:178: NumbaExperimentalFeatureWarning: First-class function type feature is experimental
  for j in numba.prange(n):
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numba/np/ufunc/parallel.py:371: NumbaWarning: The TBB threading layer requires TBB version 2021 update 6 or later i.e., TBB_INTERFACE_VERSION >= 12060. Found TBB_INTERFACE_VERSION = 12050. The TBB threading layer is disabled.
  warnings.warn(problem)
[INFO][2024-03-17 23:41:24,516][dance][<module>] 
{'activation': 'relu',
 'agg': 'sum',
 'batch_size': 128,
 'cache': False,
 'count': 400,
 'data_dir': './temp_data',
 'dataset': 'human_pbmc2_cell',
 'device': 'cuda:1',
 'dropout': 0.1,
 'edge_norm': True,
 'epochs': 100,
 'eval_epoch': False,
 'hidden_1': 300,
 'hidden_2': 0,
 'hidden_bn': False,
 'hidden_dim': 200,
 'hidden_relu': False,
 'learning_rate': 1e-05,
 'n_hidden': 1,
 'n_layers': 1,
 'nb_genes': 3000,
 'node_features': 'scale',
 'normalize_weights': 'log_per_cell',
 'num_run': 1,
 'num_workers': 1,
 'plot': False,
 'root_path': '/home/zyxing/dance/examples/tuning/cluster_graphsc',
 'same_edge_values': False,
 'seed': 0,
 'show_epoch_ari': False,
 'summary_file_path': 'results/pipeline/best_test_acc.csv',
 'sweep_id': 'twij69w5',
 'tune_mode': 'pipeline_params'}
[INFO][2024-03-17 23:41:24,516][dance][<module>] 
 files is saved in /home/zyxing/dance/examples/tuning/cluster_graphsc/human_pbmc2_cell
[INFO][2024-03-17 23:41:24,537][dance][config] tune mode is set to pipeline_params,tune_mode will first be converted to pipeline
[INFO][2024-03-17 23:41:24,540][dance][wandb_sweep_agent] Spawning agent: sweep_id='twij69w5', entity='xzy11632', project='dance-dev', count=400
wandb: Agent Starting Run: a6qe5gex with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: Currently logged in as: xzy11632. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240317_234127-a6qe5gex
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run pretty-sweep-258
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/a6qe5gex
[INFO][2024-03-17 23:41:32,915][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-17 23:41:33,011][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-17 23:41:33,011][dance][wrapped_func] Took 0:00:00.095008 to load and process data.
[INFO][2024-03-17 23:41:33,011][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-17 23:41:33,012][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-17 23:41:33,028][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-17 23:41:33,028][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-17 23:41:33,153][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-17 23:41:33,153][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-17 23:41:34,319][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=6)
[INFO][2024-03-17 23:41:34,320][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.88%
[INFO][2024-03-17 23:41:36,205][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-17 23:41:36,205][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-17 23:41:36,205][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-17 23:41:36,205][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:02<03:28,  2.11s/it]  2%|‚ñè         | 2/100 [00:02<02:10,  1.34s/it]  3%|‚ñé         | 3/100 [00:03<01:47,  1.11s/it]  4%|‚ñç         | 4/100 [00:04<01:33,  1.02it/s]  5%|‚ñå         | 5/100 [00:05<01:26,  1.09it/s]  6%|‚ñå         | 6/100 [00:06<01:20,  1.16it/s]  7%|‚ñã         | 7/100 [00:06<01:19,  1.17it/s]  8%|‚ñä         | 8/100 [00:07<01:18,  1.18it/s]  9%|‚ñâ         | 9/100 [00:08<01:18,  1.16it/s] 10%|‚ñà         | 10/100 [00:09<01:17,  1.16it/s] 11%|‚ñà         | 11/100 [00:10<01:19,  1.12it/s] 12%|‚ñà‚ñè        | 12/100 [00:11<01:21,  1.08it/s] 13%|‚ñà‚ñé        | 13/100 [00:12<01:21,  1.06it/s] 14%|‚ñà‚ñç        | 14/100 [00:13<01:20,  1.07it/s] 15%|‚ñà‚ñå        | 15/100 [00:14<01:21,  1.05it/s] 16%|‚ñà‚ñå        | 16/100 [00:15<01:21,  1.03it/s] 17%|‚ñà‚ñã        | 17/100 [00:16<01:18,  1.06it/s] 18%|‚ñà‚ñä        | 18/100 [00:17<01:18,  1.05it/s] 19%|‚ñà‚ñâ        | 19/100 [00:18<01:17,  1.05it/s] 20%|‚ñà‚ñà        | 20/100 [00:19<01:17,  1.04it/s] 21%|‚ñà‚ñà        | 21/100 [00:20<01:19,  1.00s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:21<01:17,  1.01it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:22<01:15,  1.02it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:23<01:15,  1.00it/s] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:24<01:16,  1.02s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:25<01:14,  1.01s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:26<01:12,  1.00it/s] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:27<01:10,  1.02it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:28<01:11,  1.00s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:29<01:09,  1.00it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:30<01:10,  1.02s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:31<01:09,  1.01s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:32<01:04,  1.05it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:32<01:00,  1.09it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:33<00:57,  1.13it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:34<00:55,  1.16it/s] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:35<00:54,  1.16it/s] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:36<00:53,  1.15it/s] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:37<00:51,  1.18it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:37<00:51,  1.17it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:38<00:49,  1.19it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:39<00:48,  1.19it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:40<00:48,  1.18it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:41<00:48,  1.16it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:42<00:48,  1.13it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:43<00:46,  1.16it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:44<00:46,  1.14it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:44<00:44,  1.16it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:45<00:45,  1.12it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:46<00:45,  1.09it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:47<00:45,  1.09it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:48<00:44,  1.09it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:49<00:41,  1.13it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:50<00:40,  1.14it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:51<00:40,  1.10it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:52<00:39,  1.11it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [00:53<00:38,  1.11it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [00:53<00:37,  1.13it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [00:54<00:35,  1.16it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [00:55<00:34,  1.16it/s] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [00:56<00:33,  1.16it/s] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [00:57<00:33,  1.15it/s] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [00:58<00:32,  1.15it/s] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [00:59<00:31,  1.15it/s] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:00<00:31,  1.10it/s] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:01<00:32,  1.05it/s] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:02<00:31,  1.05it/s] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:02<00:29,  1.07it/s] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:03<00:29,  1.05it/s] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:04<00:28,  1.04it/s] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:05<00:28,  1.03it/s] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:07<00:27,  1.00it/s] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:08<00:27,  1.00s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:09<00:26,  1.04s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:10<00:25,  1.03s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:11<00:25,  1.08s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:12<00:25,  1.13s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:13<00:24,  1.13s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:14<00:22,  1.08s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:15<00:20,  1.04s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:16<00:19,  1.02s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:17<00:18,  1.03s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:18<00:16,  1.01it/s] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:19<00:15,  1.02it/s] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:20<00:14,  1.02it/s] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:21<00:13,  1.04it/s] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:22<00:12,  1.05it/s] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:23<00:11,  1.03it/s] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:24<00:10,  1.03it/s] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:25<00:09,  1.00it/s] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:26<00:08,  1.03it/s] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:27<00:07,  1.08it/s] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:28<00:06,  1.08it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:29<00:05,  1.06it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:30<00:04,  1.04it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:31<00:04,  1.00s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:32<00:03,  1.01s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:33<00:02,  1.03s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:34<00:01,  1.04s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:35<00:00,  1.04s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:35<00:00,  1.05it/s]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.17533
wandb: 
wandb: üöÄ View run pretty-sweep-258 at: https://wandb.ai/xzy11632/dance-dev/runs/a6qe5gex
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240317_234127-a6qe5gex/logs
wandb: Agent Starting Run: th3u01np with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240317_234548-th3u01np
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sandy-sweep-259
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/th3u01np
[INFO][2024-03-17 23:45:53,413][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-17 23:45:53,505][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-17 23:45:53,505][dance][wrapped_func] Took 0:00:00.090895 to load and process data.
[INFO][2024-03-17 23:45:53,505][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-17 23:45:53,507][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-17 23:45:53,526][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-17 23:45:53,526][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-17 23:45:53,660][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-17 23:45:53,661][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run sandy-sweep-259 at: https://wandb.ai/xzy11632/dance-dev/runs/th3u01np
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240317_234548-th3u01np/logs
wandb: ERROR Run th3u01np errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: ykjiq2jj with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240317_234604-ykjiq2jj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run decent-sweep-260
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ykjiq2jj
[INFO][2024-03-17 23:46:09,268][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-17 23:46:09,356][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-17 23:46:09,356][dance][wrapped_func] Took 0:00:00.087265 to load and process data.
[INFO][2024-03-17 23:46:09,356][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-17 23:46:09,357][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-17 23:46:09,372][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-17 23:46:09,372][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-17 23:46:09,495][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-17 23:46:09,495][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.000 MB of 0.012 MB uploadedwandb: \ 0.000 MB of 0.012 MB uploadedwandb: | 0.000 MB of 0.012 MB uploadedwandb: / 0.000 MB of 0.012 MB uploadedwandb: - 0.000 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.001 MB of 0.025 MB uploadedwandb: / 0.001 MB of 0.025 MB uploadedwandb: - 0.001 MB of 0.025 MB uploadedwandb: \ 0.001 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.004 MB of 0.025 MB uploadedwandb: | 0.004 MB of 0.025 MB uploadedwandb: / 0.004 MB of 0.025 MB uploadedwandb: - 0.004 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run decent-sweep-260 at: https://wandb.ai/xzy11632/dance-dev/runs/ykjiq2jj
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240317_234604-ykjiq2jj/logs
wandb: ERROR Run ykjiq2jj errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: 21wmw7d6 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240317_235253-21wmw7d6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run smart-sweep-261
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/21wmw7d6
[INFO][2024-03-17 23:52:58,421][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-17 23:52:58,521][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-17 23:52:58,521][dance][wrapped_func] Took 0:00:00.091492 to load and process data.
[INFO][2024-03-17 23:52:58,521][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-17 23:52:58,523][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-17 23:52:58,543][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-17 23:52:58,543][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-17 23:52:58,688][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-17 23:52:58,689][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.016 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run smart-sweep-261 at: https://wandb.ai/xzy11632/dance-dev/runs/21wmw7d6
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240317_235253-21wmw7d6/logs
wandb: ERROR Run 21wmw7d6 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: ry3xxbx2 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240317_235519-ry3xxbx2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fancy-sweep-262
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ry3xxbx2
[INFO][2024-03-17 23:55:24,720][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-17 23:55:24,806][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-17 23:55:24,806][dance][wrapped_func] Took 0:00:00.085015 to load and process data.
[INFO][2024-03-17 23:55:24,806][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-17 23:55:24,808][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-17 23:55:24,825][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-17 23:55:24,825][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-17 23:55:24,998][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-17 23:55:24,998][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run fancy-sweep-262 at: https://wandb.ai/xzy11632/dance-dev/runs/ry3xxbx2
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240317_235519-ry3xxbx2/logs
wandb: ERROR Run ry3xxbx2 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: 0wz18c2l with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240317_235540-0wz18c2l
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run laced-sweep-263
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/0wz18c2l
[INFO][2024-03-17 23:55:45,480][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-17 23:55:45,565][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-17 23:55:45,566][dance][wrapped_func] Took 0:00:00.085417 to load and process data.
[INFO][2024-03-17 23:55:45,566][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-17 23:55:45,567][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-17 23:55:45,582][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-17 23:55:45,582][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-17 23:55:45,716][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-17 23:55:45,717][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-17 23:55:46,649][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=6)
[INFO][2024-03-17 23:55:46,650][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.65%
[INFO][2024-03-17 23:55:51,402][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-17 23:55:51,402][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-17 23:55:51,402][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-17 23:55:51,402][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:23,  1.18it/s]  2%|‚ñè         | 2/100 [00:01<01:21,  1.20it/s]  3%|‚ñé         | 3/100 [00:02<01:23,  1.17it/s]  4%|‚ñç         | 4/100 [00:03<01:22,  1.16it/s]  5%|‚ñå         | 5/100 [00:04<01:21,  1.17it/s]  6%|‚ñå         | 6/100 [00:05<01:22,  1.14it/s]  7%|‚ñã         | 7/100 [00:06<01:24,  1.10it/s]  8%|‚ñä         | 8/100 [00:06<01:20,  1.14it/s]  9%|‚ñâ         | 9/100 [00:07<01:20,  1.13it/s] 10%|‚ñà         | 10/100 [00:08<01:20,  1.12it/s] 11%|‚ñà         | 11/100 [00:09<01:18,  1.13it/s] 12%|‚ñà‚ñè        | 12/100 [00:10<01:18,  1.13it/s] 13%|‚ñà‚ñé        | 13/100 [00:11<01:18,  1.10it/s] 14%|‚ñà‚ñç        | 14/100 [00:12<01:16,  1.12it/s] 15%|‚ñà‚ñå        | 15/100 [00:13<01:16,  1.10it/s] 16%|‚ñà‚ñå        | 16/100 [00:14<01:14,  1.13it/s] 17%|‚ñà‚ñã        | 17/100 [00:14<01:12,  1.14it/s] 18%|‚ñà‚ñä        | 18/100 [00:15<01:10,  1.16it/s] 19%|‚ñà‚ñâ        | 19/100 [00:16<01:11,  1.14it/s] 20%|‚ñà‚ñà        | 20/100 [00:17<01:09,  1.15it/s] 21%|‚ñà‚ñà        | 21/100 [00:18<01:08,  1.15it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:19<01:09,  1.13it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:20<01:10,  1.09it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:21<01:08,  1.10it/s] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:22<01:07,  1.11it/s] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:23<01:07,  1.10it/s] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:24<01:07,  1.09it/s] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:24<01:04,  1.12it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:25<01:01,  1.15it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:26<01:00,  1.16it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:27<00:57,  1.19it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:28<00:56,  1.21it/s] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:28<00:55,  1.20it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:29<00:55,  1.18it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:30<00:54,  1.19it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:31<00:54,  1.18it/s] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:32<00:54,  1.15it/s] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:33<00:56,  1.10it/s] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:34<00:56,  1.08it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:35<00:56,  1.05it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:36<00:56,  1.04it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:37<00:59,  1.02s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:38<00:59,  1.04s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:39<00:57,  1.03s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:40<00:56,  1.03s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:41<00:55,  1.02s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:42<00:53,  1.01s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:43<00:52,  1.01s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:44<00:51,  1.01s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:45<00:49,  1.02it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:46<00:46,  1.06it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:47<00:44,  1.07it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:48<00:44,  1.06it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:49<00:41,  1.10it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:50<00:40,  1.12it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:50<00:39,  1.11it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [00:51<00:39,  1.08it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [00:52<00:37,  1.11it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [00:53<00:36,  1.11it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [00:54<00:34,  1.14it/s] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [00:55<00:34,  1.15it/s] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [00:56<00:32,  1.16it/s] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [00:57<00:32,  1.13it/s] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [00:57<00:30,  1.16it/s] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [00:58<00:30,  1.15it/s] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [00:59<00:28,  1.18it/s] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:00<00:28,  1.17it/s] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:01<00:27,  1.15it/s] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:02<00:28,  1.08it/s] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:03<00:28,  1.06it/s] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:04<00:27,  1.05it/s] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:05<00:26,  1.04it/s] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:06<00:25,  1.05it/s] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:07<00:25,  1.04it/s] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:08<00:23,  1.04it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:09<00:23,  1.02it/s] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:10<00:22,  1.02it/s] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:11<00:21,  1.01it/s] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:12<00:21,  1.02s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:13<00:20,  1.02s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:14<00:19,  1.02s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:15<00:18,  1.02s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:16<00:16,  1.01it/s] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:17<00:15,  1.03it/s] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:18<00:14,  1.03it/s] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:19<00:13,  1.03it/s] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:20<00:12,  1.01it/s] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:21<00:11,  1.01it/s] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:22<00:10,  1.02it/s] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:23<00:09,  1.02it/s] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:24<00:08,  1.01it/s] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:25<00:07,  1.01it/s] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:26<00:07,  1.02s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:27<00:06,  1.03s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:28<00:05,  1.05s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:29<00:04,  1.05s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:30<00:03,  1.03s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:31<00:02,  1.01s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:32<00:00,  1.01it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:33<00:00,  1.00it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:33<00:00,  1.07it/s]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.22184
wandb: 
wandb: üöÄ View run laced-sweep-263 at: https://wandb.ai/xzy11632/dance-dev/runs/0wz18c2l
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240317_235540-0wz18c2l/logs
wandb: Agent Starting Run: vb8v7svy with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240317_235859-vb8v7svy
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ethereal-sweep-264
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/vb8v7svy
[INFO][2024-03-17 23:59:04,940][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-17 23:59:05,034][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-17 23:59:05,034][dance][wrapped_func] Took 0:00:00.093077 to load and process data.
[INFO][2024-03-17 23:59:05,034][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-17 23:59:05,036][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-17 23:59:05,056][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-17 23:59:05,056][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-17 23:59:05,188][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-17 23:59:05,189][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-17 23:59:06,604][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=8)
[INFO][2024-03-17 23:59:06,605][dance.WeightedFeatureSVD][__call__] Total explained variance: 92.30%
[INFO][2024-03-17 23:59:08,263][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-17 23:59:08,264][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-17 23:59:08,264][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-17 23:59:08,264][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:01,  1.22s/it]  2%|‚ñè         | 2/100 [00:02<01:49,  1.12s/it]  3%|‚ñé         | 3/100 [00:03<01:41,  1.04s/it]  4%|‚ñç         | 4/100 [00:04<01:33,  1.03it/s]  5%|‚ñå         | 5/100 [00:04<01:28,  1.08it/s]  6%|‚ñå         | 6/100 [00:05<01:26,  1.09it/s]  7%|‚ñã         | 7/100 [00:06<01:25,  1.08it/s]  8%|‚ñä         | 8/100 [00:07<01:27,  1.05it/s]  9%|‚ñâ         | 9/100 [00:08<01:29,  1.02it/s] 10%|‚ñà         | 10/100 [00:09<01:29,  1.00it/s] 11%|‚ñà         | 11/100 [00:10<01:28,  1.01it/s] 12%|‚ñà‚ñè        | 12/100 [00:11<01:27,  1.00it/s] 13%|‚ñà‚ñé        | 13/100 [00:12<01:30,  1.04s/it] 14%|‚ñà‚ñç        | 14/100 [00:14<01:33,  1.09s/it] 15%|‚ñà‚ñå        | 15/100 [00:15<01:30,  1.06s/it] 16%|‚ñà‚ñå        | 16/100 [00:16<01:30,  1.08s/it] 17%|‚ñà‚ñã        | 17/100 [00:17<01:28,  1.07s/it] 18%|‚ñà‚ñä        | 18/100 [00:18<01:26,  1.05s/it] 19%|‚ñà‚ñâ        | 19/100 [00:19<01:22,  1.02s/it] 20%|‚ñà‚ñà        | 20/100 [00:20<01:22,  1.03s/it] 21%|‚ñà‚ñà        | 21/100 [00:21<01:23,  1.05s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:22<01:21,  1.04s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:23<01:20,  1.05s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:24<01:18,  1.03s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:25<01:16,  1.02s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:26<01:16,  1.03s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:27<01:18,  1.07s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:28<01:16,  1.06s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:29<01:15,  1.06s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:30<01:11,  1.02s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:31<01:09,  1.00s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:32<01:07,  1.00it/s] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:33<01:06,  1.00it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:34<01:07,  1.02s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:35<01:09,  1.07s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:37<01:23,  1.31s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:39<01:23,  1.32s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:40<01:28,  1.42s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:42<01:32,  1.52s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:43<01:27,  1.46s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:45<01:24,  1.44s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:46<01:19,  1.36s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:47<01:10,  1.23s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:48<01:04,  1.15s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:49<00:58,  1.07s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:50<00:55,  1.02s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:51<00:53,  1.00s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:52<00:53,  1.03s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:53<00:51,  1.01s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:54<00:49,  1.02it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:54<00:46,  1.06it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:55<00:45,  1.06it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:56<00:43,  1.07it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:57<00:46,  1.00s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:59<00:46,  1.04s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:00<00:46,  1.07s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:01<00:46,  1.09s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:02<00:43,  1.03s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:03<00:40,  1.01it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:04<00:39,  1.02it/s] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:05<00:38,  1.02it/s] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:06<00:38,  1.02s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:07<00:38,  1.03s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:08<00:37,  1.04s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:09<00:36,  1.05s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:10<00:35,  1.03s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:11<00:33,  1.01s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:12<00:33,  1.04s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:13<00:32,  1.04s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:14<00:30,  1.01s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:15<00:30,  1.04s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:16<00:28,  1.01s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:17<00:25,  1.05it/s] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:18<00:24,  1.07it/s] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:19<00:23,  1.08it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:20<00:22,  1.08it/s] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:20<00:21,  1.08it/s] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:21<00:20,  1.05it/s] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:22<00:19,  1.08it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:23<00:18,  1.10it/s] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:24<00:17,  1.11it/s] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:25<00:16,  1.09it/s] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:26<00:15,  1.09it/s] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:27<00:14,  1.07it/s] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:28<00:13,  1.08it/s] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:29<00:12,  1.10it/s] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:30<00:11,  1.09it/s] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:31<00:10,  1.12it/s] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:31<00:09,  1.13it/s] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:32<00:08,  1.13it/s] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:33<00:08,  1.12it/s] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:34<00:07,  1.10it/s] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:35<00:06,  1.09it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:36<00:05,  1.06it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:37<00:04,  1.06it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:38<00:03,  1.10it/s] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:39<00:02,  1.12it/s] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:40<00:01,  1.08it/s] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:41<00:00,  1.08it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:42<00:00,  1.07it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:42<00:00,  1.02s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.24641
wandb: 
wandb: üöÄ View run ethereal-sweep-264 at: https://wandb.ai/xzy11632/dance-dev/runs/vb8v7svy
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240317_235859-vb8v7svy/logs
wandb: Agent Starting Run: 8nyvu6av with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_000215-8nyvu6av
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run cool-sweep-265
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/8nyvu6av
[INFO][2024-03-18 00:02:20,223][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 00:02:20,303][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 00:02:20,303][dance][wrapped_func] Took 0:00:00.080041 to load and process data.
[INFO][2024-03-18 00:02:20,303][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 00:02:20,305][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 00:02:20,326][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 00:02:20,326][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 00:02:20,464][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 00:02:20,505][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 00:02:21,624][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 919) (k=40)
[INFO][2024-03-18 00:02:21,625][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.02%
[INFO][2024-03-18 00:02:24,001][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 00:02:24,001][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 00:02:24,001][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 00:02:24,002][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:55,  1.17s/it]  2%|‚ñè         | 2/100 [00:02<01:47,  1.09s/it]  3%|‚ñé         | 3/100 [00:03<01:49,  1.13s/it]  4%|‚ñç         | 4/100 [00:04<01:48,  1.13s/it]  5%|‚ñå         | 5/100 [00:05<01:43,  1.09s/it]  6%|‚ñå         | 6/100 [00:06<01:39,  1.06s/it]  7%|‚ñã         | 7/100 [00:07<01:39,  1.07s/it]  8%|‚ñä         | 8/100 [00:08<01:37,  1.06s/it]  9%|‚ñâ         | 9/100 [00:09<01:36,  1.06s/it] 10%|‚ñà         | 10/100 [00:10<01:33,  1.03s/it] 11%|‚ñà         | 11/100 [00:11<01:30,  1.01s/it] 12%|‚ñà‚ñè        | 12/100 [00:12<01:28,  1.00s/it] 13%|‚ñà‚ñé        | 13/100 [00:13<01:24,  1.02it/s] 14%|‚ñà‚ñç        | 14/100 [00:14<01:22,  1.04it/s] 15%|‚ñà‚ñå        | 15/100 [00:15<01:21,  1.04it/s] 16%|‚ñà‚ñå        | 16/100 [00:16<01:20,  1.04it/s] 17%|‚ñà‚ñã        | 17/100 [00:17<01:18,  1.05it/s] 18%|‚ñà‚ñä        | 18/100 [00:18<01:20,  1.02it/s] 19%|‚ñà‚ñâ        | 19/100 [00:19<01:20,  1.01it/s] 20%|‚ñà‚ñà        | 20/100 [00:20<01:17,  1.03it/s] 21%|‚ñà‚ñà        | 21/100 [00:21<01:16,  1.04it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:22<01:14,  1.04it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:23<01:13,  1.05it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:24<01:11,  1.06it/s] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:24<01:09,  1.07it/s] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:25<01:08,  1.08it/s] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:26<01:09,  1.05it/s] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:27<01:08,  1.05it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:28<01:06,  1.06it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:29<01:05,  1.07it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:30<01:04,  1.07it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:31<01:03,  1.07it/s] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:32<01:02,  1.07it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:33<01:01,  1.07it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:34<01:00,  1.07it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:35<00:59,  1.08it/s] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:36<00:59,  1.07it/s] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:37<00:58,  1.05it/s] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:38<00:57,  1.06it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:39<00:56,  1.06it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:40<00:55,  1.06it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:40<00:54,  1.06it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:41<00:54,  1.05it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:42<00:53,  1.05it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:43<00:51,  1.06it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:44<00:50,  1.06it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:45<00:50,  1.06it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:46<00:49,  1.05it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:47<00:49,  1.04it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:48<00:48,  1.04it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:49<00:46,  1.04it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:50<00:45,  1.05it/s]Exception in thread Thread-11 (_thread_body):
Traceback (most recent call last):
  File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
  File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
  File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/filesync/step_upload.py", line 172, in _thread_body
    self._handle_event(event)
  File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/filesync/step_upload.py", line 236, in _handle_event
    self._start_upload_job(event)
  File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/filesync/step_upload.py", line 257, in _start_upload_job
    self._spawn_upload_sync(event)
  File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/filesync/step_upload.py", line 292, in _spawn_upload_sync
    self._pool.submit(run_and_notify)
  File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/concurrent/futures/thread.py", line 169, in submit
    raise RuntimeError('cannot schedule new futures after '
RuntimeError: cannot schedule new futures after interpreter shutdown
/home/zyxing/dance/dance/utils/matrix.py:178: NumbaExperimentalFeatureWarning: First-class function type feature is experimental
  for j in numba.prange(n):
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numba/np/ufunc/parallel.py:371: NumbaWarning: The TBB threading layer requires TBB version 2021 update 6 or later i.e., TBB_INTERFACE_VERSION >= 12060. Found TBB_INTERFACE_VERSION = 12050. The TBB threading layer is disabled.
  warnings.warn(problem)
[INFO][2024-03-18 00:07:04,890][dance][<module>] 
{'activation': 'relu',
 'agg': 'sum',
 'batch_size': 128,
 'cache': False,
 'count': 400,
 'data_dir': './temp_data',
 'dataset': 'human_pbmc2_cell',
 'device': 'cuda:1',
 'dropout': 0.1,
 'edge_norm': True,
 'epochs': 100,
 'eval_epoch': False,
 'hidden_1': 300,
 'hidden_2': 0,
 'hidden_bn': False,
 'hidden_dim': 200,
 'hidden_relu': False,
 'learning_rate': 1e-05,
 'n_hidden': 1,
 'n_layers': 1,
 'nb_genes': 3000,
 'node_features': 'scale',
 'normalize_weights': 'log_per_cell',
 'num_run': 1,
 'num_workers': 1,
 'plot': False,
 'root_path': '/home/zyxing/dance/examples/tuning/cluster_graphsc',
 'same_edge_values': False,
 'seed': 0,
 'show_epoch_ari': False,
 'summary_file_path': 'results/pipeline/best_test_acc.csv',
 'sweep_id': 'twij69w5',
 'tune_mode': 'pipeline_params'}
[INFO][2024-03-18 00:07:04,890][dance][<module>] 
 files is saved in /home/zyxing/dance/examples/tuning/cluster_graphsc/human_pbmc2_cell
[INFO][2024-03-18 00:07:04,909][dance][config] tune mode is set to pipeline_params,tune_mode will first be converted to pipeline
[INFO][2024-03-18 00:07:04,912][dance][wandb_sweep_agent] Spawning agent: sweep_id='twij69w5', entity='xzy11632', project='dance-dev', count=400
wandb: Agent Starting Run: qm6gigcr with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: Currently logged in as: xzy11632. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_000708-qm6gigcr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run snowy-sweep-266
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/qm6gigcr
[INFO][2024-03-18 00:07:13,724][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 00:07:13,824][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 00:07:13,824][dance][wrapped_func] Took 0:00:00.092086 to load and process data.
[INFO][2024-03-18 00:07:13,824][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 00:07:13,826][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 00:07:13,845][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 00:07:13,845][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 00:07:14,007][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 00:07:14,062][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 00:08:00,283][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 919) (k=129)
[INFO][2024-03-18 00:08:00,284][dance.WeightedFeatureSVD][__call__] Total explained variance: 94.30%
[INFO][2024-03-18 00:17:33,720][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 00:17:33,720][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 00:17:33,720][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 00:17:33,721][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:03<05:18,  3.22s/it]  2%|‚ñè         | 2/100 [00:05<04:07,  2.52s/it]  3%|‚ñé         | 3/100 [00:07<03:45,  2.32s/it]  4%|‚ñç         | 4/100 [00:09<03:33,  2.22s/it]  5%|‚ñå         | 5/100 [00:11<03:29,  2.20s/it]  6%|‚ñå         | 6/100 [00:13<03:24,  2.17s/it]  7%|‚ñã         | 7/100 [00:15<03:23,  2.19s/it]  8%|‚ñä         | 8/100 [00:17<03:16,  2.13s/it]  9%|‚ñâ         | 9/100 [00:20<03:14,  2.14s/it] 10%|‚ñà         | 10/100 [00:22<03:13,  2.15s/it] 11%|‚ñà         | 11/100 [00:24<03:17,  2.22s/it] 12%|‚ñà‚ñè        | 12/100 [00:26<03:07,  2.13s/it] 13%|‚ñà‚ñé        | 13/100 [00:28<03:00,  2.07s/it] 14%|‚ñà‚ñç        | 14/100 [00:30<02:57,  2.06s/it] 15%|‚ñà‚ñå        | 15/100 [00:32<02:58,  2.10s/it] 16%|‚ñà‚ñå        | 16/100 [00:34<02:52,  2.05s/it] 17%|‚ñà‚ñã        | 17/100 [00:36<02:48,  2.03s/it] 18%|‚ñà‚ñä        | 18/100 [00:38<02:49,  2.06s/it] 19%|‚ñà‚ñâ        | 19/100 [00:40<02:38,  1.96s/it] 20%|‚ñà‚ñà        | 20/100 [00:42<02:29,  1.86s/it] 21%|‚ñà‚ñà        | 21/100 [00:43<02:23,  1.82s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:45<02:17,  1.76s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:47<02:15,  1.76s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:48<02:10,  1.72s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:50<02:03,  1.64s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:51<01:58,  1.60s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:53<01:56,  1.60s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:55<01:58,  1.64s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:56<01:59,  1.69s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:58<01:56,  1.66s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [01:00<01:55,  1.67s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:01<01:42,  1.50s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:02<01:35,  1.42s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:03<01:29,  1.36s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:04<01:23,  1.29s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:06<01:19,  1.25s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:07<01:16,  1.21s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:08<01:13,  1.19s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:09<01:13,  1.20s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:10<01:11,  1.20s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:12<01:14,  1.26s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:13<01:12,  1.24s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:14<01:10,  1.23s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:15<01:07,  1.20s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:16<01:06,  1.20s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:18<01:04,  1.20s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:19<01:04,  1.22s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:20<01:07,  1.30s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:22<01:10,  1.39s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:23<01:10,  1.42s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:25<01:06,  1.35s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:26<01:02,  1.30s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:27<00:59,  1.26s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:28<00:56,  1.23s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:29<00:51,  1.15s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:30<00:48,  1.10s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:31<00:48,  1.12s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:32<00:47,  1.12s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:33<00:44,  1.09s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:34<00:41,  1.05s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:35<00:39,  1.01s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:37<00:48,  1.28s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:39<00:51,  1.38s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:40<00:46,  1.29s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:41<00:43,  1.24s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:42<00:40,  1.21s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:43<00:38,  1.16s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:44<00:37,  1.17s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:45<00:36,  1.16s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:47<00:33,  1.12s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:48<00:31,  1.10s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:49<00:30,  1.09s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:50<00:29,  1.11s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:51<00:29,  1.12s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:52<00:27,  1.11s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:53<00:26,  1.11s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:54<00:26,  1.14s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:55<00:24,  1.13s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:57<00:23,  1.12s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:58<00:22,  1.12s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:59<00:21,  1.11s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:00<00:20,  1.11s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:01<00:18,  1.11s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:02<00:18,  1.13s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:03<00:16,  1.13s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:05<00:16,  1.20s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:08<00:24,  1.90s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:11<00:26,  2.21s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:15<00:29,  2.71s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:17<00:24,  2.45s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:19<00:20,  2.31s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:23<00:22,  2.77s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:26<00:21,  3.07s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:30<00:18,  3.13s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:32<00:14,  2.95s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:34<00:10,  2.61s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:36<00:06,  2.31s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:37<00:04,  2.13s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:40<00:02,  2.20s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:42<00:00,  2.15s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:42<00:00,  1.62s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.016 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.27527
wandb: 
wandb: üöÄ View run snowy-sweep-266 at: https://wandb.ai/xzy11632/dance-dev/runs/qm6gigcr
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_000708-qm6gigcr/logs
wandb: Agent Starting Run: b7aj2bek with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_002222-b7aj2bek
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run volcanic-sweep-267
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/b7aj2bek
[INFO][2024-03-18 00:22:29,113][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 00:22:29,208][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 00:22:29,208][dance][wrapped_func] Took 0:00:00.082407 to load and process data.
[INFO][2024-03-18 00:22:29,208][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 00:22:29,210][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 00:22:29,227][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 00:22:29,353][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-18 00:22:29,520][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run volcanic-sweep-267 at: https://wandb.ai/xzy11632/dance-dev/runs/b7aj2bek
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_002222-b7aj2bek/logs
wandb: ERROR Run b7aj2bek errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1081) out of bounds (919)
wandb: ERROR 
wandb: Agent Starting Run: u3sm467b with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_002243-u3sm467b
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run winter-sweep-268
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/u3sm467b
[INFO][2024-03-18 00:22:49,353][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 00:22:49,444][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 00:22:49,444][dance][wrapped_func] Took 0:00:00.089874 to load and process data.
[INFO][2024-03-18 00:22:49,444][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 00:22:49,447][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 00:22:49,468][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 00:22:49,619][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-18 00:22:49,811][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.021 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.021 MB of 0.024 MB uploadedwandb: | 0.021 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run winter-sweep-268 at: https://wandb.ai/xzy11632/dance-dev/runs/u3sm467b
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_002243-u3sm467b/logs
wandb: ERROR Run u3sm467b errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1081) out of bounds (919)
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 4ta6l2yw with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_002310-4ta6l2yw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run jolly-sweep-269
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/4ta6l2yw
[INFO][2024-03-18 00:23:16,212][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 00:23:16,299][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 00:23:16,299][dance][wrapped_func] Took 0:00:00.086288 to load and process data.
[INFO][2024-03-18 00:23:16,299][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 00:23:16,301][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 00:23:16,321][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 00:23:16,482][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 00:23:17,353][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=8)
[INFO][2024-03-18 00:23:17,354][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.81%
[INFO][2024-03-18 00:23:21,505][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 00:23:21,505][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 00:23:21,506][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 00:23:21,506][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:20,  1.42s/it]  2%|‚ñè         | 2/100 [00:02<02:20,  1.44s/it]  3%|‚ñé         | 3/100 [00:04<02:27,  1.52s/it]  4%|‚ñç         | 4/100 [00:06<02:30,  1.56s/it]  5%|‚ñå         | 5/100 [00:07<02:24,  1.52s/it]  6%|‚ñå         | 6/100 [00:09<02:24,  1.53s/it]  7%|‚ñã         | 7/100 [00:10<02:11,  1.41s/it]  8%|‚ñä         | 8/100 [00:11<02:03,  1.34s/it]  9%|‚ñâ         | 9/100 [00:12<01:53,  1.24s/it] 10%|‚ñà         | 10/100 [00:13<01:44,  1.16s/it] 11%|‚ñà         | 11/100 [00:14<01:38,  1.10s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:34,  1.08s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:30,  1.04s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:30,  1.05s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:26,  1.01s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:22,  1.02it/s] 17%|‚ñà‚ñã        | 17/100 [00:20<01:20,  1.03it/s] 18%|‚ñà‚ñä        | 18/100 [00:21<01:21,  1.00it/s] 19%|‚ñà‚ñâ        | 19/100 [00:22<01:21,  1.01s/it] 20%|‚ñà‚ñà        | 20/100 [00:23<01:21,  1.02s/it] 21%|‚ñà‚ñà        | 21/100 [00:24<01:20,  1.02s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:25<01:16,  1.02it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:26<01:15,  1.02it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:27<01:16,  1.00s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:28<01:15,  1.01s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:29<01:17,  1.04s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:30<01:17,  1.06s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:31<01:14,  1.04s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:32<01:10,  1.01it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:33<01:06,  1.05it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:34<01:04,  1.07it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:35<01:03,  1.07it/s] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:36<01:01,  1.09it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:36<01:00,  1.10it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:37<01:00,  1.08it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:38<01:00,  1.06it/s] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:39<01:00,  1.04it/s] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:40<01:01,  1.00it/s] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:42<01:04,  1.06s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:43<01:05,  1.10s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:44<01:05,  1.12s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:45<01:07,  1.16s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:46<01:04,  1.13s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:47<01:01,  1.10s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:48<00:59,  1.08s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:49<00:58,  1.08s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:51<00:56,  1.06s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:52<00:56,  1.09s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:53<00:55,  1.10s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:54<00:54,  1.09s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:55<00:53,  1.08s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:56<00:51,  1.08s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:57<00:50,  1.08s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:58<00:51,  1.11s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:59<00:49,  1.10s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:00<00:47,  1.07s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:02<00:47,  1.11s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:03<00:48,  1.16s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:04<00:50,  1.22s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:06<00:52,  1.30s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:07<00:49,  1.27s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:08<00:47,  1.24s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:09<00:45,  1.24s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:10<00:43,  1.21s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:12<00:41,  1.18s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:13<00:39,  1.16s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:14<00:37,  1.15s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:15<00:37,  1.16s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:16<00:34,  1.13s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:17<00:32,  1.09s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:18<00:31,  1.07s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:19<00:29,  1.04s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:20<00:27,  1.02s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:21<00:26,  1.01s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:22<00:25,  1.03s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:23<00:24,  1.02s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:24<00:25,  1.12s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:26<00:27,  1.24s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:28<00:29,  1.40s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:29<00:30,  1.51s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:31<00:28,  1.52s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:33<00:28,  1.56s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:34<00:27,  1.59s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:35<00:22,  1.43s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:36<00:19,  1.32s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:37<00:17,  1.23s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:39<00:15,  1.19s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:40<00:13,  1.16s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:41<00:12,  1.13s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:42<00:10,  1.08s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:43<00:09,  1.04s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:44<00:08,  1.01s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:44<00:06,  1.01it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:45<00:05,  1.04it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:46<00:04,  1.06it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:47<00:03,  1.10it/s] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:48<00:02,  1.12it/s] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:49<00:01,  1.11it/s] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:50<00:00,  1.08it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:51<00:00,  1.06it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:51<00:00,  1.11s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.018 MB of 0.025 MB uploadedwandb: / 0.018 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.18613
wandb: 
wandb: üöÄ View run jolly-sweep-269 at: https://wandb.ai/xzy11632/dance-dev/runs/4ta6l2yw
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_002310-4ta6l2yw/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: vh6qrzeb with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_002711-vh6qrzeb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dandy-sweep-270
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/vh6qrzeb
[INFO][2024-03-18 00:27:19,792][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 00:27:19,869][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 00:27:19,870][dance][wrapped_func] Took 0:00:00.076734 to load and process data.
[INFO][2024-03-18 00:27:19,871][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 00:27:19,873][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 00:27:19,897][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 00:27:20,142][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 00:27:41,894][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=8)
[INFO][2024-03-18 00:27:41,897][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.76%
[INFO][2024-03-18 00:41:40,410][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 00:41:40,411][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 00:41:40,411][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 00:41:40,411][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:22,  1.44s/it]  2%|‚ñè         | 2/100 [00:02<02:09,  1.32s/it]  3%|‚ñé         | 3/100 [00:03<02:03,  1.27s/it]  4%|‚ñç         | 4/100 [00:05<02:00,  1.26s/it]  5%|‚ñå         | 5/100 [00:06<01:53,  1.19s/it]  6%|‚ñå         | 6/100 [00:07<01:52,  1.20s/it]  7%|‚ñã         | 7/100 [00:08<01:51,  1.20s/it]  8%|‚ñä         | 8/100 [00:09<01:51,  1.21s/it]  9%|‚ñâ         | 9/100 [00:10<01:47,  1.18s/it] 10%|‚ñà         | 10/100 [00:12<01:48,  1.21s/it] 11%|‚ñà         | 11/100 [00:13<01:52,  1.26s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:49,  1.25s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:44,  1.21s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:41,  1.19s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:40,  1.18s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:39,  1.18s/it] 17%|‚ñà‚ñã        | 17/100 [00:20<01:39,  1.20s/it] 18%|‚ñà‚ñä        | 18/100 [00:21<01:38,  1.20s/it] 19%|‚ñà‚ñâ        | 19/100 [00:23<01:35,  1.18s/it] 20%|‚ñà‚ñà        | 20/100 [00:24<01:34,  1.18s/it] 21%|‚ñà‚ñà        | 21/100 [00:25<01:34,  1.19s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:26<01:32,  1.18s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:27<01:34,  1.22s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:29<01:31,  1.20s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:30<01:31,  1.21s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:31<01:26,  1.17s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:32<01:26,  1.19s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:33<01:24,  1.17s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:34<01:25,  1.21s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:36<01:22,  1.19s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:37<01:23,  1.21s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:38<01:21,  1.20s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:39<01:20,  1.20s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:40<01:18,  1.19s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:42<01:15,  1.16s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:43<01:13,  1.15s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:44<01:14,  1.18s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:45<01:14,  1.20s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:46<01:13,  1.20s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:48<01:12,  1.21s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:49<01:10,  1.19s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:50<01:08,  1.19s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:51<01:08,  1.20s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:52<01:06,  1.18s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:53<01:05,  1.19s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:55<01:03,  1.18s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:56<01:01,  1.16s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:57<00:59,  1.15s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:58<00:58,  1.15s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:59<00:57,  1.15s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:00<00:56,  1.16s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:02<00:55,  1.16s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:03<00:54,  1.17s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:04<00:53,  1.17s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:05<00:51,  1.14s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:06<00:49,  1.13s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:07<00:49,  1.16s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:09<00:50,  1.19s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:10<00:48,  1.18s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:11<00:46,  1.16s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:12<00:44,  1.14s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:13<00:43,  1.14s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:14<00:42,  1.14s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:15<00:41,  1.14s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:17<00:40,  1.16s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:18<00:40,  1.18s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:19<00:39,  1.19s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:20<00:38,  1.22s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:21<00:37,  1.21s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:23<00:35,  1.18s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:24<00:33,  1.15s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:25<00:31,  1.14s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:26<00:30,  1.12s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:27<00:28,  1.11s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:28<00:28,  1.15s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:30<00:28,  1.21s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:31<00:27,  1.19s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:32<00:25,  1.15s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:33<00:23,  1.13s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:34<00:22,  1.13s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:35<00:20,  1.09s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:36<00:20,  1.11s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:37<00:19,  1.12s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:38<00:17,  1.09s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:39<00:15,  1.05s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:40<00:14,  1.01s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:41<00:12,  1.01it/s] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:42<00:11,  1.01it/s] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:43<00:10,  1.03it/s] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:44<00:09,  1.02it/s] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:45<00:08,  1.00it/s] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:46<00:07,  1.02it/s] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:47<00:06,  1.04it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:48<00:05,  1.01it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:49<00:04,  1.03it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:50<00:03,  1.03it/s] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:51<00:02,  1.01it/s] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:52<00:01,  1.03it/s] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:53<00:00,  1.03it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:54<00:00,  1.05it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:54<00:00,  1.14s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.021 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.18886
wandb: 
wandb: üöÄ View run dandy-sweep-270 at: https://wandb.ai/xzy11632/dance-dev/runs/vh6qrzeb
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_002711-vh6qrzeb/logs
wandb: Agent Starting Run: v284k1qj with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_004533-v284k1qj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run divine-sweep-270
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/v284k1qj
[INFO][2024-03-18 00:45:40,059][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 00:45:40,205][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 00:45:40,206][dance][wrapped_func] Took 0:00:00.146339 to load and process data.
[INFO][2024-03-18 00:45:40,207][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 00:45:40,209][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 00:45:40,231][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 00:45:40,231][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 00:45:40,455][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 00:45:40,455][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 00:45:40,857][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=6)
[INFO][2024-03-18 00:45:40,858][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.93%
[INFO][2024-03-18 00:50:22,614][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 00:50:22,615][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 00:50:22,615][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 00:50:22,615][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:47,  1.09s/it]  2%|‚ñè         | 2/100 [00:02<01:58,  1.21s/it]  3%|‚ñé         | 3/100 [00:03<01:59,  1.23s/it]  4%|‚ñç         | 4/100 [00:04<02:02,  1.27s/it]  5%|‚ñå         | 5/100 [00:06<02:06,  1.33s/it]  6%|‚ñå         | 6/100 [00:07<02:00,  1.28s/it]  7%|‚ñã         | 7/100 [00:08<01:59,  1.29s/it]  8%|‚ñä         | 8/100 [00:10<01:55,  1.25s/it]  9%|‚ñâ         | 9/100 [00:11<01:52,  1.24s/it] 10%|‚ñà         | 10/100 [00:12<01:50,  1.23s/it] 11%|‚ñà         | 11/100 [00:13<01:50,  1.24s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:47,  1.23s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:45,  1.22s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:43,  1.20s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:38,  1.16s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:38,  1.17s/it] 17%|‚ñà‚ñã        | 17/100 [00:20<01:37,  1.17s/it] 18%|‚ñà‚ñä        | 18/100 [00:21<01:32,  1.13s/it] 19%|‚ñà‚ñâ        | 19/100 [00:22<01:27,  1.08s/it] 20%|‚ñà‚ñà        | 20/100 [00:23<01:24,  1.06s/it] 21%|‚ñà‚ñà        | 21/100 [00:24<01:26,  1.09s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:25<01:23,  1.07s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:26<01:18,  1.03s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:27<01:18,  1.04s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:28<01:15,  1.00s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:29<01:15,  1.02s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:30<01:14,  1.02s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:31<01:11,  1.01it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:32<01:09,  1.03it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:33<01:07,  1.04it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:34<01:05,  1.06it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:35<01:05,  1.04it/s] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:36<01:04,  1.03it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:37<01:06,  1.01s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:38<01:09,  1.07s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:39<01:07,  1.05s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:40<01:05,  1.03s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:41<01:02,  1.01s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:42<01:02,  1.02s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:43<01:01,  1.03s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:45<01:01,  1.04s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:46<00:59,  1.03s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:46<00:56,  1.01it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:47<00:52,  1.06it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:48<00:50,  1.08it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:49<00:49,  1.10it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:50<00:49,  1.07it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:51<00:48,  1.06it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:52<00:50,  1.02it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:53<00:49,  1.02it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:54<00:46,  1.05it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:55<00:45,  1.06it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:56<00:44,  1.05it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:57<00:43,  1.06it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:58<00:42,  1.07it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:59<00:40,  1.08it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:00<00:41,  1.04it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:01<00:40,  1.03it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:01<00:38,  1.06it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:02<00:37,  1.08it/s] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:03<00:36,  1.08it/s] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:04<00:35,  1.07it/s] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:05<00:34,  1.06it/s] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:06<00:35,  1.01it/s] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:07<00:34,  1.03it/s] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:08<00:32,  1.03it/s] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:09<00:32,  1.01it/s] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:10<00:31,  1.00it/s] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:12<00:34,  1.11s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:13<00:34,  1.16s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:14<00:33,  1.14s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:15<00:30,  1.10s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:16<00:28,  1.06s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:17<00:26,  1.01s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:18<00:24,  1.01it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:19<00:23,  1.03it/s] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:20<00:23,  1.01s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:21<00:22,  1.01s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:22<00:20,  1.02it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:23<00:19,  1.01it/s] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:24<00:18,  1.02it/s] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:25<00:17,  1.01it/s] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:26<00:16,  1.01it/s] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:27<00:15,  1.01it/s] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:28<00:14,  1.02it/s] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:29<00:15,  1.09s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:30<00:14,  1.11s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:32<00:14,  1.18s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:32<00:12,  1.12s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:34<00:11,  1.12s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:35<00:10,  1.13s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:36<00:09,  1.15s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:37<00:07,  1.11s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:38<00:06,  1.11s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:39<00:05,  1.10s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:40<00:04,  1.13s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:41<00:03,  1.10s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:42<00:02,  1.08s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:43<00:01,  1.06s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:44<00:00,  1.05s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:44<00:00,  1.05s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.18403
wandb: 
wandb: üöÄ View run divine-sweep-270 at: https://wandb.ai/xzy11632/dance-dev/runs/v284k1qj
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_004533-v284k1qj/logs
wandb: Agent Starting Run: bx5dio6t with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_005350-bx5dio6t
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fallen-sweep-271
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/bx5dio6t
[INFO][2024-03-18 00:53:55,600][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 00:53:55,684][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 00:53:55,685][dance][wrapped_func] Took 0:00:00.084321 to load and process data.
[INFO][2024-03-18 00:53:55,685][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 00:53:55,687][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 00:53:55,706][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 00:53:55,824][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run fallen-sweep-271 at: https://wandb.ai/xzy11632/dance-dev/runs/bx5dio6t
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_005350-bx5dio6t/logs
wandb: ERROR Run bx5dio6t errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: dwsfyqg4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_005410-dwsfyqg4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run quiet-sweep-272
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/dwsfyqg4
[INFO][2024-03-18 00:54:16,457][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 00:54:16,548][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 00:54:16,548][dance][wrapped_func] Took 0:00:00.091377 to load and process data.
[INFO][2024-03-18 00:54:16,549][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 00:54:16,550][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 00:54:16,569][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 00:54:16,717][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run quiet-sweep-272 at: https://wandb.ai/xzy11632/dance-dev/runs/dwsfyqg4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_005410-dwsfyqg4/logs
wandb: ERROR Run dwsfyqg4 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: nxuo8iyx with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_005438-nxuo8iyx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run devout-sweep-273
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/nxuo8iyx
[INFO][2024-03-18 00:54:47,097][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 00:54:47,197][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 00:54:47,197][dance][wrapped_func] Took 0:00:00.099821 to load and process data.
[INFO][2024-03-18 00:54:47,197][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 00:54:47,199][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 00:54:47,216][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 00:54:47,385][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run devout-sweep-273 at: https://wandb.ai/xzy11632/dance-dev/runs/nxuo8iyx
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_005438-nxuo8iyx/logs
wandb: ERROR Run nxuo8iyx errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: xytabxtl with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_005500-xytabxtl
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ruby-sweep-274
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/xytabxtl
[INFO][2024-03-18 00:55:09,968][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 00:55:10,133][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 00:55:10,133][dance][wrapped_func] Took 0:00:00.164733 to load and process data.
[INFO][2024-03-18 00:55:10,134][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 00:55:10,136][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 00:55:10,162][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 00:55:10,340][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.015 MB of 0.024 MB uploadedwandb: - 0.015 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run ruby-sweep-274 at: https://wandb.ai/xzy11632/dance-dev/runs/xytabxtl
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_005500-xytabxtl/logs
wandb: ERROR Run xytabxtl errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: ddxsnm6y with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_005531-ddxsnm6y
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run scarlet-sweep-275
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ddxsnm6y
[INFO][2024-03-18 00:55:40,485][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 00:55:40,595][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 00:55:40,596][dance][wrapped_func] Took 0:00:00.110176 to load and process data.
[INFO][2024-03-18 00:55:40,596][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 00:55:40,598][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 00:55:40,618][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 00:55:40,808][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-18 00:55:46,119][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=9)
[INFO][2024-03-18 00:55:46,120][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.21%
[INFO][2024-03-18 01:04:46,587][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 01:04:46,588][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 01:04:46,588][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 01:04:46,589][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:33,  1.55s/it]  2%|‚ñè         | 2/100 [00:03<03:10,  1.94s/it]  3%|‚ñé         | 3/100 [00:05<02:48,  1.73s/it]  4%|‚ñç         | 4/100 [00:06<02:38,  1.65s/it]  5%|‚ñå         | 5/100 [00:08<02:41,  1.70s/it]  6%|‚ñå         | 6/100 [00:10<02:31,  1.61s/it]  7%|‚ñã         | 7/100 [00:11<02:34,  1.66s/it]  8%|‚ñä         | 8/100 [00:13<02:25,  1.58s/it]  9%|‚ñâ         | 9/100 [00:14<02:22,  1.57s/it] 10%|‚ñà         | 10/100 [00:16<02:26,  1.62s/it] 11%|‚ñà         | 11/100 [00:17<02:21,  1.59s/it] 12%|‚ñà‚ñè        | 12/100 [00:19<02:18,  1.57s/it] 13%|‚ñà‚ñé        | 13/100 [00:20<02:11,  1.51s/it] 14%|‚ñà‚ñç        | 14/100 [00:22<02:12,  1.54s/it] 15%|‚ñà‚ñå        | 15/100 [00:23<02:08,  1.51s/it] 16%|‚ñà‚ñå        | 16/100 [00:25<02:10,  1.55s/it] 17%|‚ñà‚ñã        | 17/100 [00:27<02:07,  1.54s/it] 18%|‚ñà‚ñä        | 18/100 [00:28<02:06,  1.54s/it] 19%|‚ñà‚ñâ        | 19/100 [00:30<02:02,  1.51s/it] 20%|‚ñà‚ñà        | 20/100 [00:31<01:55,  1.45s/it] 21%|‚ñà‚ñà        | 21/100 [00:32<01:48,  1.37s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:33<01:47,  1.37s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:35<01:46,  1.39s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:36<01:44,  1.38s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:38<01:44,  1.40s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:39<01:39,  1.35s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:40<01:35,  1.30s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:41<01:29,  1.24s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:42<01:28,  1.25s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:44<01:31,  1.30s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:45<01:33,  1.36s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:47<01:33,  1.37s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:48<01:31,  1.37s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:49<01:29,  1.35s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:51<01:27,  1.35s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:52<01:23,  1.31s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:53<01:25,  1.35s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:55<01:22,  1.33s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:56<01:22,  1.35s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:58<01:22,  1.37s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:59<01:19,  1.35s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:00<01:17,  1.33s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:01<01:16,  1.33s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:03<01:16,  1.37s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:04<01:16,  1.40s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:06<01:12,  1.35s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:07<01:09,  1.31s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:08<01:07,  1.30s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:10<01:07,  1.33s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:11<01:09,  1.40s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:13<01:08,  1.41s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:14<01:09,  1.45s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:15<01:06,  1.42s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:17<01:03,  1.38s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:18<01:02,  1.39s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:19<01:00,  1.37s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:21<00:59,  1.39s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:22<01:01,  1.46s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:24<00:57,  1.41s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:25<00:58,  1.46s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:27<00:55,  1.43s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:28<00:54,  1.43s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:30<00:55,  1.49s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:31<00:52,  1.45s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:33<00:50,  1.44s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:34<00:48,  1.43s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:35<00:47,  1.43s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:37<00:47,  1.47s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:39<00:50,  1.62s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:40<00:45,  1.52s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:41<00:41,  1.43s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:43<00:38,  1.39s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:44<00:36,  1.36s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:45<00:34,  1.32s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:46<00:32,  1.30s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:48<00:30,  1.28s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:49<00:28,  1.24s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:50<00:28,  1.28s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:51<00:26,  1.25s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:53<00:24,  1.23s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:54<00:23,  1.23s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:55<00:21,  1.20s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:56<00:19,  1.16s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:57<00:18,  1.19s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:58<00:17,  1.20s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:00<00:16,  1.18s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:01<00:15,  1.22s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:02<00:14,  1.20s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:03<00:13,  1.20s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:04<00:11,  1.19s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:06<00:10,  1.17s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:07<00:09,  1.15s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:08<00:07,  1.13s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:09<00:07,  1.17s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:10<00:05,  1.18s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:11<00:04,  1.17s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:13<00:03,  1.16s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:14<00:02,  1.19s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:15<00:01,  1.20s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:16<00:00,  1.17s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:16<00:00,  1.37s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.23871
wandb: 
wandb: üöÄ View run scarlet-sweep-275 at: https://wandb.ai/xzy11632/dance-dev/runs/ddxsnm6y
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_005531-ddxsnm6y/logs
wandb: Agent Starting Run: 98o4raa6 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_010844-98o4raa6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run breezy-sweep-276
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/98o4raa6
[INFO][2024-03-18 01:08:50,365][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 01:08:50,450][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 01:08:50,451][dance][wrapped_func] Took 0:00:00.085292 to load and process data.
[INFO][2024-03-18 01:08:50,451][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 01:08:50,454][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 01:08:50,481][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 01:08:50,681][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-18 01:09:06,508][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=14)
[INFO][2024-03-18 01:09:06,521][dance.WeightedFeatureSVD][__call__] Total explained variance: 92.77%
[INFO][2024-03-18 01:13:45,851][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 01:13:45,852][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 01:13:45,852][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 01:13:45,852][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:54,  1.16s/it]  2%|‚ñè         | 2/100 [00:02<01:59,  1.22s/it]  3%|‚ñé         | 3/100 [00:03<01:59,  1.23s/it]  4%|‚ñç         | 4/100 [00:04<01:56,  1.21s/it]  5%|‚ñå         | 5/100 [00:05<01:51,  1.18s/it]  6%|‚ñå         | 6/100 [00:07<01:52,  1.20s/it]  7%|‚ñã         | 7/100 [00:08<01:54,  1.23s/it]  8%|‚ñä         | 8/100 [00:09<01:54,  1.24s/it]  9%|‚ñâ         | 9/100 [00:11<01:54,  1.26s/it] 10%|‚ñà         | 10/100 [00:12<01:51,  1.24s/it] 11%|‚ñà         | 11/100 [00:13<01:52,  1.26s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:51,  1.27s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:50,  1.27s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:44,  1.22s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:40,  1.19s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:40,  1.19s/it] 17%|‚ñà‚ñã        | 17/100 [00:20<01:40,  1.21s/it] 18%|‚ñà‚ñä        | 18/100 [00:21<01:37,  1.19s/it] 19%|‚ñà‚ñâ        | 19/100 [00:23<01:35,  1.18s/it] 20%|‚ñà‚ñà        | 20/100 [00:24<01:34,  1.18s/it] 21%|‚ñà‚ñà        | 21/100 [00:25<01:34,  1.19s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:26<01:35,  1.22s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:28<01:40,  1.30s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:29<01:37,  1.29s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:30<01:34,  1.27s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:31<01:33,  1.26s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:33<01:30,  1.24s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:34<01:30,  1.26s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:35<01:27,  1.23s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:36<01:27,  1.25s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:38<01:25,  1.25s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:39<01:23,  1.22s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:40<01:23,  1.25s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:41<01:21,  1.23s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:42<01:16,  1.18s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:44<01:14,  1.17s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:45<01:14,  1.18s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:46<01:12,  1.16s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:47<01:11,  1.17s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:49<01:15,  1.25s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:50<01:14,  1.25s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:51<01:10,  1.22s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:52<01:09,  1.21s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:53<01:07,  1.21s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:55<01:05,  1.20s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:56<01:06,  1.24s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:57<01:06,  1.26s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:58<01:05,  1.25s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:59<01:01,  1.20s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:00<00:56,  1.13s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:01<00:53,  1.08s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:02<00:51,  1.07s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:03<00:49,  1.06s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:05<00:51,  1.13s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:06<00:49,  1.11s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:07<00:49,  1.12s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:08<00:48,  1.12s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:09<00:46,  1.10s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:10<00:46,  1.13s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:11<00:44,  1.10s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:13<00:44,  1.13s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:14<00:42,  1.13s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:15<00:40,  1.10s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:16<00:38,  1.08s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:17<00:37,  1.07s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:18<00:37,  1.10s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:19<00:37,  1.13s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:20<00:37,  1.17s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:22<00:35,  1.14s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:23<00:33,  1.10s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:24<00:31,  1.09s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:25<00:31,  1.13s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:26<00:29,  1.10s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:27<00:28,  1.08s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:28<00:26,  1.07s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:29<00:24,  1.03s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:30<00:23,  1.01s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:31<00:22,  1.01s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:32<00:20,  1.00it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:33<00:20,  1.02s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:34<00:19,  1.05s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:35<00:18,  1.05s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:36<00:18,  1.06s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:37<00:16,  1.06s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:38<00:15,  1.05s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:39<00:15,  1.07s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:41<00:14,  1.10s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:42<00:13,  1.10s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:43<00:12,  1.10s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:44<00:10,  1.06s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:45<00:09,  1.07s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:46<00:08,  1.06s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:47<00:07,  1.09s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:48<00:06,  1.14s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:49<00:05,  1.10s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:50<00:04,  1.09s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:51<00:03,  1.06s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:52<00:02,  1.08s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:54<00:01,  1.15s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:55<00:00,  1.13s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:55<00:00,  1.15s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.018 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.29644
wandb: 
wandb: üöÄ View run breezy-sweep-276 at: https://wandb.ai/xzy11632/dance-dev/runs/98o4raa6
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_010844-98o4raa6/logs
wandb: Agent Starting Run: ybiemvko with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_011733-ybiemvko
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fiery-sweep-277
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ybiemvko
[INFO][2024-03-18 01:17:40,172][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 01:17:40,272][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 01:17:40,272][dance][wrapped_func] Took 0:00:00.099028 to load and process data.
[INFO][2024-03-18 01:17:40,272][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 01:17:40,275][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 01:17:40,296][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 01:17:40,296][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 01:17:40,469][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[WARNING][2024-03-18 01:18:49,101][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 01:19:07,057][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 919) (k=556)
[INFO][2024-03-18 01:19:07,058][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.03%
[INFO][2024-03-18 01:28:10,589][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 01:28:10,590][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 01:28:10,590][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 01:28:10,591][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:02<04:17,  2.60s/it]  2%|‚ñè         | 2/100 [00:04<04:03,  2.48s/it]  3%|‚ñé         | 3/100 [00:06<03:34,  2.21s/it]  4%|‚ñç         | 4/100 [00:08<03:03,  1.91s/it]  5%|‚ñå         | 5/100 [00:09<02:51,  1.80s/it]  6%|‚ñå         | 6/100 [00:11<02:42,  1.72s/it]  7%|‚ñã         | 7/100 [00:13<02:35,  1.67s/it]  8%|‚ñä         | 8/100 [00:14<02:29,  1.62s/it]  9%|‚ñâ         | 9/100 [00:16<02:22,  1.57s/it] 10%|‚ñà         | 10/100 [00:17<02:18,  1.54s/it] 11%|‚ñà         | 11/100 [00:19<02:16,  1.54s/it] 12%|‚ñà‚ñè        | 12/100 [00:20<02:17,  1.56s/it] 13%|‚ñà‚ñé        | 13/100 [00:22<02:12,  1.52s/it] 14%|‚ñà‚ñç        | 14/100 [00:23<02:11,  1.53s/it] 15%|‚ñà‚ñå        | 15/100 [00:25<02:11,  1.55s/it] 16%|‚ñà‚ñå        | 16/100 [00:26<02:09,  1.54s/it] 17%|‚ñà‚ñã        | 17/100 [00:28<02:11,  1.59s/it] 18%|‚ñà‚ñä        | 18/100 [00:30<02:09,  1.58s/it] 19%|‚ñà‚ñâ        | 19/100 [00:31<02:06,  1.57s/it] 20%|‚ñà‚ñà        | 20/100 [00:33<02:03,  1.55s/it] 21%|‚ñà‚ñà        | 21/100 [00:34<02:04,  1.57s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:36<01:59,  1.53s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:37<01:56,  1.52s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:39<01:53,  1.49s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:40<01:43,  1.38s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:41<01:36,  1.31s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:42<01:34,  1.29s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:43<01:34,  1.31s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:45<01:30,  1.27s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:46<01:30,  1.29s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:47<01:27,  1.27s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:48<01:23,  1.23s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:50<01:23,  1.24s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:51<01:20,  1.22s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:52<01:19,  1.22s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:53<01:18,  1.22s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:54<01:18,  1.25s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:56<01:16,  1.24s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:57<01:15,  1.24s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:58<01:15,  1.26s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:59<01:13,  1.25s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:01<01:11,  1.23s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:02<01:09,  1.22s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:03<01:07,  1.21s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:07<01:50,  2.01s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:11<02:15,  2.51s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:15<02:45,  3.13s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:18<02:38,  3.05s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:20<02:24,  2.84s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:22<02:03,  2.46s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:24<01:48,  2.21s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:25<01:36,  2.01s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:27<01:26,  1.83s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:28<01:19,  1.73s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:30<01:14,  1.66s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:31<01:12,  1.65s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:33<01:10,  1.65s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:34<01:06,  1.58s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:36<01:04,  1.57s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:37<01:00,  1.51s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:39<00:58,  1.49s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:41<01:02,  1.63s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:45<01:28,  2.39s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:49<01:46,  2.97s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:53<01:51,  3.19s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:57<01:54,  3.37s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:59<01:47,  3.25s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [02:02<01:39,  3.11s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:04<01:21,  2.63s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:05<01:08,  2.28s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:06<00:57,  1.97s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:08<00:48,  1.74s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:09<00:44,  1.64s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:10<00:39,  1.51s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:11<00:34,  1.36s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:12<00:29,  1.25s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:13<00:26,  1.17s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:14<00:24,  1.13s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:15<00:22,  1.08s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:16<00:21,  1.07s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:17<00:19,  1.03s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:18<00:18,  1.02s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:19<00:17,  1.01s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:20<00:16,  1.03s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:21<00:15,  1.04s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:22<00:14,  1.03s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:23<00:13,  1.02s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:24<00:12,  1.02s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:25<00:11,  1.03s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:27<00:10,  1.04s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:28<00:09,  1.04s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:29<00:08,  1.06s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:31<00:09,  1.38s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:32<00:07,  1.30s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:33<00:06,  1.28s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:34<00:04,  1.24s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:35<00:03,  1.19s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:36<00:02,  1.16s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:38<00:01,  1.14s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:39<00:00,  1.13s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:39<00:00,  1.59s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.2857
wandb: 
wandb: üöÄ View run fiery-sweep-277 at: https://wandb.ai/xzy11632/dance-dev/runs/ybiemvko
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_011733-ybiemvko/logs
wandb: Agent Starting Run: zmrsp3tx with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_013327-zmrsp3tx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run bumbling-sweep-278
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/zmrsp3tx
[INFO][2024-03-18 01:33:33,157][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 01:33:33,277][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 01:33:33,277][dance][wrapped_func] Took 0:00:00.119547 to load and process data.
[INFO][2024-03-18 01:33:33,277][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 01:33:33,281][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 01:33:33,313][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 01:33:33,314][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 01:33:33,472][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[WARNING][2024-03-18 01:34:27,123][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 01:37:26,172][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 919) (k=564)
[INFO][2024-03-18 01:37:26,173][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.06%
[INFO][2024-03-18 01:51:12,803][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 01:51:12,804][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 01:51:12,804][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 01:51:12,804][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:03<05:13,  3.16s/it]  2%|‚ñè         | 2/100 [00:06<05:25,  3.33s/it]  3%|‚ñé         | 3/100 [00:10<05:58,  3.70s/it]  4%|‚ñç         | 4/100 [00:14<05:59,  3.75s/it]  5%|‚ñå         | 5/100 [00:18<05:54,  3.73s/it]  6%|‚ñå         | 6/100 [00:22<06:04,  3.88s/it]  7%|‚ñã         | 7/100 [00:25<05:45,  3.72s/it]  8%|‚ñä         | 8/100 [00:29<05:27,  3.56s/it]  9%|‚ñâ         | 9/100 [00:32<05:16,  3.48s/it] 10%|‚ñà         | 10/100 [00:35<05:02,  3.36s/it] 11%|‚ñà         | 11/100 [00:38<04:56,  3.33s/it] 12%|‚ñà‚ñè        | 12/100 [00:41<04:44,  3.23s/it] 13%|‚ñà‚ñé        | 13/100 [00:44<04:38,  3.20s/it] 14%|‚ñà‚ñç        | 14/100 [00:48<04:44,  3.31s/it] 15%|‚ñà‚ñå        | 15/100 [00:51<04:46,  3.37s/it] 16%|‚ñà‚ñå        | 16/100 [00:55<04:42,  3.36s/it] 17%|‚ñà‚ñã        | 17/100 [00:58<04:42,  3.40s/it] 18%|‚ñà‚ñä        | 18/100 [01:01<04:32,  3.32s/it] 19%|‚ñà‚ñâ        | 19/100 [01:06<04:52,  3.61s/it] 20%|‚ñà‚ñà        | 20/100 [01:10<04:59,  3.74s/it] 21%|‚ñà‚ñà        | 21/100 [01:13<04:45,  3.61s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [01:17<04:40,  3.60s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [01:20<04:34,  3.56s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [01:23<04:24,  3.48s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [01:27<04:34,  3.66s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [01:32<04:49,  3.92s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [01:36<04:49,  3.97s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [01:40<04:48,  4.00s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [01:44<04:42,  3.99s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [01:47<04:23,  3.77s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [01:51<04:11,  3.64s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:54<04:00,  3.54s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:57<03:50,  3.44s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [02:01<03:48,  3.47s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [02:04<03:46,  3.48s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [02:08<03:45,  3.53s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [02:12<03:53,  3.71s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [02:15<03:44,  3.63s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [02:19<03:42,  3.64s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [02:22<03:31,  3.52s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [02:26<03:23,  3.44s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [02:29<03:15,  3.37s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [02:32<03:12,  3.37s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [02:35<03:07,  3.34s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [02:39<03:03,  3.34s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [02:42<03:02,  3.38s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [02:46<03:01,  3.43s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [02:50<03:02,  3.51s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [02:54<03:12,  3.78s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [02:58<03:13,  3.87s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [03:02<03:17,  4.03s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [03:06<03:09,  3.96s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [03:11<03:10,  4.06s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [03:15<03:11,  4.16s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [03:19<03:04,  4.10s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [03:23<03:01,  4.13s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [03:27<02:56,  4.11s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [03:32<02:56,  4.20s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [03:36<02:52,  4.22s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [03:40<02:46,  4.15s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [03:44<02:42,  4.16s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [03:48<02:34,  4.07s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [03:52<02:27,  4.00s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [03:56<02:22,  3.97s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [03:59<02:16,  3.89s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [04:03<02:11,  3.87s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [04:07<02:08,  3.89s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [04:11<02:02,  3.84s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [04:15<02:02,  3.95s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [04:18<01:54,  3.81s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [04:22<01:47,  3.70s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [04:26<01:43,  3.70s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [04:29<01:40,  3.71s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [04:33<01:35,  3.68s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [04:36<01:29,  3.60s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [04:40<01:24,  3.54s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [04:43<01:20,  3.50s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [04:47<01:18,  3.58s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [04:50<01:13,  3.50s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [04:54<01:08,  3.44s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [04:57<01:05,  3.46s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [05:01<01:02,  3.46s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [05:04<00:59,  3.49s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [05:07<00:55,  3.45s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [05:10<00:49,  3.28s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [05:12<00:40,  2.90s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [05:14<00:34,  2.65s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [05:17<00:30,  2.57s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [05:19<00:27,  2.46s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [05:22<00:24,  2.48s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [05:24<00:21,  2.34s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [05:26<00:18,  2.26s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [05:28<00:15,  2.17s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [05:30<00:13,  2.18s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [05:32<00:10,  2.11s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [05:34<00:08,  2.09s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [05:36<00:06,  2.10s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [05:38<00:04,  2.05s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [05:40<00:02,  2.12s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [05:42<00:00,  2.12s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [05:42<00:00,  3.43s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.29006
wandb: 
wandb: üöÄ View run bumbling-sweep-278 at: https://wandb.ai/xzy11632/dance-dev/runs/zmrsp3tx
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_013327-zmrsp3tx/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: w96hcqnc with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_015924-w96hcqnc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run scarlet-sweep-279
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/w96hcqnc
[INFO][2024-03-18 01:59:33,921][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 01:59:34,047][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 01:59:34,048][dance][wrapped_func] Took 0:00:00.126488 to load and process data.
[INFO][2024-03-18 01:59:34,048][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 01:59:34,052][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 01:59:34,083][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 01:59:34,406][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-18 02:01:06,671][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run scarlet-sweep-279 at: https://wandb.ai/xzy11632/dance-dev/runs/w96hcqnc
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_015924-w96hcqnc/logs
wandb: ERROR Run w96hcqnc errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1081) out of bounds (919)
wandb: ERROR 
wandb: Agent Starting Run: 3izxgmql with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_020122-3izxgmql
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run eager-sweep-280
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/3izxgmql
[INFO][2024-03-18 02:01:36,592][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 02:01:36,708][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 02:01:36,709][dance][wrapped_func] Took 0:00:00.116457 to load and process data.
[INFO][2024-03-18 02:01:36,709][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 02:01:36,712][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 02:01:36,751][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 02:01:36,951][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-18 02:03:06,369][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run eager-sweep-280 at: https://wandb.ai/xzy11632/dance-dev/runs/3izxgmql
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_020122-3izxgmql/logs
wandb: ERROR Run 3izxgmql errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1081) out of bounds (919)
wandb: ERROR 
wandb: Agent Starting Run: 5r2sygi9 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_020319-5r2sygi9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run quiet-sweep-281
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/5r2sygi9
[INFO][2024-03-18 02:03:33,870][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 02:03:34,208][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 02:03:34,220][dance][wrapped_func] Took 0:00:00.350024 to load and process data.
[INFO][2024-03-18 02:03:34,221][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 02:03:34,224][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 02:03:34,308][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 02:03:35,101][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-18 02:05:13,862][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=86)
[INFO][2024-03-18 02:05:13,865][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.05%
[INFO][2024-03-18 02:11:23,740][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 02:11:23,742][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 02:11:23,742][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 02:11:23,742][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:27,  1.49s/it]  2%|‚ñè         | 2/100 [00:02<02:19,  1.43s/it]  3%|‚ñé         | 3/100 [00:04<02:13,  1.38s/it]  4%|‚ñç         | 4/100 [00:05<02:14,  1.40s/it]  5%|‚ñå         | 5/100 [00:07<02:16,  1.43s/it]  6%|‚ñå         | 6/100 [00:08<02:16,  1.45s/it]  7%|‚ñã         | 7/100 [00:09<02:12,  1.43s/it]  8%|‚ñä         | 8/100 [00:11<02:09,  1.41s/it]  9%|‚ñâ         | 9/100 [00:12<02:07,  1.40s/it] 10%|‚ñà         | 10/100 [00:13<02:00,  1.34s/it] 11%|‚ñà         | 11/100 [00:15<01:56,  1.31s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<01:55,  1.32s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<01:53,  1.30s/it] 14%|‚ñà‚ñç        | 14/100 [00:19<01:52,  1.31s/it] 15%|‚ñà‚ñå        | 15/100 [00:20<01:53,  1.34s/it] 16%|‚ñà‚ñå        | 16/100 [00:21<01:51,  1.33s/it] 17%|‚ñà‚ñã        | 17/100 [00:23<01:51,  1.35s/it] 18%|‚ñà‚ñä        | 18/100 [00:24<01:46,  1.30s/it] 19%|‚ñà‚ñâ        | 19/100 [00:25<01:45,  1.31s/it] 20%|‚ñà‚ñà        | 20/100 [00:26<01:42,  1.28s/it] 21%|‚ñà‚ñà        | 21/100 [00:28<01:42,  1.29s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:29<01:39,  1.27s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:30<01:37,  1.26s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:32<01:36,  1.27s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:33<01:34,  1.26s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:34<01:31,  1.23s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:35<01:28,  1.21s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:36<01:28,  1.23s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:37<01:22,  1.16s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:38<01:19,  1.14s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:39<01:15,  1.09s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:40<01:12,  1.07s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:41<01:08,  1.02s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:42<01:06,  1.00s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:43<01:03,  1.03it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:44<01:01,  1.04it/s] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:45<01:00,  1.04it/s] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:46<01:00,  1.03it/s] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:47<00:59,  1.03it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:48<00:59,  1.00it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:49<00:58,  1.00it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:50<00:56,  1.02it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:51<00:54,  1.04it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:52<00:53,  1.05it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:53<00:51,  1.07it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:54<00:51,  1.04it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:55<00:51,  1.03it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:56<00:49,  1.05it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:57<00:46,  1.09it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:57<00:45,  1.09it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:58<00:45,  1.08it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:59<00:45,  1.05it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:00<00:44,  1.06it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:02<00:46,  1.00s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:03<00:45,  1.02s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:03<00:43,  1.01it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:04<00:41,  1.03it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:05<00:41,  1.02it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:07<00:42,  1.04s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:08<00:40,  1.02s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:09<00:39,  1.02s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:10<00:37,  1.00it/s] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:10<00:35,  1.05it/s] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:11<00:34,  1.06it/s] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:12<00:33,  1.05it/s] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:13<00:31,  1.07it/s] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:14<00:31,  1.03it/s] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:15<00:31,  1.02it/s] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:16<00:30,  1.02it/s] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:17<00:29,  1.02it/s] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:18<00:27,  1.04it/s] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:19<00:27,  1.04it/s] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:20<00:26,  1.02it/s] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:21<00:25,  1.02it/s] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:22<00:24,  1.00it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:23<00:23,  1.02it/s] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:24<00:21,  1.05it/s] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:25<00:20,  1.06it/s] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:26<00:19,  1.05it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:27<00:19,  1.03it/s] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:28<00:18,  1.03it/s] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:29<00:17,  1.01it/s] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:30<00:16,  1.02it/s] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:31<00:15,  1.05it/s] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:32<00:14,  1.04it/s] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:33<00:13,  1.05it/s] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:34<00:12,  1.03it/s] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:35<00:11,  1.04it/s] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:35<00:10,  1.06it/s] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:36<00:09,  1.08it/s] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:37<00:08,  1.10it/s] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:38<00:07,  1.08it/s] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:39<00:06,  1.06it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:40<00:05,  1.05it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:41<00:04,  1.03it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:42<00:03,  1.05it/s] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:43<00:02,  1.04it/s] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:44<00:01,  1.05it/s] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:45<00:00,  1.06it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:46<00:00,  1.01it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:46<00:00,  1.07s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.021 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.22597
wandb: 
wandb: üöÄ View run quiet-sweep-281 at: https://wandb.ai/xzy11632/dance-dev/runs/5r2sygi9
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_020319-5r2sygi9/logs
wandb: Agent Starting Run: b7jmw4ir with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_021612-b7jmw4ir
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fast-sweep-282
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/b7jmw4ir
[INFO][2024-03-18 02:16:17,644][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 02:16:17,747][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 02:16:17,748][dance][wrapped_func] Took 0:00:00.102774 to load and process data.
[INFO][2024-03-18 02:16:17,748][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 02:16:17,751][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 02:16:17,777][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 02:16:18,051][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-18 02:17:48,224][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=85)
[INFO][2024-03-18 02:17:48,243][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.73%
[INFO][2024-03-18 02:17:59,293][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 02:17:59,294][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 02:17:59,294][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 02:17:59,294][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:29,  1.11it/s]  2%|‚ñè         | 2/100 [00:01<01:27,  1.12it/s]  3%|‚ñé         | 3/100 [00:02<01:29,  1.08it/s]  4%|‚ñç         | 4/100 [00:03<01:27,  1.09it/s]  5%|‚ñå         | 5/100 [00:04<01:27,  1.09it/s]  6%|‚ñå         | 6/100 [00:05<01:28,  1.06it/s]  7%|‚ñã         | 7/100 [00:06<01:25,  1.09it/s]  8%|‚ñä         | 8/100 [00:07<01:24,  1.09it/s]  9%|‚ñâ         | 9/100 [00:08<01:27,  1.04it/s] 10%|‚ñà         | 10/100 [00:09<01:27,  1.03it/s] 11%|‚ñà         | 11/100 [00:10<01:25,  1.04it/s] 12%|‚ñà‚ñè        | 12/100 [00:11<01:21,  1.07it/s] 13%|‚ñà‚ñé        | 13/100 [00:12<01:19,  1.09it/s] 14%|‚ñà‚ñç        | 14/100 [00:12<01:17,  1.11it/s] 15%|‚ñà‚ñå        | 15/100 [00:13<01:16,  1.12it/s] 16%|‚ñà‚ñå        | 16/100 [00:14<01:14,  1.13it/s] 17%|‚ñà‚ñã        | 17/100 [00:15<01:13,  1.12it/s] 18%|‚ñà‚ñä        | 18/100 [00:16<01:12,  1.13it/s] 19%|‚ñà‚ñâ        | 19/100 [00:17<01:11,  1.13it/s] 20%|‚ñà‚ñà        | 20/100 [00:18<01:15,  1.07it/s] 21%|‚ñà‚ñà        | 21/100 [00:19<01:18,  1.01it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:21<01:39,  1.27s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:23<01:49,  1.43s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:25<01:56,  1.54s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:26<01:52,  1.50s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:27<01:41,  1.37s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:28<01:29,  1.23s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:29<01:21,  1.13s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:30<01:14,  1.05s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:31<01:12,  1.04s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:32<01:11,  1.03s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:33<01:09,  1.02s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:34<01:06,  1.01it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:35<01:04,  1.02it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:35<01:02,  1.04it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:36<01:00,  1.07it/s] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:37<00:58,  1.07it/s] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:38<00:57,  1.09it/s] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:39<00:56,  1.09it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:40<00:56,  1.07it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:41<00:54,  1.09it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:42<00:52,  1.10it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:43<00:52,  1.08it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:44<00:52,  1.06it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:45<00:53,  1.04it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:46<00:53,  1.01it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:47<00:56,  1.06s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:49<01:09,  1.34s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:51<01:11,  1.39s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:52<01:16,  1.52s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:54<01:20,  1.65s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:56<01:23,  1.74s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:58<01:19,  1.70s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:00<01:19,  1.73s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:01<01:15,  1.69s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:03<01:13,  1.67s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:05<01:15,  1.75s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:06<01:10,  1.68s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:08<01:07,  1.64s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:10<01:07,  1.70s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:11<01:03,  1.63s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:13<01:01,  1.62s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:14<01:00,  1.63s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:16<01:02,  1.74s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:18<00:56,  1.61s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:19<00:51,  1.52s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:20<00:47,  1.45s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:22<00:46,  1.44s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:23<00:45,  1.46s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:24<00:40,  1.36s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:25<00:36,  1.25s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:27<00:34,  1.24s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:28<00:32,  1.20s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:29<00:29,  1.13s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:30<00:27,  1.10s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:31<00:26,  1.10s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:32<00:24,  1.07s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:33<00:23,  1.08s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:34<00:21,  1.01s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:35<00:19,  1.03it/s] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:36<00:18,  1.05it/s] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:37<00:17,  1.04it/s] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:38<00:16,  1.04it/s] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:39<00:15,  1.01it/s] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:40<00:14,  1.00it/s] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:41<00:13,  1.00it/s] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:42<00:13,  1.07s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:43<00:13,  1.09s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:44<00:11,  1.09s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:45<00:10,  1.06s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:46<00:09,  1.06s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:47<00:08,  1.02s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:48<00:06,  1.01it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:49<00:05,  1.02it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:50<00:05,  1.02s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:51<00:04,  1.01s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:52<00:03,  1.00s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:53<00:01,  1.01it/s] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:54<00:00,  1.04it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:55<00:00,  1.04it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:55<00:00,  1.15s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.27201
wandb: 
wandb: üöÄ View run fast-sweep-282 at: https://wandb.ai/xzy11632/dance-dev/runs/b7jmw4ir
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_021612-b7jmw4ir/logs
wandb: Agent Starting Run: ktrq66bb with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_022129-ktrq66bb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run major-sweep-283
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ktrq66bb
[INFO][2024-03-18 02:21:34,313][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 02:21:34,407][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 02:21:34,407][dance][wrapped_func] Took 0:00:00.093539 to load and process data.
[INFO][2024-03-18 02:21:34,407][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 02:21:34,410][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 02:21:34,429][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 02:21:34,676][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-18 02:22:26,503][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 217) (k=178)
[INFO][2024-03-18 02:22:26,504][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.07%
[INFO][2024-03-18 02:22:41,683][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 02:22:41,683][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 02:22:41,683][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 02:22:41,683][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:15,  1.37s/it]  2%|‚ñè         | 2/100 [00:02<02:16,  1.40s/it]  3%|‚ñé         | 3/100 [00:04<02:11,  1.35s/it]  4%|‚ñç         | 4/100 [00:05<02:05,  1.30s/it]  5%|‚ñå         | 5/100 [00:06<02:04,  1.31s/it]  6%|‚ñå         | 6/100 [00:08<02:05,  1.33s/it]  7%|‚ñã         | 7/100 [00:10<02:30,  1.61s/it]  8%|‚ñä         | 8/100 [00:13<03:13,  2.10s/it]  9%|‚ñâ         | 9/100 [00:16<03:27,  2.28s/it] 10%|‚ñà         | 10/100 [00:18<03:42,  2.47s/it] 11%|‚ñà         | 11/100 [00:21<03:53,  2.62s/it] 12%|‚ñà‚ñè        | 12/100 [00:23<03:15,  2.22s/it] 13%|‚ñà‚ñé        | 13/100 [00:24<02:48,  1.94s/it] 14%|‚ñà‚ñç        | 14/100 [00:25<02:27,  1.72s/it] 15%|‚ñà‚ñå        | 15/100 [00:27<02:16,  1.61s/it] 16%|‚ñà‚ñå        | 16/100 [00:28<02:11,  1.56s/it] 17%|‚ñà‚ñã        | 17/100 [00:29<02:02,  1.48s/it] 18%|‚ñà‚ñä        | 18/100 [00:31<01:56,  1.42s/it] 19%|‚ñà‚ñâ        | 19/100 [00:32<01:53,  1.40s/it] 20%|‚ñà‚ñà        | 20/100 [00:33<01:49,  1.37s/it] 21%|‚ñà‚ñà        | 21/100 [00:35<01:48,  1.37s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:36<01:48,  1.39s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:37<01:44,  1.36s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:39<01:41,  1.34s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:40<01:39,  1.32s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:41<01:41,  1.37s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:44<01:56,  1.60s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:46<02:21,  1.97s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:49<02:37,  2.22s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:51<02:28,  2.13s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:54<02:42,  2.35s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:56<02:30,  2.21s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:57<02:02,  1.82s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:58<01:42,  1.55s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:59<01:29,  1.38s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:00<01:20,  1.26s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:01<01:15,  1.19s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:02<01:09,  1.13s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:03<01:05,  1.07s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:03<01:01,  1.02s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:04<00:59,  1.01s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:05<00:58,  1.01s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:08<01:21,  1.43s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:10<01:36,  1.72s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:13<01:45,  1.92s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:14<01:34,  1.75s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:15<01:24,  1.59s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:16<01:15,  1.46s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:18<01:10,  1.38s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:19<01:03,  1.27s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:20<01:00,  1.23s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:21<00:57,  1.20s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:22<00:55,  1.19s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:23<00:53,  1.16s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:24<00:49,  1.10s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:25<00:47,  1.08s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:26<00:46,  1.08s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:27<00:47,  1.12s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:29<00:46,  1.13s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:30<00:46,  1.16s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:31<00:45,  1.17s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:32<00:44,  1.16s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:33<00:43,  1.17s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:34<00:41,  1.15s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:36<00:40,  1.17s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:37<00:39,  1.17s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:38<00:36,  1.12s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:39<00:34,  1.09s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:40<00:32,  1.06s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:41<00:32,  1.07s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:42<00:32,  1.11s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:43<00:32,  1.16s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:44<00:30,  1.13s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:46<00:29,  1.13s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:46<00:26,  1.07s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:47<00:24,  1.02s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:48<00:23,  1.01s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:49<00:22,  1.00s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:50<00:20,  1.03it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:51<00:18,  1.06it/s] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:52<00:17,  1.07it/s] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:53<00:16,  1.09it/s] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:54<00:16,  1.06it/s] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:55<00:15,  1.04it/s] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:56<00:14,  1.02it/s] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:57<00:13,  1.05it/s] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:58<00:12,  1.05it/s] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:59<00:11,  1.05it/s] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:00<00:11,  1.04s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:01<00:10,  1.04s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:02<00:09,  1.02s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:03<00:07,  1.03it/s] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:04<00:06,  1.05it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:05<00:05,  1.02it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:06<00:04,  1.01it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:07<00:04,  1.08s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:09<00:03,  1.32s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:11<00:02,  1.45s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:12<00:01,  1.47s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:14<00:00,  1.64s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:14<00:00,  1.35s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.1773
wandb: 
wandb: üöÄ View run major-sweep-283 at: https://wandb.ai/xzy11632/dance-dev/runs/ktrq66bb
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_022129-ktrq66bb/logs
wandb: Agent Starting Run: wf7on41d with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_022835-wf7on41d
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resilient-sweep-284
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/wf7on41d
[INFO][2024-03-18 02:28:39,969][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 02:28:40,041][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 02:28:40,042][dance][wrapped_func] Took 0:00:00.071879 to load and process data.
[INFO][2024-03-18 02:28:40,042][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 02:28:40,044][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 02:28:40,071][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 02:28:40,329][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-18 02:30:19,003][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 217) (k=179)
[INFO][2024-03-18 02:30:19,004][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.80%
[INFO][2024-03-18 02:30:36,076][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 02:30:36,078][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 02:30:36,078][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 02:30:36,078][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<03:10,  1.93s/it]  2%|‚ñè         | 2/100 [00:04<03:23,  2.07s/it]  3%|‚ñé         | 3/100 [00:05<02:59,  1.85s/it]  4%|‚ñç         | 4/100 [00:07<02:58,  1.86s/it]  5%|‚ñå         | 5/100 [00:09<02:55,  1.85s/it]  6%|‚ñå         | 6/100 [00:10<02:36,  1.66s/it]  7%|‚ñã         | 7/100 [00:12<02:24,  1.55s/it]  8%|‚ñä         | 8/100 [00:13<02:13,  1.45s/it]  9%|‚ñâ         | 9/100 [00:14<02:04,  1.37s/it] 10%|‚ñà         | 10/100 [00:15<02:03,  1.37s/it] 11%|‚ñà         | 11/100 [00:17<02:00,  1.35s/it] 12%|‚ñà‚ñè        | 12/100 [00:18<01:55,  1.31s/it] 13%|‚ñà‚ñé        | 13/100 [00:19<01:53,  1.31s/it] 14%|‚ñà‚ñç        | 14/100 [00:20<01:50,  1.28s/it] 15%|‚ñà‚ñå        | 15/100 [00:21<01:44,  1.23s/it] 16%|‚ñà‚ñå        | 16/100 [00:23<01:45,  1.25s/it] 17%|‚ñà‚ñã        | 17/100 [00:24<01:43,  1.25s/it] 18%|‚ñà‚ñä        | 18/100 [00:25<01:45,  1.29s/it] 19%|‚ñà‚ñâ        | 19/100 [00:27<01:47,  1.32s/it] 20%|‚ñà‚ñà        | 20/100 [00:28<01:43,  1.29s/it] 21%|‚ñà‚ñà        | 21/100 [00:29<01:41,  1.29s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:31<01:38,  1.26s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:32<01:39,  1.29s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:33<01:37,  1.28s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:34<01:35,  1.27s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:35<01:29,  1.21s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:37<01:31,  1.25s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:38<01:26,  1.21s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:39<01:23,  1.17s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:40<01:23,  1.19s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:41<01:21,  1.18s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:42<01:18,  1.16s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:44<01:14,  1.12s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:45<01:11,  1.09s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:46<01:11,  1.11s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:47<01:10,  1.11s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:48<01:08,  1.09s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:49<01:05,  1.06s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:50<01:04,  1.06s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:51<01:04,  1.07s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:52<01:03,  1.08s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:53<01:06,  1.15s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:55<01:07,  1.19s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:56<01:13,  1.30s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:57<01:09,  1.27s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:59<01:13,  1.36s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:00<01:11,  1.35s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:02<01:14,  1.44s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:03<01:06,  1.31s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:04<00:59,  1.18s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:05<00:54,  1.11s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:06<00:50,  1.06s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:07<00:47,  1.01s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:08<00:45,  1.00it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:09<00:43,  1.03it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:09<00:42,  1.03it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:10<00:42,  1.02it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:13<01:00,  1.44s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:16<01:13,  1.80s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:18<01:22,  2.07s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:20<01:16,  1.97s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:22<01:09,  1.82s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:24<01:13,  1.99s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:26<01:12,  2.00s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:28<01:07,  1.93s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:30<01:04,  1.90s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:31<01:01,  1.87s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:34<01:04,  2.00s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:37<01:15,  2.43s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:41<01:25,  2.86s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:45<01:33,  3.21s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:49<01:39,  3.55s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:53<01:38,  3.65s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:57<01:38,  3.79s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:01<01:35,  3.84s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:06<01:35,  3.96s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:09<01:29,  3.91s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:13<01:26,  3.94s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:17<01:19,  3.77s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:21<01:16,  3.84s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:25<01:15,  3.95s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:29<01:11,  4.00s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:33<01:07,  3.94s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:37<01:02,  3.93s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:41<00:58,  3.91s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:45<00:54,  3.91s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:48<00:49,  3.84s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:52<00:45,  3.78s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:56<00:41,  3.81s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:59<00:37,  3.75s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [03:03<00:33,  3.75s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [03:07<00:30,  3.83s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [03:11<00:26,  3.73s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [03:14<00:22,  3.70s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [03:17<00:17,  3.52s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [03:21<00:13,  3.50s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [03:24<00:10,  3.49s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [03:28<00:07,  3.52s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [03:31<00:03,  3.39s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:34<00:00,  3.21s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:34<00:00,  2.14s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.20108
wandb: 
wandb: üöÄ View run resilient-sweep-284 at: https://wandb.ai/xzy11632/dance-dev/runs/wf7on41d
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_022835-wf7on41d/logs
wandb: Agent Starting Run: q89up54u with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_023810-q89up54u
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rich-sweep-285
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/q89up54u
[INFO][2024-03-18 02:38:17,370][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 02:38:17,466][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 02:38:17,466][dance][wrapped_func] Took 0:00:00.095141 to load and process data.
[INFO][2024-03-18 02:38:17,466][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 02:38:17,468][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 02:38:17,485][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 02:38:17,734][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-18 02:39:33,665][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=136)
[INFO][2024-03-18 02:39:33,665][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.08%
[INFO][2024-03-18 02:45:54,690][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 02:45:54,691][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 02:45:54,691][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 02:45:54,691][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:02<04:25,  2.68s/it]  2%|‚ñè         | 2/100 [00:05<04:26,  2.72s/it]  3%|‚ñé         | 3/100 [00:08<04:27,  2.76s/it]  4%|‚ñç         | 4/100 [00:11<04:28,  2.79s/it]  5%|‚ñå         | 5/100 [00:13<04:12,  2.66s/it]  6%|‚ñå         | 6/100 [00:16<04:20,  2.77s/it]  7%|‚ñã         | 7/100 [00:18<04:07,  2.66s/it]  8%|‚ñä         | 8/100 [00:21<04:01,  2.62s/it]  9%|‚ñâ         | 9/100 [00:24<03:57,  2.61s/it] 10%|‚ñà         | 10/100 [00:26<03:58,  2.65s/it] 11%|‚ñà         | 11/100 [00:29<03:52,  2.62s/it] 12%|‚ñà‚ñè        | 12/100 [00:32<03:57,  2.70s/it] 13%|‚ñà‚ñé        | 13/100 [00:34<03:56,  2.72s/it] 14%|‚ñà‚ñç        | 14/100 [00:37<03:58,  2.77s/it] 15%|‚ñà‚ñå        | 15/100 [00:40<03:53,  2.75s/it] 16%|‚ñà‚ñå        | 16/100 [00:43<03:43,  2.66s/it] 17%|‚ñà‚ñã        | 17/100 [00:45<03:41,  2.67s/it] 18%|‚ñà‚ñä        | 18/100 [00:48<03:36,  2.64s/it] 19%|‚ñà‚ñâ        | 19/100 [00:50<03:32,  2.62s/it] 20%|‚ñà‚ñà        | 20/100 [00:53<03:25,  2.57s/it] 21%|‚ñà‚ñà        | 21/100 [00:56<03:31,  2.67s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:58<03:30,  2.70s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [01:01<03:21,  2.61s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [01:04<03:23,  2.68s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [01:06<03:21,  2.69s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [01:09<03:18,  2.69s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [01:12<03:15,  2.68s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [01:14<03:08,  2.62s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [01:17<03:04,  2.60s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [01:20<03:05,  2.65s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [01:22<03:05,  2.69s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:25<03:02,  2.69s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:28<03:00,  2.70s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:31<02:59,  2.71s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:33<02:58,  2.75s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:36<02:56,  2.75s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:39<02:53,  2.76s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:42<02:50,  2.75s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:44<02:47,  2.74s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:47<02:47,  2.80s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:50<02:41,  2.73s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:53<02:39,  2.75s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:55<02:29,  2.63s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:58<02:34,  2.76s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [02:01<02:34,  2.80s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [02:04<02:32,  2.82s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [02:07<02:30,  2.85s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [02:10<02:30,  2.89s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [02:13<02:25,  2.86s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [02:15<02:19,  2.78s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [02:18<02:17,  2.80s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [02:21<02:12,  2.77s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [02:24<02:12,  2.81s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [02:27<02:14,  2.91s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [02:29<02:08,  2.85s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [02:32<02:08,  2.91s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [02:35<02:02,  2.84s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [02:38<01:57,  2.81s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [02:41<01:54,  2.80s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [02:44<01:54,  2.87s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [02:47<01:55,  2.95s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [02:50<01:53,  2.98s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [02:53<01:52,  3.04s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [02:56<01:48,  3.02s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [03:00<01:51,  3.17s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [03:03<01:49,  3.22s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [03:06<01:40,  3.04s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [03:08<01:33,  2.93s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [03:11<01:33,  3.01s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [03:15<01:31,  3.05s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [03:17<01:25,  2.94s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [03:20<01:19,  2.84s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [03:23<01:16,  2.84s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [03:26<01:15,  2.92s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [03:29<01:12,  2.91s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [03:32<01:10,  2.93s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [03:35<01:08,  2.96s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [03:38<01:07,  3.08s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [03:41<01:04,  3.07s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [03:44<01:03,  3.15s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [03:47<00:56,  2.98s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [03:50<00:52,  2.91s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [03:52<00:47,  2.81s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [03:55<00:43,  2.71s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [03:57<00:40,  2.70s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [04:00<00:38,  2.73s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [04:03<00:34,  2.67s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [04:05<00:31,  2.65s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [04:08<00:29,  2.65s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [04:11<00:26,  2.62s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [04:14<00:24,  2.70s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [04:16<00:21,  2.67s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [04:19<00:18,  2.67s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [04:22<00:16,  2.76s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [04:24<00:13,  2.74s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [04:27<00:10,  2.67s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [04:30<00:08,  2.91s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [04:34<00:06,  3.10s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [04:37<00:03,  3.20s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [04:41<00:00,  3.25s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [04:41<00:00,  2.81s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.27721
wandb: 
wandb: üöÄ View run rich-sweep-285 at: https://wandb.ai/xzy11632/dance-dev/runs/q89up54u
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_023810-q89up54u/logs
wandb: Agent Starting Run: f55zo1j7 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_025329-f55zo1j7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run confused-sweep-286
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/f55zo1j7
[INFO][2024-03-18 02:53:35,258][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 02:53:35,353][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 02:53:35,353][dance][wrapped_func] Took 0:00:00.094511 to load and process data.
[INFO][2024-03-18 02:53:35,353][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 02:53:35,358][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 02:53:35,378][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 02:53:35,629][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-18 02:54:33,892][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=138)
[INFO][2024-03-18 02:54:33,894][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.04%
[INFO][2024-03-18 02:54:36,682][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 02:54:36,682][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 02:54:36,682][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 02:54:36,682][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:56,  1.18s/it]  2%|‚ñè         | 2/100 [00:02<02:18,  1.41s/it]  3%|‚ñé         | 3/100 [00:04<02:10,  1.35s/it]  4%|‚ñç         | 4/100 [00:05<02:05,  1.31s/it]  5%|‚ñå         | 5/100 [00:06<01:58,  1.25s/it]  6%|‚ñå         | 6/100 [00:07<01:56,  1.24s/it]  7%|‚ñã         | 7/100 [00:08<01:55,  1.24s/it]  8%|‚ñä         | 8/100 [00:10<01:55,  1.25s/it]  9%|‚ñâ         | 9/100 [00:11<01:58,  1.30s/it] 10%|‚ñà         | 10/100 [00:12<01:56,  1.29s/it] 11%|‚ñà         | 11/100 [00:14<01:54,  1.29s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<01:53,  1.29s/it] 13%|‚ñà‚ñé        | 13/100 [00:16<01:53,  1.31s/it] 14%|‚ñà‚ñç        | 14/100 [00:17<01:49,  1.27s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<01:47,  1.26s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<01:42,  1.22s/it] 17%|‚ñà‚ñã        | 17/100 [00:22<02:07,  1.54s/it] 18%|‚ñà‚ñä        | 18/100 [00:25<02:38,  1.93s/it] 19%|‚ñà‚ñâ        | 19/100 [00:28<02:59,  2.22s/it] 20%|‚ñà‚ñà        | 20/100 [00:31<03:19,  2.49s/it] 21%|‚ñà‚ñà        | 21/100 [00:34<03:21,  2.55s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:36<03:09,  2.43s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:38<03:11,  2.49s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:40<02:50,  2.24s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:42<02:36,  2.09s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:44<02:46,  2.26s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:47<02:55,  2.41s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:50<03:00,  2.50s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:53<03:05,  2.61s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:56<03:06,  2.66s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:58<02:53,  2.51s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:00<02:44,  2.42s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:03<02:45,  2.48s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:05<02:49,  2.57s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:08<02:44,  2.53s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:10<02:42,  2.53s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:13<02:39,  2.53s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:15<02:36,  2.53s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:18<02:35,  2.54s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:20<02:29,  2.49s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:23<02:24,  2.45s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:25<02:22,  2.45s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:28<02:20,  2.47s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:30<02:17,  2.46s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:32<02:13,  2.43s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:35<02:11,  2.44s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:37<02:08,  2.43s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:39<02:03,  2.37s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:42<01:59,  2.35s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:44<01:59,  2.38s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:46<01:53,  2.32s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:49<01:50,  2.29s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:51<01:44,  2.22s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:53<01:36,  2.09s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:54<01:24,  1.88s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:55<01:18,  1.79s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:57<01:13,  1.70s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:58<01:08,  1.64s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [02:00<01:04,  1.58s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [02:02<01:04,  1.60s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [02:03<01:02,  1.61s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [02:05<01:01,  1.62s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [02:06<00:59,  1.61s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [02:08<00:55,  1.54s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [02:09<00:54,  1.55s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [02:11<00:52,  1.55s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [02:12<00:50,  1.52s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [02:14<00:49,  1.55s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:15<00:47,  1.52s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:17<00:44,  1.48s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:18<00:43,  1.51s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:20<00:42,  1.51s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:22<00:41,  1.53s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:23<00:39,  1.50s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:25<00:38,  1.53s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:26<00:35,  1.47s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:28<00:35,  1.54s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:29<00:32,  1.48s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:31<00:31,  1.52s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:32<00:28,  1.44s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:33<00:28,  1.50s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:35<00:27,  1.50s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:37<00:26,  1.55s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:38<00:25,  1.58s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:40<00:23,  1.55s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:41<00:22,  1.59s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:43<00:19,  1.53s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:44<00:18,  1.57s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:46<00:16,  1.53s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:47<00:15,  1.53s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:49<00:13,  1.50s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:51<00:12,  1.56s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:52<00:10,  1.51s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:54<00:09,  1.55s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:55<00:07,  1.45s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:56<00:05,  1.41s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:57<00:04,  1.36s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:59<00:02,  1.38s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [03:00<00:01,  1.33s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:01<00:00,  1.36s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:01<00:00,  1.82s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.26874
wandb: 
wandb: üöÄ View run confused-sweep-286 at: https://wandb.ai/xzy11632/dance-dev/runs/f55zo1j7
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_025329-f55zo1j7/logs
wandb: Agent Starting Run: 9xvvsn7m with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_025939-9xvvsn7m
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run stilted-sweep-287
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/9xvvsn7m
[INFO][2024-03-18 02:59:48,665][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 02:59:48,802][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 02:59:48,802][dance][wrapped_func] Took 0:00:00.137218 to load and process data.
[INFO][2024-03-18 02:59:48,803][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 02:59:48,806][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 02:59:48,850][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 02:59:49,244][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-18 03:01:19,245][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=122)
[INFO][2024-03-18 03:01:19,246][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.02%
[INFO][2024-03-18 03:11:30,512][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 03:11:30,513][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 03:11:30,514][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 03:11:30,514][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:02<03:50,  2.33s/it]  2%|‚ñè         | 2/100 [00:04<03:50,  2.35s/it]  3%|‚ñé         | 3/100 [00:07<03:48,  2.36s/it]  4%|‚ñç         | 4/100 [00:09<03:33,  2.22s/it]  5%|‚ñå         | 5/100 [00:11<03:29,  2.20s/it]  6%|‚ñå         | 6/100 [00:13<03:21,  2.14s/it]  7%|‚ñã         | 7/100 [00:14<03:06,  2.01s/it]  8%|‚ñä         | 8/100 [00:16<02:50,  1.85s/it]  9%|‚ñâ         | 9/100 [00:17<02:33,  1.68s/it] 10%|‚ñà         | 10/100 [00:19<02:17,  1.53s/it] 11%|‚ñà         | 11/100 [00:20<02:10,  1.47s/it] 12%|‚ñà‚ñè        | 12/100 [00:21<02:02,  1.39s/it] 13%|‚ñà‚ñé        | 13/100 [00:22<02:00,  1.39s/it] 14%|‚ñà‚ñç        | 14/100 [00:24<01:55,  1.34s/it] 15%|‚ñà‚ñå        | 15/100 [00:25<01:50,  1.30s/it] 16%|‚ñà‚ñå        | 16/100 [00:26<01:46,  1.27s/it] 17%|‚ñà‚ñã        | 17/100 [00:27<01:47,  1.30s/it] 18%|‚ñà‚ñä        | 18/100 [00:29<01:47,  1.31s/it] 19%|‚ñà‚ñâ        | 19/100 [00:30<01:48,  1.34s/it] 20%|‚ñà‚ñà        | 20/100 [00:31<01:45,  1.32s/it] 21%|‚ñà‚ñà        | 21/100 [00:33<01:44,  1.32s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:34<01:40,  1.29s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:35<01:40,  1.30s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:37<01:38,  1.29s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:38<01:38,  1.32s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:39<01:37,  1.32s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:41<01:52,  1.55s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:44<02:04,  1.73s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:46<02:09,  1.82s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:47<02:04,  1.78s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:49<01:55,  1.68s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:50<01:50,  1.63s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:52<01:45,  1.57s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:53<01:45,  1.60s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:55<01:40,  1.55s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:56<01:40,  1.57s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:58<01:35,  1.51s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:59<01:32,  1.50s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:01<01:28,  1.46s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:02<01:30,  1.50s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:04<01:31,  1.55s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:05<01:29,  1.54s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:07<01:24,  1.48s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:08<01:22,  1.48s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:10<01:22,  1.49s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:11<01:22,  1.53s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:13<01:20,  1.51s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:14<01:18,  1.50s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:16<01:13,  1.45s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:17<01:14,  1.49s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:19<01:14,  1.51s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:21<01:17,  1.61s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:22<01:15,  1.61s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:24<01:12,  1.58s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:25<01:10,  1.57s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:27<01:08,  1.57s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:28<01:07,  1.57s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:30<01:03,  1.52s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:31<01:01,  1.51s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:33<00:59,  1.49s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:34<00:59,  1.52s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:36<00:59,  1.57s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:37<00:56,  1.52s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:39<00:52,  1.45s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:40<00:49,  1.42s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:41<00:45,  1.34s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:42<00:44,  1.34s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:44<00:42,  1.33s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:45<00:40,  1.31s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:46<00:38,  1.30s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:48<00:37,  1.29s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:49<00:36,  1.29s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:50<00:35,  1.31s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:52<00:35,  1.37s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:53<00:33,  1.35s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:54<00:31,  1.32s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:56<00:30,  1.33s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:57<00:29,  1.35s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:58<00:28,  1.38s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:01<00:35,  1.78s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:04<00:39,  2.08s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:06<00:39,  2.19s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:10<00:41,  2.45s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:11<00:36,  2.27s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:13<00:32,  2.18s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:15<00:29,  2.08s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:17<00:25,  1.94s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:18<00:21,  1.79s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:20<00:19,  1.73s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:21<00:16,  1.60s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:23<00:14,  1.63s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:25<00:13,  1.65s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:26<00:11,  1.61s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:28<00:09,  1.59s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:29<00:07,  1.54s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:30<00:06,  1.52s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:32<00:04,  1.49s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:34<00:03,  1.54s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:35<00:01,  1.44s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:36<00:00,  1.39s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:36<00:00,  1.57s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.31891
wandb: 
wandb: üöÄ View run stilted-sweep-287 at: https://wandb.ai/xzy11632/dance-dev/runs/9xvvsn7m
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_025939-9xvvsn7m/logs
wandb: Agent Starting Run: drlwx82e with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_031626-drlwx82e
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run comfy-sweep-288
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/drlwx82e
[INFO][2024-03-18 03:16:32,217][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 03:16:32,308][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 03:16:32,308][dance][wrapped_func] Took 0:00:00.090222 to load and process data.
[INFO][2024-03-18 03:16:32,308][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 03:16:32,310][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 03:16:32,330][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 03:16:32,577][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-18 03:17:28,269][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=122)
[INFO][2024-03-18 03:17:28,276][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.67%
[INFO][2024-03-18 03:17:30,062][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 03:17:30,063][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 03:17:30,063][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 03:17:30,063][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:50,  1.11s/it]  2%|‚ñè         | 2/100 [00:02<01:40,  1.03s/it]  3%|‚ñé         | 3/100 [00:03<01:38,  1.02s/it]  4%|‚ñç         | 4/100 [00:04<01:35,  1.00it/s]  5%|‚ñå         | 5/100 [00:04<01:32,  1.02it/s]  6%|‚ñå         | 6/100 [00:05<01:29,  1.05it/s]  7%|‚ñã         | 7/100 [00:06<01:30,  1.02it/s]  8%|‚ñä         | 8/100 [00:07<01:28,  1.04it/s]  9%|‚ñâ         | 9/100 [00:08<01:25,  1.06it/s] 10%|‚ñà         | 10/100 [00:09<01:24,  1.07it/s] 11%|‚ñà         | 11/100 [00:10<01:23,  1.07it/s] 12%|‚ñà‚ñè        | 12/100 [00:11<01:28,  1.00s/it] 13%|‚ñà‚ñé        | 13/100 [00:14<02:01,  1.39s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<02:28,  1.72s/it] 15%|‚ñà‚ñå        | 15/100 [00:21<03:51,  2.72s/it] 16%|‚ñà‚ñå        | 16/100 [00:26<04:54,  3.50s/it] 17%|‚ñà‚ñã        | 17/100 [00:32<05:44,  4.15s/it] 18%|‚ñà‚ñä        | 18/100 [00:37<06:01,  4.40s/it] 19%|‚ñà‚ñâ        | 19/100 [00:42<06:02,  4.48s/it] 20%|‚ñà‚ñà        | 20/100 [00:47<06:12,  4.65s/it] 21%|‚ñà‚ñà        | 21/100 [00:51<05:58,  4.53s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:56<06:01,  4.63s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [01:01<06:09,  4.80s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [01:05<05:56,  4.68s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [01:10<05:55,  4.74s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [01:15<05:57,  4.83s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [01:20<05:38,  4.63s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [01:24<05:28,  4.56s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [01:28<05:08,  4.34s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [01:32<04:56,  4.23s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [01:36<04:44,  4.12s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:39<04:26,  3.92s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:42<04:09,  3.72s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:45<03:52,  3.53s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:48<03:37,  3.35s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:51<03:26,  3.23s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:55<03:30,  3.34s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:59<03:45,  3.64s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [02:03<03:46,  3.71s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [02:07<03:43,  3.72s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [02:10<03:24,  3.46s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [02:12<03:07,  3.24s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [02:15<02:48,  2.95s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [02:18<02:48,  3.01s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [02:21<02:41,  2.93s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [02:23<02:34,  2.85s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [02:26<02:27,  2.79s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [02:29<02:37,  3.02s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [02:32<02:30,  2.95s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [02:35<02:23,  2.87s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [02:38<02:30,  3.07s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [02:42<02:28,  3.10s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [02:45<02:26,  3.13s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [02:48<02:24,  3.15s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [02:51<02:14,  3.00s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [02:53<02:08,  2.92s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [02:56<02:07,  2.96s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [02:59<02:03,  2.95s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [03:02<02:02,  2.99s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [03:05<01:59,  2.99s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [03:08<01:54,  2.93s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [03:11<01:51,  2.93s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [03:14<01:46,  2.88s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [03:17<01:40,  2.80s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [03:19<01:37,  2.79s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [03:22<01:33,  2.74s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [03:26<01:39,  3.00s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [03:29<01:41,  3.16s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [03:33<01:48,  3.51s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [03:37<01:46,  3.56s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [03:41<01:42,  3.53s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [03:44<01:39,  3.56s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [03:48<01:34,  3.52s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [03:51<01:28,  3.42s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [03:54<01:26,  3.46s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [03:58<01:25,  3.56s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [04:01<01:19,  3.45s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [04:05<01:15,  3.41s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [04:08<01:13,  3.52s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [04:12<01:12,  3.61s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [04:17<01:15,  3.99s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [04:21<01:10,  3.91s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [04:25<01:08,  4.02s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [04:30<01:09,  4.36s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [04:36<01:12,  4.83s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [04:41<01:08,  4.90s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [04:46<01:01,  4.75s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [04:50<00:54,  4.54s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [04:54<00:48,  4.43s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [04:57<00:41,  4.19s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [05:02<00:37,  4.14s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [05:05<00:31,  3.97s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [05:09<00:27,  3.87s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [05:12<00:22,  3.71s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [05:16<00:18,  3.63s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [05:19<00:14,  3.60s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [05:23<00:11,  3.75s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [05:26<00:07,  3.62s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [05:30<00:03,  3.73s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [05:34<00:00,  3.71s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [05:34<00:00,  3.35s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.26733
wandb: 
wandb: üöÄ View run comfy-sweep-288 at: https://wandb.ai/xzy11632/dance-dev/runs/drlwx82e
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_031626-drlwx82e/logs
wandb: Agent Starting Run: ri8u1zxn with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_032554-ri8u1zxn
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run balmy-sweep-289
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ri8u1zxn
[INFO][2024-03-18 03:26:01,681][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 03:26:01,774][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 03:26:01,774][dance][wrapped_func] Took 0:00:00.092859 to load and process data.
[INFO][2024-03-18 03:26:01,774][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 03:26:01,777][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 03:26:01,795][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 03:26:01,795][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 03:26:02,012][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 03:26:02,048][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 03:26:17,243][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 919) (k=450)
[INFO][2024-03-18 03:26:17,248][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.01%
[INFO][2024-03-18 03:32:14,350][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 03:32:14,398][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 03:32:14,399][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 03:32:14,399][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:03<05:44,  3.48s/it]  2%|‚ñè         | 2/100 [00:06<05:40,  3.48s/it]  3%|‚ñé         | 3/100 [00:10<05:44,  3.55s/it]  4%|‚ñç         | 4/100 [00:14<05:50,  3.65s/it]  5%|‚ñå         | 5/100 [00:17<05:45,  3.63s/it]  6%|‚ñå         | 6/100 [00:21<05:41,  3.63s/it]  7%|‚ñã         | 7/100 [00:25<05:35,  3.61s/it]  8%|‚ñä         | 8/100 [00:28<05:25,  3.54s/it]  9%|‚ñâ         | 9/100 [00:32<05:21,  3.53s/it] 10%|‚ñà         | 10/100 [00:35<05:17,  3.53s/it] 11%|‚ñà         | 11/100 [00:38<05:08,  3.46s/it] 12%|‚ñà‚ñè        | 12/100 [00:42<05:04,  3.46s/it] 13%|‚ñà‚ñé        | 13/100 [00:45<04:59,  3.44s/it] 14%|‚ñà‚ñç        | 14/100 [00:49<04:55,  3.44s/it] 15%|‚ñà‚ñå        | 15/100 [00:52<04:52,  3.44s/it] 16%|‚ñà‚ñå        | 16/100 [00:56<04:47,  3.43s/it] 17%|‚ñà‚ñã        | 17/100 [00:59<04:40,  3.38s/it] 18%|‚ñà‚ñä        | 18/100 [01:02<04:36,  3.37s/it] 19%|‚ñà‚ñâ        | 19/100 [01:06<04:33,  3.38s/it] 20%|‚ñà‚ñà        | 20/100 [01:09<04:34,  3.43s/it] 21%|‚ñà‚ñà        | 21/100 [01:12<04:29,  3.41s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [01:16<04:32,  3.50s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [01:20<04:33,  3.56s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [01:23<04:23,  3.47s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [01:26<04:17,  3.43s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [01:30<04:12,  3.41s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [01:33<04:04,  3.35s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [01:37<04:08,  3.46s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [01:41<04:13,  3.57s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [01:44<04:03,  3.48s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [01:46<03:33,  3.09s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:48<03:08,  2.77s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:50<02:48,  2.52s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:52<02:33,  2.32s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:54<02:23,  2.21s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:56<02:18,  2.17s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:58<02:13,  2.12s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [02:00<02:06,  2.04s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [02:02<02:03,  2.02s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [02:04<02:03,  2.05s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [02:06<01:58,  2.01s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [02:08<01:59,  2.05s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [02:10<01:58,  2.07s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [02:12<01:50,  1.97s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [02:14<01:52,  2.05s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [02:16<01:51,  2.06s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [02:18<01:43,  1.96s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [02:20<01:41,  1.96s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [02:22<01:41,  1.99s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [02:24<01:36,  1.93s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [02:26<01:36,  1.97s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [02:28<01:35,  2.00s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [02:30<01:31,  1.95s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [02:32<01:31,  1.99s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [02:33<01:25,  1.91s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [02:35<01:26,  1.96s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [02:37<01:19,  1.85s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [02:39<01:15,  1.81s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [02:41<01:13,  1.79s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [02:42<01:10,  1.76s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [02:44<01:03,  1.64s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [02:45<01:02,  1.64s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [02:47<00:58,  1.59s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [02:48<00:56,  1.58s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [02:49<00:51,  1.48s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [02:51<00:48,  1.42s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [02:52<00:44,  1.34s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [02:53<00:42,  1.32s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:54<00:39,  1.28s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:56<00:39,  1.31s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:57<00:39,  1.35s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:58<00:36,  1.30s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [03:00<00:35,  1.31s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [03:01<00:33,  1.29s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [03:02<00:33,  1.32s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [03:04<00:31,  1.30s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [03:05<00:29,  1.28s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [03:06<00:27,  1.27s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [03:07<00:27,  1.30s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [03:09<00:26,  1.34s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [03:11<00:27,  1.46s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [03:12<00:27,  1.52s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [03:14<00:26,  1.53s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [03:16<00:25,  1.59s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [03:17<00:22,  1.53s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [03:18<00:20,  1.48s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [03:20<00:18,  1.41s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [03:21<00:16,  1.38s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [03:22<00:15,  1.39s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [03:24<00:14,  1.45s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [03:27<00:18,  2.07s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [03:31<00:19,  2.45s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [03:34<00:19,  2.78s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [03:42<00:25,  4.21s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [03:50<00:27,  5.40s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [03:58<00:24,  6.22s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [04:05<00:19,  6.55s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [04:13<00:13,  6.78s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [04:21<00:07,  7.11s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [04:26<00:00,  6.49s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [04:26<00:00,  2.66s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.015 MB of 0.025 MB uploadedwandb: | 0.015 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.12444
wandb: 
wandb: üöÄ View run balmy-sweep-289 at: https://wandb.ai/xzy11632/dance-dev/runs/ri8u1zxn
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_032554-ri8u1zxn/logs
wandb: Agent Starting Run: 4clwem8a with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_033932-4clwem8a
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run graceful-sweep-290
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/4clwem8a
[INFO][2024-03-18 03:39:37,337][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 03:39:37,432][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 03:39:37,433][dance][wrapped_func] Took 0:00:00.095504 to load and process data.
[INFO][2024-03-18 03:39:37,433][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 03:39:37,435][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 03:39:37,454][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 03:39:37,454][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 03:39:37,614][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 03:39:37,640][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 03:39:50,681][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 919) (k=434)
[INFO][2024-03-18 03:39:50,694][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.09%
[INFO][2024-03-18 03:39:57,153][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 03:39:57,154][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 03:39:57,154][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 03:39:57,154][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<03:13,  1.96s/it]  2%|‚ñè         | 2/100 [00:03<03:09,  1.94s/it]  3%|‚ñé         | 3/100 [00:05<03:06,  1.92s/it]  4%|‚ñç         | 4/100 [00:07<02:48,  1.75s/it]  5%|‚ñå         | 5/100 [00:08<02:34,  1.63s/it]  6%|‚ñå         | 6/100 [00:10<02:26,  1.56s/it]  7%|‚ñã         | 7/100 [00:11<02:15,  1.46s/it]  8%|‚ñä         | 8/100 [00:12<02:08,  1.39s/it]  9%|‚ñâ         | 9/100 [00:14<02:06,  1.40s/it] 10%|‚ñà         | 10/100 [00:15<02:00,  1.34s/it] 11%|‚ñà         | 11/100 [00:16<01:56,  1.31s/it] 12%|‚ñà‚ñè        | 12/100 [00:17<01:52,  1.28s/it] 13%|‚ñà‚ñé        | 13/100 [00:19<01:52,  1.29s/it] 14%|‚ñà‚ñç        | 14/100 [00:20<01:50,  1.28s/it] 15%|‚ñà‚ñå        | 15/100 [00:21<01:50,  1.31s/it] 16%|‚ñà‚ñå        | 16/100 [00:22<01:48,  1.30s/it] 17%|‚ñà‚ñã        | 17/100 [00:24<01:46,  1.29s/it] 18%|‚ñà‚ñä        | 18/100 [00:25<01:45,  1.29s/it] 19%|‚ñà‚ñâ        | 19/100 [00:26<01:43,  1.28s/it] 20%|‚ñà‚ñà        | 20/100 [00:28<01:45,  1.32s/it] 21%|‚ñà‚ñà        | 21/100 [00:29<01:45,  1.33s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:31<01:52,  1.44s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:32<01:58,  1.54s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:34<01:56,  1.53s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:35<01:50,  1.47s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:37<01:45,  1.42s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:38<01:40,  1.37s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:39<01:35,  1.33s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:40<01:34,  1.33s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:42<01:32,  1.32s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:44<01:43,  1.50s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:46<02:06,  1.87s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:48<02:06,  1.88s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:50<02:00,  1.82s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:52<01:53,  1.75s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:53<01:49,  1.71s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:55<01:44,  1.66s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:56<01:41,  1.64s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:58<01:38,  1.62s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:59<01:34,  1.58s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:01<01:33,  1.58s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:03<01:33,  1.61s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:04<01:33,  1.65s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:06<01:29,  1.59s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:07<01:26,  1.57s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:09<01:25,  1.59s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:11<01:24,  1.60s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:12<01:22,  1.58s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:14<01:18,  1.53s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:15<01:13,  1.47s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:16<01:10,  1.44s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:17<01:06,  1.39s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:19<01:03,  1.35s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:20<01:00,  1.32s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:21<00:58,  1.30s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:23<00:56,  1.29s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:24<00:52,  1.22s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:25<00:49,  1.18s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:26<00:47,  1.16s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:27<00:44,  1.12s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:28<00:42,  1.09s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:29<00:43,  1.14s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:30<00:44,  1.20s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:31<00:41,  1.16s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:32<00:38,  1.11s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:34<00:41,  1.21s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:35<00:38,  1.17s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:36<00:38,  1.21s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:38<00:40,  1.32s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:39<00:38,  1.29s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:40<00:37,  1.28s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:42<00:35,  1.25s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:43<00:31,  1.18s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:44<00:29,  1.14s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:45<00:29,  1.20s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:46<00:29,  1.24s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:48<00:29,  1.28s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:49<00:28,  1.29s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:51<00:28,  1.38s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:53<00:34,  1.74s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:55<00:34,  1.82s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:56<00:29,  1.64s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:58<00:26,  1.57s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:00<00:26,  1.66s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:03<00:34,  2.28s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:11<00:54,  3.89s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:19<01:07,  5.16s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:26<01:08,  5.69s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:34<01:09,  6.29s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:41<01:06,  6.62s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:48<01:00,  6.78s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:58<01:00,  7.55s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [03:06<00:54,  7.85s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [03:12<00:42,  7.12s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [03:17<00:33,  6.68s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [03:22<00:24,  6.23s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [03:28<00:18,  6.02s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [03:33<00:11,  5.70s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [03:38<00:05,  5.61s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:44<00:00,  5.54s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:44<00:00,  2.24s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.15515
wandb: 
wandb: üöÄ View run graceful-sweep-290 at: https://wandb.ai/xzy11632/dance-dev/runs/4clwem8a
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_033932-4clwem8a/logs
wandb: Agent Starting Run: eg0ierci with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_034534-eg0ierci
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dry-sweep-291
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/eg0ierci
[INFO][2024-03-18 03:45:40,489][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 03:45:40,565][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 03:45:40,565][dance][wrapped_func] Took 0:00:00.075479 to load and process data.
[INFO][2024-03-18 03:45:40,566][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 03:45:40,568][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 03:45:40,587][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 03:45:40,951][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-18 03:45:41,105][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run dry-sweep-291 at: https://wandb.ai/xzy11632/dance-dev/runs/eg0ierci
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_034534-eg0ierci/logs
wandb: ERROR Run eg0ierci errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1081) out of bounds (919)
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: m7m5xicq with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_034601-m7m5xicq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dazzling-sweep-292
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/m7m5xicq
[INFO][2024-03-18 03:46:07,962][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 03:46:08,051][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 03:46:08,052][dance][wrapped_func] Took 0:00:00.088481 to load and process data.
[INFO][2024-03-18 03:46:08,052][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 03:46:08,054][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 03:46:08,084][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 03:46:08,364][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-18 03:46:08,518][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run dazzling-sweep-292 at: https://wandb.ai/xzy11632/dance-dev/runs/m7m5xicq
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_034601-m7m5xicq/logs
wandb: ERROR Run m7m5xicq errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1081) out of bounds (919)
wandb: ERROR 
wandb: Agent Starting Run: mbp2pr1v with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_034622-mbp2pr1v
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ethereal-sweep-293
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/mbp2pr1v
[INFO][2024-03-18 03:46:27,334][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 03:46:27,414][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 03:46:27,415][dance][wrapped_func] Took 0:00:00.079718 to load and process data.
[INFO][2024-03-18 03:46:27,415][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 03:46:27,417][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 03:46:27,433][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 03:46:27,569][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 03:46:27,908][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=90)
[INFO][2024-03-18 03:46:27,909][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.08%
[INFO][2024-03-18 03:46:29,656][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 03:46:29,657][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 03:46:29,657][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 03:46:29,657][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:30,  1.09it/s]  2%|‚ñè         | 2/100 [00:01<01:31,  1.07it/s]  3%|‚ñé         | 3/100 [00:02<01:29,  1.09it/s]  4%|‚ñç         | 4/100 [00:03<01:35,  1.00it/s]  5%|‚ñå         | 5/100 [00:04<01:34,  1.00it/s]  6%|‚ñå         | 6/100 [00:05<01:36,  1.03s/it]  7%|‚ñã         | 7/100 [00:07<01:39,  1.07s/it]  8%|‚ñä         | 8/100 [00:08<01:38,  1.07s/it]  9%|‚ñâ         | 9/100 [00:09<01:40,  1.11s/it] 10%|‚ñà         | 10/100 [00:10<01:38,  1.09s/it] 11%|‚ñà         | 11/100 [00:11<01:43,  1.17s/it] 12%|‚ñà‚ñè        | 12/100 [00:12<01:40,  1.14s/it] 13%|‚ñà‚ñé        | 13/100 [00:14<01:41,  1.17s/it] 14%|‚ñà‚ñç        | 14/100 [00:15<01:35,  1.11s/it] 15%|‚ñà‚ñå        | 15/100 [00:15<01:28,  1.04s/it] 16%|‚ñà‚ñå        | 16/100 [00:16<01:24,  1.01s/it] 17%|‚ñà‚ñã        | 17/100 [00:18<01:28,  1.06s/it] 18%|‚ñà‚ñä        | 18/100 [00:19<01:26,  1.06s/it] 19%|‚ñà‚ñâ        | 19/100 [00:20<01:24,  1.05s/it] 20%|‚ñà‚ñà        | 20/100 [00:21<01:21,  1.02s/it] 21%|‚ñà‚ñà        | 21/100 [00:22<01:19,  1.00s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:23<01:20,  1.03s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:24<01:27,  1.14s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:26<01:35,  1.25s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:27<01:36,  1.28s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:28<01:39,  1.35s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:30<01:38,  1.34s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:31<01:30,  1.26s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:32<01:24,  1.19s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:33<01:23,  1.20s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:34<01:23,  1.20s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:35<01:20,  1.18s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:36<01:16,  1.14s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:37<01:12,  1.10s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:38<01:08,  1.05s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:39<01:06,  1.04s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:41<01:09,  1.11s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:42<01:05,  1.05s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:42<01:01,  1.01s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:43<00:59,  1.00it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:45<01:00,  1.02s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:46<01:00,  1.05s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:48<01:17,  1.36s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:50<01:23,  1.50s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:51<01:29,  1.63s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:53<01:27,  1.61s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:55<01:29,  1.69s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:56<01:22,  1.60s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:58<01:27,  1.72s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:00<01:23,  1.68s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:02<01:24,  1.73s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:03<01:19,  1.66s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:05<01:16,  1.63s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:06<01:14,  1.63s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:08<01:13,  1.64s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:10<01:16,  1.75s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:12<01:18,  1.82s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:14<01:16,  1.83s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:16<01:12,  1.78s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:17<01:07,  1.69s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:18<01:02,  1.61s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:20<01:02,  1.66s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:22<01:01,  1.65s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:23<00:57,  1.60s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:25<00:54,  1.55s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:26<00:52,  1.56s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:28<00:53,  1.62s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:30<00:50,  1.59s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:31<00:49,  1.58s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:33<00:47,  1.59s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:34<00:43,  1.49s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:36<00:41,  1.49s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:37<00:39,  1.45s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:38<00:34,  1.35s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:39<00:31,  1.27s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:40<00:28,  1.20s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:41<00:25,  1.12s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:42<00:23,  1.08s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:43<00:22,  1.07s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:44<00:21,  1.06s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:45<00:20,  1.07s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:46<00:19,  1.09s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:48<00:18,  1.11s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:49<00:17,  1.07s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:50<00:16,  1.08s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:51<00:15,  1.10s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:52<00:14,  1.13s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:53<00:13,  1.12s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:54<00:12,  1.13s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:56<00:11,  1.17s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:57<00:10,  1.21s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:58<00:09,  1.22s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:59<00:08,  1.19s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:00<00:07,  1.20s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:02<00:05,  1.20s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:03<00:04,  1.18s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:04<00:03,  1.18s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:05<00:02,  1.15s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:06<00:01,  1.19s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:07<00:00,  1.19s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:07<00:00,  1.28s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.018 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.15344
wandb: 
wandb: üöÄ View run ethereal-sweep-293 at: https://wandb.ai/xzy11632/dance-dev/runs/mbp2pr1v
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_034622-mbp2pr1v/logs
wandb: Agent Starting Run: fjvmm30o with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_035008-fjvmm30o
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run splendid-sweep-294
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/fjvmm30o
[INFO][2024-03-18 03:50:14,208][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 03:50:14,317][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 03:50:14,317][dance][wrapped_func] Took 0:00:00.108372 to load and process data.
[INFO][2024-03-18 03:50:14,317][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 03:50:14,319][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 03:50:14,338][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 03:50:14,562][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 03:50:17,288][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=84)
[INFO][2024-03-18 03:50:17,300][dance.WeightedFeatureSVD][__call__] Total explained variance: 88.87%
[INFO][2024-03-18 03:50:20,072][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 03:50:20,074][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 03:50:20,074][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 03:50:20,074][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:48,  1.09s/it]  2%|‚ñè         | 2/100 [00:02<01:47,  1.10s/it]  3%|‚ñé         | 3/100 [00:03<01:44,  1.07s/it]  4%|‚ñç         | 4/100 [00:04<01:41,  1.06s/it]  5%|‚ñå         | 5/100 [00:05<01:36,  1.02s/it]  6%|‚ñå         | 6/100 [00:06<01:31,  1.03it/s]  7%|‚ñã         | 7/100 [00:07<01:29,  1.04it/s]  8%|‚ñä         | 8/100 [00:08<01:31,  1.01it/s]  9%|‚ñâ         | 9/100 [00:09<01:29,  1.02it/s] 10%|‚ñà         | 10/100 [00:09<01:26,  1.04it/s] 11%|‚ñà         | 11/100 [00:10<01:24,  1.06it/s] 12%|‚ñà‚ñè        | 12/100 [00:11<01:22,  1.07it/s] 13%|‚ñà‚ñé        | 13/100 [00:12<01:20,  1.08it/s] 14%|‚ñà‚ñç        | 14/100 [00:13<01:19,  1.08it/s] 15%|‚ñà‚ñå        | 15/100 [00:14<01:20,  1.05it/s] 16%|‚ñà‚ñå        | 16/100 [00:15<01:22,  1.02it/s] 17%|‚ñà‚ñã        | 17/100 [00:16<01:22,  1.01it/s] 18%|‚ñà‚ñä        | 18/100 [00:17<01:20,  1.02it/s] 19%|‚ñà‚ñâ        | 19/100 [00:18<01:19,  1.02it/s] 20%|‚ñà‚ñà        | 20/100 [00:19<01:20,  1.00s/it] 21%|‚ñà‚ñà        | 21/100 [00:20<01:19,  1.00s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:21<01:18,  1.01s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:22<01:16,  1.01it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:23<01:16,  1.01s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:24<01:14,  1.00it/s] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:25<01:10,  1.04it/s] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:26<01:09,  1.05it/s] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:27<01:07,  1.06it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:28<01:08,  1.04it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:29<01:07,  1.04it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:30<01:06,  1.03it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:31<01:08,  1.00s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:32<01:06,  1.01it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:33<01:03,  1.04it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:34<01:02,  1.03it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:35<00:59,  1.08it/s] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:35<00:56,  1.11it/s] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:36<00:55,  1.12it/s] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:37<00:54,  1.11it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:38<00:54,  1.10it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:39<00:54,  1.09it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:40<00:51,  1.12it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:41<00:50,  1.12it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:42<00:52,  1.07it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:43<00:51,  1.08it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:44<00:49,  1.10it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:45<00:49,  1.08it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:46<00:48,  1.08it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:46<00:47,  1.07it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:48<00:50,  1.02s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:49<00:51,  1.06s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:50<00:48,  1.01s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:51<00:45,  1.03it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:51<00:42,  1.08it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:52<00:40,  1.12it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:53<00:42,  1.04it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [00:55<00:43,  1.02s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [00:56<00:44,  1.06s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [00:57<00:46,  1.12s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [00:58<00:42,  1.07s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [00:59<00:39,  1.01s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:00<00:36,  1.05it/s] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:00<00:34,  1.08it/s] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:01<00:32,  1.12it/s] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:02<00:31,  1.10it/s] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:03<00:30,  1.12it/s] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:04<00:30,  1.10it/s] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:05<00:29,  1.07it/s] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:06<00:30,  1.01it/s] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:07<00:31,  1.04s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:08<00:30,  1.04s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:10<00:31,  1.11s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:11<00:33,  1.23s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:12<00:31,  1.23s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:14<00:32,  1.30s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:15<00:32,  1.35s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:17<00:31,  1.37s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:18<00:28,  1.29s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:19<00:25,  1.20s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:20<00:22,  1.12s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:21<00:20,  1.06s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:22<00:18,  1.04s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:23<00:17,  1.02s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:24<00:16,  1.03s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:25<00:15,  1.02s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:26<00:14,  1.02s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:27<00:13,  1.05s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:28<00:12,  1.08s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:29<00:12,  1.10s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:30<00:10,  1.08s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:31<00:10,  1.13s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:32<00:08,  1.08s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:33<00:07,  1.10s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:35<00:06,  1.12s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:36<00:06,  1.21s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:38<00:05,  1.33s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:39<00:04,  1.36s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:40<00:02,  1.36s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:42<00:01,  1.31s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:43<00:00,  1.25s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:43<00:00,  1.03s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.1381
wandb: 
wandb: üöÄ View run splendid-sweep-294 at: https://wandb.ai/xzy11632/dance-dev/runs/fjvmm30o
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_035008-fjvmm30o/logs
wandb: Agent Starting Run: umjv5ie1 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_035359-umjv5ie1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dainty-sweep-295
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/umjv5ie1
[INFO][2024-03-18 03:54:04,375][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 03:54:04,473][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 03:54:04,473][dance][wrapped_func] Took 0:00:00.097151 to load and process data.
[INFO][2024-03-18 03:54:04,473][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 03:54:04,475][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 03:54:04,494][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 03:54:04,651][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.024 MB uploadedwandb: \ 0.018 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run dainty-sweep-295 at: https://wandb.ai/xzy11632/dance-dev/runs/umjv5ie1
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_035359-umjv5ie1/logs
wandb: ERROR Run umjv5ie1 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/cell_feature.py", line 50, in __call__
wandb: ERROR     gene_feat = gene_pca.fit_transform(feat.T)  # decompose into gene features
wandb: ERROR                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
wandb: ERROR     data_to_wrap = f(self, X, *args, **kwargs)
wandb: ERROR                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 1152, in wrapper
wandb: ERROR     return fit_method(estimator, *args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 460, in fit_transform
wandb: ERROR     U, S, Vt = self._fit(X)
wandb: ERROR                ^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 483, in _fit
wandb: ERROR     X = self._validate_data(
wandb: ERROR         ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 605, in _validate_data
wandb: ERROR     out = check_array(X, input_name="X", **check_params)
wandb: ERROR           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/validation.py", line 967, in check_array
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: Found array with 0 sample(s) (shape=(0, 8218)) while a minimum of 1 is required by PCA.
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 2slff8tf with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_035425-2slff8tf
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run gallant-sweep-296
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/2slff8tf
[INFO][2024-03-18 03:54:36,089][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 03:54:36,355][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 03:54:36,356][dance][wrapped_func] Took 0:00:00.266565 to load and process data.
[INFO][2024-03-18 03:54:36,368][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 03:54:36,370][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 03:54:36,421][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 03:54:36,924][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run gallant-sweep-296 at: https://wandb.ai/xzy11632/dance-dev/runs/2slff8tf
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_035425-2slff8tf/logs
wandb: ERROR Run 2slff8tf errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/cell_feature.py", line 98, in __call__
wandb: ERROR     svd.fit_transform(feat)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
wandb: ERROR     data_to_wrap = f(self, X, *args, **kwargs)
wandb: ERROR                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 1145, in wrapper
wandb: ERROR     estimator._validate_params()
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 638, in _validate_params
wandb: ERROR     validate_parameter_constraints(
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_param_validation.py", line 96, in validate_parameter_constraints
wandb: ERROR     raise InvalidParameterError(
wandb: ERROR sklearn.utils._param_validation.InvalidParameterError: The 'n_components' parameter of TruncatedSVD must be an int in the range [1, inf). Got -1 instead.
wandb: ERROR 
wandb: Agent Starting Run: rgkchdj4 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_035446-rgkchdj4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run toasty-sweep-297
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/rgkchdj4
[INFO][2024-03-18 03:54:54,485][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 03:54:54,670][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 03:54:54,671][dance][wrapped_func] Took 0:00:00.184627 to load and process data.
[INFO][2024-03-18 03:54:54,671][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 03:54:54,673][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 03:54:54,719][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 03:54:54,920][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 03:55:01,278][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=92)
[INFO][2024-03-18 03:55:01,279][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.02%
[INFO][2024-03-18 04:02:25,386][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 04:02:25,388][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 04:02:25,388][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 04:02:25,388][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:58,  1.20s/it]  2%|‚ñè         | 2/100 [00:02<02:02,  1.25s/it]  3%|‚ñé         | 3/100 [00:03<02:00,  1.25s/it]  4%|‚ñç         | 4/100 [00:04<01:58,  1.23s/it]  5%|‚ñå         | 5/100 [00:06<01:54,  1.21s/it]  6%|‚ñå         | 6/100 [00:07<01:51,  1.18s/it]  7%|‚ñã         | 7/100 [00:08<01:48,  1.17s/it]  8%|‚ñä         | 8/100 [00:09<01:44,  1.13s/it]  9%|‚ñâ         | 9/100 [00:10<01:46,  1.17s/it] 10%|‚ñà         | 10/100 [00:11<01:43,  1.15s/it] 11%|‚ñà         | 11/100 [00:12<01:39,  1.12s/it] 12%|‚ñà‚ñè        | 12/100 [00:13<01:37,  1.11s/it] 13%|‚ñà‚ñé        | 13/100 [00:14<01:33,  1.08s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:33,  1.08s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:30,  1.06s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<01:26,  1.03s/it] 17%|‚ñà‚ñã        | 17/100 [00:19<01:25,  1.03s/it] 18%|‚ñà‚ñä        | 18/100 [00:20<01:24,  1.03s/it] 19%|‚ñà‚ñâ        | 19/100 [00:21<01:23,  1.03s/it] 20%|‚ñà‚ñà        | 20/100 [00:22<01:24,  1.05s/it] 21%|‚ñà‚ñà        | 21/100 [00:23<01:22,  1.04s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:24<01:20,  1.04s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:25<01:20,  1.04s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:26<01:19,  1.04s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:27<01:17,  1.03s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:28<01:17,  1.04s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:29<01:15,  1.03s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:30<01:14,  1.03s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:31<01:14,  1.04s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:32<01:15,  1.08s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:33<01:13,  1.07s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:34<01:14,  1.09s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:35<01:11,  1.07s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:36<01:09,  1.06s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:37<01:07,  1.03s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:38<01:06,  1.03s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:39<01:05,  1.03s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:41<01:04,  1.05s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:42<01:05,  1.07s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:43<01:05,  1.09s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:44<01:02,  1.06s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:45<01:00,  1.05s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:46<00:59,  1.04s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:47<00:59,  1.07s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:48<00:59,  1.08s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:49<00:58,  1.09s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:50<00:57,  1.09s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:51<00:55,  1.07s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:52<00:52,  1.03s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:53<00:51,  1.02s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:54<00:50,  1.03s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:56<00:52,  1.10s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:57<00:51,  1.10s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:58<00:48,  1.06s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:59<00:46,  1.04s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:00<00:45,  1.04s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:01<00:44,  1.03s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:02<00:44,  1.07s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:03<00:42,  1.04s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:04<00:41,  1.03s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:05<00:39,  1.03s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:06<00:39,  1.03s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:07<00:36,  1.01it/s] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:08<00:35,  1.01it/s] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:09<00:34,  1.00it/s] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:10<00:34,  1.01s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:11<00:32,  1.00it/s] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:12<00:31,  1.01it/s] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:13<00:30,  1.01it/s] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:14<00:30,  1.00s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:15<00:30,  1.05s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:16<00:29,  1.04s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:17<00:28,  1.05s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:18<00:26,  1.01s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:19<00:24,  1.03it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:20<00:22,  1.04it/s] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:21<00:21,  1.08it/s] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:22<00:20,  1.07it/s] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:23<00:19,  1.07it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:24<00:20,  1.02s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:25<00:21,  1.11s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:26<00:21,  1.18s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:28<00:21,  1.27s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:29<00:21,  1.36s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:31<00:19,  1.28s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:32<00:16,  1.18s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:32<00:14,  1.10s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:33<00:12,  1.04s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:34<00:11,  1.03s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:35<00:09,  1.01it/s] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:36<00:08,  1.03it/s] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:37<00:07,  1.03it/s] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:38<00:06,  1.03it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:39<00:05,  1.02it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:40<00:04,  1.01it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:41<00:04,  1.05s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:42<00:03,  1.08s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:44<00:02,  1.10s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:45<00:01,  1.09s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:46<00:00,  1.09s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:46<00:00,  1.06s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.17422
wandb: 
wandb: üöÄ View run toasty-sweep-297 at: https://wandb.ai/xzy11632/dance-dev/runs/rgkchdj4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_035446-rgkchdj4/logs
wandb: Agent Starting Run: b2ykh1zj with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_040612-b2ykh1zj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sleek-sweep-298
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/b2ykh1zj
[INFO][2024-03-18 04:06:18,212][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 04:06:18,321][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 04:06:18,321][dance][wrapped_func] Took 0:00:00.109029 to load and process data.
[INFO][2024-03-18 04:06:18,321][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 04:06:18,324][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 04:06:18,346][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 04:06:18,633][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 04:06:21,045][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=87)
[INFO][2024-03-18 04:06:21,046][dance.WeightedFeatureSVD][__call__] Total explained variance: 88.96%
[INFO][2024-03-18 04:06:23,492][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 04:06:23,493][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 04:06:23,494][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 04:06:23,494][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:41,  1.03s/it]  2%|‚ñè         | 2/100 [00:01<01:35,  1.03it/s]  3%|‚ñé         | 3/100 [00:02<01:33,  1.04it/s]  4%|‚ñç         | 4/100 [00:03<01:36,  1.00s/it]  5%|‚ñå         | 5/100 [00:04<01:33,  1.01it/s]  6%|‚ñå         | 6/100 [00:06<01:35,  1.01s/it]  7%|‚ñã         | 7/100 [00:07<01:36,  1.04s/it]  8%|‚ñä         | 8/100 [00:08<01:34,  1.03s/it]  9%|‚ñâ         | 9/100 [00:09<01:35,  1.05s/it] 10%|‚ñà         | 10/100 [00:10<01:33,  1.04s/it] 11%|‚ñà         | 11/100 [00:11<01:32,  1.04s/it] 12%|‚ñà‚ñè        | 12/100 [00:12<01:31,  1.05s/it] 13%|‚ñà‚ñé        | 13/100 [00:13<01:32,  1.06s/it] 14%|‚ñà‚ñç        | 14/100 [00:14<01:39,  1.16s/it] 15%|‚ñà‚ñå        | 15/100 [00:16<01:51,  1.31s/it] 16%|‚ñà‚ñå        | 16/100 [00:17<01:55,  1.37s/it] 17%|‚ñà‚ñã        | 17/100 [00:19<02:03,  1.49s/it] 18%|‚ñà‚ñä        | 18/100 [00:21<02:09,  1.58s/it] 19%|‚ñà‚ñâ        | 19/100 [00:22<02:04,  1.54s/it] 20%|‚ñà‚ñà        | 20/100 [00:24<01:51,  1.39s/it] 21%|‚ñà‚ñà        | 21/100 [00:24<01:39,  1.25s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:26<01:36,  1.24s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:27<01:47,  1.40s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:29<01:52,  1.48s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:31<01:49,  1.46s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:32<01:46,  1.44s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:33<01:43,  1.42s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:35<01:44,  1.46s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:36<01:35,  1.35s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:37<01:30,  1.29s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:38<01:28,  1.28s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:39<01:22,  1.21s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:40<01:16,  1.14s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:41<01:13,  1.12s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:42<01:09,  1.06s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:43<01:07,  1.05s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:44<01:05,  1.03s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:45<01:04,  1.03s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:46<01:01,  1.01s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:47<00:59,  1.01it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:48<00:57,  1.03it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:49<00:57,  1.02it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:50<00:58,  1.02s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:51<00:59,  1.05s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:52<00:56,  1.03s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:54<00:55,  1.03s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:54<00:54,  1.02s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:56<00:53,  1.04s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:57<00:53,  1.06s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:58<00:52,  1.04s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:59<00:50,  1.03s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:00<00:47,  1.00it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:01<00:46,  1.02it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:01<00:44,  1.03it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:03<00:44,  1.01it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:04<00:43,  1.01it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:05<00:44,  1.03s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:06<00:43,  1.04s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:07<00:42,  1.03s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:08<00:41,  1.04s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:09<00:41,  1.07s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:10<00:39,  1.04s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:11<00:38,  1.04s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:12<00:36,  1.02s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:13<00:34,  1.00it/s] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:14<00:33,  1.02it/s] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:15<00:32,  1.03it/s] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:16<00:31,  1.02it/s] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:17<00:31,  1.00s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:18<00:31,  1.03s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:19<00:30,  1.07s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:20<00:29,  1.05s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:21<00:27,  1.03s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:22<00:26,  1.02s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:23<00:24,  1.01it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:24<00:24,  1.01s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:25<00:23,  1.01s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:26<00:22,  1.02s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:27<00:21,  1.01s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:28<00:20,  1.00s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:29<00:19,  1.01s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:30<00:18,  1.02s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:31<00:17,  1.04s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:32<00:16,  1.06s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:33<00:15,  1.06s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:34<00:14,  1.03s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:35<00:13,  1.01s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:36<00:12,  1.07s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:38<00:11,  1.06s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:39<00:10,  1.05s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:40<00:09,  1.04s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:41<00:08,  1.08s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:42<00:07,  1.03s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:43<00:06,  1.01s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:44<00:04,  1.00it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:45<00:04,  1.03s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:46<00:03,  1.04s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:47<00:02,  1.04s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:48<00:01,  1.03s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:49<00:00,  1.04s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:49<00:00,  1.09s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.16329
wandb: 
wandb: üöÄ View run sleek-sweep-298 at: https://wandb.ai/xzy11632/dance-dev/runs/b2ykh1zj
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_040612-b2ykh1zj/logs
wandb: Agent Starting Run: lsu6ph34 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_040927-lsu6ph34
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fancy-sweep-299
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/lsu6ph34
[INFO][2024-03-18 04:09:33,547][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 04:09:33,667][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 04:09:33,668][dance][wrapped_func] Took 0:00:00.120326 to load and process data.
[INFO][2024-03-18 04:09:33,668][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 04:09:33,671][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 04:09:33,698][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 04:09:34,055][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-18 04:09:37,401][dance.WeightedFeaturePCA][__call__] Decomposing train features (8218, 200) (k=89)
[INFO][2024-03-18 04:09:37,401][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.02%
[INFO][2024-03-18 04:09:58,807][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 04:09:58,808][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 04:09:58,808][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 04:09:58,808][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:43,  1.04s/it]  2%|‚ñè         | 2/100 [00:02<01:38,  1.01s/it]  3%|‚ñé         | 3/100 [00:02<01:32,  1.04it/s]  4%|‚ñç         | 4/100 [00:03<01:34,  1.02it/s]  5%|‚ñå         | 5/100 [00:04<01:32,  1.03it/s]  6%|‚ñå         | 6/100 [00:05<01:33,  1.00it/s]  7%|‚ñã         | 7/100 [00:07<01:34,  1.02s/it]  8%|‚ñä         | 8/100 [00:07<01:31,  1.00it/s]  9%|‚ñâ         | 9/100 [00:08<01:28,  1.03it/s] 10%|‚ñà         | 10/100 [00:09<01:27,  1.02it/s] 11%|‚ñà         | 11/100 [00:10<01:26,  1.03it/s] 12%|‚ñà‚ñè        | 12/100 [00:11<01:26,  1.02it/s] 13%|‚ñà‚ñé        | 13/100 [00:12<01:28,  1.01s/it] 14%|‚ñà‚ñç        | 14/100 [00:13<01:28,  1.03s/it] 15%|‚ñà‚ñå        | 15/100 [00:14<01:25,  1.01s/it] 16%|‚ñà‚ñå        | 16/100 [00:15<01:23,  1.00it/s] 17%|‚ñà‚ñã        | 17/100 [00:16<01:22,  1.01it/s] 18%|‚ñà‚ñä        | 18/100 [00:17<01:20,  1.01it/s] 19%|‚ñà‚ñâ        | 19/100 [00:18<01:20,  1.00it/s] 20%|‚ñà‚ñà        | 20/100 [00:20<01:26,  1.08s/it] 21%|‚ñà‚ñà        | 21/100 [00:21<01:25,  1.08s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:22<01:19,  1.02s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:23<01:18,  1.02s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:24<01:19,  1.04s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:25<01:19,  1.06s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:26<01:21,  1.10s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:27<01:20,  1.11s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:28<01:19,  1.10s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:29<01:20,  1.13s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:31<01:18,  1.12s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:32<01:16,  1.11s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:33<01:16,  1.12s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:34<01:16,  1.14s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:35<01:13,  1.12s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:36<01:11,  1.09s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:37<01:08,  1.08s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:38<01:07,  1.07s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:39<01:05,  1.06s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:40<01:04,  1.06s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:41<01:03,  1.06s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:42<01:04,  1.09s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:44<01:03,  1.10s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:45<01:01,  1.08s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:46<01:00,  1.08s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:47<01:00,  1.10s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:48<00:58,  1.08s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:49<00:57,  1.09s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:50<00:57,  1.10s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:51<00:54,  1.08s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:52<00:53,  1.06s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:53<00:53,  1.08s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:54<00:52,  1.08s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:55<00:49,  1.06s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:56<00:47,  1.03s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:58<00:50,  1.13s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:59<00:56,  1.27s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:01<00:57,  1.33s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:02<00:59,  1.43s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:04<00:54,  1.33s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:05<00:48,  1.22s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:06<00:44,  1.15s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:06<00:41,  1.10s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:07<00:39,  1.07s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:08<00:37,  1.04s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:09<00:36,  1.04s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:10<00:34,  1.01s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:11<00:32,  1.01it/s] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:12<00:31,  1.01it/s] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:13<00:30,  1.03it/s] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:14<00:28,  1.05it/s] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:15<00:28,  1.03it/s] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:16<00:26,  1.06it/s] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:17<00:25,  1.05it/s] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:18<00:24,  1.06it/s] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:19<00:23,  1.06it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:20<00:23,  1.02it/s] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:21<00:23,  1.00s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:22<00:21,  1.00it/s] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:23<00:20,  1.01it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:24<00:20,  1.04s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:25<00:20,  1.06s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:26<00:19,  1.08s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:27<00:17,  1.04s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:28<00:16,  1.04s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:29<00:14,  1.01it/s] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:30<00:13,  1.00it/s] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:31<00:13,  1.01s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:32<00:12,  1.03s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:34<00:11,  1.06s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:34<00:10,  1.02s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:35<00:08,  1.01it/s] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:36<00:07,  1.04it/s] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:37<00:06,  1.04it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:38<00:05,  1.04it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:39<00:04,  1.05it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:40<00:03,  1.06it/s] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:41<00:02,  1.08it/s] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:42<00:01,  1.07it/s] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:43<00:00,  1.04it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:44<00:00,  1.03it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:44<00:00,  1.04s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.19031
wandb: 
wandb: üöÄ View run fancy-sweep-299 at: https://wandb.ai/xzy11632/dance-dev/runs/lsu6ph34
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_040927-lsu6ph34/logs
wandb: Agent Starting Run: d4wlynm1 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsPlaceHolder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_041320-d4wlynm1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run vocal-sweep-300
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/d4wlynm1
[INFO][2024-03-18 04:13:26,740][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 04:13:26,859][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 04:13:26,859][dance][wrapped_func] Took 0:00:00.118742 to load and process data.
[INFO][2024-03-18 04:13:26,859][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 04:13:26,862][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsPlaceHolder',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 04:13:26,883][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 04:13:27,196][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-18 04:13:34,630][dance.WeightedFeatureSVD][__call__] Decomposing train features (8218, 200) (k=84)
[INFO][2024-03-18 04:13:34,641][dance.WeightedFeatureSVD][__call__] Total explained variance: 88.97%
[INFO][2024-03-18 04:13:49,149][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 04:13:49,150][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 04:13:49,150][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 04:13:49,150][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:51,  1.13s/it]  2%|‚ñè         | 2/100 [00:02<01:52,  1.15s/it]  3%|‚ñé         | 3/100 [00:03<01:46,  1.10s/it]  4%|‚ñç         | 4/100 [00:04<01:44,  1.09s/it]  5%|‚ñå         | 5/100 [00:05<01:38,  1.04s/it]  6%|‚ñå         | 6/100 [00:06<01:34,  1.01s/it]  7%|‚ñã         | 7/100 [00:07<01:33,  1.01s/it]  8%|‚ñä         | 8/100 [00:08<01:30,  1.02it/s]  9%|‚ñâ         | 9/100 [00:09<01:29,  1.02it/s] 10%|‚ñà         | 10/100 [00:10<01:29,  1.01it/s] 11%|‚ñà         | 11/100 [00:11<01:27,  1.02it/s] 12%|‚ñà‚ñè        | 12/100 [00:12<01:23,  1.05it/s] 13%|‚ñà‚ñé        | 13/100 [00:13<01:24,  1.03it/s] 14%|‚ñà‚ñç        | 14/100 [00:13<01:21,  1.06it/s] 15%|‚ñà‚ñå        | 15/100 [00:14<01:19,  1.07it/s] 16%|‚ñà‚ñå        | 16/100 [00:15<01:19,  1.06it/s] 17%|‚ñà‚ñã        | 17/100 [00:16<01:17,  1.07it/s] 18%|‚ñà‚ñä        | 18/100 [00:17<01:20,  1.02it/s] 19%|‚ñà‚ñâ        | 19/100 [00:18<01:20,  1.00it/s] 20%|‚ñà‚ñà        | 20/100 [00:20<01:22,  1.03s/it] 21%|‚ñà‚ñà        | 21/100 [00:21<01:23,  1.06s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:22<01:25,  1.10s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:23<01:25,  1.12s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:24<01:27,  1.15s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:25<01:27,  1.17s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:27<01:26,  1.17s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:28<01:25,  1.17s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:29<01:25,  1.19s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:30<01:23,  1.18s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:31<01:24,  1.20s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:33<01:24,  1.23s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:34<01:23,  1.23s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:35<01:21,  1.21s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:36<01:19,  1.20s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:37<01:17,  1.20s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:39<01:16,  1.19s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:40<01:13,  1.17s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:41<01:10,  1.14s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:42<01:06,  1.10s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:43<01:05,  1.10s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:44<01:06,  1.13s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:45<01:05,  1.14s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:46<01:05,  1.15s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:48<01:05,  1.17s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:50<01:19,  1.44s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:51<01:22,  1.52s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:53<01:26,  1.63s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:55<01:27,  1.69s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:57<01:34,  1.84s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:59<01:26,  1.72s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:00<01:20,  1.65s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:02<01:13,  1.53s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:03<01:14,  1.59s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:05<01:14,  1.63s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:06<01:08,  1.53s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:07<01:01,  1.39s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:08<00:56,  1.30s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:10<00:53,  1.28s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:11<00:50,  1.24s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:12<00:49,  1.23s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:13<00:47,  1.22s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:14<00:45,  1.20s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:15<00:42,  1.15s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:16<00:40,  1.11s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:18<00:39,  1.12s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:19<00:37,  1.11s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:20<00:37,  1.13s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:21<00:35,  1.10s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:22<00:33,  1.07s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:23<00:31,  1.04s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:24<00:29,  1.01s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:25<00:28,  1.00s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:26<00:27,  1.02s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:27<00:26,  1.02s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:28<00:26,  1.05s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:29<00:24,  1.02s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:30<00:23,  1.03s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:31<00:22,  1.03s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:32<00:21,  1.03s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:33<00:20,  1.02s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:34<00:18,  1.00it/s] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:35<00:17,  1.00it/s] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:36<00:16,  1.01it/s] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:37<00:15,  1.01it/s] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:38<00:15,  1.00s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:39<00:13,  1.00it/s] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:40<00:13,  1.02s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:41<00:12,  1.04s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:42<00:11,  1.08s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:43<00:10,  1.08s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:44<00:09,  1.08s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:46<00:08,  1.10s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:47<00:07,  1.09s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:48<00:06,  1.13s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:49<00:05,  1.13s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:50<00:04,  1.14s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:52<00:03,  1.32s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:54<00:03,  1.55s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:56<00:01,  1.59s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:57<00:00,  1.61s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:57<00:00,  1.18s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.013 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.12751
wandb: 
wandb: üöÄ View run vocal-sweep-300 at: https://wandb.ai/xzy11632/dance-dev/runs/d4wlynm1
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_041320-d4wlynm1/logs
wandb: Agent Starting Run: boxxi70a with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_041725-boxxi70a
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glowing-sweep-301
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/boxxi70a
[INFO][2024-03-18 04:17:31,959][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 04:17:32,115][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 04:17:32,116][dance][wrapped_func] Took 0:00:00.150283 to load and process data.
[INFO][2024-03-18 04:17:32,116][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 04:17:32,119][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'Log1P',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 04:17:32,147][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 04:17:32,504][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 04:18:20,227][dance.WeightedFeaturePCA][__call__] Decomposing train features (5917, 919) (k=465)
[INFO][2024-03-18 04:18:20,228][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.00%
[INFO][2024-03-18 04:21:15,051][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 04:21:15,052][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 04:21:15,052][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 04:21:15,052][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:02<03:25,  2.08s/it]  2%|‚ñè         | 2/100 [00:04<03:25,  2.10s/it]  3%|‚ñé         | 3/100 [00:06<03:23,  2.10s/it]  4%|‚ñç         | 4/100 [00:08<03:19,  2.08s/it]  5%|‚ñå         | 5/100 [00:10<03:15,  2.06s/it]  6%|‚ñå         | 6/100 [00:12<03:19,  2.12s/it]  7%|‚ñã         | 7/100 [00:14<03:20,  2.16s/it]  8%|‚ñä         | 8/100 [00:16<03:15,  2.13s/it]  9%|‚ñâ         | 9/100 [00:18<02:49,  1.86s/it] 10%|‚ñà         | 10/100 [00:19<02:27,  1.63s/it] 11%|‚ñà         | 11/100 [00:20<02:27,  1.65s/it] 12%|‚ñà‚ñè        | 12/100 [00:24<03:10,  2.16s/it] 13%|‚ñà‚ñé        | 13/100 [00:27<03:31,  2.43s/it] 14%|‚ñà‚ñç        | 14/100 [00:30<03:42,  2.58s/it] 15%|‚ñà‚ñå        | 15/100 [00:33<03:47,  2.67s/it] 16%|‚ñà‚ñå        | 16/100 [00:35<03:44,  2.68s/it] 17%|‚ñà‚ñã        | 17/100 [00:39<04:03,  2.93s/it] 18%|‚ñà‚ñä        | 18/100 [00:42<04:01,  2.95s/it] 19%|‚ñà‚ñâ        | 19/100 [00:45<03:59,  2.96s/it] 20%|‚ñà‚ñà        | 20/100 [00:48<04:00,  3.01s/it] 21%|‚ñà‚ñà        | 21/100 [00:51<03:47,  2.87s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:54<03:46,  2.91s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:56<03:25,  2.67s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:59<03:34,  2.82s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [01:02<03:39,  2.93s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [01:05<03:36,  2.92s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [01:08<03:31,  2.90s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [01:11<03:34,  2.98s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [01:14<03:36,  3.05s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [01:17<03:32,  3.03s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [01:20<03:30,  3.05s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:23<03:30,  3.09s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:26<03:25,  3.07s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:29<03:21,  3.05s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:32<03:15,  3.00s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:35<02:57,  2.78s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:38<02:59,  2.84s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:40<02:56,  2.84s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:43<02:55,  2.88s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:45<02:36,  2.61s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:48<02:38,  2.68s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:51<02:37,  2.72s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:54<02:37,  2.76s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:57<02:40,  2.86s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [02:00<02:37,  2.87s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [02:03<02:35,  2.88s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [02:09<03:19,  3.77s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [02:15<03:59,  4.60s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [02:21<04:20,  5.10s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [02:27<04:18,  5.17s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [02:32<04:08,  5.06s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [02:36<03:54,  4.88s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [02:40<03:38,  4.64s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [02:44<03:29,  4.55s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [02:49<03:21,  4.49s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [02:53<03:16,  4.47s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [02:57<03:07,  4.36s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [03:01<02:56,  4.21s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [03:06<03:00,  4.39s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [03:09<02:37,  3.94s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [03:12<02:18,  3.55s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [03:14<02:05,  3.31s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [03:17<01:54,  3.09s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [03:20<01:46,  2.97s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [03:22<01:39,  2.84s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [03:25<01:34,  2.79s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [03:28<01:31,  2.78s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [03:30<01:30,  2.84s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [03:33<01:22,  2.66s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [03:35<01:15,  2.51s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [03:37<01:11,  2.47s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [03:39<01:07,  2.39s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [03:42<01:02,  2.33s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [03:44<00:58,  2.25s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [03:46<00:55,  2.23s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [03:48<00:54,  2.27s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [03:50<00:51,  2.22s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [03:53<00:48,  2.20s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [03:55<00:45,  2.17s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [03:57<00:42,  2.13s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [03:59<00:41,  2.16s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [04:01<00:37,  2.07s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [04:03<00:34,  2.00s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [04:04<00:30,  1.89s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [04:05<00:25,  1.70s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [04:07<00:21,  1.52s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [04:08<00:18,  1.43s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [04:09<00:16,  1.38s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [04:10<00:15,  1.38s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [04:12<00:13,  1.34s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [04:13<00:11,  1.33s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [04:14<00:10,  1.29s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [04:15<00:08,  1.25s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [04:16<00:07,  1.22s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [04:18<00:06,  1.26s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [04:19<00:04,  1.18s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [04:20<00:03,  1.16s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [04:21<00:02,  1.16s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [04:22<00:01,  1.20s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [04:24<00:00,  1.19s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [04:24<00:00,  2.64s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.28806
wandb: 
wandb: üöÄ View run glowing-sweep-301 at: https://wandb.ai/xzy11632/dance-dev/runs/boxxi70a
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_041725-boxxi70a/logs
wandb: Agent Starting Run: douzh096 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_042630-douzh096
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rich-sweep-302
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/douzh096
[INFO][2024-03-18 04:26:35,977][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 04:26:36,067][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 04:26:36,067][dance][wrapped_func] Took 0:00:00.090108 to load and process data.
[INFO][2024-03-18 04:26:36,068][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 04:26:36,069][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'Log1P',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 04:26:36,091][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 04:26:36,277][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 04:27:29,503][dance.WeightedFeatureSVD][__call__] Decomposing train features (5917, 919) (k=607)
[INFO][2024-03-18 04:27:29,505][dance.WeightedFeatureSVD][__call__] Total explained variance: 94.20%
[INFO][2024-03-18 04:27:52,299][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 04:27:52,300][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 04:27:52,300][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 04:27:52,300][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:34,  1.56s/it]  2%|‚ñè         | 2/100 [00:03<02:36,  1.59s/it]  3%|‚ñé         | 3/100 [00:04<02:25,  1.50s/it]  4%|‚ñç         | 4/100 [00:06<02:29,  1.55s/it]  5%|‚ñå         | 5/100 [00:07<02:12,  1.40s/it]  6%|‚ñå         | 6/100 [00:08<02:16,  1.45s/it]  7%|‚ñã         | 7/100 [00:10<02:19,  1.50s/it]  8%|‚ñä         | 8/100 [00:11<02:17,  1.49s/it]  9%|‚ñâ         | 9/100 [00:13<02:23,  1.57s/it] 10%|‚ñà         | 10/100 [00:15<02:18,  1.54s/it] 11%|‚ñà         | 11/100 [00:16<02:15,  1.52s/it] 12%|‚ñà‚ñè        | 12/100 [00:18<02:10,  1.49s/it] 13%|‚ñà‚ñé        | 13/100 [00:19<02:16,  1.57s/it] 14%|‚ñà‚ñç        | 14/100 [00:21<02:16,  1.58s/it] 15%|‚ñà‚ñå        | 15/100 [00:22<02:13,  1.57s/it] 16%|‚ñà‚ñå        | 16/100 [00:24<02:06,  1.50s/it] 17%|‚ñà‚ñã        | 17/100 [00:25<02:06,  1.53s/it] 18%|‚ñà‚ñä        | 18/100 [00:27<02:07,  1.56s/it] 19%|‚ñà‚ñâ        | 19/100 [00:29<02:08,  1.59s/it] 20%|‚ñà‚ñà        | 20/100 [00:30<02:08,  1.61s/it] 21%|‚ñà‚ñà        | 21/100 [00:32<02:02,  1.55s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:33<02:00,  1.54s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:35<01:55,  1.50s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:36<01:56,  1.54s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:38<01:57,  1.57s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:39<01:51,  1.51s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:41<01:49,  1.50s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:42<01:45,  1.47s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:44<01:50,  1.56s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:45<01:45,  1.51s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:47<01:39,  1.44s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:48<01:33,  1.37s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:49<01:26,  1.30s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:50<01:24,  1.28s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:52<01:24,  1.30s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:53<01:22,  1.29s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:54<01:23,  1.32s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:55<01:16,  1.24s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:56<01:11,  1.17s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:57<01:06,  1.11s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:58<01:04,  1.09s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:59<01:02,  1.07s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:00<01:01,  1.08s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:02<01:01,  1.09s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:03<00:58,  1.06s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:03<00:55,  1.03s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:05<00:54,  1.03s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:05<00:52,  1.00s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:07<00:52,  1.03s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:08<00:51,  1.03s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:09<00:52,  1.08s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:10<00:51,  1.08s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:11<00:48,  1.04s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:12<00:48,  1.05s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:13<00:46,  1.04s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:14<00:46,  1.06s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:15<00:46,  1.09s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:17<01:00,  1.45s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:20<01:17,  1.88s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:23<01:28,  2.22s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:26<01:37,  2.49s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:29<01:33,  2.46s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:31<01:24,  2.28s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:33<01:18,  2.18s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:35<01:15,  2.15s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:37<01:09,  2.06s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:38<01:06,  2.00s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:40<01:04,  2.00s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:42<00:55,  1.80s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:43<00:49,  1.64s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:44<00:43,  1.48s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:45<00:39,  1.40s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:47<00:37,  1.38s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:48<00:34,  1.34s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:49<00:32,  1.31s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:51<00:37,  1.58s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:54<00:46,  2.03s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:57<00:50,  2.28s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:00<00:52,  2.51s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:03<00:51,  2.55s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:05<00:47,  2.50s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:08<00:44,  2.49s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:10<00:41,  2.45s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:13<00:41,  2.60s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:15<00:35,  2.40s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:18<00:34,  2.49s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:20<00:32,  2.53s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:23<00:31,  2.60s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:26<00:29,  2.65s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:29<00:26,  2.63s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:31<00:23,  2.66s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:34<00:21,  2.65s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:36<00:16,  2.40s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:38<00:14,  2.45s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:41<00:12,  2.45s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:44<00:10,  2.63s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:47<00:08,  2.70s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:49<00:05,  2.66s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:52<00:02,  2.75s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:55<00:00,  2.67s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:55<00:00,  1.75s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.29376
wandb: 
wandb: üöÄ View run rich-sweep-302 at: https://wandb.ai/xzy11632/dance-dev/runs/douzh096
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_042630-douzh096/logs
wandb: Agent Starting Run: vwm2depz with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_043124-vwm2depz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run jolly-sweep-303
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/vwm2depz
[INFO][2024-03-18 04:31:34,641][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 04:31:34,756][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 04:31:34,765][dance][wrapped_func] Took 0:00:00.124438 to load and process data.
[INFO][2024-03-18 04:31:34,766][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 04:31:34,768][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'Log1P',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-18 04:31:35,102][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.013 MB uploadedwandb: - 0.017 MB of 0.024 MB uploadedwandb: \ 0.017 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run jolly-sweep-303 at: https://wandb.ai/xzy11632/dance-dev/runs/vwm2depz
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_043124-vwm2depz/logs
wandb: ERROR Run vwm2depz errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1081) out of bounds (919)
wandb: ERROR 
wandb: Agent Starting Run: koj0lmtz with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_043146-koj0lmtz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run colorful-sweep-304
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/koj0lmtz
[INFO][2024-03-18 04:31:51,699][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 04:31:51,793][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 04:31:51,794][dance][wrapped_func] Took 0:00:00.093947 to load and process data.
[INFO][2024-03-18 04:31:51,794][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 04:31:51,795][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'Log1P',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-18 04:31:52,073][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run colorful-sweep-304 at: https://wandb.ai/xzy11632/dance-dev/runs/koj0lmtz
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_043146-koj0lmtz/logs
wandb: ERROR Run koj0lmtz errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1081) out of bounds (919)
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: j6fci7ww with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_043211-j6fci7ww
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run amber-sweep-305
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/j6fci7ww
[INFO][2024-03-18 04:32:17,095][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 04:32:17,204][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 04:32:17,205][dance][wrapped_func] Took 0:00:00.096546 to load and process data.
[INFO][2024-03-18 04:32:17,205][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 04:32:17,207][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'Log1P',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[INFO][2024-03-18 04:32:20,647][dance.WeightedFeaturePCA][__call__] Decomposing train features (5917, 200) (k=123)
[INFO][2024-03-18 04:32:20,648][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.15%
[INFO][2024-03-18 04:32:53,418][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 04:32:53,420][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 04:32:53,420][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 04:32:53,420][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:22,  1.44s/it]  2%|‚ñè         | 2/100 [00:02<02:10,  1.34s/it]  3%|‚ñé         | 3/100 [00:03<01:59,  1.23s/it]  4%|‚ñç         | 4/100 [00:04<01:47,  1.12s/it]  5%|‚ñå         | 5/100 [00:05<01:48,  1.14s/it]  6%|‚ñå         | 6/100 [00:06<01:42,  1.09s/it]  7%|‚ñã         | 7/100 [00:07<01:37,  1.05s/it]  8%|‚ñä         | 8/100 [00:08<01:31,  1.00it/s]  9%|‚ñâ         | 9/100 [00:09<01:34,  1.04s/it] 10%|‚ñà         | 10/100 [00:11<01:35,  1.07s/it] 11%|‚ñà         | 11/100 [00:12<01:35,  1.08s/it] 12%|‚ñà‚ñè        | 12/100 [00:13<01:34,  1.07s/it] 13%|‚ñà‚ñé        | 13/100 [00:14<01:32,  1.06s/it] 14%|‚ñà‚ñç        | 14/100 [00:15<01:30,  1.05s/it] 15%|‚ñà‚ñå        | 15/100 [00:16<01:28,  1.04s/it] 16%|‚ñà‚ñå        | 16/100 [00:17<01:29,  1.06s/it] 17%|‚ñà‚ñã        | 17/100 [00:18<01:26,  1.04s/it] 18%|‚ñà‚ñä        | 18/100 [00:19<01:25,  1.04s/it] 19%|‚ñà‚ñâ        | 19/100 [00:20<01:23,  1.03s/it] 20%|‚ñà‚ñà        | 20/100 [00:21<01:22,  1.04s/it] 21%|‚ñà‚ñà        | 21/100 [00:22<01:20,  1.02s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:23<01:19,  1.02s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:24<01:16,  1.01it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:25<01:17,  1.02s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:26<01:16,  1.02s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:27<01:16,  1.03s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:28<01:13,  1.01s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:29<01:14,  1.03s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:30<01:12,  1.02s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:31<01:12,  1.03s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:32<01:10,  1.02s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:33<01:11,  1.05s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:34<01:10,  1.05s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:35<01:09,  1.06s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:36<01:07,  1.04s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:37<01:05,  1.03s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:38<01:05,  1.04s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:40<01:05,  1.05s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:41<01:04,  1.06s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:42<01:01,  1.03s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:42<00:58,  1.02it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:43<00:55,  1.04it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:44<00:53,  1.07it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:45<00:52,  1.06it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:46<00:51,  1.07it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:47<00:50,  1.06it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:48<00:51,  1.03it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:50<01:04,  1.24s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:51<01:04,  1.27s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:52<00:58,  1.18s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:53<00:53,  1.10s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:54<00:50,  1.06s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:55<00:48,  1.04s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:56<00:46,  1.01s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:57<00:43,  1.04it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:58<00:42,  1.04it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [00:59<00:39,  1.08it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:00<00:39,  1.07it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:01<00:37,  1.09it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:02<00:37,  1.07it/s] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:03<00:36,  1.07it/s] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:04<00:42,  1.13s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:05<00:44,  1.20s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:07<00:41,  1.16s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:08<00:39,  1.14s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:09<00:37,  1.12s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:10<00:35,  1.08s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:11<00:34,  1.06s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:12<00:31,  1.02s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:15<00:47,  1.58s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:18<01:04,  2.23s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:20<01:01,  2.21s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:23<01:00,  2.25s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:25<01:01,  2.38s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:27<00:54,  2.19s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:28<00:44,  1.84s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:29<00:36,  1.58s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:30<00:30,  1.41s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:31<00:26,  1.29s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:32<00:24,  1.20s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:33<00:21,  1.15s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:34<00:19,  1.10s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:35<00:18,  1.11s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:36<00:16,  1.06s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:37<00:15,  1.04s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:38<00:14,  1.04s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:39<00:13,  1.05s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:41<00:12,  1.08s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:42<00:11,  1.07s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:43<00:10,  1.06s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:44<00:09,  1.01s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:44<00:07,  1.03it/s] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:45<00:06,  1.04it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:46<00:05,  1.04it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:47<00:04,  1.05it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:48<00:03,  1.03it/s] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:49<00:02,  1.03it/s] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:50<00:01,  1.06it/s] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:51<00:00,  1.07it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:52<00:00,  1.09it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:52<00:00,  1.12s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.017 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.3332
wandb: 
wandb: üöÄ View run amber-sweep-305 at: https://wandb.ai/xzy11632/dance-dev/runs/j6fci7ww
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_043211-j6fci7ww/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: vazstcol with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_043549-vazstcol
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ancient-sweep-306
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/vazstcol
[INFO][2024-03-18 04:35:54,093][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 04:35:54,226][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 04:35:54,226][dance][wrapped_func] Took 0:00:00.131709 to load and process data.
[INFO][2024-03-18 04:35:54,226][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 04:35:54,229][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'Log1P',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[INFO][2024-03-18 04:35:56,550][dance.WeightedFeatureSVD][__call__] Decomposing train features (5917, 200) (k=120)
[INFO][2024-03-18 04:35:56,550][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.28%
[INFO][2024-03-18 04:35:57,708][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 04:35:57,708][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 04:35:57,708][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 04:35:57,709][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:02,  1.59it/s]  2%|‚ñè         | 2/100 [00:01<01:07,  1.44it/s]  3%|‚ñé         | 3/100 [00:02<01:19,  1.22it/s]  4%|‚ñç         | 4/100 [00:03<01:27,  1.10it/s]  5%|‚ñå         | 5/100 [00:04<01:26,  1.10it/s]  6%|‚ñå         | 6/100 [00:05<01:24,  1.11it/s]  7%|‚ñã         | 7/100 [00:06<01:23,  1.11it/s]  8%|‚ñä         | 8/100 [00:07<01:25,  1.08it/s]  9%|‚ñâ         | 9/100 [00:07<01:23,  1.09it/s] 10%|‚ñà         | 10/100 [00:08<01:22,  1.10it/s] 11%|‚ñà         | 11/100 [00:09<01:17,  1.14it/s] 12%|‚ñà‚ñè        | 12/100 [00:10<01:16,  1.15it/s] 13%|‚ñà‚ñé        | 13/100 [00:11<01:14,  1.17it/s] 14%|‚ñà‚ñç        | 14/100 [00:12<01:14,  1.16it/s] 15%|‚ñà‚ñå        | 15/100 [00:13<01:13,  1.15it/s] 16%|‚ñà‚ñå        | 16/100 [00:13<01:13,  1.14it/s] 17%|‚ñà‚ñã        | 17/100 [00:14<01:09,  1.19it/s] 18%|‚ñà‚ñä        | 18/100 [00:15<01:08,  1.19it/s] 19%|‚ñà‚ñâ        | 19/100 [00:16<01:07,  1.20it/s] 20%|‚ñà‚ñà        | 20/100 [00:17<01:09,  1.15it/s] 21%|‚ñà‚ñà        | 21/100 [00:18<01:10,  1.13it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:19<01:10,  1.11it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:20<01:11,  1.07it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:21<01:11,  1.07it/s] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:22<01:09,  1.08it/s] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:22<01:08,  1.08it/s] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:24<01:09,  1.05it/s] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:25<01:14,  1.03s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:27<01:39,  1.40s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:29<01:45,  1.51s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:31<01:57,  1.70s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:33<02:00,  1.77s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:35<02:00,  1.79s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:37<02:00,  1.82s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:38<01:56,  1.79s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:41<02:06,  1.97s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:42<02:00,  1.92s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:44<02:00,  1.95s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:46<01:55,  1.89s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:48<01:43,  1.72s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:49<01:43,  1.76s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:51<01:43,  1.79s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:53<01:43,  1.82s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:55<01:40,  1.80s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:57<01:36,  1.75s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:58<01:30,  1.67s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:00<01:25,  1.62s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:01<01:28,  1.71s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:03<01:27,  1.72s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:06<01:36,  1.92s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:09<01:53,  2.31s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:12<02:01,  2.52s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:14<01:58,  2.51s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:19<02:21,  3.09s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:23<02:37,  3.50s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:27<02:44,  3.73s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:32<02:46,  3.87s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:36<02:51,  4.08s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:41<02:51,  4.18s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:46<02:56,  4.42s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:50<02:52,  4.42s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:54<02:43,  4.30s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:59<02:46,  4.51s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [02:03<02:34,  4.28s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [02:07<02:25,  4.17s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [02:11<02:24,  4.24s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [02:15<02:16,  4.13s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [02:19<02:14,  4.19s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:23<02:07,  4.12s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:27<02:00,  4.01s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:31<01:58,  4.10s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:36<01:56,  4.16s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:40<01:50,  4.09s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:43<01:43,  3.99s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:47<01:38,  3.94s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:51<01:35,  3.98s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:55<01:29,  3.91s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:59<01:24,  3.86s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [03:03<01:21,  3.89s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [03:07<01:18,  3.92s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [03:10<01:13,  3.86s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [03:14<01:07,  3.76s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [03:17<00:59,  3.51s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [03:19<00:51,  3.24s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [03:22<00:45,  3.06s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [03:25<00:40,  2.88s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [03:27<00:35,  2.77s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [03:30<00:32,  2.74s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [03:32<00:28,  2.62s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [03:34<00:24,  2.48s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [03:37<00:22,  2.47s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [03:39<00:19,  2.42s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [03:41<00:16,  2.42s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [03:44<00:14,  2.43s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [03:46<00:12,  2.41s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [03:49<00:09,  2.45s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [03:51<00:07,  2.41s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [03:53<00:04,  2.39s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [03:56<00:02,  2.42s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:58<00:00,  2.38s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:58<00:00,  2.39s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.37094
wandb: 
wandb: üöÄ View run ancient-sweep-306 at: https://wandb.ai/xzy11632/dance-dev/runs/vazstcol
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_043549-vazstcol/logs
wandb: Agent Starting Run: sc6nx3wb with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_044108-sc6nx3wb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dandy-sweep-307
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/sc6nx3wb
[INFO][2024-03-18 04:41:14,188][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 04:41:14,295][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 04:41:14,296][dance][wrapped_func] Took 0:00:00.107703 to load and process data.
[INFO][2024-03-18 04:41:14,296][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 04:41:14,299][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
[INFO][2024-03-18 04:41:21,730][dance.WeightedFeaturePCA][__call__] Decomposing train features (5917, 159) (k=76)
[INFO][2024-03-18 04:41:21,730][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.13%
[INFO][2024-03-18 04:46:01,167][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 04:46:01,169][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 04:46:01,169][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 04:46:01,169][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:35,  1.04it/s]  2%|‚ñè         | 2/100 [00:01<01:34,  1.04it/s]  3%|‚ñé         | 3/100 [00:02<01:35,  1.01it/s]  4%|‚ñç         | 4/100 [00:03<01:33,  1.03it/s]  5%|‚ñå         | 5/100 [00:04<01:35,  1.00s/it]  6%|‚ñå         | 6/100 [00:06<01:36,  1.03s/it]  7%|‚ñã         | 7/100 [00:06<01:33,  1.00s/it]  8%|‚ñä         | 8/100 [00:07<01:31,  1.01it/s]  9%|‚ñâ         | 9/100 [00:08<01:29,  1.02it/s] 10%|‚ñà         | 10/100 [00:09<01:29,  1.00it/s] 11%|‚ñà         | 11/100 [00:10<01:28,  1.01it/s] 12%|‚ñà‚ñè        | 12/100 [00:11<01:28,  1.01s/it] 13%|‚ñà‚ñé        | 13/100 [00:12<01:27,  1.01s/it] 14%|‚ñà‚ñç        | 14/100 [00:13<01:26,  1.00s/it] 15%|‚ñà‚ñå        | 15/100 [00:14<01:24,  1.01it/s] 16%|‚ñà‚ñå        | 16/100 [00:15<01:21,  1.03it/s] 17%|‚ñà‚ñã        | 17/100 [00:16<01:20,  1.04it/s] 18%|‚ñà‚ñä        | 18/100 [00:17<01:18,  1.05it/s] 19%|‚ñà‚ñâ        | 19/100 [00:18<01:18,  1.03it/s] 20%|‚ñà‚ñà        | 20/100 [00:19<01:19,  1.00it/s] 21%|‚ñà‚ñà        | 21/100 [00:20<01:19,  1.00s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:21<01:17,  1.00it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:22<01:16,  1.00it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:23<01:16,  1.01s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:24<01:15,  1.01s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:25<01:14,  1.00s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:26<01:12,  1.01it/s] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:27<01:11,  1.01it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:28<01:09,  1.02it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:29<01:08,  1.02it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:30<01:07,  1.02it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:31<01:04,  1.05it/s] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:32<01:04,  1.04it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:33<01:04,  1.02it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:34<01:04,  1.01it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:35<01:04,  1.01s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:36<01:03,  1.01s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:37<01:02,  1.01s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:38<01:01,  1.01s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:39<01:01,  1.03s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:40<00:59,  1.00s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:41<00:57,  1.00it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:42<00:57,  1.00s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:43<00:55,  1.01it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:44<00:52,  1.05it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:45<00:53,  1.02it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:46<00:53,  1.01s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:47<00:51,  1.01it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:48<00:49,  1.03it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:49<00:49,  1.00it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:50<00:45,  1.08it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:51<00:42,  1.13it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:51<00:39,  1.18it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:52<00:40,  1.14it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:53<00:38,  1.18it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:54<00:37,  1.18it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [00:55<00:36,  1.18it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [00:56<00:34,  1.20it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [00:57<00:35,  1.17it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [00:57<00:33,  1.18it/s] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [00:58<00:33,  1.16it/s] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [00:59<00:32,  1.15it/s] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:00<00:32,  1.15it/s] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:01<00:30,  1.17it/s] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:02<00:29,  1.17it/s] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:03<00:28,  1.19it/s] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:03<00:27,  1.18it/s] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:04<00:26,  1.19it/s] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:05<00:25,  1.22it/s] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:06<00:24,  1.24it/s] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:07<00:23,  1.21it/s] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:08<00:23,  1.18it/s] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:08<00:22,  1.22it/s] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:09<00:21,  1.23it/s] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:10<00:20,  1.23it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:11<00:20,  1.17it/s] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:12<00:21,  1.09it/s] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:13<00:19,  1.10it/s] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:14<00:18,  1.12it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:14<00:16,  1.18it/s] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:15<00:16,  1.17it/s] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:16<00:15,  1.18it/s] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:17<00:14,  1.15it/s] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:18<00:14,  1.13it/s] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:19<00:12,  1.19it/s] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:19<00:11,  1.20it/s] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:20<00:10,  1.19it/s] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:21<00:10,  1.19it/s] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:22<00:09,  1.22it/s] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:23<00:08,  1.18it/s] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:24<00:07,  1.16it/s] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:25<00:06,  1.16it/s] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:26<00:06,  1.13it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:26<00:05,  1.14it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:27<00:04,  1.18it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:28<00:03,  1.21it/s] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:29<00:02,  1.20it/s] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:30<00:01,  1.22it/s] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:30<00:00,  1.26it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:31<00:00,  1.26it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:31<00:00,  1.09it/s]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.32168
wandb: 
wandb: üöÄ View run dandy-sweep-307 at: https://wandb.ai/xzy11632/dance-dev/runs/sc6nx3wb
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_044108-sc6nx3wb/logs
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 6lthu674 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_044840-6lthu674
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run golden-sweep-308
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/6lthu674
[INFO][2024-03-18 04:48:44,830][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 04:48:44,918][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 04:48:44,918][dance][wrapped_func] Took 0:00:00.087629 to load and process data.
[INFO][2024-03-18 04:48:44,918][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 04:48:44,920][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
[INFO][2024-03-18 04:48:46,959][dance.WeightedFeatureSVD][__call__] Decomposing train features (5917, 159) (k=80)
[INFO][2024-03-18 04:48:46,959][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.68%
[INFO][2024-03-18 04:48:48,580][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 04:48:48,580][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 04:48:48,580][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 04:48:48,580][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:22,  1.19it/s]  2%|‚ñè         | 2/100 [00:01<01:27,  1.12it/s]  3%|‚ñé         | 3/100 [00:02<01:32,  1.05it/s]  4%|‚ñç         | 4/100 [00:03<01:35,  1.00it/s]  5%|‚ñå         | 5/100 [00:04<01:39,  1.04s/it]  6%|‚ñå         | 6/100 [00:06<01:38,  1.05s/it]  7%|‚ñã         | 7/100 [00:07<01:35,  1.03s/it]  8%|‚ñä         | 8/100 [00:08<01:33,  1.01s/it]  9%|‚ñâ         | 9/100 [00:08<01:25,  1.07it/s] 10%|‚ñà         | 10/100 [00:09<01:21,  1.11it/s] 11%|‚ñà         | 11/100 [00:10<01:16,  1.16it/s] 12%|‚ñà‚ñè        | 12/100 [00:11<01:15,  1.17it/s] 13%|‚ñà‚ñé        | 13/100 [00:11<01:12,  1.20it/s] 14%|‚ñà‚ñç        | 14/100 [00:12<01:09,  1.24it/s] 15%|‚ñà‚ñå        | 15/100 [00:13<01:08,  1.25it/s] 16%|‚ñà‚ñå        | 16/100 [00:14<01:06,  1.26it/s] 17%|‚ñà‚ñã        | 17/100 [00:15<01:03,  1.30it/s] 18%|‚ñà‚ñä        | 18/100 [00:15<01:02,  1.31it/s] 19%|‚ñà‚ñâ        | 19/100 [00:16<01:01,  1.33it/s] 20%|‚ñà‚ñà        | 20/100 [00:17<01:02,  1.27it/s] 21%|‚ñà‚ñà        | 21/100 [00:18<01:02,  1.26it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:18<01:01,  1.26it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:19<01:01,  1.24it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:20<01:02,  1.22it/s] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:21<01:01,  1.22it/s] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:22<00:58,  1.26it/s] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:23<00:58,  1.26it/s] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:23<00:56,  1.28it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:24<00:55,  1.29it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:25<00:53,  1.30it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:26<00:52,  1.30it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:26<00:52,  1.29it/s] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:27<00:53,  1.25it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:28<00:53,  1.23it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:29<00:52,  1.24it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:30<00:50,  1.26it/s] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:30<00:48,  1.30it/s] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:31<00:47,  1.30it/s] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:32<00:47,  1.30it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:33<00:47,  1.27it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:33<00:46,  1.26it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:34<00:46,  1.26it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:35<00:45,  1.26it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:36<00:44,  1.26it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:37<00:42,  1.28it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:37<00:43,  1.24it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:38<00:41,  1.28it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:39<00:41,  1.24it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:40<00:42,  1.21it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:41<00:43,  1.16it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:42<00:40,  1.21it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:42<00:39,  1.22it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:43<00:37,  1.24it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:44<00:35,  1.29it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:45<00:34,  1.29it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:45<00:33,  1.31it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [00:46<00:32,  1.31it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [00:47<00:34,  1.21it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [00:48<00:32,  1.24it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [00:49<00:34,  1.18it/s] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [00:50<00:34,  1.15it/s] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [00:51<00:32,  1.15it/s] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [00:51<00:30,  1.20it/s] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [00:52<00:31,  1.15it/s] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [00:54<00:35,  1.03s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [00:55<00:37,  1.11s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [00:56<00:39,  1.21s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [00:58<00:41,  1.28s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [00:59<00:38,  1.25s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:00<00:37,  1.25s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:02<00:37,  1.31s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:03<00:34,  1.24s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:04<00:33,  1.24s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:05<00:32,  1.24s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:06<00:29,  1.20s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:08<00:29,  1.23s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:09<00:28,  1.24s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:10<00:27,  1.26s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:12<00:27,  1.29s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:13<00:26,  1.32s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:14<00:25,  1.33s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:16<00:23,  1.28s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:17<00:23,  1.38s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:19<00:22,  1.41s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:20<00:21,  1.46s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:22<00:20,  1.46s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:23<00:19,  1.51s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:25<00:17,  1.48s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:26<00:16,  1.51s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:28<00:14,  1.46s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:29<00:13,  1.45s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:30<00:11,  1.42s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:32<00:09,  1.39s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:33<00:08,  1.37s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:35<00:06,  1.39s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:36<00:05,  1.35s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:37<00:04,  1.33s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:39<00:02,  1.36s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:40<00:01,  1.40s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:42<00:00,  1.43s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:42<00:00,  1.02s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.32999
wandb: 
wandb: üöÄ View run golden-sweep-308 at: https://wandb.ai/xzy11632/dance-dev/runs/6lthu674
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_044840-6lthu674/logs
wandb: Agent Starting Run: q3vdm0x7 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_045146-q3vdm0x7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run zesty-sweep-309
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/q3vdm0x7
[INFO][2024-03-18 04:51:51,884][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 04:51:51,981][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 04:51:51,981][dance][wrapped_func] Took 0:00:00.095970 to load and process data.
[INFO][2024-03-18 04:51:51,981][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 04:51:51,984][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[INFO][2024-03-18 04:51:52,740][dance.WeightedFeaturePCA][__call__] Decomposing train features (5917, 200) (k=85)
[INFO][2024-03-18 04:51:52,743][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.12%
[INFO][2024-03-18 04:51:54,643][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 04:51:54,644][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 04:51:54,644][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 04:51:54,644][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:16,  1.29it/s]  2%|‚ñè         | 2/100 [00:01<01:14,  1.32it/s]  3%|‚ñé         | 3/100 [00:02<01:12,  1.33it/s]  4%|‚ñç         | 4/100 [00:03<01:12,  1.32it/s]  5%|‚ñå         | 5/100 [00:03<01:12,  1.31it/s]  6%|‚ñå         | 6/100 [00:04<01:13,  1.28it/s]  7%|‚ñã         | 7/100 [00:05<01:13,  1.26it/s]  8%|‚ñä         | 8/100 [00:06<01:16,  1.20it/s]  9%|‚ñâ         | 9/100 [00:07<01:14,  1.22it/s] 10%|‚ñà         | 10/100 [00:07<01:14,  1.21it/s] 11%|‚ñà         | 11/100 [00:08<01:14,  1.20it/s] 12%|‚ñà‚ñè        | 12/100 [00:09<01:12,  1.22it/s] 13%|‚ñà‚ñé        | 13/100 [00:10<01:10,  1.24it/s] 14%|‚ñà‚ñç        | 14/100 [00:11<01:12,  1.18it/s] 15%|‚ñà‚ñå        | 15/100 [00:12<01:11,  1.19it/s] 16%|‚ñà‚ñå        | 16/100 [00:13<01:10,  1.19it/s] 17%|‚ñà‚ñã        | 17/100 [00:13<01:09,  1.19it/s] 18%|‚ñà‚ñä        | 18/100 [00:14<01:07,  1.22it/s] 19%|‚ñà‚ñâ        | 19/100 [00:15<01:06,  1.22it/s] 20%|‚ñà‚ñà        | 20/100 [00:16<01:06,  1.21it/s] 21%|‚ñà‚ñà        | 21/100 [00:17<01:04,  1.22it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:17<01:02,  1.25it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:18<01:01,  1.25it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:19<01:01,  1.24it/s] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:20<00:59,  1.26it/s] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:20<00:58,  1.27it/s] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:21<00:58,  1.25it/s] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:22<00:55,  1.31it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:23<00:53,  1.34it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:23<00:52,  1.33it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:24<00:55,  1.25it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:25<00:55,  1.24it/s] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:26<00:52,  1.27it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:27<00:50,  1.30it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:27<00:49,  1.31it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:28<00:49,  1.31it/s] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:29<00:49,  1.26it/s] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:30<00:51,  1.20it/s] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:31<00:51,  1.18it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:32<00:51,  1.16it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:33<00:51,  1.14it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:34<00:52,  1.10it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:35<00:50,  1.12it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:35<00:49,  1.13it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:36<00:49,  1.10it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:37<00:52,  1.02it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:39<00:56,  1.06s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:40<00:56,  1.09s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:41<00:55,  1.09s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:42<00:54,  1.08s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:43<00:53,  1.09s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:44<00:53,  1.11s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:45<00:52,  1.13s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:47<00:51,  1.13s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:48<00:53,  1.19s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:49<00:54,  1.24s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [00:51<00:55,  1.29s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [00:52<00:51,  1.22s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [00:53<00:50,  1.23s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [00:54<00:48,  1.22s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [00:55<00:45,  1.16s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [00:56<00:42,  1.11s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [00:57<00:41,  1.12s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [00:59<00:40,  1.12s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:00<00:38,  1.11s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:01<00:37,  1.10s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:02<00:34,  1.05s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:03<00:32,  1.03s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:03<00:30,  1.02it/s] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:04<00:29,  1.03it/s] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:05<00:27,  1.05it/s] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:06<00:25,  1.10it/s] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:07<00:23,  1.16it/s] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:08<00:21,  1.19it/s] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:09<00:21,  1.17it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:09<00:20,  1.17it/s] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:10<00:20,  1.11it/s] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:11<00:19,  1.15it/s] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:12<00:18,  1.15it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:13<00:17,  1.17it/s] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:14<00:15,  1.23it/s] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:14<00:14,  1.23it/s] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:15<00:13,  1.25it/s] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:16<00:12,  1.25it/s] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:17<00:12,  1.20it/s] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:18<00:11,  1.17it/s] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:19<00:11,  1.15it/s] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:20<00:10,  1.15it/s] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:20<00:09,  1.17it/s] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:21<00:08,  1.16it/s] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:22<00:08,  1.07it/s] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:24<00:08,  1.01s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:25<00:07,  1.06s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:26<00:06,  1.05s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:27<00:05,  1.02s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:28<00:04,  1.05s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:29<00:03,  1.05s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:30<00:02,  1.08s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:31<00:01,  1.04s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:32<00:00,  1.06it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:32<00:00,  1.08it/s]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.25702
wandb: 
wandb: üöÄ View run zesty-sweep-309 at: https://wandb.ai/xzy11632/dance-dev/runs/q3vdm0x7
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_045146-q3vdm0x7/logs
wandb: Agent Starting Run: q8mynf9i with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_045408-q8mynf9i
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sparkling-sweep-310
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/q8mynf9i
[INFO][2024-03-18 04:54:12,628][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 04:54:12,715][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 04:54:12,716][dance][wrapped_func] Took 0:00:00.087486 to load and process data.
[INFO][2024-03-18 04:54:12,716][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 04:54:12,718][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'Log1P',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[INFO][2024-03-18 04:54:15,120][dance.WeightedFeatureSVD][__call__] Decomposing train features (5917, 200) (k=106)
[INFO][2024-03-18 04:54:15,125][dance.WeightedFeatureSVD][__call__] Total explained variance: 92.68%
[INFO][2024-03-18 05:00:40,463][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 05:00:40,465][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 05:00:40,465][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 05:00:40,465][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:02<03:43,  2.26s/it]  2%|‚ñè         | 2/100 [00:04<03:32,  2.17s/it]  3%|‚ñé         | 3/100 [00:06<03:31,  2.18s/it]  4%|‚ñç         | 4/100 [00:08<03:21,  2.10s/it]  5%|‚ñå         | 5/100 [00:10<03:18,  2.09s/it]  6%|‚ñå         | 6/100 [00:12<03:13,  2.06s/it]  7%|‚ñã         | 7/100 [00:14<03:06,  2.00s/it]  8%|‚ñä         | 8/100 [00:16<03:07,  2.04s/it]  9%|‚ñâ         | 9/100 [00:18<03:04,  2.03s/it] 10%|‚ñà         | 10/100 [00:20<03:02,  2.03s/it] 11%|‚ñà         | 11/100 [00:22<02:59,  2.02s/it] 12%|‚ñà‚ñè        | 12/100 [00:24<03:01,  2.06s/it] 13%|‚ñà‚ñé        | 13/100 [00:26<03:01,  2.09s/it] 14%|‚ñà‚ñç        | 14/100 [00:29<03:01,  2.11s/it] 15%|‚ñà‚ñå        | 15/100 [00:30<02:45,  1.95s/it] 16%|‚ñà‚ñå        | 16/100 [00:32<02:32,  1.81s/it] 17%|‚ñà‚ñã        | 17/100 [00:33<02:22,  1.71s/it] 18%|‚ñà‚ñä        | 18/100 [00:35<02:15,  1.65s/it] 19%|‚ñà‚ñâ        | 19/100 [00:36<02:10,  1.61s/it] 20%|‚ñà‚ñà        | 20/100 [00:38<02:03,  1.54s/it] 21%|‚ñà‚ñà        | 21/100 [00:39<01:58,  1.50s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:40<01:51,  1.43s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:41<01:44,  1.36s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:43<01:42,  1.34s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:44<01:37,  1.30s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:45<01:33,  1.27s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:46<01:30,  1.24s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:47<01:26,  1.20s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:49<01:25,  1.20s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:50<01:26,  1.23s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:51<01:24,  1.23s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:52<01:23,  1.22s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:54<01:20,  1.21s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:55<01:19,  1.21s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:56<01:17,  1.20s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:57<01:17,  1.21s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:58<01:14,  1.19s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:59<01:12,  1.17s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:00<01:09,  1.14s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:02<01:09,  1.16s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:03<01:08,  1.16s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:04<01:05,  1.13s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:05<01:06,  1.17s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:07<01:08,  1.22s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:08<01:09,  1.26s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:09<01:07,  1.26s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:10<01:06,  1.26s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:12<01:03,  1.22s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:13<00:59,  1.16s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:14<00:58,  1.16s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:15<00:55,  1.13s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:16<00:52,  1.10s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:17<00:51,  1.10s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:18<00:49,  1.08s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:19<00:47,  1.07s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:20<00:46,  1.06s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:21<00:45,  1.07s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:22<00:44,  1.06s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:23<00:44,  1.08s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:24<00:42,  1.07s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:25<00:42,  1.08s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:26<00:41,  1.09s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:28<00:40,  1.08s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:29<00:39,  1.09s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:30<00:38,  1.10s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:31<00:38,  1.13s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:32<00:38,  1.17s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:34<00:47,  1.49s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:37<00:53,  1.72s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:39<00:59,  1.97s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:41<00:57,  1.99s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:43<00:52,  1.86s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:44<00:47,  1.77s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:46<00:43,  1.68s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:48<00:42,  1.70s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:49<00:37,  1.55s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:50<00:33,  1.45s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:51<00:29,  1.36s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:53<00:27,  1.33s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:54<00:25,  1.29s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:55<00:24,  1.27s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:56<00:22,  1.27s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:57<00:21,  1.26s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:59<00:19,  1.23s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:00<00:18,  1.23s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:01<00:17,  1.22s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:02<00:15,  1.19s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:03<00:14,  1.18s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:04<00:12,  1.17s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:06<00:11,  1.19s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:07<00:10,  1.16s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:08<00:09,  1.17s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:09<00:08,  1.20s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:10<00:07,  1.22s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:11<00:05,  1.15s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:12<00:04,  1.11s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:14<00:03,  1.10s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:15<00:02,  1.06s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:16<00:01,  1.05s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:17<00:00,  1.03s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:17<00:00,  1.37s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.25767
wandb: 
wandb: üöÄ View run sparkling-sweep-310 at: https://wandb.ai/xzy11632/dance-dev/runs/q8mynf9i
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_045408-q8mynf9i/logs
wandb: Agent Starting Run: 4hb7yclo with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_050334-4hb7yclo
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dark-sweep-311
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/4hb7yclo
[INFO][2024-03-18 05:03:41,906][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 05:03:42,029][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 05:03:42,030][dance][wrapped_func] Took 0:00:00.123843 to load and process data.
[INFO][2024-03-18 05:03:42,031][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 05:03:42,034][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-18 05:03:43,574][dance.WeightedFeaturePCA][__call__] Decomposing train features (5917, 200) (k=75)
[INFO][2024-03-18 05:03:43,575][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.11%
[INFO][2024-03-18 05:03:49,796][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 05:03:49,797][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 05:03:49,797][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 05:03:49,797][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:21,  1.22it/s]  2%|‚ñè         | 2/100 [00:01<01:16,  1.28it/s]  3%|‚ñé         | 3/100 [00:02<01:17,  1.25it/s]  4%|‚ñç         | 4/100 [00:03<01:18,  1.23it/s]  5%|‚ñå         | 5/100 [00:04<01:17,  1.23it/s]  6%|‚ñå         | 6/100 [00:04<01:15,  1.25it/s]  7%|‚ñã         | 7/100 [00:05<01:16,  1.21it/s]  8%|‚ñä         | 8/100 [00:06<01:15,  1.21it/s]  9%|‚ñâ         | 9/100 [00:07<01:15,  1.21it/s] 10%|‚ñà         | 10/100 [00:08<01:11,  1.26it/s] 11%|‚ñà         | 11/100 [00:08<01:11,  1.25it/s] 12%|‚ñà‚ñè        | 12/100 [00:09<01:09,  1.27it/s] 13%|‚ñà‚ñé        | 13/100 [00:10<01:06,  1.31it/s] 14%|‚ñà‚ñç        | 14/100 [00:11<01:05,  1.32it/s] 15%|‚ñà‚ñå        | 15/100 [00:11<01:04,  1.31it/s] 16%|‚ñà‚ñå        | 16/100 [00:12<01:06,  1.26it/s] 17%|‚ñà‚ñã        | 17/100 [00:13<01:09,  1.20it/s] 18%|‚ñà‚ñä        | 18/100 [00:14<01:06,  1.23it/s] 19%|‚ñà‚ñâ        | 19/100 [00:15<01:04,  1.25it/s] 20%|‚ñà‚ñà        | 20/100 [00:15<01:03,  1.25it/s] 21%|‚ñà‚ñà        | 21/100 [00:16<01:04,  1.22it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:17<01:05,  1.20it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:18<01:05,  1.17it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:19<01:05,  1.17it/s] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:20<01:05,  1.14it/s] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:21<01:03,  1.17it/s] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:22<01:02,  1.16it/s] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:22<01:01,  1.16it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:23<01:02,  1.14it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:24<01:04,  1.09it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:26<01:19,  1.15s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:28<01:27,  1.28s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:29<01:28,  1.32s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:30<01:27,  1.33s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:32<01:29,  1.38s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:33<01:27,  1.37s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:35<01:24,  1.34s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:36<01:25,  1.39s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:37<01:24,  1.39s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:39<01:23,  1.38s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:40<01:20,  1.36s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:41<01:15,  1.30s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:42<01:10,  1.24s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:44<01:08,  1.22s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:45<01:13,  1.33s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:46<01:10,  1.30s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:48<01:06,  1.25s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:49<01:04,  1.24s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:50<01:02,  1.22s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:51<01:01,  1.24s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:52<00:58,  1.20s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:53<00:57,  1.20s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:55<00:57,  1.22s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:56<01:00,  1.33s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:58<01:04,  1.43s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:59<01:01,  1.40s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:01<01:01,  1.44s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:02<00:57,  1.37s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:03<00:55,  1.35s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:04<00:50,  1.26s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:06<00:49,  1.26s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:07<00:48,  1.27s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:08<00:47,  1.29s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:10<00:46,  1.29s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:11<00:47,  1.35s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:12<00:46,  1.36s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:14<00:43,  1.33s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:15<00:42,  1.32s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:16<00:40,  1.31s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:18<00:38,  1.29s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:19<00:38,  1.32s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:20<00:37,  1.34s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:22<00:36,  1.34s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:23<00:35,  1.38s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:25<00:34,  1.38s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:26<00:33,  1.38s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:27<00:31,  1.36s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:29<00:29,  1.35s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:30<00:27,  1.29s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:31<00:23,  1.20s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:32<00:22,  1.18s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:33<00:21,  1.20s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:34<00:19,  1.17s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:35<00:18,  1.15s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:36<00:17,  1.13s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:38<00:16,  1.16s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:39<00:14,  1.10s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:40<00:13,  1.09s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:41<00:11,  1.07s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:42<00:10,  1.04s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:42<00:08,  1.02it/s] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:43<00:07,  1.08it/s] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:44<00:06,  1.12it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:45<00:05,  1.16it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:46<00:04,  1.18it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:46<00:03,  1.21it/s] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:47<00:02,  1.18it/s] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:48<00:01,  1.16it/s] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:49<00:00,  1.10it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:50<00:00,  1.11it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:50<00:00,  1.11s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.24298
wandb: 
wandb: üöÄ View run dark-sweep-311 at: https://wandb.ai/xzy11632/dance-dev/runs/4hb7yclo
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_050334-4hb7yclo/logs
wandb: Agent Starting Run: 70z6tw6s with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: Log1P
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_050622-70z6tw6s
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run peach-sweep-312
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/70z6tw6s
[INFO][2024-03-18 05:06:29,377][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 05:06:29,513][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 05:06:29,514][dance][wrapped_func] Took 0:00:00.136570 to load and process data.
[INFO][2024-03-18 05:06:29,515][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 05:06:29,518][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'Log1P',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-18 05:06:47,900][dance.WeightedFeatureSVD][__call__] Decomposing train features (5917, 200) (k=107)
[INFO][2024-03-18 05:06:47,934][dance.WeightedFeatureSVD][__call__] Total explained variance: 93.59%
[INFO][2024-03-18 05:12:13,554][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 05:12:13,555][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 05:12:13,556][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 05:12:13,556][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:07,  1.29s/it]  2%|‚ñè         | 2/100 [00:02<02:15,  1.38s/it]  3%|‚ñé         | 3/100 [00:04<02:13,  1.38s/it]  4%|‚ñç         | 4/100 [00:05<02:17,  1.43s/it]  5%|‚ñå         | 5/100 [00:06<02:12,  1.39s/it]  6%|‚ñå         | 6/100 [00:07<01:57,  1.25s/it]  7%|‚ñã         | 7/100 [00:08<01:45,  1.13s/it]  8%|‚ñä         | 8/100 [00:09<01:40,  1.10s/it]  9%|‚ñâ         | 9/100 [00:10<01:37,  1.07s/it] 10%|‚ñà         | 10/100 [00:11<01:32,  1.03s/it] 11%|‚ñà         | 11/100 [00:12<01:36,  1.08s/it] 12%|‚ñà‚ñè        | 12/100 [00:13<01:33,  1.06s/it] 13%|‚ñà‚ñé        | 13/100 [00:14<01:29,  1.03s/it] 14%|‚ñà‚ñç        | 14/100 [00:15<01:28,  1.02s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<02:00,  1.42s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<02:26,  1.74s/it] 17%|‚ñà‚ñã        | 17/100 [00:22<02:34,  1.86s/it] 18%|‚ñà‚ñä        | 18/100 [00:24<02:37,  1.92s/it] 19%|‚ñà‚ñâ        | 19/100 [00:26<02:33,  1.89s/it] 20%|‚ñà‚ñà        | 20/100 [00:29<02:39,  1.99s/it] 21%|‚ñà‚ñà        | 21/100 [00:31<02:40,  2.03s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:32<02:28,  1.91s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:34<02:18,  1.80s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:35<02:07,  1.68s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:36<01:55,  1.54s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:38<01:45,  1.43s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:39<01:37,  1.34s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:40<01:33,  1.29s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:41<01:28,  1.25s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:42<01:24,  1.20s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:43<01:20,  1.17s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:44<01:17,  1.15s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:45<01:16,  1.14s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:47<01:14,  1.14s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:48<01:14,  1.15s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:49<01:14,  1.16s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:50<01:14,  1.18s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:51<01:12,  1.18s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:53<01:11,  1.18s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:54<01:10,  1.17s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:55<01:09,  1.18s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:56<01:07,  1.16s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:57<01:08,  1.20s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:59<01:08,  1.22s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:00<01:03,  1.15s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:01<01:02,  1.15s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:02<01:03,  1.20s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:03<01:02,  1.20s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:04<01:02,  1.22s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:06<00:58,  1.17s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:07<00:54,  1.11s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:07<00:51,  1.07s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:09<00:49,  1.05s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:09<00:47,  1.03s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:11<00:46,  1.04s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:12<00:46,  1.07s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:13<00:46,  1.07s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:14<00:43,  1.04s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:15<00:41,  1.01s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:16<00:40,  1.01s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:17<00:40,  1.03s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:18<00:40,  1.05s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:19<00:38,  1.05s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:20<00:37,  1.05s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:21<00:35,  1.02s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:22<00:34,  1.02s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:23<00:33,  1.01s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:24<00:33,  1.05s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:25<00:33,  1.09s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:28<00:44,  1.48s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:30<00:49,  1.72s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:32<00:50,  1.81s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:34<00:52,  1.93s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:37<00:53,  2.07s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:38<00:49,  2.00s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:40<00:44,  1.87s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:42<00:40,  1.78s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:43<00:38,  1.74s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:45<00:35,  1.68s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:46<00:34,  1.70s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:48<00:32,  1.72s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:50<00:29,  1.63s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:51<00:26,  1.54s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:52<00:23,  1.46s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:53<00:19,  1.33s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:54<00:17,  1.23s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:55<00:15,  1.15s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:56<00:13,  1.11s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:57<00:12,  1.13s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:58<00:10,  1.08s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:59<00:09,  1.04s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:00<00:08,  1.00s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:01<00:06,  1.02it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:02<00:06,  1.01s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:03<00:05,  1.00s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:04<00:03,  1.01it/s] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:05<00:03,  1.01s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:06<00:02,  1.00s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:07<00:01,  1.00s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:08<00:00,  1.01s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:08<00:00,  1.29s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.24779
wandb: 
wandb: üöÄ View run peach-sweep-312 at: https://wandb.ai/xzy11632/dance-dev/runs/70z6tw6s
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_050622-70z6tw6s/logs
wandb: Agent Starting Run: 8dr1ge7r with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_051513-8dr1ge7r
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ethereal-sweep-313
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/8dr1ge7r
[INFO][2024-03-18 05:15:18,688][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 05:15:18,776][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 05:15:18,776][dance][wrapped_func] Took 0:00:00.087220 to load and process data.
[INFO][2024-03-18 05:15:18,776][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 05:15:18,778][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 05:15:18,796][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 05:15:18,796][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 05:15:18,962][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 05:15:18,962][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 05:15:20,013][dance.WeightedFeaturePCA][__call__] Decomposing train features (5917, 919) (k=11)
[INFO][2024-03-18 05:15:20,014][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.01%
[INFO][2024-03-18 05:15:21,638][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 05:15:21,638][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 05:15:21,639][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 05:15:21,639][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:02<03:35,  2.18s/it]  2%|‚ñè         | 2/100 [00:04<03:42,  2.27s/it]  3%|‚ñé         | 3/100 [00:06<03:31,  2.18s/it]  4%|‚ñç         | 4/100 [00:08<03:24,  2.14s/it]  5%|‚ñå         | 5/100 [00:10<03:26,  2.17s/it]  6%|‚ñå         | 6/100 [00:12<03:21,  2.14s/it]  7%|‚ñã         | 7/100 [00:14<03:00,  1.95s/it]  8%|‚ñä         | 8/100 [00:15<02:39,  1.73s/it]  9%|‚ñâ         | 9/100 [00:16<02:17,  1.51s/it] 10%|‚ñà         | 10/100 [00:17<02:04,  1.38s/it] 11%|‚ñà         | 11/100 [00:18<01:54,  1.29s/it] 12%|‚ñà‚ñè        | 12/100 [00:20<01:49,  1.24s/it] 13%|‚ñà‚ñé        | 13/100 [00:21<01:39,  1.15s/it] 14%|‚ñà‚ñç        | 14/100 [00:22<01:38,  1.14s/it] 15%|‚ñà‚ñå        | 15/100 [00:23<01:32,  1.09s/it] 16%|‚ñà‚ñå        | 16/100 [00:24<01:30,  1.07s/it] 17%|‚ñà‚ñã        | 17/100 [00:25<01:28,  1.06s/it] 18%|‚ñà‚ñä        | 18/100 [00:26<01:27,  1.06s/it] 19%|‚ñà‚ñâ        | 19/100 [00:27<01:27,  1.08s/it] 20%|‚ñà‚ñà        | 20/100 [00:28<01:26,  1.08s/it] 21%|‚ñà‚ñà        | 21/100 [00:29<01:26,  1.09s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:30<01:23,  1.07s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:31<01:21,  1.06s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:32<01:21,  1.07s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:33<01:18,  1.05s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:34<01:18,  1.06s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:35<01:15,  1.03s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:36<01:14,  1.04s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:37<01:12,  1.03s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:39<01:34,  1.36s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:42<01:52,  1.64s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:44<02:05,  1.85s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:46<02:08,  1.92s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:48<02:10,  1.98s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:51<02:14,  2.08s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:53<02:12,  2.07s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:55<02:10,  2.08s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:57<02:11,  2.12s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:59<02:03,  2.03s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:01<01:56,  1.94s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:03<01:56,  1.97s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:04<01:50,  1.91s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:06<01:48,  1.90s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:08<01:48,  1.94s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:10<01:44,  1.91s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:12<01:41,  1.89s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:14<01:36,  1.82s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:15<01:27,  1.69s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:16<01:21,  1.59s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:18<01:16,  1.53s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:19<01:08,  1.40s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:20<01:03,  1.32s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:21<01:02,  1.32s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:24<01:15,  1.64s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:26<01:27,  1.94s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:29<01:34,  2.14s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:31<01:37,  2.27s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:34<01:38,  2.34s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:36<01:32,  2.24s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:38<01:23,  2.08s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:39<01:16,  1.97s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:41<01:10,  1.84s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:43<01:05,  1.78s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:44<01:02,  1.75s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:46<01:00,  1.72s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:48<00:57,  1.69s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:49<00:55,  1.68s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:51<00:52,  1.65s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:52<00:50,  1.62s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:54<00:49,  1.64s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:55<00:45,  1.58s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:57<00:42,  1.51s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:58<00:39,  1.48s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:59<00:36,  1.39s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:01<00:34,  1.36s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:02<00:31,  1.30s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:03<00:29,  1.27s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:04<00:28,  1.29s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:06<00:27,  1.31s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:07<00:26,  1.32s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:08<00:24,  1.28s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:10<00:22,  1.28s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:11<00:21,  1.27s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:12<00:20,  1.26s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:13<00:18,  1.27s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:15<00:18,  1.34s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:16<00:16,  1.29s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:17<00:14,  1.21s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:18<00:12,  1.17s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:19<00:11,  1.12s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:20<00:10,  1.12s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:21<00:08,  1.10s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:22<00:07,  1.11s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:23<00:06,  1.10s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:24<00:05,  1.07s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:25<00:04,  1.03s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:27<00:03,  1.08s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:28<00:02,  1.07s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:29<00:01,  1.07s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:30<00:00,  1.08s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:30<00:00,  1.50s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.026 MB uploadedwandb: - 0.026 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.20473
wandb: 
wandb: üöÄ View run ethereal-sweep-313 at: https://wandb.ai/xzy11632/dance-dev/runs/8dr1ge7r
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_051513-8dr1ge7r/logs
wandb: Agent Starting Run: ozi6eyk8 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_051836-ozi6eyk8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run genial-sweep-314
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ozi6eyk8
[INFO][2024-03-18 05:18:42,105][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 05:18:42,194][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 05:18:42,194][dance][wrapped_func] Took 0:00:00.087771 to load and process data.
[INFO][2024-03-18 05:18:42,194][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 05:18:42,196][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 05:18:42,216][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 05:18:42,217][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 05:18:42,369][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 05:18:42,370][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 05:18:58,391][dance.WeightedFeatureSVD][__call__] Decomposing train features (5917, 919) (k=41)
[INFO][2024-03-18 05:18:58,394][dance.WeightedFeatureSVD][__call__] Total explained variance: 93.99%
[INFO][2024-03-18 05:19:03,787][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 05:19:03,789][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 05:19:03,789][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 05:19:03,789][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:44,  1.66s/it]  2%|‚ñè         | 2/100 [00:02<02:14,  1.38s/it]  3%|‚ñé         | 3/100 [00:04<02:04,  1.29s/it]  4%|‚ñç         | 4/100 [00:05<01:56,  1.22s/it]  5%|‚ñå         | 5/100 [00:06<01:55,  1.22s/it]  6%|‚ñå         | 6/100 [00:07<01:48,  1.16s/it]  7%|‚ñã         | 7/100 [00:08<01:46,  1.15s/it]  8%|‚ñä         | 8/100 [00:09<01:46,  1.16s/it]  9%|‚ñâ         | 9/100 [00:10<01:46,  1.18s/it] 10%|‚ñà         | 10/100 [00:11<01:38,  1.10s/it] 11%|‚ñà         | 11/100 [00:12<01:36,  1.08s/it] 12%|‚ñà‚ñè        | 12/100 [00:13<01:33,  1.06s/it] 13%|‚ñà‚ñé        | 13/100 [00:14<01:27,  1.01s/it] 14%|‚ñà‚ñç        | 14/100 [00:15<01:31,  1.07s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:30,  1.07s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<01:29,  1.06s/it] 17%|‚ñà‚ñã        | 17/100 [00:19<01:28,  1.06s/it] 18%|‚ñà‚ñä        | 18/100 [00:20<01:26,  1.06s/it] 19%|‚ñà‚ñâ        | 19/100 [00:21<01:24,  1.05s/it] 20%|‚ñà‚ñà        | 20/100 [00:22<01:22,  1.04s/it] 21%|‚ñà‚ñà        | 21/100 [00:23<01:22,  1.05s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:24<01:24,  1.08s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:25<01:27,  1.14s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:28<01:58,  1.56s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:31<02:23,  1.91s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:32<02:21,  1.91s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:34<02:21,  1.94s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:36<02:04,  1.73s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:37<01:56,  1.64s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:41<02:38,  2.26s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:45<03:08,  2.73s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:48<03:24,  3.01s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:51<03:09,  2.83s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:53<02:58,  2.70s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:55<02:44,  2.53s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:58<02:36,  2.45s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:00<02:32,  2.42s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:01<02:13,  2.16s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:03<02:02,  2.00s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:04<01:49,  1.83s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:06<01:41,  1.72s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:07<01:33,  1.61s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:09<01:29,  1.57s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:10<01:26,  1.54s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:12<01:24,  1.53s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:13<01:23,  1.55s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:15<01:21,  1.54s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:16<01:18,  1.50s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:18<01:16,  1.50s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:19<01:16,  1.54s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:21<01:11,  1.46s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:22<01:10,  1.46s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:24<01:13,  1.56s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:25<01:10,  1.53s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:27<01:06,  1.48s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:28<01:04,  1.45s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:30<01:04,  1.49s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:31<01:03,  1.51s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:33<01:02,  1.52s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:34<00:59,  1.49s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:36<00:58,  1.49s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:37<00:57,  1.50s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:39<00:55,  1.50s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:40<00:52,  1.46s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:42<00:51,  1.47s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:43<00:49,  1.47s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:45<00:49,  1.49s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:46<00:48,  1.52s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:48<00:45,  1.46s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:49<00:43,  1.44s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:50<00:41,  1.43s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:52<00:38,  1.36s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:53<00:35,  1.33s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:54<00:34,  1.33s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:56<00:34,  1.38s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:57<00:32,  1.37s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:58<00:30,  1.32s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:59<00:28,  1.31s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:01<00:28,  1.35s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:02<00:27,  1.36s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:04<00:26,  1.37s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:05<00:25,  1.40s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:07<00:23,  1.40s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:08<00:22,  1.40s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:09<00:21,  1.42s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:11<00:19,  1.40s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:12<00:17,  1.38s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:13<00:15,  1.30s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:14<00:14,  1.28s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:16<00:12,  1.28s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:17<00:11,  1.25s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:18<00:10,  1.28s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:20<00:09,  1.34s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:21<00:07,  1.31s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:22<00:06,  1.34s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:23<00:05,  1.26s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:25<00:03,  1.20s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:26<00:02,  1.13s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:27<00:01,  1.11s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:28<00:00,  1.12s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:28<00:00,  1.48s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.021 MB uploadedwandb: \ 0.013 MB of 0.026 MB uploadedwandb: | 0.013 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.24056
wandb: 
wandb: üöÄ View run genial-sweep-314 at: https://wandb.ai/xzy11632/dance-dev/runs/ozi6eyk8
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_051836-ozi6eyk8/logs
wandb: Agent Starting Run: d62e339t with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_052218-d62e339t
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run crimson-sweep-315
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/d62e339t
[INFO][2024-03-18 05:22:23,789][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 05:22:23,902][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 05:22:23,902][dance][wrapped_func] Took 0:00:00.106143 to load and process data.
[INFO][2024-03-18 05:22:23,902][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 05:22:23,905][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 05:22:23,935][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 05:22:24,133][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 05:22:24,250][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run crimson-sweep-315 at: https://wandb.ai/xzy11632/dance-dev/runs/d62e339t
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_052218-d62e339t/logs
wandb: ERROR Run d62e339t errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1081) out of bounds (919)
wandb: ERROR 
wandb: Agent Starting Run: gnx393gr with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_052235-gnx393gr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dry-sweep-316
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/gnx393gr
[INFO][2024-03-18 05:22:40,782][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 05:22:40,867][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 05:22:40,868][dance][wrapped_func] Took 0:00:00.085011 to load and process data.
[INFO][2024-03-18 05:22:40,868][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 05:22:40,869][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 05:22:40,890][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 05:22:41,056][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 05:22:41,160][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run dry-sweep-316 at: https://wandb.ai/xzy11632/dance-dev/runs/gnx393gr
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_052235-gnx393gr/logs
wandb: ERROR Run gnx393gr errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1081) out of bounds (919)
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 3oz8jovr with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_052301-3oz8jovr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run good-sweep-317
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/3oz8jovr
[INFO][2024-03-18 05:23:09,030][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 05:23:09,127][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 05:23:09,128][dance][wrapped_func] Took 0:00:00.097285 to load and process data.
[INFO][2024-03-18 05:23:09,128][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 05:23:09,130][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 05:23:09,152][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 05:23:09,409][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 05:23:11,670][dance.WeightedFeaturePCA][__call__] Decomposing train features (5917, 200) (k=5)
[INFO][2024-03-18 05:23:11,670][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.49%
[INFO][2024-03-18 05:27:41,852][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 05:27:41,853][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 05:27:41,853][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 05:27:41,853][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:36,  1.02it/s]  2%|‚ñè         | 2/100 [00:01<01:26,  1.14it/s]  3%|‚ñé         | 3/100 [00:02<01:27,  1.11it/s]  4%|‚ñç         | 4/100 [00:03<01:24,  1.14it/s]  5%|‚ñå         | 5/100 [00:04<01:23,  1.13it/s]  6%|‚ñå         | 6/100 [00:05<01:22,  1.14it/s]  7%|‚ñã         | 7/100 [00:06<01:18,  1.18it/s]  8%|‚ñä         | 8/100 [00:06<01:17,  1.19it/s]  9%|‚ñâ         | 9/100 [00:07<01:16,  1.18it/s] 10%|‚ñà         | 10/100 [00:08<01:17,  1.17it/s] 11%|‚ñà         | 11/100 [00:09<01:18,  1.14it/s] 12%|‚ñà‚ñè        | 12/100 [00:10<01:14,  1.17it/s] 13%|‚ñà‚ñé        | 13/100 [00:11<01:12,  1.21it/s] 14%|‚ñà‚ñç        | 14/100 [00:12<01:11,  1.20it/s] 15%|‚ñà‚ñå        | 15/100 [00:12<01:08,  1.23it/s] 16%|‚ñà‚ñå        | 16/100 [00:13<01:07,  1.25it/s] 17%|‚ñà‚ñã        | 17/100 [00:14<01:06,  1.24it/s] 18%|‚ñà‚ñä        | 18/100 [00:15<01:06,  1.23it/s] 19%|‚ñà‚ñâ        | 19/100 [00:16<01:07,  1.21it/s] 20%|‚ñà‚ñà        | 20/100 [00:16<01:06,  1.20it/s] 21%|‚ñà‚ñà        | 21/100 [00:17<01:06,  1.19it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:18<01:03,  1.23it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:19<01:02,  1.23it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:20<01:02,  1.21it/s] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:20<01:00,  1.23it/s] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:21<00:59,  1.23it/s] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:22<00:59,  1.23it/s] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:23<01:00,  1.18it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:24<00:59,  1.20it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:25<00:58,  1.20it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:25<00:53,  1.28it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:26<00:53,  1.27it/s] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:27<00:54,  1.24it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:28<00:53,  1.23it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:29<00:54,  1.20it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:30<00:55,  1.15it/s] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:30<00:52,  1.19it/s] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:31<00:53,  1.17it/s] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:32<00:53,  1.13it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:33<00:50,  1.18it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:34<00:51,  1.15it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:35<00:50,  1.15it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:36<00:50,  1.12it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:37<00:50,  1.11it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:38<00:49,  1.10it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:39<00:50,  1.07it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:40<00:49,  1.07it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:40<00:46,  1.12it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:41<00:45,  1.11it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:42<00:44,  1.11it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:43<00:45,  1.09it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:44<00:42,  1.13it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:45<00:40,  1.17it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:46<00:39,  1.17it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:46<00:37,  1.19it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:47<00:36,  1.21it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [00:48<00:37,  1.15it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [00:49<00:37,  1.12it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [00:50<00:36,  1.11it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [00:51<00:37,  1.06it/s] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [00:52<00:36,  1.06it/s] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [00:53<00:34,  1.10it/s] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [00:54<00:34,  1.08it/s] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [00:55<00:35,  1.02it/s] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [00:56<00:35,  1.01s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [00:57<00:32,  1.03it/s] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [00:58<00:31,  1.05it/s] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [00:59<00:29,  1.08it/s] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [00:59<00:27,  1.13it/s] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:00<00:26,  1.13it/s] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:01<00:24,  1.17it/s] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:02<00:23,  1.18it/s] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:03<00:23,  1.13it/s] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:04<00:22,  1.14it/s] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:04<00:20,  1.19it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:05<00:19,  1.21it/s] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:07<00:23,  1.01s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:08<00:21,  1.03it/s] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:08<00:20,  1.05it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:09<00:18,  1.06it/s] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:10<00:17,  1.07it/s] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:11<00:16,  1.09it/s] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:12<00:15,  1.07it/s] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:13<00:15,  1.05it/s] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:14<00:14,  1.01it/s] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:15<00:14,  1.00s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:16<00:12,  1.01it/s] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:17<00:11,  1.06it/s] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:18<00:10,  1.10it/s] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:19<00:08,  1.12it/s] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:20<00:08,  1.11it/s] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:21<00:07,  1.08it/s] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:22<00:06,  1.07it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:22<00:05,  1.11it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:23<00:04,  1.15it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:24<00:03,  1.18it/s] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:25<00:02,  1.16it/s] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:26<00:01,  1.18it/s] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:27<00:00,  1.18it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:27<00:00,  1.18it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:27<00:00,  1.14it/s]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.19038
wandb: 
wandb: üöÄ View run good-sweep-317 at: https://wandb.ai/xzy11632/dance-dev/runs/3oz8jovr
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_052301-3oz8jovr/logs
wandb: Agent Starting Run: x4r08e3s with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_053015-x4r08e3s
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run earnest-sweep-318
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/x4r08e3s
[INFO][2024-03-18 05:30:21,921][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 05:30:22,065][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 05:30:22,066][dance][wrapped_func] Took 0:00:00.128674 to load and process data.
[INFO][2024-03-18 05:30:22,066][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 05:30:22,070][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 05:30:22,108][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 05:30:22,472][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 05:30:37,094][dance.WeightedFeatureSVD][__call__] Decomposing train features (5917, 200) (k=6)
[INFO][2024-03-18 05:30:37,095][dance.WeightedFeatureSVD][__call__] Total explained variance: 91.65%
[INFO][2024-03-18 05:33:21,922][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 05:33:21,930][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 05:33:21,930][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 05:33:21,930][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:58,  1.19s/it]  2%|‚ñè         | 2/100 [00:02<01:46,  1.09s/it]  3%|‚ñé         | 3/100 [00:03<01:51,  1.15s/it]  4%|‚ñç         | 4/100 [00:04<01:49,  1.14s/it]  5%|‚ñå         | 5/100 [00:05<01:44,  1.10s/it]  6%|‚ñå         | 6/100 [00:06<01:45,  1.12s/it]  7%|‚ñã         | 7/100 [00:07<01:44,  1.12s/it]  8%|‚ñä         | 8/100 [00:08<01:42,  1.11s/it]  9%|‚ñâ         | 9/100 [00:10<01:42,  1.13s/it] 10%|‚ñà         | 10/100 [00:11<01:44,  1.16s/it] 11%|‚ñà         | 11/100 [00:12<01:43,  1.16s/it] 12%|‚ñà‚ñè        | 12/100 [00:13<01:42,  1.17s/it] 13%|‚ñà‚ñé        | 13/100 [00:14<01:39,  1.14s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:43,  1.21s/it] 15%|‚ñà‚ñå        | 15/100 [00:17<01:40,  1.18s/it] 16%|‚ñà‚ñå        | 16/100 [00:18<01:36,  1.15s/it] 17%|‚ñà‚ñã        | 17/100 [00:19<01:35,  1.15s/it] 18%|‚ñà‚ñä        | 18/100 [00:20<01:35,  1.17s/it] 19%|‚ñà‚ñâ        | 19/100 [00:21<01:35,  1.18s/it] 20%|‚ñà‚ñà        | 20/100 [00:22<01:31,  1.14s/it] 21%|‚ñà‚ñà        | 21/100 [00:24<01:32,  1.17s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:25<01:27,  1.12s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:26<01:25,  1.11s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:27<01:24,  1.11s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:28<01:21,  1.09s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:29<01:20,  1.08s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:30<01:16,  1.05s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:31<01:16,  1.06s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:32<01:14,  1.06s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:33<01:14,  1.07s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:34<01:14,  1.08s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:36<01:15,  1.12s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:37<01:13,  1.10s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:38<01:12,  1.10s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:39<01:11,  1.10s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:40<01:11,  1.12s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:41<01:11,  1.14s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:42<01:09,  1.13s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:43<01:09,  1.13s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:45<01:09,  1.16s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:46<01:07,  1.14s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:47<01:03,  1.10s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:48<01:02,  1.09s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:49<01:00,  1.07s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:50<01:00,  1.10s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:51<00:57,  1.07s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:52<00:57,  1.08s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:53<00:56,  1.08s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:54<00:55,  1.08s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:55<00:53,  1.07s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:56<00:52,  1.08s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:57<00:52,  1.09s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:59<00:51,  1.10s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:00<00:51,  1.13s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:01<00:50,  1.12s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:02<00:49,  1.13s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:03<00:47,  1.10s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:04<00:46,  1.10s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:05<00:46,  1.14s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:07<00:44,  1.12s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:08<00:43,  1.11s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:09<00:42,  1.12s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:10<00:42,  1.15s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:11<00:41,  1.16s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:12<00:39,  1.14s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:13<00:38,  1.14s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:15<00:38,  1.16s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:16<00:36,  1.15s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:17<00:34,  1.12s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:18<00:32,  1.08s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:19<00:32,  1.11s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:20<00:32,  1.15s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:21<00:30,  1.14s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:22<00:29,  1.12s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:24<00:28,  1.15s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:25<00:28,  1.17s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:26<00:26,  1.14s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:27<00:24,  1.11s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:28<00:23,  1.12s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:29<00:22,  1.12s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:30<00:21,  1.13s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:31<00:19,  1.10s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:32<00:18,  1.09s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:34<00:17,  1.09s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:35<00:16,  1.09s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:36<00:15,  1.10s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:37<00:14,  1.09s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:38<00:12,  1.06s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:39<00:12,  1.10s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:40<00:11,  1.11s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:41<00:10,  1.11s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:42<00:08,  1.10s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:43<00:07,  1.11s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:44<00:06,  1.10s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:46<00:05,  1.10s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:47<00:04,  1.11s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:48<00:03,  1.11s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:49<00:02,  1.11s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:50<00:01,  1.13s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:51<00:00,  1.12s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:51<00:00,  1.12s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.20695
wandb: 
wandb: üöÄ View run earnest-sweep-318 at: https://wandb.ai/xzy11632/dance-dev/runs/x4r08e3s
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_053015-x4r08e3s/logs
wandb: Agent Starting Run: 6ryrimm1 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_053641-6ryrimm1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run distinctive-sweep-319
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/6ryrimm1
[INFO][2024-03-18 05:36:46,846][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 05:36:46,933][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 05:36:46,933][dance][wrapped_func] Took 0:00:00.085956 to load and process data.
[INFO][2024-03-18 05:36:46,933][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 05:36:46,936][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 05:36:46,955][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 05:36:47,146][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run distinctive-sweep-319 at: https://wandb.ai/xzy11632/dance-dev/runs/6ryrimm1
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_053641-6ryrimm1/logs
wandb: ERROR Run 6ryrimm1 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: w6lmc9lj with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_053659-w6lmc9lj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run denim-sweep-320
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/w6lmc9lj
[INFO][2024-03-18 05:37:05,144][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 05:37:05,240][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 05:37:05,241][dance][wrapped_func] Took 0:00:00.096172 to load and process data.
[INFO][2024-03-18 05:37:05,241][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 05:37:05,243][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 05:37:05,262][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 05:37:05,559][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run denim-sweep-320 at: https://wandb.ai/xzy11632/dance-dev/runs/w6lmc9lj
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_053659-w6lmc9lj/logs
wandb: ERROR Run w6lmc9lj errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: clvkfxoq with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_053725-clvkfxoq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rose-sweep-321
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/clvkfxoq
[INFO][2024-03-18 05:37:30,342][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 05:37:30,431][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 05:37:30,431][dance][wrapped_func] Took 0:00:00.088865 to load and process data.
[INFO][2024-03-18 05:37:30,431][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 05:37:30,433][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 05:37:30,454][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 05:37:30,627][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.016 MB of 0.025 MB uploadedwandb: \ 0.016 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run rose-sweep-321 at: https://wandb.ai/xzy11632/dance-dev/runs/clvkfxoq
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_053725-clvkfxoq/logs
wandb: ERROR Run clvkfxoq errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: zj032pok with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_053741-zj032pok
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run twilight-sweep-322
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/zj032pok
[INFO][2024-03-18 05:37:47,812][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 05:37:47,914][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 05:37:47,914][dance][wrapped_func] Took 0:00:00.101512 to load and process data.
[INFO][2024-03-18 05:37:47,914][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 05:37:47,916][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 05:37:47,932][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 05:37:48,083][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run twilight-sweep-322 at: https://wandb.ai/xzy11632/dance-dev/runs/zj032pok
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_053741-zj032pok/logs
wandb: ERROR Run zj032pok errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: gjym7niu with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_053758-gjym7niu
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run prime-sweep-323
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/gjym7niu
[INFO][2024-03-18 05:38:03,952][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 05:38:04,044][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 05:38:04,044][dance][wrapped_func] Took 0:00:00.091412 to load and process data.
[INFO][2024-03-18 05:38:04,044][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 05:38:04,046][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 05:38:04,067][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 05:38:04,254][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 05:38:04,958][dance.WeightedFeaturePCA][__call__] Decomposing train features (5917, 200) (k=8)
[INFO][2024-03-18 05:38:04,958][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.79%
[INFO][2024-03-18 05:38:06,996][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 05:38:06,997][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 05:38:06,997][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 05:38:06,998][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:12,  1.37it/s]  2%|‚ñè         | 2/100 [00:01<01:20,  1.21it/s]  3%|‚ñé         | 3/100 [00:02<01:18,  1.23it/s]  4%|‚ñç         | 4/100 [00:03<01:21,  1.18it/s]  5%|‚ñå         | 5/100 [00:04<01:21,  1.16it/s]  6%|‚ñå         | 6/100 [00:04<01:16,  1.23it/s]  7%|‚ñã         | 7/100 [00:05<01:12,  1.28it/s]  8%|‚ñä         | 8/100 [00:06<01:11,  1.28it/s]  9%|‚ñâ         | 9/100 [00:07<01:10,  1.29it/s] 10%|‚ñà         | 10/100 [00:08<01:11,  1.26it/s] 11%|‚ñà         | 11/100 [00:08<01:10,  1.26it/s] 12%|‚ñà‚ñè        | 12/100 [00:09<01:12,  1.22it/s] 13%|‚ñà‚ñé        | 13/100 [00:10<01:10,  1.23it/s] 14%|‚ñà‚ñç        | 14/100 [00:11<01:08,  1.25it/s] 15%|‚ñà‚ñå        | 15/100 [00:12<01:06,  1.27it/s] 16%|‚ñà‚ñå        | 16/100 [00:12<01:04,  1.31it/s] 17%|‚ñà‚ñã        | 17/100 [00:13<01:04,  1.28it/s] 18%|‚ñà‚ñä        | 18/100 [00:14<01:05,  1.24it/s] 19%|‚ñà‚ñâ        | 19/100 [00:15<01:05,  1.23it/s] 20%|‚ñà‚ñà        | 20/100 [00:16<01:04,  1.24it/s] 21%|‚ñà‚ñà        | 21/100 [00:16<01:07,  1.17it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:17<01:05,  1.19it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:18<01:02,  1.24it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:19<01:02,  1.22it/s] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:20<01:03,  1.19it/s] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:21<01:01,  1.20it/s] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:21<00:58,  1.24it/s] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:22<00:57,  1.25it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:23<00:57,  1.24it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:24<00:55,  1.27it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:25<00:55,  1.25it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:25<00:52,  1.29it/s] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:26<00:51,  1.31it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:27<00:49,  1.33it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:27<00:49,  1.32it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:28<00:48,  1.31it/s] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:29<00:49,  1.26it/s] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:30<00:49,  1.26it/s] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:31<00:47,  1.28it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:31<00:46,  1.28it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:32<00:49,  1.19it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:33<00:47,  1.23it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:34<00:50,  1.13it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:35<00:49,  1.12it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:36<00:46,  1.19it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:37<00:48,  1.10it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:38<00:45,  1.16it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:39<00:45,  1.13it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:39<00:42,  1.19it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:40<00:41,  1.20it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:41<00:38,  1.27it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:42<00:38,  1.23it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:43<00:38,  1.21it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:43<00:37,  1.23it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:44<00:37,  1.20it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:46<00:43,  1.02it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [00:47<00:47,  1.11s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [00:48<00:48,  1.15s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [00:50<00:52,  1.28s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [00:51<00:50,  1.27s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [00:52<00:47,  1.22s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [00:53<00:46,  1.21s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [00:54<00:43,  1.17s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [00:55<00:41,  1.14s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [00:56<00:37,  1.08s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [00:58<00:36,  1.09s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [00:58<00:34,  1.05s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:00<00:34,  1.07s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:01<00:34,  1.10s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:02<00:32,  1.09s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:03<00:28,  1.01it/s] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:03<00:25,  1.08it/s] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:04<00:23,  1.13it/s] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:05<00:22,  1.16it/s] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:06<00:21,  1.18it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:07<00:20,  1.20it/s] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:07<00:19,  1.18it/s] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:08<00:18,  1.20it/s] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:09<00:17,  1.22it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:10<00:16,  1.22it/s] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:11<00:15,  1.26it/s] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:12<00:16,  1.12it/s] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:13<00:17,  1.05s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:14<00:17,  1.09s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:16<00:17,  1.17s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:17<00:16,  1.15s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:18<00:15,  1.18s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:19<00:13,  1.16s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:20<00:11,  1.07s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:21<00:09,  1.00it/s] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:22<00:08,  1.05it/s] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:22<00:07,  1.10it/s] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:23<00:06,  1.09it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:24<00:05,  1.12it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:25<00:04,  1.12it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:26<00:03,  1.16it/s] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:27<00:02,  1.19it/s] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:27<00:01,  1.23it/s] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:28<00:00,  1.25it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:29<00:00,  1.25it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:29<00:00,  1.12it/s]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.21529
wandb: 
wandb: üöÄ View run prime-sweep-323 at: https://wandb.ai/xzy11632/dance-dev/runs/gjym7niu
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_053758-gjym7niu/logs
wandb: Agent Starting Run: qrg655ub with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizePlaceHolder
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_054042-qrg655ub
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run radiant-sweep-324
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/qrg655ub
[INFO][2024-03-18 05:40:48,835][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 05:40:49,003][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 05:40:49,003][dance][wrapped_func] Took 0:00:00.166644 to load and process data.
[INFO][2024-03-18 05:40:49,004][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 05:40:49,006][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'NormalizePlaceHolder',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 05:40:49,024][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 05:40:49,212][dance][wrapped_func] The function 'NormalizePlaceHolder' (/home/zyxing/dance/dance/transforms/normalize.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 05:41:11,192][dance.WeightedFeatureSVD][__call__] Decomposing train features (5917, 200) (k=9)
[INFO][2024-03-18 05:41:11,207][dance.WeightedFeatureSVD][__call__] Total explained variance: 91.53%
[INFO][2024-03-18 05:43:28,396][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 05:43:28,396][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 05:43:28,397][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 05:43:28,397][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizePlaceHolder
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:26,  1.14it/s]  2%|‚ñè         | 2/100 [00:01<01:30,  1.08it/s]  3%|‚ñé         | 3/100 [00:02<01:33,  1.04it/s]  4%|‚ñç         | 4/100 [00:03<01:27,  1.09it/s]  5%|‚ñå         | 5/100 [00:04<01:20,  1.17it/s]  6%|‚ñå         | 6/100 [00:05<01:15,  1.25it/s]  7%|‚ñã         | 7/100 [00:05<01:12,  1.29it/s]  8%|‚ñä         | 8/100 [00:06<01:11,  1.29it/s]  9%|‚ñâ         | 9/100 [00:07<01:13,  1.23it/s] 10%|‚ñà         | 10/100 [00:08<01:12,  1.24it/s] 11%|‚ñà         | 11/100 [00:09<01:13,  1.21it/s] 12%|‚ñà‚ñè        | 12/100 [00:09<01:12,  1.22it/s] 13%|‚ñà‚ñé        | 13/100 [00:10<01:12,  1.21it/s] 14%|‚ñà‚ñç        | 14/100 [00:11<01:08,  1.25it/s] 15%|‚ñà‚ñå        | 15/100 [00:12<01:05,  1.30it/s] 16%|‚ñà‚ñå        | 16/100 [00:13<01:04,  1.30it/s] 17%|‚ñà‚ñã        | 17/100 [00:13<01:05,  1.27it/s] 18%|‚ñà‚ñä        | 18/100 [00:14<01:03,  1.29it/s] 19%|‚ñà‚ñâ        | 19/100 [00:15<01:05,  1.24it/s] 20%|‚ñà‚ñà        | 20/100 [00:16<01:09,  1.14it/s] 21%|‚ñà‚ñà        | 21/100 [00:17<01:05,  1.20it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:18<01:03,  1.23it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:18<01:03,  1.21it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:19<01:00,  1.25it/s] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:20<00:59,  1.26it/s] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:21<01:01,  1.19it/s] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:22<00:59,  1.22it/s] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:22<00:59,  1.20it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:23<00:58,  1.21it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:24<00:57,  1.23it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:25<00:56,  1.22it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:26<00:56,  1.20it/s] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:27<00:58,  1.14it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:28<00:56,  1.17it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:28<00:54,  1.20it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:29<00:57,  1.12it/s] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:30<00:56,  1.12it/s] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:31<00:54,  1.13it/s] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:32<00:56,  1.08it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:33<00:58,  1.03it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:34<00:59,  1.02s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:35<00:57,  1.02it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:36<00:57,  1.01s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:37<00:55,  1.01it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:38<00:52,  1.05it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:39<00:48,  1.12it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:40<00:44,  1.18it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:40<00:42,  1.22it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:41<00:40,  1.26it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:42<00:39,  1.27it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:43<00:38,  1.26it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:44<00:41,  1.16it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:45<00:45,  1.04it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:46<00:48,  1.06s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:48<00:51,  1.15s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:49<00:53,  1.23s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [00:50<00:53,  1.24s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [00:51<00:51,  1.23s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [00:53<00:51,  1.26s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [00:54<00:50,  1.27s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [00:55<00:51,  1.31s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [00:57<00:47,  1.25s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [00:58<00:45,  1.23s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [00:59<00:44,  1.24s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:00<00:42,  1.21s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:02<00:42,  1.25s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:03<00:44,  1.36s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:05<00:45,  1.42s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:06<00:44,  1.44s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:07<00:40,  1.34s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:08<00:34,  1.20s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:09<00:33,  1.20s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:10<00:31,  1.16s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:12<00:31,  1.19s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:13<00:29,  1.16s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:14<00:27,  1.17s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:15<00:26,  1.16s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:16<00:25,  1.15s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:17<00:24,  1.15s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:19<00:23,  1.19s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:20<00:22,  1.18s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:21<00:22,  1.23s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:23<00:22,  1.31s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:25<00:24,  1.55s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:27<00:24,  1.63s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:28<00:22,  1.59s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:29<00:19,  1.52s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:31<00:19,  1.59s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:33<00:16,  1.53s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:34<00:15,  1.60s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:36<00:15,  1.67s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:38<00:14,  1.81s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:40<00:11,  1.66s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:41<00:10,  1.69s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:43<00:08,  1.65s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:45<00:06,  1.67s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:46<00:04,  1.64s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:48<00:03,  1.61s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:49<00:01,  1.55s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:51<00:00,  1.57s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:51<00:00,  1.11s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.017 MB of 0.025 MB uploadedwandb: | 0.017 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.20746
wandb: 
wandb: üöÄ View run radiant-sweep-324 at: https://wandb.ai/xzy11632/dance-dev/runs/qrg655ub
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_054042-qrg655ub/logs
wandb: Agent Starting Run: 7grovqqj with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_054656-7grovqqj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run feasible-sweep-325
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/7grovqqj
[INFO][2024-03-18 05:47:02,360][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 05:47:02,451][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 05:47:02,451][dance][wrapped_func] Took 0:00:00.083565 to load and process data.
[INFO][2024-03-18 05:47:02,451][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 05:47:02,453][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 05:47:02,477][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 05:47:02,683][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 05:47:05,340][dance.WeightedFeaturePCA][__call__] Decomposing train features (5917, 919) (k=18)
[INFO][2024-03-18 05:47:05,341][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.05%
[INFO][2024-03-18 05:47:09,272][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 05:47:09,273][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 05:47:09,273][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 05:47:09,273][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:36,  1.58s/it]  2%|‚ñè         | 2/100 [00:02<02:09,  1.32s/it]  3%|‚ñé         | 3/100 [00:03<02:01,  1.26s/it]  4%|‚ñç         | 4/100 [00:04<01:51,  1.16s/it]  5%|‚ñå         | 5/100 [00:06<01:50,  1.16s/it]  6%|‚ñå         | 6/100 [00:07<01:44,  1.11s/it]  7%|‚ñã         | 7/100 [00:08<01:45,  1.13s/it]  8%|‚ñä         | 8/100 [00:09<01:44,  1.14s/it]  9%|‚ñâ         | 9/100 [00:10<01:47,  1.19s/it] 10%|‚ñà         | 10/100 [00:11<01:42,  1.14s/it] 11%|‚ñà         | 11/100 [00:13<02:01,  1.37s/it] 12%|‚ñà‚ñè        | 12/100 [00:15<02:06,  1.44s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<02:14,  1.55s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<02:15,  1.57s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<02:07,  1.50s/it] 16%|‚ñà‚ñå        | 16/100 [00:21<01:59,  1.42s/it] 17%|‚ñà‚ñã        | 17/100 [00:22<01:53,  1.37s/it] 18%|‚ñà‚ñä        | 18/100 [00:23<01:53,  1.38s/it] 19%|‚ñà‚ñâ        | 19/100 [00:25<01:52,  1.39s/it] 20%|‚ñà‚ñà        | 20/100 [00:26<01:55,  1.44s/it] 21%|‚ñà‚ñà        | 21/100 [00:28<01:47,  1.36s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:29<01:43,  1.32s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:30<01:36,  1.25s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:31<01:35,  1.26s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:33<01:37,  1.30s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:34<01:38,  1.33s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:35<01:32,  1.27s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:36<01:33,  1.30s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:38<01:30,  1.28s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:39<01:30,  1.29s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:40<01:28,  1.28s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:42<01:28,  1.31s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:43<01:27,  1.30s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:44<01:24,  1.29s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:45<01:21,  1.26s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:47<01:24,  1.31s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:48<01:25,  1.36s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:50<01:23,  1.34s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:51<01:21,  1.34s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:52<01:17,  1.29s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:53<01:15,  1.27s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:55<01:13,  1.26s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:56<01:13,  1.30s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:57<01:12,  1.29s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:59<01:14,  1.36s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:00<01:10,  1.30s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:01<01:06,  1.26s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:02<01:03,  1.22s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:03<01:00,  1.19s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:04<00:58,  1.17s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:06<00:57,  1.17s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:07<00:58,  1.21s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:08<00:51,  1.11s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:09<00:47,  1.03s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:09<00:44,  1.01it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:10<00:44,  1.00s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:11<00:42,  1.00it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:12<00:41,  1.01it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:13<00:40,  1.02it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:14<00:38,  1.05it/s] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:15<00:37,  1.03it/s] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:16<00:37,  1.03it/s] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:17<00:35,  1.05it/s] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:18<00:33,  1.07it/s] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:19<00:34,  1.01it/s] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:20<00:33,  1.01it/s] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:21<00:33,  1.02s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:22<00:31,  1.01it/s] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:23<00:31,  1.00s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:24<00:30,  1.02s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:25<00:28,  1.03it/s] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:26<00:26,  1.05it/s] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:27<00:24,  1.09it/s] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:28<00:22,  1.15it/s] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:28<00:20,  1.20it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:29<00:19,  1.23it/s] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:30<00:18,  1.23it/s] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:31<00:17,  1.23it/s] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:32<00:17,  1.20it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:33<00:17,  1.18it/s] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:35<00:23,  1.22s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:37<00:27,  1.50s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:38<00:26,  1.55s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:40<00:22,  1.43s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:41<00:19,  1.30s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:42<00:16,  1.19s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:42<00:14,  1.10s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:43<00:12,  1.03s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:44<00:10,  1.01it/s] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:45<00:09,  1.01it/s] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:46<00:09,  1.08s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:49<00:10,  1.36s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:50<00:10,  1.44s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:51<00:07,  1.25s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:52<00:05,  1.15s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:53<00:04,  1.08s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:54<00:03,  1.03s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:55<00:01,  1.01it/s] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:56<00:01,  1.01s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:57<00:00,  1.03it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:57<00:00,  1.17s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.22805
wandb: 
wandb: üöÄ View run feasible-sweep-325 at: https://wandb.ai/xzy11632/dance-dev/runs/7grovqqj
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_054656-7grovqqj/logs
wandb: Agent Starting Run: g7c13g1x with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_054958-g7c13g1x
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run smooth-sweep-326
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/g7c13g1x
[INFO][2024-03-18 05:50:03,776][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 05:50:03,878][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 05:50:03,878][dance][wrapped_func] Took 0:00:00.099779 to load and process data.
[INFO][2024-03-18 05:50:03,878][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 05:50:03,880][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 05:50:03,905][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 05:50:04,127][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 05:50:17,249][dance.WeightedFeatureSVD][__call__] Decomposing train features (5917, 919) (k=86)
[INFO][2024-03-18 05:50:17,250][dance.WeightedFeatureSVD][__call__] Total explained variance: 94.85%
[INFO][2024-03-18 05:50:21,633][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 05:50:21,634][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 05:50:21,634][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 05:50:21,634][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:29,  1.51s/it]  2%|‚ñè         | 2/100 [00:02<02:07,  1.31s/it]  3%|‚ñé         | 3/100 [00:03<02:02,  1.26s/it]  4%|‚ñç         | 4/100 [00:05<02:18,  1.44s/it]  5%|‚ñå         | 5/100 [00:06<02:14,  1.42s/it]  6%|‚ñå         | 6/100 [00:08<02:13,  1.42s/it]  7%|‚ñã         | 7/100 [00:09<02:07,  1.37s/it]  8%|‚ñä         | 8/100 [00:11<02:09,  1.41s/it]  9%|‚ñâ         | 9/100 [00:12<02:15,  1.49s/it] 10%|‚ñà         | 10/100 [00:14<02:13,  1.48s/it] 11%|‚ñà         | 11/100 [00:15<02:14,  1.51s/it] 12%|‚ñà‚ñè        | 12/100 [00:17<02:15,  1.54s/it] 13%|‚ñà‚ñé        | 13/100 [00:18<02:09,  1.49s/it] 14%|‚ñà‚ñç        | 14/100 [00:20<02:07,  1.48s/it] 15%|‚ñà‚ñå        | 15/100 [00:21<02:07,  1.50s/it] 16%|‚ñà‚ñå        | 16/100 [00:23<02:06,  1.50s/it] 17%|‚ñà‚ñã        | 17/100 [00:24<02:05,  1.52s/it] 18%|‚ñà‚ñä        | 18/100 [00:26<02:02,  1.49s/it] 19%|‚ñà‚ñâ        | 19/100 [00:27<02:01,  1.50s/it] 20%|‚ñà‚ñà        | 20/100 [00:29<01:59,  1.50s/it] 21%|‚ñà‚ñà        | 21/100 [00:30<01:58,  1.51s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:32<01:58,  1.52s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:34<01:59,  1.55s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:35<01:51,  1.46s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:36<01:44,  1.40s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:37<01:41,  1.37s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:39<01:40,  1.38s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:40<01:35,  1.33s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:41<01:31,  1.28s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:42<01:25,  1.22s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:43<01:20,  1.17s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:45<01:22,  1.21s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:46<01:22,  1.23s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:47<01:25,  1.29s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:49<01:25,  1.32s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:50<01:24,  1.31s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:51<01:18,  1.24s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:52<01:15,  1.22s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:53<01:13,  1.21s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:55<01:12,  1.20s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:56<01:13,  1.25s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:58<01:18,  1.35s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:59<01:17,  1.36s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:00<01:19,  1.41s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:02<01:14,  1.35s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:03<01:10,  1.31s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:04<01:10,  1.33s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:06<01:08,  1.32s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:07<01:04,  1.26s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:08<01:02,  1.25s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:09<01:01,  1.25s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:11<01:01,  1.28s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:14<01:31,  1.96s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:17<01:49,  2.37s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:21<02:02,  2.73s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:24<02:08,  2.92s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:27<01:56,  2.72s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:29<01:49,  2.61s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:31<01:38,  2.41s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:32<01:21,  2.05s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:33<01:09,  1.79s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:34<01:01,  1.62s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:36<00:53,  1.45s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:37<00:47,  1.33s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:38<00:43,  1.25s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:39<00:41,  1.21s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:40<00:41,  1.25s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:41<00:39,  1.24s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:42<00:37,  1.21s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:44<00:35,  1.17s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:45<00:32,  1.12s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:46<00:33,  1.18s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:47<00:32,  1.20s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:48<00:30,  1.19s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:49<00:29,  1.18s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:51<00:27,  1.16s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:52<00:26,  1.13s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:53<00:25,  1.14s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:54<00:23,  1.13s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:55<00:23,  1.17s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:56<00:22,  1.17s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:57<00:21,  1.18s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:59<00:20,  1.21s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:00<00:18,  1.19s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:01<00:17,  1.16s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:02<00:15,  1.10s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:03<00:13,  1.08s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:04<00:12,  1.07s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:05<00:12,  1.11s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:07<00:11,  1.19s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:08<00:10,  1.19s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:09<00:09,  1.20s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:10<00:07,  1.10s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:11<00:06,  1.06s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:12<00:05,  1.03s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:13<00:04,  1.05s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:14<00:03,  1.05s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:17<00:03,  1.52s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:19<00:01,  1.77s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:22<00:00,  2.13s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:22<00:00,  1.42s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.31124
wandb: 
wandb: üöÄ View run smooth-sweep-326 at: https://wandb.ai/xzy11632/dance-dev/runs/g7c13g1x
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_054958-g7c13g1x/logs
wandb: Agent Starting Run: o4e4ycy0 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_055323-o4e4ycy0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run super-sweep-327
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/o4e4ycy0
[INFO][2024-03-18 05:53:29,281][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 05:53:29,363][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 05:53:29,364][dance][wrapped_func] Took 0:00:00.081864 to load and process data.
[INFO][2024-03-18 05:53:29,364][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 05:53:29,366][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-18 05:53:29,675][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run super-sweep-327 at: https://wandb.ai/xzy11632/dance-dev/runs/o4e4ycy0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_055323-o4e4ycy0/logs
wandb: ERROR Run o4e4ycy0 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1081) out of bounds (919)
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 04n91j8r with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_055350-04n91j8r
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run curious-sweep-328
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/04n91j8r
[INFO][2024-03-18 05:53:55,965][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 05:53:56,121][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 05:53:56,122][dance][wrapped_func] Took 0:00:00.155580 to load and process data.
[INFO][2024-03-18 05:53:56,122][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 05:53:56,123][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-18 05:53:56,552][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.018 MB uploadedwandb: | 0.012 MB of 0.018 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run curious-sweep-328 at: https://wandb.ai/xzy11632/dance-dev/runs/04n91j8r
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_055350-04n91j8r/logs
wandb: ERROR Run 04n91j8r errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1081) out of bounds (919)
wandb: ERROR 
wandb: Agent Starting Run: 2ufha0ne with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_055413-2ufha0ne
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sweet-sweep-329
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/2ufha0ne
[INFO][2024-03-18 05:54:19,549][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 05:54:19,683][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 05:54:19,684][dance][wrapped_func] Took 0:00:00.134426 to load and process data.
[INFO][2024-03-18 05:54:19,684][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 05:54:19,687][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[INFO][2024-03-18 05:54:21,078][dance.WeightedFeaturePCA][__call__] Decomposing train features (5917, 200) (k=6)
[INFO][2024-03-18 05:54:21,079][dance.WeightedFeaturePCA][__call__] Total explained variance: 91.03%
[INFO][2024-03-18 06:03:19,445][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 06:03:19,446][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 06:03:19,446][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 06:03:19,446][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:43,  1.05s/it]  2%|‚ñè         | 2/100 [00:01<01:36,  1.01it/s]  3%|‚ñé         | 3/100 [00:02<01:31,  1.06it/s]  4%|‚ñç         | 4/100 [00:03<01:36,  1.00s/it]  5%|‚ñå         | 5/100 [00:04<01:30,  1.05it/s]  6%|‚ñå         | 6/100 [00:05<01:28,  1.07it/s]  7%|‚ñã         | 7/100 [00:06<01:26,  1.07it/s]  8%|‚ñä         | 8/100 [00:07<01:20,  1.14it/s]  9%|‚ñâ         | 9/100 [00:08<01:22,  1.10it/s] 10%|‚ñà         | 10/100 [00:09<01:20,  1.12it/s] 11%|‚ñà         | 11/100 [00:10<01:19,  1.12it/s] 12%|‚ñà‚ñè        | 12/100 [00:11<01:20,  1.10it/s] 13%|‚ñà‚ñé        | 13/100 [00:11<01:15,  1.16it/s] 14%|‚ñà‚ñç        | 14/100 [00:12<01:14,  1.16it/s] 15%|‚ñà‚ñå        | 15/100 [00:13<01:14,  1.14it/s] 16%|‚ñà‚ñå        | 16/100 [00:14<01:10,  1.19it/s] 17%|‚ñà‚ñã        | 17/100 [00:15<01:08,  1.20it/s] 18%|‚ñà‚ñä        | 18/100 [00:16<01:09,  1.18it/s] 19%|‚ñà‚ñâ        | 19/100 [00:16<01:06,  1.21it/s] 20%|‚ñà‚ñà        | 20/100 [00:17<01:05,  1.22it/s] 21%|‚ñà‚ñà        | 21/100 [00:18<01:08,  1.16it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:19<01:05,  1.18it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:20<01:04,  1.19it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:21<01:06,  1.15it/s] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:21<01:02,  1.21it/s] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:22<01:00,  1.23it/s] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:23<00:58,  1.24it/s] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:24<00:57,  1.25it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:25<00:57,  1.23it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:26<00:59,  1.17it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:26<00:58,  1.17it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:27<00:57,  1.18it/s] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:28<00:56,  1.18it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:29<00:56,  1.16it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:30<00:55,  1.17it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:31<00:53,  1.20it/s] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:31<00:53,  1.18it/s] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:32<00:53,  1.17it/s] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:33<00:51,  1.18it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:34<00:50,  1.18it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:35<00:49,  1.19it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:36<00:48,  1.21it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:36<00:46,  1.22it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:37<00:45,  1.23it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:38<00:44,  1.23it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:39<00:43,  1.25it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:40<00:42,  1.24it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:41<00:42,  1.22it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:41<00:41,  1.22it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:42<00:40,  1.25it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:43<00:39,  1.25it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:44<00:39,  1.23it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:45<00:37,  1.25it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:45<00:36,  1.28it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:46<00:35,  1.27it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:47<00:35,  1.24it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [00:48<00:35,  1.22it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [00:49<00:34,  1.21it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [00:49<00:33,  1.23it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [00:50<00:32,  1.24it/s] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [00:51<00:31,  1.24it/s] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [00:52<00:31,  1.22it/s] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [00:53<00:30,  1.21it/s] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [00:53<00:29,  1.22it/s] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [00:54<00:28,  1.21it/s] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [00:55<00:29,  1.16it/s] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [00:56<00:26,  1.22it/s] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [00:57<00:25,  1.27it/s] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [00:57<00:24,  1.26it/s] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [00:58<00:25,  1.19it/s] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [00:59<00:25,  1.14it/s] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:00<00:24,  1.12it/s] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:01<00:24,  1.12it/s] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:02<00:22,  1.16it/s] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:03<00:20,  1.20it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:04<00:19,  1.23it/s] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:04<00:18,  1.25it/s] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:05<00:18,  1.20it/s] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:06<00:17,  1.23it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:07<00:16,  1.20it/s] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:08<00:16,  1.16it/s] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:09<00:16,  1.12it/s] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:10<00:15,  1.11it/s] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:11<00:14,  1.07it/s] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:12<00:13,  1.09it/s] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:12<00:12,  1.11it/s] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:13<00:11,  1.11it/s] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:14<00:11,  1.05it/s] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:15<00:10,  1.08it/s] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:16<00:09,  1.08it/s] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:17<00:08,  1.09it/s] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:18<00:07,  1.12it/s] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:19<00:06,  1.14it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:20<00:05,  1.13it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:21<00:04,  1.15it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:21<00:03,  1.13it/s] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:22<00:02,  1.12it/s] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:23<00:01,  1.11it/s] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:24<00:00,  1.11it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:25<00:00,  1.10it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:25<00:00,  1.17it/s]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.17642
wandb: 
wandb: üöÄ View run sweet-sweep-329 at: https://wandb.ai/xzy11632/dance-dev/runs/2ufha0ne
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_055413-2ufha0ne/logs
wandb: Agent Starting Run: 6to4u8to with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_060605-6to4u8to
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lemon-sweep-330
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/6to4u8to
[INFO][2024-03-18 06:06:10,051][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 06:06:10,145][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 06:06:10,145][dance][wrapped_func] Took 0:00:00.093022 to load and process data.
[INFO][2024-03-18 06:06:10,145][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 06:06:10,147][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[INFO][2024-03-18 06:06:11,805][dance.WeightedFeatureSVD][__call__] Decomposing train features (5917, 200) (k=6)
[INFO][2024-03-18 06:06:11,809][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.95%
[INFO][2024-03-18 06:06:13,824][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 06:06:13,824][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 06:06:13,824][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 06:06:13,825][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:18,  1.27it/s]  2%|‚ñè         | 2/100 [00:01<01:20,  1.22it/s]  3%|‚ñé         | 3/100 [00:02<01:17,  1.25it/s]  4%|‚ñç         | 4/100 [00:03<01:16,  1.26it/s]  5%|‚ñå         | 5/100 [00:03<01:15,  1.26it/s]  6%|‚ñå         | 6/100 [00:04<01:13,  1.28it/s]  7%|‚ñã         | 7/100 [00:05<01:10,  1.31it/s]  8%|‚ñä         | 8/100 [00:06<01:08,  1.34it/s]  9%|‚ñâ         | 9/100 [00:07<01:11,  1.27it/s] 10%|‚ñà         | 10/100 [00:07<01:10,  1.28it/s] 11%|‚ñà         | 11/100 [00:08<01:09,  1.27it/s] 12%|‚ñà‚ñè        | 12/100 [00:09<01:10,  1.25it/s] 13%|‚ñà‚ñé        | 13/100 [00:10<01:10,  1.23it/s] 14%|‚ñà‚ñç        | 14/100 [00:11<01:08,  1.26it/s] 15%|‚ñà‚ñå        | 15/100 [00:11<01:07,  1.27it/s] 16%|‚ñà‚ñå        | 16/100 [00:12<01:04,  1.31it/s] 17%|‚ñà‚ñã        | 17/100 [00:13<01:01,  1.34it/s] 18%|‚ñà‚ñä        | 18/100 [00:14<01:02,  1.32it/s] 19%|‚ñà‚ñâ        | 19/100 [00:14<01:03,  1.28it/s] 20%|‚ñà‚ñà        | 20/100 [00:15<01:04,  1.25it/s] 21%|‚ñà‚ñà        | 21/100 [00:16<01:04,  1.23it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:17<01:02,  1.26it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:17<00:58,  1.31it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:18<00:56,  1.35it/s] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:19<00:55,  1.36it/s] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:20<00:54,  1.37it/s] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:20<00:53,  1.37it/s] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:21<00:53,  1.34it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:22<00:53,  1.33it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:23<00:51,  1.36it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:23<00:53,  1.30it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:24<00:53,  1.27it/s] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:25<00:54,  1.24it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:26<00:53,  1.24it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:27<00:54,  1.20it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:28<00:53,  1.19it/s] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:29<00:52,  1.19it/s] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:29<00:51,  1.19it/s] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:30<00:51,  1.19it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:31<00:50,  1.19it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:32<00:50,  1.17it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:33<00:49,  1.18it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:34<00:47,  1.20it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:35<00:48,  1.14it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:35<00:48,  1.14it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:36<00:45,  1.18it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:37<00:45,  1.16it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:38<00:44,  1.16it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:39<00:51,  1.01s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:40<00:50,  1.01s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:41<00:50,  1.03s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:42<00:46,  1.03it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:43<00:43,  1.07it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:44<00:44,  1.04it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:45<00:41,  1.09it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:46<00:38,  1.13it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [00:46<00:36,  1.18it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [00:47<00:34,  1.22it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [00:48<00:32,  1.24it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [00:49<00:31,  1.28it/s] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [00:50<00:33,  1.17it/s] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [00:52<00:44,  1.16s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [00:53<00:45,  1.24s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [00:54<00:47,  1.31s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [00:56<00:45,  1.30s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [00:57<00:42,  1.26s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [00:58<00:40,  1.22s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [00:59<00:38,  1.19s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:00<00:35,  1.15s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:01<00:32,  1.07s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:02<00:27,  1.04it/s] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:03<00:25,  1.10it/s] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:03<00:23,  1.13it/s] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:04<00:22,  1.16it/s] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:05<00:20,  1.19it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:06<00:19,  1.23it/s] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:06<00:17,  1.29it/s] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:07<00:16,  1.33it/s] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:08<00:15,  1.35it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:09<00:14,  1.35it/s] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:09<00:14,  1.32it/s] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:10<00:14,  1.26it/s] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:11<00:13,  1.23it/s] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:12<00:13,  1.22it/s] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:13<00:12,  1.25it/s] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:14<00:11,  1.25it/s] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:14<00:10,  1.25it/s] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:15<00:09,  1.27it/s] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:16<00:08,  1.24it/s] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:17<00:08,  1.24it/s] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:18<00:07,  1.22it/s] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:18<00:06,  1.23it/s] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:19<00:05,  1.26it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:20<00:04,  1.29it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:21<00:03,  1.29it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:22<00:03,  1.19it/s] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:22<00:02,  1.22it/s] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:23<00:01,  1.21it/s] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:24<00:00,  1.11it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:25<00:00,  1.12it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:25<00:00,  1.17it/s]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.017 MB of 0.025 MB uploadedwandb: \ 0.017 MB of 0.025 MB uploadedwandb: | 0.017 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.18427
wandb: 
wandb: üöÄ View run lemon-sweep-330 at: https://wandb.ai/xzy11632/dance-dev/runs/6to4u8to
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_060605-6to4u8to/logs
wandb: Agent Starting Run: tyveaid8 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_060847-tyveaid8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run bright-sweep-331
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/tyveaid8
[INFO][2024-03-18 06:08:52,936][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 06:08:53,038][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 06:08:53,039][dance][wrapped_func] Took 0:00:00.101522 to load and process data.
[INFO][2024-03-18 06:08:53,039][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 06:08:53,041][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run bright-sweep-331 at: https://wandb.ai/xzy11632/dance-dev/runs/tyveaid8
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_060847-tyveaid8/logs
wandb: ERROR Run tyveaid8 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: np4y2fmb with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_060913-np4y2fmb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run curious-sweep-332
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/np4y2fmb
[INFO][2024-03-18 06:09:20,867][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 06:09:20,976][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 06:09:20,977][dance][wrapped_func] Took 0:00:00.108969 to load and process data.
[INFO][2024-03-18 06:09:20,977][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 06:09:20,980][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run curious-sweep-332 at: https://wandb.ai/xzy11632/dance-dev/runs/np4y2fmb
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_060913-np4y2fmb/logs
wandb: ERROR Run np4y2fmb errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: 17r4eo2k with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_060935-17r4eo2k
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glorious-sweep-333
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/17r4eo2k
[INFO][2024-03-18 06:09:40,493][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 06:09:40,586][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 06:09:40,587][dance][wrapped_func] Took 0:00:00.092944 to load and process data.
[INFO][2024-03-18 06:09:40,587][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 06:09:40,588][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run glorious-sweep-333 at: https://wandb.ai/xzy11632/dance-dev/runs/17r4eo2k
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_060935-17r4eo2k/logs
wandb: ERROR Run 17r4eo2k errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: r9uyojd7 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_060951-r9uyojd7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run light-sweep-334
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/r9uyojd7
[INFO][2024-03-18 06:09:57,661][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 06:09:57,760][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 06:09:57,760][dance][wrapped_func] Took 0:00:00.098280 to load and process data.
[INFO][2024-03-18 06:09:57,760][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 06:09:57,762][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:208: RuntimeWarning: overflow encountered in expm1
  np.expm1(X, out=X)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:11: RuntimeWarning: overflow encountered in multiply
  mean_sq = np.multiply(X, X).mean(axis=axis, dtype=np.float64)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_utils.py:12: RuntimeWarning: invalid value encountered in subtract
  var = mean_sq - mean**2
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run light-sweep-334 at: https://wandb.ai/xzy11632/dance-dev/runs/r9uyojd7
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_060951-r9uyojd7/logs
wandb: ERROR Run r9uyojd7 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/interface.py", line 68, in __call__
wandb: ERROR     self.func(data.data, **self.func_kwargs)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 453, in highly_variable_genes
wandb: ERROR     df = _highly_variable_genes_single_batch(
wandb: ERROR          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py", line 225, in _highly_variable_genes_single_batch
wandb: ERROR     df["mean_bin"] = pd.cut(df["means"], bins=n_bins)
wandb: ERROR                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/pandas/core/reshape/tile.py", line 263, in cut
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: cannot specify integer `bins` when input data contains infinity
wandb: ERROR 
wandb: Agent Starting Run: 8rmbvhio with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_061009-8rmbvhio
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run northern-sweep-335
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/8rmbvhio
[INFO][2024-03-18 06:10:15,769][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 06:10:15,870][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 06:10:15,870][dance][wrapped_func] Took 0:00:00.100300 to load and process data.
[INFO][2024-03-18 06:10:15,870][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 06:10:15,872][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-18 06:10:16,533][dance.WeightedFeaturePCA][__call__] Decomposing train features (5917, 200) (k=9)
[INFO][2024-03-18 06:10:16,534][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.45%
[INFO][2024-03-18 06:10:18,623][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 06:10:18,624][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 06:10:18,624][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 06:10:18,624][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:29,  1.10it/s]  2%|‚ñè         | 2/100 [00:01<01:23,  1.18it/s]  3%|‚ñé         | 3/100 [00:02<01:21,  1.19it/s]  4%|‚ñç         | 4/100 [00:03<01:20,  1.19it/s]  5%|‚ñå         | 5/100 [00:04<01:19,  1.19it/s]  6%|‚ñå         | 6/100 [00:05<01:23,  1.13it/s]  7%|‚ñã         | 7/100 [00:05<01:18,  1.19it/s]  8%|‚ñä         | 8/100 [00:06<01:14,  1.24it/s]  9%|‚ñâ         | 9/100 [00:07<01:12,  1.25it/s] 10%|‚ñà         | 10/100 [00:08<01:12,  1.25it/s] 11%|‚ñà         | 11/100 [00:09<01:16,  1.16it/s] 12%|‚ñà‚ñè        | 12/100 [00:10<01:16,  1.16it/s] 13%|‚ñà‚ñé        | 13/100 [00:11<01:15,  1.15it/s] 14%|‚ñà‚ñç        | 14/100 [00:11<01:16,  1.13it/s] 15%|‚ñà‚ñå        | 15/100 [00:12<01:14,  1.14it/s] 16%|‚ñà‚ñå        | 16/100 [00:13<01:13,  1.15it/s] 17%|‚ñà‚ñã        | 17/100 [00:14<01:12,  1.14it/s] 18%|‚ñà‚ñä        | 18/100 [00:15<01:10,  1.17it/s] 19%|‚ñà‚ñâ        | 19/100 [00:16<01:10,  1.16it/s] 20%|‚ñà‚ñà        | 20/100 [00:17<01:11,  1.12it/s] 21%|‚ñà‚ñà        | 21/100 [00:18<01:11,  1.11it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:18<01:08,  1.13it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:19<01:07,  1.15it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:20<01:05,  1.15it/s] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:21<01:04,  1.16it/s] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:22<01:03,  1.17it/s] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:23<01:02,  1.16it/s] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:24<01:03,  1.14it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:25<01:03,  1.12it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:25<01:02,  1.12it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:26<01:02,  1.11it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:27<01:00,  1.13it/s] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:28<00:58,  1.14it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:29<00:57,  1.14it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:30<00:58,  1.10it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:31<01:09,  1.09s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:33<01:09,  1.10s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:34<01:11,  1.15s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:35<01:04,  1.05s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:35<00:57,  1.04it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:36<00:52,  1.12it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:37<00:49,  1.17it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:38<00:47,  1.21it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:38<00:45,  1.22it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:40<00:49,  1.11it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:40<00:48,  1.12it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:41<00:45,  1.17it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:42<00:44,  1.16it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:43<00:43,  1.18it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:44<00:46,  1.07it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:45<00:46,  1.06it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:46<00:46,  1.03it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:47<00:43,  1.07it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:48<00:41,  1.10it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:48<00:38,  1.16it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:49<00:35,  1.23it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [00:50<00:35,  1.20it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [00:51<00:34,  1.21it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [00:52<00:36,  1.14it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [00:53<00:41,  1.03s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [00:54<00:38,  1.00it/s] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [00:55<00:36,  1.05it/s] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [00:56<00:34,  1.06it/s] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [00:57<00:32,  1.10it/s] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [00:58<00:33,  1.05it/s] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [00:59<00:35,  1.06s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:01<00:40,  1.24s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:02<00:43,  1.37s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:04<00:45,  1.46s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:05<00:41,  1.38s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:06<00:35,  1.22s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:07<00:32,  1.16s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:09<00:32,  1.20s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:09<00:28,  1.10s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:10<00:26,  1.07s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:11<00:23,  1.02it/s] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:12<00:21,  1.06it/s] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:13<00:20,  1.08it/s] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:14<00:19,  1.09it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:15<00:17,  1.14it/s] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:15<00:16,  1.15it/s] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:16<00:15,  1.16it/s] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:17<00:14,  1.21it/s] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:18<00:12,  1.24it/s] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:18<00:11,  1.30it/s] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:19<00:10,  1.31it/s] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:20<00:09,  1.31it/s] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:21<00:09,  1.29it/s] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:22<00:08,  1.27it/s] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:22<00:08,  1.23it/s] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:23<00:07,  1.19it/s] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:24<00:06,  1.20it/s] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:25<00:06,  1.16it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:26<00:05,  1.17it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:27<00:04,  1.14it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:28<00:03,  1.11it/s] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:29<00:02,  1.07it/s] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:30<00:02,  1.03s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:31<00:01,  1.02s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:32<00:00,  1.00it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:32<00:00,  1.08it/s]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.28166
wandb: 
wandb: üöÄ View run northern-sweep-335 at: https://wandb.ai/xzy11632/dance-dev/runs/8rmbvhio
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_061009-8rmbvhio/logs
wandb: Agent Starting Run: a2zv57mf with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: NormalizeTotal
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_061301-a2zv57mf
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run iconic-sweep-336
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/a2zv57mf
[INFO][2024-03-18 06:13:06,885][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 06:13:07,020][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 06:13:07,021][dance][wrapped_func] Took 0:00:00.135213 to load and process data.
[INFO][2024-03-18 06:13:07,021][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 06:13:07,023][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'NormalizeTotal',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-18 06:13:09,511][dance.WeightedFeatureSVD][__call__] Decomposing train features (5917, 200) (k=12)
[INFO][2024-03-18 06:13:09,511][dance.WeightedFeatureSVD][__call__] Total explained variance: 92.23%
[INFO][2024-03-18 06:13:11,534][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 06:13:11,535][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 06:13:11,535][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 06:13:11,536][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: NormalizeTotal
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:29,  1.11it/s]  2%|‚ñè         | 2/100 [00:01<01:32,  1.06it/s]  3%|‚ñé         | 3/100 [00:02<01:34,  1.03it/s]  4%|‚ñç         | 4/100 [00:03<01:29,  1.07it/s]  5%|‚ñå         | 5/100 [00:04<01:23,  1.14it/s]  6%|‚ñå         | 6/100 [00:05<01:26,  1.08it/s]  7%|‚ñã         | 7/100 [00:06<01:23,  1.11it/s]  8%|‚ñä         | 8/100 [00:07<01:24,  1.08it/s]  9%|‚ñâ         | 9/100 [00:08<01:22,  1.10it/s] 10%|‚ñà         | 10/100 [00:09<01:21,  1.11it/s] 11%|‚ñà         | 11/100 [00:09<01:17,  1.15it/s] 12%|‚ñà‚ñè        | 12/100 [00:10<01:15,  1.17it/s] 13%|‚ñà‚ñé        | 13/100 [00:11<01:13,  1.19it/s] 14%|‚ñà‚ñç        | 14/100 [00:12<01:12,  1.19it/s] 15%|‚ñà‚ñå        | 15/100 [00:13<01:11,  1.19it/s] 16%|‚ñà‚ñå        | 16/100 [00:14<01:11,  1.18it/s] 17%|‚ñà‚ñã        | 17/100 [00:15<01:12,  1.15it/s] 18%|‚ñà‚ñä        | 18/100 [00:15<01:08,  1.19it/s] 19%|‚ñà‚ñâ        | 19/100 [00:16<01:06,  1.22it/s] 20%|‚ñà‚ñà        | 20/100 [00:17<01:09,  1.16it/s] 21%|‚ñà‚ñà        | 21/100 [00:18<01:06,  1.18it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:19<01:09,  1.13it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:20<01:05,  1.17it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:20<01:05,  1.16it/s] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:21<01:01,  1.21it/s] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:22<01:00,  1.22it/s] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:23<00:58,  1.24it/s] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:24<00:58,  1.23it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:24<00:57,  1.24it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:25<00:57,  1.21it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:26<01:00,  1.14it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:27<01:00,  1.12it/s] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:28<00:58,  1.15it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:29<00:57,  1.15it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:30<00:54,  1.19it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:31<00:53,  1.19it/s] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:31<00:51,  1.23it/s] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:32<00:49,  1.24it/s] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:33<00:50,  1.22it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:34<00:51,  1.17it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:35<00:50,  1.16it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:36<00:58,  1.00s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:37<01:00,  1.06s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:39<01:03,  1.14s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:39<00:58,  1.06s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:40<00:53,  1.00it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:41<00:49,  1.08it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:42<00:46,  1.12it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:43<00:43,  1.18it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:43<00:40,  1.23it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:44<00:38,  1.28it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:45<00:38,  1.24it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:46<00:36,  1.27it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:46<00:35,  1.29it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:47<00:35,  1.27it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:48<00:35,  1.26it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [00:49<00:33,  1.28it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [00:50<00:33,  1.26it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [00:50<00:31,  1.29it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [00:51<00:30,  1.33it/s] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [00:52<00:28,  1.35it/s] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [00:53<00:29,  1.30it/s] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [00:54<00:31,  1.17it/s] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [00:55<00:39,  1.10s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [00:57<00:40,  1.15s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [00:58<00:42,  1.26s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:00<00:45,  1.37s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:01<00:43,  1.36s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:02<00:42,  1.36s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:04<00:42,  1.43s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:06<00:43,  1.49s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:08<00:44,  1.60s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:09<00:40,  1.51s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:10<00:39,  1.51s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:12<00:36,  1.46s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:13<00:33,  1.41s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:14<00:30,  1.34s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:16<00:30,  1.39s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:17<00:29,  1.39s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:19<00:28,  1.42s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:20<00:27,  1.47s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:22<00:26,  1.49s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:23<00:24,  1.45s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:25<00:24,  1.53s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:26<00:21,  1.42s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:27<00:19,  1.41s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:28<00:16,  1.30s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:29<00:15,  1.25s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:31<00:13,  1.27s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:32<00:12,  1.28s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:33<00:11,  1.30s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:35<00:10,  1.26s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:35<00:07,  1.13s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:36<00:06,  1.11s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:37<00:05,  1.07s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:38<00:04,  1.03s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:39<00:02,  1.03it/s] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:40<00:01,  1.00it/s] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:41<00:00,  1.06it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:42<00:00,  1.11it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:42<00:00,  1.02s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.017 MB of 0.025 MB uploadedwandb: | 0.017 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.22215
wandb: 
wandb: üöÄ View run iconic-sweep-336 at: https://wandb.ai/xzy11632/dance-dev/runs/a2zv57mf
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_061301-a2zv57mf/logs
wandb: Agent Starting Run: qmatodxm with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_061546-qmatodxm
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run pretty-sweep-337
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/qmatodxm
[INFO][2024-03-18 06:15:51,766][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 06:15:51,841][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 06:15:51,841][dance][wrapped_func] Took 0:00:00.072774 to load and process data.
[INFO][2024-03-18 06:15:51,841][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 06:15:51,844][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 06:15:51,859][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[WARNING][2024-03-18 06:16:52,079][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 06:17:02,949][dance.WeightedFeaturePCA][__call__] Decomposing train features (5917, 919) (k=526)
[INFO][2024-03-18 06:17:02,951][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.01%
[INFO][2024-03-18 06:17:21,793][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 06:17:21,794][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 06:17:21,794][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 06:17:21,794][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:15,  1.37s/it]  2%|‚ñè         | 2/100 [00:02<02:15,  1.39s/it]  3%|‚ñé         | 3/100 [00:04<02:08,  1.33s/it]  4%|‚ñç         | 4/100 [00:05<02:03,  1.28s/it]  5%|‚ñå         | 5/100 [00:06<01:57,  1.24s/it]  6%|‚ñå         | 6/100 [00:07<01:57,  1.25s/it]  7%|‚ñã         | 7/100 [00:09<01:59,  1.28s/it]  8%|‚ñä         | 8/100 [00:10<02:00,  1.31s/it]  9%|‚ñâ         | 9/100 [00:11<01:56,  1.28s/it] 10%|‚ñà         | 10/100 [00:12<01:57,  1.30s/it] 11%|‚ñà         | 11/100 [00:14<02:13,  1.50s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<02:12,  1.50s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<02:10,  1.50s/it] 14%|‚ñà‚ñç        | 14/100 [00:19<02:15,  1.58s/it] 15%|‚ñà‚ñå        | 15/100 [00:21<02:11,  1.55s/it] 16%|‚ñà‚ñå        | 16/100 [00:22<02:07,  1.52s/it] 17%|‚ñà‚ñã        | 17/100 [00:23<01:56,  1.40s/it] 18%|‚ñà‚ñä        | 18/100 [00:24<01:47,  1.32s/it] 19%|‚ñà‚ñâ        | 19/100 [00:26<01:47,  1.32s/it] 20%|‚ñà‚ñà        | 20/100 [00:27<01:44,  1.30s/it] 21%|‚ñà‚ñà        | 21/100 [00:30<02:26,  1.86s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:33<02:46,  2.14s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:36<02:58,  2.32s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:38<03:04,  2.43s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:41<03:09,  2.53s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:44<03:13,  2.61s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:46<03:11,  2.62s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:48<02:50,  2.37s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:49<02:21,  2.00s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:50<01:59,  1.70s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:51<01:41,  1.47s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:52<01:28,  1.30s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:53<01:19,  1.19s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:54<01:12,  1.10s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:55<01:10,  1.08s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:56<01:06,  1.04s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:57<01:04,  1.02s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:58<01:02,  1.00s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:59<00:58,  1.04it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:00<00:55,  1.08it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:01<00:56,  1.04it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:02<00:55,  1.04it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:03<00:54,  1.04it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:04<00:55,  1.00it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:05<00:54,  1.01it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:06<00:52,  1.03it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:06<00:49,  1.07it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:07<00:47,  1.08it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:08<00:46,  1.10it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:09<00:48,  1.03it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:10<00:48,  1.01it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:11<00:48,  1.00s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:12<00:45,  1.03it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:13<00:43,  1.05it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:14<00:43,  1.04it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:15<00:42,  1.03it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:16<00:42,  1.01it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:17<00:41,  1.02it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:18<00:41,  1.02s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:20<00:42,  1.07s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:22<00:57,  1.47s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:25<01:10,  1.85s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:28<01:19,  2.16s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:30<01:22,  2.30s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:33<01:23,  2.38s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:35<01:24,  2.49s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:38<01:24,  2.57s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:41<01:21,  2.54s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:43<01:17,  2.51s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:45<01:12,  2.42s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:48<01:12,  2.50s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:50<01:08,  2.44s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:51<00:53,  2.00s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:53<00:50,  1.92s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:55<00:46,  1.84s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:57<00:43,  1.82s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:59<00:43,  1.89s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:01<00:42,  1.93s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:02<00:39,  1.90s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:04<00:34,  1.70s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:05<00:29,  1.55s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:06<00:26,  1.48s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:07<00:23,  1.41s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:09<00:21,  1.34s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:10<00:18,  1.25s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:11<00:17,  1.24s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:12<00:16,  1.25s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:13<00:15,  1.28s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:15<00:14,  1.29s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:16<00:12,  1.28s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:17<00:11,  1.25s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:18<00:09,  1.25s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:20<00:08,  1.25s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:21<00:07,  1.26s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:22<00:06,  1.27s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:25<00:06,  1.67s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:28<00:06,  2.17s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:32<00:05,  2.73s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:36<00:03,  3.09s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:39<00:00,  2.99s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:39<00:00,  1.59s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.32341
wandb: 
wandb: üöÄ View run pretty-sweep-337 at: https://wandb.ai/xzy11632/dance-dev/runs/qmatodxm
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_061546-qmatodxm/logs
wandb: Agent Starting Run: 6bkmydkr with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_062104-6bkmydkr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run olive-sweep-338
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/6bkmydkr
[INFO][2024-03-18 06:21:10,532][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 06:21:10,662][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 06:21:10,663][dance][wrapped_func] Took 0:00:00.128684 to load and process data.
[INFO][2024-03-18 06:21:10,663][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 06:21:10,665][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 06:21:10,709][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[WARNING][2024-03-18 06:21:58,681][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 06:22:17,794][dance.WeightedFeatureSVD][__call__] Decomposing train features (5917, 919) (k=535)
[INFO][2024-03-18 06:22:17,795][dance.WeightedFeatureSVD][__call__] Total explained variance: 90.10%
[INFO][2024-03-18 06:22:57,151][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 06:22:57,151][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 06:22:57,151][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 06:22:57,151][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:50,  1.12s/it]  2%|‚ñè         | 2/100 [00:02<02:06,  1.29s/it]  3%|‚ñé         | 3/100 [00:05<03:22,  2.09s/it]  4%|‚ñç         | 4/100 [00:08<03:46,  2.36s/it]  5%|‚ñå         | 5/100 [00:11<04:10,  2.63s/it]  6%|‚ñå         | 6/100 [00:13<04:01,  2.57s/it]  7%|‚ñã         | 7/100 [00:16<04:00,  2.59s/it]  8%|‚ñä         | 8/100 [00:19<03:59,  2.61s/it]  9%|‚ñâ         | 9/100 [00:22<04:06,  2.71s/it] 10%|‚ñà         | 10/100 [00:24<04:00,  2.68s/it] 11%|‚ñà         | 11/100 [00:27<04:02,  2.73s/it] 12%|‚ñà‚ñè        | 12/100 [00:30<03:53,  2.65s/it] 13%|‚ñà‚ñé        | 13/100 [00:32<03:37,  2.50s/it] 14%|‚ñà‚ñç        | 14/100 [00:35<03:54,  2.72s/it] 15%|‚ñà‚ñå        | 15/100 [00:38<04:04,  2.88s/it] 16%|‚ñà‚ñå        | 16/100 [00:41<04:00,  2.86s/it] 17%|‚ñà‚ñã        | 17/100 [00:44<04:04,  2.95s/it] 18%|‚ñà‚ñä        | 18/100 [00:47<04:08,  3.02s/it] 19%|‚ñà‚ñâ        | 19/100 [00:50<04:06,  3.04s/it] 20%|‚ñà‚ñà        | 20/100 [00:54<04:08,  3.11s/it] 21%|‚ñà‚ñà        | 21/100 [00:57<04:04,  3.10s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [01:00<03:59,  3.06s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [01:02<03:44,  2.92s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [01:05<03:43,  2.94s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [01:08<03:33,  2.85s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [01:09<02:58,  2.41s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [01:11<02:40,  2.19s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [01:13<02:31,  2.10s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [01:15<02:27,  2.08s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [01:17<02:20,  2.01s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [01:19<02:16,  1.97s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:21<02:11,  1.94s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:22<02:00,  1.80s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:23<01:48,  1.65s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:25<01:40,  1.55s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:26<01:32,  1.44s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:27<01:29,  1.42s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:28<01:22,  1.33s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:29<01:16,  1.26s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:31<01:17,  1.29s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:32<01:14,  1.26s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:33<01:13,  1.27s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:35<01:15,  1.33s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:36<01:12,  1.29s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:37<01:08,  1.24s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:38<01:08,  1.26s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:40<01:05,  1.24s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:41<01:07,  1.30s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:42<01:05,  1.28s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:45<01:23,  1.68s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:48<01:50,  2.25s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:52<02:10,  2.72s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:56<02:20,  2.99s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [02:00<02:28,  3.22s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [02:03<02:26,  3.26s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [02:05<02:11,  2.98s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [02:07<01:58,  2.75s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [02:10<01:51,  2.64s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [02:12<01:46,  2.61s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [02:15<01:38,  2.46s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [02:16<01:21,  2.10s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [02:17<01:09,  1.84s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [02:18<01:00,  1.63s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [02:19<00:52,  1.46s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [02:20<00:46,  1.33s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [02:21<00:41,  1.23s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [02:22<00:39,  1.21s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [02:24<00:38,  1.20s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [02:25<00:36,  1.19s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [02:26<00:36,  1.21s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:27<00:35,  1.24s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:29<00:35,  1.26s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:30<00:34,  1.29s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:31<00:33,  1.27s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:32<00:31,  1.27s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:34<00:30,  1.27s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:35<00:29,  1.29s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:36<00:28,  1.29s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:38<00:26,  1.25s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:39<00:24,  1.23s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:40<00:22,  1.20s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:41<00:21,  1.19s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:42<00:20,  1.20s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:43<00:18,  1.17s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:44<00:17,  1.14s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:46<00:16,  1.14s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:47<00:14,  1.13s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:48<00:13,  1.14s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:49<00:12,  1.14s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:50<00:11,  1.13s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:51<00:10,  1.20s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:53<00:09,  1.21s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:54<00:08,  1.23s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:55<00:07,  1.21s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:56<00:06,  1.21s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:57<00:04,  1.15s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:58<00:03,  1.07s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:59<00:02,  1.05s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [03:00<00:01,  1.05s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:01<00:00,  1.02s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [03:01<00:00,  1.82s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.33431
wandb: 
wandb: üöÄ View run olive-sweep-338 at: https://wandb.ai/xzy11632/dance-dev/runs/6bkmydkr
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_062104-6bkmydkr/logs
wandb: Agent Starting Run: 8sbe7y3o with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_062702-8sbe7y3o
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rare-sweep-339
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/8sbe7y3o
[INFO][2024-03-18 06:27:06,835][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 06:27:06,925][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 06:27:06,925][dance][wrapped_func] Took 0:00:00.089323 to load and process data.
[INFO][2024-03-18 06:27:06,925][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 06:27:06,929][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-18 06:27:58,760][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.018 MB of 0.024 MB uploadedwandb: | 0.018 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run rare-sweep-339 at: https://wandb.ai/xzy11632/dance-dev/runs/8sbe7y3o
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_062702-8sbe7y3o/logs
wandb: ERROR Run 8sbe7y3o errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1081) out of bounds (919)
wandb: ERROR 
wandb: Agent Starting Run: n7e2otfg with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_062811-n7e2otfg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run faithful-sweep-340
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/n7e2otfg
[INFO][2024-03-18 06:28:17,097][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 06:28:17,194][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 06:28:17,194][dance][wrapped_func] Took 0:00:00.096111 to load and process data.
[INFO][2024-03-18 06:28:17,194][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 06:28:17,198][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-18 06:29:19,739][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run faithful-sweep-340 at: https://wandb.ai/xzy11632/dance-dev/runs/n7e2otfg
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_062811-n7e2otfg/logs
wandb: ERROR Run n7e2otfg errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1081) out of bounds (919)
wandb: ERROR 
wandb: Agent Starting Run: v2ahwz4u with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_062935-v2ahwz4u
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run silver-sweep-341
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/v2ahwz4u
[INFO][2024-03-18 06:29:40,955][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 06:29:41,037][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 06:29:41,037][dance][wrapped_func] Took 0:00:00.081782 to load and process data.
[INFO][2024-03-18 06:29:41,037][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 06:29:41,039][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-18 06:30:35,927][dance.WeightedFeaturePCA][__call__] Decomposing train features (5917, 200) (k=88)
[INFO][2024-03-18 06:30:35,929][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.04%
[INFO][2024-03-18 06:30:37,248][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 06:30:37,248][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 06:30:37,249][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 06:30:37,249][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:14,  1.33it/s]  2%|‚ñè         | 2/100 [00:01<01:10,  1.38it/s]  3%|‚ñé         | 3/100 [00:02<01:14,  1.30it/s]  4%|‚ñç         | 4/100 [00:03<01:13,  1.31it/s]  5%|‚ñå         | 5/100 [00:03<01:12,  1.31it/s]  6%|‚ñå         | 6/100 [00:04<01:15,  1.24it/s]  7%|‚ñã         | 7/100 [00:05<01:14,  1.25it/s]  8%|‚ñä         | 8/100 [00:06<01:16,  1.20it/s]  9%|‚ñâ         | 9/100 [00:07<01:14,  1.22it/s] 10%|‚ñà         | 10/100 [00:07<01:11,  1.25it/s] 11%|‚ñà         | 11/100 [00:08<01:11,  1.25it/s] 12%|‚ñà‚ñè        | 12/100 [00:09<01:10,  1.25it/s] 13%|‚ñà‚ñé        | 13/100 [00:10<01:11,  1.22it/s] 14%|‚ñà‚ñç        | 14/100 [00:11<01:10,  1.22it/s] 15%|‚ñà‚ñå        | 15/100 [00:12<01:09,  1.22it/s] 16%|‚ñà‚ñå        | 16/100 [00:12<01:11,  1.17it/s] 17%|‚ñà‚ñã        | 17/100 [00:13<01:14,  1.12it/s] 18%|‚ñà‚ñä        | 18/100 [00:14<01:12,  1.13it/s] 19%|‚ñà‚ñâ        | 19/100 [00:15<01:10,  1.15it/s] 20%|‚ñà‚ñà        | 20/100 [00:16<01:10,  1.13it/s] 21%|‚ñà‚ñà        | 21/100 [00:17<01:09,  1.14it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:18<01:09,  1.13it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:19<01:07,  1.13it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:20<01:08,  1.11it/s] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:21<01:06,  1.13it/s] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:21<01:06,  1.12it/s] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:22<01:04,  1.13it/s] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:23<01:04,  1.11it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:24<01:02,  1.14it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:25<01:01,  1.14it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:26<01:02,  1.11it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:27<01:00,  1.13it/s] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:28<00:58,  1.15it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:28<00:57,  1.14it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:29<00:57,  1.12it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:30<00:56,  1.13it/s] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:31<00:55,  1.14it/s] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:32<00:53,  1.15it/s] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:33<00:53,  1.14it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:34<00:52,  1.15it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:35<00:51,  1.15it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:35<00:48,  1.18it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:36<00:48,  1.19it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:37<00:47,  1.19it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:38<00:45,  1.20it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:39<00:44,  1.21it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:39<00:42,  1.23it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:40<00:42,  1.23it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:41<00:41,  1.23it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:42<00:39,  1.27it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:43<00:37,  1.31it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:43<00:37,  1.27it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:44<00:37,  1.25it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:45<00:37,  1.24it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:46<00:37,  1.21it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:47<00:36,  1.20it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [00:48<00:36,  1.17it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [00:48<00:35,  1.17it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [00:50<00:38,  1.06it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [00:51<00:37,  1.07it/s] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [00:51<00:35,  1.11it/s] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [00:52<00:33,  1.12it/s] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [00:53<00:32,  1.15it/s] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [00:54<00:31,  1.14it/s] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [00:55<00:30,  1.16it/s] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [00:56<00:29,  1.14it/s] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [00:57<00:28,  1.14it/s] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [00:57<00:28,  1.14it/s] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [00:58<00:26,  1.17it/s] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [00:59<00:24,  1.22it/s] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:00<00:23,  1.25it/s] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:01<00:22,  1.24it/s] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:01<00:21,  1.28it/s] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:02<00:21,  1.23it/s] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:03<00:19,  1.25it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:04<00:20,  1.19it/s] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:05<00:20,  1.14it/s] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:06<00:19,  1.14it/s] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:07<00:20,  1.03it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:08<00:22,  1.12s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:10<00:21,  1.13s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:11<00:21,  1.19s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:12<00:19,  1.17s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:13<00:19,  1.24s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:15<00:19,  1.29s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:16<00:18,  1.30s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:17<00:16,  1.28s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:19<00:15,  1.28s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:20<00:14,  1.31s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:21<00:12,  1.26s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:22<00:10,  1.22s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:24<00:09,  1.24s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:25<00:08,  1.23s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:26<00:07,  1.22s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:27<00:05,  1.19s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:28<00:04,  1.21s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:30<00:03,  1.21s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:31<00:02,  1.22s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:32<00:01,  1.21s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:33<00:00,  1.22s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:33<00:00,  1.07it/s]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.018 MB uploadedwandb: \ 0.012 MB of 0.018 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.31252
wandb: 
wandb: üöÄ View run silver-sweep-341 at: https://wandb.ai/xzy11632/dance-dev/runs/v2ahwz4u
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_062935-v2ahwz4u/logs
wandb: Agent Starting Run: 5wmr798a with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_063325-5wmr798a
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run graceful-sweep-342
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/5wmr798a
[INFO][2024-03-18 06:33:31,518][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 06:33:31,624][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 06:33:31,624][dance][wrapped_func] Took 0:00:00.105483 to load and process data.
[INFO][2024-03-18 06:33:31,624][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 06:33:31,626][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-18 06:34:36,882][dance.WeightedFeatureSVD][__call__] Decomposing train features (5917, 200) (k=87)
[INFO][2024-03-18 06:34:36,893][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.70%
[INFO][2024-03-18 06:34:38,821][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 06:34:38,822][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 06:34:38,822][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 06:34:38,823][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:24,  1.17it/s]  2%|‚ñè         | 2/100 [00:01<01:28,  1.11it/s]  3%|‚ñé         | 3/100 [00:02<01:29,  1.09it/s]  4%|‚ñç         | 4/100 [00:03<01:28,  1.09it/s]  5%|‚ñå         | 5/100 [00:04<01:24,  1.13it/s]  6%|‚ñå         | 6/100 [00:05<01:23,  1.13it/s]  7%|‚ñã         | 7/100 [00:06<01:24,  1.10it/s]  8%|‚ñä         | 8/100 [00:07<01:23,  1.10it/s]  9%|‚ñâ         | 9/100 [00:08<01:24,  1.08it/s] 10%|‚ñà         | 10/100 [00:09<01:23,  1.08it/s] 11%|‚ñà         | 11/100 [00:10<01:24,  1.06it/s] 12%|‚ñà‚ñè        | 12/100 [00:10<01:20,  1.10it/s] 13%|‚ñà‚ñé        | 13/100 [00:11<01:17,  1.13it/s] 14%|‚ñà‚ñç        | 14/100 [00:12<01:15,  1.14it/s] 15%|‚ñà‚ñå        | 15/100 [00:13<01:16,  1.11it/s] 16%|‚ñà‚ñå        | 16/100 [00:14<01:15,  1.12it/s] 17%|‚ñà‚ñã        | 17/100 [00:15<01:15,  1.09it/s] 18%|‚ñà‚ñä        | 18/100 [00:16<01:13,  1.11it/s] 19%|‚ñà‚ñâ        | 19/100 [00:17<01:10,  1.15it/s] 20%|‚ñà‚ñà        | 20/100 [00:17<01:08,  1.16it/s] 21%|‚ñà‚ñà        | 21/100 [00:18<01:08,  1.16it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:19<01:10,  1.11it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:20<01:10,  1.10it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:21<01:09,  1.10it/s] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:22<01:10,  1.06it/s] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:23<01:07,  1.10it/s] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:24<01:01,  1.18it/s] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:24<00:59,  1.21it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:25<00:57,  1.22it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:26<00:58,  1.19it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:27<01:02,  1.11it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:28<01:02,  1.08it/s] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:29<01:03,  1.05it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:30<01:04,  1.03it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:31<01:02,  1.03it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:32<01:04,  1.01s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:33<01:07,  1.07s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:35<01:11,  1.16s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:36<01:12,  1.19s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:37<01:13,  1.22s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:38<01:06,  1.12s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:39<01:00,  1.04s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:40<00:56,  1.01it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:41<00:54,  1.03it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:42<00:57,  1.04s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:43<00:55,  1.02s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:44<00:54,  1.04s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:45<00:52,  1.02s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:46<00:48,  1.04it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:47<00:45,  1.10it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:48<00:43,  1.14it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:48<00:41,  1.14it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:49<00:41,  1.14it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:50<00:42,  1.09it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:51<00:41,  1.08it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:52<00:39,  1.10it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [00:53<00:39,  1.09it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [00:54<00:37,  1.13it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [00:55<00:35,  1.14it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [00:56<00:34,  1.16it/s] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [00:56<00:33,  1.17it/s] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [00:57<00:32,  1.17it/s] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [00:58<00:31,  1.18it/s] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [00:59<00:32,  1.09it/s] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:00<00:31,  1.10it/s] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:01<00:30,  1.12it/s] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:02<00:29,  1.14it/s] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:03<00:27,  1.15it/s] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:03<00:26,  1.15it/s] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:04<00:26,  1.12it/s] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:05<00:25,  1.14it/s] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:06<00:24,  1.13it/s] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:07<00:23,  1.15it/s] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:08<00:22,  1.17it/s] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:09<00:21,  1.16it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:10<00:20,  1.18it/s] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:10<00:18,  1.23it/s] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:11<00:17,  1.24it/s] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:12<00:17,  1.22it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:13<00:17,  1.17it/s] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:14<00:16,  1.17it/s] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:15<00:15,  1.16it/s] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:15<00:14,  1.18it/s] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:16<00:13,  1.17it/s] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:17<00:12,  1.20it/s] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:18<00:11,  1.20it/s] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:19<00:10,  1.20it/s] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:20<00:10,  1.16it/s] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:20<00:09,  1.16it/s] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:22<00:09,  1.03it/s] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:23<00:09,  1.04s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:24<00:08,  1.09s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:25<00:07,  1.08s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:26<00:06,  1.05s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:27<00:05,  1.00s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:28<00:03,  1.03it/s] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:29<00:02,  1.10it/s] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:29<00:01,  1.17it/s] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:30<00:00,  1.23it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:31<00:00,  1.26it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:31<00:00,  1.09it/s]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.018 MB of 0.025 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.29093
wandb: 
wandb: üöÄ View run graceful-sweep-342 at: https://wandb.ai/xzy11632/dance-dev/runs/5wmr798a
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_063325-5wmr798a/logs
wandb: Agent Starting Run: c53103em with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_063718-c53103em
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wild-sweep-343
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/c53103em
[INFO][2024-03-18 06:37:23,742][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 06:37:23,857][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 06:37:23,858][dance][wrapped_func] Took 0:00:00.114318 to load and process data.
[INFO][2024-03-18 06:37:23,858][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 06:37:23,860][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-18 06:38:28,886][dance.WeightedFeaturePCA][__call__] Decomposing train features (5917, 227) (k=184)
[INFO][2024-03-18 06:38:28,887][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.08%
[INFO][2024-03-18 06:38:30,221][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 06:38:30,221][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 06:38:30,221][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 06:38:30,221][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:28,  1.12it/s]  2%|‚ñè         | 2/100 [00:01<01:32,  1.06it/s]  3%|‚ñé         | 3/100 [00:02<01:37,  1.00s/it]  4%|‚ñç         | 4/100 [00:03<01:34,  1.02it/s]  5%|‚ñå         | 5/100 [00:04<01:27,  1.09it/s]  6%|‚ñå         | 6/100 [00:05<01:24,  1.11it/s]  7%|‚ñã         | 7/100 [00:06<01:24,  1.10it/s]  8%|‚ñä         | 8/100 [00:07<01:22,  1.11it/s]  9%|‚ñâ         | 9/100 [00:08<01:22,  1.11it/s] 10%|‚ñà         | 10/100 [00:09<01:24,  1.07it/s] 11%|‚ñà         | 11/100 [00:10<01:20,  1.11it/s] 12%|‚ñà‚ñè        | 12/100 [00:11<01:21,  1.08it/s] 13%|‚ñà‚ñé        | 13/100 [00:11<01:17,  1.12it/s] 14%|‚ñà‚ñç        | 14/100 [00:12<01:14,  1.16it/s] 15%|‚ñà‚ñå        | 15/100 [00:13<01:12,  1.18it/s] 16%|‚ñà‚ñå        | 16/100 [00:14<01:10,  1.19it/s] 17%|‚ñà‚ñã        | 17/100 [00:15<01:10,  1.18it/s] 18%|‚ñà‚ñä        | 18/100 [00:16<01:12,  1.12it/s] 19%|‚ñà‚ñâ        | 19/100 [00:17<01:15,  1.07it/s] 20%|‚ñà‚ñà        | 20/100 [00:18<01:16,  1.04it/s] 21%|‚ñà‚ñà        | 21/100 [00:19<01:29,  1.14s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:21<01:34,  1.21s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:22<01:30,  1.18s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:23<01:29,  1.18s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:24<01:24,  1.13s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:25<01:19,  1.08s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:26<01:14,  1.01s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:27<01:10,  1.03it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:28<01:09,  1.02it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:29<01:09,  1.00it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:30<01:10,  1.02s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:31<01:10,  1.04s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:32<01:10,  1.05s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:33<01:06,  1.01s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:34<01:07,  1.04s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:35<01:05,  1.02s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:36<01:04,  1.02s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:37<01:05,  1.06s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:38<01:04,  1.06s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:39<01:02,  1.04s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:40<00:59,  1.01s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:42<01:12,  1.25s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:44<01:26,  1.51s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:46<01:32,  1.66s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:48<01:39,  1.81s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:50<01:45,  1.95s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:53<01:45,  2.00s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:55<01:43,  2.00s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:57<01:44,  2.05s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:59<01:42,  2.05s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:01<01:40,  2.05s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:03<01:34,  1.98s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:04<01:30,  1.92s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:06<01:29,  1.95s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:08<01:27,  1.95s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:10<01:18,  1.77s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:11<01:12,  1.68s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:13<01:06,  1.59s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:14<01:04,  1.56s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:16<01:02,  1.57s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:17<01:01,  1.57s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:19<01:00,  1.59s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:20<00:57,  1.56s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:22<00:54,  1.52s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:23<00:53,  1.53s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:25<00:51,  1.51s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:26<00:45,  1.39s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:27<00:42,  1.34s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:28<00:40,  1.30s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:29<00:35,  1.20s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:30<00:31,  1.10s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:31<00:30,  1.08s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:32<00:28,  1.07s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:33<00:27,  1.06s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:34<00:26,  1.05s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:35<00:24,  1.04s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:36<00:23,  1.04s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:37<00:22,  1.03s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:38<00:21,  1.01s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:39<00:19,  1.01it/s] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:40<00:18,  1.02it/s] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:42<00:19,  1.06s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:43<00:17,  1.04s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:44<00:16,  1.04s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:45<00:15,  1.06s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:46<00:15,  1.08s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:47<00:14,  1.13s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:48<00:14,  1.19s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:50<00:13,  1.21s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:51<00:12,  1.29s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:52<00:11,  1.31s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:54<00:10,  1.30s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:55<00:08,  1.19s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:56<00:06,  1.13s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:57<00:05,  1.09s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:58<00:04,  1.10s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:59<00:03,  1.07s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:00<00:02,  1.05s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:01<00:01,  1.03s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:02<00:00,  1.06s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:02<00:00,  1.22s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.28869
wandb: 
wandb: üöÄ View run wild-sweep-343 at: https://wandb.ai/xzy11632/dance-dev/runs/c53103em
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_063718-c53103em/logs
wandb: Agent Starting Run: scv9be2k with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_064200-scv9be2k
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run serene-sweep-344
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/scv9be2k
[INFO][2024-03-18 06:42:05,659][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 06:42:05,762][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 06:42:05,762][dance][wrapped_func] Took 0:00:00.102489 to load and process data.
[INFO][2024-03-18 06:42:05,762][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 06:42:05,764][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-18 06:43:43,716][dance.WeightedFeatureSVD][__call__] Decomposing train features (5917, 227) (k=185)
[INFO][2024-03-18 06:43:43,718][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.79%
[INFO][2024-03-18 06:47:46,063][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 06:47:46,064][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 06:47:46,064][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 06:47:46,064][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:02<03:48,  2.31s/it]  2%|‚ñè         | 2/100 [00:04<03:35,  2.20s/it]  3%|‚ñé         | 3/100 [00:07<03:51,  2.38s/it]  4%|‚ñç         | 4/100 [00:10<04:42,  2.95s/it]  5%|‚ñå         | 5/100 [00:13<04:41,  2.97s/it]  6%|‚ñå         | 6/100 [00:16<04:44,  3.02s/it]  7%|‚ñã         | 7/100 [00:19<04:34,  2.96s/it]  8%|‚ñä         | 8/100 [00:22<04:20,  2.83s/it]  9%|‚ñâ         | 9/100 [00:25<04:23,  2.89s/it] 10%|‚ñà         | 10/100 [00:28<04:22,  2.92s/it] 11%|‚ñà         | 11/100 [00:31<04:19,  2.92s/it] 12%|‚ñà‚ñè        | 12/100 [00:34<04:14,  2.90s/it] 13%|‚ñà‚ñé        | 13/100 [00:37<04:14,  2.93s/it] 14%|‚ñà‚ñç        | 14/100 [00:40<04:25,  3.08s/it] 15%|‚ñà‚ñå        | 15/100 [00:43<04:19,  3.06s/it] 16%|‚ñà‚ñå        | 16/100 [00:45<03:57,  2.83s/it] 17%|‚ñà‚ñã        | 17/100 [00:49<04:06,  2.97s/it] 18%|‚ñà‚ñä        | 18/100 [00:52<04:03,  2.96s/it] 19%|‚ñà‚ñâ        | 19/100 [00:55<04:00,  2.97s/it] 20%|‚ñà‚ñà        | 20/100 [00:57<03:45,  2.81s/it] 21%|‚ñà‚ñà        | 21/100 [01:00<03:50,  2.92s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [01:03<03:45,  2.89s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [01:06<03:53,  3.04s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [01:09<03:40,  2.90s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [01:12<03:44,  2.99s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [01:15<03:39,  2.97s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [01:18<03:27,  2.84s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [01:21<03:29,  2.91s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [01:24<03:31,  2.98s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [01:27<03:26,  2.94s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [01:29<03:12,  2.79s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [01:32<03:03,  2.70s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [01:34<02:58,  2.66s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [01:37<02:51,  2.60s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [01:39<02:48,  2.60s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [01:42<02:55,  2.74s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:46<03:00,  2.87s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:48<02:57,  2.87s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:51<02:50,  2.80s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:54<02:55,  2.92s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:57<02:52,  2.93s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:59<02:38,  2.74s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [02:02<02:34,  2.71s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [02:05<02:32,  2.72s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [02:08<02:31,  2.76s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [02:10<02:26,  2.71s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [02:13<02:26,  2.76s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [02:16<02:19,  2.68s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [02:18<02:12,  2.59s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [02:20<01:56,  2.34s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [02:22<01:53,  2.31s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [02:24<01:52,  2.35s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [02:27<01:48,  2.30s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [02:29<01:42,  2.22s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [02:31<01:37,  2.16s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [02:33<01:36,  2.19s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [02:35<01:31,  2.12s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [02:37<01:28,  2.11s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [02:39<01:28,  2.17s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [02:42<01:28,  2.21s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [02:44<01:27,  2.25s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [02:47<01:29,  2.37s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [02:49<01:25,  2.32s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [02:51<01:22,  2.29s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [02:53<01:19,  2.26s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [02:56<01:18,  2.32s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [02:58<01:16,  2.31s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [03:00<01:13,  2.30s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [03:02<01:07,  2.19s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [03:04<01:06,  2.20s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [03:07<01:04,  2.21s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [03:09<01:02,  2.22s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [03:11<00:56,  2.10s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [03:13<00:55,  2.15s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [03:15<00:55,  2.23s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [03:18<00:55,  2.30s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [03:20<00:53,  2.34s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [03:23<00:51,  2.36s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [03:25<00:49,  2.36s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [03:28<00:47,  2.40s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [03:30<00:47,  2.48s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [03:33<00:44,  2.45s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [03:35<00:41,  2.42s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [03:37<00:38,  2.43s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [03:40<00:37,  2.47s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [03:42<00:34,  2.46s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [03:45<00:31,  2.45s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [03:47<00:29,  2.43s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [03:49<00:25,  2.28s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [03:51<00:21,  2.17s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [03:53<00:19,  2.19s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [03:55<00:16,  2.10s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [03:57<00:14,  2.05s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [03:59<00:11,  1.89s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [04:00<00:08,  1.79s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [04:02<00:06,  1.73s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [04:04<00:05,  1.79s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [04:05<00:03,  1.73s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [04:07<00:01,  1.66s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [04:08<00:00,  1.56s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [04:08<00:00,  2.49s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.017 MB of 0.025 MB uploadedwandb: | 0.017 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.3706
wandb: 
wandb: üöÄ View run serene-sweep-344 at: https://wandb.ai/xzy11632/dance-dev/runs/scv9be2k
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_064200-scv9be2k/logs
wandb: Agent Starting Run: 9lzkv6tg with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_065318-9lzkv6tg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ethereal-sweep-345
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/9lzkv6tg
[INFO][2024-03-18 06:53:23,390][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 06:53:23,492][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 06:53:23,493][dance][wrapped_func] Took 0:00:00.102068 to load and process data.
[INFO][2024-03-18 06:53:23,493][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 06:53:23,495][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-18 06:54:20,182][dance.WeightedFeaturePCA][__call__] Decomposing train features (5917, 200) (k=145)
[INFO][2024-03-18 06:54:20,183][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.08%
[INFO][2024-03-18 06:54:23,111][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 06:54:23,111][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 06:54:23,112][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 06:54:23,112][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:02<03:42,  2.25s/it]  2%|‚ñè         | 2/100 [00:04<03:21,  2.05s/it]  3%|‚ñé         | 3/100 [00:05<02:53,  1.79s/it]  4%|‚ñç         | 4/100 [00:07<02:37,  1.64s/it]  5%|‚ñå         | 5/100 [00:08<02:29,  1.57s/it]  6%|‚ñå         | 6/100 [00:10<02:27,  1.57s/it]  7%|‚ñã         | 7/100 [00:11<02:20,  1.51s/it]  8%|‚ñä         | 8/100 [00:12<02:06,  1.37s/it]  9%|‚ñâ         | 9/100 [00:13<01:57,  1.29s/it] 10%|‚ñà         | 10/100 [00:14<01:52,  1.24s/it] 11%|‚ñà         | 11/100 [00:15<01:44,  1.17s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<01:36,  1.10s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<01:31,  1.05s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<01:27,  1.02s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<01:24,  1.01it/s] 16%|‚ñà‚ñå        | 16/100 [00:20<01:25,  1.01s/it] 17%|‚ñà‚ñã        | 17/100 [00:21<01:27,  1.05s/it] 18%|‚ñà‚ñä        | 18/100 [00:22<01:22,  1.01s/it] 19%|‚ñà‚ñâ        | 19/100 [00:23<01:19,  1.02it/s] 20%|‚ñà‚ñà        | 20/100 [00:24<01:16,  1.04it/s] 21%|‚ñà‚ñà        | 21/100 [00:25<01:13,  1.08it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:26<01:09,  1.12it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:26<01:07,  1.14it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:27<01:05,  1.16it/s] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:28<01:07,  1.10it/s] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:29<01:06,  1.12it/s] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:30<01:06,  1.11it/s] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:31<01:02,  1.15it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:32<00:59,  1.20it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:32<00:56,  1.23it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:33<00:59,  1.17it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:34<00:57,  1.18it/s] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:35<00:58,  1.14it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:36<00:59,  1.12it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:37<00:55,  1.16it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:38<00:55,  1.15it/s] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:39<00:55,  1.13it/s] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:40<00:54,  1.13it/s] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:40<00:52,  1.16it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:41<00:49,  1.20it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:42<00:47,  1.24it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:43<00:46,  1.26it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:43<00:44,  1.29it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:44<00:42,  1.32it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:45<00:41,  1.33it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:46<00:41,  1.32it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:46<00:40,  1.32it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:47<00:40,  1.29it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:48<00:39,  1.30it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:49<00:38,  1.30it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:49<00:37,  1.31it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:50<00:36,  1.32it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:51<00:36,  1.30it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:52<00:34,  1.35it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:52<00:33,  1.32it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:53<00:34,  1.28it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [00:54<00:33,  1.30it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [00:55<00:32,  1.28it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [00:56<00:31,  1.31it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [00:56<00:30,  1.30it/s] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [00:57<00:29,  1.30it/s] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [00:58<00:28,  1.34it/s] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [00:59<00:28,  1.32it/s] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [00:59<00:27,  1.32it/s] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:00<00:26,  1.34it/s] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:01<00:25,  1.31it/s] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:02<00:28,  1.17it/s] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:03<00:31,  1.02it/s] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:04<00:28,  1.11it/s] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:05<00:25,  1.17it/s] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:05<00:24,  1.20it/s] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:06<00:22,  1.24it/s] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:07<00:21,  1.25it/s] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:08<00:21,  1.20it/s] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:10<00:30,  1.22s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:12<00:32,  1.37s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:14<00:39,  1.74s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:16<00:37,  1.72s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:18<00:35,  1.68s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:19<00:34,  1.71s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:20<00:28,  1.51s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:22<00:27,  1.52s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:24<00:29,  1.76s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:26<00:29,  1.84s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:29<00:33,  2.24s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:33<00:34,  2.50s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:36<00:34,  2.63s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:39<00:34,  2.91s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:42<00:33,  3.01s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:46<00:31,  3.11s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:49<00:28,  3.13s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:52<00:24,  3.03s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:55<00:21,  3.13s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:58<00:18,  3.11s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:01<00:15,  3.09s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:04<00:12,  3.15s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:07<00:09,  3.04s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:10<00:05,  2.99s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:13<00:03,  3.05s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:17<00:00,  3.13s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:17<00:00,  1.37s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.29813
wandb: 
wandb: üöÄ View run ethereal-sweep-345 at: https://wandb.ai/xzy11632/dance-dev/runs/9lzkv6tg
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_065318-9lzkv6tg/logs
wandb: Agent Starting Run: ppiga5zx with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_065848-ppiga5zx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run toasty-sweep-346
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ppiga5zx
[INFO][2024-03-18 06:58:54,089][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 06:58:54,205][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 06:58:54,205][dance][wrapped_func] Took 0:00:00.115684 to load and process data.
[INFO][2024-03-18 06:58:54,206][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 06:58:54,209][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[INFO][2024-03-18 06:59:52,204][dance.WeightedFeatureSVD][__call__] Decomposing train features (5917, 200) (k=146)
[INFO][2024-03-18 06:59:52,205][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.86%
[INFO][2024-03-18 06:59:53,902][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 06:59:53,903][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 06:59:53,903][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 06:59:53,904][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:00,  1.22s/it]  2%|‚ñè         | 2/100 [00:03<02:53,  1.77s/it]  3%|‚ñé         | 3/100 [00:05<03:19,  2.06s/it]  4%|‚ñç         | 4/100 [00:08<03:34,  2.24s/it]  5%|‚ñå         | 5/100 [00:10<03:38,  2.30s/it]  6%|‚ñå         | 6/100 [00:13<03:38,  2.32s/it]  7%|‚ñã         | 7/100 [00:15<03:41,  2.38s/it]  8%|‚ñä         | 8/100 [00:18<03:43,  2.43s/it]  9%|‚ñâ         | 9/100 [00:19<03:06,  2.05s/it] 10%|‚ñà         | 10/100 [00:20<02:32,  1.70s/it] 11%|‚ñà         | 11/100 [00:21<02:12,  1.48s/it] 12%|‚ñà‚ñè        | 12/100 [00:22<01:59,  1.36s/it] 13%|‚ñà‚ñé        | 13/100 [00:23<01:51,  1.28s/it] 14%|‚ñà‚ñç        | 14/100 [00:24<01:43,  1.20s/it] 15%|‚ñà‚ñå        | 15/100 [00:25<01:38,  1.16s/it] 16%|‚ñà‚ñå        | 16/100 [00:26<01:32,  1.10s/it] 17%|‚ñà‚ñã        | 17/100 [00:27<01:25,  1.03s/it] 18%|‚ñà‚ñä        | 18/100 [00:28<01:20,  1.02it/s] 19%|‚ñà‚ñâ        | 19/100 [00:29<01:17,  1.04it/s] 20%|‚ñà‚ñà        | 20/100 [00:29<01:14,  1.07it/s] 21%|‚ñà‚ñà        | 21/100 [00:31<01:18,  1.01it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:32<01:16,  1.01it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:32<01:14,  1.03it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:33<01:08,  1.11it/s] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:34<01:03,  1.17it/s] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:35<01:00,  1.22it/s] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:35<00:57,  1.26it/s] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:36<00:57,  1.26it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:37<00:55,  1.28it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:38<00:53,  1.30it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:39<00:54,  1.27it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:39<00:53,  1.26it/s] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:40<00:51,  1.29it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:41<00:50,  1.31it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:42<00:48,  1.33it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:42<00:48,  1.33it/s] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:43<00:49,  1.28it/s] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:44<00:48,  1.29it/s] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:45<00:47,  1.29it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:45<00:46,  1.30it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:46<00:44,  1.32it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:47<00:43,  1.33it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:48<00:43,  1.32it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:48<00:41,  1.33it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:49<00:40,  1.35it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:50<00:39,  1.35it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:51<00:38,  1.36it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:51<00:37,  1.37it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:52<00:37,  1.36it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:53<00:36,  1.37it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:54<00:36,  1.32it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:54<00:36,  1.33it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:55<00:36,  1.29it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:56<00:36,  1.25it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:57<00:36,  1.24it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:58<00:34,  1.27it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [00:58<00:33,  1.28it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [00:59<00:32,  1.29it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:00<00:31,  1.31it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:01<00:30,  1.32it/s] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:01<00:30,  1.30it/s] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:02<00:31,  1.21it/s] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:03<00:29,  1.25it/s] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:04<00:33,  1.09it/s] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:05<00:34,  1.00it/s] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:07<00:35,  1.04s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:07<00:32,  1.00it/s] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:09<00:32,  1.03s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:10<00:30,  1.00it/s] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:10<00:29,  1.03it/s] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:11<00:26,  1.08it/s] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:12<00:25,  1.10it/s] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:13<00:24,  1.09it/s] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:14<00:23,  1.10it/s] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:15<00:22,  1.10it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:16<00:22,  1.09it/s] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:18<00:29,  1.27s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:21<00:42,  1.92s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:26<00:55,  2.64s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:30<01:03,  3.18s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:35<01:10,  3.69s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:39<01:08,  3.83s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:44<01:08,  4.05s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:47<01:02,  3.89s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:52<01:01,  4.13s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:56<00:58,  4.15s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:01<00:56,  4.35s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:05<00:51,  4.28s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:09<00:46,  4.23s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:14<00:44,  4.41s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:18<00:39,  4.35s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:23<00:34,  4.35s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:27<00:30,  4.40s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:32<00:26,  4.43s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:36<00:21,  4.35s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:40<00:17,  4.41s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:45<00:13,  4.38s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:49<00:08,  4.26s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:52<00:04,  4.05s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:56<00:00,  3.92s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:56<00:00,  1.76s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.31296
wandb: 
wandb: üöÄ View run toasty-sweep-346 at: https://wandb.ai/xzy11632/dance-dev/runs/ppiga5zx
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_065848-ppiga5zx/logs
wandb: Agent Starting Run: qldy5y8v with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_070435-qldy5y8v
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wobbly-sweep-347
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/qldy5y8v
[INFO][2024-03-18 07:04:41,693][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:04:41,810][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:04:41,811][dance][wrapped_func] Took 0:00:00.103620 to load and process data.
[INFO][2024-03-18 07:04:41,811][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 07:04:41,814][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-18 07:06:05,582][dance.WeightedFeaturePCA][__call__] Decomposing train features (5917, 200) (k=109)
[INFO][2024-03-18 07:06:05,583][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.09%
[INFO][2024-03-18 07:07:37,417][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 07:07:37,418][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 07:07:37,418][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 07:07:37,419][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:28,  1.50s/it]  2%|‚ñè         | 2/100 [00:02<02:22,  1.45s/it]  3%|‚ñé         | 3/100 [00:03<02:04,  1.28s/it]  4%|‚ñç         | 4/100 [00:05<01:54,  1.19s/it]  5%|‚ñå         | 5/100 [00:06<01:45,  1.12s/it]  6%|‚ñå         | 6/100 [00:07<01:46,  1.14s/it]  7%|‚ñã         | 7/100 [00:08<01:44,  1.12s/it]  8%|‚ñä         | 8/100 [00:09<01:43,  1.13s/it]  9%|‚ñâ         | 9/100 [00:10<01:49,  1.20s/it] 10%|‚ñà         | 10/100 [00:11<01:45,  1.17s/it] 11%|‚ñà         | 11/100 [00:13<01:44,  1.17s/it] 12%|‚ñà‚ñè        | 12/100 [00:14<01:45,  1.20s/it] 13%|‚ñà‚ñé        | 13/100 [00:15<01:42,  1.18s/it] 14%|‚ñà‚ñç        | 14/100 [00:16<01:45,  1.22s/it] 15%|‚ñà‚ñå        | 15/100 [00:18<01:43,  1.22s/it] 16%|‚ñà‚ñå        | 16/100 [00:19<01:42,  1.22s/it] 17%|‚ñà‚ñã        | 17/100 [00:20<01:38,  1.19s/it] 18%|‚ñà‚ñä        | 18/100 [00:21<01:36,  1.18s/it] 19%|‚ñà‚ñâ        | 19/100 [00:22<01:39,  1.23s/it] 20%|‚ñà‚ñà        | 20/100 [00:23<01:34,  1.18s/it] 21%|‚ñà‚ñà        | 21/100 [00:25<01:39,  1.26s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:26<01:40,  1.29s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:27<01:35,  1.24s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:29<01:32,  1.21s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:30<01:32,  1.24s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:31<01:32,  1.25s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:32<01:29,  1.23s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:33<01:28,  1.23s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:35<01:28,  1.25s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:36<01:24,  1.21s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:37<01:24,  1.23s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:38<01:24,  1.24s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:40<01:23,  1.24s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:41<01:22,  1.24s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:42<01:19,  1.23s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:43<01:16,  1.20s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:44<01:15,  1.20s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:46<01:16,  1.23s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:47<01:14,  1.23s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:48<01:14,  1.23s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:49<01:12,  1.22s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:51<01:09,  1.21s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:52<01:07,  1.19s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:53<01:06,  1.19s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:54<01:05,  1.19s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:55<01:06,  1.24s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:57<01:06,  1.26s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:58<01:06,  1.27s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:59<01:04,  1.26s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:01<01:02,  1.25s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:02<00:59,  1.20s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:03<01:01,  1.27s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:04<01:01,  1.30s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:06<00:58,  1.26s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:07<00:55,  1.24s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:08<00:54,  1.24s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:09<00:52,  1.22s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:11<00:52,  1.26s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:12<00:51,  1.25s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:13<00:50,  1.27s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:14<00:48,  1.23s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:15<00:46,  1.23s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:17<00:46,  1.25s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:18<00:45,  1.25s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:19<00:43,  1.25s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:21<00:42,  1.26s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:22<00:40,  1.24s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:23<00:38,  1.20s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:24<00:37,  1.20s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:25<00:36,  1.22s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:27<00:35,  1.23s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:28<00:35,  1.27s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:29<00:34,  1.28s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:30<00:32,  1.26s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:32<00:30,  1.23s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:33<00:29,  1.23s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:34<00:28,  1.22s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:35<00:27,  1.26s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:37<00:26,  1.24s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:38<00:24,  1.22s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:39<00:22,  1.20s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:40<00:21,  1.20s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:41<00:20,  1.23s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:43<00:19,  1.24s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:44<00:18,  1.26s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:45<00:17,  1.27s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:47<00:16,  1.27s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:48<00:14,  1.24s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:49<00:13,  1.26s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:50<00:12,  1.23s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:51<00:11,  1.23s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:53<00:09,  1.24s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:54<00:08,  1.25s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:55<00:07,  1.25s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:56<00:06,  1.25s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:58<00:04,  1.23s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:59<00:03,  1.23s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:00<00:02,  1.27s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:01<00:01,  1.27s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:03<00:00,  1.20s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:03<00:00,  1.23s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.3445
wandb: 
wandb: üöÄ View run wobbly-sweep-347 at: https://wandb.ai/xzy11632/dance-dev/runs/qldy5y8v
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_070435-qldy5y8v/logs
wandb: Agent Starting Run: wti4ylsp with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScTransform
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_071055-wti4ylsp
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run astral-sweep-348
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/wti4ylsp
[INFO][2024-03-18 07:11:04,677][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:11:04,914][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:11:04,914][dance][wrapped_func] Took 0:00:00.235334 to load and process data.
[INFO][2024-03-18 07:11:04,914][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 07:11:04,931][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'ScTransform',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-18 07:12:28,348][dance.WeightedFeatureSVD][__call__] Decomposing train features (5917, 200) (k=108)
[INFO][2024-03-18 07:12:28,349][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.66%
[INFO][2024-03-18 07:15:24,457][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 07:15:24,457][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 07:15:24,458][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 07:15:24,458][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:56,  1.18s/it]  2%|‚ñè         | 2/100 [00:02<01:54,  1.17s/it]  3%|‚ñé         | 3/100 [00:03<01:50,  1.14s/it]  4%|‚ñç         | 4/100 [00:04<01:38,  1.03s/it]  5%|‚ñå         | 5/100 [00:05<01:28,  1.07it/s]  6%|‚ñå         | 6/100 [00:05<01:24,  1.11it/s]  7%|‚ñã         | 7/100 [00:06<01:24,  1.10it/s]  8%|‚ñä         | 8/100 [00:07<01:22,  1.11it/s]  9%|‚ñâ         | 9/100 [00:08<01:19,  1.14it/s] 10%|‚ñà         | 10/100 [00:09<01:19,  1.13it/s] 11%|‚ñà         | 11/100 [00:10<01:19,  1.12it/s] 12%|‚ñà‚ñè        | 12/100 [00:11<01:20,  1.10it/s] 13%|‚ñà‚ñé        | 13/100 [00:12<01:18,  1.11it/s] 14%|‚ñà‚ñç        | 14/100 [00:12<01:14,  1.15it/s] 15%|‚ñà‚ñå        | 15/100 [00:13<01:12,  1.17it/s] 16%|‚ñà‚ñå        | 16/100 [00:14<01:10,  1.19it/s] 17%|‚ñà‚ñã        | 17/100 [00:15<01:10,  1.18it/s] 18%|‚ñà‚ñä        | 18/100 [00:16<01:10,  1.16it/s] 19%|‚ñà‚ñâ        | 19/100 [00:17<01:07,  1.19it/s] 20%|‚ñà‚ñà        | 20/100 [00:17<01:06,  1.19it/s] 21%|‚ñà‚ñà        | 21/100 [00:18<01:04,  1.23it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:19<01:03,  1.24it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:20<01:04,  1.20it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:21<01:07,  1.13it/s] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:22<01:06,  1.12it/s] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:23<01:05,  1.13it/s] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:24<01:04,  1.13it/s] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:24<01:03,  1.13it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:25<01:02,  1.14it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:26<01:01,  1.13it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:27<01:02,  1.11it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:28<01:00,  1.13it/s] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:29<01:00,  1.11it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:30<00:57,  1.14it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:31<00:57,  1.13it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:32<00:58,  1.10it/s] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:32<00:54,  1.15it/s] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:33<00:52,  1.19it/s] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:34<00:53,  1.14it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:35<00:53,  1.12it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:36<00:51,  1.14it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:37<00:53,  1.08it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:38<00:52,  1.09it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:39<00:48,  1.15it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:40<00:48,  1.14it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:40<00:46,  1.17it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:41<00:44,  1.18it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:42<00:44,  1.18it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:43<00:44,  1.14it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:44<00:43,  1.16it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:45<00:41,  1.19it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:45<00:40,  1.19it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:46<00:39,  1.20it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:47<00:37,  1.21it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:48<00:36,  1.22it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:49<00:36,  1.20it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [00:50<00:36,  1.18it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [00:51<00:37,  1.12it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [00:52<00:37,  1.08it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [00:52<00:36,  1.09it/s] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [00:53<00:35,  1.10it/s] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [00:54<00:33,  1.13it/s] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [00:55<00:31,  1.17it/s] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [00:56<00:30,  1.18it/s] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [00:57<00:30,  1.15it/s] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [00:58<00:30,  1.11it/s] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [00:59<00:30,  1.08it/s] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:00<00:30,  1.06it/s] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:01<00:28,  1.07it/s] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:01<00:27,  1.11it/s] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:02<00:25,  1.12it/s] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:03<00:25,  1.12it/s] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:04<00:23,  1.13it/s] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:05<00:23,  1.10it/s] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:06<00:23,  1.07it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:07<00:22,  1.06it/s] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:08<00:21,  1.05it/s] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:09<00:19,  1.10it/s] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:10<00:18,  1.15it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:10<00:17,  1.17it/s] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:11<00:16,  1.13it/s] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:12<00:16,  1.11it/s] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:13<00:15,  1.12it/s] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:14<00:14,  1.14it/s] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:15<00:12,  1.17it/s] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:16<00:11,  1.17it/s] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:16<00:11,  1.18it/s] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:17<00:10,  1.14it/s] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:18<00:09,  1.11it/s] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:19<00:09,  1.11it/s] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:20<00:08,  1.07it/s] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:21<00:07,  1.12it/s] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:22<00:06,  1.16it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:23<00:05,  1.16it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:23<00:04,  1.20it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:24<00:03,  1.15it/s] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:25<00:02,  1.13it/s] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:26<00:01,  1.07it/s] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:27<00:00,  1.10it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:28<00:00,  1.15it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:28<00:00,  1.13it/s]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.021 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.36502
wandb: 
wandb: üöÄ View run astral-sweep-348 at: https://wandb.ai/xzy11632/dance-dev/runs/wti4ylsp
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_071055-wti4ylsp/logs
wandb: Agent Starting Run: u6rnjkxt with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_071749-u6rnjkxt
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run distinctive-sweep-349
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/u6rnjkxt
[INFO][2024-03-18 07:17:54,462][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:17:54,556][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:17:54,557][dance][wrapped_func] Took 0:00:00.093876 to load and process data.
[INFO][2024-03-18 07:17:54,557][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 07:17:54,580][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'FilterGenesPlaceHolder',
 'WeightedFeaturePCA',
 None,
 None][0m
[WARNING][2024-03-18 07:17:54,602][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:17:54,804][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 07:17:55,627][dance.WeightedFeaturePCA][__call__] Decomposing train features (5917, 919) (k=431)
[INFO][2024-03-18 07:17:55,628][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.00%
[INFO][2024-03-18 07:17:57,280][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 07:17:57,280][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 07:17:57,280][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 07:17:57,280][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:31,  1.08it/s]  2%|‚ñè         | 2/100 [00:01<01:32,  1.06it/s]  3%|‚ñé         | 3/100 [00:02<01:38,  1.01s/it]  4%|‚ñç         | 4/100 [00:03<01:34,  1.01it/s]  5%|‚ñå         | 5/100 [00:04<01:34,  1.01it/s]  6%|‚ñå         | 6/100 [00:06<01:36,  1.03s/it]  7%|‚ñã         | 7/100 [00:07<01:34,  1.01s/it]  8%|‚ñä         | 8/100 [00:07<01:30,  1.01it/s]  9%|‚ñâ         | 9/100 [00:08<01:31,  1.01s/it] 10%|‚ñà         | 10/100 [00:11<02:23,  1.59s/it] 11%|‚ñà         | 11/100 [00:14<02:44,  1.85s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<02:52,  1.96s/it] 13%|‚ñà‚ñé        | 13/100 [00:18<02:58,  2.05s/it] 14%|‚ñà‚ñç        | 14/100 [00:21<03:01,  2.11s/it] 15%|‚ñà‚ñå        | 15/100 [00:23<03:05,  2.18s/it] 16%|‚ñà‚ñå        | 16/100 [00:25<02:56,  2.10s/it] 17%|‚ñà‚ñã        | 17/100 [00:26<02:35,  1.88s/it] 18%|‚ñà‚ñä        | 18/100 [00:28<02:32,  1.86s/it] 19%|‚ñà‚ñâ        | 19/100 [00:29<02:17,  1.70s/it] 20%|‚ñà‚ñà        | 20/100 [00:30<02:03,  1.54s/it] 21%|‚ñà‚ñà        | 21/100 [00:32<01:50,  1.40s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:32<01:38,  1.26s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:34<01:31,  1.19s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:34<01:23,  1.10s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:35<01:20,  1.08s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:37<01:21,  1.11s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:38<01:19,  1.09s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:39<01:16,  1.06s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:40<01:14,  1.05s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:41<01:16,  1.10s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:42<01:14,  1.08s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:43<01:12,  1.07s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:44<01:11,  1.07s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:45<01:09,  1.05s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:46<01:10,  1.08s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:47<01:08,  1.07s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:48<01:06,  1.06s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:49<01:04,  1.04s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:50<01:03,  1.04s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:51<01:04,  1.07s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:52<01:02,  1.05s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:53<00:59,  1.02s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:54<00:56,  1.01it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:55<00:55,  1.01it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:56<00:54,  1.01it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:57<00:53,  1.01it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:58<00:52,  1.01it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:59<00:50,  1.03it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:00<00:49,  1.03it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:01<00:47,  1.05it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:02<00:46,  1.05it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:03<00:47,  1.00it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:04<00:47,  1.02s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:05<00:47,  1.04s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:06<00:48,  1.07s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:07<00:45,  1.04s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:08<00:44,  1.03s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:09<00:42,  1.01s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:10<00:41,  1.01s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:12<00:41,  1.04s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:12<00:39,  1.02s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:13<00:38,  1.01s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:14<00:36,  1.00it/s] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:15<00:35,  1.02it/s] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:16<00:33,  1.03it/s] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:17<00:32,  1.05it/s] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:18<00:31,  1.04it/s] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:19<00:31,  1.02it/s] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:20<00:31,  1.03s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:21<00:30,  1.00s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:22<00:29,  1.00s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:23<00:27,  1.00it/s] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:24<00:26,  1.02it/s] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:25<00:25,  1.01it/s] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:26<00:25,  1.01s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:29<00:38,  1.60s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:32<00:45,  1.98s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:35<00:50,  2.28s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:38<00:51,  2.46s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:40<00:48,  2.43s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:42<00:41,  2.20s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:43<00:32,  1.81s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:44<00:26,  1.57s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:45<00:22,  1.42s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:46<00:20,  1.34s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:47<00:16,  1.21s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:48<00:14,  1.13s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:49<00:13,  1.11s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:50<00:11,  1.08s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:51<00:10,  1.07s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:52<00:09,  1.07s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:53<00:08,  1.11s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:54<00:07,  1.08s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:55<00:06,  1.06s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:57<00:05,  1.08s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:58<00:04,  1.10s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:59<00:03,  1.04s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:00<00:02,  1.06s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:01<00:01,  1.03s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:02<00:00,  1.01it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:02<00:00,  1.22s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.19469
wandb: 
wandb: üöÄ View run distinctive-sweep-349 at: https://wandb.ai/xzy11632/dance-dev/runs/u6rnjkxt
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_071749-u6rnjkxt/logs
wandb: Agent Starting Run: i53r19yx with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesPlaceHolder
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_072047-i53r19yx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lunar-sweep-350
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/i53r19yx
[INFO][2024-03-18 07:20:52,708][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:20:52,800][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:20:52,800][dance][wrapped_func] Took 0:00:00.091563 to load and process data.
[INFO][2024-03-18 07:20:52,800][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 07:20:52,803][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'FilterGenesPlaceHolder',
 'WeightedFeatureSVD',
 None,
 None][0m
[WARNING][2024-03-18 07:20:52,826][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:20:53,021][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[INFO][2024-03-18 07:20:58,477][dance.WeightedFeatureSVD][__call__] Decomposing train features (5917, 919) (k=419)
[INFO][2024-03-18 07:20:58,478][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.28%
[INFO][2024-03-18 07:21:00,089][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 07:21:00,090][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 07:21:00,090][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 07:21:00,090][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<01:45,  1.07s/it]  2%|‚ñè         | 2/100 [00:01<01:33,  1.05it/s]  3%|‚ñé         | 3/100 [00:02<01:30,  1.07it/s]  4%|‚ñç         | 4/100 [00:03<01:26,  1.11it/s]  5%|‚ñå         | 5/100 [00:04<01:23,  1.14it/s]  6%|‚ñå         | 6/100 [00:05<01:22,  1.13it/s]  7%|‚ñã         | 7/100 [00:06<01:20,  1.15it/s]  8%|‚ñä         | 8/100 [00:07<01:18,  1.17it/s]  9%|‚ñâ         | 9/100 [00:08<01:20,  1.13it/s] 10%|‚ñà         | 10/100 [00:08<01:19,  1.13it/s] 11%|‚ñà         | 11/100 [00:09<01:20,  1.10it/s] 12%|‚ñà‚ñè        | 12/100 [00:10<01:23,  1.06it/s] 13%|‚ñà‚ñé        | 13/100 [00:11<01:19,  1.09it/s] 14%|‚ñà‚ñç        | 14/100 [00:12<01:18,  1.09it/s] 15%|‚ñà‚ñå        | 15/100 [00:13<01:17,  1.10it/s] 16%|‚ñà‚ñå        | 16/100 [00:14<01:18,  1.07it/s] 17%|‚ñà‚ñã        | 17/100 [00:16<01:53,  1.37s/it] 18%|‚ñà‚ñä        | 18/100 [00:19<02:15,  1.65s/it] 19%|‚ñà‚ñâ        | 19/100 [00:21<02:24,  1.78s/it] 20%|‚ñà‚ñà        | 20/100 [00:23<02:30,  1.88s/it] 21%|‚ñà‚ñà        | 21/100 [00:25<02:41,  2.05s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:28<02:50,  2.19s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:30<02:49,  2.20s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:32<02:39,  2.09s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:34<02:40,  2.14s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:37<02:45,  2.24s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:39<02:44,  2.26s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:41<02:44,  2.29s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:43<02:34,  2.17s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:45<02:23,  2.05s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:47<02:28,  2.15s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:50<02:27,  2.17s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:52<02:28,  2.21s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:54<02:28,  2.25s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:57<02:33,  2.37s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:59<02:28,  2.31s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [01:01<02:23,  2.27s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [01:03<02:13,  2.15s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [01:05<01:57,  1.93s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [01:06<01:51,  1.86s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [01:08<01:47,  1.83s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [01:09<01:29,  1.55s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [01:11<01:29,  1.58s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [01:12<01:21,  1.45s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [01:13<01:24,  1.53s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [01:15<01:19,  1.48s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [01:17<01:23,  1.57s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [01:18<01:17,  1.50s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:19<01:14,  1.45s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:20<01:07,  1.35s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:21<01:02,  1.28s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:23<00:58,  1.22s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:24<00:53,  1.14s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:25<00:50,  1.11s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:26<00:48,  1.07s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:27<00:45,  1.04s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:27<00:43,  1.02s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:29<00:43,  1.03s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:30<00:41,  1.02s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:32<00:56,  1.42s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:35<01:13,  1.89s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:38<01:26,  2.28s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:41<01:36,  2.61s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:44<01:38,  2.73s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:47<01:38,  2.81s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:50<01:31,  2.68s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:53<01:30,  2.73s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:55<01:19,  2.50s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:56<01:07,  2.18s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:58<01:03,  2.11s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [02:00<01:00,  2.09s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [02:02<00:56,  2.03s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [02:04<00:53,  1.98s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [02:06<00:51,  1.97s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [02:07<00:43,  1.76s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [02:08<00:37,  1.58s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [02:09<00:34,  1.49s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [02:11<00:31,  1.43s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [02:12<00:29,  1.42s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [02:14<00:27,  1.40s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [02:15<00:25,  1.36s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [02:16<00:24,  1.34s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [02:17<00:22,  1.33s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [02:19<00:21,  1.37s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [02:20<00:20,  1.39s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [02:22<00:19,  1.36s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [02:23<00:17,  1.38s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [02:24<00:15,  1.33s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [02:26<00:14,  1.34s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [02:27<00:13,  1.33s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [02:28<00:11,  1.33s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:30<00:10,  1.33s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:31<00:09,  1.34s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:32<00:07,  1.31s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:33<00:06,  1.31s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:35<00:05,  1.32s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:36<00:03,  1.33s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:37<00:02,  1.31s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:39<00:01,  1.31s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:40<00:00,  1.28s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:40<00:00,  1.60s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.021 MB uploadedwandb: | 0.012 MB of 0.021 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.22572
wandb: 
wandb: üöÄ View run lunar-sweep-350 at: https://wandb.ai/xzy11632/dance-dev/runs/i53r19yx
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_072047-i53r19yx/logs
wandb: Agent Starting Run: mloc0mda with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_072436-mloc0mda
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dark-sweep-351
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/mloc0mda
[INFO][2024-03-18 07:24:41,794][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:24:41,916][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:24:41,917][dance][wrapped_func] Took 0:00:00.121158 to load and process data.
[INFO][2024-03-18 07:24:41,917][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 07:24:41,922][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'FilterGenesRegression',
 'WeightedFeaturePCA',
 None,
 None][0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-18 07:24:42,235][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run dark-sweep-351 at: https://wandb.ai/xzy11632/dance-dev/runs/mloc0mda
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_072436-mloc0mda/logs
wandb: ERROR Run mloc0mda errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1081) out of bounds (919)
wandb: ERROR 
wandb: Agent Starting Run: e3shkwnz with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesRegression
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_072453-e3shkwnz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run breezy-sweep-352
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/e3shkwnz
[INFO][2024-03-18 07:24:57,645][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:24:57,754][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:24:57,754][dance][wrapped_func] Took 0:00:00.107908 to load and process data.
[INFO][2024-03-18 07:24:57,755][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 07:24:57,756][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'FilterGenesRegression',
 'WeightedFeatureSVD',
 None,
 None][0m
/home/zyxing/dance/dance/transforms/filter.py:654: UserWarning: Expecting count data as input, but the input feature matrix does not appear to be count.Please make sure the input is indeed a count matrix.
  warnings.warn("Expecting count data as input, but the input feature matrix does not appear to be count."
[INFO][2024-03-18 07:24:58,198][dance][_filter_enclasc] Start generating cell features using EnClaSC
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run breezy-sweep-352 at: https://wandb.ai/xzy11632/dance-dev/runs/e3shkwnz
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_072453-e3shkwnz/logs
wandb: ERROR Run e3shkwnz errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 660, in __call__
wandb: ERROR     data.data.obsm[self.out] = filter_func(feat)
wandb: ERROR                                ^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 679, in _filter_enclasc
wandb: ERROR     feat_index = np.argpartition(scores, -num_genes)[-num_genes:]
wandb: ERROR                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 858, in argpartition
wandb: ERROR     return _wrapfunc(a, 'argpartition', kth, axis=axis, kind=kind, order=order)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
wandb: ERROR     return bound(*args, **kwds)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR ValueError: kth(=-1081) out of bounds (919)
wandb: ERROR 
wandb: Agent Starting Run: 80s2vx6t with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_072509-80s2vx6t
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dandy-sweep-353
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/80s2vx6t
[INFO][2024-03-18 07:25:15,075][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:25:15,176][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:25:15,176][dance][wrapped_func] Took 0:00:00.100396 to load and process data.
[INFO][2024-03-18 07:25:15,176][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 07:25:15,179][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'FilterGenesTopK',
 'WeightedFeaturePCA',
 None,
 None][0m
[INFO][2024-03-18 07:25:15,766][dance.WeightedFeaturePCA][__call__] Decomposing train features (5917, 200) (k=86)
[INFO][2024-03-18 07:25:15,767][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.05%
[INFO][2024-03-18 07:25:17,360][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 07:25:17,360][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 07:25:17,361][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 07:25:17,361][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesRegression
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:24,  1.17it/s]  2%|‚ñè         | 2/100 [00:01<01:32,  1.06it/s]  3%|‚ñé         | 3/100 [00:02<01:34,  1.03it/s]  4%|‚ñç         | 4/100 [00:03<01:32,  1.03it/s]  5%|‚ñå         | 5/100 [00:04<01:28,  1.07it/s]  6%|‚ñå         | 6/100 [00:05<01:34,  1.00s/it]  7%|‚ñã         | 7/100 [00:06<01:30,  1.03it/s]  8%|‚ñä         | 8/100 [00:07<01:31,  1.01it/s]  9%|‚ñâ         | 9/100 [00:09<01:39,  1.09s/it] 10%|‚ñà         | 10/100 [00:10<01:37,  1.08s/it] 11%|‚ñà         | 11/100 [00:11<01:35,  1.07s/it] 12%|‚ñà‚ñè        | 12/100 [00:11<01:27,  1.01it/s] 13%|‚ñà‚ñé        | 13/100 [00:12<01:21,  1.07it/s] 14%|‚ñà‚ñç        | 14/100 [00:13<01:19,  1.08it/s] 15%|‚ñà‚ñå        | 15/100 [00:14<01:18,  1.09it/s] 16%|‚ñà‚ñå        | 16/100 [00:15<01:23,  1.00it/s] 17%|‚ñà‚ñã        | 17/100 [00:16<01:22,  1.01it/s] 18%|‚ñà‚ñä        | 18/100 [00:17<01:20,  1.02it/s] 19%|‚ñà‚ñâ        | 19/100 [00:18<01:16,  1.06it/s] 20%|‚ñà‚ñà        | 20/100 [00:19<01:15,  1.06it/s] 21%|‚ñà‚ñà        | 21/100 [00:20<01:17,  1.02it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:21<01:17,  1.01it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:22<01:17,  1.01s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:23<01:20,  1.06s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:24<01:20,  1.07s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:25<01:18,  1.07s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:26<01:14,  1.02s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:27<01:12,  1.01s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:28<01:11,  1.00s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:29<01:11,  1.01s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:31<01:13,  1.06s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:32<01:22,  1.21s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:34<01:25,  1.27s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:35<01:22,  1.24s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:36<01:24,  1.30s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:38<01:25,  1.34s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:39<01:24,  1.33s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:40<01:15,  1.21s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:41<01:05,  1.07s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:41<00:58,  1.02it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:42<00:56,  1.04it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:43<00:53,  1.09it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:44<00:50,  1.12it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:45<00:49,  1.14it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:46<00:48,  1.13it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:47<00:48,  1.11it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:48<00:47,  1.11it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:48<00:47,  1.09it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:49<00:46,  1.10it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:50<00:45,  1.10it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:51<00:44,  1.10it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:53<00:50,  1.05s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:54<00:51,  1.10s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:55<00:51,  1.12s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:56<00:47,  1.05s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:57<00:44,  1.01s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [00:58<00:43,  1.01s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [00:59<00:41,  1.00it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:00<00:44,  1.09s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:01<00:42,  1.07s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:02<00:40,  1.04s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:03<00:37,  1.00it/s] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:04<00:34,  1.07it/s] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:05<00:33,  1.08it/s] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:05<00:31,  1.12it/s] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:06<00:30,  1.13it/s] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:07<00:30,  1.09it/s] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:08<00:29,  1.08it/s] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:09<00:28,  1.09it/s] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:10<00:28,  1.06it/s] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:11<00:27,  1.05it/s] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:12<00:25,  1.10it/s] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:13<00:23,  1.13it/s] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:14<00:22,  1.16it/s] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:14<00:21,  1.16it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:15<00:20,  1.18it/s] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:16<00:19,  1.17it/s] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:17<00:18,  1.18it/s] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:18<00:18,  1.15it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:19<00:17,  1.13it/s] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:20<00:16,  1.16it/s] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:20<00:15,  1.15it/s] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:21<00:14,  1.17it/s] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:22<00:14,  1.12it/s] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:23<00:13,  1.12it/s] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:24<00:12,  1.13it/s] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:25<00:11,  1.14it/s] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:26<00:10,  1.14it/s] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:27<00:09,  1.17it/s] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:27<00:08,  1.18it/s] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:28<00:07,  1.16it/s] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:29<00:07,  1.13it/s] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:30<00:06,  1.09it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:31<00:05,  1.05it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:32<00:04,  1.05it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:33<00:03,  1.06it/s] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:34<00:02,  1.11it/s] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:35<00:01,  1.15it/s] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:36<00:00,  1.13it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:37<00:00,  1.14it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:37<00:00,  1.03it/s]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.21051
wandb: 
wandb: üöÄ View run dandy-sweep-353 at: https://wandb.ai/xzy11632/dance-dev/runs/80s2vx6t
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_072509-80s2vx6t/logs
wandb: Agent Starting Run: 96mrkil9 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: FilterGenesTopK
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_072748-96mrkil9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run earnest-sweep-354
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/96mrkil9
[INFO][2024-03-18 07:27:53,053][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:27:53,145][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:27:53,145][dance][wrapped_func] Took 0:00:00.091338 to load and process data.
[INFO][2024-03-18 07:27:53,146][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 07:27:53,148][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'FilterGenesTopK',
 'WeightedFeatureSVD',
 None,
 None][0m
[INFO][2024-03-18 07:27:54,789][dance.WeightedFeatureSVD][__call__] Decomposing train features (5917, 200) (k=82)
[INFO][2024-03-18 07:27:54,790][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.19%
[INFO][2024-03-18 07:27:55,979][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 07:27:55,979][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 07:27:55,979][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 07:27:55,980][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    num_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:21,  1.21it/s]  2%|‚ñè         | 2/100 [00:01<01:19,  1.24it/s]  3%|‚ñé         | 3/100 [00:02<01:21,  1.19it/s]  4%|‚ñç         | 4/100 [00:03<01:18,  1.22it/s]  5%|‚ñå         | 5/100 [00:04<01:18,  1.21it/s]  6%|‚ñå         | 6/100 [00:04<01:18,  1.19it/s]  7%|‚ñã         | 7/100 [00:05<01:18,  1.19it/s]  8%|‚ñä         | 8/100 [00:06<01:17,  1.19it/s]  9%|‚ñâ         | 9/100 [00:07<01:17,  1.17it/s] 10%|‚ñà         | 10/100 [00:08<01:17,  1.16it/s] 11%|‚ñà         | 11/100 [00:09<01:17,  1.15it/s] 12%|‚ñà‚ñè        | 12/100 [00:10<01:17,  1.14it/s] 13%|‚ñà‚ñé        | 13/100 [00:11<01:17,  1.12it/s] 14%|‚ñà‚ñç        | 14/100 [00:12<01:16,  1.13it/s] 15%|‚ñà‚ñå        | 15/100 [00:12<01:14,  1.14it/s] 16%|‚ñà‚ñå        | 16/100 [00:13<01:13,  1.15it/s] 17%|‚ñà‚ñã        | 17/100 [00:14<01:11,  1.15it/s] 18%|‚ñà‚ñä        | 18/100 [00:15<01:12,  1.14it/s] 19%|‚ñà‚ñâ        | 19/100 [00:16<01:11,  1.14it/s] 20%|‚ñà‚ñà        | 20/100 [00:17<01:11,  1.11it/s] 21%|‚ñà‚ñà        | 21/100 [00:18<01:12,  1.09it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:19<01:11,  1.09it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:20<01:12,  1.06it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:21<01:10,  1.08it/s] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:21<01:07,  1.10it/s] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:23<01:12,  1.03it/s] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:23<01:07,  1.07it/s] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:24<01:05,  1.10it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:26<01:12,  1.02s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:27<01:17,  1.11s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:28<01:22,  1.19s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:30<01:23,  1.23s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:31<01:21,  1.21s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:32<01:19,  1.21s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:33<01:19,  1.22s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:34<01:13,  1.14s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:35<01:05,  1.04s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:36<00:59,  1.05it/s] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:36<00:54,  1.13it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:37<00:52,  1.14it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:38<00:50,  1.18it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:39<00:48,  1.20it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:40<00:48,  1.17it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:41<00:48,  1.16it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:42<01:01,  1.11s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:44<01:02,  1.17s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:45<01:11,  1.35s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:47<01:10,  1.36s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:48<01:12,  1.41s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:50<01:11,  1.44s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:51<01:08,  1.40s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:53<01:07,  1.41s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:54<01:03,  1.35s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:55<01:06,  1.45s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:57<01:02,  1.40s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:58<00:59,  1.35s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:00<01:01,  1.43s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:01<01:01,  1.46s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:03<00:59,  1.44s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:04<00:59,  1.49s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:06<00:58,  1.49s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:07<00:51,  1.36s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:08<00:48,  1.32s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:09<00:47,  1.33s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:11<00:47,  1.36s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:12<00:42,  1.25s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:13<00:43,  1.31s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:14<00:40,  1.26s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:16<00:39,  1.28s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:17<00:37,  1.26s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:18<00:37,  1.30s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:20<00:36,  1.30s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:21<00:35,  1.32s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:23<00:36,  1.42s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:24<00:33,  1.36s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:25<00:32,  1.34s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:26<00:30,  1.33s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:28<00:29,  1.35s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:29<00:28,  1.37s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:30<00:27,  1.35s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:32<00:24,  1.28s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:33<00:21,  1.21s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:34<00:20,  1.20s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:35<00:17,  1.08s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:35<00:15,  1.01s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:36<00:14,  1.01s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:37<00:12,  1.02it/s] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:38<00:11,  1.05it/s] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:39<00:10,  1.07it/s] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:40<00:08,  1.14it/s] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:41<00:07,  1.15it/s] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:41<00:06,  1.20it/s] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:42<00:05,  1.18it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:43<00:05,  1.20it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:44<00:04,  1.18it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:45<00:03,  1.20it/s] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:46<00:02,  1.24it/s] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:46<00:01,  1.26it/s] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:47<00:00,  1.25it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:48<00:00,  1.25it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:48<00:00,  1.08s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.21332
wandb: 
wandb: üöÄ View run earnest-sweep-354 at: https://wandb.ai/xzy11632/dance-dev/runs/96mrkil9
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_072748-96mrkil9/logs
wandb: Agent Starting Run: qlthx5xn with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_073036-qlthx5xn
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run usual-sweep-355
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/qlthx5xn
[INFO][2024-03-18 07:30:41,727][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:30:41,857][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:30:41,858][dance][wrapped_func] Took 0:00:00.130173 to load and process data.
[INFO][2024-03-18 07:30:41,858][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 07:30:41,861][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeaturePCA',
 None,
 None][0m
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.023 MB uploadedwandb: - 0.012 MB of 0.023 MB uploadedwandb: \ 0.023 MB of 0.023 MB uploadedwandb:                                                                                
wandb: üöÄ View run usual-sweep-355 at: https://wandb.ai/xzy11632/dance-dev/runs/qlthx5xn
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_073036-qlthx5xn/logs
wandb: ERROR Run qlthx5xn errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/cell_feature.py", line 50, in __call__
wandb: ERROR     gene_feat = gene_pca.fit_transform(feat.T)  # decompose into gene features
wandb: ERROR                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
wandb: ERROR     data_to_wrap = f(self, X, *args, **kwargs)
wandb: ERROR                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 1152, in wrapper
wandb: ERROR     return fit_method(estimator, *args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 460, in fit_transform
wandb: ERROR     U, S, Vt = self._fit(X)
wandb: ERROR                ^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 483, in _fit
wandb: ERROR     X = self._validate_data(
wandb: ERROR         ^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 605, in _validate_data
wandb: ERROR     out = check_array(X, input_name="X", **check_params)
wandb: ERROR           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/validation.py", line 967, in check_array
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: Found array with 0 sample(s) (shape=(0, 5917)) while a minimum of 1 is required by PCA.
wandb: ERROR 
wandb: Agent Starting Run: 6uizdqvk with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByMeanAndDisp
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_073052-6uizdqvk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fearless-sweep-356
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/6uizdqvk
[INFO][2024-03-18 07:30:58,577][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:30:58,696][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:30:58,696][dance][wrapped_func] Took 0:00:00.117840 to load and process data.
[INFO][2024-03-18 07:30:58,696][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 07:30:58,698][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByMeanAndDisp',
 'WeightedFeatureSVD',
 None,
 None][0m
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.023 MB uploadedwandb: \ 0.012 MB of 0.023 MB uploadedwandb: | 0.023 MB of 0.023 MB uploadedwandb:                                                                                
wandb: üöÄ View run fearless-sweep-356 at: https://wandb.ai/xzy11632/dance-dev/runs/6uizdqvk
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_073052-6uizdqvk/logs
wandb: ERROR Run 6uizdqvk errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/cell_feature.py", line 98, in __call__
wandb: ERROR     svd.fit_transform(feat)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 157, in wrapped
wandb: ERROR     data_to_wrap = f(self, X, *args, **kwargs)
wandb: ERROR                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 1145, in wrapper
wandb: ERROR     estimator._validate_params()
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/base.py", line 638, in _validate_params
wandb: ERROR     validate_parameter_constraints(
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/sklearn/utils/_param_validation.py", line 96, in validate_parameter_constraints
wandb: ERROR     raise InvalidParameterError(
wandb: ERROR sklearn.utils._param_validation.InvalidParameterError: The 'n_components' parameter of TruncatedSVD must be an int in the range [1, inf). Got -1 instead.
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 6c8uhgvp with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_073119-6c8uhgvp
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rich-sweep-357
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/6c8uhgvp
[INFO][2024-03-18 07:31:25,160][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:31:25,243][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:31:25,243][dance][wrapped_func] Took 0:00:00.082715 to load and process data.
[INFO][2024-03-18 07:31:25,243][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 07:31:25,245][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeaturePCA',
 None,
 None][0m
[INFO][2024-03-18 07:31:25,979][dance.WeightedFeaturePCA][__call__] Decomposing train features (5917, 200) (k=89)
[INFO][2024-03-18 07:31:25,979][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.02%
[INFO][2024-03-18 07:31:28,291][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 07:31:28,291][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 07:31:28,291][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 07:31:28,291][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByMeanAndDisp
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:26,  1.15it/s]  2%|‚ñè         | 2/100 [00:01<01:23,  1.17it/s]  3%|‚ñé         | 3/100 [00:02<01:18,  1.24it/s]  4%|‚ñç         | 4/100 [00:03<01:17,  1.24it/s]  5%|‚ñå         | 5/100 [00:04<01:17,  1.23it/s]  6%|‚ñå         | 6/100 [00:05<01:19,  1.18it/s]  7%|‚ñã         | 7/100 [00:05<01:15,  1.24it/s]  8%|‚ñä         | 8/100 [00:06<01:14,  1.24it/s]  9%|‚ñâ         | 9/100 [00:07<01:13,  1.23it/s] 10%|‚ñà         | 10/100 [00:08<01:13,  1.23it/s] 11%|‚ñà         | 11/100 [00:08<01:12,  1.24it/s] 12%|‚ñà‚ñè        | 12/100 [00:09<01:11,  1.23it/s] 13%|‚ñà‚ñé        | 13/100 [00:10<01:10,  1.23it/s] 14%|‚ñà‚ñç        | 14/100 [00:11<01:13,  1.17it/s] 15%|‚ñà‚ñå        | 15/100 [00:12<01:11,  1.19it/s] 16%|‚ñà‚ñå        | 16/100 [00:13<01:10,  1.19it/s] 17%|‚ñà‚ñã        | 17/100 [00:14<01:09,  1.19it/s] 18%|‚ñà‚ñä        | 18/100 [00:14<01:06,  1.22it/s] 19%|‚ñà‚ñâ        | 19/100 [00:15<01:07,  1.21it/s] 20%|‚ñà‚ñà        | 20/100 [00:16<01:06,  1.20it/s] 21%|‚ñà‚ñà        | 21/100 [00:17<01:08,  1.16it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:18<01:05,  1.19it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:19<01:03,  1.21it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:19<01:03,  1.19it/s] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:20<01:00,  1.24it/s] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:21<00:59,  1.24it/s] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:22<00:58,  1.25it/s] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:22<00:56,  1.27it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:23<00:57,  1.24it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:24<00:57,  1.23it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:25<00:56,  1.21it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:26<00:59,  1.14it/s] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:27<00:57,  1.17it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:28<00:55,  1.19it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:28<00:54,  1.20it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:29<00:53,  1.20it/s] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:30<00:52,  1.20it/s] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:31<00:54,  1.14it/s] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:32<00:54,  1.12it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:33<00:52,  1.14it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:34<00:51,  1.14it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:35<00:49,  1.18it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:35<00:47,  1.20it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:36<00:46,  1.21it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:37<00:44,  1.23it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:38<00:43,  1.23it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:39<00:43,  1.22it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:40<00:44,  1.17it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:40<00:45,  1.12it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:41<00:43,  1.15it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:42<00:42,  1.15it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:43<00:41,  1.16it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:44<00:40,  1.16it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:45<00:39,  1.18it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:46<00:40,  1.12it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:46<00:38,  1.15it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [00:47<00:38,  1.13it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [00:48<00:36,  1.17it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [00:49<00:34,  1.19it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [00:50<00:33,  1.21it/s] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [00:51<00:31,  1.24it/s] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [00:51<00:29,  1.27it/s] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [00:52<00:29,  1.23it/s] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [00:53<00:29,  1.24it/s] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [00:54<00:28,  1.23it/s] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [00:55<00:28,  1.21it/s] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [00:55<00:26,  1.22it/s] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [00:56<00:25,  1.24it/s] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [00:57<00:24,  1.26it/s] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [00:58<00:23,  1.26it/s] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [00:59<00:22,  1.27it/s] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [00:59<00:22,  1.26it/s] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:00<00:22,  1.20it/s] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:01<00:21,  1.18it/s] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:02<00:21,  1.18it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:03<00:20,  1.16it/s] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:04<00:19,  1.20it/s] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:04<00:17,  1.25it/s] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:05<00:16,  1.25it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:06<00:17,  1.16it/s] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:07<00:16,  1.15it/s] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:08<00:16,  1.11it/s] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:09<00:15,  1.11it/s] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:10<00:14,  1.10it/s] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:11<00:13,  1.11it/s] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:12<00:12,  1.10it/s] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:13<00:14,  1.11s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:15<00:16,  1.39s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:16<00:13,  1.24s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:17<00:11,  1.14s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:18<00:09,  1.06s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:19<00:08,  1.01s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:20<00:06,  1.01it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:21<00:05,  1.05it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:22<00:04,  1.04it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:23<00:03,  1.02it/s] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:24<00:03,  1.03s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:25<00:02,  1.02s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:26<00:00,  1.02it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:27<00:00,  1.05it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:27<00:00,  1.15it/s]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.015 MB of 0.025 MB uploadedwandb: | 0.015 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.23727
wandb: 
wandb: üöÄ View run rich-sweep-357 at: https://wandb.ai/xzy11632/dance-dev/runs/6c8uhgvp
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_073119-6c8uhgvp/logs
wandb: Agent Starting Run: v070twd6 with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesLogarithmizedByTopGenes
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_073410-v070twd6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run charmed-sweep-358
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/v070twd6
[INFO][2024-03-18 07:34:15,929][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:34:16,037][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:34:16,037][dance][wrapped_func] Took 0:00:00.099949 to load and process data.
[INFO][2024-03-18 07:34:16,037][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 07:34:16,040][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesLogarithmizedByTopGenes',
 'WeightedFeatureSVD',
 None,
 None][0m
[INFO][2024-03-18 07:34:18,420][dance.WeightedFeatureSVD][__call__] Decomposing train features (5917, 200) (k=85)
[INFO][2024-03-18 07:34:18,421][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.14%
[INFO][2024-03-18 07:34:19,919][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 07:34:19,920][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 07:34:19,920][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 07:34:19,921][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:21,  1.21it/s]  2%|‚ñè         | 2/100 [00:01<01:19,  1.24it/s]  3%|‚ñé         | 3/100 [00:02<01:19,  1.22it/s]  4%|‚ñç         | 4/100 [00:03<01:15,  1.26it/s]  5%|‚ñå         | 5/100 [00:03<01:14,  1.28it/s]  6%|‚ñå         | 6/100 [00:04<01:12,  1.29it/s]  7%|‚ñã         | 7/100 [00:05<01:13,  1.26it/s]  8%|‚ñä         | 8/100 [00:06<01:13,  1.25it/s]  9%|‚ñâ         | 9/100 [00:07<01:15,  1.20it/s] 10%|‚ñà         | 10/100 [00:08<01:17,  1.16it/s] 11%|‚ñà         | 11/100 [00:09<01:16,  1.16it/s] 12%|‚ñà‚ñè        | 12/100 [00:09<01:17,  1.14it/s] 13%|‚ñà‚ñé        | 13/100 [00:10<01:17,  1.12it/s] 14%|‚ñà‚ñç        | 14/100 [00:11<01:14,  1.15it/s] 15%|‚ñà‚ñå        | 15/100 [00:12<01:14,  1.14it/s] 16%|‚ñà‚ñå        | 16/100 [00:13<01:17,  1.08it/s] 17%|‚ñà‚ñã        | 17/100 [00:14<01:16,  1.08it/s] 18%|‚ñà‚ñä        | 18/100 [00:15<01:13,  1.11it/s] 19%|‚ñà‚ñâ        | 19/100 [00:16<01:12,  1.12it/s] 20%|‚ñà‚ñà        | 20/100 [00:17<01:12,  1.11it/s] 21%|‚ñà‚ñà        | 21/100 [00:18<01:10,  1.12it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:18<01:08,  1.14it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:19<01:11,  1.08it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:21<01:15,  1.00it/s] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:22<01:17,  1.03s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:23<01:18,  1.07s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:24<01:18,  1.08s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:25<01:19,  1.10s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:26<01:20,  1.14s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:28<01:19,  1.14s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:29<01:18,  1.14s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:30<01:16,  1.13s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:31<01:16,  1.15s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:32<01:15,  1.14s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:33<01:12,  1.11s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:34<01:07,  1.06s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:35<01:06,  1.05s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:36<01:04,  1.04s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:37<01:07,  1.11s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:38<01:02,  1.04s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:39<00:57,  1.03it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:40<00:53,  1.08it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:41<00:57,  1.00s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:42<00:53,  1.04it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:43<00:55,  1.01s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:44<00:57,  1.06s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:45<00:53,  1.02s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:46<00:51,  1.01it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:47<00:50,  1.00it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:48<00:47,  1.06it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:49<00:44,  1.11it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:50<00:42,  1.14it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:50<00:40,  1.17it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:51<00:39,  1.17it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:52<00:39,  1.15it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:53<00:37,  1.16it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [00:54<00:36,  1.16it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [00:55<00:36,  1.16it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [00:56<00:35,  1.14it/s] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [00:57<00:36,  1.10it/s] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [00:57<00:35,  1.11it/s] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [00:59<00:39,  1.03s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:00<00:39,  1.07s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:02<00:44,  1.23s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:03<00:46,  1.32s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:04<00:42,  1.25s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:05<00:39,  1.18s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:06<00:38,  1.21s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:07<00:34,  1.11s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:08<00:30,  1.03s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:09<00:28,  1.02it/s] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:10<00:26,  1.07it/s] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:11<00:25,  1.07it/s] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:12<00:23,  1.10it/s] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:13<00:22,  1.11it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:13<00:20,  1.16it/s] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:14<00:18,  1.22it/s] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:15<00:17,  1.27it/s] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:16<00:16,  1.27it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:16<00:15,  1.30it/s] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:17<00:15,  1.25it/s] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:18<00:16,  1.08it/s] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:19<00:16,  1.03it/s] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:20<00:15,  1.01it/s] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:21<00:14,  1.05it/s] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:22<00:13,  1.07it/s] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:23<00:11,  1.11it/s] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:24<00:10,  1.14it/s] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:25<00:09,  1.15it/s] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:26<00:08,  1.17it/s] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:26<00:07,  1.17it/s] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:27<00:06,  1.21it/s] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:28<00:05,  1.23it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:29<00:04,  1.25it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:29<00:03,  1.28it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:30<00:03,  1.23it/s] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:31<00:02,  1.23it/s] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:32<00:01,  1.19it/s] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:33<00:00,  1.12it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:34<00:00,  1.13it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:34<00:00,  1.06it/s]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.20375
wandb: 
wandb: üöÄ View run charmed-sweep-358 at: https://wandb.ai/xzy11632/dance-dev/runs/v070twd6
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_073410-v070twd6/logs
wandb: Agent Starting Run: w4dkglwm with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeaturePCA
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_073641-w4dkglwm
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run revived-sweep-359
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/w4dkglwm
[INFO][2024-03-18 07:36:46,425][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:36:46,541][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:36:46,541][dance][wrapped_func] Took 0:00:00.114847 to load and process data.
[INFO][2024-03-18 07:36:46,541][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 07:36:46,544][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'WeightedFeaturePCA',
 None,
 None][0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-18 07:36:47,728][dance.WeightedFeaturePCA][__call__] Decomposing train features (5917, 200) (k=86)
[INFO][2024-03-18 07:36:47,728][dance.WeightedFeaturePCA][__call__] Total explained variance: 90.12%
[INFO][2024-03-18 07:36:49,791][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 07:36:49,791][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 07:36:49,791][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 07:36:49,791][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeaturePCA
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:28,  1.12it/s]  2%|‚ñè         | 2/100 [00:01<01:25,  1.15it/s]  3%|‚ñé         | 3/100 [00:02<01:38,  1.02s/it]  4%|‚ñç         | 4/100 [00:03<01:32,  1.04it/s]  5%|‚ñå         | 5/100 [00:04<01:27,  1.09it/s]  6%|‚ñå         | 6/100 [00:05<01:21,  1.16it/s]  7%|‚ñã         | 7/100 [00:06<01:21,  1.14it/s]  8%|‚ñä         | 8/100 [00:07<01:17,  1.19it/s]  9%|‚ñâ         | 9/100 [00:07<01:14,  1.21it/s] 10%|‚ñà         | 10/100 [00:08<01:13,  1.22it/s] 11%|‚ñà         | 11/100 [00:09<01:11,  1.24it/s] 12%|‚ñà‚ñè        | 12/100 [00:10<01:12,  1.21it/s] 13%|‚ñà‚ñé        | 13/100 [00:11<01:12,  1.20it/s] 14%|‚ñà‚ñç        | 14/100 [00:11<01:10,  1.22it/s] 15%|‚ñà‚ñå        | 15/100 [00:12<01:09,  1.23it/s] 16%|‚ñà‚ñå        | 16/100 [00:13<01:11,  1.18it/s] 17%|‚ñà‚ñã        | 17/100 [00:14<01:08,  1.22it/s] 18%|‚ñà‚ñä        | 18/100 [00:15<01:07,  1.22it/s] 19%|‚ñà‚ñâ        | 19/100 [00:16<01:08,  1.18it/s] 20%|‚ñà‚ñà        | 20/100 [00:17<01:08,  1.17it/s] 21%|‚ñà‚ñà        | 21/100 [00:17<01:08,  1.16it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:18<01:04,  1.21it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:19<01:03,  1.21it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:20<01:01,  1.23it/s] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:21<01:01,  1.23it/s] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:21<01:01,  1.21it/s] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:22<01:01,  1.19it/s] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:23<01:07,  1.07it/s] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:24<01:06,  1.08it/s] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:25<01:03,  1.10it/s] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:26<01:02,  1.11it/s] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:27<01:01,  1.10it/s] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:28<01:05,  1.03it/s] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:29<01:04,  1.02it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:30<01:04,  1.01it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:31<00:59,  1.08it/s] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:32<00:56,  1.12it/s] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:33<00:55,  1.11it/s] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:34<00:54,  1.13it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:34<00:52,  1.14it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:35<00:51,  1.14it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:36<00:50,  1.14it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:37<00:54,  1.05it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:38<00:52,  1.07it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:39<00:51,  1.08it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:40<00:49,  1.08it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:41<00:48,  1.10it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:42<00:50,  1.03it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:43<00:52,  1.02s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:44<00:52,  1.06s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:45<00:51,  1.04s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:46<00:46,  1.03it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:47<00:42,  1.10it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:48<00:41,  1.12it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:49<00:40,  1.11it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:50<00:43,  1.01it/s] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [00:51<00:42,  1.01it/s] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [00:52<00:41,  1.01it/s] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [00:53<00:42,  1.03s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [00:54<00:43,  1.09s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [00:55<00:43,  1.12s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [00:57<00:43,  1.13s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [00:58<00:41,  1.13s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [00:59<00:44,  1.24s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:00<00:42,  1.21s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:01<00:38,  1.12s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:02<00:38,  1.15s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:04<00:37,  1.17s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:05<00:38,  1.23s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:06<00:38,  1.27s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:08<00:37,  1.28s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:09<00:36,  1.31s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:10<00:33,  1.23s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:11<00:29,  1.12s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:12<00:25,  1.03s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:13<00:22,  1.05it/s] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:13<00:20,  1.11it/s] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:14<00:19,  1.14it/s] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:15<00:17,  1.18it/s] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:16<00:16,  1.19it/s] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:17<00:15,  1.20it/s] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:17<00:14,  1.21it/s] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:18<00:14,  1.21it/s] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:19<00:13,  1.16it/s] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:20<00:13,  1.15it/s] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:21<00:11,  1.18it/s] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:22<00:11,  1.18it/s] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:22<00:10,  1.19it/s] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:23<00:09,  1.19it/s] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:24<00:08,  1.22it/s] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:25<00:07,  1.21it/s] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:26<00:06,  1.22it/s] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:27<00:05,  1.22it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:27<00:04,  1.21it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:28<00:04,  1.17it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:29<00:03,  1.12it/s] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:30<00:02,  1.16it/s] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:31<00:01,  1.21it/s] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:32<00:00,  1.25it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:32<00:00,  1.28it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:32<00:00,  1.08it/s]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.018 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.24169
wandb: 
wandb: üöÄ View run revived-sweep-359 at: https://wandb.ai/xzy11632/dance-dev/runs/w4dkglwm
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_073641-w4dkglwm/logs
wandb: Agent Starting Run: iohp5o5w with config:
wandb: 	pipeline.0.filter.gene: FilterGenesScanpyOrder
wandb: 	pipeline.1.filter.cell: FilterCellsScanpyOrder
wandb: 	pipeline.2.normalize: ScaleFeature
wandb: 	pipeline.3.filter.gene: HighlyVariableGenesRawCount
wandb: 	pipeline.4.feature.cell: WeightedFeatureSVD
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_073928-iohp5o5w
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sweepy-sweep-360
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/twij69w5
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/iohp5o5w
[INFO][2024-03-18 07:39:33,829][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:39:33,933][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:39:34,048][dance][wrapped_func] Took 0:00:00.217274 to load and process data.
[INFO][2024-03-18 07:39:34,049][dance][generate_config] The content in pipeline_params will be converted to pipeline
[INFO][2024-03-18 07:39:34,055][dance][_sanitize_pipeline] Pipeline plan:
[92m['FilterGenesScanpyOrder',
 'FilterCellsScanpyOrder',
 'ScaleFeature',
 'HighlyVariableGenesRawCount',
 'WeightedFeatureSVD',
 None,
 None][0m
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/scanpy/preprocessing/_highly_variable_genes.py:64: UserWarning: `flavor='seurat_v3'` expects raw count data, but non-integers were found.
  warnings.warn(
[INFO][2024-03-18 07:39:36,412][dance.WeightedFeatureSVD][__call__] Decomposing train features (5917, 200) (k=81)
[INFO][2024-03-18 07:39:36,417][dance.WeightedFeatureSVD][__call__] Total explained variance: 89.11%
[INFO][2024-03-18 07:39:37,845][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 07:39:37,845][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 07:39:37,845][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 07:39:37,845][dance][get_feature] Indexing option for 'uns' not implemented yet.
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesScanpyOrder
  scope: _registry_.preprocessor.filter.gene
  params:
    order:
    - min_counts
    - min_cells
    - max_counts
    - max_cells
    min_counts: 1270
    max_counts: 310000
    min_cells: 0.01
    max_cells: 0.99
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    order:
    - min_counts
    - min_genes
    - max_counts
    - max_genes
    min_counts: 840
    max_counts: 8000
    min_genes: 0.01
    max_genes: 0.99
- type: normalize
  desc: null
  target: ScaleFeature
  scope: _registry_.preprocessor.normalize
  params: {}
- type: filter.gene
  desc: null
  target: HighlyVariableGenesRawCount
  scope: _registry_.preprocessor.filter.gene
  params:
    n_top_genes: 200
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    log_level: INFO
    split_name: train
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:00<01:30,  1.09it/s]  2%|‚ñè         | 2/100 [00:01<01:28,  1.11it/s]  3%|‚ñé         | 3/100 [00:02<01:23,  1.17it/s]  4%|‚ñç         | 4/100 [00:03<01:26,  1.11it/s]  5%|‚ñå         | 5/100 [00:04<01:24,  1.13it/s]  6%|‚ñå         | 6/100 [00:05<01:21,  1.16it/s]  7%|‚ñã         | 7/100 [00:06<01:18,  1.18it/s]  8%|‚ñä         | 8/100 [00:06<01:17,  1.19it/s]  9%|‚ñâ         | 9/100 [00:07<01:16,  1.19it/s] 10%|‚ñà         | 10/100 [00:08<01:16,  1.17it/s] 11%|‚ñà         | 11/100 [00:09<01:15,  1.17it/s] 12%|‚ñà‚ñè        | 12/100 [00:10<01:14,  1.19it/s] 13%|‚ñà‚ñé        | 13/100 [00:11<01:11,  1.22it/s] 14%|‚ñà‚ñç        | 14/100 [00:11<01:10,  1.23it/s] 15%|‚ñà‚ñå        | 15/100 [00:12<01:09,  1.23it/s] 16%|‚ñà‚ñå        | 16/100 [00:13<01:10,  1.19it/s] 17%|‚ñà‚ñã        | 17/100 [00:14<01:09,  1.20it/s] 18%|‚ñà‚ñä        | 18/100 [00:15<01:07,  1.22it/s] 19%|‚ñà‚ñâ        | 19/100 [00:15<01:04,  1.25it/s] 20%|‚ñà‚ñà        | 20/100 [00:16<01:02,  1.29it/s] 21%|‚ñà‚ñà        | 21/100 [00:17<01:02,  1.26it/s] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:18<01:00,  1.28it/s] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:19<01:01,  1.26it/s] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:19<01:02,  1.21it/s] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:20<01:04,  1.15it/s] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:22<01:15,  1.03s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:23<01:24,  1.15s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:25<01:32,  1.29s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:26<01:28,  1.25s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:27<01:21,  1.16s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:28<01:18,  1.14s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:29<01:16,  1.12s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:30<01:08,  1.02s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:31<01:02,  1.05it/s] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:31<00:56,  1.14it/s] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:32<00:53,  1.19it/s] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:33<00:51,  1.23it/s] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:34<00:48,  1.27it/s] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:35<00:49,  1.24it/s] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:35<00:50,  1.18it/s] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:36<00:49,  1.18it/s] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:37<00:49,  1.18it/s] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:38<00:49,  1.15it/s] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:39<00:48,  1.15it/s] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:40<00:47,  1.16it/s] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:41<00:46,  1.15it/s] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:42<00:46,  1.14it/s] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:42<00:45,  1.14it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [00:43<00:43,  1.17it/s] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [00:44<00:41,  1.19it/s] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [00:45<00:40,  1.20it/s] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [00:46<00:41,  1.15it/s] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [00:47<00:40,  1.16it/s] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [00:48<00:44,  1.04it/s] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [00:49<00:44,  1.01it/s] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [00:50<00:44,  1.02s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [00:51<00:44,  1.04s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [00:52<00:44,  1.06s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [00:53<00:43,  1.07s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [00:54<00:42,  1.07s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [00:55<00:42,  1.08s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [00:57<00:41,  1.10s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [00:58<00:39,  1.07s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [00:59<00:37,  1.04s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:00<00:35,  1.02s/it] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:01<00:34,  1.01s/it] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:02<00:33,  1.03s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:03<00:31,  1.00it/s] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:03<00:30,  1.03it/s] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:04<00:28,  1.04it/s] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:05<00:27,  1.05it/s] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:06<00:26,  1.04it/s] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:07<00:25,  1.07it/s] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:08<00:25,  1.03it/s] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:09<00:24,  1.02it/s] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:10<00:25,  1.05s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:11<00:23,  1.03s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:12<00:22,  1.04s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:13<00:21,  1.02s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:14<00:18,  1.05it/s] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:15<00:18,  1.06it/s] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:16<00:17,  1.00it/s] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:17<00:17,  1.06s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:19<00:17,  1.06s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:20<00:15,  1.04s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:21<00:14,  1.02s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:22<00:13,  1.01s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:23<00:12,  1.01s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:23<00:10,  1.04it/s] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:24<00:09,  1.06it/s] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:25<00:08,  1.08it/s] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [01:26<00:07,  1.06it/s] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [01:27<00:06,  1.11it/s] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [01:28<00:05,  1.18it/s] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [01:28<00:04,  1.25it/s] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [01:29<00:03,  1.26it/s] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [01:30<00:02,  1.25it/s] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [01:31<00:01,  1.27it/s] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [01:32<00:00,  1.27it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:32<00:00,  1.19it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [01:32<00:00,  1.08it/s]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.017 MB of 0.025 MB uploadedwandb: \ 0.017 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.22721
wandb: 
wandb: üöÄ View run sweepy-sweep-360 at: https://wandb.ai/xzy11632/dance-dev/runs/iohp5o5w
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_073928-iohp5o5w/logs
wandb: Sweep Agent: Waiting for job.
wandb: Sweep Agent: Exiting.
[INFO][2024-03-18 07:42:30,214][dance][wandb_sweep] Sweep config:
{'entity': 'xzy11632',
 'method': 'bayes',
 'metric': {'goal': 'maximize', 'name': 'acc'},
 'parameters': {'params.1.FilterCellsScanpyOrder.max_counts': {'max': 100000,
                                                               'min': 10000},
                'params.1.FilterCellsScanpyOrder.max_genes': {'max': 1.0,
                                                              'min': 0.95},
                'params.1.FilterCellsScanpyOrder.min_counts': {'max': 1000,
                                                               'min': 3},
                'params.1.FilterCellsScanpyOrder.min_genes': {'max': 0.05,
                                                              'min': 0.0},
                'params.1.FilterCellsScanpyOrder.order': {'values': [['min_counts',
                                                                      'min_genes',
                                                                      'max_counts',
                                                                      'max_genes'],
                                                                     ['min_counts',
                                                                      'min_genes',
                                                                      'max_genes',
                                                                      'max_counts'],
                                                                     ['min_counts',
                                                                      'max_counts',
                                                                      'min_genes',
                                                                      'max_genes'],
                                                                     ['min_counts',
                                                                      'max_counts',
                                                                      'max_genes',
                                                                      'min_genes'],
                                                                     ['min_counts',
                                                                      'max_genes',
                                                                      'min_genes',
                                                                      'max_counts'],
                                                                     ['min_counts',
                                                                      'max_genes',
                                                                      'max_counts',
                                                                      'min_genes'],
                                                                     ['min_genes',
                                                                      'min_counts',
                                                                      'max_counts',
                                                                      'max_genes'],
                                                                     ['min_genes',
                                                                      'min_counts',
                                                                      'max_genes',
                                                                      'max_counts'],
                                                                     ['min_genes',
                                                                      'max_counts',
                                                                      'min_counts',
                                                                      'max_genes'],
                                                                     ['min_genes',
                                                                      'max_counts',
                                                                      'max_genes',
                                                                      'min_counts'],
                                                                     ['min_genes',
                                                                      'max_genes',
                                                                      'min_counts',
                                                                      'max_counts'],
                                                                     ['min_genes',
                                                                      'max_genes',
                                                                      'max_counts',
                                                                      'min_counts'],
                                                                     ['max_counts',
                                                                      'min_counts',
                                                                      'min_genes',
                                                                      'max_genes'],
                                                                     ['max_counts',
                                                                      'min_counts',
                                                                      'max_genes',
                                                                      'min_genes'],
                                                                     ['max_counts',
                                                                      'min_genes',
                                                                      'min_counts',
                                                                      'max_genes'],
                                                                     ['max_counts',
                                                                      'min_genes',
                                                                      'max_genes',
                                                                      'min_counts'],
                                                                     ['max_counts',
                                                                      'max_genes',
                                                                      'min_counts',
                                                                      'min_genes'],
                                                                     ['max_counts',
                                                                      'max_genes',
                                                                      'min_genes',
                                                                      'min_counts'],
                                                                     ['max_genes',
                                                                      'min_counts',
                                                                      'min_genes',
                                                                      'max_counts'],
                                                                     ['max_genes',
                                                                      'min_counts',
                                                                      'max_counts',
                                                                      'min_genes'],
                                                                     ['max_genes',
                                                                      'min_genes',
                                                                      'min_counts',
                                                                      'max_counts'],
                                                                     ['max_genes',
                                                                      'min_genes',
                                                                      'max_counts',
                                                                      'min_counts'],
                                                                     ['max_genes',
                                                                      'max_counts',
                                                                      'min_counts',
                                                                      'min_genes'],
                                                                     ['max_genes',
                                                                      'max_counts',
                                                                      'min_genes',
                                                                      'min_counts']]},
                'params.2.Log1P.base': {'max': 10.0, 'min': 1.0},
                'params.3.FilterGenesTopK.mode': {'values': ['sum',
                                                             'var',
                                                             'cv',
                                                             'rv']},
                'params.3.FilterGenesTopK.num_genes': {'max': 10000,
                                                       'min': 100},
                'params.3.FilterGenesTopK.top': {'values': [True, False]},
                'params.4.WeightedFeatureSVD.feat_norm_mode': {'values': [None,
                                                                          'normalize',
                                                                          'standardize',
                                                                          'minmax',
                                                                          'l2']},
                'params.4.WeightedFeatureSVD.n_components': {'max': 0.95,
                                                             'min': 0.8}},
 'project': 'dance-dev'}
[INFO][2024-03-18 07:42:30,797][dance][wandb_sweep] [94m

	[*] Sweep ID: buxvct8o
[0m
[INFO][2024-03-18 07:42:30,797][dance][wandb_sweep_agent] Spawning agent: sweep_id='buxvct8o', entity='xzy11632', project='dance-dev', count=10
wandb: Agent Starting Run: 6g1h3ovg with config:
wandb: 	params.1.FilterCellsScanpyOrder.max_counts: 62440
wandb: 	params.1.FilterCellsScanpyOrder.max_genes: 0.9833940695070034
wandb: 	params.1.FilterCellsScanpyOrder.min_counts: 480
wandb: 	params.1.FilterCellsScanpyOrder.min_genes: 0.00034192361806867355
wandb: 	params.1.FilterCellsScanpyOrder.order: ['min_counts', 'max_genes', 'min_genes', 'max_counts']
wandb: 	params.2.Log1P.base: 4.603430316731329
wandb: 	params.3.FilterGenesTopK.mode: sum
wandb: 	params.3.FilterGenesTopK.num_genes: 4477
wandb: 	params.3.FilterGenesTopK.top: True
wandb: 	params.4.WeightedFeatureSVD.feat_norm_mode: None
wandb: 	params.4.WeightedFeatureSVD.n_components: 0.8489945548852093
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_074233-6g1h3ovg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run icy-sweep-1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/buxvct8o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/6g1h3ovg
[INFO][2024-03-18 07:42:39,275][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:42:39,366][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:42:39,367][dance][wrapped_func] Took 0:00:00.083642 to load and process data.
[INFO][2024-03-18 07:42:39,369][dance][_sanitize_params] Params plan:
[92m[None,
 {'max_counts': 62440,
  'max_genes': 0.9833940695070034,
  'min_counts': 480,
  'min_genes': 0.00034192361806867355,
  'order': ['min_counts', 'max_genes', 'min_genes', 'max_counts']},
 {'base': 4.603430316731329},
 {'mode': 'sum', 'num_genes': 4477, 'top': True},
 {'feat_norm_mode': None, 'n_components': 0.8489945548852093},
 None,
 None][0m
[WARNING][2024-03-18 07:42:39,390][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:42:39,391][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run icy-sweep-1 at: https://wandb.ai/xzy11632/dance-dev/runs/6g1h3ovg
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_074233-6g1h3ovg/logs
wandb: ERROR Run 6g1h3ovg errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 383, in __call__
wandb: ERROR     mask = self._get_preserve_mask(gene_summary)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 516, in _get_preserve_mask
wandb: ERROR     raise ValueError(f"{self.num_genes=!r} > total number of genes: {total_num_genes}")
wandb: ERROR ValueError: self.num_genes=4477 > total number of genes: 1000
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: kk601v7y with config:
wandb: 	params.1.FilterCellsScanpyOrder.max_counts: 27377
wandb: 	params.1.FilterCellsScanpyOrder.max_genes: 0.9958713539817396
wandb: 	params.1.FilterCellsScanpyOrder.min_counts: 513
wandb: 	params.1.FilterCellsScanpyOrder.min_genes: 0.02219073127859421
wandb: 	params.1.FilterCellsScanpyOrder.order: ['min_counts', 'max_genes', 'max_counts', 'min_genes']
wandb: 	params.2.Log1P.base: 3.0074673046319043
wandb: 	params.3.FilterGenesTopK.mode: var
wandb: 	params.3.FilterGenesTopK.num_genes: 1472
wandb: 	params.3.FilterGenesTopK.top: True
wandb: 	params.4.WeightedFeatureSVD.feat_norm_mode: l2
wandb: 	params.4.WeightedFeatureSVD.n_components: 0.9218798754233664
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_074259-kk601v7y
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dauntless-sweep-2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/buxvct8o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/kk601v7y
[INFO][2024-03-18 07:43:05,793][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:43:05,946][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:43:05,947][dance][wrapped_func] Took 0:00:00.152883 to load and process data.
[INFO][2024-03-18 07:43:05,948][dance][_sanitize_params] Params plan:
[92m[None,
 {'max_counts': 27377,
  'max_genes': 0.9958713539817396,
  'min_counts': 513,
  'min_genes': 0.02219073127859421,
  'order': ['min_counts', 'max_genes', 'max_counts', 'min_genes']},
 {'base': 3.0074673046319043},
 {'mode': 'var', 'num_genes': 1472, 'top': True},
 {'feat_norm_mode': 'l2', 'n_components': 0.9218798754233664},
 None,
 None][0m
[WARNING][2024-03-18 07:43:05,970][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:43:05,971][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.017 MB of 0.024 MB uploadedwandb: \ 0.017 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run dauntless-sweep-2 at: https://wandb.ai/xzy11632/dance-dev/runs/kk601v7y
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_074259-kk601v7y/logs
wandb: ERROR Run kk601v7y errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 383, in __call__
wandb: ERROR     mask = self._get_preserve_mask(gene_summary)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 516, in _get_preserve_mask
wandb: ERROR     raise ValueError(f"{self.num_genes=!r} > total number of genes: {total_num_genes}")
wandb: ERROR ValueError: self.num_genes=1472 > total number of genes: 1000
wandb: ERROR 
wandb: Agent Starting Run: uuis785m with config:
wandb: 	params.1.FilterCellsScanpyOrder.max_counts: 19281
wandb: 	params.1.FilterCellsScanpyOrder.max_genes: 0.9881347092093484
wandb: 	params.1.FilterCellsScanpyOrder.min_counts: 231
wandb: 	params.1.FilterCellsScanpyOrder.min_genes: 0.02952381465044558
wandb: 	params.1.FilterCellsScanpyOrder.order: ['max_genes', 'max_counts', 'min_counts', 'min_genes']
wandb: 	params.2.Log1P.base: 9.072665526441252
wandb: 	params.3.FilterGenesTopK.mode: sum
wandb: 	params.3.FilterGenesTopK.num_genes: 9037
wandb: 	params.3.FilterGenesTopK.top: False
wandb: 	params.4.WeightedFeatureSVD.feat_norm_mode: normalize
wandb: 	params.4.WeightedFeatureSVD.n_components: 0.8537545759945279
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_074317-uuis785m
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run robust-sweep-3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/buxvct8o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/uuis785m
[INFO][2024-03-18 07:43:25,107][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:43:25,296][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:43:25,297][dance][wrapped_func] Took 0:00:00.188894 to load and process data.
[INFO][2024-03-18 07:43:25,300][dance][_sanitize_params] Params plan:
[92m[None,
 {'max_counts': 19281,
  'max_genes': 0.9881347092093484,
  'min_counts': 231,
  'min_genes': 0.02952381465044558,
  'order': ['max_genes', 'max_counts', 'min_counts', 'min_genes']},
 {'base': 9.072665526441252},
 {'mode': 'sum', 'num_genes': 9037, 'top': False},
 {'feat_norm_mode': 'normalize', 'n_components': 0.8537545759945279},
 None,
 None][0m
[WARNING][2024-03-18 07:43:25,330][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:43:25,332][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run robust-sweep-3 at: https://wandb.ai/xzy11632/dance-dev/runs/uuis785m
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_074317-uuis785m/logs
wandb: ERROR Run uuis785m errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 383, in __call__
wandb: ERROR     mask = self._get_preserve_mask(gene_summary)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 516, in _get_preserve_mask
wandb: ERROR     raise ValueError(f"{self.num_genes=!r} > total number of genes: {total_num_genes}")
wandb: ERROR ValueError: self.num_genes=9037 > total number of genes: 1000
wandb: ERROR 
wandb: Agent Starting Run: 7rsh0aei with config:
wandb: 	params.1.FilterCellsScanpyOrder.max_counts: 79767
wandb: 	params.1.FilterCellsScanpyOrder.max_genes: 0.9502990066407094
wandb: 	params.1.FilterCellsScanpyOrder.min_counts: 570
wandb: 	params.1.FilterCellsScanpyOrder.min_genes: 0.031052279286405655
wandb: 	params.1.FilterCellsScanpyOrder.order: ['min_genes', 'max_counts', 'max_genes', 'min_counts']
wandb: 	params.2.Log1P.base: 5.276221652433209
wandb: 	params.3.FilterGenesTopK.mode: sum
wandb: 	params.3.FilterGenesTopK.num_genes: 6433
wandb: 	params.3.FilterGenesTopK.top: False
wandb: 	params.4.WeightedFeatureSVD.feat_norm_mode: normalize
wandb: 	params.4.WeightedFeatureSVD.n_components: 0.9351761586308268
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_074338-7rsh0aei
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dainty-sweep-4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/buxvct8o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/7rsh0aei
[INFO][2024-03-18 07:43:44,929][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:43:45,059][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:43:45,059][dance][wrapped_func] Took 0:00:00.128883 to load and process data.
[INFO][2024-03-18 07:43:45,062][dance][_sanitize_params] Params plan:
[92m[None,
 {'max_counts': 79767,
  'max_genes': 0.9502990066407094,
  'min_counts': 570,
  'min_genes': 0.031052279286405655,
  'order': ['min_genes', 'max_counts', 'max_genes', 'min_counts']},
 {'base': 5.276221652433209},
 {'mode': 'sum', 'num_genes': 6433, 'top': False},
 {'feat_norm_mode': 'normalize', 'n_components': 0.9351761586308268},
 None,
 None][0m
[WARNING][2024-03-18 07:43:45,092][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:43:45,093][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.012 MB of 0.024 MB uploadedwandb: - 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run dainty-sweep-4 at: https://wandb.ai/xzy11632/dance-dev/runs/7rsh0aei
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_074338-7rsh0aei/logs
wandb: ERROR Run 7rsh0aei errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 383, in __call__
wandb: ERROR     mask = self._get_preserve_mask(gene_summary)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 516, in _get_preserve_mask
wandb: ERROR     raise ValueError(f"{self.num_genes=!r} > total number of genes: {total_num_genes}")
wandb: ERROR ValueError: self.num_genes=6433 > total number of genes: 1000
wandb: ERROR 
wandb: Agent Starting Run: az0tat14 with config:
wandb: 	params.1.FilterCellsScanpyOrder.max_counts: 16325
wandb: 	params.1.FilterCellsScanpyOrder.max_genes: 0.9809007195762074
wandb: 	params.1.FilterCellsScanpyOrder.min_counts: 125
wandb: 	params.1.FilterCellsScanpyOrder.min_genes: 0.044989062658722656
wandb: 	params.1.FilterCellsScanpyOrder.order: ['max_genes', 'min_genes', 'max_counts', 'min_counts']
wandb: 	params.2.Log1P.base: 6.682515002368029
wandb: 	params.3.FilterGenesTopK.mode: var
wandb: 	params.3.FilterGenesTopK.num_genes: 5271
wandb: 	params.3.FilterGenesTopK.top: False
wandb: 	params.4.WeightedFeatureSVD.feat_norm_mode: standardize
wandb: 	params.4.WeightedFeatureSVD.n_components: 0.9274106202010424
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_074359-az0tat14
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ancient-sweep-5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/buxvct8o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/az0tat14
[INFO][2024-03-18 07:44:04,177][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:44:04,280][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:44:04,281][dance][wrapped_func] Took 0:00:00.103267 to load and process data.
[INFO][2024-03-18 07:44:04,282][dance][_sanitize_params] Params plan:
[92m[None,
 {'max_counts': 16325,
  'max_genes': 0.9809007195762074,
  'min_counts': 125,
  'min_genes': 0.044989062658722656,
  'order': ['max_genes', 'min_genes', 'max_counts', 'min_counts']},
 {'base': 6.682515002368029},
 {'mode': 'var', 'num_genes': 5271, 'top': False},
 {'feat_norm_mode': 'standardize', 'n_components': 0.9274106202010424},
 None,
 None][0m
[WARNING][2024-03-18 07:44:04,302][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:44:04,303][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.024 MB uploadedwandb: \ 0.012 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run ancient-sweep-5 at: https://wandb.ai/xzy11632/dance-dev/runs/az0tat14
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_074359-az0tat14/logs
wandb: ERROR Run az0tat14 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 383, in __call__
wandb: ERROR     mask = self._get_preserve_mask(gene_summary)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 516, in _get_preserve_mask
wandb: ERROR     raise ValueError(f"{self.num_genes=!r} > total number of genes: {total_num_genes}")
wandb: ERROR ValueError: self.num_genes=5271 > total number of genes: 1000
wandb: ERROR 
wandb: Agent Starting Run: z0qjtut8 with config:
wandb: 	params.1.FilterCellsScanpyOrder.max_counts: 22875
wandb: 	params.1.FilterCellsScanpyOrder.max_genes: 0.964345256804542
wandb: 	params.1.FilterCellsScanpyOrder.min_counts: 981
wandb: 	params.1.FilterCellsScanpyOrder.min_genes: 0.04056893917440369
wandb: 	params.1.FilterCellsScanpyOrder.order: ['max_counts', 'min_counts', 'max_genes', 'min_genes']
wandb: 	params.2.Log1P.base: 2.239181672700417
wandb: 	params.3.FilterGenesTopK.mode: sum
wandb: 	params.3.FilterGenesTopK.num_genes: 3502
wandb: 	params.3.FilterGenesTopK.top: False
wandb: 	params.4.WeightedFeatureSVD.feat_norm_mode: None
wandb: 	params.4.WeightedFeatureSVD.n_components: 0.8444160045589373
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_074415-z0qjtut8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run clean-sweep-6
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/buxvct8o
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/z0qjtut8
[INFO][2024-03-18 07:44:21,720][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:44:21,817][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:44:21,818][dance][wrapped_func] Took 0:00:00.096383 to load and process data.
[INFO][2024-03-18 07:44:21,819][dance][_sanitize_params] Params plan:
[92m[None,
 {'max_counts': 22875,
  'max_genes': 0.964345256804542,
  'min_counts': 981,
  'min_genes': 0.04056893917440369,
  'order': ['max_counts', 'min_counts', 'max_genes', 'min_genes']},
 {'base': 2.239181672700417},
 {'mode': 'sum', 'num_genes': 3502, 'top': False},
 {'feat_norm_mode': None, 'n_components': 0.8444160045589373},
 None,
 None][0m
Create sweep with ID: buxvct8o
Sweep URL: https://wandb.ai/xzy11632/dance-dev/sweeps/buxvct8o
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    max_counts: 62440
    max_genes: 0.9833940695070034
    min_counts: 480
    min_genes: 0.00034192361806867355
    order:
    - min_counts
    - max_genes
    - min_genes
    - max_counts
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 4.603430316731329
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    mode: sum
    num_genes: 4477
    top: true
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    feat_norm_mode: null
    n_components: 0.8489945548852093
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    max_counts: 27377
    max_genes: 0.9958713539817396
    min_counts: 513
    min_genes: 0.02219073127859421
    order:
    - min_counts
    - max_genes
    - max_counts
    - min_genes
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 3.0074673046319043
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    mode: var
    num_genes: 1472
    top: true
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    feat_norm_mode: l2
    n_components: 0.9218798754233664
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    max_counts: 19281
    max_genes: 0.9881347092093484
    min_counts: 231
    min_genes: 0.02952381465044558
    order:
    - max_genes
    - max_counts
    - min_counts
    - min_genes
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 9.072665526441252
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    mode: sum
    num_genes: 9037
    top: false
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    feat_norm_mode: normalize
    n_components: 0.8537545759945279
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    max_counts: 79767
    max_genes: 0.9502990066407094
    min_counts: 570
    min_genes: 0.031052279286405655
    order:
    - min_genes
    - max_counts
    - max_genes
    - min_counts
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 5.276221652433209
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    mode: sum
    num_genes: 6433
    top: false
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    feat_norm_mode: normalize
    n_components: 0.9351761586308268
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    max_counts: 16325
    max_genes: 0.9809007195762074
    min_counts: 125
    min_genes: 0.044989062658722656
    order:
    - max_genes
    - min_genes
    - max_counts
    - min_counts
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 6.682515002368029
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    mode: var
    num_genes: 5271
    top: false
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    feat_norm_mode: standardize
    n_components: 0.9274106202010424
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

[WARNING][2024-03-18 07:44:21,849][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:44:21,850][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.018 MB of 0.024 MB uploadedwandb: \ 0.018 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run clean-sweep-6 at: https://wandb.ai/xzy11632/dance-dev/runs/z0qjtut8
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_074415-z0qjtut8/logs
wandb: ERROR Run z0qjtut8 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 383, in __call__
wandb: ERROR     mask = self._get_preserve_mask(gene_summary)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/filter.py", line 516, in _get_preserve_mask
wandb: ERROR     raise ValueError(f"{self.num_genes=!r} > total number of genes: {total_num_genes}")
wandb: ERROR ValueError: self.num_genes=3502 > total number of genes: 1000
wandb: ERROR 
wandb: ERROR Detected 5 failed runs in a row at start, killing sweep.
wandb: To change this value set WANDB_AGENT_MAX_INITIAL_FAILURES=val
[INFO][2024-03-18 07:44:31,210][dance][wandb_sweep] Sweep config:
{'entity': 'xzy11632',
 'method': 'bayes',
 'metric': {'goal': 'maximize', 'name': 'acc'},
 'parameters': {'params.2.ScTransform.bin_size': {'max': 800, 'min': 300},
                'params.2.ScTransform.bw_adjust': {'max': 5.0, 'min': 1.0},
                'params.2.ScTransform.gmean_eps': {'max': 10, 'min': 1},
                'params.2.ScTransform.min_cells': {'max': 10, 'min': 1},
                'params.2.ScTransform.n_cells': {'values': [None, 1, 10, 100]},
                'params.2.ScTransform.n_genes': {'max': 3000, 'min': 1000},
                'params.3.HighlyVariableGenesLogarithmizedByTopGenes.flavor': {'values': ['seurat',
                                                                                          'cell_ranger']},
                'params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_bins': {'max': 30,
                                                                               'min': 10},
                'params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_top_genes': {'max': 10000,
                                                                                    'min': 100},
                'params.4.WeightedFeatureSVD.feat_norm_mode': {'values': [None,
                                                                          'normalize',
                                                                          'standardize',
                                                                          'minmax',
                                                                          'l2']},
                'params.4.WeightedFeatureSVD.n_components': {'max': 0.95,
                                                             'min': 0.8}},
 'project': 'dance-dev'}
[INFO][2024-03-18 07:44:31,772][dance][wandb_sweep] [94m

	[*] Sweep ID: e12gvsvk
[0m
[INFO][2024-03-18 07:44:31,772][dance][wandb_sweep_agent] Spawning agent: sweep_id='e12gvsvk', entity='xzy11632', project='dance-dev', count=10
wandb: Agent Starting Run: q3gprk9n with config:
wandb: 	params.2.ScTransform.bin_size: 473
wandb: 	params.2.ScTransform.bw_adjust: 4.907619420811239
wandb: 	params.2.ScTransform.gmean_eps: 2
wandb: 	params.2.ScTransform.min_cells: 9
wandb: 	params.2.ScTransform.n_cells: 1
wandb: 	params.2.ScTransform.n_genes: 2283
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.flavor: cell_ranger
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_bins: 24
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_top_genes: 3887
wandb: 	params.4.WeightedFeatureSVD.feat_norm_mode: minmax
wandb: 	params.4.WeightedFeatureSVD.n_components: 0.9488563330415448
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_074434-q3gprk9n
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run jolly-sweep-1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/e12gvsvk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/q3gprk9n
[INFO][2024-03-18 07:44:39,486][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:44:39,598][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:44:39,599][dance][wrapped_func] Took 0:00:00.111747 to load and process data.
[INFO][2024-03-18 07:44:39,600][dance][_sanitize_params] Params plan:
[92m[None,
 None,
 {'bin_size': 473,
  'bw_adjust': 4.907619420811239,
  'gmean_eps': 2,
  'min_cells': 9,
  'n_cells': 1,
  'n_genes': 2283},
 {'flavor': 'cell_ranger', 'n_bins': 24, 'n_top_genes': 3887},
 {'feat_norm_mode': 'minmax', 'n_components': 0.9488563330415448},
 None,
 None][0m
[WARNING][2024-03-18 07:44:39,619][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:44:39,619][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:44:39,620][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:44:39,620][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/normalize.py:277: RuntimeWarning: invalid value encountered in log10
  genes_log_gmean = np.log10(gmean(X, axis=0, eps=self.gmean_eps))
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsScanpyOrder
  scope: _registry_.preprocessor.filter.cell
  params:
    max_counts: 22875
    max_genes: 0.964345256804542
    min_counts: 981
    min_genes: 0.04056893917440369
    order:
    - max_counts
    - min_counts
    - max_genes
    - min_genes
- type: normalize
  desc: null
  target: Log1P
  scope: _registry_.preprocessor.normalize
  params:
    base: 2.239181672700417
- type: filter.gene
  desc: null
  target: FilterGenesTopK
  scope: _registry_.preprocessor.filter.gene
  params:
    mode: sum
    num_genes: 3502
    top: false
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    feat_norm_mode: null
    n_components: 0.8444160045589373
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

Create sweep with ID: e12gvsvk
Sweep URL: https://wandb.ai/xzy11632/dance-dev/sweeps/e12gvsvk
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
    bin_size: 473
    bw_adjust: 4.907619420811239
    gmean_eps: 2
    min_cells: 9
    n_cells: 1
    n_genes: 2283
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    flavor: cell_ranger
    n_bins: 24
    n_top_genes: 3887
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    feat_norm_mode: minmax
    n_components: 0.9488563330415448
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:476: RuntimeWarning: divide by zero encountered in scalar divide
  t0 = n / sum(weights * (y / mu - 1)**2)
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: invalid value encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:476: RuntimeWarning: divide by zero encountered in scalar divide
  t0 = n / sum(weights * (y / mu - 1)**2)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:476: RuntimeWarning: divide by zero encountered in scalar divide
  t0 = n / sum(weights * (y / mu - 1)**2)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:476: RuntimeWarning: divide by zero encountered in scalar divide
  t0 = n / sum(weights * (y / mu - 1)**2)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: invalid value encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: invalid value encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.018 MB of 0.025 MB uploadedwandb: - 0.018 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run jolly-sweep-1 at: https://wandb.ai/xzy11632/dance-dev/runs/q3gprk9n
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_074434-q3gprk9n/logs
wandb: ERROR Run q3gprk9n errored:
wandb: ERROR multiprocessing.pool.RemoteTraceback: 
wandb: ERROR """
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/multiprocessing/pool.py", line 125, in worker
wandb: ERROR     result = (True, func(*args, **kwds))
wandb: ERROR                     ^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/multiprocessing/pool.py", line 48, in mapstar
wandb: ERROR     return list(map(*args))
wandb: ERROR            ^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 456, in _parallel_wrapper
wandb: ERROR     res = pr.fit(disp=False)
wandb: ERROR           ^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py", line 1355, in fit
wandb: ERROR     cntfit = super(CountModel, self).fit(start_params=start_params,
wandb: ERROR              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py", line 243, in fit
wandb: ERROR     mlefit = super().fit(start_params=start_params,
wandb: ERROR              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/base/model.py", line 582, in fit
wandb: ERROR     Hinv = np.linalg.inv(-retvals['Hessian']) / nobs
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/linalg/linalg.py", line 561, in inv
wandb: ERROR     ainv = _umath_linalg.inv(a, signature=signature, extobj=extobj)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/linalg/linalg.py", line 112, in _raise_linalgerror_singular
wandb: ERROR     raise LinAlgError("Singular matrix")
wandb: ERROR numpy.linalg.LinAlgError: Singular matrix
wandb: ERROR """
wandb: ERROR 
wandb: ERROR The above exception was the direct cause of the following exception:
wandb: ERROR 
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 329, in __call__
wandb: ERROR     pool.map(_parallel_wrapper, range(umi_bin.shape[1]), chunksize=pc_chunksize)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/multiprocessing/pool.py", line 367, in map
wandb: ERROR     return self._map_async(func, iterable, mapstar, chunksize).get()
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/multiprocessing/pool.py", line 774, in get
wandb: ERROR     raise self._value
wandb: ERROR numpy.linalg.LinAlgError: Singular matrix
wandb: ERROR 
wandb: Agent Starting Run: jx8zbhlf with config:
wandb: 	params.2.ScTransform.bin_size: 728
wandb: 	params.2.ScTransform.bw_adjust: 1.9621806003259916
wandb: 	params.2.ScTransform.gmean_eps: 8
wandb: 	params.2.ScTransform.min_cells: 4
wandb: 	params.2.ScTransform.n_cells: 1
wandb: 	params.2.ScTransform.n_genes: 2854
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.flavor: cell_ranger
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_bins: 16
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_top_genes: 1564
wandb: 	params.4.WeightedFeatureSVD.feat_norm_mode: standardize
wandb: 	params.4.WeightedFeatureSVD.n_components: 0.8355343405752885
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_074450-jx8zbhlf
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run curious-sweep-2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/e12gvsvk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/jx8zbhlf
[INFO][2024-03-18 07:44:56,060][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:44:56,155][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:44:56,155][dance][wrapped_func] Took 0:00:00.092948 to load and process data.
[INFO][2024-03-18 07:44:56,156][dance][_sanitize_params] Params plan:
[92m[None,
 None,
 {'bin_size': 728,
  'bw_adjust': 1.9621806003259916,
  'gmean_eps': 8,
  'min_cells': 4,
  'n_cells': 1,
  'n_genes': 2854},
 {'flavor': 'cell_ranger', 'n_bins': 16, 'n_top_genes': 1564},
 {'feat_norm_mode': 'standardize', 'n_components': 0.8355343405752885},
 None,
 None][0m
[WARNING][2024-03-18 07:44:56,175][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:44:56,175][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:44:56,175][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:44:56,175][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/normalize.py:277: RuntimeWarning: invalid value encountered in log10
  genes_log_gmean = np.log10(gmean(X, axis=0, eps=self.gmean_eps))
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
    bin_size: 728
    bw_adjust: 1.9621806003259916
    gmean_eps: 8
    min_cells: 4
    n_cells: 1
    n_genes: 2854
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    flavor: cell_ranger
    n_bins: 16
    n_top_genes: 1564
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    feat_norm_mode: standardize
    n_components: 0.8355343405752885
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:476: RuntimeWarning: divide by zero encountered in scalar divide
  t0 = n / sum(weights * (y / mu - 1)**2)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:476: RuntimeWarning: divide by zero encountered in scalar divide
  t0 = n / sum(weights * (y / mu - 1)**2)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: invalid value encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:476: RuntimeWarning: divide by zero encountered in scalar divide
  t0 = n / sum(weights * (y / mu - 1)**2)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:476: RuntimeWarning: divide by zero encountered in scalar divide
  t0 = n / sum(weights * (y / mu - 1)**2)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:476: RuntimeWarning: divide by zero encountered in scalar divide
  t0 = n / sum(weights * (y / mu - 1)**2)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: invalid value encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: invalid value encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.013 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run curious-sweep-2 at: https://wandb.ai/xzy11632/dance-dev/runs/jx8zbhlf
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_074450-jx8zbhlf/logs
wandb: ERROR Run jx8zbhlf errored:
wandb: ERROR multiprocessing.pool.RemoteTraceback: 
wandb: ERROR """
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/multiprocessing/pool.py", line 125, in worker
wandb: ERROR     result = (True, func(*args, **kwds))
wandb: ERROR                     ^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/multiprocessing/pool.py", line 48, in mapstar
wandb: ERROR     return list(map(*args))
wandb: ERROR            ^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 456, in _parallel_wrapper
wandb: ERROR     res = pr.fit(disp=False)
wandb: ERROR           ^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py", line 1355, in fit
wandb: ERROR     cntfit = super(CountModel, self).fit(start_params=start_params,
wandb: ERROR              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py", line 243, in fit
wandb: ERROR     mlefit = super().fit(start_params=start_params,
wandb: ERROR              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/base/model.py", line 582, in fit
wandb: ERROR     Hinv = np.linalg.inv(-retvals['Hessian']) / nobs
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/linalg/linalg.py", line 561, in inv
wandb: ERROR     ainv = _umath_linalg.inv(a, signature=signature, extobj=extobj)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/linalg/linalg.py", line 112, in _raise_linalgerror_singular
wandb: ERROR     raise LinAlgError("Singular matrix")
wandb: ERROR numpy.linalg.LinAlgError: Singular matrix
wandb: ERROR """
wandb: ERROR 
wandb: ERROR The above exception was the direct cause of the following exception:
wandb: ERROR 
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 329, in __call__
wandb: ERROR     pool.map(_parallel_wrapper, range(umi_bin.shape[1]), chunksize=pc_chunksize)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/multiprocessing/pool.py", line 367, in map
wandb: ERROR     return self._map_async(func, iterable, mapstar, chunksize).get()
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/multiprocessing/pool.py", line 774, in get
wandb: ERROR     raise self._value
wandb: ERROR numpy.linalg.LinAlgError: Singular matrix
wandb: ERROR 
wandb: Agent Starting Run: 79h5o79k with config:
wandb: 	params.2.ScTransform.bin_size: 531
wandb: 	params.2.ScTransform.bw_adjust: 2.177403107259476
wandb: 	params.2.ScTransform.gmean_eps: 1
wandb: 	params.2.ScTransform.min_cells: 9
wandb: 	params.2.ScTransform.n_cells: 100
wandb: 	params.2.ScTransform.n_genes: 1619
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.flavor: seurat
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_bins: 20
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_top_genes: 6454
wandb: 	params.4.WeightedFeatureSVD.feat_norm_mode: normalize
wandb: 	params.4.WeightedFeatureSVD.n_components: 0.87745788919243
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_074507-79h5o79k
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run genial-sweep-3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/e12gvsvk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/79h5o79k
[INFO][2024-03-18 07:45:13,774][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:45:13,917][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:45:13,917][dance][wrapped_func] Took 0:00:00.141233 to load and process data.
[INFO][2024-03-18 07:45:13,919][dance][_sanitize_params] Params plan:
[92m[None,
 None,
 {'bin_size': 531,
  'bw_adjust': 2.177403107259476,
  'gmean_eps': 1,
  'min_cells': 9,
  'n_cells': 100,
  'n_genes': 1619},
 {'flavor': 'seurat', 'n_bins': 20, 'n_top_genes': 6454},
 {'feat_norm_mode': 'normalize', 'n_components': 0.87745788919243},
 None,
 None][0m
[WARNING][2024-03-18 07:45:13,942][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:45:13,942][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:45:13,943][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:45:13,943][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
    bin_size: 531
    bw_adjust: 2.177403107259476
    gmean_eps: 1
    min_cells: 9
    n_cells: 100
    n_genes: 1619
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    flavor: seurat
    n_bins: 20
    n_top_genes: 6454
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    feat_norm_mode: normalize
    n_components: 0.87745788919243
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/base/model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn("Maximum Likelihood optimization failed to "
/home/zyxing/dance/dance/transforms/normalize.py:376: RuntimeWarning: overflow encountered in cast
  X.data[:] = (d - mud) / vard**0.5
[INFO][2024-03-18 07:45:33,077][dance][set_config_from_dict] Setting config 'feature_channel' to 'CellFeatureGraph'
[INFO][2024-03-18 07:45:33,077][dance][set_config_from_dict] Setting config 'feature_channel_type' to 'uns'
[INFO][2024-03-18 07:45:33,078][dance][set_config_from_dict] Setting config 'label_channel' to 'Group'
[WARNING][2024-03-18 07:45:33,078][dance][get_feature] Indexing option for 'uns' not implemented yet.
  0%|          | 0/100 [00:00<?, ?it/s]/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/dgl/dataloading/dataloader.py:1149: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
  1%|          | 1/100 [00:01<02:35,  1.57s/it]  2%|‚ñè         | 2/100 [00:03<02:30,  1.54s/it]  3%|‚ñé         | 3/100 [00:04<02:30,  1.55s/it]  4%|‚ñç         | 4/100 [00:05<02:17,  1.44s/it]  5%|‚ñå         | 5/100 [00:07<02:27,  1.55s/it]  6%|‚ñå         | 6/100 [00:08<02:15,  1.44s/it]  7%|‚ñã         | 7/100 [00:10<02:09,  1.39s/it]  8%|‚ñä         | 8/100 [00:11<01:58,  1.29s/it]  9%|‚ñâ         | 9/100 [00:12<01:56,  1.28s/it] 10%|‚ñà         | 10/100 [00:13<01:50,  1.22s/it] 11%|‚ñà         | 11/100 [00:14<01:49,  1.23s/it] 12%|‚ñà‚ñè        | 12/100 [00:16<01:46,  1.21s/it] 13%|‚ñà‚ñé        | 13/100 [00:17<01:47,  1.24s/it] 14%|‚ñà‚ñç        | 14/100 [00:18<01:44,  1.21s/it] 15%|‚ñà‚ñå        | 15/100 [00:19<01:42,  1.20s/it] 16%|‚ñà‚ñå        | 16/100 [00:20<01:41,  1.21s/it] 17%|‚ñà‚ñã        | 17/100 [00:22<01:39,  1.20s/it] 18%|‚ñà‚ñä        | 18/100 [00:23<01:41,  1.23s/it] 19%|‚ñà‚ñâ        | 19/100 [00:24<01:35,  1.18s/it] 20%|‚ñà‚ñà        | 20/100 [00:25<01:34,  1.19s/it] 21%|‚ñà‚ñà        | 21/100 [00:26<01:32,  1.17s/it] 22%|‚ñà‚ñà‚ñè       | 22/100 [00:27<01:32,  1.18s/it] 23%|‚ñà‚ñà‚ñé       | 23/100 [00:29<01:28,  1.15s/it] 24%|‚ñà‚ñà‚ñç       | 24/100 [00:30<01:29,  1.18s/it] 25%|‚ñà‚ñà‚ñå       | 25/100 [00:31<01:27,  1.17s/it] 26%|‚ñà‚ñà‚ñå       | 26/100 [00:32<01:28,  1.19s/it] 27%|‚ñà‚ñà‚ñã       | 27/100 [00:33<01:26,  1.19s/it] 28%|‚ñà‚ñà‚ñä       | 28/100 [00:35<01:28,  1.22s/it] 29%|‚ñà‚ñà‚ñâ       | 29/100 [00:36<01:25,  1.20s/it] 30%|‚ñà‚ñà‚ñà       | 30/100 [00:37<01:24,  1.21s/it] 31%|‚ñà‚ñà‚ñà       | 31/100 [00:38<01:22,  1.19s/it] 32%|‚ñà‚ñà‚ñà‚ñè      | 32/100 [00:39<01:20,  1.18s/it] 33%|‚ñà‚ñà‚ñà‚ñé      | 33/100 [00:41<01:19,  1.19s/it] 34%|‚ñà‚ñà‚ñà‚ñç      | 34/100 [00:42<01:18,  1.19s/it] 35%|‚ñà‚ñà‚ñà‚ñå      | 35/100 [00:43<01:21,  1.25s/it] 36%|‚ñà‚ñà‚ñà‚ñå      | 36/100 [00:44<01:17,  1.22s/it] 37%|‚ñà‚ñà‚ñà‚ñã      | 37/100 [00:46<01:16,  1.22s/it] 38%|‚ñà‚ñà‚ñà‚ñä      | 38/100 [00:47<01:12,  1.17s/it] 39%|‚ñà‚ñà‚ñà‚ñâ      | 39/100 [00:48<01:12,  1.19s/it] 40%|‚ñà‚ñà‚ñà‚ñà      | 40/100 [00:49<01:08,  1.15s/it] 41%|‚ñà‚ñà‚ñà‚ñà      | 41/100 [00:50<01:09,  1.18s/it] 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 42/100 [00:51<01:07,  1.16s/it] 43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 43/100 [00:52<01:07,  1.18s/it] 44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 44/100 [00:54<01:04,  1.16s/it] 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 45/100 [00:55<01:05,  1.20s/it] 46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 46/100 [00:56<01:03,  1.18s/it] 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 47/100 [00:57<01:04,  1.21s/it] 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 48/100 [00:58<01:02,  1.21s/it] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 49/100 [01:00<00:59,  1.17s/it] 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 50/100 [01:01<00:59,  1.19s/it] 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 51/100 [01:02<00:56,  1.16s/it] 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 52/100 [01:03<00:56,  1.18s/it] 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 53/100 [01:04<00:54,  1.15s/it] 54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 54/100 [01:05<00:53,  1.16s/it] 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 55/100 [01:06<00:51,  1.14s/it] 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 56/100 [01:08<00:51,  1.18s/it] 57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 57/100 [01:09<00:50,  1.16s/it] 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 58/100 [01:10<00:51,  1.24s/it] 59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 59/100 [01:11<00:50,  1.22s/it] 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 60/100 [01:13<00:47,  1.20s/it] 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 61/100 [01:14<00:44,  1.13s/it] 62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 62/100 [01:15<00:40,  1.08s/it] 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 63/100 [01:15<00:38,  1.05s/it] 64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 64/100 [01:16<00:36,  1.02s/it] 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 65/100 [01:17<00:34,  1.01it/s] 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 66/100 [01:18<00:33,  1.01it/s] 67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 67/100 [01:21<00:50,  1.52s/it] 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 68/100 [01:24<01:04,  2.00s/it] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 69/100 [01:28<01:15,  2.42s/it] 70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 70/100 [01:30<01:14,  2.49s/it] 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 71/100 [01:33<01:12,  2.49s/it] 72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 72/100 [01:35<01:07,  2.40s/it] 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 73/100 [01:37<01:02,  2.31s/it] 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 74/100 [01:39<00:55,  2.15s/it] 75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 75/100 [01:40<00:46,  1.87s/it] 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 76/100 [01:41<00:39,  1.67s/it] 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 77/100 [01:42<00:35,  1.53s/it] 78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 78/100 [01:44<00:32,  1.47s/it] 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 79/100 [01:45<00:28,  1.37s/it] 80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 80/100 [01:46<00:25,  1.29s/it] 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 81/100 [01:47<00:23,  1.26s/it] 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 82/100 [01:48<00:22,  1.26s/it] 83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 83/100 [01:50<00:21,  1.24s/it] 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 84/100 [01:51<00:19,  1.22s/it] 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 85/100 [01:52<00:17,  1.18s/it] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 86/100 [01:53<00:16,  1.15s/it] 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 87/100 [01:54<00:14,  1.15s/it] 88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 88/100 [01:55<00:14,  1.18s/it] 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 89/100 [01:57<00:13,  1.21s/it] 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 90/100 [01:58<00:12,  1.23s/it] 91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 91/100 [01:59<00:10,  1.21s/it] 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 92/100 [02:00<00:09,  1.20s/it] 93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 93/100 [02:01<00:08,  1.19s/it] 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 94/100 [02:03<00:07,  1.20s/it] 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 95/100 [02:04<00:05,  1.17s/it] 96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 96/100 [02:05<00:04,  1.16s/it] 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 97/100 [02:06<00:03,  1.15s/it] 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 98/100 [02:07<00:02,  1.14s/it] 99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 99/100 [02:08<00:01,  1.14s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:09<00:00,  1.14s/it]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [02:09<00:00,  1.30s/it]
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.026 MB uploadedwandb: \ 0.026 MB of 0.026 MB uploadedwandb: | 0.026 MB of 0.026 MB uploadedwandb: / 0.026 MB of 0.026 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb: acc ‚ñÅ
wandb: 
wandb: Run summary:
wandb: acc 0.10248
wandb: 
wandb: üöÄ View run genial-sweep-3 at: https://wandb.ai/xzy11632/dance-dev/runs/79h5o79k
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_074507-79h5o79k/logs
wandb: Agent Starting Run: fylvekwz with config:
wandb: 	params.2.ScTransform.bin_size: 379
wandb: 	params.2.ScTransform.bw_adjust: 4.090143434669404
wandb: 	params.2.ScTransform.gmean_eps: 7
wandb: 	params.2.ScTransform.min_cells: 4
wandb: 	params.2.ScTransform.n_cells: 100
wandb: 	params.2.ScTransform.n_genes: 1001
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.flavor: cell_ranger
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_bins: 12
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_top_genes: 7576
wandb: 	params.4.WeightedFeatureSVD.feat_norm_mode: l2
wandb: 	params.4.WeightedFeatureSVD.n_components: 0.885045798685858
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_074905-fylvekwz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run legendary-sweep-4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/e12gvsvk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/fylvekwz
[INFO][2024-03-18 07:49:09,625][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:49:09,715][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:49:09,715][dance][wrapped_func] Took 0:00:00.089870 to load and process data.
[INFO][2024-03-18 07:49:09,717][dance][_sanitize_params] Params plan:
[92m[None,
 None,
 {'bin_size': 379,
  'bw_adjust': 4.090143434669404,
  'gmean_eps': 7,
  'min_cells': 4,
  'n_cells': 100,
  'n_genes': 1001},
 {'flavor': 'cell_ranger', 'n_bins': 12, 'n_top_genes': 7576},
 {'feat_norm_mode': 'l2', 'n_components': 0.885045798685858},
 None,
 None][0m
[WARNING][2024-03-18 07:49:09,733][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:49:09,733][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:49:09,734][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:49:09,734][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/normalize.py:277: RuntimeWarning: invalid value encountered in log10
  genes_log_gmean = np.log10(gmean(X, axis=0, eps=self.gmean_eps))
/home/zyxing/dance/dance/transforms/normalize.py:283: RuntimeWarning: invalid value encountered in log10
  genes_log_gmean_step1 = np.log10(gmean(X[cells_step1][:, genes_step1], axis=0, eps=self.gmean_eps))
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
    bin_size: 379
    bw_adjust: 4.090143434669404
    gmean_eps: 7
    min_cells: 4
    n_cells: 100
    n_genes: 1001
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    flavor: cell_ranger
    n_bins: 12
    n_top_genes: 7576
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    feat_norm_mode: l2
    n_components: 0.885045798685858
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/base/model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn("Maximum Likelihood optimization failed to "
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.022 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run legendary-sweep-4 at: https://wandb.ai/xzy11632/dance-dev/runs/fylvekwz
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_074905-fylvekwz/logs
wandb: ERROR Run fylvekwz errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 348, in __call__
wandb: ERROR     [is_outlier(model_pars.values[:, i], genes_log_gmean_step1) for i in range(model_pars.shape[1])]).sum(0) > 0
wandb: ERROR     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 348, in <listcomp>
wandb: ERROR     [is_outlier(model_pars.values[:, i], genes_log_gmean_step1) for i in range(model_pars.shape[1])]).sum(0) > 0
wandb: ERROR      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 427, in is_outlier
wandb: ERROR     z = FFTKDE(kernel='gaussian', bw='ISJ').fit(x)
wandb: ERROR         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/FFTKDE.py", line 107, in fit
wandb: ERROR     super().fit(data, weights)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/BaseKDE.py", line 102, in fit
wandb: ERROR     data = self._process_sequence(data)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/BaseKDE.py", line 208, in _process_sequence
wandb: ERROR     return np.asarray_chkfinite(out, dtype=float)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/lib/function_base.py", line 630, in asarray_chkfinite
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: array must not contain infs or NaNs
wandb: ERROR 
wandb: Agent Starting Run: 2h2dey8u with config:
wandb: 	params.2.ScTransform.bin_size: 311
wandb: 	params.2.ScTransform.bw_adjust: 1.4530498359924282
wandb: 	params.2.ScTransform.gmean_eps: 10
wandb: 	params.2.ScTransform.min_cells: 4
wandb: 	params.2.ScTransform.n_cells: 100
wandb: 	params.2.ScTransform.n_genes: 2220
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.flavor: seurat
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_bins: 18
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_top_genes: 1508
wandb: 	params.4.WeightedFeatureSVD.feat_norm_mode: minmax
wandb: 	params.4.WeightedFeatureSVD.n_components: 0.8217702286631624
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_074926-2h2dey8u
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wandering-sweep-5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/e12gvsvk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/2h2dey8u
[INFO][2024-03-18 07:49:31,970][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:49:32,084][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:49:32,084][dance][wrapped_func] Took 0:00:00.104951 to load and process data.
[INFO][2024-03-18 07:49:32,086][dance][_sanitize_params] Params plan:
[92m[None,
 None,
 {'bin_size': 311,
  'bw_adjust': 1.4530498359924282,
  'gmean_eps': 10,
  'min_cells': 4,
  'n_cells': 100,
  'n_genes': 2220},
 {'flavor': 'seurat', 'n_bins': 18, 'n_top_genes': 1508},
 {'feat_norm_mode': 'minmax', 'n_components': 0.8217702286631624},
 None,
 None][0m
[WARNING][2024-03-18 07:49:32,101][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:49:32,101][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:49:32,102][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:49:32,102][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/normalize.py:277: RuntimeWarning: invalid value encountered in log10
  genes_log_gmean = np.log10(gmean(X, axis=0, eps=self.gmean_eps))
/home/zyxing/dance/dance/transforms/normalize.py:283: RuntimeWarning: invalid value encountered in log10
  genes_log_gmean_step1 = np.log10(gmean(X[cells_step1][:, genes_step1], axis=0, eps=self.gmean_eps))
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
    bin_size: 311
    bw_adjust: 1.4530498359924282
    gmean_eps: 10
    min_cells: 4
    n_cells: 100
    n_genes: 2220
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    flavor: seurat
    n_bins: 18
    n_top_genes: 1508
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    feat_norm_mode: minmax
    n_components: 0.8217702286631624
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/base/model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn("Maximum Likelihood optimization failed to "
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run wandering-sweep-5 at: https://wandb.ai/xzy11632/dance-dev/runs/2h2dey8u
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_074926-2h2dey8u/logs
wandb: ERROR Run 2h2dey8u errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 348, in __call__
wandb: ERROR     [is_outlier(model_pars.values[:, i], genes_log_gmean_step1) for i in range(model_pars.shape[1])]).sum(0) > 0
wandb: ERROR     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 348, in <listcomp>
wandb: ERROR     [is_outlier(model_pars.values[:, i], genes_log_gmean_step1) for i in range(model_pars.shape[1])]).sum(0) > 0
wandb: ERROR      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 427, in is_outlier
wandb: ERROR     z = FFTKDE(kernel='gaussian', bw='ISJ').fit(x)
wandb: ERROR         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/FFTKDE.py", line 107, in fit
wandb: ERROR     super().fit(data, weights)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/BaseKDE.py", line 102, in fit
wandb: ERROR     data = self._process_sequence(data)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/BaseKDE.py", line 208, in _process_sequence
wandb: ERROR     return np.asarray_chkfinite(out, dtype=float)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/lib/function_base.py", line 630, in asarray_chkfinite
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: array must not contain infs or NaNs
wandb: ERROR 
wandb: Agent Starting Run: lekt6bjo with config:
wandb: 	params.2.ScTransform.bin_size: 342
wandb: 	params.2.ScTransform.bw_adjust: 2.5911719353839273
wandb: 	params.2.ScTransform.gmean_eps: 7
wandb: 	params.2.ScTransform.min_cells: 7
wandb: 	params.2.ScTransform.n_cells: 100
wandb: 	params.2.ScTransform.n_genes: 1306
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.flavor: cell_ranger
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_bins: 25
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_top_genes: 5424
wandb: 	params.4.WeightedFeatureSVD.feat_norm_mode: l2
wandb: 	params.4.WeightedFeatureSVD.n_components: 0.8384907736102032
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_074947-lekt6bjo
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run frosty-sweep-6
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/e12gvsvk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/lekt6bjo
[INFO][2024-03-18 07:49:51,962][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:49:52,053][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:49:52,054][dance][wrapped_func] Took 0:00:00.090315 to load and process data.
[INFO][2024-03-18 07:49:52,056][dance][_sanitize_params] Params plan:
[92m[None,
 None,
 {'bin_size': 342,
  'bw_adjust': 2.5911719353839273,
  'gmean_eps': 7,
  'min_cells': 7,
  'n_cells': 100,
  'n_genes': 1306},
 {'flavor': 'cell_ranger', 'n_bins': 25, 'n_top_genes': 5424},
 {'feat_norm_mode': 'l2', 'n_components': 0.8384907736102032},
 None,
 None][0m
[WARNING][2024-03-18 07:49:52,073][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:49:52,073][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:49:52,074][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:49:52,074][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/normalize.py:277: RuntimeWarning: invalid value encountered in log10
  genes_log_gmean = np.log10(gmean(X, axis=0, eps=self.gmean_eps))
/home/zyxing/dance/dance/transforms/normalize.py:283: RuntimeWarning: invalid value encountered in log10
  genes_log_gmean_step1 = np.log10(gmean(X[cells_step1][:, genes_step1], axis=0, eps=self.gmean_eps))
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
    bin_size: 342
    bw_adjust: 2.5911719353839273
    gmean_eps: 7
    min_cells: 7
    n_cells: 100
    n_genes: 1306
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    flavor: cell_ranger
    n_bins: 25
    n_top_genes: 5424
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    feat_norm_mode: l2
    n_components: 0.8384907736102032
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/base/model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn("Maximum Likelihood optimization failed to "
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run frosty-sweep-6 at: https://wandb.ai/xzy11632/dance-dev/runs/lekt6bjo
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_074947-lekt6bjo/logs
wandb: ERROR Run lekt6bjo errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 348, in __call__
wandb: ERROR     [is_outlier(model_pars.values[:, i], genes_log_gmean_step1) for i in range(model_pars.shape[1])]).sum(0) > 0
wandb: ERROR     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 348, in <listcomp>
wandb: ERROR     [is_outlier(model_pars.values[:, i], genes_log_gmean_step1) for i in range(model_pars.shape[1])]).sum(0) > 0
wandb: ERROR      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 427, in is_outlier
wandb: ERROR     z = FFTKDE(kernel='gaussian', bw='ISJ').fit(x)
wandb: ERROR         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/FFTKDE.py", line 107, in fit
wandb: ERROR     super().fit(data, weights)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/BaseKDE.py", line 102, in fit
wandb: ERROR     data = self._process_sequence(data)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/BaseKDE.py", line 208, in _process_sequence
wandb: ERROR     return np.asarray_chkfinite(out, dtype=float)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/lib/function_base.py", line 630, in asarray_chkfinite
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: array must not contain infs or NaNs
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: wop8jusz with config:
wandb: 	params.2.ScTransform.bin_size: 663
wandb: 	params.2.ScTransform.bw_adjust: 4.061460543089599
wandb: 	params.2.ScTransform.gmean_eps: 6
wandb: 	params.2.ScTransform.min_cells: 4
wandb: 	params.2.ScTransform.n_cells: 1
wandb: 	params.2.ScTransform.n_genes: 2292
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.flavor: cell_ranger
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_bins: 19
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_top_genes: 437
wandb: 	params.4.WeightedFeatureSVD.feat_norm_mode: l2
wandb: 	params.4.WeightedFeatureSVD.n_components: 0.8593212736031212
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_075015-wop8jusz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run expert-sweep-7
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/e12gvsvk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/wop8jusz
[INFO][2024-03-18 07:50:21,136][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:50:21,241][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:50:21,241][dance][wrapped_func] Took 0:00:00.103688 to load and process data.
[INFO][2024-03-18 07:50:21,244][dance][_sanitize_params] Params plan:
[92m[None,
 None,
 {'bin_size': 663,
  'bw_adjust': 4.061460543089599,
  'gmean_eps': 6,
  'min_cells': 4,
  'n_cells': 1,
  'n_genes': 2292},
 {'flavor': 'cell_ranger', 'n_bins': 19, 'n_top_genes': 437},
 {'feat_norm_mode': 'l2', 'n_components': 0.8593212736031212},
 None,
 None][0m
[WARNING][2024-03-18 07:50:21,273][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:50:21,274][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:50:21,274][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:50:21,275][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/normalize.py:277: RuntimeWarning: invalid value encountered in log10
  genes_log_gmean = np.log10(gmean(X, axis=0, eps=self.gmean_eps))
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
    bin_size: 663
    bw_adjust: 4.061460543089599
    gmean_eps: 6
    min_cells: 4
    n_cells: 1
    n_genes: 2292
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    flavor: cell_ranger
    n_bins: 19
    n_top_genes: 437
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    feat_norm_mode: l2
    n_components: 0.8593212736031212
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:476: RuntimeWarning: divide by zero encountered in scalar divide
  t0 = n / sum(weights * (y / mu - 1)**2)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: invalid value encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:476: RuntimeWarning: divide by zero encountered in scalar divide
  t0 = n / sum(weights * (y / mu - 1)**2)
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:476: RuntimeWarning: divide by zero encountered in scalar divide
  t0 = n / sum(weights * (y / mu - 1)**2)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:476: RuntimeWarning: divide by zero encountered in scalar divide
  t0 = n / sum(weights * (y / mu - 1)**2)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:476: RuntimeWarning: divide by zero encountered in scalar divide
  t0 = n / sum(weights * (y / mu - 1)**2)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run expert-sweep-7 at: https://wandb.ai/xzy11632/dance-dev/runs/wop8jusz
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_075015-wop8jusz/logs
wandb: ERROR Run wop8jusz errored:
wandb: ERROR multiprocessing.pool.RemoteTraceback: 
wandb: ERROR """
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/multiprocessing/pool.py", line 125, in worker
wandb: ERROR     result = (True, func(*args, **kwds))
wandb: ERROR                     ^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/multiprocessing/pool.py", line 48, in mapstar
wandb: ERROR     return list(map(*args))
wandb: ERROR            ^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 456, in _parallel_wrapper
wandb: ERROR     res = pr.fit(disp=False)
wandb: ERROR           ^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py", line 1355, in fit
wandb: ERROR     cntfit = super(CountModel, self).fit(start_params=start_params,
wandb: ERROR              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py", line 243, in fit
wandb: ERROR     mlefit = super().fit(start_params=start_params,
wandb: ERROR              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/base/model.py", line 582, in fit
wandb: ERROR     Hinv = np.linalg.inv(-retvals['Hessian']) / nobs
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/linalg/linalg.py", line 561, in inv
wandb: ERROR     ainv = _umath_linalg.inv(a, signature=signature, extobj=extobj)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/linalg/linalg.py", line 112, in _raise_linalgerror_singular
wandb: ERROR     raise LinAlgError("Singular matrix")
wandb: ERROR numpy.linalg.LinAlgError: Singular matrix
wandb: ERROR """
wandb: ERROR 
wandb: ERROR The above exception was the direct cause of the following exception:
wandb: ERROR 
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 329, in __call__
wandb: ERROR     pool.map(_parallel_wrapper, range(umi_bin.shape[1]), chunksize=pc_chunksize)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/multiprocessing/pool.py", line 367, in map
wandb: ERROR     return self._map_async(func, iterable, mapstar, chunksize).get()
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/multiprocessing/pool.py", line 774, in get
wandb: ERROR     raise self._value
wandb: ERROR numpy.linalg.LinAlgError: Singular matrix
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: v5jf99w2 with config:
wandb: 	params.2.ScTransform.bin_size: 702
wandb: 	params.2.ScTransform.bw_adjust: 2.7921054126507614
wandb: 	params.2.ScTransform.gmean_eps: 8
wandb: 	params.2.ScTransform.min_cells: 7
wandb: 	params.2.ScTransform.n_cells: None
wandb: 	params.2.ScTransform.n_genes: 2882
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.flavor: cell_ranger
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_bins: 22
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_top_genes: 2309
wandb: 	params.4.WeightedFeatureSVD.feat_norm_mode: None
wandb: 	params.4.WeightedFeatureSVD.n_components: 0.8142910361538676
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_075045-v5jf99w2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run light-sweep-8
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/e12gvsvk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/v5jf99w2
[INFO][2024-03-18 07:50:50,699][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:50:50,797][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:50:50,797][dance][wrapped_func] Took 0:00:00.097034 to load and process data.
[INFO][2024-03-18 07:50:50,799][dance][_sanitize_params] Params plan:
[92m[None,
 None,
 {'bin_size': 702,
  'bw_adjust': 2.7921054126507614,
  'gmean_eps': 8,
  'min_cells': 7,
  'n_cells': None,
  'n_genes': 2882},
 {'flavor': 'cell_ranger', 'n_bins': 22, 'n_top_genes': 2309},
 {'feat_norm_mode': None, 'n_components': 0.8142910361538676},
 None,
 None][0m
[WARNING][2024-03-18 07:50:50,820][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:50:50,820][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:50:50,821][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:50:50,821][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/normalize.py:277: RuntimeWarning: invalid value encountered in log10
  genes_log_gmean = np.log10(gmean(X, axis=0, eps=self.gmean_eps))
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
    bin_size: 702
    bw_adjust: 2.7921054126507614
    gmean_eps: 8
    min_cells: 7
    n_cells: null
    n_genes: 2882
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    flavor: cell_ranger
    n_bins: 22
    n_top_genes: 2309
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    feat_norm_mode: null
    n_components: 0.8142910361538676
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.022 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run light-sweep-8 at: https://wandb.ai/xzy11632/dance-dev/runs/v5jf99w2
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_075045-v5jf99w2/logs
wandb: ERROR Run v5jf99w2 errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 348, in __call__
wandb: ERROR     [is_outlier(model_pars.values[:, i], genes_log_gmean_step1) for i in range(model_pars.shape[1])]).sum(0) > 0
wandb: ERROR     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 348, in <listcomp>
wandb: ERROR     [is_outlier(model_pars.values[:, i], genes_log_gmean_step1) for i in range(model_pars.shape[1])]).sum(0) > 0
wandb: ERROR      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 427, in is_outlier
wandb: ERROR     z = FFTKDE(kernel='gaussian', bw='ISJ').fit(x)
wandb: ERROR         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/FFTKDE.py", line 107, in fit
wandb: ERROR     super().fit(data, weights)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/BaseKDE.py", line 102, in fit
wandb: ERROR     data = self._process_sequence(data)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/BaseKDE.py", line 208, in _process_sequence
wandb: ERROR     return np.asarray_chkfinite(out, dtype=float)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/lib/function_base.py", line 630, in asarray_chkfinite
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: array must not contain infs or NaNs
wandb: ERROR 
wandb: Agent Starting Run: 1dnrla0w with config:
wandb: 	params.2.ScTransform.bin_size: 380
wandb: 	params.2.ScTransform.bw_adjust: 3.415274051053377
wandb: 	params.2.ScTransform.gmean_eps: 4
wandb: 	params.2.ScTransform.min_cells: 8
wandb: 	params.2.ScTransform.n_cells: 100
wandb: 	params.2.ScTransform.n_genes: 1130
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.flavor: cell_ranger
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_bins: 15
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_top_genes: 4495
wandb: 	params.4.WeightedFeatureSVD.feat_norm_mode: None
wandb: 	params.4.WeightedFeatureSVD.n_components: 0.9466736886011946
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_075202-1dnrla0w
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run prime-sweep-9
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/e12gvsvk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/1dnrla0w
[INFO][2024-03-18 07:52:10,152][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:52:10,250][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:52:10,251][dance][wrapped_func] Took 0:00:00.097381 to load and process data.
[INFO][2024-03-18 07:52:10,253][dance][_sanitize_params] Params plan:
[92m[None,
 None,
 {'bin_size': 380,
  'bw_adjust': 3.415274051053377,
  'gmean_eps': 4,
  'min_cells': 8,
  'n_cells': 100,
  'n_genes': 1130},
 {'flavor': 'cell_ranger', 'n_bins': 15, 'n_top_genes': 4495},
 {'feat_norm_mode': None, 'n_components': 0.9466736886011946},
 None,
 None][0m
[WARNING][2024-03-18 07:52:10,273][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:52:10,273][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:52:10,274][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:52:10,274][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/normalize.py:277: RuntimeWarning: invalid value encountered in log10
  genes_log_gmean = np.log10(gmean(X, axis=0, eps=self.gmean_eps))
/home/zyxing/dance/dance/transforms/normalize.py:283: RuntimeWarning: invalid value encountered in log10
  genes_log_gmean_step1 = np.log10(gmean(X[cells_step1][:, genes_step1], axis=0, eps=self.gmean_eps))
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
    bin_size: 380
    bw_adjust: 3.415274051053377
    gmean_eps: 4
    min_cells: 8
    n_cells: 100
    n_genes: 1130
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    flavor: cell_ranger
    n_bins: 15
    n_top_genes: 4495
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    feat_norm_mode: null
    n_components: 0.9466736886011946
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/base/model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn("Maximum Likelihood optimization failed to "
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.022 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.025 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run prime-sweep-9 at: https://wandb.ai/xzy11632/dance-dev/runs/1dnrla0w
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_075202-1dnrla0w/logs
wandb: ERROR Run 1dnrla0w errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 348, in __call__
wandb: ERROR     [is_outlier(model_pars.values[:, i], genes_log_gmean_step1) for i in range(model_pars.shape[1])]).sum(0) > 0
wandb: ERROR     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 348, in <listcomp>
wandb: ERROR     [is_outlier(model_pars.values[:, i], genes_log_gmean_step1) for i in range(model_pars.shape[1])]).sum(0) > 0
wandb: ERROR      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 427, in is_outlier
wandb: ERROR     z = FFTKDE(kernel='gaussian', bw='ISJ').fit(x)
wandb: ERROR         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/FFTKDE.py", line 107, in fit
wandb: ERROR     super().fit(data, weights)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/BaseKDE.py", line 102, in fit
wandb: ERROR     data = self._process_sequence(data)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/BaseKDE.py", line 208, in _process_sequence
wandb: ERROR     return np.asarray_chkfinite(out, dtype=float)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/lib/function_base.py", line 630, in asarray_chkfinite
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: array must not contain infs or NaNs
wandb: ERROR 
wandb: Agent Starting Run: urhw25pk with config:
wandb: 	params.2.ScTransform.bin_size: 574
wandb: 	params.2.ScTransform.bw_adjust: 2.8929186218262046
wandb: 	params.2.ScTransform.gmean_eps: 8
wandb: 	params.2.ScTransform.min_cells: 5
wandb: 	params.2.ScTransform.n_cells: None
wandb: 	params.2.ScTransform.n_genes: 2979
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.flavor: cell_ranger
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_bins: 29
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_top_genes: 9031
wandb: 	params.4.WeightedFeatureSVD.feat_norm_mode: minmax
wandb: 	params.4.WeightedFeatureSVD.n_components: 0.8694391442724448
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_075228-urhw25pk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run upbeat-sweep-10
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/e12gvsvk
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/urhw25pk
[INFO][2024-03-18 07:52:33,149][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:52:33,250][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:52:33,250][dance][wrapped_func] Took 0:00:00.099430 to load and process data.
[INFO][2024-03-18 07:52:33,253][dance][_sanitize_params] Params plan:
[92m[None,
 None,
 {'bin_size': 574,
  'bw_adjust': 2.8929186218262046,
  'gmean_eps': 8,
  'min_cells': 5,
  'n_cells': None,
  'n_genes': 2979},
 {'flavor': 'cell_ranger', 'n_bins': 29, 'n_top_genes': 9031},
 {'feat_norm_mode': 'minmax', 'n_components': 0.8694391442724448},
 None,
 None][0m
[WARNING][2024-03-18 07:52:33,279][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:52:33,279][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:52:33,280][dance][wrapped_func] The function 'FilterGenesPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:52:33,280][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/normalize.py:277: RuntimeWarning: invalid value encountered in log10
  genes_log_gmean = np.log10(gmean(X, axis=0, eps=self.gmean_eps))
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPlaceHolder
  scope: _registry_.preprocessor.filter.gene
  params: {}
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
    bin_size: 574
    bw_adjust: 2.8929186218262046
    gmean_eps: 8
    min_cells: 5
    n_cells: null
    n_genes: 2979
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    flavor: cell_ranger
    n_bins: 29
    n_top_genes: 9031
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    feat_norm_mode: minmax
    n_components: 0.8694391442724448
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.025 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run upbeat-sweep-10 at: https://wandb.ai/xzy11632/dance-dev/runs/urhw25pk
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_075228-urhw25pk/logs
wandb: ERROR Run urhw25pk errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 348, in __call__
wandb: ERROR     [is_outlier(model_pars.values[:, i], genes_log_gmean_step1) for i in range(model_pars.shape[1])]).sum(0) > 0
wandb: ERROR     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 348, in <listcomp>
wandb: ERROR     [is_outlier(model_pars.values[:, i], genes_log_gmean_step1) for i in range(model_pars.shape[1])]).sum(0) > 0
wandb: ERROR      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 427, in is_outlier
wandb: ERROR     z = FFTKDE(kernel='gaussian', bw='ISJ').fit(x)
wandb: ERROR         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/FFTKDE.py", line 107, in fit
wandb: ERROR     super().fit(data, weights)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/BaseKDE.py", line 102, in fit
wandb: ERROR     data = self._process_sequence(data)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/BaseKDE.py", line 208, in _process_sequence
wandb: ERROR     return np.asarray_chkfinite(out, dtype=float)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/lib/function_base.py", line 630, in asarray_chkfinite
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: array must not contain infs or NaNs
wandb: ERROR 
[INFO][2024-03-18 07:53:51,584][dance][wandb_sweep] Sweep config:
{'entity': 'xzy11632',
 'method': 'bayes',
 'metric': {'goal': 'maximize', 'name': 'acc'},
 'parameters': {'params.0.FilterGenesPercentile.max_val': {'max': 99,
                                                           'min': 95},
                'params.0.FilterGenesPercentile.min_val': {'max': 10, 'min': 1},
                'params.0.FilterGenesPercentile.mode': {'values': ['sum',
                                                                   'var',
                                                                   'cv',
                                                                   'rv']},
                'params.2.ScTransform.bin_size': {'max': 800, 'min': 300},
                'params.2.ScTransform.bw_adjust': {'max': 5.0, 'min': 1.0},
                'params.2.ScTransform.gmean_eps': {'max': 10, 'min': 1},
                'params.2.ScTransform.min_cells': {'max': 10, 'min': 1},
                'params.2.ScTransform.n_cells': {'values': [None, 1, 10, 100]},
                'params.2.ScTransform.n_genes': {'max': 3000, 'min': 1000},
                'params.3.HighlyVariableGenesLogarithmizedByTopGenes.flavor': {'values': ['seurat',
                                                                                          'cell_ranger']},
                'params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_bins': {'max': 30,
                                                                               'min': 10},
                'params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_top_genes': {'max': 10000,
                                                                                    'min': 100},
                'params.4.WeightedFeatureSVD.feat_norm_mode': {'values': [None,
                                                                          'normalize',
                                                                          'standardize',
                                                                          'minmax',
                                                                          'l2']},
                'params.4.WeightedFeatureSVD.n_components': {'max': 0.95,
                                                             'min': 0.8}},
 'project': 'dance-dev'}
[INFO][2024-03-18 07:53:52,163][dance][wandb_sweep] [94m

	[*] Sweep ID: nc4yzuzs
[0m
[INFO][2024-03-18 07:53:52,164][dance][wandb_sweep_agent] Spawning agent: sweep_id='nc4yzuzs', entity='xzy11632', project='dance-dev', count=10
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: 930bhhay with config:
wandb: 	params.0.FilterGenesPercentile.max_val: 95
wandb: 	params.0.FilterGenesPercentile.min_val: 10
wandb: 	params.0.FilterGenesPercentile.mode: var
wandb: 	params.2.ScTransform.bin_size: 521
wandb: 	params.2.ScTransform.bw_adjust: 4.991547806217198
wandb: 	params.2.ScTransform.gmean_eps: 9
wandb: 	params.2.ScTransform.min_cells: 9
wandb: 	params.2.ScTransform.n_cells: 10
wandb: 	params.2.ScTransform.n_genes: 2227
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.flavor: seurat
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_bins: 23
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_top_genes: 1338
wandb: 	params.4.WeightedFeatureSVD.feat_norm_mode: standardize
wandb: 	params.4.WeightedFeatureSVD.n_components: 0.9311950372881156
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_075404-930bhhay
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run eager-sweep-1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/nc4yzuzs
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/930bhhay
[INFO][2024-03-18 07:54:09,459][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:54:09,544][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:54:09,545][dance][wrapped_func] Took 0:00:00.083490 to load and process data.
[INFO][2024-03-18 07:54:09,547][dance][_sanitize_params] Params plan:
[92m[{'max_val': 95, 'min_val': 10, 'mode': 'var'},
 None,
 {'bin_size': 521,
  'bw_adjust': 4.991547806217198,
  'gmean_eps': 9,
  'min_cells': 9,
  'n_cells': 10,
  'n_genes': 2227},
 {'flavor': 'seurat', 'n_bins': 23, 'n_top_genes': 1338},
 {'feat_norm_mode': 'standardize', 'n_components': 0.9311950372881156},
 None,
 None][0m
[WARNING][2024-03-18 07:54:09,568][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:54:09,623][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/normalize.py:277: RuntimeWarning: invalid value encountered in log10
  genes_log_gmean = np.log10(gmean(X, axis=0, eps=self.gmean_eps))
/home/zyxing/dance/dance/transforms/normalize.py:283: RuntimeWarning: invalid value encountered in log10
  genes_log_gmean_step1 = np.log10(gmean(X[cells_step1][:, genes_step1], axis=0, eps=self.gmean_eps))
Create sweep with ID: nc4yzuzs
Sweep URL: https://wandb.ai/xzy11632/dance-dev/sweeps/nc4yzuzs
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params:
    max_val: 95
    min_val: 10
    mode: var
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
    bin_size: 521
    bw_adjust: 4.991547806217198
    gmean_eps: 9
    min_cells: 9
    n_cells: 10
    n_genes: 2227
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    flavor: seurat
    n_bins: 23
    n_top_genes: 1338
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    feat_norm_mode: standardize
    n_components: 0.9311950372881156
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run eager-sweep-1 at: https://wandb.ai/xzy11632/dance-dev/runs/930bhhay
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_075404-930bhhay/logs
wandb: ERROR Run 930bhhay errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 348, in __call__
wandb: ERROR     [is_outlier(model_pars.values[:, i], genes_log_gmean_step1) for i in range(model_pars.shape[1])]).sum(0) > 0
wandb: ERROR     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 348, in <listcomp>
wandb: ERROR     [is_outlier(model_pars.values[:, i], genes_log_gmean_step1) for i in range(model_pars.shape[1])]).sum(0) > 0
wandb: ERROR      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 427, in is_outlier
wandb: ERROR     z = FFTKDE(kernel='gaussian', bw='ISJ').fit(x)
wandb: ERROR         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/FFTKDE.py", line 107, in fit
wandb: ERROR     super().fit(data, weights)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/BaseKDE.py", line 102, in fit
wandb: ERROR     data = self._process_sequence(data)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/BaseKDE.py", line 208, in _process_sequence
wandb: ERROR     return np.asarray_chkfinite(out, dtype=float)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/lib/function_base.py", line 630, in asarray_chkfinite
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: array must not contain infs or NaNs
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: ie4ui7wf with config:
wandb: 	params.0.FilterGenesPercentile.max_val: 99
wandb: 	params.0.FilterGenesPercentile.min_val: 2
wandb: 	params.0.FilterGenesPercentile.mode: sum
wandb: 	params.2.ScTransform.bin_size: 777
wandb: 	params.2.ScTransform.bw_adjust: 1.619076014089536
wandb: 	params.2.ScTransform.gmean_eps: 8
wandb: 	params.2.ScTransform.min_cells: 6
wandb: 	params.2.ScTransform.n_cells: None
wandb: 	params.2.ScTransform.n_genes: 2701
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.flavor: cell_ranger
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_bins: 21
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_top_genes: 2027
wandb: 	params.4.WeightedFeatureSVD.feat_norm_mode: standardize
wandb: 	params.4.WeightedFeatureSVD.n_components: 0.9037334408641576
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_075431-ie4ui7wf
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run worldly-sweep-2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/nc4yzuzs
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/ie4ui7wf
[INFO][2024-03-18 07:54:37,353][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:54:37,449][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:54:37,450][dance][wrapped_func] Took 0:00:00.096026 to load and process data.
[INFO][2024-03-18 07:54:37,451][dance][_sanitize_params] Params plan:
[92m[{'max_val': 99, 'min_val': 2, 'mode': 'sum'},
 None,
 {'bin_size': 777,
  'bw_adjust': 1.619076014089536,
  'gmean_eps': 8,
  'min_cells': 6,
  'n_cells': None,
  'n_genes': 2701},
 {'flavor': 'cell_ranger', 'n_bins': 21, 'n_top_genes': 2027},
 {'feat_norm_mode': 'standardize', 'n_components': 0.9037334408641576},
 None,
 None][0m
[WARNING][2024-03-18 07:54:37,481][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:54:37,583][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/normalize.py:277: RuntimeWarning: invalid value encountered in log10
  genes_log_gmean = np.log10(gmean(X, axis=0, eps=self.gmean_eps))
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params:
    max_val: 99
    min_val: 2
    mode: sum
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
    bin_size: 777
    bw_adjust: 1.619076014089536
    gmean_eps: 8
    min_cells: 6
    n_cells: null
    n_genes: 2701
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    flavor: cell_ranger
    n_bins: 21
    n_top_genes: 2027
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    feat_norm_mode: standardize
    n_components: 0.9037334408641576
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.025 MB uploadedwandb: - 0.013 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run worldly-sweep-2 at: https://wandb.ai/xzy11632/dance-dev/runs/ie4ui7wf
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_075431-ie4ui7wf/logs
wandb: ERROR Run ie4ui7wf errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 348, in __call__
wandb: ERROR     [is_outlier(model_pars.values[:, i], genes_log_gmean_step1) for i in range(model_pars.shape[1])]).sum(0) > 0
wandb: ERROR     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 348, in <listcomp>
wandb: ERROR     [is_outlier(model_pars.values[:, i], genes_log_gmean_step1) for i in range(model_pars.shape[1])]).sum(0) > 0
wandb: ERROR      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 427, in is_outlier
wandb: ERROR     z = FFTKDE(kernel='gaussian', bw='ISJ').fit(x)
wandb: ERROR         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/FFTKDE.py", line 107, in fit
wandb: ERROR     super().fit(data, weights)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/BaseKDE.py", line 102, in fit
wandb: ERROR     data = self._process_sequence(data)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/BaseKDE.py", line 208, in _process_sequence
wandb: ERROR     return np.asarray_chkfinite(out, dtype=float)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/lib/function_base.py", line 630, in asarray_chkfinite
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: array must not contain infs or NaNs
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: j9n0my96 with config:
wandb: 	params.0.FilterGenesPercentile.max_val: 99
wandb: 	params.0.FilterGenesPercentile.min_val: 3
wandb: 	params.0.FilterGenesPercentile.mode: cv
wandb: 	params.2.ScTransform.bin_size: 490
wandb: 	params.2.ScTransform.bw_adjust: 1.8817830601750096
wandb: 	params.2.ScTransform.gmean_eps: 4
wandb: 	params.2.ScTransform.min_cells: 4
wandb: 	params.2.ScTransform.n_cells: 1
wandb: 	params.2.ScTransform.n_genes: 2966
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.flavor: seurat
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_bins: 14
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_top_genes: 638
wandb: 	params.4.WeightedFeatureSVD.feat_norm_mode: standardize
wandb: 	params.4.WeightedFeatureSVD.n_components: 0.803222184455254
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_075556-j9n0my96
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run proud-sweep-3
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/nc4yzuzs
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/j9n0my96
[INFO][2024-03-18 07:56:01,136][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:56:01,245][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:56:01,245][dance][wrapped_func] Took 0:00:00.107515 to load and process data.
[INFO][2024-03-18 07:56:01,247][dance][_sanitize_params] Params plan:
[92m[{'max_val': 99, 'min_val': 3, 'mode': 'cv'},
 None,
 {'bin_size': 490,
  'bw_adjust': 1.8817830601750096,
  'gmean_eps': 4,
  'min_cells': 4,
  'n_cells': 1,
  'n_genes': 2966},
 {'flavor': 'seurat', 'n_bins': 14, 'n_top_genes': 638},
 {'feat_norm_mode': 'standardize', 'n_components': 0.803222184455254},
 None,
 None][0m
[WARNING][2024-03-18 07:56:01,270][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:56:01,370][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/normalize.py:277: RuntimeWarning: invalid value encountered in log10
  genes_log_gmean = np.log10(gmean(X, axis=0, eps=self.gmean_eps))
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params:
    max_val: 99
    min_val: 3
    mode: cv
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
    bin_size: 490
    bw_adjust: 1.8817830601750096
    gmean_eps: 4
    min_cells: 4
    n_cells: 1
    n_genes: 2966
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    flavor: seurat
    n_bins: 14
    n_top_genes: 638
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    feat_norm_mode: standardize
    n_components: 0.803222184455254
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: invalid value encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: invalid value encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.012 MB of 0.025 MB uploadedwandb: \ 0.013 MB of 0.025 MB uploadedwandb: | 0.013 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run proud-sweep-3 at: https://wandb.ai/xzy11632/dance-dev/runs/j9n0my96
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_075556-j9n0my96/logs
wandb: ERROR Run j9n0my96 errored:
wandb: ERROR multiprocessing.pool.RemoteTraceback: 
wandb: ERROR """
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/multiprocessing/pool.py", line 125, in worker
wandb: ERROR     result = (True, func(*args, **kwds))
wandb: ERROR                     ^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/multiprocessing/pool.py", line 48, in mapstar
wandb: ERROR     return list(map(*args))
wandb: ERROR            ^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 456, in _parallel_wrapper
wandb: ERROR     res = pr.fit(disp=False)
wandb: ERROR           ^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py", line 1355, in fit
wandb: ERROR     cntfit = super(CountModel, self).fit(start_params=start_params,
wandb: ERROR              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py", line 243, in fit
wandb: ERROR     mlefit = super().fit(start_params=start_params,
wandb: ERROR              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/base/model.py", line 582, in fit
wandb: ERROR     Hinv = np.linalg.inv(-retvals['Hessian']) / nobs
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/linalg/linalg.py", line 561, in inv
wandb: ERROR     ainv = _umath_linalg.inv(a, signature=signature, extobj=extobj)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/linalg/linalg.py", line 112, in _raise_linalgerror_singular
wandb: ERROR     raise LinAlgError("Singular matrix")
wandb: ERROR numpy.linalg.LinAlgError: Singular matrix
wandb: ERROR """
wandb: ERROR 
wandb: ERROR The above exception was the direct cause of the following exception:
wandb: ERROR 
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 329, in __call__
wandb: ERROR     pool.map(_parallel_wrapper, range(umi_bin.shape[1]), chunksize=pc_chunksize)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/multiprocessing/pool.py", line 367, in map
wandb: ERROR     return self._map_async(func, iterable, mapstar, chunksize).get()
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/multiprocessing/pool.py", line 774, in get
wandb: ERROR     raise self._value
wandb: ERROR numpy.linalg.LinAlgError: Singular matrix
wandb: ERROR 
wandb: Agent Starting Run: 4qpeighm with config:
wandb: 	params.0.FilterGenesPercentile.max_val: 95
wandb: 	params.0.FilterGenesPercentile.min_val: 7
wandb: 	params.0.FilterGenesPercentile.mode: cv
wandb: 	params.2.ScTransform.bin_size: 596
wandb: 	params.2.ScTransform.bw_adjust: 2.605176608225945
wandb: 	params.2.ScTransform.gmean_eps: 3
wandb: 	params.2.ScTransform.min_cells: 3
wandb: 	params.2.ScTransform.n_cells: 100
wandb: 	params.2.ScTransform.n_genes: 1169
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.flavor: seurat
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_bins: 22
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_top_genes: 7117
wandb: 	params.4.WeightedFeatureSVD.feat_norm_mode: None
wandb: 	params.4.WeightedFeatureSVD.n_components: 0.9083644509678148
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_075618-4qpeighm
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rural-sweep-4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/nc4yzuzs
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/4qpeighm
[INFO][2024-03-18 07:56:23,422][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:56:23,521][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:56:23,521][dance][wrapped_func] Took 0:00:00.090849 to load and process data.
[INFO][2024-03-18 07:56:23,524][dance][_sanitize_params] Params plan:
[92m[{'max_val': 95, 'min_val': 7, 'mode': 'cv'},
 None,
 {'bin_size': 596,
  'bw_adjust': 2.605176608225945,
  'gmean_eps': 3,
  'min_cells': 3,
  'n_cells': 100,
  'n_genes': 1169},
 {'flavor': 'seurat', 'n_bins': 22, 'n_top_genes': 7117},
 {'feat_norm_mode': None, 'n_components': 0.9083644509678148},
 None,
 None][0m
[WARNING][2024-03-18 07:56:23,547][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:56:23,623][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/normalize.py:277: RuntimeWarning: invalid value encountered in log10
  genes_log_gmean = np.log10(gmean(X, axis=0, eps=self.gmean_eps))
/home/zyxing/dance/dance/transforms/normalize.py:283: RuntimeWarning: invalid value encountered in log10
  genes_log_gmean_step1 = np.log10(gmean(X[cells_step1][:, genes_step1], axis=0, eps=self.gmean_eps))
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params:
    max_val: 95
    min_val: 7
    mode: cv
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
    bin_size: 596
    bw_adjust: 2.605176608225945
    gmean_eps: 3
    min_cells: 3
    n_cells: 100
    n_genes: 1169
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    flavor: seurat
    n_bins: 22
    n_top_genes: 7117
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    feat_norm_mode: null
    n_components: 0.9083644509678148
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.025 MB uploadedwandb: | 0.012 MB of 0.025 MB uploadedwandb: / 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run rural-sweep-4 at: https://wandb.ai/xzy11632/dance-dev/runs/4qpeighm
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_075618-4qpeighm/logs
wandb: ERROR Run 4qpeighm errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 348, in __call__
wandb: ERROR     [is_outlier(model_pars.values[:, i], genes_log_gmean_step1) for i in range(model_pars.shape[1])]).sum(0) > 0
wandb: ERROR     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 348, in <listcomp>
wandb: ERROR     [is_outlier(model_pars.values[:, i], genes_log_gmean_step1) for i in range(model_pars.shape[1])]).sum(0) > 0
wandb: ERROR      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 427, in is_outlier
wandb: ERROR     z = FFTKDE(kernel='gaussian', bw='ISJ').fit(x)
wandb: ERROR         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/FFTKDE.py", line 107, in fit
wandb: ERROR     super().fit(data, weights)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/BaseKDE.py", line 102, in fit
wandb: ERROR     data = self._process_sequence(data)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/BaseKDE.py", line 208, in _process_sequence
wandb: ERROR     return np.asarray_chkfinite(out, dtype=float)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/lib/function_base.py", line 630, in asarray_chkfinite
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: array must not contain infs or NaNs
wandb: ERROR 
wandb: Agent Starting Run: 72uma8gf with config:
wandb: 	params.0.FilterGenesPercentile.max_val: 97
wandb: 	params.0.FilterGenesPercentile.min_val: 4
wandb: 	params.0.FilterGenesPercentile.mode: sum
wandb: 	params.2.ScTransform.bin_size: 599
wandb: 	params.2.ScTransform.bw_adjust: 4.003176730060797
wandb: 	params.2.ScTransform.gmean_eps: 1
wandb: 	params.2.ScTransform.min_cells: 2
wandb: 	params.2.ScTransform.n_cells: 1
wandb: 	params.2.ScTransform.n_genes: 2560
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.flavor: seurat
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_bins: 22
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_top_genes: 2900
wandb: 	params.4.WeightedFeatureSVD.feat_norm_mode: None
wandb: 	params.4.WeightedFeatureSVD.n_components: 0.8607692221797487
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_075634-72uma8gf
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run silver-sweep-5
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/nc4yzuzs
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/72uma8gf
[INFO][2024-03-18 07:56:40,084][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:56:40,209][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:56:40,210][dance][wrapped_func] Took 0:00:00.124943 to load and process data.
[INFO][2024-03-18 07:56:40,212][dance][_sanitize_params] Params plan:
[92m[{'max_val': 97, 'min_val': 4, 'mode': 'sum'},
 None,
 {'bin_size': 599,
  'bw_adjust': 4.003176730060797,
  'gmean_eps': 1,
  'min_cells': 2,
  'n_cells': 1,
  'n_genes': 2560},
 {'flavor': 'seurat', 'n_bins': 22, 'n_top_genes': 2900},
 {'feat_norm_mode': None, 'n_components': 0.8607692221797487},
 None,
 None][0m
[WARNING][2024-03-18 07:56:40,240][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:56:40,338][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params:
    max_val: 97
    min_val: 4
    mode: sum
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
    bin_size: 599
    bw_adjust: 4.003176730060797
    gmean_eps: 1
    min_cells: 2
    n_cells: 1
    n_genes: 2560
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    flavor: seurat
    n_bins: 22
    n_top_genes: 2900
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    feat_norm_mode: null
    n_components: 0.8607692221797487
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:476: RuntimeWarning: divide by zero encountered in scalar divide
  t0 = n / sum(weights * (y / mu - 1)**2)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:476: RuntimeWarning: divide by zero encountered in scalar divide
  t0 = n / sum(weights * (y / mu - 1)**2)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:476: RuntimeWarning: divide by zero encountered in scalar divide
  t0 = n / sum(weights * (y / mu - 1)**2)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:476: RuntimeWarning: divide by zero encountered in scalar divide
  t0 = n / sum(weights * (y / mu - 1)**2)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:476: RuntimeWarning: divide by zero encountered in scalar divide
  t0 = n / sum(weights * (y / mu - 1)**2)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:484: RuntimeWarning: divide by zero encountered in scalar divide
  de = score(n, t0, mu, y, weights) / i
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/dance/dance/transforms/normalize.py:476: RuntimeWarning: divide by zero encountered in scalar divide
  t0 = n / sum(weights * (y / mu - 1)**2)
/home/zyxing/dance/dance/transforms/normalize.py:474: RuntimeWarning: invalid value encountered in divide
  return sum(w * (-polygamma(1, th + y) + polygamma(1, th) - 1 / th + 2 / (mu + th) - (y + th) / (mu + th)**2))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in subtract
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/dance/dance/transforms/normalize.py:471: RuntimeWarning: invalid value encountered in divide
  return sum(w * (psi(th + y) - psi(th) + np.log(th) + 1 - np.log(th + mu) - (y + th) / (mu + th)))
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py:227: PerfectSeparationWarning: Perfect separation or prediction detected, parameter may not be identified
  warnings.warn(msg, category=PerfectSeparationWarning)
wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.024 MB uploadedwandb: / 0.021 MB of 0.024 MB uploadedwandb: - 0.021 MB of 0.024 MB uploadedwandb: \ 0.021 MB of 0.024 MB uploadedwandb: | 0.021 MB of 0.024 MB uploadedwandb: / 0.021 MB of 0.024 MB uploadedwandb: - 0.021 MB of 0.024 MB uploadedwandb: \ 0.021 MB of 0.024 MB uploadedwandb: | 0.024 MB of 0.024 MB uploadedwandb:                                                                                
wandb: üöÄ View run silver-sweep-5 at: https://wandb.ai/xzy11632/dance-dev/runs/72uma8gf
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_075634-72uma8gf/logs
wandb: ERROR Run 72uma8gf errored:
wandb: ERROR multiprocessing.pool.RemoteTraceback: 
wandb: ERROR """
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/multiprocessing/pool.py", line 125, in worker
wandb: ERROR     result = (True, func(*args, **kwds))
wandb: ERROR                     ^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/multiprocessing/pool.py", line 48, in mapstar
wandb: ERROR     return list(map(*args))
wandb: ERROR            ^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 456, in _parallel_wrapper
wandb: ERROR     res = pr.fit(disp=False)
wandb: ERROR           ^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py", line 1355, in fit
wandb: ERROR     cntfit = super(CountModel, self).fit(start_params=start_params,
wandb: ERROR              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/discrete/discrete_model.py", line 243, in fit
wandb: ERROR     mlefit = super().fit(start_params=start_params,
wandb: ERROR              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/statsmodels/base/model.py", line 582, in fit
wandb: ERROR     Hinv = np.linalg.inv(-retvals['Hessian']) / nobs
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/linalg/linalg.py", line 561, in inv
wandb: ERROR     ainv = _umath_linalg.inv(a, signature=signature, extobj=extobj)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/linalg/linalg.py", line 112, in _raise_linalgerror_singular
wandb: ERROR     raise LinAlgError("Singular matrix")
wandb: ERROR numpy.linalg.LinAlgError: Singular matrix
wandb: ERROR """
wandb: ERROR 
wandb: ERROR The above exception was the direct cause of the following exception:
wandb: ERROR 
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 329, in __call__
wandb: ERROR     pool.map(_parallel_wrapper, range(umi_bin.shape[1]), chunksize=pc_chunksize)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/multiprocessing/pool.py", line 367, in map
wandb: ERROR     return self._map_async(func, iterable, mapstar, chunksize).get()
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/multiprocessing/pool.py", line 774, in get
wandb: ERROR     raise self._value
wandb: ERROR numpy.linalg.LinAlgError: Singular matrix
wandb: ERROR 
wandb: Sweep Agent: Waiting for job.
wandb: Job received.
wandb: Agent Starting Run: xsivglos with config:
wandb: 	params.0.FilterGenesPercentile.max_val: 97
wandb: 	params.0.FilterGenesPercentile.min_val: 8
wandb: 	params.0.FilterGenesPercentile.mode: rv
wandb: 	params.2.ScTransform.bin_size: 474
wandb: 	params.2.ScTransform.bw_adjust: 4.861809064204648
wandb: 	params.2.ScTransform.gmean_eps: 4
wandb: 	params.2.ScTransform.min_cells: 3
wandb: 	params.2.ScTransform.n_cells: None
wandb: 	params.2.ScTransform.n_genes: 1312
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.flavor: seurat
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_bins: 14
wandb: 	params.3.HighlyVariableGenesLogarithmizedByTopGenes.n_top_genes: 3918
wandb: 	params.4.WeightedFeatureSVD.feat_norm_mode: standardize
wandb: 	params.4.WeightedFeatureSVD.n_components: 0.9221899831800922
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /home/zyxing/dance/examples/tuning/cluster_graphsc/wandb/run-20240318_075705-xsivglos
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run gentle-sweep-6
wandb: ‚≠êÔ∏è View project at https://wandb.ai/xzy11632/dance-dev
wandb: üßπ View sweep at https://wandb.ai/xzy11632/dance-dev/sweeps/nc4yzuzs
wandb: üöÄ View run at https://wandb.ai/xzy11632/dance-dev/runs/xsivglos
[INFO][2024-03-18 07:57:10,738][dance][set_seed] Setting global random seed to 0
/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/anndata/_core/anndata.py:522: FutureWarning: The dtype argument is deprecated and will be removed in late 2024.
  warnings.warn(
[INFO][2024-03-18 07:57:10,826][dance][load_data] Raw data loaded:
Data object that wraps (.data):
AnnData object with n_obs √ó n_vars = 8218 √ó 1000
    uns: 'dance_config'
    obsm: 'Group'
[INFO][2024-03-18 07:57:10,826][dance][wrapped_func] Took 0:00:00.087010 to load and process data.
[INFO][2024-03-18 07:57:10,828][dance][_sanitize_params] Params plan:
[92m[{'max_val': 97, 'min_val': 8, 'mode': 'rv'},
 None,
 {'bin_size': 474,
  'bw_adjust': 4.861809064204648,
  'gmean_eps': 4,
  'min_cells': 3,
  'n_cells': None,
  'n_genes': 1312},
 {'flavor': 'seurat', 'n_bins': 14, 'n_top_genes': 3918},
 {'feat_norm_mode': 'standardize', 'n_components': 0.9221899831800922},
 None,
 None][0m
[WARNING][2024-03-18 07:57:10,847][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
[WARNING][2024-03-18 07:57:10,906][dance][wrapped_func] The function 'FilterCellsPlaceHolder' (/home/zyxing/dance/dance/transforms/filter.py) is deprecated and will be removed soon[91m
   Reason: will be replaced by builtin bypass mechanism in pipeline[0m
/home/zyxing/dance/dance/transforms/normalize.py:277: RuntimeWarning: invalid value encountered in log10
  genes_log_gmean = np.log10(gmean(X, axis=0, eps=self.gmean_eps))
Pipeline config:
type: preprocessor
desc: null
pipeline:
- type: filter.gene
  desc: null
  target: FilterGenesPercentile
  scope: _registry_.preprocessor.filter.gene
  params:
    max_val: 97
    min_val: 8
    mode: rv
- type: filter.cell
  desc: null
  target: FilterCellsPlaceHolder
  scope: _registry_.preprocessor.filter.cell
  params: {}
- type: normalize
  desc: null
  target: ScTransform
  scope: _registry_.preprocessor.normalize
  params:
    processes_num: 8
    bin_size: 474
    bw_adjust: 4.861809064204648
    gmean_eps: 4
    min_cells: 3
    n_cells: null
    n_genes: 1312
- type: filter.gene
  desc: null
  target: HighlyVariableGenesLogarithmizedByTopGenes
  scope: _registry_.preprocessor.filter.gene
  params:
    flavor: seurat
    n_bins: 14
    n_top_genes: 3918
- type: feature.cell
  desc: null
  target: WeightedFeatureSVD
  scope: _registry_.preprocessor.feature.cell
  params:
    out: feature.cell
    feat_norm_mode: standardize
    n_components: 0.9221899831800922
- type: graph.cell
  desc: null
  target: CellFeatureGraph
  scope: _registry_.preprocessor.graph.cell
  params:
    cell_feature_channel: feature.cell
- type: misc
  desc: null
  target: SetConfig
  scope: _registry_.preprocessor.misc
  params:
    config_dict:
      feature_channel: CellFeatureGraph
      feature_channel_type: uns
      label_channel: Group

wandb: - 0.012 MB of 0.012 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: / 0.012 MB of 0.012 MB uploadedwandb: - 0.017 MB of 0.025 MB uploadedwandb: \ 0.017 MB of 0.025 MB uploadedwandb: | 0.025 MB of 0.025 MB uploadedwandb:                                                                                
wandb: üöÄ View run gentle-sweep-6 at: https://wandb.ai/xzy11632/dance-dev/runs/xsivglos
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240318_075705-xsivglos/logs
wandb: ERROR Run xsivglos errored:
wandb: ERROR Traceback (most recent call last):
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/wandb/agents/pyagent.py", line 308, in _run_job
wandb: ERROR     self._function()
wandb: ERROR   File "/home/zyxing/dance/examples/tuning/cluster_graphsc/main.py", line 70, in evaluate_pipeline
wandb: ERROR     preprocessing_pipeline(data)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 232, in bounded_functional
wandb: ERROR     a(*args, **kwargs)
wandb: ERROR   File "/home/zyxing/dance/dance/pipeline.py", line 114, in __call__
wandb: ERROR     return self.functional(*args, **kwargs)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 348, in __call__
wandb: ERROR     [is_outlier(model_pars.values[:, i], genes_log_gmean_step1) for i in range(model_pars.shape[1])]).sum(0) > 0
wandb: ERROR     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 348, in <listcomp>
wandb: ERROR     [is_outlier(model_pars.values[:, i], genes_log_gmean_step1) for i in range(model_pars.shape[1])]).sum(0) > 0
wandb: ERROR      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/dance/dance/transforms/normalize.py", line 427, in is_outlier
wandb: ERROR     z = FFTKDE(kernel='gaussian', bw='ISJ').fit(x)
wandb: ERROR         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/FFTKDE.py", line 107, in fit
wandb: ERROR     super().fit(data, weights)
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/BaseKDE.py", line 102, in fit
wandb: ERROR     data = self._process_sequence(data)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/KDEpy/BaseKDE.py", line 208, in _process_sequence
wandb: ERROR     return np.asarray_chkfinite(out, dtype=float)
wandb: ERROR            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
wandb: ERROR   File "/home/zyxing/anaconda3/envs/dance-env/lib/python3.11/site-packages/numpy/lib/function_base.py", line 630, in asarray_chkfinite
wandb: ERROR     raise ValueError(
wandb: ERROR ValueError: array must not contain infs or NaNs
wandb: ERROR 
wandb: ERROR Detected 5 failed runs in a row at start, killing sweep.
wandb: To change this value set WANDB_AGENT_MAX_INITIAL_FAILURES=val
